<html>
<head>
<title>Model performance &amp; cost functions for classification models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">分类模型的模型性能和成本函数</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/model-performance-cost-functions-for-classification-models-a7b1b00ba60?source=collection_archive---------3-----------------------#2018-08-08">https://towardsdatascience.com/model-performance-cost-functions-for-classification-models-a7b1b00ba60?source=collection_archive---------3-----------------------#2018-08-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/30b72e655542f0d924feb82df1eb724d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C9R06Lw44ixhJQaY4o4kQw.jpeg"/></div></div></figure><p id="4a93" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">分类模型是预测分类的 Y 变量的机器学习模型:</p><ol class=""><li id="f685" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated">雇主会离开还是留下来？</li><li id="673d" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">病人到底有没有癌症？</li><li id="13c6" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">该客户属于高风险、中等风险还是低风险？</li><li id="fccd" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">客户会支付贷款还是违约？</li></ol><p id="7668" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Y 变量只能取 2 个值的分类模型称为二元分类器。</p><p id="832c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">分类模型的模型性能通常在哪个模型性能最相关方面存在争议，尤其是当数据集不平衡时。用于评估分类模型的通常模型性能测量是准确度、灵敏度或召回率、特异性、精确度、KS 统计和曲线下面积(AUC)。</p><p id="1754" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们基于一个预测贷款违约的例子来理解一些模型性能测量。贷款违约数据集是不平衡数据集的一个典型例子，其中两个类是贷款违约 Y 和贷款违约 n。贷款违约者的数量通常只占整个数据集的很小一部分，不超过 7–8%。这提供了一个经典的不平衡数据集来理解为什么成本函数在决定使用哪个模型时至关重要。</p><p id="3830" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在我们深入研究如何制定成本函数之前，让我们看看混淆矩阵、假阳性、假阴性和各种模型性能测量的定义的基本概念。</p><h1 id="04bd" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">什么是混淆矩阵？</h1><p id="959f" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">混淆矩阵是包含二进制分类器输出的表格。让我们看看预测贷款违约的二元分类器的混淆矩阵——0 表示客户将支付贷款，1 表示客户将违约。我们进一步讨论的积极类是 1(将违约的客户)。</p><p id="7b32" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">矩阵的行表示观察到的或实际的类别，列表示预测的类别。</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/554ff60609fbd84388fd0e282b979943.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/format:webp/1*uIvndUruvejk3NspvNmUIA.jpeg"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk">Confusion matrix</figcaption></figure><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/6d106673c03b151d5414e20cb819cc39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CnBf25sk5VRk9JGBcivYNw.png"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk">Definition of TP, FP, TN, FN</figcaption></figure><p id="667b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，让我们试着理解每个模型性能度量在混淆矩阵的组成部分方面转化为什么。</p><h1 id="011f" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">准确(性)</h1><p id="1d4b" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">准确性是模型通过记录总数做出的正确预测的数量。最好的准确度是 100%,表明所有的预测都是正确的。</p><p id="4928" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于不平衡的数据集，精确度不是模型性能的有效衡量标准。对于默认比率为 5%的数据集，即使所有记录都被预测为 0，该模型仍将具有 95%的准确性。但是这种模式会忽略所有的默认值，对业务非常不利。因此，在这种情况下，准确性不是衡量模型性能的正确标准。</p><h1 id="4efe" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">敏感性或回忆</h1><p id="2a3a" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">灵敏度(回忆或真阳性率)的计算方法是正确的阳性预测数除以阳性总数。它也被称为回忆(REC)或真阳性率(TPR)。</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/cef9916c35d8e23e436ec89c2f09d950.png" data-original-src="https://miro.medium.com/v2/resize:fit:582/format:webp/1*rR3iVvSGvzqmQP8pidxDZQ.jpeg"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk">Sensitivity</figcaption></figure><h1 id="6a43" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">特征</h1><p id="c2bb" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">特异性(真阴性率)计算为正确阴性预测数除以阴性总数。</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/5d4dafbb1d380f272277b017f1aaa177.png" data-original-src="https://miro.medium.com/v2/resize:fit:610/format:webp/1*nEA1EAlaDNy-EBt0ixFbvA.png"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk">Specificity</figcaption></figure><h1 id="d9bc" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">精确</h1><p id="d047" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">精度(阳性预测值)的计算方法是正确的阳性预测数除以阳性预测总数。</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/910acb282dbf8ab2bf983cfa211afa3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:556/format:webp/1*8HP3ZrCGGs-zf_jAVQLz5Q.png"/></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk">Precision</figcaption></figure><h1 id="9350" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">KS 统计</h1><p id="ed77" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">KS 统计量是正分布和负分布之间分离程度的度量。KS 值为 100 表示分数对记录进行了精确的划分，一个组包含所有的正数，另一个组包含所有的负数。在实际情况下，高于 50%的 KS 值是理想的。</p><h1 id="6bf3" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">ROC 图和曲线下面积(AUC)</h1><p id="0e16" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">ROC 图是 X 轴表示特异性，Y 轴表示灵敏度的图。ROC 曲线下的面积是模型性能的度量。随机分类器的 AUC 是 50%,而完美分类器的 AUC 是 100%。对于实际情况，超过 70%的 AUC 是理想的。</p><h1 id="242f" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">精确度与召回率</h1><p id="b583" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">回忆或敏感度为我们提供了关于模型在假阴性(对将违约的客户的不正确预测)上的表现的信息，而精确度为我们提供了模型在假阳性上的表现的信息。基于预测的结果，精确度或召回率对模型来说可能更重要。</p><p id="fed8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">成本函数在决定哪个不正确的预测可能更有害(假阳性或假阴性)时发挥作用(换句话说，哪个性能测量更重要——精确度或召回率)。</p><h1 id="6ea9" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">净收入函数</h1><p id="69df" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">净收入或成本函数是通过为每个假阳性和假阴性分配成本并基于正确和不正确的预测得出总收入而得到的。让我们假设此贷款默认数据集的成本和收入如下:</p><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/3545d21d89a14c70d5d2fccd94a507b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HNfqlrvF5S31RxYgYxi_2A.png"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk">Cost components of a loan default prediction model</figcaption></figure><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nb"><img src="../Images/0e62c750d3a74e1dacd23d1f645708b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*prjHB1jDuSAlEIUX38D8iw.png"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk">Allocation of FP, FN &amp; TP cost</figcaption></figure><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/271586db464960608d9d6afa7d1a5f7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FRcTeGDzXBMVMD7f4zeqEQ.png"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk">Net revenue</figcaption></figure><p id="52ca" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">由于假阴性成本最高，最<strong class="ka ir"> <em class="nd">的最优模型将是假阴性</em> </strong>最小的模型。换句话说，与其他模型相比，具有更高敏感度的模型将获得更高的净收入。</p><p id="abd2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们有了计算净收入的方法，让我们根据混淆矩阵来比较两个模型:</p><h1 id="a940" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">混淆矩阵 A</h1><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ne"><img src="../Images/2a5f03246400472e426c8abdb2dc4c32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zESV_AxAR-oMdct42jH0qw.png"/></div></div></figure><h1 id="9a1c" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">混淆矩阵 B</h1><figure class="mo mp mq mr gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nf"><img src="../Images/2f9b810eda6749614bb72ede4280be7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*myaH9_xxZ6mArTExUZZ07A.png"/></div></div></figure><p id="5c90" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">模型 B 由于其较低的假阴性被证明是一个更好的模型，因此可以被选择用于预测违约。</p><p id="2f73" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">总之，在各种成本成分的相当近似的估计可用的商业场景中，基于成本函数的模型性能度量与传统的模型性能度量(如灵敏度、特异性等)相比，将给出对模型选择的更好的洞察。与给出统计术语相比，如果用成本和收入来解释模型，对客户来说也更有意义。</p></div></div>    
</body>
</html>