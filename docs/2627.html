<html>
<head>
<title>Bayes’ Rule Applied</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">应用贝叶斯规则</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/bayes-rule-applied-75965e4482ff?source=collection_archive---------1-----------------------#2018-02-14">https://towardsdatascience.com/bayes-rule-applied-75965e4482ff?source=collection_archive---------1-----------------------#2018-02-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/af33616aa5d5c4afd57d35f577eda38b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X-Nr5zIt4Nm-7ucZsKtxbg.jpeg"/></div></div></figure><div class=""/><p id="1412" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka jc">在现实世界问题上使用贝叶斯推理</strong></p><p id="a03d" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">贝叶斯推理的基本思想是用更多的数据变得“更少的错误”。这个过程很简单:我们有一个最初的信念，称为先验，当我们获得更多信息时，我们会更新它。虽然我们不认为这是贝叶斯推理，但我们一直在使用这种技术。例如，我们最初可能认为有 50%的机会在季度末获得晋升。如果我们从经理那里得到积极的反馈，我们会向上调整我们的估计，相反，如果我们把咖啡机弄得一团糟，我们可能会降低概率。随着我们不断收集信息，我们会改进我们的估计，以更接近“真实”的答案。</p><p id="92dc" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们的直觉行为被形式化为一个简单而强大的等式，称为<a class="ae kw" href="http://www.eecs.qmul.ac.uk/~norman/BBNs/Bayes_rule.htm" rel="noopener ugc nofollow" target="_blank">贝叶斯法则</a>:</p><figure class="ky kz la lb gt is gh gi paragraph-image"><div class="gh gi kx"><img src="../Images/dade92675ebaa8b53f5ac74eee461616.png" data-original-src="https://miro.medium.com/v2/resize:fit:770/format:webp/1*cZc4ICYYheIZf1Py358C-w.png"/></div></figure><p id="1f39" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将左侧称为后验概率，作为给定事件 b 的事件 A 的条件概率。在右侧，<code class="fe lc ld le lf b">P(A)</code>是我们的先验，或事件 A 的概率的初始信念，<code class="fe lc ld le lf b">P(B|A)</code>是可能性(也是条件概率)，我们从我们的数据中得出，<code class="fe lc ld le lf b">P(B)</code>是使概率分布总和为 1 的归一化常数。贝叶斯规则在统计语言中的一般形式是后验概率等于似然性乘以先验除以归一化常数。这个简短的等式引出了贝叶斯推理的整个领域，贝叶斯推理是一种对世界进行推理的有效方法。</p><p id="7fb4" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">虽然 A 和 B 可能是很好的占位符，但它们对让我们了解如何使用这个概念没有太大帮助。为了做到这一点，我们可以将贝叶斯规则应用于现实世界数据的问题。</p></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><p id="20e9" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我在自己的生活中一直在探索的一个问题是睡眠模式。我有来自我的 Garmin Vivosmart 手表的 2 个多月的数据，显示我何时入睡和醒来。在<a class="ae kw" rel="noopener" target="_blank" href="/markov-chain-monte-carlo-in-python-44f7e609be98">之前的一篇</a>文章中，我用马尔可夫链蒙特卡罗(MCMC)方法计算出了我在给定时间睡着的概率。最终模型显示<em class="ln">最有可能的</em>睡眠时间分布(MCMC 是一种近似方法)如下。</p><figure class="ky kz la lb gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi lo"><img src="../Images/d51978a5efd18dc8244698b3d49044d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WbHoJ6_iGT7ovDBPS3KGMw.png"/></div></div></figure><p id="91d6" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是我睡着的概率，只考虑时间。如果我们知道时间并且有额外的证据呢？知道我卧室的灯亮着会如何改变我睡着的概率？这就是我们使用贝叶斯规则来更新我们的估计的地方。对于特定时间，如果我们知道我卧室灯的信息，我们可以使用上面分布的概率作为<em class="ln">先验</em>，然后应用贝叶斯方程:</p><figure class="ky kz la lb gt is gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/0e37299754370d3a4a5e9e49ca35b6b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*ZzecqlCUpUq1tc5dUQK18g.png"/></div></figure><p id="f72f" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">左边是后验概率，给定我卧室灯的状态(开或关)，睡眠的条件概率。给定时间的概率将作为我们的先验，<code class="fe lc ld le lf b">P(sleep)</code>，或者在没有额外信息的情况下我们使用的估计值。比如晚上 10 点，我睡着的先验概率是 27.34%。如果我们有更多的信息，我们可以使用从观测数据中得到的可能性<code class="fe lc ld le lf b">P(bedroom light |sleep)</code>来更新这些信息。根据我的习惯，我知道假设我睡着了，我卧室的灯亮着的概率大约是 1%。那就是:</p><figure class="ky kz la lb gt is gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/4a9a556f2071313bbb730e1992c718ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1128/format:webp/1*FREtsVg9Bwi1BCN-AvLFpA.png"/></div></figure><p id="eba5" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">假设我睡着了，我的灯熄灭的概率是<code class="fe lc ld le lf b">1–0.01 = 0.99</code>(这里我用减号(-)表示相反的情况。)这是因为条件概率分布的总和必须为 1。如果我们知道我睡着了，我卧室的灯要么开着，要么关着！</p><p id="a45a" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">等式的最后一部分是归一化常数<code class="fe lc ld le lf b">P(light)</code>。这代表我的灯亮着的总概率。我的灯亮着有两种情况:我睡着了或者我醒着。因此，如果我们知道睡眠的先验概率，我们可以计算归一化常数为:</p><figure class="ky kz la lb gt is gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/960cc8f48126b82e1c8445e7cc163e3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*bFTFP_CCt4pxaGezJZxS_Q.png"/></div></figure><p id="22e6" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我的灯亮着的总概率考虑了我睡着时灯亮着的几率和我醒着时灯亮着的几率。(<code class="fe lc ld le lf b">P(-sleep) = 1 — P(sleep)</code>是我醒着的概率。)</p><p id="81a5" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">假设我没有睡着，我的灯亮着的概率<code class="fe lc ld le lf b">P(light | — sleep)</code>，也是通过观察确定的。在我的例子中，我知道如果我醒着，我卧室的灯有大约 80%的可能性是亮着的(这意味着如果我醒着，我的灯有 20%的可能性是不亮的)。</p><p id="2909" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用我的灯亮着的总概率，贝叶斯公式是:</p><figure class="ky kz la lb gt is gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/9b634e1921c98135b7638efd6490ffdc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1318/format:webp/1*vlU5wEqqC4tmoaxen5Rf2Q.png"/></div></figure><p id="67b6" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">假设我的灯亮着，这代表我睡着的概率。如果我的灯关了，那么我们用<code class="fe lc ld le lf b">P(-light|...</code>替换每一个<code class="fe lc ld le lf b">P(light|...</code>。</p></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><p id="d12b" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">只有单词的方程已经够多了，让我们看看如何将它用于数字！</p><p id="628d" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们知道我的灯是亮着的，我们将在晚上 10:30 应用这个等式。首先，我们使用时间计算我睡着的先验概率，得到的答案是 73.90%。先验为我们的估计提供了一个很好的起点，但是我们可以通过加入关于我的光的信息来改进它。知道我的灯亮着，我们可以用相关的数字填充贝叶斯方程:</p><figure class="ky kz la lb gt is gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/dec3a6c4d6e34af143eca732574cc2b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*jWp1f-XYpFPHpqWEY_pzkQ.png"/></div></figure><p id="dc28" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我的灯亮着，这一事实极大地改变了我们对我睡着的概率的估计，从超过 70%变成了 3.42%。这显示了贝叶斯法则的力量:我们能够通过加入更多的信息来更新我们对形势的最初估计。尽管我们可能已经直观地做到了这一点，但从形式方程的角度来考虑它，可以让我们以严格的方式更新我们的信念。</p><p id="5d1d" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们试试另一个例子。如果现在是晚上 9:45，我的灯关了怎么办？试着从 0.1206 的先验概率开始解这道题。</p><p id="f1e8" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我没有总是手工做这个推断，而是写了一些简单的 Python 代码来做这些计算，你可以在<a class="ae kw" href="https://github.com/WillKoehrsen/ai-projects/blob/master/bayesian_inference/bayes_rule_applied.ipynb" rel="noopener ugc nofollow" target="_blank"> Jupyter 笔记本</a>中玩这些计算。代码输出以下答案:</p><pre class="ky kz la lb gt lu lf lv lw aw lx bi"><span id="58c8" class="ly lz jb lf b gy ma mb l mc md">Time: 09:45:00 PM 	Light is OFF.<br/><br/>The prior probability of sleep:    12.06%<br/>The updated probability of sleep:  40.44%</span></pre><p id="499b" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们再次看到额外的信息改变了我们的估计。现在，如果我的妹妹想在晚上 9:45 打电话给我，她不知何故知道我的灯亮着，她可以参考这个等式来确定我是否会接电话(假设我总是在醒着的时候接电话)！谁说日常生活中不能用 stats？</p></div><div class="ab cl lg lh hu li" role="separator"><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll lm"/><span class="lj bw bk lk ll"/></div><div class="ij ik il im in"><p id="6b7f" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">看到数字结果是有帮助的，但是可视化也有助于使观点更加清晰。如果仅仅通过看方程式不能表达想法，我总是试图结合情节来表达想法。在这里，我们可以使用额外的数据来可视化睡眠的先验和条件概率分布。</p><figure class="ky kz la lb gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi me"><img src="../Images/9acdbc5070d26044aeea353bce546f85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UCCTzW1_V3gu42V8xmULRg.png"/></div></div></figure><p id="a319" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当我的灯亮着的时候，曲线向右移动，表明在给定的时间我睡着的概率较低。同样，如果我的灯关闭，曲线会向左移动。从概念上理解一个统计概念可能是困难的，但是这个例子精确地说明了为什么我们使用贝叶斯法则。如果我们想减少对世界的错误，那么额外的信息应该改变我们的信念，贝叶斯推理使用系统的方法更新我们的估计。</p><h1 id="67de" class="mf lz jb bd mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb bi translated">使用更多的证据！</h1><p id="b015" class="pw-post-body-paragraph jy jz jb ka b kb nc kd ke kf nd kh ki kj ne kl km kn nf kp kq kr ng kt ku kv ij bi translated">为什么停在我卧室的灯前？我们可以在模型中使用尽可能多的信息，它将继续变得更加精确(只要数据告诉我们一些关于这种情况的有用信息)。例如，如果我知道在我睡着的情况下，我的手机正在充电的可能性是 95%，我们可以将这一知识纳入模型。</p><p id="8db4" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里，我们将假设我的手机正在充电的概率是给定我是否在睡觉的信息的情况下我的灯打开的概率的<a class="ae kw" href="https://en.wikipedia.org/wiki/Conditional_independence" rel="noopener ugc nofollow" target="_blank">有条件独立</a>(<a class="ae kw" href="https://brilliant.org/wiki/probability-independent-events/" rel="noopener ugc nofollow" target="_blank">独立</a>是一个稍微高级一点的概念，但它允许我们简化许多问题)。使用额外信息的贝叶斯方程被表达为:</p><figure class="ky kz la lb gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nh"><img src="../Images/94875ea2e275cd248b6eab8b8d55b539.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*clegNHghgb04Mz_XknQjsg.png"/></div></div></figure><p id="79b5" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这看起来有点吓人，但是使用一点 Python 代码，我们可以创建一个函数来为我们进行计算。我们在任何时候输入，以及我的灯是否亮着和手机是否在充电的任何组合，函数返回更新的我睡着的概率。</p><p id="7dab" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我将跳过数学(我让我的计算机来做)并显示结果:</p><pre class="ky kz la lb gt lu lf lv lw aw lx bi"><span id="5099" class="ly lz jb lf b gy ma mb l mc md">Time is 11:00:00 PM 	Light is ON 	Phone IS NOT charging.<br/><br/>The prior probability of sleep:    95.52%<br/>The updated probability of sleep:  1.74%</span></pre><p id="88f5" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在晚上 11 点，没有额外的信息，我们几乎可以肯定地猜测我睡着了。然而，一旦我们有了我的灯亮着而手机没有充电的额外信息，我们就断定我睡着的可能性微乎其微。这是另一个查询:</p><pre class="ky kz la lb gt lu lf lv lw aw lx bi"><span id="fb7c" class="ly lz jb lf b gy ma mb l mc md">Time is 10:15:00 PM 	Light is OFF 	Phone IS charging.<br/><br/>The prior probability of sleep:    50.79%<br/>The updated probability of sleep:  95.10%</span></pre><p id="e364" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">根据具体情况，概率会变低或变高。为了证明这一点，我们可以看看光和电话证据的四种配置，以及它们如何改变概率分布:</p><figure class="ky kz la lb gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi me"><img src="../Images/37584e7c7b5838ab7b1bcce256d79e1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dNHiqyTaRP-1H__1fqNNCw.png"/></div></div></figure><p id="ddc9" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这个图表中有很多信息，但是关键的想法是概率曲线根据证据而变化。随着我们获得更多的数据，我们可以进一步完善我们的估计。</p><h1 id="0ad7" class="mf lz jb bd mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb bi translated">结论</h1><p id="135e" class="pw-post-body-paragraph jy jz jb ka b kb nc kd ke kf nd kh ki kj ne kl km kn nf kp kq kr ng kt ku kv ij bi translated">当只使用字母或虚构的情况给出抽象方程时，贝叶斯规则和其他统计概念可能难以理解。我上过很多课，贝叶斯法则都是用不太有用的例子来展示的，比如掷硬币或者从瓮中抽出彩球，但是直到这个项目，我才最终理解了贝叶斯推理的适用性。如果你正在纠结一个概念，寻找一个你可以应用它的环境，或者看看别人已经这样做的案例！</p><p id="cd35" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当我们把概念转化为问题时，真正的学习就来了。我们不仅可以通过这种方式学习新技能，还可以做一些非常酷的项目！数据科学的成功在于不断学习，将新技术添加到您的技能组合中，并找出不同任务的最佳方法。在这里，我们展示了贝叶斯推理如何让我们更新我们的信念来解释新的证据，以便更好地模拟现实。随着我们收集更多的证据，我们需要不断调整我们的预测，贝叶斯方程为我们提供了合适的框架。</p><p id="79bf" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一如既往，我欢迎反馈、讨论和建设性的批评。可以通过 Twitter <a class="ae kw" href="https://twitter.com/koehrsen_will" rel="noopener ugc nofollow" target="_blank"> @koehrsen_will </a>找到我。</p></div></div>    
</body>
</html>