<html>
<head>
<title>Is a Chinese restaurant’s name predictive of its quality?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一家中国餐馆的名字能预示它的质量吗？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/is-a-chinese-restaurants-name-predictive-of-its-quality-594d9f0cc0f2?source=collection_archive---------13-----------------------#2018-12-24">https://towardsdatascience.com/is-a-chinese-restaurants-name-predictive-of-its-quality-594d9f0cc0f2?source=collection_archive---------13-----------------------#2018-12-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="eb21" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我经常路过一家叫华龙的中国餐馆。这就是华龙的样子。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/6834de04e81af7b82e6bde69dd697f30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i_wtY361nGXX6CBSO9CSTg.jpeg"/></div></div></figure><p id="a013" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">住在纽约，我们都知道这家餐厅。过于复杂的菜单。看起来像是在 70 年代拍摄的普通食物照片。但对我来说，我可以通过<em class="kx">这个名字来感受一下。“</em>华龙”就是听起来不好。因此，自然而然地，我决定建立一个快速模型，看看一家中国餐馆的名字能否预测它的质量。</p></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><p id="05d8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我用 Yelp 的 API 抓取了纽约 1000 家中餐馆的数据(一些报道称纽约总共有<a class="ae lf" href="https://newyork.cbslocal.com/2011/01/19/grubb-snub-new-survey-poo-poos-nyc-chinese-food/" rel="noopener ugc nofollow" target="_blank"> ~6000 家中餐馆</a>)。为了简单起见，我们来定义一个“好”的餐馆，它有超过 10 个评论和至少 4 星的评级。使用这个定义，我们数据集中大约 40%的餐馆是“好”的。</p><h2 id="6273" class="lg lh iq bd li lj lk dn ll lm ln dp lo jy lp lq lr kc ls lt lu kg lv lw lx ly bi translated">用的最多的词是什么？</h2><p id="8c54" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">纽约中餐馆名称中最常见的单词是:</p><blockquote class="me"><p id="a8d5" class="mf mg iq bd mh mi mj mk ml mm mn kk dk translated"><em class="mo">餐厅:194 <br/>中餐:145 <br/>厨房:100 <br/>新:71 <br/>花园:69 </em></p></blockquote><p id="9cf6" class="pw-post-body-paragraph jn jo iq jp b jq mp js jt ju mq jw jx jy mr ka kb kc ms ke kf kg mt ki kj kk ij bi translated">在我们的数据集中，近 20%的中国餐馆直接在标题中包含“餐馆”一词。如果说中国人有什么不同的话，那就是他们说到点子上了。其他一些熟悉的词也在这里，像“花园”和“黄金”。</p><p id="689d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们也来看看最热门的两个单词短语(如果你喜欢，也可以称之为<em class="kx">双字母组合</em>):</p><blockquote class="me"><p id="8ad2" class="mf mg iq bd mh mi mj mk ml mm mn kk dk translated"><em class="mo">中餐厅:79 <br/>中厨房:17 <br/>港:16 <br/> xi 安:13 <br/>名吃:13 </em></p></blockquote><p id="9801" class="pw-post-body-paragraph jn jo iq jp b jq mp js jt ju mq jw jx jy mr ka kb kc ms ke kf kg mt ki kj kk ij bi translated">这个数据稍微稀疏一点，而且也在挑选知名品牌，比如西安名吃。为了简单起见，我们不会在模型中包含二元模型。</p><h2 id="1d97" class="lg lh iq bd li lj lk dn ll lm ln dp lo jy lp lq lr kc ls lt lu kg lv lw lx ly bi translated">训练模型</h2><p id="f87d" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">我们现在有了训练预测模型所需的组件:<em class="kx">目标</em>(如果一家餐馆是“好”的，即二进制分类)和<em class="kx">特征</em>(一个单词在餐馆名称中的出现)。作为最后一个转换步骤，我们将对名称应用一个<a class="ae lf" href="https://en.wikipedia.org/wiki/Tf%E2%80%93idf" rel="noopener ugc nofollow" target="_blank"> tf-idf 转换</a>。这增加了一点权重，应该有助于提高性能，特别是通过降低总出现次数很多的单词的等级。最后，我们将在数据上拟合一个<a class="ae lf" href="https://www.youtube.com/watch?v=1NxnPkZM9bc" rel="noopener ugc nofollow" target="_blank">支持向量机(SVM) </a>，一个文本分类问题的标准模型。</p><p id="9d96" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Python 的<code class="fe mu mv mw mx b">sklearn</code>库中方便的<code class="fe mu mv mw mx b">Pipeline</code>类使这变得非常简单:</p><p id="b821" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mu mv mw mx b">X_train, X_test, y_train, y_test = train_test_split(data.name, data.is_good, test_size=0.2, random_state=42)<br/>clf = Pipeline([<br/> (‘vect’, CountVectorizer()),<br/> (‘tfidf’, TfidfTransformer()),<br/> (‘clf’, SGDClassifier(random_state=42))<br/>])<br/>clf.fit(X_train, y_train)</code></p><p id="5741" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">评估预测模型有效性的常用指标是<a class="ae lf" href="https://developers.google.com/machine-learning/crash-course/classification/roc-and-auc" rel="noopener ugc nofollow" target="_blank"> AUC 得分</a>。该模型的 AUC 值为 0.60，这并不惊人，但也不可怕。这意味着，如果模型按照从最差到最差的顺序排列所有餐馆，那么一家真正好的餐馆往往会排在一家真正差的餐馆之前。</p><h2 id="1919" class="lg lh iq bd li lj lk dn ll lm ln dp lo jy lp lq lr kc ls lt lu kg lv lw lx ly bi translated">有哪些具体的词具有预测性？</h2><p id="9169" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">像 SVM 这样的线性模型的好处在于它们是可以解释的。我们可以检查模型应用于每个单词的权重，以感受每个单词的“预测”程度。</p><p id="cc85" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">“好”中餐馆最具预测性的词汇(过滤掉出现过的词汇&lt;10 times) are:</p><blockquote class="me"><p id="26da" class="mf mg iq bd mh mi mj mk ml mm mn kk dk translated"><em class="mo">美食<br/>饺子<br/>孔<br/>亚洲<br/>炒锅</em></p></blockquote><p id="778c" class="pw-post-body-paragraph jn jo iq jp b jq mp js jt ju mq jw jx jy mr ka kb kc ms ke kf kg mt ki kj kk ij bi translated">最消极的预测词是:</p><blockquote class="me"><p id="c0cc" class="mf mg iq bd mh mi mj mk ml mm mn kk dk translated">g <em class="mo"> olden <br/> wah <br/>餐厅<br/>北京<br/> lee </em></p></blockquote><p id="639f" class="pw-post-body-paragraph jn jo iq jp b jq mp js jt ju mq jw jx jy mr ka kb kc ms ke kf kg mt ki kj kk ij bi translated">我想“烹饪”比“餐馆”更有品位。我知道“黄金”是垃圾！</p><h2 id="0029" class="lg lh iq bd li lj lk dn ll lm ln dp lo jy lp lq lr kc ls lt lu kg lv lw lx ly bi translated">什么是好名字？</h2><p id="0946" class="pw-post-body-paragraph jn jo iq jp b jq lz js jt ju ma jw jx jy mb ka kb kc mc ke kf kg md ki kj kk ij bi translated">最后，为了好玩，我构建了一个小脚本，它随机生成中国餐馆名称(使用我们在训练集中构建的词汇)，并返回模型预测的第一个好餐馆名称。剧本找到的我的最爱？</p><blockquote class="me"><p id="c516" class="mf mg iq bd mh mi mj mk ml mm mn kk dk translated"><em class="mo">超级卡西<br/>黄门<br/>周大叔<br/>大胖子</em></p></blockquote><p id="a7eb" class="pw-post-body-paragraph jn jo iq jp b jq mp js jt ju mq jw jx jy mr ka kb kc ms ke kf kg mt ki kj kk ij bi translated">哪天带我去<em class="kx"> Great Fatt </em>。</p></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><p id="c102" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">回到华龙，我经常路过的餐馆…它在 Yelp 上有 3.5 的评分和 20 条评论。模特是怎么想的？</p><p id="341f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mu mv mw mx b">&gt;&gt; model.predict(model_vect.transform(['hua long']))[0]<br/>False</code></p><p id="a863" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">#mlforthewin</p><p id="70d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">笔记本在<a class="ae lf" href="https://github.com/kning/blog_posts/blob/master/chinese_restaurants/name-prediction.ipynb" rel="noopener ugc nofollow" target="_blank"> github </a>上。</p></div></div>    
</body>
</html>