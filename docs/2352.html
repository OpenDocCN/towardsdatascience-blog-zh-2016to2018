<html>
<head>
<title>Kaggle Planet Competition: How to land in top 4%</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Kaggle 星球大赛:如何登陆前 4%</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/kaggle-planet-competition-how-to-land-in-top-4-a679ff0013ba?source=collection_archive---------2-----------------------#2018-01-14">https://towardsdatascience.com/kaggle-planet-competition-how-to-land-in-top-4-a679ff0013ba?source=collection_archive---------2-----------------------#2018-01-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c5cc17b2a0ae08be204279d3b13a7617.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eWPDDgBx_h4IFpk7bBQIhw.png"/></div></div></figure><p id="ccb2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这篇博文中，我们将学习如何在著名的 Kaggle 竞赛“<a class="ae kw" href="https://www.kaggle.com/c/planet-understanding-the-amazon-from-space" rel="noopener ugc nofollow" target="_blank">星球:从太空了解亚马逊</a>”中取得世界级的成绩。</p><p id="fc28" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kx">博客中使用的技术是通用的，可以应用于任何其他需要物体检测的问题。这些技巧都在</em><a class="ae kw" href="http://forums.fast.ai/t/unofficial-release-of-part-1-v2/9285" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir"><em class="kx">fast . ai deep learning MOOC</em></strong></a><em class="kx">中有所教授。在本教程中，我们将使用基于 PyTorch 构建的</em><a class="ae kw" href="https://github.com/fastai/fastai" rel="noopener ugc nofollow" target="_blank"><em class="kx">fastai</em></a><em class="kx">deep learning 库。</em></p><h1 id="bcdf" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">下载比赛数据</h1><p id="7c7a" class="pw-post-body-paragraph jy jz iq ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">让我们开始吧，登录 Kaggle 账号，前往<a class="ae kw" href="https://www.kaggle.com/c/planet-understanding-the-amazon-from-space" rel="noopener ugc nofollow" target="_blank">竞赛页面</a>，接受竞赛规则，前往<em class="kx">数据</em>标签，下载以下文件。</p><ul class=""><li id="dca8" class="mb mc iq ka b kb kc kf kg kj md kn me kr mf kv mg mh mi mj bi translated"><em class="kx">sample _ submission _ v2 . CSV . zip</em></li><li id="3f05" class="mb mc iq ka b kb mk kf ml kj mm kn mn kr mo kv mg mh mi mj bi translated"><em class="kx">test-jpg-additional . tar . 7z</em></li><li id="924d" class="mb mc iq ka b kb mk kf ml kj mm kn mn kr mo kv mg mh mi mj bi translated"><em class="kx"> test-jpg.tar.7z </em></li><li id="07ff" class="mb mc iq ka b kb mk kf ml kj mm kn mn kr mo kv mg mh mi mj bi translated"><em class="kx"> train-jpg.tar.7z </em></li><li id="c7af" class="mb mc iq ka b kb mk kf ml kj mm kn mn kr mo kv mg mh mi mj bi translated"><em class="kx"> train_v2.csv.zip </em></li></ul><p id="ee2d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们可以使用<strong class="ka ir"><em class="kx">k</em></strong><a class="ae kw" href="https://github.com/floydwch/kaggle-cli" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir"><em class="kx">aggle-cl</em></strong></a><strong class="ka ir"><em class="kx">I</em></strong>下载文件，这在你使用 AWS、Paperspace 等云 VM 实例时很有用。要使用<strong class="ka ir"> <em class="kx"> kaggle-cli </em> </strong>下载文件，请使用以下命令。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="04a2" class="my kz iq mu b gy mz na l nb nc">$ kg download -u &lt;username&gt; -p &lt;password&gt; -c planet-understanding-the-amazon-from-space -f &lt;name of file&gt;</span></pre><p id="e7e8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">其中<code class="fe nd ne nf mu b">planet-understanding-the-amazon-from-space</code>是比赛名称，你可以在比赛 URL 的末尾<code class="fe nd ne nf mu b"> /c/ </code>部分<code class="fe nd ne nf mu b"><a class="ae kw" href="https://www.kaggle.com/c/planet-understanding-the-amazon-from-space" rel="noopener ugc nofollow" target="_blank">https://www.kaggle.com/c/planet-understanding-the-amazon-from-spac</a>e</code>后找到比赛名称。还有另一个很棒的 Chrome 扩展<em class="kx"/><strong class="ka ir"><em class="kx">Curl Widget</em></strong>下载云实例上的数据。你可以在这里<a class="ae kw" href="http://Builds a command line for 'curl/wget' tools to enable the download of data on a console only session." rel="noopener ugc nofollow" target="_blank">查看</a>。</p><p id="35d4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">文件下载完成后，我们可以使用以下命令提取文件。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="ecf4" class="my kz iq mu b gy mz na l nb nc">#To extract .7z files<br/>7z x -so &lt;file_name&gt;.7z | tar xf -</span><span id="ff02" class="my kz iq mu b gy ng na l nb nc">#To extract.zip files<br/>unzip &lt;file_name&gt;.zip</span></pre><p id="f5fa" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一旦提取完成，将所有文件从文件夹<code class="fe nd ne nf mu b">test-jpg-additional</code>移动到<code class="fe nd ne nf mu b">test-jpg</code>。</p><p id="031b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们的数据准备好了。让我们开始构建模型。</p><h1 id="aa4e" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">初始模型</h1><p id="508f" class="pw-post-body-paragraph jy jz iq ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated"><em class="kx">注意:只有重要的代码片段显示在这篇博文中，完整的笔记本在这里</em><a class="ae kw" href="https://github.com/irshadqemu/Kaggle-Competitions/blob/master/Planet_amazon_resnet34.ipynb" rel="noopener ugc nofollow" target="_blank"><em class="kx"/></a><em class="kx">。</em></p><ul class=""><li id="b303" class="mb mc iq ka b kb kc kf kg kj md kn me kr mf kv mg mh mi mj bi translated">如果你看了比赛的评价标准，你会知道它是基于<a class="ae kw" href="https://clusteval.sdu.dk/1/clustering_quality_measures/5" rel="noopener ugc nofollow" target="_blank"> f2 分数</a>。我们相应地为模型定义度量。我们将使用由微软公布的<a class="ae kw" href="https://arxiv.org/pdf/1512.03385.pdf" rel="noopener ugc nofollow" target="_blank">深度剩余模型<strong class="ka ir"> renet34 </strong>的预训练实现。</a></li></ul><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nh"><img src="../Images/14e8de5edb4e5d4153ac5fb5eaf60e6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FXDETSJm1VF7qOd6QTehhw.png"/></div></div></figure><p id="813b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">获取 20%的可用训练数据作为验证数据，并加载预训练模型。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/698302c736996946233d08c1a90c72cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3jVEyvJ1_m9eX3EBP0QgIw.png"/></div></div></figure><h2 id="73e2" class="my kz iq bd la nj nk dn le nl nm dp li kj nn no lm kn np nq lq kr nr ns lu nt bi translated">寻找学习率</h2><p id="054e" class="pw-post-body-paragraph jy jz iq ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">学习率是该模型最重要的超参数之一。它决定了模型学习的快慢。如果 LR 太高，模型将试图学习得太快，损失函数将不收敛。如果 LR 太低，模型将需要太长时间才能收敛。</p><p id="b0ac" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用 fastai 库找到一个好的学习率非常容易，只需运行下面两行代码。(<em class="kx">它有助于使用研究论文</em> <a class="ae kw" href="https://arxiv.org/abs/1608.03983" rel="noopener ugc nofollow" target="_blank"> <em class="kx">中介绍的技术找到 LR，用于训练神经网络</em> </a>的循环学习率)</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/7d4329e00dfa5da9480db235449f0e27.png" data-original-src="https://miro.medium.com/v2/resize:fit:678/format:webp/1*AWpz-ruplxN1PsCwh1LsZQ.png"/></div></figure><p id="4496" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这将绘制 LR 对损失函数的曲线图。LR 的一个好值是损失函数斜率最高的地方。正如我们所见，斜率在 0.1 左右最高，您可以使用任何接近它的值。用 0.1 左右的几个值进行实验，以找到 LR 的最佳值，这将是一个好主意。在尝试了几个值之后，0.2 似乎对我最有效。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nv"><img src="../Images/c31547b9904494a613d14a3b06c9d449.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rzlllHN5l7dQcufHk9RliA.png"/></div></div></figure><h2 id="3299" class="my kz iq bd la nj nk dn le nl nm dp li kj nn no lm kn np nq lq kr nr ns lu nt bi translated">训练模型</h2><p id="c13f" class="pw-post-body-paragraph jy jz iq ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">比赛中的芯片总尺寸为 256X256，我们开始用 64x64 来训练我们的模型，并将随着训练的进展逐渐增加图像的尺寸<em class="kx">。这是避免过度拟合的非常好的技术。</em></p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nw"><img src="../Images/34478627f9f102e283838a07a1a8b302.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*md0v7M1fXL_BPasDT2ERZw.png"/></div></div></figure><p id="dbac" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">输出具有以下格式</p><p id="fdbb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe nd ne nf mu b">[ &lt;epoch_number&gt; &lt;train loss&gt; &lt;val loss&gt; &lt;val set f2 score&gt;]</code></p><p id="9ef6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们试着轻描淡写一下<code class="fe nd ne nf mu b">fit function</code>。在训练模型时<em class="kx"> fastai </em>实现了一种叫做<em class="kx">带重启的随机梯度下降(SGDR)的技术(</em> <a class="ae kw" href="https://arxiv.org/abs/1608.03983" rel="noopener ugc nofollow" target="_blank"> <em class="kx">论文链接</em> </a> <em class="kx">)。</em>它在循环中训练模型，其中每个循环由一个或多个时期组成。对于每个周期，它从给定的 LR 值开始，并将随着训练的进行而指数地降低 LR ( <em class="kx">指数学习速率表</em>)。拟合中的第二个参数表示循环总数。一个循环中的总次数由以下两个参数<code class="fe nd ne nf mu b">cycle_len</code>和<code class="fe nd ne nf mu b">cycle_mult</code>控制。</p><p id="283f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe nd ne nf mu b">epochs in first cycle = cycle_len <br/>epochs in second cycle = epochs in previous(first) cycle x cycle_mult<br/>epochs in third cycle = epochs in previous(second) cycle x cycle_mult</code> <br/>这是显示每个周期 LR 变化的图表。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nx"><img src="../Images/3fb3ffa654c1fa2487b7e36914bbc9bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d5QmE_tv4jtm7jrgVasTWQ.png"/></div></div></figure><p id="102f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">解冻所有图层，并为图层设置不同的学习速率</strong></p><p id="df4d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">默认情况下，<code class="fe nd ne nf mu b">fastai</code>将冻结所有图层的权重，除了最后几个图层和它添加的用于微调给定数据集模型的图层。(<em class="kx">有 Keras 背景的数据科学家会欣赏这个，不需要</em> <code class="fe nd ne nf mu b"><em class="kx">model.pop</em></code> <em class="kx">、</em> <code class="fe nd ne nf mu b"><em class="kx">model.add</em></code> <em class="kx">、</em><code class="fe nd ne nf mu b"><em class="kx">model.layers[index].trainable=False</em></code><em class="kx"/><code class="fe nd ne nf mu b"><em class="kx">model.compile</em></code>……)</p><p id="4be3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以在上述时代，所有的学习都是由那些解冻的最后一层完成的。<br/>接下来，我们将解冻所有层的权重，以提高模型的准确性。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ny"><img src="../Images/45ce0a83d0377cb0c7bfe31a6ccac06d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tjz55Yvqn8-vwCLLj9s9qQ.png"/></div></div></figure><p id="6851" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你给<em class="kx"> fastai </em>一个 3 元素的数组，它会把层分成 3 组，【&lt;初始卷积层&gt;，&lt;剩余卷积层&gt;，&lt;最后完全连接层&gt;。对于每个集合，它将使用数组中相应的值。</p><p id="37f2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在 CNN 的初始层学习寻找简单的特征(如边缘，颜色渐变，角落),这些特征对行星数据集同样有帮助。因此，我们对它们使用最低的 LR。CNN 的更高层学习寻找复杂的特征(像几何图案、脸、特定物体等)。更高层的 LR 值的增加将有助于它们更快地适应给定的数据集。</p><p id="8370" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如您从输出中看到的，我们的模型已经开始过度适应。我将在这里停止训练，并将训练图像大小增加到 128x128。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nz"><img src="../Images/568219e11c3a040a9d23f7b6cdbcb8e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l4wjRSfEyktPsT7R3eZ5rg.png"/></div></div></figure><p id="d544" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">同样，通过将图像大小增加到 256x256 来训练模型。这将结束模型的训练阶段。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oa"><img src="../Images/b4e60818130cdaed94aaeb246b75c793.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6C7dFX_2UWorwZ8DYNR4rg.png"/></div></div></figure><p id="c156" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kx"> fastai </em>还有一个非常好的特性叫做<strong class="ka ir">测试时间增强(TTA) </strong>。这个想法很简单；对每个测试图像应用简单的增强以生成它的五个副本，然后对每个副本进行预测。您可以对这些预测进行平均，以显著降低误差(1–2%)。正如您在下面的代码中看到的，使用 TTA，F2 分数从 0.928 增加到 0.930。这是一个很好的分数。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ob"><img src="../Images/07f43dae5f488bb46a44cc91d5f80dab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z4g54iPaHcPUOlDo1BUwhw.png"/></div></div></figure><h1 id="766c" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated"><strong class="ak">第一次提交给 Kaggle </strong></h1><p id="7536" class="pw-post-body-paragraph jy jz iq ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">在提交文件中，我们需要对每个图像放置预测标签。每个图像可以属于多个类别。</p><p id="6287" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe nd ne nf mu b">file_10770,agriculture clear cultivation primary road test_26732,agriculture clear cultivation haze primary</code></p><p id="fcb3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您查看我们的验证集(下图)中的预测示例，您会看到我们的原始标签是 1 和 0 的形式，但我们的预测是浮点数。因此，我们需要为提交文件中包含的预测选择一个阈值(0.66 对于下面的例子是理想的)。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oc"><img src="../Images/f991f5e5ac742ce2bbcf090e3ac3d96a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zJbAA2V9czHXi5e4q2wbGQ.png"/></div></div></figure><p id="2092" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe nd ne nf mu b">op_th </code>函数在给定范围内尝试多个阈值，并返回使 F2 分数最大化的阈值。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi od"><img src="../Images/7de139e0e9d4c91e67f105ae7c235fe2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f5-qVwWPQxwoKjPyPz0JbQ.png"/></div></div></figure><p id="f1ae" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们有了最佳阈值，让我们生成一个提交文件</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oe"><img src="../Images/7bd90eb629a5fe55a4ade75d588b5f55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*msL4hEnrSuo8NPfiCEJMcw.png"/></div></div></figure><p id="8045" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是 Kaggle 的提交结果。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi of"><img src="../Images/098942714f4d6820d95ae8a20895f83b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TpDhBn3ybvE90xzNPyW__w.png"/></div></div></figure><p id="2b95" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">私人得分 0.92997 将使我们在 938 名中排名第 65 位。这款最初的车型本应排在<strong class="ka ir">前 7%。这是相当大的成就。让我们进一步改进它。</strong></p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi og"><img src="../Images/9b4f54bee40ca7afd4a401e126b697c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZRQ-5G-qIUSL7tC4R2T8rA.png"/></div></div><figcaption class="oh oi gj gh gi oj ok bd b be z dk">Private leader board of Kaggle planet competition.</figcaption></figure><h1 id="6b92" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">组装</h1><p id="c73c" class="pw-post-body-paragraph jy jz iq ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">我的下一个目标是进入前 5%。我训练了 5 个 resnet34 模型。每个模型的训练集由 90%的可用训练数据和剩余的 10 %数据组成，作为验证集。我还对每个模型的训练集应用了略有不同的数据扩充。这是所有模特的 F2 分数。</p><pre class="mp mq mr ms gt mt mu mv mw aw mx bi"><span id="7c64" class="my kz iq mu b gy mz na l nb nc">f2 Score: 0.9285756738073999                 <br/>f2 Score: 0.9325735931488134                 <br/>f2 Score: 0.9345646226806884                 <br/>f2 Score: 0.9331467241762751                 <br/>f2 Score: 0.9349772800026489</span></pre><p id="55ee" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">看到这一点后，我对职位的提高充满了希望。我准备了提交文件，并提交给 Kaggle。这是结果。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ol"><img src="../Images/a900f1773d22c29b409ac34eb6643e94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bQuMeD0FSNYkvHaFkjFbqQ.png"/></div></div><figcaption class="oh oi gj gh gi oj ok bd b be z dk">Kaggle submission result for ensemble</figcaption></figure><p id="3a2e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里是 Kaggle 的私人领袖板。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi om"><img src="../Images/d6013dd9ab9ebddf0138cffff69d2e2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v0t5su_z_Vedpnt72WzBeg.png"/></div></div></figure><p id="fe9f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">0.93078 的个人得分将使我们在 938 分中排在第 35 位</strong>。这是最高的 3.7%。</p><h2 id="8abe" class="my kz iq bd la nj nk dn le nl nm dp li kj nn no lm kn np nq lq kr nr ns lu nt bi translated">所以我们进入了前 4%。目标实现</h2><p id="8419" class="pw-post-body-paragraph jy jz iq ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated"><em class="kx">代码为合奏可以在</em> <a class="ae kw" href="https://github.com/irshadqemu/Kaggle-Competitions/blob/master/Planet_amazon_resnet34.ipynb" rel="noopener ugc nofollow" target="_blank"> <em class="kx">这里找到</em> </a> <em class="kx">或者便签本底部。</em></p></div><div class="ab cl on oo hu op" role="separator"><span class="oq bw bk or os ot"/><span class="oq bw bk or os ot"/><span class="oq bw bk or os"/></div><div class="ij ik il im in"><h1 id="201f" class="ky kz iq bd la lb ou ld le lf ov lh li lj ow ll lm ln ox lp lq lr oy lt lu lv bi translated">如何进一步提高</h1><p id="d160" class="pw-post-body-paragraph jy jz iq ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">我将给你留下进一步改进的建议。</p><ul class=""><li id="5113" class="mb mc iq ka b kb kc kf kg kj md kn me kr mf kv mg mh mi mj bi translated"><strong class="ka ir">找到阈值的更好方法:</strong>在准备提交文件时，我使用了大约 0.2 的阈值来为所有测试图像选择类别，但理想情况下，每个测试图像都应该有一个独立的阈值，具体取决于模型的预测值。我尝试训练一个 ML 模型来寻找更好的阈值，但没有成功。(<em class="kx">代码在笔记本</em></li><li id="d321" class="mb mc iq ka b kb mk kf ml kj mm kn mn kr mo kv mg mh mi mj bi translated"><strong class="ka ir">找出模型预测错误的类别:</strong>从验证集预测中，您可以找出模型预测最不正确的类别。您可以在训练集中引入这些类的多个稍微扩充的副本。</li><li id="c6dd" class="mb mc iq ka b kb mk kf ml kj mm kn mn kr mo kv mg mh mi mj bi translated"><strong class="ka ir">用 tiff 代替 jpg: </strong>对于相同数量的图像，tiff 格式的训练数据集大小为 12.87 GB，而 jpg 格式的大小仅为 600MB，因此很明显 tiff 数据比 jpg 包含更多的信息。这必将有助于进一步改进模型。</li><li id="cec8" class="mb mc iq ka b kb mk kf ml kj mm kn mn kr mo kv mg mh mi mj bi translated"><strong class="ka ir">尝试其他架构:</strong>我只用过 resnet34 型号，它们是很多其他高级型号，比如 resnet50，resent101。你可以尝试这些。</li><li id="5561" class="mb mc iq ka b kb mk kf ml kj mm kn mn kr mo kv mg mh mi mj bi translated"><strong class="ka ir">减少过拟合:</strong>如果你在笔记本上看集合训练的输出，你会知道我的一些模型在训练时开始过拟合。您可以尝试提前停止或退出，以减少过度拟合。</li><li id="f794" class="mb mc iq ka b kb mk kf ml kj mm kn mn kr mo kv mg mh mi mj bi translated"><strong class="ka ir">训练多个 CNN 架构的系综:</strong>在准备系综的时候，我只用过 resnet34 的系综。您可以准备一个包括多种架构的系综，如 resnet50、resnet101 等。</li></ul><p id="6208" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你喜欢读这篇文章，请鼓掌。:-)</p></div><div class="ab cl on oo hu op" role="separator"><span class="oq bw bk or os ot"/><span class="oq bw bk or os ot"/><span class="oq bw bk or os"/></div><div class="ij ik il im in"><div class="mp mq mr ms gt oz"><a href="https://github.com/irshadqemu/Kaggle-Competitions/blob/master/Planet_amazon_resnet34.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="pa ab fo"><div class="pb ab pc cl cj pd"><h2 class="bd ir gy z fp pe fr fs pf fu fw ip bi translated">irshadqemu/ka ggle-竞赛</h2><div class="pg l"><h3 class="bd b gy z fp pe fr fs pf fu fw dk translated">Kaggle-竞赛-我的 ka ggle 竞赛笔记本</h3></div><div class="ph l"><p class="bd b dl z fp pe fr fs pf fu fw dk translated">github.com</p></div></div><div class="pi l"><div class="pj l pk pl pm pi pn jw oz"/></div></div></a></div></div></div>    
</body>
</html>