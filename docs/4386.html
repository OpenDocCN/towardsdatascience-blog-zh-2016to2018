<html>
<head>
<title>Clustering algorithms for customer segmentation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">客户细分的聚类算法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/clustering-algorithms-for-customer-segmentation-af637c6830ac?source=collection_archive---------1-----------------------#2018-08-13">https://towardsdatascience.com/clustering-algorithms-for-customer-segmentation-af637c6830ac?source=collection_archive---------1-----------------------#2018-08-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/4053b648a26e25775830b6eda44932c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*caijLPswjk1R_GaNtM8jRg.jpeg"/></div></div></figure><p id="d80c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">上下文</strong> <br/>在当今竞争激烈的世界，了解客户行为并根据其人口统计和购买行为对客户进行分类至关重要。这是客户细分的一个重要方面，它允许营销人员在促销、营销和产品开发策略方面更好地针对各种受众群调整营销工作。</p><p id="986b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">目标</strong> <br/>这篇文章展示了使用 python 中的 k-means 聚类对电子商务网站的客户数据集<a class="ae kz" href="https://github.com/sowmyacr/kmeans_cluster/blob/master/CLV.csv" rel="noopener ugc nofollow" target="_blank">进行细分的概念。数据集包含大约 300 名客户的<strong class="kd iu"> <em class="la">年收入</em> </strong>和他们在电子商务网站上的<strong class="kd iu"> <em class="la">年支出</em> </strong>。我们将使用 k-means 聚类算法得出最佳聚类数，并根据提供的数据了解潜在的客户群。</a></p><p id="694a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">关于数据集</strong> <br/>数据集由 303 名客户的年收入(以 000 美元计)和他们一年内在电子商务网站上的总支出(以 000 美元计)组成。让我们使用 python 中的<em class="la"> numpy </em>和<em class="la"> pandas </em>库来研究这些数据。</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="544a" class="lk ll it lg b gy lm ln l lo lp">#<strong class="lg iu">Load the required packages</strong><br/>import numpy as np<br/>import pandas as pd<br/>import matplotlib.pyplot as plt</span><span id="8bc7" class="lk ll it lg b gy lq ln l lo lp">#<strong class="lg iu">Plot styling</strong><br/>import seaborn as sns; sns.set()  # for plot styling<br/>%matplotlib inline</span><span id="fbbb" class="lk ll it lg b gy lq ln l lo lp">plt.rcParams['figure.figsize'] = (16, 9)<br/>plt.style.use('ggplot')</span><span id="fdae" class="lk ll it lg b gy lq ln l lo lp">#<strong class="lg iu">Read the csv file</strong><br/>dataset=pd.read_csv('CLV.csv')</span><span id="5a2e" class="lk ll it lg b gy lq ln l lo lp">#<strong class="lg iu">Explore the dataset</strong><br/>dataset.head()#top 5 columns<br/>len(dataset) # of rows</span><span id="c461" class="lk ll it lg b gy lq ln l lo lp">#<strong class="lg iu">descriptive statistics of the dataset</strong><br/>dataset.describe().transpose()<br/></span></pre><figure class="lb lc ld le gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lr"><img src="../Images/1039b099cb6817c0569c8012df5db98e.png" data-original-src="https://miro.medium.com/v2/resize:fit:496/format:webp/1*_k0qUYYBKtqIP1K250FLUw.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk">dataset.head()</figcaption></figure><figure class="lb lc ld le gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lw"><img src="../Images/95e9f318ac5e71c9a38aa46d0cb5ffef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IUFpXVjr2yLFSsnOHy_Olg.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk">dataset.describe().transpose()</figcaption></figure><p id="d04a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">数据集由 303 行组成。平均年收入为 245000 英镑，平均年支出为 149000 英镑。年收入和年支出的分布用<em class="la"> distplot </em>和<em class="la"> violinplot </em>表示。</p><p id="8bc0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">可视化数据<br/></strong>disp plot 和 violinplot 显示收入和支出的数据分布。</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="8086" class="lk ll it lg b gy lm ln l lo lp"><strong class="lg iu">#Visualizing the data - displot</strong><br/>plot_income = sns.distplot(dataset["INCOME"])<br/>plot_spend = sns.distplot(dataset["SPEND"])<br/>plt.xlabel('Income / spend')</span></pre><figure class="lb lc ld le gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lx"><img src="../Images/2f6dc0847ffc7c337e9fba19485cd2e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sC7cuxrqdorH2gHcKkAhWQ.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk">Distribution plot of Income &amp; Spend</figcaption></figure><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="8d39" class="lk ll it lg b gy lm ln l lo lp"><strong class="lg iu">#Violin plot of Income and Spend</strong><br/>f, axes = plt.subplots(1,2, figsize=(12,6), sharex=True, sharey=True)<br/>v1 = sns.violinplot(data=dataset, x='INCOME', color="skyblue",ax=axes[0])<br/>v2 = sns.violinplot(data=dataset, x='SPEND',color="lightgreen", ax=axes[1])<br/>v1.set(xlim=(0,420))</span></pre><figure class="lb lc ld le gt ju gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/755b734740187ed16927116ff843cb58.png" data-original-src="https://miro.medium.com/v2/resize:fit:1372/format:webp/1*5Dq6aejpkykOlW09S3zvag.png"/></div></figure><p id="4122" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">聚类基础<br/> </strong>聚类是一种无监督的机器学习技术，其中没有定义的因变量和自变量。数据中的模式用于识别/分组相似的观察结果。</p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lz"><img src="../Images/ef5b9c10b960a7f51c12a9c9f3155de3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s4vg39ytHTcqkEqlMrzM2Q.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk">Original Dataset</figcaption></figure><figure class="lb lc ld le gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lz"><img src="../Images/4f660a0585617dffb735586a42fad1c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SXcE6t7yM9_QAp3NO4VXSQ.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk">After Clustering</figcaption></figure><p id="90a6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">任何聚类算法的目标都是确保一个聚类中数据点之间的距离与两个聚类之间的距离相比非常小。换句话说，一个群体的成员非常相似，而不同群体的成员极其不相似。</p><p id="861d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们将使用 are k-means 聚类来根据客户的收入和支出数据创建客户细分。</p><p id="bfe1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">K-均值聚类</strong><br/>K-均值聚类是一种迭代聚类算法，其中聚类数 K 是预先确定的，并且该算法基于特征相似性迭代地将每个数据点分配给 K 个聚类之一。</p><p id="edc2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">k 均值算法的主要步骤</strong></p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ma"><img src="../Images/38fa4cc3d2ffc36a33ec4599d6cfbdda.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dcWOeMRD1JMAoe7O9Ien0Q.png"/></div></div></figure><p id="0857" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">聚类的数学方法</strong></p><p id="44ca" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">聚类背后的数学原理，简单来说，就是最小化聚类质心与其相关数据点之间距离的平方和:</p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/81539c3478b0c19b0ead9e32015d8edd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*WClEcQuJiKDSTDojrfCtgA.png"/></div></figure><ul class=""><li id="6d13" class="mc md it kd b ke kf ki kj km me kq mf ku mg ky mh mi mj mk bi translated"><em class="la"> K </em> =集群的数量</li><li id="7085" class="mc md it kd b ke ml ki mm km mn kq mo ku mp ky mh mi mj mk bi translated"><em class="la"> N </em> =数据点的数量</li><li id="76aa" class="mc md it kd b ke ml ki mm km mn kq mo ku mp ky mh mi mj mk bi translated"><em class="la">C</em>=群集 j 的质心</li><li id="c5f2" class="mc md it kd b ke ml ki mm km mn kq mo ku mp ky mh mi mj mk bi translated">(<em class="la">xij—CJ</em>)–数据点与其被分配的质心之间的距离</li></ul><p id="e2f4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">确定最佳聚类数“K”<br/></strong>K-means 聚类的主要输入是聚类数。这是使用<strong class="kd iu"> <em class="la">最小化平方(WCSS) </em> </strong>内聚类和的概念导出的。创建一个 scree 图，它在 X 轴上绘制聚类数，在 y 轴上绘制每个聚类数的 WCSS。</p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mq"><img src="../Images/ff1bedde006023d2f973d03d7991a97d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8NUJhICQPZYZmWrk5wnufQ.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk">Scree plot / Elbow method to determine optimum number of clusters</figcaption></figure><p id="c944" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">随着星团数量的增加，WCSS 不断减小。WCSS 的下降最初是陡峭的，然后下降的速率变慢，导致肘形图。弯头形成处的簇数通常给出了最佳簇数的指示。应该结合对业务需求的具体了解来决定最佳集群数量。</p><p id="1792" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">对于我们的数据集，我们将使用肘方法得出最佳聚类数:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="ea7f" class="lk ll it lg b gy lm ln l lo lp"><strong class="lg iu">#Using the elbow method to find the optimum number of clusters</strong><br/>from sklearn.cluster import KMeans<br/>wcss = []<br/>for i in range(1,11):<br/>    km=KMeans(n_clusters=i,init='k-means++', max_iter=300, n_init=10, random_state=0)<br/>    km.fit(X)<br/>    wcss.append(km.inertia_)<br/>plt.plot(range(1,11),wcss)<br/>plt.title('Elbow Method')<br/>plt.xlabel('Number of clusters')<br/>plt.ylabel('wcss')<br/>plt.show()</span></pre><figure class="lb lc ld le gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mr"><img src="../Images/8a47662652e1e7a3400a1ed273155282.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lOXU_6h09IurGrwMZa2Wkg.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk">Scree plot of given datatset on customer Income &amp; Spend</figcaption></figure><p id="1e9c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">根据肘图，我们可以选择 4、5 或 6 个集群。让我们尝试集群的数量和可视化集群，以决定集群的最终数量。</p><p id="3663" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">将 k 均值拟合到 k=4 的数据集</strong></p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="e5eb" class="lk ll it lg b gy lm ln l lo lp"><strong class="lg iu">##Fitting kmeans to the dataset with k=4</strong><br/>km4=KMeans(n_clusters=4,init='k-means++', max_iter=300, n_init=10, random_state=0)<br/>y_means = km4.fit_predict(X)</span><span id="30c1" class="lk ll it lg b gy lq ln l lo lp"><strong class="lg iu">#Visualizing the clusters for k=4</strong><br/>plt.scatter(X[y_means==0,0],X[y_means==0,1],s=50, c='purple',label='Cluster1')<br/>plt.scatter(X[y_means==1,0],X[y_means==1,1],s=50, c='blue',label='Cluster2')<br/>plt.scatter(X[y_means==2,0],X[y_means==2,1],s=50, c='green',label='Cluster3')<br/>plt.scatter(X[y_means==3,0],X[y_means==3,1],s=50, c='cyan',label='Cluster4')</span><span id="949e" class="lk ll it lg b gy lq ln l lo lp">plt.scatter(km4.cluster_centers_[:,0], km4.cluster_centers_[:,1],s=200,marker='s', c='red', alpha=0.7, label='Centroids')<br/>plt.title('Customer segments')<br/>plt.xlabel('Annual income of customer')<br/>plt.ylabel('Annual spend from customer on site')<br/>plt.legend()<br/>plt.show()</span></pre><figure class="lb lc ld le gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lx"><img src="../Images/4b62745cbb2899d2e6150b7b11307914.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6BgHOm5ICoUqsxUtXpXe2A.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk">Cluster plot : k=4</figcaption></figure><p id="6cd3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">该图显示了 4 个集群的分布。我们可以将他们理解为以下客户群:</p><ol class=""><li id="21cd" class="mc md it kd b ke kf ki kj km me kq mf ku mg ky ms mi mj mk bi translated">第 1 类:中等年收入和低年支出的客户</li><li id="1e46" class="mc md it kd b ke ml ki mm km mn kq mo ku mp ky ms mi mj mk bi translated">第 2 类:年收入高、年支出中等偏高的客户</li><li id="d552" class="mc md it kd b ke ml ki mm km mn kq mo ku mp ky ms mi mj mk bi translated">第三类:年收入低的客户</li><li id="79e3" class="mc md it kd b ke ml ki mm km mn kq mo ku mp ky ms mi mj mk bi translated">第 4 类:年收入中等但年支出高的客户</li></ol><p id="8e7a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">集群 4 是一个潜在的客户群。然而，群 2 和群 3 可以被进一步细分以达到更具体的目标客户群。现在让我们来看看当 k=6 时，集群是如何创建的:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="b9f6" class="lk ll it lg b gy lm ln l lo lp"><strong class="lg iu">##Fitting kmeans to the dataset - k=6</strong><br/>km4=KMeans(n_clusters=6,init='k-means++', max_iter=300, n_init=10, random_state=0)<br/>y_means = km4.fit_predict(X)</span><span id="79a9" class="lk ll it lg b gy lq ln l lo lp"><strong class="lg iu">#Visualizing the clusters</strong><br/>plt.scatter(X[y_means==0,0],X[y_means==0,1],s=50, c='purple',label='Cluster1')<br/>plt.scatter(X[y_means==1,0],X[y_means==1,1],s=50, c='blue',label='Cluster2')<br/>plt.scatter(X[y_means==2,0],X[y_means==2,1],s=50, c='green',label='Cluster3')<br/>plt.scatter(X[y_means==3,0],X[y_means==3,1],s=50, c='cyan',label='Cluster4')<br/>plt.scatter(X[y_means==4,0],X[y_means==4,1],s=50, c='magenta',label='Cluster5')<br/>plt.scatter(X[y_means==5,0],X[y_means==5,1],s=50, c='orange',label='Cluster6')</span><span id="1fc6" class="lk ll it lg b gy lq ln l lo lp">plt.scatter(km.cluster_centers_[:,0], km.cluster_centers_[:,1],s=200,marker='s', c='red', alpha=0.7, label='Centroids')<br/>plt.title('Customer segments')<br/>plt.xlabel('Annual income of customer')<br/>plt.ylabel('Annual spend from customer on site')<br/>plt.legend()<br/>plt.show()</span></pre><figure class="lb lc ld le gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lx"><img src="../Images/9aaa03bc63c80bab196dcf42448f2181.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*adZ_7nG8d5qik_yg_VOl-Q.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk">Cluster plot : k=6</figcaption></figure><p id="dc2d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">将聚类数设置为 6 似乎可以提供更有意义的客户细分。</p><ol class=""><li id="9085" class="mc md it kd b ke kf ki kj km me kq mf ku mg ky ms mi mj mk bi translated">第 1 类:中等收入，低年支出</li><li id="595d" class="mc md it kd b ke ml ki mm km mn kq mo ku mp ky ms mi mj mk bi translated">第二类:低收入，低年度支出</li><li id="7209" class="mc md it kd b ke ml ki mm km mn kq mo ku mp ky ms mi mj mk bi translated">集群 3:高收入，高年度支出</li><li id="fae2" class="mc md it kd b ke ml ki mm km mn kq mo ku mp ky ms mi mj mk bi translated">集群 4:低收入，高年度支出</li><li id="c9e9" class="mc md it kd b ke ml ki mm km mn kq mo ku mp ky ms mi mj mk bi translated">第 5 类:中等收入，低年支出</li><li id="3056" class="mc md it kd b ke ml ki mm km mn kq mo ku mp ky ms mi mj mk bi translated">集群 6:非常高的收入，高的年支出</li></ol><p id="2407" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">因此，很明显，6 个聚类提供了更有意义的客户细分。</p><p id="6df5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">细分客户的营销策略</strong> <br/>根据这 6 个集群，我们可以制定与每个集群相关的营销策略:</p><ul class=""><li id="e3a6" class="mc md it kd b ke kf ki kj km me kq mf ku mg ky mh mi mj mk bi translated">一个典型的策略是将某些促销努力集中于集群 6 和集群 3 的高价值客户。</li><li id="23e2" class="mc md it kd b ke ml ki mm km mn kq mo ku mp ky mh mi mj mk bi translated">集群 4 是一个独特的客户群，尽管他们的年收入相对较低，但这些客户倾向于在网站上花费更多，这表明他们的忠诚度。可能会有一些基于折扣价格的促销活动来吸引这一群体。</li><li id="c95e" class="mc md it kd b ke ml ki mm km mn kq mo ku mp ky mh mi mj mk bi translated">对于收入和年度支出都较低的第 2 组，可能需要进一步分析以找出支出较低的原因，并且可以引入对价格敏感的策略来增加该细分市场的支出。</li><li id="dd7d" class="mc md it kd b ke ml ki mm km mn kq mo ku mp ky mh mi mj mk bi translated">尽管年收入不错，但第 1 类和第 5 类客户在网站上的花费并不多——对这些细分市场的进一步分析可能会导致对这些客户的满意度/不满意度的深入了解，或者降低电子商务网站对这些客户的可见性。策略可以相应地发展。</li></ul><p id="db41" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们已经看到，我们如何通过使用聚类算法来生成客户细分，从而获得有意义的见解和建议。为了简单起见，数据集只使用了两个变量——收入和支出。在一个典型的业务场景中，有几个变量可能会产生更加现实和特定于业务的见解。</p></div></div>    
</body>
</html>