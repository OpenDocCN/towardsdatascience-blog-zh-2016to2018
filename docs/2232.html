<html>
<head>
<title>How to use Facebook Graph API and extract data using Python!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用脸书图形API和使用Python提取数据！</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-use-facebook-graph-api-and-extract-data-using-python-1839e19d6999?source=collection_archive---------0-----------------------#2016-10-04">https://towardsdatascience.com/how-to-use-facebook-graph-api-and-extract-data-using-python-1839e19d6999?source=collection_archive---------0-----------------------#2016-10-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="3247" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好，</p><p id="9803" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我关于Medium.com的第二篇报道。自从第一个故事以来，我已经从挣扎着写代码变成了有点舒服。我写了一个Python代码来提取脸书的公开数据。让我们深入研究一下。</p><p id="a0c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">获取接入令牌:</strong></p><p id="a463" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了能够使用python代码从脸书提取数据，您需要在脸书上注册为开发人员，然后拥有一个访问令牌。下面是它的步骤。</p><ol class=""><li id="d139" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated">去developers.facebook.com链接<a class="ae kl" href="http://developers.facebook.com" rel="noopener ugc nofollow" target="_blank">，在那里创建一个账户。</a></li><li id="ab06" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">转到链接<a class="ae kl" href="https://developers.facebook.com/tools/explorer" rel="noopener ugc nofollow" target="_blank">developers.facebook.com/tools/explorer</a>。</li><li id="4315" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">转到右上角的“我的应用程序”下拉菜单，选择“添加新应用程序”。选择显示名称和类别，然后“创建应用ID”。</li><li id="1fd3" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">再次回到同一环节<a class="ae kl" href="https://developers.facebook.com/tools/explorer" rel="noopener ugc nofollow" target="_blank">developers.facebook.com/tools/explorer</a>。您将在右上角的“我的应用程序”下方看到“图形应用程序资源管理器”。从“图形API浏览器”下拉列表中，选择您的应用程序。</li><li id="0b93" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">然后，选择“获取令牌”。从该下拉列表中，选择“获取用户访问令牌”。从出现的菜单中选择“权限”，然后选择“获取访问令牌”</li><li id="d03e" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">转到链接<a class="ae kl" href="https://developers.facebook.com/tools/accesstoken/" rel="noopener ugc nofollow" target="_blank">developers.facebook.com/tools/accesstoken</a>。选择“用户令牌”对应的“调试”。转到“扩展令牌访问”。这将确保您的令牌不会每两小时过期一次。</li></ol><p id="9977" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">访问脸书公共数据的Python代码:</strong></p><p id="faee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你想收集任何公开的数据，请点击链接<a class="ae kl" href="https://developers.facebook.com/docs/graph-api" rel="noopener ugc nofollow" target="_blank">https://developers.facebook.com/docs/graph-api</a>。参见<a class="ae kl" href="https://developers.facebook.com/docs/graph-api/reference/v2.7/" rel="noopener ugc nofollow" target="_blank">https://developers . Facebook . com/docs/graph-API/reference/v 2.7/</a>。从这个文档中，选择您想要从中提取数据的任何字段，如“组”或“页”等。在选择了这些代码之后，去看看代码的例子，然后选择“facebook graph api ”,你会得到如何提取信息的提示。这个博客主要是关于获取事件数据。</p><p id="2555" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，导入' urllib3 '，' facebook '，' requests '，如果它们已经可用的话。如果没有，请下载这些库。定义一个变量令牌，并将其值设置为上面得到的“用户访问令牌”。</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="16c2" class="lj lk iq lf b gy ll lm l ln lo">token= ‘aiufniqaefncqiuhfencioaeusKJBNfljabicnlkjshniuwnscslkjjndfi’</span></pre><p id="fd41" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">获取事件列表:</strong></p><p id="6b3c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，要查找任何搜索词“诗歌”的事件信息，并将这些事件的数量限制为10000个:</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="0379" class="lj lk iq lf b gy ll lm l ln lo">graph = facebook.GraphAPI(access_token=token, version = 2.7)<br/>events = graph.request(‘/search?q=Poetry&amp;type=event&amp;limit=10000’)</span></pre><p id="aa1c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将给出一个在脸书上创建的所有事件的字典，并且其名称中有字符串“诗歌”。要获取事件列表，请执行以下操作:</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="7503" class="lj lk iq lf b gy ll lm l ln lo">eventList = events[‘data’]</span></pre><p id="9dd0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">从上面提取的事件列表中提取事件的所有信息:</strong></p><p id="a2a9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过以下方式获取列表中第一个事件的EventID</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="87e5" class="lj lk iq lf b gy ll lm l ln lo">eventid = eventList[1][‘id’]</span></pre><p id="8f99" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于此EventID，获取所有信息并设置一些变量，这些变量将在以后由以下人员使用:</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="3943" class="lj lk iq lf b gy ll lm l ln lo">event1 = graph.get_object(id=eventid,<br/> fields=’attending_count,can_guests_invite,category,cover,declined_count,description,end_time,guest_list_enabled,interested_count,is_canceled,is_page_owned,is_viewer_admin,maybe_count,noreply_count,owner,parent_group,place,ticket_uri,timezone,type,updated_time’)<br/>attenderscount = event1[‘attending_count’]<br/>declinerscount = event1[‘declined_count’]<br/>interestedcount = event1[‘interested_count’]<br/>maybecount = event1[‘maybe_count’]<br/>noreplycount = event1[‘noreply_count’]</span></pre><p id="473e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">获取所有参加活动的人的列表，并将响应转换成json格式:</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="aefa" class="lj lk iq lf b gy ll lm l ln lo">attenders = requests.get(“<a class="ae kl" href="https://graph.facebook.com/v2.7/" rel="noopener ugc nofollow" target="_blank">https://graph.facebook.com/v2.7/</a>"+eventid+"/attending?access_token="+token+”&amp;limit=”+str(attenderscount)) </span><span id="b164" class="lj lk iq lf b gy lp lm l ln lo">attenders_json = attenders.json()</span></pre><p id="046f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">获取事件的管理员:</p><pre class="la lb lc ld gt le lf lg lh aw li bi"><span id="6917" class="lj lk iq lf b gy ll lm l ln lo">admins = requests.get(“<a class="ae kl" href="https://graph.facebook.com/v2.7/" rel="noopener ugc nofollow" target="_blank">https://graph.facebook.com/v2.7/</a>"+eventid+"/admins?access_token="+token)</span><span id="8e52" class="lj lk iq lf b gy lp lm l ln lo">admins_json = admins.json()</span></pre><p id="07ec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">同样，如果您愿意，您可以提取其他信息，如该活动的照片/视频/提要。</p><p id="69af" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">进入<a class="ae kl" href="https://developers.facebook.com/docs/graph-api/reference/event/" rel="noopener ugc nofollow" target="_blank">https://developers . Facebook . com/docs/graph-API/reference/event/</a>查看文档中的“Edges”部分。见图片</p><figure class="la lb lc ld gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lq"><img src="../Images/187ce36380558b9a2dad3906c126d4de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h6JmVmvoJU0mPpBEE2_4vg.png"/></div></div></figure><p id="5271" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，让我们说，你想有一个对这个事件感兴趣的所有人的名单，点击“感兴趣的”绿色单词在这里。这将打开新的一页:</p><figure class="la lb lc ld gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi ly"><img src="../Images/11e34c62e3c81dd5c47d7fed59cd0db9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sYrPBl2NAF3ZMxkfaMLfsA.png"/></div></div></figure><p id="5152" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在此选择“图形API浏览器”。这将打开新的一页:</p><figure class="la lb lc ld gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi lz"><img src="../Images/66dc4ad60a361f3fdc5a8a838dea4c42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6gK5H0EMscabu36iyyNnJg.png"/></div></div></figure><p id="f692" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这里，输入事件的id来代替{event-id}，如下所示:</p><figure class="la lb lc ld gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi ma"><img src="../Images/17fb6a2b8fb8f2b01e80739e67adaaf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w75PB19XpWLPiPe_pSuF2w.png"/></div></div></figure><p id="3ebf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">点击提交。此外，在同一页面上，你会发现下面的'获取代码'选项</p><figure class="la lb lc ld gt lr gh gi paragraph-image"><div role="button" tabindex="0" class="ls lt di lu bf lv"><div class="gh gi mb"><img src="../Images/922e187b2336a6749c1382f9c06e7c37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VoiBMqv5PxtLPKsCIzfcQw.png"/></div></div></figure><p id="6451" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">选择它以查看代码。在出现的弹出窗口中选择“curl ”,然后在python代码中获得相同的输出，用requests.get编写它，如上面的示例所示。</p><p id="9e73" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">希望这对那些开始使用facebook graph API的人有所帮助。我将很高兴听到你的建议/问题/反馈。</p><p id="d4b0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你发现这个博客对你有任何价值，如果你对加密货币感兴趣，如果你很慷慨，考虑发送一些涟漪到以下地址:</p><p id="154d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">目的地标签:5973413</p><p id="2987" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">钱包地址:rld inlq 5 cjood 9 wdjy 9 zcdgyck 8 kgevkuj</p><p id="d485" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上面的语句中有太多的如果。只有三个都是真的才发送！加密货币FTW！</p></div></div>    
</body>
</html>