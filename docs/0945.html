<html>
<head>
<title/>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1/>
<blockquote>原文：<a href="https://towardsdatascience.com/today-im-going-to-talk-about-a-small-practical-example-of-using-neural-networks-training-one-to-6b2cbd6efdb3?source=collection_archive---------0-----------------------#2017-07-12">https://towardsdatascience.com/today-im-going-to-talk-about-a-small-practical-example-of-using-neural-networks-training-one-to-6b2cbd6efdb3?source=collection_archive---------0-----------------------#2017-07-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/d4d5c47e648786ffad0513e3d4cae04c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zRZ46MeFZMd5F52CHM6EYA.png"/></div></div></figure><p id="9d5f" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">今天我要讲一个使用神经网络的小例子——训练一个人玩蛇游戏。</p><p id="8822" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">这篇文章是为初学者写的，所以如果你擅长机器学习，你不会发现你感兴趣的东西。如果你对机器学习、神经网络和张量流有所了解，那就太好了，但除此之外没有任何问题。</p><p id="fea9" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">最后，很明显，有更好的方法来为贪吃蛇游戏编写逻辑，但是让我们假设这是一个真实的任务，我们需要这样来解决它。</p><h1 id="045a" class="jy jz jb bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">第 0 部分:游戏</h1><p id="6437" class="pw-post-body-paragraph iz ja jb jc b jd kw jf jg jh kx jj jk jl ky jn jo jp kz jr js jt la jv jw jx ij bi translated">首先，我们需要写一个游戏本身。它将有一个 20x20 的领域，在开始的 3 件蛇，一个随机生成的苹果在每个时刻的时间和 API 使用我们的网络。你可以在这里找到游戏<a class="ae lb" href="https://github.com/korolvs/snake_nn/blob/master/snake_game.py" rel="noopener ugc nofollow" target="_blank">的代码。</a></p><figure class="ld le lf lg gt is gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/3fdc26dee2bb480b07a883b48d9e9ed6.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/1*2VKWGN2p1NyGY7i0KedvOg.gif"/></div></figure><p id="6465" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">现在让我们从神经网络开始。</p><h1 id="48f8" class="jy jz jb bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">第一部分:生存</h1><h2 id="6787" class="lh jz jb bd ka li lj dn ke lk ll dp ki jl lm ln km jp lo lp kq jt lq lr ku ls bi translated">特征</h2><p id="5823" class="pw-post-body-paragraph iz ja jb jc b jd kw jf jg jh kx jj jk jl ky jn jo jp kz jr js jt la jv jw jx ij bi translated">为了让蛇变得“聪明”,我们需要给它一些知识——我们需要创造<strong class="jc lt">特征</strong>来教它。总是尝试选择最有用的功能。如果你没有增加足够的功能，一个网络将不会得到足够的信息。从另一面来说，如果特征太多。对于一个网络来说，很难决定哪个更重要，学习时间也更长。</p><p id="f239" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">第一步，我们会学习蛇如何生存，不会去想苹果。为了选择正确的方向，它应该知道周围是否有障碍。考虑到这些障碍和建议的方向，网络将决定这是否是一个好的行动。</p><p id="30f0" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">因此，在我们神经网络的输入端，我们将给出一个由 4 个数字组成的数组:</p><ul class=""><li id="baf3" class="lu lv jb jc b jd je jh ji jl lw jp lx jt ly jx lz ma mb mc bi translated">蛇的左边是否有障碍物(1 —是，0 —否)</li><li id="979d" class="lu lv jb jc b jd md jh me jl mf jp mg jt mh jx lz ma mb mc bi translated">蛇的前面是否有障碍物(1 —是，0 —否)</li><li id="e092" class="lu lv jb jc b jd md jh me jl mf jp mg jt mh jx lz ma mb mc bi translated">蛇的右边有障碍物吗(1 —有，0 —无)</li><li id="ccec" class="lu lv jb jc b jd md jh me jl mf jp mg jt mh jx lz ma mb mc bi translated">建议的方向(-1 —向左，0 —向前，1 —向右)</li></ul><p id="75dd" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">作为输出，我们希望得到一个决定。1 —我们应该走选定的方向，0 —我们应该选择另一个方向。</p><h2 id="93b6" class="lh jz jb bd ka li lj dn ke lk ll dp ki jl lm ln km jp lo lp kq jt lq lr ku ls bi translated">输入数据</h2><p id="60d3" class="pw-post-body-paragraph iz ja jb jc b jd kw jf jg jh kx jj jk jl ky jn jo jp kz jr js jt la jv jw jx ij bi translated">神经网络需要一些数据来学习。输入数据是机器学习非常重要的一部分。如果你有大量的数据，即使你的网络架构不好，你也可以取得很好的结果。这就是为什么像谷歌这样的公司试图从他们的用户那里获得所有信息(当然不是因为他们有糟糕的架构，而是因为真正的大数据是宝贵的)。</p><p id="096c" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">所以我们需要生成一些数据。你可以坐着玩尽可能多的游戏，但是当你可以自动生成数据(从头开始或者修改你有的数据)的时候总是好的。在我们的例子中，很容易创建数据，只要随机选择方向，观察蛇在转弯后是否还活着。</p><p id="7fa8" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">100 场比赛后，我有 5504 个训练样本。训练生存就够了</p><h2 id="76f7" class="lh jz jb bd ka li lj dn ke lk ll dp ki jl lm ln km jp lo lp kq jt lq lr ku ls bi translated">神经网络体系结构</h2><p id="b76b" class="pw-post-body-paragraph iz ja jb jc b jd kw jf jg jh kx jj jk jl ky jn jo jp kz jr js jt la jv jw jx ij bi translated">选择正确的架构或神经网络总是很难。您可以选择神经元层数、层数和神经元类型。这总是取决于你试图解决的任务。最好尝试不同的变化，选择一个比其他更适合的。</p><p id="a6c3" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">我们的任务非常简单，因此我们将只使用输入和输出层。不需要隐藏层。</p><figure class="ld le lf lg gt is gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/af422c73dcecf9b6a9185d114eb7017a.png" data-original-src="https://miro.medium.com/v2/resize:fit:462/format:webp/1*vpcmHGcYrRu-mSufZI39NA.png"/></div></figure><p id="4561" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">在 TensorFlow 中，它将看起来像(我使用的是<a class="ae lb" href="http://tflearn.org/" rel="noopener ugc nofollow" target="_blank"> TFLearn </a>):</p><pre class="ld le lf lg gt mj mk ml mm aw mn bi"><span id="9d63" class="lh jz jb mk b gy mo mp l mq mr">network = input_data(shape=[None, 4, 1], name='input')<br/>network = fully_connected(network, 1, activation='linear')<br/>network = regression(network, optimizer='adam', learning_rate=1e-2, loss='mean_square', name='target')<br/>model = tflearn.DNN(network)</span></pre><p id="b6db" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">你可以在这里找到完整的代码<a class="ae lb" href="https://github.com/korolvs/snake_nn/blob/master/nn_1.py" rel="noopener ugc nofollow" target="_blank"/></p><h2 id="f2e5" class="lh jz jb bd ka li lj dn ke lk ll dp ki jl lm ln km jp lo lp kq jt lq lr ku ls bi translated">结果</h2><p id="04cf" class="pw-post-body-paragraph iz ja jb jc b jd kw jf jg jh kx jj jk jl ky jn jo jp kz jr js jt la jv jw jx ij bi translated">每一轮我们给网络三组可能的动作，选择一组输出更好的。经过训练后，这条蛇选择了最简单的生存方式:</p><figure class="ld le lf lg gt is gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/6e9d801f65bbc74a802ad8317d146ecd.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/1*WN6N9bxZWGA8SHBVfCV5gA.gif"/></div></figure><h1 id="e32a" class="jy jz jb bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">第二部分:让我们喂蛇</h1><h2 id="fd07" class="lh jz jb bd ka li lj dn ke lk ll dp ki jl lm ln km jp lo lp kq jt lq lr ku ls bi translated">新功能</h2><p id="06cd" class="pw-post-body-paragraph iz ja jb jc b jd kw jf jg jh kx jj jk jl ky jn jo jp kz jr js jt la jv jw jx ij bi translated">现在当蛇知道如何生存时，就该想想苹果了。为了教会蛇如何找到苹果，我们需要添加一个新的特性。我选择了蛇的移动方向和苹果方向之间的角度:</p><figure class="ld le lf lg gt is gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/55fd54a5891d2466d7bd0a4a1a9d9dd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:446/format:webp/1*ponlSe9ldlOt7d8BkN371A.png"/></div></figure><p id="e822" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">如果一个苹果在蛇的左边，数字将是正的，如果它在右边，数字将是负的。同样，让你的特征正常化总是好的。在这种情况下，我们需要将角度除以 180 度，因此数字将从-1 到 1。</p><p id="bdc1" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">所以新的输入将是一个由 5 个数字组成的数组:</p><ul class=""><li id="c0ed" class="lu lv jb jc b jd je jh ji jl lw jp lx jt ly jx lz ma mb mc bi translated">蛇的左边是否有障碍物(1 —是，0 —否)</li><li id="6c94" class="lu lv jb jc b jd md jh me jl mf jp mg jt mh jx lz ma mb mc bi translated">蛇的前面是否有障碍物(1 —是，0 —否)</li><li id="43cf" class="lu lv jb jc b jd md jh me jl mf jp mg jt mh jx lz ma mb mc bi translated">蛇的右边有障碍物吗(1 —有，0 —无)</li><li id="df7c" class="lu lv jb jc b jd md jh me jl mf jp mg jt mh jx lz ma mb mc bi translated">蛇的移动方向和苹果方向之间的标准化角度(从-1 到 1)</li><li id="4200" class="lu lv jb jc b jd md jh me jl mf jp mg jt mh jx lz ma mb mc bi translated">建议的方向(-1 —向左，0 —向前，1 —向右)</li></ul><h2 id="eeb9" class="lh jz jb bd ka li lj dn ke lk ll dp ki jl lm ln km jp lo lp kq jt lq lr ku ls bi translated">新产出</h2><p id="3c78" class="pw-post-body-paragraph iz ja jb jc b jd kw jf jg jh kx jj jk jl ky jn jo jp kz jr js jt la jv jw jx ij bi translated">现在，我们不只是观察蛇在一个回合后是否还活着，而是需要判断这个回合是否成功。为此，我们将计算转弯前后蛇的头部和苹果之间的距离。</p><p id="41af" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">新的输出将是:</p><ul class=""><li id="637d" class="lu lv jb jc b jd je jh ji jl lw jp lx jt ly jx lz ma mb mc bi translated">-1 如果蛇没有活下来</li><li id="3769" class="lu lv jb jc b jd md jh me jl mf jp mg jt mh jx lz ma mb mc bi translated">0 如果蛇活了下来但是方向错了</li><li id="b49e" class="lu lv jb jc b jd md jh me jl mf jp mg jt mh jx lz ma mb mc bi translated">1 如果这条蛇幸存下来并且方向正确</li></ul><p id="50bb" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">在最初的 10000 场比赛后，我得到了:</p><ul class=""><li id="3d39" class="lu lv jb jc b jd je jh ji jl lw jp lx jt ly jx lz ma mb mc bi translated">294078 向右转</li><li id="e340" class="lu lv jb jc b jd md jh me jl mf jp mg jt mh jx lz ma mb mc bi translated">280527 转向错误</li><li id="e656" class="lu lv jb jc b jd md jh me jl mf jp mg jt mh jx lz ma mb mc bi translated">10000 次错误转弯</li></ul><p id="6d49" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">让我们看看这是否足以教会蛇，但在此之前，我们需要改变它的架构。</p><h2 id="2b71" class="lh jz jb bd ka li lj dn ke lk ll dp ki jl lm ln km jp lo lp kq jt lq lr ku ls bi translated">新建筑</h2><p id="d0e8" class="pw-post-body-paragraph iz ja jb jc b jd kw jf jg jh kx jj jk jl ky jn jo jp kz jr js jt la jv jw jx ij bi translated">现在我们有了更复杂的输入数据和更多的输出选项。所以还是选择更复杂的神经网络架构吧。让我们添加一个有 25 个神经元的隐藏层。</p><figure class="ld le lf lg gt is gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/9783ced0f61ab7105b8ee0b7a448d700.png" data-original-src="https://miro.medium.com/v2/resize:fit:702/format:webp/1*aEBuUm8N6vR91ZMLzOBxkg.png"/></div></figure><p id="e485" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">代码:</p><pre class="ld le lf lg gt mj mk ml mm aw mn bi"><span id="55f2" class="lh jz jb mk b gy mo mp l mq mr">network = input_data(shape=[None, 5, 1], name='input')<br/>network = fully_connected(network, 25, activation='relu')<br/>network = fully_connected(network, 1, activation='linear')<br/>network = regression(network, optimizer='adam', learning_rate=1e-2, loss='mean_square', name='target')<br/>model = tflearn.DNN(network)</span></pre><p id="2838" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">你可以在这里找到完整的代码<a class="ae lb" href="https://github.com/korolvs/snake_nn/blob/master/nn_2.py" rel="noopener ugc nofollow" target="_blank"/></p><h2 id="0b44" class="lh jz jb bd ka li lj dn ke lk ll dp ki jl lm ln km jp lo lp kq jt lq lr ku ls bi translated">初步结果</h2><p id="9512" class="pw-post-body-paragraph iz ja jb jc b jd kw jf jg jh kx jj jk jl ky jn jo jp kz jr js jt la jv jw jx ij bi translated">《学习蛇》节目在 1000 个测试游戏中的结果如下:</p><ul class=""><li id="8d0e" class="lu lv jb jc b jd je jh ji jl lw jp lx jt ly jx lz ma mb mc bi translated">平均级数——166.61</li><li id="2959" class="lu lv jb jc b jd md jh me jl mf jp mg jt mh jx lz ma mb mc bi translated">平均分数——12.171</li></ul><p id="de90" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">外观:</p><figure class="ld le lf lg gt is gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/6e28283787e6a6f7e8caa7c1960dab5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/1*oTHQK4zv7dUVdI0hT8zUHA.gif"/></div></figure><p id="05bb" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">还不错。但是我们可以做得更好。让我们来看看蛇出错时的一些输入:</p><ul class=""><li id="2af9" class="lu lv jb jc b jd je jh ji jl lw jp lx jt ly jx lz ma mb mc bi">[ 1, 1, 1, 0.36420025]</li><li id="0b50" class="lu lv jb jc b jd md jh me jl mf jp mg jt mh jx lz ma mb mc bi">[ 1, 1, 0, 0.04516724]</li><li id="35e3" class="lu lv jb jc b jd md jh me jl mf jp mg jt mh jx lz ma mb mc bi">[ 1, 0, 1, 0.2912856]</li></ul><p id="136d" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">其中数字是:[左边的障碍，前面的障碍，右边的障碍，与苹果的角度]</p><p id="7fdb" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">在第一个例子中，考虑到输入数据，对蛇没有什么可做的，但在接下来的例子中，有机会生存，蛇选择了错误的行动。我们能用它做什么？</p><h2 id="bee2" class="lh jz jb bd ka li lj dn ke lk ll dp ki jl lm ln km jp lo lp kq jt lq lr ku ls bi translated">让我们让蛇再次变得伟大</h2><p id="80d8" class="pw-post-body-paragraph iz ja jb jc b jd kw jf jg jh kx jj jk jl ky jn jo jp kz jr js jt la jv jw jx ij bi translated">你可以通过调整网络来改变不同的东西——架构、特性、学习速率和输入样本的数量。如果你能得到更多的输入数据，尝试使用它总是值得的。在我们的情况下，很容易产生更多的游戏。让我们试试 100000 个游戏。</p><figure class="ld le lf lg gt is gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/c83d58523f3f541e605929f621927132.png" data-original-src="https://miro.medium.com/v2/resize:fit:444/1*FpTxOiGk9E1EP9YePa7D4A.gif"/></div></figure><ul class=""><li id="103c" class="lu lv jb jc b jd je jh ji jl lw jp lx jt ly jx lz ma mb mc bi translated">平均级数— 398.959</li><li id="1df9" class="lu lv jb jc b jd md jh me jl mf jp mg jt mh jx lz ma mb mc bi translated">平均点数— 25.333</li></ul><p id="7ea3" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">而蛇死的时候所有的输入看起来都是[1，1，1，x]。这意味着蛇只有在没有任何办法生存的时候才会死亡。</p><h1 id="5327" class="jy jz jb bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">摘要</h1><p id="b2ae" class="pw-post-body-paragraph iz ja jb jc b jd kw jf jg jh kx jj jk jl ky jn jo jp kz jr js jt la jv jw jx ij bi translated">我为一个神经网络、一个架构选择了特征，并获得了一些输入数据。在结果中，网络计算给定要素的最佳结果。</p><p id="667d" class="pw-post-body-paragraph iz ja jb jc b jd je jf jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv jw jx ij bi translated">下一次我将向您展示如何让它变得更好，以及如何使用卷积神经网络。</p></div></div>    
</body>
</html>