# 马尔可夫决策过程入门:强化学习

> 原文：<https://towardsdatascience.com/getting-started-with-markov-decision-processes-reinforcement-learning-ada7b4572ffb?source=collection_archive---------2----------------------->

## 第二部分:解释 ***马尔可夫决策过程、*** 贝尔曼方程和政策的概念

在这篇博文中，我将解释理解如何解决强化学习问题所需的概念。这一系列的博客文章包含了大卫·西尔弗在[关于强化学习的介绍](http://www0.cs.ucl.ac.uk/staff/d.silver/web/Teaching.html)中解释的概念总结。

零件:[1](/reinforcement-learning-an-introduction-to-the-concepts-applications-and-code-ced6fbfd882d)2[3](https://medium.com/@taggatle/planning-by-dynamic-programming-reinforcement-learning-ed4924bbaa4c)[4](/model-free-prediction-reinforcement-learning-507297e8e2ad)…

![](img/e6304b643b55c79c3544616d4808d02e.png)

到目前为止，我们已经在很高的层次上学习了设置强化学习问题所需的组件。现在，我们将更详细地正式描述强化学习的环境。在本帖中，我们将看看一个*完全可观测的* *环境*以及如何将环境正式描述为 ***马尔可夫决策过程*** (MDPs)。

> 如果我们能解决马尔可夫决策过程，那么我们就能解决一大堆强化学习问题。

MDPs 需要满足 ***马尔可夫性质*** 。

> **马尔可夫性质:** *要求“未来独立于过去给定的现在”。*

***性质*** :麟州 *Sₜ* 是马氏当且仅当:

![](img/67df8e5cdf50ce60ff13d43183820794.png)

简单地说，这意味着状态 *Sₜ* 从历史中获取所有相关信息。 *S₁，S₂，…，Sₜ₋₁* 可以丢弃，我们仍然得到相同的 ***状态转移概率*** 到下一个状态 *Sₜ₊₁* 。

> **状态转移概率 *:*** *状态转移概率告诉我们，给定我们处于状态* s *下一个状态*s’*会发生的概率是多少。*

![](img/d597b43260de1873dd07d2f49367a2ad.png)

*P without the double lines represents the state transitions. The above equation has the transition from state s to state s’. P with the double lines represents the probability from going from state s to s’.*

我们也可以根据一个*状态转移矩阵* ***P*** 来定义所有的状态转移，其中每一行都告诉我们从一个状态到所有可能的后续状态的转移概率。

![](img/7bb06c371e3268dcd5217972a90d3674.png)

State transition matrix.

# **马尔可夫过程/马尔可夫链**

第一个也是最简单的 MDP 是一个 ***马尔可夫过程*** 。

> **马尔可夫过程/马尔可夫链** : *具有*马尔可夫性质的随机状态序列 S₁、S₂、… *。*

![](img/76e1397deada20ad16fd27a67aec44e4.png)

下面是一个马尔可夫链的图示，其中每个节点代表一个状态，有可能从一个状态转移到下一个状态，其中 *Stop* 代表一个终止状态。

![](img/daf1b954258d9a374dc015dc5d74e9de.png)

Markov Chain

我们可以拿一个 ***样本*** 集来遍历这个链，最后到达终点状态。一个示例情节是从*阶段 1* 到*阶段 2* 到*赢得*到*停止。*以下是几个样本集的代表:

- *S1 S2 赢停
- S1 S2 瞬移 S2 赢停
- S1 暂停 S1 S2 赢停*

上述马尔可夫链具有以下转移概率矩阵:

![](img/2908a42e432882c380b84743574d3561.png)

对于每个状态，该状态的转移概率之和等于 1。

# 马尔可夫奖励过程

在上面的马尔可夫链中，我们没有与达到目标的状态相关联的值。一个 ***马尔可夫奖励过程*** 是一个带有奖励值的马尔可夫链。

![](img/388f51b10a6859c0e7e359700d3fe251.png)

> *我们的目标是最大化* **回报** *。回报* Gₜ *是从时步* t *开始的总折扣奖励。*

![](img/ca5bb580071035cf9a295acc2f722b9f.png)

Equation to calculate return

***折现因子*** *γ* 是介于 0 和 1 之间的一个值(可以选择)。如果γ接近 0，则导致近视评估，而接近 1 的值有利于远视评估。

![](img/1738dc64e9efbcbfd67616e4e3c7e60c.png)

Markov Reward Process

***注*** *:由于在马尔可夫奖励过程中我们没有采取行动，Gₜ是通过遍历随机样本序列来计算的。*

## MRP 的价值函数

> **状态值函数** v(s) *:给出状态* s *的长期值。它是从状态* s 开始的预期收益

![](img/2f47a2c01e0f81b76ec234625f103234.png)

state-value function

我们可以这样看，从状态 *s* 开始，通过状态 *s* 的各种样本，我们的预期收益是多少。我们更喜欢给予更多总回报的州。

![](img/22f8ec32d749521c7b2c4d4961f81ff3.png)

state-values for MRP with *γ=1*

## MRPs 的贝尔曼方程

价值函数可以分解为两部分:

*   ***即时奖励:*** *Rₜ₊₁*
*   ***继承国贴现值***:*γ(s*ₜ₊₁*)*

我们可以使用上面的*状态值*函数和*返回函数*定义一个新的等式来计算状态值函数:

![](img/569bd45fc44031de15481f7c2fcbf28c.png)

updated bellman state-value equation

或者，这可以写成矩阵形式:

![](img/399759adc4060d50a7addababc146295.png)

使用这个等式，我们可以计算每个状态的状态值。由于我们在上面有一个简单的模型，带有γ=1 的 MRP 的*“状态值”*，我们可以使用一个联立方程，使用更新的状态值函数来计算状态值。

![](img/448a8b53eaa8ed97e41a6e9c2215ecc9.png)

对于较小的 MRPs，求解上面的方程很简单，但是对于较大的数目，就变得非常复杂。为了解决大型 MRP，我们需要其他技术，如*动态规划*、*蒙特卡洛评估*和*时差学习*，这些将在后面的博客中讨论。

# 马尔可夫决策过程

一个 ***马尔可夫决策过程*** 是一个马尔可夫回报过程的扩展，因为它包含了一个代理必须做出的决策。环境中的所有状态都是马尔可夫的。

![](img/2eb06923a10a75adaffe9e66b4164e7c.png)

在马尔可夫决策过程中，我们现在对进入哪个状态有了更多的控制。在下面的 MDP 的例子中，如果我们选择进行*传送*动作，我们将在 40%的时间里回到状态*阶段 2* 中，在 60%的时间里回到状态*阶段 1* 中。当选择相应的动作时，其他状态转换以 100%的概率发生，例如采取动作*前进 2* 从*阶段 2* 将把我们带到*胜利。*

![](img/c7ca79f9c4c9833b193d473d4e3804a5.png)

## 政策

> 一个**策略** *π* 是给定状态下动作的分布。它完全定义了一个代理的行为。MDP 政策取决于现状，而不是历史。

![](img/aac716c912a906524435e9a35b8dbc12.png)

Policy function

策略给出了从一个状态到下一个状态的映射。如果我在状态 *s，*它从那个状态映射出采取每一个行动的概率。示例如果我们有策略 *π(杂务|阶段 1)=100%，*这意味着代理将在处于状态*阶段 1 时采取动作*杂务 100%* 。*

## MDP 的价值函数

因为我们采取行动，所以根据我们的行为会有不同的期望。

> *MDP 的* **状态值函数***v _*π*(s)*是从状态* s *开始，然后遵循策略π的期望收益。**

*![](img/06bb785ef26a48de9c79cb3d1325a422.png)*

*状态值函数告诉我们通过遵循策略 *π* 处于状态 *s* 有多好。*

> ****动作值函数** q_π(s，a) *是从状态* s *开始，采取动作* a *，然后跟随策略* π的期望收益。**

**![](img/c774803e5107c3141f6159bd29df7e87.png)**

**行动价值函数告诉我们从特定状态采取特定行动有多好。让我们知道我们应该在各州采取什么行动**

## **贝尔曼期望方程**

**价值函数也可以以 ***的形式写成贝尔曼期望方程*** 如下:**

*****状态值函数:*****

**![](img/312756664a715f520d384f8e034451cc.png)**

*****动作值功能:*****

**![](img/fa4476585802ee0a072114bd8ed37244.png)**

## **最优值函数**

**在上述所有等式中，我们使用给定的策略来遵循，这可能不是要采取的最佳行动。强化学习的关键目标是找到能使我们的回报最大化的最优策略。**

> *****最优状态值函数***v∫(s)*是所有策略的最大值函数。它告诉我们你能从系统中获得的最大回报。*****

**![](img/030d694f6d2d7f2c63769d341d4e2f92.png)**

> *****最优动作值函数**q∫(s，a) *是所有策略上的最大动作值函数。它告诉我们，从状态* s *开始并采取行动* a *时，你能从系统中获得的最大回报是什么。****

**![](img/30673cc2f827527136184e0a2ab802c8.png)**

**如果你知道*q∫*，那么你就知道在 MDP 中应该采取的正确行动和最佳表现，从而解决 MDP 问题。**

> **q∑(s，a)表示采取哪些行动来获得最佳表现。**

## **寻找最佳策略**

**通过最大化超过*q∫(s，a)* 可以找到最优策略:**

**![](img/5444cf3242712b8cc4cb557fed13118d.png)**

*****贝尔曼最优方程*** 是非线性的，很难求解。在后面的博客中，我将讨论使用各种技术来解决这个方程的迭代解决方案，例如*值迭代、策略迭代、Q-Learning* 和 *Sarsa。***

# **参考**

*   **[关于 RL 的 UCL 课程——第 2 讲](http://www0.cs.ucl.ac.uk/staff/d.silver/web/Teaching_files/MDP.pdf)**
*   **《强化学习导论》，萨顿和巴尔托，1998 年**

**如果你喜欢这篇文章，并想看到更多，不要忘记关注和/或留下掌声。**