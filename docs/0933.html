<html>
<head>
<title>Image Augmentation for Deep Learning using Keras and Histogram Equalization</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于Keras和直方图均衡的深度学习图像增强</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/image-augmentation-for-deep-learning-using-keras-and-histogram-equalization-9329f6ae5085?source=collection_archive---------0-----------------------#2017-07-11">https://towardsdatascience.com/image-augmentation-for-deep-learning-using-keras-and-histogram-equalization-9329f6ae5085?source=collection_archive---------0-----------------------#2017-07-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/99493db53a6a0038164bd4ee1fa27f4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lcbviXWSDUpasgGZ9xVP4g.png"/></div></div></figure><p id="ceec" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在本帖中，我们将回顾:</p><ul class=""><li id="0cea" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated">图像增强:它是什么？为什么重要？</li><li id="5250" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">Keras:如何使用它进行基本的图像增强。</li><li id="a5d1" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">直方图均衡化:它是什么？怎么有用？</li><li id="0de3" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">实现直方图均衡化技术:修改keras .预处理image.py文件的一种方法。</li></ul><h1 id="bd82" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">图像增强:它是什么？为什么重要？</h1><p id="bd80" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">深度神经网络，尤其是<a class="ae mn" href="https://en.wikipedia.org/wiki/Convolutional_neural_network" rel="noopener ugc nofollow" target="_blank">卷积神经网络(CNN)</a>，尤其擅长图像分类任务。最先进的CNN甚至被证明在图像识别方面超过了人类的表现。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mo"><img src="../Images/db2773caa05ce35b1b76b002db0407f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*udiqyHuiIduCr8QTtb76cw.png"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk"><a class="ae mn" href="https://www.eff.org/ai/metrics" rel="noopener ugc nofollow" target="_blank">https://www.eff.org/ai/metrics</a></figcaption></figure><p id="fcf6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然而，正如我们从杨健先生在热门电视节目<em class="mx">【硅谷】</em><a class="ae mn" href="https://itunes.apple.com/us/app/not-hotdog/id1212457521?mt=8" rel="noopener ugc nofollow" target="_blank">(该应用程序现已在app store上提供)</a>中的“热狗，不是热狗”食物识别应用中了解到的那样，收集图像作为训练数据既昂贵又耗时。</p><p id="a1d4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你不熟悉电视节目《硅谷》,请注意以下视频中的语言是NSFW语:</p><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="721f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了对抗收集成千上万训练图像的高费用，已经开发了图像增强，以便从现有数据集生成训练数据。图像增强是获取已经在训练数据集中的图像并操纵它们以创建同一图像的许多改变版本的过程。这不仅提供了更多的图像进行训练，而且还可以帮助我们的分类器暴露在更广泛的光照和颜色情况下，从而使我们的分类器更加鲁棒。下面是一些来自<a class="ae mn" href="https://github.com/aleju/imgaug" rel="noopener ugc nofollow" target="_blank"> imgaug </a>库的不同扩充的例子。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/da463362fb125b13d1303abbdc502745.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bqNylp7FcqIBWg0DrcimUw.png"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk"><a class="ae mn" href="https://github.com/aleju/imgaug" rel="noopener ugc nofollow" target="_blank">https://github.com/aleju/imgaug</a></figcaption></figure><h1 id="661a" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">使用Keras进行基本图像增强</h1><p id="a5cc" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">有许多方法可以对图像进行预处理。在这篇文章中，我们将回顾一些最常见的开箱即用的方法，这些方法是<a class="ae mn" href="https://github.com/fchollet/keras" rel="noopener ugc nofollow" target="_blank"> keras深度学习库</a>为增强图像提供的，然后我们将展示如何改变<a class="ae mn" href="https://github.com/fchollet/keras/blob/master/keras/preprocessing/image.py" rel="noopener ugc nofollow" target="_blank">keras . preprocessing image . py</a>文件，以便启用直方图均衡化方法。我们将使用keras附带的cifar10数据集。然而，我们将只使用来自数据集中的猫和狗的图像，以便保持任务足够小，可以在CPU上执行——如果您想继续的话。你可以从<a class="ae mn" href="https://github.com/ryanleeallred/Image_Augmentation/blob/master/Histogram_Modification.ipynb" rel="noopener ugc nofollow" target="_blank">这篇文章中查看IPython笔记本的源代码。</a></p><h2 id="5f43" class="nb ll iq bd lm nc nd dn lq ne nf dp lu kj ng nh ly kn ni nj mc kr nk nl mg nm bi translated">加载和格式化数据</h2><p id="67d3" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">我们要做的第一件事是加载cifar10数据集并格式化图像，以便为CNN做准备。我们还将浏览一些图片，以确保数据已经正确加载。</p><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="nn mz l"/></div></figure><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi no"><img src="../Images/313ba01da24781cb235fe414156d04df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fXLDd7KEVFNb88FzNK85DA.png"/></div></div></figure><p id="b4b2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">cifar10图像只有32 x 32像素，因此在这里放大时看起来有颗粒，但CNN不知道它有颗粒，它看到的只是数据。</p><h2 id="8024" class="nb ll iq bd lm nc nd dn lq ne nf dp lu kj ng nh ly kn ni nj mc kr nk nl mg nm bi translated">从ImageDataGenerator()创建图像生成器</h2><p id="5737" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">用keras增加我们的图像数据非常简单。杰森·布朗利在这方面提供了很棒的教程。首先，我们需要通过调用<code class="fe np nq nr ns b">ImageDataGenerator()</code>函数创建一个图像生成器，并向它传递一个参数列表，描述我们希望它对图像执行的更改。然后，我们将调用图像生成器上的<code class="fe np nq nr ns b">fit()</code>函数，它将把更改一批一批地应用到图像上。默认情况下，修改将被随机应用，所以不是每个图像每次都会改变。您还可以使用<code class="fe np nq nr ns b">keras.preprocessing</code>将增强的图像文件导出到一个文件夹中，以便建立一个巨大的修改图像数据集。</p><p id="ae01" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将在这里看一些视觉上更有趣的增强。所有可能的<code class="fe np nq nr ns b">ImageDataGenerator()</code>参数的描述以及<code class="fe np nq nr ns b">keras.preprocessing</code>中可用的其他方法列表可在<a class="ae mn" href="https://keras.io/preprocessing/image/" rel="noopener ugc nofollow" target="_blank"> keras文档中找到。</a></p><h2 id="4b9b" class="nb ll iq bd lm nc nd dn lq ne nf dp lu kj ng nh ly kn ni nj mc kr nk nl mg nm bi translated">随机旋转图像</h2><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="nn mz l"/></div></figure><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nt"><img src="../Images/049893e12f244aee679ede053f553b28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TdfPytXooo5uhR5rDxObCg.png"/></div></div></figure><h2 id="b5aa" class="nb ll iq bd lm nc nd dn lq ne nf dp lu kj ng nh ly kn ni nj mc kr nk nl mg nm bi translated">垂直翻转图像</h2><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="nn mz l"/></div></figure><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nu"><img src="../Images/6c4689eb7a4e8f7b3898ca23d6f32b60.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eLbBRRzINuSrleLPFQT_kQ.png"/></div></div></figure><p id="4518" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">水平翻转图像也是为分类器生成更多数据的经典方法之一。这很容易做到，并且可能对这个数据集更有意义，但是，我已经省略了代码和图像，因为在没有看到原始图像的情况下，没有办法知道狗或猫的图像是否被水平翻转。</p><h2 id="7d79" class="nb ll iq bd lm nc nd dn lq ne nf dp lu kj ng nh ly kn ni nj mc kr nk nl mg nm bi translated">将图像垂直或水平移动20%</h2><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="nn mz l"/></div></figure><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nv"><img src="../Images/a97ab9c0744192f20a04b76980875758.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*srxyncJdYzqosFopIzyC1Q.png"/></div></div></figure><h1 id="c9a0" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">直方图均衡技术</h1><p id="622d" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">直方图均衡化是采用低对比度图像并增加图像相对高点和低点之间的对比度的过程，以便带出阴影中的细微差异并创建更高对比度的图像。结果可能是惊人的，尤其是对于灰度图像。以下是一些例子:</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nw"><img src="../Images/324f4cdef1297b55fec491ea4cf1e5d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_VJrMkOn7PDwvsZj3_oawg.png"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk"><a class="ae mn" href="https://www.bruzed.com/2009/10/contrast-stretching-and-histogram-equalization/" rel="noopener ugc nofollow" target="_blank">https://www.bruzed.com/2009/10/contrast-stretching-and-histogram-equalization/</a></figcaption></figure><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nx"><img src="../Images/46e14bce511f41364f5e0eb7223c74d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UCWinF9OgNnQZ5UfecRa2Q.png"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk"><a class="ae mn" href="http://www-classes.usc.edu/engr/ee-s/569/qa2/Histogram%20Equalization.htm" rel="noopener ugc nofollow" target="_blank">http://www-classes.usc.edu/engr/ee-s/569/qa2/Histogram%20Equalization.htm</a></figcaption></figure><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ny"><img src="../Images/20d3659b2dd3b02b63b72891d482718f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rbct6sU7XaEgvxtEkpiMEQ.png"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk"><a class="ae mn" href="https://studentathome.wordpress.com/2013/03/27/local-histogram-equalization/" rel="noopener ugc nofollow" target="_blank">https://studentathome.wordpress.com/2013/03/27/local-histogram-equalization/</a></figcaption></figure><p id="d55a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在本帖中，我们将探讨三种提高图像对比度的图像增强技术。这些方法有时也被称为“<a class="ae mn" href="http://homepages.inf.ed.ac.uk/rbf/HIPR2/stretch.htm" rel="noopener ugc nofollow" target="_blank">直方图拉伸</a>”，因为它们采用像素强度的分布，并拉伸该分布以适应更大范围的值，从而增加图像最亮和最暗部分之间的对比度。</p><h2 id="d2c7" class="nb ll iq bd lm nc nd dn lq ne nf dp lu kj ng nh ly kn ni nj mc kr nk nl mg nm bi translated">直方图均衡</h2><p id="c748" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">直方图均衡化通过检测图像中像素密度的分布并将这些像素密度绘制在直方图上来增加图像的对比度。然后分析该直方图的分布，如果存在当前未被利用的像素亮度范围，则直方图被“拉伸”以覆盖这些范围，然后被“<a class="ae mn" href="https://en.wikipedia.org/wiki/Histogram_equalization#Back_projection" rel="noopener ugc nofollow" target="_blank">反向投影</a>到图像上以增加图像的整体对比度。</p><h2 id="b2d6" class="nb ll iq bd lm nc nd dn lq ne nf dp lu kj ng nh ly kn ni nj mc kr nk nl mg nm bi translated">对比度扩展</h2><p id="c583" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">对比度拉伸采用的方法是分析图像中像素密度的分布，然后<a class="ae mn" href="http://scikit-image.org/docs/0.9.x/auto_examples/plot_equalize.html" rel="noopener ugc nofollow" target="_blank">“重新缩放图像，以包含第二和第98个百分点内的所有强度。”</a></p><h2 id="5ad9" class="nb ll iq bd lm nc nd dn lq ne nf dp lu kj ng nh ly kn ni nj mc kr nk nl mg nm bi translated">自适应均衡</h2><p id="09b9" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">自适应均衡不同于常规直方图均衡，因为计算了几个不同的直方图，每个直方图对应于图像的不同部分；然而，它<a class="ae mn" href="https://en.wikipedia.org/wiki/Adaptive_histogram_equalization" rel="noopener ugc nofollow" target="_blank">有在其他不感兴趣的部分过度放大噪声</a>的趋势。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nz"><img src="../Images/02ddf8b92e4f79bec3120e36310e101d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uz5ZzaDTLx2EAt8bSVMJyA.png"/></div></div></figure><p id="504e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">以下代码来自于<a class="ae mn" href="http://scikit-image.org/" rel="noopener ugc nofollow" target="_blank"> sci-kit image library的</a> docs，并已被修改以在我们的cifar10数据集的第一个图像上执行上述三个增强。首先，我们将从sci-kit image (skimage)库中导入必要的模块，然后修改来自<a class="ae mn" href="http://scikit-image.org/docs/dev/auto_examples/color_exposure/plot_equalize.html" rel="noopener ugc nofollow" target="_blank"> sci-kit image文档</a>的代码，以查看数据集的第一个图像的增强。</p><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="nn mz l"/></div></figure><p id="31cf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">以下是来自cifar10数据集的低对比度猫的修改图像。如您所见，结果不如低对比度灰度图像那样引人注目，但仍有助于提高图像质量。</p><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oa"><img src="../Images/db7a4ae546f842819ee7d10483568282.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rAMYGhUWmbjauADVREKOqg.png"/></div></div></figure><h1 id="0fb9" class="lk ll iq bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">修改keras .预处理以启用直方图均衡化技术。</h1><p id="89e1" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">既然我们已经成功地修改了来自cifar10数据集的一幅图像，我们将演示如何修改keras.preprocessing image.py文件，以便执行这些不同的直方图修改技术，就像我们使用<code class="fe np nq nr ns b">ImageDataGenerator()</code>对现成的keras增强所做的那样。为了实现这一功能，我们将遵循以下一般步骤:</p><h2 id="7fcd" class="nb ll iq bd lm nc nd dn lq ne nf dp lu kj ng nh ly kn ni nj mc kr nk nl mg nm bi translated">概观</h2><ul class=""><li id="b585" class="kw kx iq ka b kb mi kf mj kj ob kn oc kr od kv lb lc ld le bi translated">在您自己的机器上找到keras.preprocessing image.py文件。</li><li id="d3ee" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">将image.py文件复制到您的文件或笔记本中。</li><li id="94a5" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">将每个均衡技术的一个属性添加到DataImageGenerator() init函数中。</li><li id="3714" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">将IF语句子句添加到random_transform方法中，以便在我们调用<code class="fe np nq nr ns b">datagen.fit()</code>时实现扩充。</li></ul><p id="83cd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对keras.preprocessing的<code class="fe np nq nr ns b">image.py</code>文件进行修改的最简单的方法之一就是简单地将其内容复制并粘贴到我们的代码中。这将消除导入它的需要。你可以在这里查看github <a class="ae mn" href="https://github.com/fchollet/keras/blob/master/keras/preprocessing/image.py" rel="noopener ugc nofollow" target="_blank">上<code class="fe np nq nr ns b">image.py</code>文件的内容。</a>然而，为了确保你抓取的文件版本与你之前导入的文件版本相同，最好抓取你机器上已经存在的<code class="fe np nq nr ns b">image.py</code>文件。运行<code class="fe np nq nr ns b">print(keras.__file__)</code>将打印出机器上keras库的路径。该路径(对于mac用户)可能类似于:</p><pre class="mp mq mr ms gt oe ns of og aw oh bi"><span id="03c9" class="nb ll iq ns b gy oi oj l ok ol">/usr/local/lib/python3.5/dist-packages/keras/__init__.pyc</span></pre><p id="06f8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这为我们提供了本地机器上keras的路径。继续导航到那里，然后进入<code class="fe np nq nr ns b">preprocessing</code>文件夹。在<code class="fe np nq nr ns b">preprocessing</code>里面你会看到<code class="fe np nq nr ns b">image.py</code>文件。然后，您可以将其内容复制到您的代码中。这个文件很长，但是对于初学者来说，这可能是对它进行修改的最简单的方法之一。</p><h2 id="79b3" class="nb ll iq bd lm nc nd dn lq ne nf dp lu kj ng nh ly kn ni nj mc kr nk nl mg nm bi translated">编辑<code class="fe np nq nr ns b">image.py</code></h2><p id="9752" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">在image.py的顶部，你可以注释掉这一行:<code class="fe np nq nr ns b">from ..import backend as K</code>，如果你已经在上面包含了它。</p><p id="d1e2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">此时，还要仔细检查以确保您导入了必要的scikit-image模块，以便复制的<code class="fe np nq nr ns b">image.py</code>可以看到它们。</p><pre class="mp mq mr ms gt oe ns of og aw oh bi"><span id="5252" class="nb ll iq ns b gy oi oj l ok ol">from skimage import data, img_as_float<br/>from skimage import exposure</span></pre><p id="ed58" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们现在需要在ImageDataGenerator类的<code class="fe np nq nr ns b">__init__ </code>方法中添加六行代码，这样它就有三个属性来表示我们将要添加的增强类型。下面的代码是从我当前的image.py复制过来的，旁边有<code class="fe np nq nr ns b">#####</code>的那几行是我添加的。</p><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="nn mz l"/></div></figure><p id="0382" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe np nq nr ns b">random_transform()</code>函数(如下)响应我们传递给<code class="fe np nq nr ns b">ImageDataGenerator()</code>函数的参数。如果我们已经将<code class="fe np nq nr ns b">contrast_stretching</code>、<code class="fe np nq nr ns b">adaptive_equalization</code>或<code class="fe np nq nr ns b">histogram_equalization</code>参数设置为<code class="fe np nq nr ns b">True</code>，当我们调用<code class="fe np nq nr ns b">ImageDataGenerator()</code>(就像我们对其他图像增强所做的那样)<code class="fe np nq nr ns b">random_transform()</code>将应用所需的图像增强。</p><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="nn mz l"/></div></figure><p id="1d3e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们已经有了所有必要的代码，可以调用ImageDataGenerator()来执行直方图修改技术。如果我们将这三个值都设置为<code class="fe np nq nr ns b">True</code>，下面是一些图像的样子。</p><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="nn mz l"/></div></figure><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi om"><img src="../Images/9e12ed962972994d5a6a381f444c65ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yd9PtKw-4h7XtuRyeyAuKg.png"/></div></div></figure><p id="4e3e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于任何给定的数据集，我不建议将它们中的一个以上设置为<code class="fe np nq nr ns b">True</code>。请确保使用您的特定数据集进行实验，以了解哪些内容有助于提高分类器的准确性。对于彩色图像，我发现对比度拉伸通常比直方图修改或自适应均衡获得更好的结果。</p><h2 id="5a84" class="nb ll iq bd lm nc nd dn lq ne nf dp lu kj ng nh ly kn ni nj mc kr nk nl mg nm bi translated">训练和验证你的Keras CNN</h2><p id="ac01" class="pw-post-body-paragraph jy jz iq ka b kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr mm kt ku kv ij bi translated">最后一步是训练我们的CNN，并使用<code class="fe np nq nr ns b">model.fit_generator()</code>验证模型，以便在增强图像上训练和验证我们的神经网络。</p><figure class="mp mq mr ms gt jr"><div class="bz fp l di"><div class="nn mz l"/></div></figure><figure class="mp mq mr ms gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi on"><img src="../Images/d1ebbeaefb097679d0fd6acdeb3b98aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q1beHKdUCTilE7j4vuzhaQ.png"/></div></div></figure></div></div>    
</body>
</html>