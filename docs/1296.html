<html>
<head>
<title>Linear Regression in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python中的线性回归</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/linear-regression-in-python-9a1f5f000606?source=collection_archive---------1-----------------------#2017-08-21">https://towardsdatascience.com/linear-regression-in-python-9a1f5f000606?source=collection_archive---------1-----------------------#2017-08-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="9f31" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在线性回归中，在给定用于定型模型的定型数据的情况下，您试图构建一个允许您预测新数据值的模型。这将变得清晰，因为我们通过这个职位的工作。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/fe581a4cd57b15cade1c21ad7f29bcba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_TqRJ9SmwFzRigJhMiN2uw.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Courtesy of Department of Statistics, ITS Surabaya</figcaption></figure><p id="850d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以上，我们可以看到简单的线性回归方程。y变量被认为是我们的反应或因变量。这是我们打算预测的，比如<em class="lb">销售</em>是一个热门选择。</p><p id="edcf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">B0是y轴截距，即X=0，直线与y轴相交。B1X本质上是我们的B1(我们的X对我们的y的影响量)，以及我们的X，它是我们的特征/独立变量。与我们的y变量不同，多个X可以与相应的beta(每个的系数)一起使用。这允许我们创建一个具有许多特征(X)变量的模型来预测y中的值。随机误差分量是不可约误差。</p><p id="7b7c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第一步:可视化</strong></p><p id="9ef5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用可视化，你应该能够判断哪些变量与y有线性关系。</p><p id="f397" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这种情况下，我们使用“销售”作为我们的回答/y。用您预期的功能列表替换测试版的变量列表</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lc"><img src="../Images/6874ff7517dd2e1a5fba2ae4944a0a09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p-d_SGXcMpfka6gtqkKexQ.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Seaborn Pairplot</figcaption></figure><p id="9cdf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lb">要使用的附加参数:</em></p><p id="814b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">size=:允许您操纵渲染的pairplot的大小</p><p id="2461" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">kind= 'reg ':将尝试添加最佳拟合线和95%置信区间。目标是最小化误差平方和。</p><p id="0c1b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第二步:SK学习—设置变量</strong></p><p id="4876" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Scikit-Learn期望X是一个特征矩阵(Pandas Dataframe)，y是一个响应向量(Pandas Series)。让我们从如下分离变量开始。</p><p id="f13c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">处理您的功能(X):</p><p id="d72b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lb">在本例中，我们使用TV、Radio和Social列作为预测变量。</em></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ld"><img src="../Images/8489ec64fb326871c23d0414832955ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rdC6926yinNsPcE-GuwAlQ.png"/></div></div></figure><p id="3679" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">处理您的回答(y):</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi le"><img src="../Images/dd84da2f1533342799f46f78d9f74e9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Si9gKud23LKHh7W2bpPgyQ.png"/></div></div></figure><p id="b882" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您想知道为什么大写的X表示特性，小写的y表示响应，这主要是由于惯例。</p><p id="a25b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第三步:SK Learn —拆分我们的数据</strong></p><p id="79e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将X &amp; y分成训练集和测试集:</p><p id="f306" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过将X和y变量传递给train_test_split方法，我们能够通过将4个变量分配给结果来捕获数据中的分割。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lf"><img src="../Images/6fa365309d22911fcfaec855ba62aeea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iXBmASCZ0gIAlzczlcyESw.png"/></div></div></figure><p id="28ce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第四步:SK Learn —训练我们的模型</strong></p><p id="e958" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我们需要导入sklearn.linear_model来访问LinearRegression。然后它需要被实例化，模型适合我们的训练数据。这是下面看到的。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lg"><img src="../Images/d7f4fadb4daf6913ebc79ea321714cb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kwLcl94ahFKiKh_VeMkUog.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Instantiate and fitting model to training data</figcaption></figure><p id="8c59" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第五步:解释系数</strong></p><p id="9dd9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些系数将允许我们用β值来模拟我们的方程。linreg变量(分配给LinearRegression对象)能够使用下面的代码提取截距和系数。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lh"><img src="../Images/1117f7a89b579d467ec85debbd15f29c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SJFFfjndsLHMNdAXXgGWmg.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Extracting data from model</figcaption></figure><p id="c9a7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">截距就是你的B0值；并且每个系数将是通过的X的相应β(按照它们各自的顺序)。</p><p id="7365" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第六步:根据你的模型进行预测</strong></p><p id="25dd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">基于您的模型进行预测就像使用下面的代码一样简单:向predict方法传递您的测试数据。给定新的测试X数据，这将返回y的预测值。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi li"><img src="../Images/097f5a62c42455fa68f61337a3d7665c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mWyJaOBitK5Khtru449nOg.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Returns results of y predictions given X data in X_test</figcaption></figure><p id="681a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第七步:模型评估</strong></p><p id="9f5b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有三个主要指标用于评估线性模型。这些是:平均绝对误差(MAE)，均方误差(MSE)，或均方根误差(RMSE)。</p><p id="1e86" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">梅:最容易理解。代表平均误差</p><p id="8260" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">MSE:类似于MAE，但噪声被夸大，较大的误差被“惩罚”。它比MAE更难解释，因为它不是基本单位，然而，它通常更受欢迎。</p><p id="d158" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">RMSE:最流行的度量，类似于MSE，然而，结果是平方根，因为它是基本单位，所以更容易解释。建议将RMSE作为解释您的模型的主要指标。</p><p id="b5ae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面，您可以看到如何计算每个指标。它们都需要两个列表作为参数，一个是您的预测值，另一个是真实值</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi lj"><img src="../Images/7a88f96e0cc57efbb71b0597627859f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YsIZIP6M8n0QNQUruMRaqw.png"/></div></div></figure><p id="bfb0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第八步:特征选择</strong></p><p id="5e2d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">获得误差度量后，请注意哪些X对y的影响最小。移除其中一些特征可能会提高模型的准确性。</p><p id="8443" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，我们开始了一个反复试验的过程，这个过程从头开始，直到一个令人满意的模型产生。以下步骤可能对这一特定部分有用。</p><ol class=""><li id="f69d" class="lk ll iq jp b jq jr ju jv jy lm kc ln kg lo kk lp lq lr ls bi translated">替换特征列</li><li id="5551" class="lk ll iq jp b jq lt ju lu jy lv kc lw kg lx kk lp lq lr ls bi translated">训练_测试_分割您的数据</li><li id="0ca0" class="lk ll iq jp b jq lt ju lu jy lv kc lw kg lx kk lp lq lr ls bi translated">使用linreg.fit再次将模型拟合到linreg</li><li id="16f6" class="lk ll iq jp b jq lt ju lu jy lv kc lw kg lx kk lp lq lr ls bi translated">使用(y_pred = linreg.predict(X_test))进行预测</li><li id="79b5" class="lk ll iq jp b jq lt ju lu jy lv kc lw kg lx kk lp lq lr ls bi translated">计算RMSE</li><li id="cf90" class="lk ll iq jp b jq lt ju lu jy lv kc lw kg lx kk lp lq lr ls bi translated">重复直到RMSE满意</li></ol></div></div>    
</body>
</html>