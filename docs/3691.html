<html>
<head>
<title>AI for artists: Part 2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">艺术家的人工智能:第二部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/ai-for-artists-part-2-c3e41653747a?source=collection_archive---------14-----------------------#2018-06-07">https://towardsdatascience.com/ai-for-artists-part-2-c3e41653747a?source=collection_archive---------14-----------------------#2018-06-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/d3eb5dbdc423120918d0356c44ad77a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KzCGJuADeu_qZrZqJkpNZA.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Quote from Westworld TV show</figcaption></figure><p id="0981" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir"> <em class="la">注意，本文是艺术家 AI 系列的一部分。</em> </strong> <a class="ae lb" rel="noopener" target="_blank" href="/ai-for-artists-part-1-8d74502725d0"> <strong class="ke ir"> <em class="la">第一部分</em></strong></a><strong class="ke ir"><em class="la"/></strong><a class="ae lb" rel="noopener" target="_blank" href="/ai-for-artists-part-2-c3e41653747a"><strong class="ke ir"><em class="la">第二部分</em> </strong> </a></p><p id="637e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">音乐是一种强有力的工具，它能让世界上一些最聪明的头脑变得不可思议。其中有弗里德里希·尼采、叔本华、弗吉尼亚·伍尔夫等等。尼采在他的书《偶像的黄昏》中说“没有音乐的生活将是一个错误”。</p><p id="5def" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在本文中，我们将使用简单的 LSTM 网络来创作音乐，但在此之前，让我们先简要了解一下音乐创作史上出现过的算法作曲。</p><h1 id="e8fd" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">穿越时间的简史……</h1><p id="279e" class="pw-post-body-paragraph kc kd iq ke b kf ma kh ki kj mb kl km kn mc kp kq kr md kt ku kv me kx ky kz ij bi translated">从古希腊时代开始，就有许多关于音乐理论的论文，但它们并不是任何纯粹意义上的“算法作品”。但在古典时期，算法音乐最常被引用的例子之一是莫扎特的音乐。</p><figure class="mf mg mh mi gt jr"><div class="bz fp l di"><div class="mj mk l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Combinations obtained by rolling a dice.</figcaption></figure><p id="69d1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">1958 年，亚尼斯·克塞纳基斯在他的作品中使用了马尔可夫链。</p><h2 id="939f" class="ml ld iq bd le mm mn dn li mo mp dp lm kn mq mr lq kr ms mt lu kv mu mv ly mw bi translated">马尔可夫链</h2><p id="7272" class="pw-post-body-paragraph kc kd iq ke b kf ma kh ki kj mb kl km kn mc kp kq kr md kt ku kv me kx ky kz ij bi translated">马尔可夫链用于描述一组可能的事件，其中每个事件发生的概率只取决于前一个事件达到的状态。这些用于预测序列中的下一个数据，其中数据可以是单词、音符等。它基本上模拟了一个音符序列播放后出现的概率。马尔可夫链的一个主要限制是它只能产生存在于原始数据中的子序列。但是用这种方法不可能扩展到那些精确的子序列之外。然后出现了递归神经网络(RNNs)尝试这样做。</p><h2 id="302e" class="ml ld iq bd le mm mn dn li mo mp dp lm kn mq mr lq kr ms mt lu kv mu mv ly mw bi translated">什么是 RNN？</h2><p id="6d18" class="pw-post-body-paragraph kc kd iq ke b kf ma kh ki kj mb kl km kn mc kp kq kr md kt ku kv me kx ky kz ij bi translated">我们打个比方来理解这一点。假设你想预测晚餐会吃什么。食物只有三样——煎饼、炒饭和面包。我们试图拟合一个模型，根据厨师迟到、特殊场合、鸡肉价格下跌等因素来预测每天的食物。如果我们开始在晚餐数据的历史上训练这一点，我们学会了预测某个特定夜晚的食物。我们可以看到，即使我们正确地选择输入和训练数据，预测的准确性也不会超过某一点。现在，当我们看一看数据时，我们可以看到食物——炒饭、煎饼和面包在一个循环中重复，不依赖于任何因素。如果前一天是 Chapati，那么第二天就会是面包，这就像一个序列。在这里，预测某一天的食物最重要的是前一天的食物数据。通过收集以前的食物数据，我们可以预测下一次的数据。</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mx"><img src="../Images/ce9ed6a2d5d360bb512d44d26069f785.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NKhwsOYNUT5xU7Pyf6Znhg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">source : <a class="ae lb" href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/" rel="noopener ugc nofollow" target="_blank">http://colah.github.io/posts/2015-08-Understanding-LSTMs/</a></figcaption></figure><p id="30ee" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在正常的神经网络中，所有的输入都是相互独立的，但是在 RNN，所有的输入都是相互关联的。首先，它从输入序列中取出 x(0 ),然后输出 h(0 ), h(0)和 x(1)是下一步的输入。因此，h(0)和 x(1)是下一步的输入。类似地，下一步的 h(1)是下一步的 x(2)的输入，依此类推。这样它在训练的时候就一直记住了上下文。假设我们必须生成给定音乐序列中的下一个音符，在这种情况下，所有先前音符之间的关系有助于预测更好的输出。但问题是，由于消失梯度问题，标准 RNN 不能学习长期序列。</p><h2 id="b05d" class="ml ld iq bd le mm mn dn li mo mp dp lm kn mq mr lq kr ms mt lu kv mu mv ly mw bi translated">消失梯度问题</h2><p id="32d4" class="pw-post-body-paragraph kc kd iq ke b kf ma kh ki kj mb kl km kn mc kp kq kr md kt ku kv me kx ky kz ij bi translated">当我们不断增加越来越多的隐藏层时，以及在反向传播过程中，就会发生这种情况，结果误差(导数)会变得很大或很小。这意味着与层级中较后层的神经元相比，较前层的神经元学习非常慢。这样做的问题是训练过程耗时太长，模型的预测精度会下降。解决方案之一是使用 LSTM 网络。2002 年，道格·埃克改变了这种方法，将标准的 RNN 细胞转换成“长短期记忆”(LSTM)细胞。</p><h2 id="505c" class="ml ld iq bd le mm mn dn li mo mp dp lm kn mq mr lq kr ms mt lu kv mu mv ly mw bi translated">LSTM 网络公司</h2><p id="e3ed" class="pw-post-body-paragraph kc kd iq ke b kf ma kh ki kj mb kl km kn mc kp kq kr md kt ku kv me kx ky kz ij bi translated">长短期记忆网络(LSTM)是一种 RNN，能够学习长期依赖性，这意味着他们可以长时间记住信息。在正常的 RNNs 中，这种重复模块将具有类似单个 tanh 层的简单结构。</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi my"><img src="../Images/fb483b4fcd2ff45863386c05d60933ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vODZnovJafo8L_qZ-Tk1xQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Simple RNN (source:colah’s blog)</figcaption></figure><p id="618d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">LSTMs 具有链状结构，重复模块具有不同的结构。不是只有一个神经网络层，而是有四个网络。</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mz"><img src="../Images/cace770db820b756504598221c2c97d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J5W8FrASMi93Z81NlAui4w.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">LSTM</figcaption></figure><p id="26fc" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">LSTM 网络不是神经元，而是连接成层的记忆块。块包含管理块状态和输出的门。</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/315b06669286a86dbab272e616b5ef94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HGY8vT3iSpCgqUAR_abe_Q.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">cell state highlighted</figcaption></figure><p id="fcaf" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">LSTMs 的关键是单元状态，即贯穿图表顶部的水平线。它沿着整个链条直线向下，只有一些微小的线性相互作用。</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nb"><img src="../Images/db50c4dc0951900f2b33ab0386022ee4.png" data-original-src="https://miro.medium.com/v2/resize:fit:396/format:webp/1*a6FEUZOlcx4peSLv3eZVnw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">LSTM gate</figcaption></figure><p id="ab4a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">门是决定是否让信息通过的一种方式。sigmoid 层输出 0 到 1 之间的数字。</p><p id="a329" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><em class="la">0→没有东西通过</em></p><p id="4156" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><em class="la">1→一切经过</em></p><p id="2389" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">一个 LSTM 有三个这样的门，用来保护和控制细胞状态。</p><p id="7a53" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir"> <em class="la">忘记门→ </em> </strong>决定从单元中丢弃什么信息。<br/> <strong class="ke ir"> <em class="la">输入门→ </em> </strong>决定输入哪些值来更新存储器状态。<br/> <strong class="ke ir"> <em class="la">输出门→ </em> </strong>根据输入和单元内存决定输出什么。</p><p id="01da" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">有许多方法可以使用从马尔可夫链到卷积神经网络(Wavenet)的不同网络来生成音乐。在这里我选择了 LSTM 网络生成音乐。对于训练数据，我们使用诺丁汉音乐数据库。我使用了由<a class="ae lb" href="https://github.com/PanagiotisPtr" rel="noopener ugc nofollow" target="_blank"> Panagiotis Petridis </a>创建的预训练模型。数据集采用 ABC 格式。如果有好的 gpu 或者 cpu 也可以自己训练模型。<a class="ae lb" href="https://github.com/sav132/music-generation-lstm" rel="noopener ugc nofollow" target="_blank"> <strong class="ke ir">提供了<em class="la">这里的</em> </strong> </a>为 jupyter 笔记本。如果你想了解代码<a class="ae lb" href="https://artofmachinelearning.wordpress.com/2018/06/07/code-explanation-for-ai-for-artists-part-2/" rel="noopener ugc nofollow" target="_blank">的解释，请点击此链接</a>。</p><p id="5e63" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">将生成五个文本文件作为输出。您可以使用 abcmidi 之类的软件将生成的文本文件转换为 midi。您也可以使用各种项目，如 magenta、wavenet、deepjazz 等来生成音乐。</p><figure class="mf mg mh mi gt jr"><div class="bz fp l di"><div class="nc mk l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">My output</figcaption></figure><p id="ea0c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><em class="la">如果你是初学者，想入门深度学习领域，可以访问我的博客</em> <a class="ae lb" href="http://artofmachinelearning.wordpress.com" rel="noopener ugc nofollow" target="_blank"> <em class="la">机器学习的艺术</em> </a> <em class="la">。</em></p><p id="c15a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">感谢您的宝贵时间！！</p><p id="cf37" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">参考:</p><div class="nd ne gp gr nf ng"><a href="https://quod.lib.umich.edu/s/spobooks/bbv9810.0001.001/1:5/--algorithmic-composition-a-gentle-introduction-to-music?rgn=div1;view=fulltext" rel="noopener  ugc nofollow" target="_blank"><div class="nh ab fo"><div class="ni ab nj cl cj nk"><h2 class="bd ir gy z fp nl fr fs nm fu fw ip bi translated">算法作曲:用普通 LISP 和普通…</h2><div class="nn l"><h3 class="bd b gy z fp nl fr fs nm fu fw dk translated">使用程序生成一段音乐的一个非常简单的例子是使用 12 面骰子(编号为 1-12)来…</h3></div><div class="no l"><p class="bd b dl z fp nl fr fs nm fu fw dk translated">quod.lib.umich.edu</p></div></div><div class="np l"><div class="nq l nr ns nt np nu jw ng"/></div></div></a></div><div class="nd ne gp gr nf ng"><a href="http://abc.sourceforge.net/NMD/" rel="noopener  ugc nofollow" target="_blank"><div class="nh ab fo"><div class="ni ab nj cl cj nk"><h2 class="bd ir gy z fp nl fr fs nm fu fw ip bi translated">ABC 音乐项目-诺丁汉音乐数据库</h2><div class="nn l"><h3 class="bd b gy z fp nl fr fs nm fu fw dk translated">这些曲子最初不是手工核对的，所以很可能到处都有错误。诺丁汉音乐…</h3></div><div class="no l"><p class="bd b dl z fp nl fr fs nm fu fw dk translated">abc.sourceforge.net</p></div></div></div></a></div><div class="nd ne gp gr nf ng"><a href="http://setosa.io/ev/markov-chains/" rel="noopener  ugc nofollow" target="_blank"><div class="nh ab fo"><div class="ni ab nj cl cj nk"><h2 class="bd ir gy z fp nl fr fs nm fu fw ip bi translated">马尔可夫链直观地解释了</h2><div class="nn l"><h3 class="bd b gy z fp nl fr fs nm fu fw dk translated">当然，真正的建模者并不总是画出马尔可夫链图。相反，他们使用“转移矩阵”来计算…</h3></div><div class="no l"><p class="bd b dl z fp nl fr fs nm fu fw dk translated">setosa.io</p></div></div><div class="np l"><div class="nv l nr ns nt np nu jw ng"/></div></div></a></div><div class="nd ne gp gr nf ng"><a href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/" rel="noopener  ugc nofollow" target="_blank"><div class="nh ab fo"><div class="ni ab nj cl cj nk"><h2 class="bd ir gy z fp nl fr fs nm fu fw ip bi translated">了解 LSTM 网络——colah 的博客</h2><div class="nn l"><h3 class="bd b gy z fp nl fr fs nm fu fw dk translated">这些循环使得循环神经网络看起来有点神秘。然而，如果你想得更多一点，事实证明…</h3></div><div class="no l"><p class="bd b dl z fp nl fr fs nm fu fw dk translated">colah.github.io</p></div></div></div></a></div><p id="be12" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><a class="ae lb" href="https://www.youtube.com/watch?v=qhXZsFVxGKo" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=qhXZsFVxGKo</a></p><div class="nd ne gp gr nf ng"><a href="https://medium.com/artists-and-machine-intelligence/neural-nets-for-generating-music-f46dffac21c0" rel="noopener follow" target="_blank"><div class="nh ab fo"><div class="ni ab nj cl cj nk"><h2 class="bd ir gy z fp nl fr fs nm fu fw ip bi translated">用于生成音乐的神经网络</h2><div class="nn l"><h3 class="bd b gy z fp nl fr fs nm fu fw dk translated">算法音乐创作在过去的几年里有了很大的发展，但是这个想法已经有很长的历史了。在一些…</h3></div><div class="no l"><p class="bd b dl z fp nl fr fs nm fu fw dk translated">medium.com</p></div></div><div class="np l"><div class="nw l nr ns nt np nu jw ng"/></div></div></a></div><div class="nd ne gp gr nf ng"><a href="https://github.com/PanagiotisPtr/Music-Generation-RNN" rel="noopener  ugc nofollow" target="_blank"><div class="nh ab fo"><div class="ni ab nj cl cj nk"><h2 class="bd ir gy z fp nl fr fs nm fu fw ip bi translated">泛音乐主义者/音乐一代-RNN</h2><div class="nn l"><h3 class="bd b gy z fp nl fr fs nm fu fw dk translated">音乐生成-RNN -一个使用 TFLearn 中 LSTM 层的神经网络，学习如何作曲。</h3></div><div class="no l"><p class="bd b dl z fp nl fr fs nm fu fw dk translated">github.com</p></div></div><div class="np l"><div class="nx l nr ns nt np nu jw ng"/></div></div></a></div></div></div>    
</body>
</html>