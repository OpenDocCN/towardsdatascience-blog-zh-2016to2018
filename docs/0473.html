<html>
<head>
<title>How to use Twitter’s API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用 Twitter 的 API</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-use-twitters-api-c3e25c2ad8fe?source=collection_archive---------2-----------------------#2017-05-08">https://towardsdatascience.com/how-to-use-twitters-api-c3e25c2ad8fe?source=collection_archive---------2-----------------------#2017-05-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/799ff64b1d8db9a965a187b0e1bf2bb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/format:webp/1*G5wQOQ8CygD7eg3sXGcMMg.png"/></div></figure><p id="b44f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">为什么要使用 API？API 代表应用程序编程接口(API ),它们允许您访问仅在服务器上可用的资源。让我们学习如何使用 twitters 的 API。</p><p id="6d43" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">首先，你需要一个 twitter 账户，并附上你的电话号码作为验证。然后你需要去<a class="ae ks" href="https://apps.twitter.com/" rel="noopener ugc nofollow" target="_blank">apps.twitter.com</a>并创建应用程序，这样我们就可以引用 Twitter 为该应用程序生成的相应密钥。这些是我们将在应用程序中用来与 Twitter API 通信的键。</p><p id="8e61" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在进入代码，我们需要安装 python-twitter API 库</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="2ddd" class="lc ld iq ky b gy le lf l lg lh">!pip install python-twitter</span></pre><p id="81f3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">确保你理解 Twitters 的 API 使用规则，如果你不遵守他们的规则，他们会阻止你访问数据。这里有一个链接，链接到他们的一些费率限制【https://dev.twitter.com/rest/public/rate-limiting T2】</p><p id="f42a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在我们有了我们的应用程序，我们有了与应用程序相关联的键。</p><h2 id="a9d1" class="lc ld iq bd li lj lk dn ll lm ln dp lo kf lp lq lr kj ls lt lu kn lv lw lx ly bi translated">按键设置</h2><ul class=""><li id="6f68" class="lz ma iq jw b jx mb kb mc kf md kj me kn mf kr mg mh mi mj bi translated"><strong class="jw ir">消费者密钥</strong>——在你的应用页面“密钥和访问令牌”下找到它</li><li id="30c2" class="lz ma iq jw b jx mk kb ml kf mm kj mn kn mo kr mg mh mi mj bi translated"><strong class="jw ir">consumer _ secret</strong>——位于“密钥和访问令牌”选项卡中的<strong class="jw ir"> consumer_key </strong>下方</li><li id="3f8c" class="lz ma iq jw b jx mk kb ml kf mm kj mn kn mo kr mg mh mi mj bi translated"><strong class="jw ir"> access_token_key </strong> —您需要点击“生成令牌”按钮来获取此信息</li><li id="06c1" class="lz ma iq jw b jx mk kb ml kf mm kj mn kn mo kr mg mh mi mj bi translated"><strong class="jw ir"> access_token_secret </strong> —按下“生成令牌”后也可用</li></ul><p id="e391" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们将在下面的函数中插入这些特定的键</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="e840" class="lc ld iq ky b gy le lf l lg lh">import twitter, re, datetime, pandas as pd</span><span id="3c17" class="lc ld iq ky b gy mp lf l lg lh">class twitterminer():</span><span id="a7db" class="lc ld iq ky b gy mp lf l lg lh">request_limit   =   20    <br/>    api             =   False<br/>    data            =   []<br/>    <br/>    twitter_keys = {<br/>        'consumer_key':       , #add your consumer key<br/>        'consumer_secret':     , #add your consumer secret key<br/>        'access_token_key':    , #add your access token key<br/>        'access_token_secret':  #add your access token secret key<br/>    }<br/>    <br/>    def __init__(self,  request_limit = 20):<br/>        <br/>        self.request_limit = request_limit<br/>        <br/>        # This sets the twitter API object for use internall within the class<br/>        self.set_api()<br/>        <br/>    def set_api(self):<br/>        <br/>        self.api = twitter.Api(<br/>            consumer_key         =   self.twitter_keys['consumer_key'],<br/>            consumer_secret      =   self.twitter_keys['consumer_secret'],<br/>            access_token_key     =   self.twitter_keys['access_token_key'],<br/>            access_token_secret  =   self.twitter_keys['access_token_secret']<br/>        )</span><span id="3b5d" class="lc ld iq ky b gy mp lf l lg lh">def mine_user_tweets(self, user=" set default user to get data from", mine_retweets=False):</span><span id="4b36" class="lc ld iq ky b gy mp lf l lg lh">statuses   =   self.api.GetUserTimeline(screen_name=user, count=self.request_limit)<br/>        data       =   []<br/>        <br/>        for item in statuses:</span><span id="1d79" class="lc ld iq ky b gy mp lf l lg lh">mined = {<br/>                'tweet_id': item.id,<br/>                'handle': item.user.name,<br/>                'retweet_count': item.retweet_count,<br/>                'text': item.text,<br/>                'mined_at': datetime.datetime.now(),<br/>                'created_at': item.created_at,<br/>            }<br/>            <br/>            data.append(mined)<br/>            <br/>        return data</span></pre><p id="f4b7" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">然后，我们需要实例化我们的类，以便能够使用我们上面的函数。</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="48f0" class="lc ld iq ky b gy le lf l lg lh">mine = twitterminer()</span></pre><p id="a8ae" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">让我们使用 API 从唐纳德·特朗普的推特上获取一些推文</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="ed4b" class="lc ld iq ky b gy le lf l lg lh"># insert handle we like<br/>trump_tweets = miner.mine_user_tweets("realDonaldTrump")<br/>trump_df = pd.DataFrame(trump_tweets)</span></pre><p id="1026" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们现在已经成功地将来自唐纳德·特朗普推特的推文拉到我们的本地机器上进行分析。祝你收集数据顺利。</p></div></div>    
</body>
</html>