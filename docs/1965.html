<html>
<head>
<title>Fun with small image data-sets</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">有趣的小图像数据集</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/fun-with-small-image-data-sets-8c83d95d0159?source=collection_archive---------1-----------------------#2017-11-23">https://towardsdatascience.com/fun-with-small-image-data-sets-8c83d95d0159?source=collection_archive---------1-----------------------#2017-11-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="8d5a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">棒球还是板球？美元还是加元？</p><p id="071e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">假设您想为自己的特定任务构建一个图像分类器。你可能认为你需要收集大量的数据。令人惊讶的是，少量的训练图像足以产生合理的准确率(90–100%)。我将在这里讨论两个案例研究:将图像中的运动分类为棒球或板球，并将钞票图像识别为美元或加拿大元。</p><p id="eacb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我目前正在旧金山参加Fastai <a class="ae kl" href="https://www.usfca.edu/data-institute/certificates/deep-learning-part-one" rel="noopener ugc nofollow" target="_blank">深度学习</a>课程。到目前为止非常有趣。我尝试的两个案例(板球对棒球和美元对加元)都是基于第一课。该课程使用预先训练的模型resnet 34(Fastai的一位同学<a class="ae kl" href="http://teleported.in/posts/decoding-resnet-architecture/" rel="noopener ugc nofollow" target="_blank">在此</a>提供了关于resnet模型的更多细节)作为起点。使用fastai框架非常简单快捷。下面是这个难题主要部分的一个例子——调用学习者数据对象的fit方法来训练模型。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi km"><img src="../Images/b67aad4e664531761c393486ff673904.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/format:webp/1*WY6rakO_1SpR0UXAD86QWA.jpeg"/></div></figure><p id="b143" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第一课是深入研究使用卷积神经网络(CNN)模型来获得非常受欢迎的狗与猫Kaggle比赛的最新结果。我强烈建议你在这里看看<a class="ae kl" href="https://github.com/fastai/fastai" rel="noopener ugc nofollow" target="_blank">。课程是以Jupyter笔记本的形式，你需要有某种深度学习机器设置(流行的选择是AWS，Paperspace实例；或者定制的深度学习装备)。</a><a class="ae kl" href="https://www.crestle.com/" rel="noopener ugc nofollow" target="_blank"> Crestle </a>是另一个选项，让您几乎无需任何设置即可开箱运行Jupyter笔记本。</p><p id="c370" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">板球vs棒球</strong></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi ku"><img src="../Images/6b0ddc7c420b3d7c768df23aeb8578d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jKhhStGSkU6gu2WlXm_n1A.jpeg"/></div></div></figure><p id="212f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">板球和棒球是两项有着相似“特征”的运动，所以我试图区分它们。为了收集用于训练和测试的图像，我分别使用Google Image搜索了Cricket和Baseball这两个术语。我为每项运动下载了20张图片，并将它们分成训练(<strong class="jp ir"> 15张图片</strong>)和测试(<strong class="jp ir"> 5张图片</strong>)组。我能够用15幅训练图像获得90%的合理准确度(9/10的测试图像被正确分类)。这里有一些图片被分类的例子。预测分数越接近0表示棒球图像。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kz"><img src="../Images/d85774ec969a6c43c7f30046b705286f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1RQyaubNc8QDy59FlQkLug.jpeg"/></div></div></figure><p id="1c06" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在玩了这个模型之后，我发现0.1的学习率给出了很好的结果。由于训练图像的数量很少，所以我使用试错法来找到一个好的学习率。下面是一张分类错误的图片。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi la"><img src="../Images/8998a3665b3a7fe9a426621c6ed95923.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fdEj0JHQ-iiuwj9NFArQ1Q.jpeg"/></div></div></figure><p id="ccfa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过多次运行该模型并改变超参数，时不时地得到100%是可能的。我不确定100%的准确率是否意味着太多，因为测试图像的数量很少。接下来，我想用大量的有效图片来尝试一下，看看这个模型是如何推广的。</p><p id="ce8d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">美元对加元</strong></p><p id="9e9f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这次我用美钞做了同样的实验，分别用<strong class="jp ir"> 7张美元和加拿大元的图像</strong>进行训练，用<strong class="jp ir"> 5张图像</strong>进行测试。这一次，分类器能够轻松达到100%的准确率。以下是一些示例结果——预测得分越接近0，意味着美元钞票是加拿大的。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi lb"><img src="../Images/d92500c31930e7ad0360635d9b871f6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5kFapjNzeIA5VrdF6uRgMQ.png"/></div></div></figure><p id="ff18" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">另一种分析分类模型结果的常用方法是使用<a class="ae kl" href="http://www.dataschool.io/simple-guide-to-confusion-matrix-terminology/" rel="noopener ugc nofollow" target="_blank">混淆矩阵</a>，它沿着负45°对角线显示正确分类的分类变量。在这种情况下，没有美元被错误分类，因此我们看到下面的[5，0][0，5]模式。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi lc"><img src="../Images/bc7e13a204ad85f8e05079a9a25fe1da.png" data-original-src="https://miro.medium.com/v2/resize:fit:726/format:webp/1*0Rlgws9ixWjxNKKNyKVJwQ.jpeg"/></div></figure><p id="c710" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">结论</strong></p><p id="99e7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">许多领域都受到数据收集问题的困扰(生物医学图像、工业设置)。收集足够的图像数据可能很难或者非常昂贵。然而，我们不一定需要1000张图像来使用预先训练的模型构建我们自己的定制分类器。这对于原型制作和快速实验来说是个好消息。以下是一些值得进一步探索的方向:</p><ol class=""><li id="7314" class="ld le iq jp b jq jr ju jv jy lf kc lg kg lh kk li lj lk ll bi translated">自动下载定制图像，以便构建更好、更定制的分类器</li><li id="52ae" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">确定更适合小型数据集的技术/实践。将它们应用于收集数据困难/昂贵的领域</li><li id="c88c" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">尝试一些有趣的例子:船vs潜艇？这个人戴没戴眼镜？</li></ol><p id="8713" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">PS:这周我开始破解其中的一个问题。本系列的第二部分，阅读<a class="ae kl" href="https://medium.com/@nikhil.b.k_13958/fun-with-small-image-data-sets-part-2-54d683ca8c96" rel="noopener"> <em class="lr">人类是否戴着眼镜</em> </a>？</p></div></div>    
</body>
</html>