<html>
<head>
<title>On Average, You’re Using the Wrong Average — Part II</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">平均而言，你使用了错误的平均值——第二部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/on-average-youre-using-the-wrong-average-part-ii-b32fcb41527e?source=collection_archive---------2-----------------------#2018-03-04">https://towardsdatascience.com/on-average-youre-using-the-wrong-average-part-ii-b32fcb41527e?source=collection_archive---------2-----------------------#2018-03-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="f94f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">真实和模拟数据+使用R &amp; BigQuery的汇总统计动态</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/02a999e53ee772cd1dc40c5f091f8ae1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xUzSCpB1_b5ckB-qFSXHfA.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Depiction of harmonic, geometric &amp; arithmetic means of a simple geometric series, from <a class="ae lb" rel="noopener" target="_blank" href="/on-average-youre-using-the-wrong-average-geometric-harmonic-means-in-data-analysis-2a703e21ea0">Part I</a>.</figcaption></figure><h2 id="bb4f" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated">前言</h2><p id="5fb3" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated"><a class="ae lb" rel="noopener" target="_blank" href="/on-average-youre-using-the-wrong-average-geometric-harmonic-means-in-data-analysis-2a703e21ea0">本系列的第一部分</a>构建了一个实用的&amp;概念框架，用于在数据分析中使用鲜为人知的<a class="ae lb" href="https://en.wikipedia.org/wiki/Pythagorean_means" rel="noopener ugc nofollow" target="_blank">勾股方法</a>来理解&amp;。我竭尽全力(大约5000个单词)为普通观众建立直觉，只需要小学数学知识。</p><p id="edbe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这篇文章将会更深入一点&amp;更具技术性，探索这些方法在更丰富的模拟数据集下的动态变化，这些数据集来自于几个概率分布。然后，我们将这些与一些可比较的“真实世界”大数据集并置。我的目标也是更简洁和经济，假设有更高水平的数学和概率理论。</p></div><div class="ab cl ma mb hu mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="ij ik il im in"><h2 id="cf48" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated">毕达哥拉斯的意思是重述</h2><p id="bfb7" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">回想一下，有3种毕达哥拉斯方法符合不等式:</p><blockquote class="mh mi mj"><p id="ab18" class="jn jo mk jp b jq jr js jt ju jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj kk ij bi translated"><code class="fe mo mp mq mr b"><strong class="jp ir">harmonic mean </strong>≤<strong class="jp ir"> geometric mean </strong>≤<strong class="jp ir"> arithmetic mean</strong></code></p></blockquote><p id="b3ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">只有在数据集中的每个数字都是相同数字的极限情况下，它们才是相互等价的。</p><ul class=""><li id="8418" class="ms mt iq jp b jq jr ju jv jy mu kc mv kg mw kk mx my mz na bi translated"><code class="fe mo mp mq mr b"><strong class="jp ir">arithmetic mean</strong></code>通过简单的加法&amp;除法产生。</li><li id="3446" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated"><code class="fe mo mp mq mr b"><strong class="jp ir">geometric mean</strong></code>是通过乘法&amp;根产生的。</li><li id="953f" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated"><code class="fe mo mp mq mr b"><strong class="jp ir">harmonic mean</strong></code>是通过倒数，加上&amp;除法产生的。</li></ul><p id="a65c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">他们的方程式是:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ng"><img src="../Images/d8f0e24888522a120c354f3860a404e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aEAfFhzivXc3ytfydCXIGA.png"/></div></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nh"><img src="../Images/88be1ed1047b39607af5ce0fe39209d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LOC8EHgrAWIR-_YEO_Bv6g.png"/></div></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ni"><img src="../Images/66006e317587ee286679bad07aa9c09e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uoRZVi91Vzs5__eLQTDPng.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">via <a class="ae lb" href="https://en.wikipedia.org/wiki/Pythagorean_means" rel="noopener ugc nofollow" target="_blank">Wikipedia</a></figcaption></figure><p id="fa44" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，每一个都可以被导出或表达为彼此的重新配置。例如:</p><ul class=""><li id="6235" class="ms mt iq jp b jq jr ju jv jy mu kc mv kg mw kk mx my mz na bi translated"><code class="fe mo mp mq mr b"><strong class="jp ir">geometric mean</strong></code>就是数据集的对数转换值的<code class="fe mo mp mq mr b"><strong class="jp ir">arithmetic mean</strong></code>的反对数。它还可以<em class="mk">有时</em>保持缩放到一个共同分母的比率的顺序<code class="fe mo mp mq mr b"><strong class="jp ir">arithmetic means</strong></code>，或者至少产生类似的可信汇总值。</li><li id="033a" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated"><code class="fe mo mp mq mr b"><strong class="jp ir">harmonic mean</strong></code>是数据集倒数的<code class="fe mo mp mq mr b"><strong class="jp ir">arithmetic mean</strong></code>的倒数。它也可以通过数据集的适当<code class="fe mo mp mq mr b"><strong class="jp ir">weighted arithmetic mean</strong></code>来再现。</li></ul><p id="6894" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">经验法则:</p><ul class=""><li id="730f" class="ms mt iq jp b jq jr ju jv jy mu kc mv kg mw kk mx my mz na bi translated"><code class="fe mo mp mq mr b"><strong class="jp ir">arithmetic mean</strong></code>最适合于<em class="mk">加法</em>、<em class="mk">线性</em>、<em class="mk">对称</em>、<em class="mk">正态</em>/<em class="mk">高斯</em>数据集</li><li id="fb29" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated"><code class="fe mo mp mq mr b"><strong class="jp ir">geometric mean</strong></code>最适合于<em class="mk">乘法</em>、<em class="mk">几何</em>、<em class="mk">指数</em>、<em class="mk">对数正态</em>、<em class="mk">偏斜</em>数据集，以及不同尺度上的<em class="mk">比率</em> &amp; <em class="mk">复合增长率</em>。</li><li id="2872" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated"><code class="fe mo mp mq mr b"><strong class="jp ir">harmonic mean</strong></code>是三者中最罕见的，但就分子而言，它非常适合平均比率，如旅行率、一些财务指标&amp;各种专业应用从物理学到数学<a class="ae lb" href="https://en.wikipedia.org/wiki/Power%E2%80%93speed_number" rel="noopener ugc nofollow" target="_blank"/>&amp;机器学习模型的<a class="ae lb" href="https://en.wikipedia.org/wiki/Harmonic_mean#In_other_sciences" rel="noopener ugc nofollow" target="_blank">评估</a>。</li></ul><p id="6730" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">局限性:</p><ul class=""><li id="9c7b" class="ms mt iq jp b jq jr ju jv jy mu kc mv kg mw kk mx my mz na bi translated">由于相对罕见，<code class="fe mo mp mq mr b"><strong class="jp ir">geometric</strong></code> &amp; <code class="fe mo mp mq mr b"><strong class="jp ir">harmonic</strong></code>的意思可能很难解释&amp;误导观众期待“平均”更传统的含义</li><li id="91c1" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated"><code class="fe mo mp mq mr b"><strong class="jp ir">geometric mean</strong></code>实际上是“无单位”的，因为标度&amp;可解释单位在乘法运算中丢失(因子在不同标度上)</li><li id="e668" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated"><code class="fe mo mp mq mr b"><strong class="jp ir">Geometric</strong></code> &amp; <code class="fe mo mp mq mr b"><strong class="jp ir">harmonic</strong></code>表示不能容纳≤ 0的输入</li></ul><p id="0e6c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">更详细的讨论见<a class="ae lb" rel="noopener" target="_blank" href="/on-average-youre-using-the-wrong-average-geometric-harmonic-means-in-data-analysis-2a703e21ea0">第一部分</a>。我们现在将看到一些实际操作。</p></div><div class="ab cl ma mb hu mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="ij ik il im in"><h2 id="5909" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated">模拟数据集</h2><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nj"><img src="../Images/823f83d38fc2713b1264d54e249eaba5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MX8jetRF9adt7cERreiivg.png"/></div></div></figure><p id="6c90" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在第一部分中，我们观察了在平凡的加法和乘法数据集下勾股平均的动力学。在这里，我们将通过模拟r中各种概率分布的更丰富的数据集来扩展这个练习。</p><p id="1c72" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于我们的<em class="mk">加法</em>或<em class="mk">线性</em>数据集，我们将从<strong class="jp ir">随机正态</strong>分布中抽取10，000个样本，平均值为100 &amp;标准差为20，以避免抽取值≤ 0:</p><pre class="km kn ko kp gt nk mr nl nm aw nn bi"><span id="d5b5" class="lc ld iq mr b gy no np l nq nr">hist( <br/>  rnorm( 10000, 100, 20 ) <br/>  )</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ns"><img src="../Images/76b8d091cb3697ea6df1608754aa462f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*inlIUuByFWMB0BxaaGxa3g.png"/></div></div></figure><p id="cb98" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来我们将模拟三种类型的乘法数据集(尽管<a class="ae lb" href="https://en.wikipedia.org/wiki/Relationships_among_probability_distributions" rel="noopener ugc nofollow" target="_blank">有意义</a> <a class="ae lb" href="https://projecteuclid.org/euclid.im/1089229510" rel="noopener ugc nofollow" target="_blank">差异</a>，但它们通常<a class="ae lb" href="https://math.stackexchange.com/questions/164436/difference-between-power-law-distribution-and-exponential-decay" rel="noopener ugc nofollow" target="_blank">难以区分</a>):对数正态分布<strong class="jp ir">、<strong class="jp ir">指数分布</strong>、&amp;、<strong class="jp ir">幂律分布</strong>。</strong></p><p id="dfbd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有许多方法可以产生对数正态分布——基本上任何同分布随机变量的乘法相互作用都会产生对数正态分布——这就是为什么它在现实世界中如此频繁地出现，特别是在人类的努力中。为了简化&amp;的可解释性，我们将简单地将<a class="ae lb" href="https://en.wikipedia.org/wiki/E_(mathematical_constant)" rel="noopener ugc nofollow" target="_blank">欧拉数</a>提升到从<strong class="jp ir">正态</strong>分布中抽取的随机指数，然后加上100，使其处于我们的<strong class="jp ir">正态</strong>分布的范围内:</p><pre class="km kn ko kp gt nk mr nl nm aw nn bi"><span id="289a" class="lc ld iq mr b gy no np l nq nr">hist(<br/>  exp(1)^rnorm(10000,3,.9) + 100,<br/>  breaks = 39<br/> )</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ns"><img src="../Images/01fd3f104c30164e4054ef9bce0cef4c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kU_kAO2OmdMdHXa-b0ZzuA.png"/></div></div></figure><p id="3143" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从技术上讲，这是一个<strong class="jp ir">指数</strong>分布的特例，但是我们将通过R的<code class="fe mo mp mq mr b">rexp</code>函数模拟另一种变化，在这里我们简单地指定样本的数量&amp;衰减率(同样，将结果加100):</p><pre class="km kn ko kp gt nk mr nl nm aw nn bi"><span id="1f72" class="lc ld iq mr b gy no np l nq nr">hist(<br/>  rexp(10000, 1/10) +100<br/> )</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ns"><img src="../Images/6222999e7686de10607cd92aac29dd33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r8vEib93s9bZzCguDRLUkg.png"/></div></div></figure><p id="686a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，我们将通过将样本从<strong class="jp ir">正态</strong>分布提升到常数指数(再次是欧拉数，保持其自然<em class="mk"/>)来生成<strong class="jp ir">幂律</strong>分布，然后加上100:</p><blockquote class="mh mi mj"><p id="83b6" class="jn jo mk jp b jq jr js jt ju jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj kk ij bi translated">(注意，这与我们的<strong class="jp ir">对数正态</strong>方法相反，其中欧拉数是基数&amp;分布是指数)</p></blockquote><pre class="km kn ko kp gt nk mr nl nm aw nn bi"><span id="0714" class="lc ld iq mr b gy no np l nq nr">hist(<br/>  rnorm(10000, 3, 1)^exp(1) + 100<br/> )</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ns"><img src="../Images/4cc419d3f6df9daed9f9ec467cd31ee7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oEYkXWd-JXwlYttPE8qgFA.png"/></div></div></figure><p id="6ce9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好了，现在我们将使用<code class="fe mo mp mq mr b"><strong class="jp ir">ggridges</strong></code>包来更好地绘制我们的分布图。我们还会加载<code class="fe mo mp mq mr b"><strong class="jp ir">tidyverse</strong></code>包，像文明用户一样:</p><pre class="km kn ko kp gt nk mr nl nm aw nn bi"><span id="e304" class="lc ld iq mr b gy no np l nq nr">library(tidyverse)<br/>library(ggridges)</span></pre><p id="ab25" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们把我们的分布放入一个有序因子表中:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="8599" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们更巧妙的看看我们的发行版:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nv"><img src="../Images/f15a1092be81a21604db850d9695b8e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p1enGX7ij_pr4-17cGCc5A.png"/></div></div></figure><p id="b226" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">身材匀称的一群人。让我们计算一些汇总统计数据。</p><p id="c5e3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mk">既然R本身没有</em> <code class="fe mo mp mq mr b"><strong class="jp ir"><em class="mk">geometric</em></strong></code> <em class="mk">或者</em> <code class="fe mo mp mq mr b"><strong class="jp ir"><em class="mk">harmonic</em></strong></code> <em class="mk">的意思函数，我们就要稍微狡猾一点:</em></p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="344b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">输出:</p><pre class="km kn ko kp gt nk mr nl nm aw nn bi"><span id="379f" class="lc ld iq mr b gy no np l nq nr"># A tibble: 4 x 5<br/>  distribution median    am    gm    hm<br/>  &lt;fct&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;<br/>1 normal         99.6  99.9  97.7  95.4<br/>2 lognormal     120   129   127   125  <br/>3 exponential   107   110   110   109  <br/>4 power law     120   125   124   122</span></pre><p id="f1de" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">…并将它们添加到我们的图中:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nt nu l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">(note: I did some post-production editing for the subtitle legend cuz I can never bend gglegends sufficiently to my will — &amp; the median lines are a bit of a hack)</figcaption></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nv"><img src="../Images/476c532a484c9178e9a6cb894b9904c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J2J_py4ART_aCBdlyr8ijg.png"/></div></div></figure><p id="19f9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们立即注意到偏斜密度以及<a class="ae lb" href="https://en.wikipedia.org/wiki/Heavy-tailed_distribution" rel="noopener ugc nofollow" target="_blank">长&amp;厚尾</a>对均值分布的影响以及它们与中位数的关系:</p><ul class=""><li id="7be8" class="ms mt iq jp b jq jr ju jv jy mu kc mv kg mw kk mx my mz na bi translated">在我们的<strong class="jp ir">正态分布</strong>中，<code class="fe mo mp mq mr b"><strong class="jp ir">median</strong></code> &amp; <code class="fe mo mp mq mr b"><strong class="jp ir">arithmetic mean</strong></code>几乎完全相同。(<code class="fe mo mp mq mr b">99.6</code> &amp; <code class="fe mo mp mq mr b">99.9</code>分别按上表输出)。</li><li id="bb1a" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated">我们的其他分布的向右偏斜将所有的平均值拉向<code class="fe mo mp mq mr b"><strong class="jp ir">median</strong></code>的右边，这倾向于数据集的更密集的峰</li></ul><p id="32d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">虽然这里有点拥挤，但让我们通过调整x轴限制来仔细看看，又名<code class="fe mo mp mq mr b">xlim()</code>:</p><pre class="km kn ko kp gt nk mr nl nm aw nn bi"><span id="58d0" class="lc ld iq mr b gy no np l nq nr">...xlim(90, 150)...</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nv"><img src="../Images/d66cc55a5b4a14ed49d76fa5419cf32a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KrkEOuuRmjtXCWekPF0CAQ.png"/></div></div></figure><ul class=""><li id="465f" class="ms mt iq jp b jq jr ju jv jy mu kc mv kg mw kk mx my mz na bi translated">再次注意，在<strong class="jp ir">正常</strong>对称数据集中，<code class="fe mo mp mq mr b"><strong class="jp ir">geometric</strong></code> &amp; <code class="fe mo mp mq mr b"><strong class="jp ir">harmonic</strong></code>意味着有意低估了数据的“中点”，但大致等间距(每个约相隔2个单位)。</li><li id="4f4c" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated">在<strong class="jp ir">对数正态</strong>分布中，长(略细)的尾巴将均值拉离<code class="fe mo mp mq mr b"><strong class="jp ir">median</strong></code>所代表的有序中点很远，&amp;甚至会扭曲均值的分布，使得<code class="fe mo mp mq mr b"><strong class="jp ir">arithmetic</strong></code>比<code class="fe mo mp mq mr b"><strong class="jp ir">harmonic</strong></code>离<code class="fe mo mp mq mr b"><strong class="jp ir">geometric</strong></code>更远。</li><li id="00cd" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated">在我们的<strong class="jp ir">指数</strong>分布中，值是如此密集&amp;指数衰减的短细尾巴消失得如此之快，以至于我们的平均值也挤在一起——尽管严重的偏斜仍然将它们从<code class="fe mo mp mq mr b"><strong class="jp ir">median</strong></code>中移走。</li><li id="00cf" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated">我们的<strong class="jp ir">幂律</strong>分布衰减最慢，&amp;因此尾巴最粗。尽管如此，它在“身体”中几乎是正常的，不对称分布的偏斜是最轻微的。它的平均距离大致相等，但仍远离<code class="fe mo mp mq mr b"><strong class="jp ir">median</strong></code>。</li></ul><p id="9dbb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<strong class="jp ir">第一部分</strong> &amp;上面我提到的<code class="fe mo mp mq mr b"><strong class="jp ir">geometric</strong></code> &amp; <code class="fe mo mp mq mr b"><strong class="jp ir">arithmetic</strong></code>的对数关系是指:</p><blockquote class="mh mi mj"><p id="9a54" class="jn jo mk jp b jq jr js jt ju jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj kk ij bi translated"><code class="fe mo mp mq mr b"><strong class="jp ir">geometric mean</strong></code>只是数据集的对数转换值的<code class="fe mo mp mq mr b"><strong class="jp ir">arithmetic mean</strong></code>的反对数。</p></blockquote><p id="54a9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了证明这一点，让我们再看一下我们摘要统计表:</p><pre class="km kn ko kp gt nk mr nl nm aw nn bi"><span id="7066" class="lc ld iq mr b gy no np l nq nr"># A tibble: 4 x 5<br/>  distribution median    am    gm    hm<br/>  &lt;fct&gt;         &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;<br/>1 normal         99.6  99.9  97.7  95.4<br/>2 lognormal     120   129   <strong class="mr ir"><em class="mk">127</em></strong>   125  <br/>3 exponential   107   110   110   109  <br/>4 power law     120   125   124   122</span></pre><p id="1c1a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意我们的<strong class="jp ir">log normal</strong>T5:<code class="fe mo mp mq mr b">127</code>。</p><p id="4a5f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们将计算<em class="mk">对数转换后的</em>值的<code class="fe mo mp mq mr b"><strong class="jp ir">arithmetic mean</strong></code>:</p><pre class="km kn ko kp gt nk mr nl nm aw nn bi"><span id="ab60" class="lc ld iq mr b gy no np l nq nr">dist2$x %&gt;% log() %&gt;% mean()</span><span id="a80d" class="lc ld iq mr b gy nw np l nq nr"># output:<br/>[1] 4.84606</span></pre><p id="57ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">…&amp;然后拿那个号码的<em class="mk">反日志</em>:</p><pre class="km kn ko kp gt nk mr nl nm aw nn bi"><span id="8125" class="lc ld iq mr b gy no np l nq nr">exp(1)^4.84606</span><span id="c01b" class="lc ld iq mr b gy nw np l nq nr"># output<br/>[1] 127.2381</span></pre><p id="d737" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就这样。</p><p id="0c0a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，为了让大家明白这一点，让我们来看看为什么会这样(为什么对数正态分布得名):</p><pre class="km kn ko kp gt nk mr nl nm aw nn bi"><span id="43e6" class="lc ld iq mr b gy no np l nq nr"># subtract 100 we originally added before taking the log</span><span id="1e1f" class="lc ld iq mr b gy nw np l nq nr">(dist2$x — 100) %&gt;% log() %&gt;% hist()</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ns"><img src="../Images/23a7145c8681c77f2af9b6ef2c57f562.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8Pb0FsGuUBrGafZsvQRUZA.png"/></div></div></figure><p id="cd48" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">顾名思义，<strong class="jp ir">对数正态</strong>分布的<em class="mk">对数变换</em>产生了<strong class="jp ir">正态</strong>分布。因此，<code class="fe mo mp mq mr b"><strong class="jp ir">arithmetic mean</strong></code>的加法基在<strong class="jp ir">正态</strong>分布中产生的结果与<code class="fe mo mp mq mr b"><strong class="jp ir">geometric mean</strong></code>的乘法性质在<strong class="jp ir">对数正态</strong>分布中产生的结果相同。</p><p id="80c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们不应该对经过对数变换的<strong class="jp ir">对数正态</strong>数据集产生的完美正态分布印象太深，因为我们指定了产生<strong class="jp ir">对数正态</strong>值的精确的<a class="ae lb" href="https://en.wikipedia.org/wiki/Data_generating_process" rel="noopener ugc nofollow" target="_blank">数据生成过程</a>，&amp;实际上只是颠倒了该过程，以再现潜在的<strong class="jp ir">正态</strong>分布。</p><p id="3061" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在现实世界中，事情很少如此整齐，生成过程通常更加复杂&amp;未知或不可知。因此，关于如何建模的<a class="ae lb" href="https://projecteuclid.org/euclid.im/1089229510" rel="noopener ugc nofollow" target="_blank">困惑&amp;争议</a>描述经验得出的数据集。</p><p id="b69f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们来看一些这样的数据集&amp;看看有什么大惊小怪的。</p></div><div class="ab cl ma mb hu mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="ij ik il im in"><h2 id="e944" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated">真实世界数据</h2><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nj"><img src="../Images/7135ff003413e4651a35914ff37aa1ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xZVPyQ-pSWM-FPYN3TuEEA.jpeg"/></div></div></figure><p id="4739" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">虽然通常不如我们的模拟分布温顺，但真实世界的数据集通常至少类似于上述四类中的一类。</p><p id="0c78" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">正态</strong>分布——被大肆宣传的“钟形曲线”——最常出现在自然&amp;生物有机体&amp;相互作用很少的场景中。身高&amp;体重是典型的例子。因此，我的第一反应是寻找可靠的数据集。它满足了要求，但是关于<code class="fe mo mp mq mr b">n = 50</code>(数据集中一种花的观察数量)还有一些不足之处。我在想<em class="mk">更大的</em>。</p><p id="5c57" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以让我们加载<code class="fe mo mp mq mr b"><a class="ae lb" href="https://github.com/r-dbi/bigrquery" rel="noopener ugc nofollow" target="_blank">bigrquery</a></code>包，&amp;做<em class="mk"> bigRqueries </em>。</p><p id="d9db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mo mp mq mr b">library(bigrquery)</code></p><p id="78e6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">谷歌的BigQuery提供了大量真实数据的公共数据集，有些非常大，从基因组学到专利再到维基百科的文章统计。</p><p id="2b34" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">出于我们最初的目的，<code class="fe mo mp mq mr b">natality</code>数据集看起来足够生物化:</p><pre class="km kn ko kp gt nk mr nl nm aw nn bi"><span id="a7c9" class="lc ld iq mr b gy no np l nq nr">project &lt;- “YOUR-PROJECT-ID”</span><span id="9137" class="lc ld iq mr b gy nw np l nq nr">sql &lt;- “SELECT COUNT(*) <br/>        FROM `bigquery-public-data.samples.natality`”</span><span id="b68e" class="lc ld iq mr b gy nw np l nq nr">query_exec(sql, project = project, use_legacy_sql = F)</span></pre><p id="8144" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mk"> (protip:这里有很多数据，&amp;你得到的</em> <a class="ae lb" href="https://cloud.google.com/bigquery/pricing#free-tier" rel="noopener ugc nofollow" target="_blank"> <em class="mk">是按被访问的数据量收费的</em> </a> <em class="mk">，但是你每个月的第一TB是免费的。此外，尽管</em> <code class="fe mo mp mq mr b">SELECT *</code> <em class="mk">由于显而易见的原因而被极力劝阻，但</em> <code class="fe mo mp mq mr b">SELECT COUNT(*)</code> <em class="mk">实际上是一个自由操作，&amp;是一个扩展事物范围的好主意)</em></p><p id="9251" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">输出:</p><pre class="km kn ko kp gt nk mr nl nm aw nn bi"><span id="99a7" class="lc ld iq mr b gy no np l nq nr"><em class="mk">0 bytes processed</em><br/>  f0_<br/>1 137826763</span></pre><p id="129a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这还差不多，1.37亿婴儿记录。我们不太需要所有这些，所以让我们随机抽取1%的婴儿体重，取前一百万个结果&amp;看看我们得到了什么:</p><pre class="km kn ko kp gt nk mr nl nm aw nn bi"><span id="2c5a" class="lc ld iq mr b gy no np l nq nr">sql &lt;- “SELECT weight_pounds<br/>        FROM `bigquery-public-data.samples.natality`<br/>        WHERE RAND() &lt; .01”</span><span id="02a9" class="lc ld iq mr b gy nw np l nq nr">natal &lt;- query_exec(sql, project = project, use_legacy_sql = F,<br/>                    max_pages = 100)</span></pre><p id="e577" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">输出:</p><pre class="km kn ko kp gt nk mr nl nm aw nn bi"><span id="e70f" class="lc ld iq mr b gy no np l nq nr">Running job /: 7s:1.0 gigabytes processed<br/>Warning message: <br/>Only first 100 pages of size 10000 retrieved. Use max_pages = Inf to retrieve all.</span></pre><p id="d9ec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mo mp mq mr b">hist(natal$weight_pounds)</code>产量:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ns"><img src="../Images/39213dfd245fbb32b38e9efbfc1beea1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VKAXf9oa36vHnCqUzsYyzQ.png"/></div></div></figure><p id="3ed6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">正常</strong> af imo。</p><p id="016a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，为了找到一些有偏差的乘法数据，让我们超越生物学，进入社会学。</p><p id="fb53" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将查看<em class="mk"> New York </em>数据集，其中包含各种城市信息，包括乘坐黄色&amp;绿色出租车的出行。</p><pre class="km kn ko kp gt nk mr nl nm aw nn bi"><span id="0458" class="lc ld iq mr b gy no np l nq nr">sql &lt;- “SELECT COUNT(*) <br/>        FROM `nyc-tlc.green.trips_2015`”</span><span id="e15b" class="lc ld iq mr b gy nw np l nq nr">query_exec(sql, project = project, use_legacy_sql = F)</span></pre><p id="ec37" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">输出:</p><pre class="km kn ko kp gt nk mr nl nm aw nn bi"><span id="c145" class="lc ld iq mr b gy no np l nq nr"><em class="mk">0 bytes processed</em><br/>  f0_                                                               <br/>1 9896012</span></pre><p id="f1e3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不到1000万，所以我们来看看整个旅程的距离:</p><p id="a7bb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="mk">(这可能需要一段时间)</em></p><pre class="km kn ko kp gt nk mr nl nm aw nn bi"><span id="566b" class="lc ld iq mr b gy no np l nq nr">sql &lt;- "SELECT trip_distance FROM `nyc-tlc.green.trips_2015`"</span><span id="b7c7" class="lc ld iq mr b gy nw np l nq nr">trips &lt;- query_exec(sql, project = project, use_legacy_sql = F)</span><span id="2959" class="lc ld iq mr b gy nw np l nq nr">hist(trips$trips_distance)</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ns"><img src="../Images/d2e78a6d25228b68250663c0f237d6b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dRCWGEZVgLgu_Li0w8vDmw.png"/></div></div></figure><p id="aff8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi">-_-</p><p id="40b8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">看起来有一些极端的异常值把我们的x轴拉到了800英里。糟糕的出租车之旅。让我们把这个范围缩小到20英里以内&amp;再看一看:</p><p id="6bdc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mo mp mq mr b">trips$trip_distance %&gt;% subset(. &lt;= 20) %&gt;% hist()</code></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ns"><img src="../Images/c4d9356a1fe7213185bf47779e797c1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j7_rLwAM_5QsRlPihbdmSg.png"/></div></div></figure><p id="1fda" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就是我们，对数正态分布的一个警示标志:长尾<em class="mk"/>。让我们通过绘制日志直方图来检查数据的对数正态性:</p><p id="a665" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mo mp mq mr b">trips$trip_distance %&gt;% subset(. &lt;= 20) %&gt;% log() %&gt;% hist()</code></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ns"><img src="../Images/7354f2d2773484cd2620854fa79e64b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XIpUMcjR2CofGJ_B3xTVuA.png"/></div></div></figure><p id="32a8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正常的<em class="mk">鱼</em>肯定，但我们超过了标记一点&amp;现在观察到一点左歪斜。唉，现实世界又来了。但是可以肯定地说，对数正态分布在这里并不是一个完全荒谬的模型。</p><p id="a485" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">继续前进。让我们找到更多的<a class="ae lb" href="https://en.wikipedia.org/wiki/Heavy-tailed_distribution" rel="noopener ugc nofollow" target="_blank">重尾</a>数据，这次是在一个更接近我自己的数字网络分析专业亲和力的领域:Github数据集:</p><pre class="km kn ko kp gt nk mr nl nm aw nn bi"><span id="eb07" class="lc ld iq mr b gy no np l nq nr">sql &lt;- "SELECT COUNT(*)<br/>        FROM `bigquery-public-data.samples.github_nested`"</span><span id="1c17" class="lc ld iq mr b gy nw np l nq nr">query_exec(sql, project = project, use_legacy_sql = F)</span></pre><p id="0a6d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">输出:</p><pre class="km kn ko kp gt nk mr nl nm aw nn bi"><span id="af15" class="lc ld iq mr b gy no np l nq nr"><em class="mk">0 bytes processed</em><br/>  f0_<br/>1 2541639</span></pre><p id="e50d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">250万行。由于我开始担心我的本地机器的内存，我们将使用我们的随机采样器&amp;百万行定界符来获得每个github库的“观察者”计数:</p><pre class="km kn ko kp gt nk mr nl nm aw nn bi"><span id="6b2a" class="lc ld iq mr b gy no np l nq nr">sql &lt;- “SELECT repository.watchers <br/>        FROM `bigquery-public-data.samples.github_nested`<br/>        WHERE RAND() &lt; .5”</span><span id="5a13" class="lc ld iq mr b gy nw np l nq nr">github &lt;- query_exec(sql, project = project, use_legacy_sql = F,<br/>                     max_pages = 100)</span><span id="07ce" class="lc ld iq mr b gy nw np l nq nr">github$watchers %&gt;% hist()</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ns"><img src="../Images/c2a25248f277b289d93a7836b5a632de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dx6lhA2ZzduLR0uo2chxVg.png"/></div></div></figure><p id="a4ca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">同样，极端的长尾动态，所以让我们做一些修整:</p><p id="3c47" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mo mp mq mr b">github$watchers %&gt;% subset(5 &lt; . &amp; . &lt; 3000) %&gt;% hist()</code></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ns"><img src="../Images/7870ea8bc8f0637f022ab14657955391.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D4ikauyCYdZWHjNGfPAC_g.png"/></div></div></figure><p id="d508" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">指数af。</p><p id="f9a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是又是<strong class="jp ir"> lognormal </strong>吗？</p><p id="0d26" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mo mp mq mr b">github$watchers %&gt;% subset(5 &lt; . &amp; . &lt; 3000) %&gt;% log() %&gt;% hist()</code></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ns"><img src="../Images/1195b0af884893fd64b68d7560481968.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_7Irsbiq1gb7rXGVXn0jyQ.png"/></div></div></figure><p id="7fba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不要。</p><p id="0348" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">谁知那只稀有的野兽:<a class="ae lb" href="https://www.vosesoftware.com/riskwiki/LogUniformdistribution.php" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir"/>分布</a>！</p><p id="ddfe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们从大数据瓮中再抽取一个，这一次看几十个<a class="ae lb" href="https://news.ycombinator.com/" rel="noopener ugc nofollow" target="_blank">黑客新闻</a>帖子:</p><pre class="km kn ko kp gt nk mr nl nm aw nn bi"><span id="f655" class="lc ld iq mr b gy no np l nq nr">sql &lt;- “SELECT COUNT(*)<br/>        FROM `bigquery-public-data.hacker_news.full`”</span><span id="6ce4" class="lc ld iq mr b gy nw np l nq nr">query_exec(sql, project = project, use_legacy_sql = F)</span></pre><p id="b2f5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">输出:</p><pre class="km kn ko kp gt nk mr nl nm aw nn bi"><span id="72dd" class="lc ld iq mr b gy no np l nq nr"><em class="mk">0 bytes processed</em><br/>  f0_<br/>1 16489224</span></pre><p id="5e04" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi">…</p><pre class="km kn ko kp gt nk mr nl nm aw nn bi"><span id="aa0a" class="lc ld iq mr b gy no np l nq nr">sql &lt;- “SELECT score<br/>        FROM `bigquery-public-data.hacker_news.full`<br/>        WHERE RAND() &lt; .1”</span><span id="cd59" class="lc ld iq mr b gy nw np l nq nr">hn &lt;- query_exec(sql, project = project, use_legacy_sql = F,<br/>                 max_pages = 100)</span><span id="74b6" class="lc ld iq mr b gy nw np l nq nr">hn$score %&gt;% hist()</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ns"><img src="../Images/fb513f370123ca0607f3ec60104f7793.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mby9wKLKUrMC0b3-b1OOpQ.png"/></div></div></figure><p id="9d11" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi">…</p><p id="3bca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mo mp mq mr b">hn$score %&gt;% subset(10 &lt; . &amp; . &lt;= 300) %&gt;% hist()</code></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ns"><img src="../Images/5e2a62a14607ea206848df059ef74077.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*15Y6GNCTfxnFf4S8osx-4w.png"/></div></div></figure><p id="ef5b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">较慢的衰减(一旦修整)。至于对数变换呢？</p><p id="8577" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mo mp mq mr b">hn$score %&gt;% subset(10 &lt; . &amp; . &lt;= 300) %&gt;% log() %&gt;% hist()</code></p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ns"><img src="../Images/ef994f847de4879dfa315e0ed4ff836b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TrsB_P2zNnBcn0-o1G6ZWw.png"/></div></div></figure><p id="c90a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">再次粗略地用向右衰减的<strong class="jp ir">对数均匀化</strong>。</p><p id="0ea6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我粗略地搜索了一下野外的<strong class="jp ir">幂律</strong>分布，结果证明毫无结果，这也许并不奇怪，因为它们最常出现在<a class="ae lb" href="https://icon.colorado.edu/#!/" rel="noopener ugc nofollow" target="_blank">网络科学</a>中(&amp;，<a class="ae lb" href="https://www.quantamagazine.org/scant-evidence-of-power-laws-found-in-real-world-networks-20180215/" rel="noopener ugc nofollow" target="_blank">似乎比最初声称的</a>还要稀少)。</p><p id="22df" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在任何情况下，让我们组织我们真实世界的数据集，就像我们对模拟分布所做的那样&amp;比较性地绘制它们。我们将对它们进行归一化，再次将它们集中在100左右:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="08d5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在开始绘图:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nv"><img src="../Images/3316d6093463837dabb34158e6076f7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4GlSTMoDb4P4K48LoB6saw.png"/></div></div></figure><p id="c8c5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">与它们来自的真实世界一样，边缘比我们模拟的分布要粗糙一些。仍然非常相似。让我们将它们与来自不可或缺的托马斯·林·彼得森的新(&amp; excellent) <a class="ae lb" href="https://github.com/thomasp85/patchwork" rel="noopener ugc nofollow" target="_blank">拼接包</a>并排放在一起:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nv"><img src="../Images/84a085d635ea3ad6ff9304faca477539.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ydWjl0TopmIgYb509bkY6g.png"/></div></div></figure><p id="c4ff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">乍看之下，我们的模拟分布将为其相邻的真实世界数据集提供合理的模型，除了<code class="fe mo mp mq mr b"><strong class="jp ir">power law</strong> -&gt; <strong class="jp ir">hacker news scores</strong></code>，其中衰减的凹度&amp;尾部的权重有很大不同。</p><p id="ae78" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当然，还有许多更严格的模型拟合等测试，但让我们像以前一样，通过绘制分布的汇总统计来再看一看。</p><blockquote class="mh mi mj"><p id="1eea" class="jn jo mk jp b jq jr js jt ju jv jw jx ml jz ka kb mm kd ke kf mn kh ki kj kk ij bi translated">不幸的是，关于标准化的真实世界数据的一些东西干扰了我的汇总统计计算，它们都或多或少地彼此无法区分。我怀疑这与计算机在浮点运算上的挣扎有关(但也可能与我自己在算术上的挣扎有关)。在任何情况下，我们将不得不使用我们的非标准化的真实世界数据，这意味着我们将不得不单独绘制它们&amp;尝试手动排列ggridge拼接。</p></blockquote><p id="ba0b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先编译我们的非标准化分布并计算汇总统计数据:</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="7d1b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在开始绘图(这很难看，因为我们必须为每个真实的分布创建单独的绘图，但是<em class="mk">拼接</em>允许我们优雅地定义布局):</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nt nu l"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nv"><img src="../Images/b20c237420220f615dff315bca3c2ce4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BRFA2fCeRe_nVCms7MUsLQ.png"/></div></div></figure><p id="5bbf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有趣的是，我们真实世界的数据集汇总统计数据似乎比我们模拟的分布更加分散。让我们放大来仔细看看。</p><p id="e258" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我不会转贴所有代码，但基本上只是修改了<code class="fe mo mp mq mr b">pm1</code>，让<code class="fe mo mp mq mr b">xlim(90, 150)</code> &amp;取消了其余情节中<code class="fe mo mp mq mr b">xlim()</code>行的注释:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nv"><img src="../Images/adfcb92a6ea53a605ca5aeb038ff4d90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4-FeqHdcoQeotXk-kkXuJA.png"/></div></div></figure><p id="fbfe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里甚至更明显，但是对于正态分布:汇总统计动态差异很大，这应该让我们在容易地“目测”理想化模型与现实世界数据的拟合时暂停。</p><p id="dece" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就结束了我们在模拟的&amp;真实世界分布下对<strong class="jp ir">毕达哥拉斯意义</strong>的探索。</p><p id="0aae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您还没有，请查看<a class="ae lb" rel="noopener" target="_blank" href="/on-average-youre-using-the-wrong-average-geometric-harmonic-means-in-data-analysis-2a703e21ea0">第一部分</a>以获得更低级、更明确的&amp;直观介绍。参考资料见下文&amp;进一步阅读。</p><p id="e93b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">还有，关注我更多这样的！</p><p id="bad7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">— <br/>在推特上关注:<a class="ae lb" href="https://www.twitter.com/dnlmc" rel="noopener ugc nofollow" target="_blank">@ dnlmc</a>T3】LinkedIn:【linkedin.com/in/dnlmc】T4T6】Github:<a class="ae lb" href="https://github.com/dnlmc" rel="noopener ugc nofollow" target="_blank">https://github.com/dnlmc</a></p></div><div class="ab cl ma mb hu mc" role="separator"><span class="md bw bk me mf mg"/><span class="md bw bk me mf mg"/><span class="md bw bk me mf"/></div><div class="ij ik il im in"><h2 id="22b5" class="lc ld iq bd le lf lg dn lh li lj dp lk jy ll lm ln kc lo lp lq kg lr ls lt lu bi translated">选择参考文献和进一步阅读</h2><p id="04b1" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated"><strong class="jp ir">第一部分</strong></p><ul class=""><li id="9fb6" class="ms mt iq jp b jq jr ju jv jy mu kc mv kg mw kk mx my mz na bi translated"><a class="ae lb" href="https://en.wikipedia.org/wiki/Pythagorean_means" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Pythagorean_means</a></li><li id="d9e9" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated"><a class="ae lb" href="https://en.wikipedia.org/wiki/Summary_statistics" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Summary_statistics</a></li><li id="f84b" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated"><a class="ae lb" href="https://en.wikipedia.org/wiki/Central_tendency" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Central_tendency</a></li><li id="0e93" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated"><a class="ae lb" href="https://www.stat.berkeley.edu/~stark/SticiGui/Text/location.htm" rel="noopener ugc nofollow" target="_blank">位置测量&amp;展开</a>”—stat.berkeley.edu</li><li id="7821" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated">"<a class="ae lb" href="https://www.linkedin.com/pulse/20140715160509-29681087-median-vs-average-household-income/" rel="noopener ugc nofollow" target="_blank">中位数vs平均家庭收入</a> " — LinkedIn</li><li id="02a2" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated">"<a class="ae lb" href="http://wkuappliedeconomics.org/indblogs/mean-vs-median-income-which-one-to-use-and-what-it-means-for-south-central-kentucky/" rel="noopener ugc nofollow" target="_blank">平均收入vs中位收入</a>"</li><li id="6d0e" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated">你应该用几何平均数来总结数据</li><li id="b89e" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated">”<a class="ae lb" href="https://stats.stackexchange.com/questions/23117/which-mean-to-use-and-when" rel="noopener ugc nofollow" target="_blank">哪个‘意思’要用&amp;当？</a> " —堆栈溢出</li><li id="adc3" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated">"<a class="ae lb" href="https://www.quora.com/When-is-it-most-appropriate-to-take-the-arithmetic-mean-vs-geometric-mean-vs-harmonic-mean" rel="noopener ugc nofollow" target="_blank">什么时候取算术平均值vs几何平均值vs调和平均值最合适？</a>”—Quora</li><li id="3cee" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated"><a class="ae lb" href="http://economistatlarge.com/r-guide/arithmetic-harmonic-geometric-means-r" rel="noopener ugc nofollow" target="_blank">算术，调和&amp;几何意思同R </a></li><li id="1f83" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated">"<a class="ae lb" href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2621087" rel="noopener ugc nofollow" target="_blank">使用市盈率调和平均值来提高公司估值</a> " —期刊文章</li></ul><p id="165e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第二部分</strong></p><ul class=""><li id="44da" class="ms mt iq jp b jq jr ju jv jy mu kc mv kg mw kk mx my mz na bi translated"><a class="ae lb" href="https://en.wikipedia.org/wiki/Heavy-tailed_distribution" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Heavy-tailed_distribution</a></li><li id="eb27" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated"><a class="ae lb" href="https://en.wikipedia.org/wiki/Relationships_among_probability_distributions" rel="noopener ugc nofollow" target="_blank">https://en . Wikipedia . org/wiki/Relationships _ inter _ probability _ distributions</a></li><li id="f63c" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated"><a class="ae lb" href="http://www.win-vector.com/blog/2010/02/living-in-a-lognormal-world/" rel="noopener ugc nofollow" target="_blank">http://www . win-vector . com/blog/2010/02/living-in-a-log normal-world/</a></li><li id="6de2" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated">"<a class="ae lb" href="https://projecteuclid.org/euclid.im/1089229510" rel="noopener ugc nofollow" target="_blank">幂律和对数正态分布生成模型简史</a> " —期刊文章</li><li id="9dc4" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated">"<a class="ae lb" href="https://math.stackexchange.com/questions/164436/difference-between-power-law-distribution-and-exponential-decay" rel="noopener ugc nofollow" target="_blank">幂律分布与指数衰减的区别</a> " —堆叠交换</li><li id="3bee" class="ms mt iq jp b jq nb ju nc jy nd kc ne kg nf kk mx my mz na bi translated">"<a class="ae lb" href="https://www.quantamagazine.org/scant-evidence-of-power-laws-found-in-real-world-networks-20180215/" rel="noopener ugc nofollow" target="_blank">现实世界网络中发现的幂律证据不足</a> " —量子杂志</li></ul></div></div>    
</body>
</html>