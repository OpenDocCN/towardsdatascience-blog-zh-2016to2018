<html>
<head>
<title>Vehicle Detection using Support Vector Machine(SVM)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于支持向量机(SVM)的车辆检测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/vehicle-detection-using-support-vector-machine-svm-19e073b61d16?source=collection_archive---------1-----------------------#2018-04-22">https://towardsdatascience.com/vehicle-detection-using-support-vector-machine-svm-19e073b61d16?source=collection_archive---------1-----------------------#2018-04-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="76b0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是从视频中成功检测到汽车的输出视频:</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="kq kr l"/></div></figure><p id="e63f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">分析:</strong></p><p id="465a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我已经完成了Udacity自动驾驶汽车项目的车辆检测项目。在这里，我试图提供使用支持向量机(SVM)检测车辆的详细分析。</p><p id="63ea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在此之前，为了理解使用SVM实现车辆检测，我们需要知道一些术语:</p><h1 id="3082" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated"><strong class="ak">图像特征提取:</strong></h1><p id="dc64" class="pw-post-body-paragraph jn jo iq jp b jq lq js jt ju lr jw jx jy ls ka kb kc lt ke kf kg lu ki kj kk ij bi translated">我做的第一件也是最重要的事情是从图像中提取特征。图像中有许多可以提取的特征，这些特征可以帮助训练我们的分类器。通过仅从称为特征描述符的图像中提取有用的信息来表示图像。我用于车辆检测的一个重要的T4特征描述符是猪:</p><p id="349f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">梯度方向直方图(HOG): </strong></p><p id="127c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">形状是表征任何物体的重要参数之一。HOG是一种特征描述符，用于根据对象的形状来表征对象。该技术计算图像提及部分中每个<strong class="jp ir">梯度方向</strong>的直方图(出现次数)。但是等等，到底什么是<strong class="jp ir">渐变定向</strong>？？？正如我们所知，每张图像都有颜色和亮度。这些性质的方向变化可以称为梯度取向。以下是特征提取的逐步过程，其中也包括HOG:</p><ol class=""><li id="ec4a" class="lv lw iq jp b jq jr ju jv jy lx kc ly kg lz kk ma mb mc md bi translated"><strong class="jp ir">提取图像的空间特征:</strong></li></ol><p id="82ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">调整图像大小后，我们仍然保留了图像的所有特征。因此，我们调整了图像的大小，有了它的帮助，我们的代码会运行得更快，而不会丢失任何信息。这可以在打开cv函数cv2.resize()的帮助下完成。</p><p id="a5b6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 2。图像色彩空间转换:</strong></p><p id="8f60" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将图像转换到特定的<strong class="jp ir">色彩空间</strong>以从所选色彩通道中提取信息:</p><p id="811f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以将图像转换为以下任何色彩空间:</p><p id="3733" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">RGB、HSV、YCrCb、YUV、LUV、HLS</p><p id="65b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如，如果你想识别一个物体在阴影下的图像，我们可以使用它们的一些属性，如图像的亮度或饱和度，来更有效地对一些阴影下的车辆进行分类。这可以通过使用HLS色彩空间通道来完成。</p><p id="3ef3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 3。颜色直方图提取:</strong></p><p id="c30f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们借助函数numpy.histogram()获取图像的颜色直方图。这在存储图像的不同特征时非常重要。</p><p id="ca47" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 4。猪:</strong></p><p id="5843" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如上所述，HOG是我在特征提取过程中使用的最后一步。我为hog使用的函数是HOG()。下面是图像的hog特征的可视化:</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div class="gh gi me"><img src="../Images/da3f6b4bac0f2fd75d8817487e0018a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*bYXPQf9cI7jWbxMmFyWteg.png"/></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk">Hog feature of a car</figcaption></figure><p id="151f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">特征提取完成后，现在开始训练我们的分类器。我用过rbf SVM(支持向量机中的径向基函数)。早些时候，我尝试使用线性SVM模型，但由于准确性较低，我的代码在许多地方无法检测到车辆。使用rbg SVM将我的准确率提高到99.13 %。</p><h1 id="c5e4" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated"><strong class="ak">使用滑动窗口检测汽车:</strong></h1><p id="c1d6" class="pw-post-body-paragraph jn jo iq jp b jq lq js jt ju lr jw jx jy ls ka kb kc lt ke kf kg lu ki kj kk ij bi translated">既然分类器被训练，我们使用滑动窗口概念。对于车窗的每个区域，我们应用图像分类器来检查是否在该区域检测到车辆。请注意，汽车的大小将根据汽车离我们的汽车有多远而有所不同。下面是一个这样的例子，由于汽车与中央摄像机的距离不同，汽车尺寸也不同:</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi ml"><img src="../Images/22a46546a1a4e2b856ec6908939227d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nsw_mYPaTvfNFIWET5JHkg.png"/></div></div></figure><p id="90af" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，我使用了3个不同大小的矩形窗口，它们将贯穿整个图像并检测汽车，如果有的话。我选择的窗口尺寸是64x64、96x96和128x128。如果有汽车出现在窗口，我们将窗口位置保存到一个变量中。实施之后，我仍然面临两个问题:</p><ol class=""><li id="501a" class="lv lw iq jp b jq jr ju jv jy lx kc ly kg lz kk ma mb mc md bi translated"><strong class="jp ir">单个汽车图像的窗口太多:</strong></li></ol><p id="0523" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">虽然在图像的某些部分检测到了汽车，但是还有许多窗口在检测汽车。下面是我为图片中的两辆车准备的窗户:</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi mq"><img src="../Images/567f389888434385c1d8464533e162b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*OL93WD-yA0vcnZKIvWheXQ.png"/></div></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk">Multiple windows</figcaption></figure><p id="1def" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我的目标是只有一个窗口，而不是这么多的窗口。</p><p id="a7ce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 2。误车检测(误报)</strong></p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/26074275f03da09c8b3fc74ec01b37d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:968/format:webp/1*BjAu1x6gS8lRs0P4QBPnlg.png"/></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk">False positive</figcaption></figure><p id="6faa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在是项目的最后一部分，<strong class="jp ir">热图。</strong>我创建了所有汽车检测的热图，对于每个检测，我将热图[window_img]增加1。现在，在热图的帮助下，我将只保留一个窗口，而不是一辆车的多个窗口。此外，我将拒绝一些窗口的基础上，一些阈值。这是我的热图中具有多个(重叠)窗口的图像的外观:</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi mq"><img src="../Images/e1bfcc5c2678a892fbb5f31901b9dd11.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*wt-tVxhxm2syeJ3ekDMoPw.png"/></div></div></figure><p id="6f26" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下是应用热图后的结果图像:</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="mm mn di mo bf mp"><div class="gh gi mq"><img src="../Images/3d9c8a074143393e90b56fcf63a42399.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/format:webp/1*-u1cbs_sQJf21nbJzR-gcA.png"/></div></div><figcaption class="mh mi gj gh gi mj mk bd b be z dk">Detected cars from an image</figcaption></figure><p id="5f33" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">虽然汽车被正确地检测到，但我仍然觉得这个视频有一些局限性。处理这段视频花了大约30分钟。此外，这在我们有其他物体(如行人)的其他场景中可能并不完美。在接下来的日子里，我一定会尝试YOLO来提高准确性！！</p></div></div>    
</body>
</html>