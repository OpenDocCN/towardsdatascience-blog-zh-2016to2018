<html>
<head>
<title>How to Bring Keras Models onto Android with ZERO Knowledge of Tensorflow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在对 Tensorflow 一无所知的情况下将 Keras 模型带到 Android 上</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-convert-from-keras-to-tflite-with-zero-knowledge-of-tensorflow-5448a296ae67?source=collection_archive---------5-----------------------#2018-08-14">https://towardsdatascience.com/how-to-convert-from-keras-to-tflite-with-zero-knowledge-of-tensorflow-5448a296ae67?source=collection_archive---------5-----------------------#2018-08-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/9280ca5c5dad6ab6eee7c620690b33dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h2X9ckg3FJr4FGSfwh0F2w.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/photos/0VGG7cqTwCo?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Rodion Kutsaev</a> on <a class="ae kc" href="https://unsplash.com/search/photos/android?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="98a6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你刚刚创造了喀拉斯最惊人的神经网络。但是有一个问题。</p><p id="da97" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">目前，您的网络只存在于您的计算机上。它不能从那里改变世界。</p><p id="0783" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你首先想到的是把它放到你的手机上。现在手机比人多，这是一个让你的神经网络真正到达需要它的人手中的极好策略。</p><p id="f36f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在 Android 手机上运行神经网络最流行的库之一是 Tensorflow Lite。要使用它，您需要将 Keras .h5 文件转换为 Tensorflow。tflite 文件。对于那些不熟悉 Tensorflow 的 Keras 用户来说，这可能是一项艰巨的任务。在本文中，我将展示如何在几乎不了解 Windows 操作系统上的 Tensorflow 的情况下实现这一点。</p><p id="ab81" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第一步，我们要将 Keras .h5 文件转换成张量流。pb 文件。为此，我们将下载 keras_to_tensorflow 工具，可在此处找到<a class="ae kc" href="https://github.com/amir-abdi/keras_to_tensorflow" rel="noopener ugc nofollow" target="_blank">。</a></p><div class="lb lc gp gr ld le"><a href="https://github.com/amir-abdi/keras_to_tensorflow" rel="noopener  ugc nofollow" target="_blank"><div class="lf ab fo"><div class="lg ab lh cl cj li"><h2 class="bd ir gy z fp lj fr fs lk fu fw ip bi translated">阿米尔-阿卜迪/喀拉斯 _ 托 _ 滕索福尔</h2><div class="ll l"><h3 class="bd b gy z fp lj fr fs lk fu fw dk translated">keras _ to _ tensorflow——将训练好的 keras 模型转换成推理 tensor flow 模型的通用代码</h3></div><div class="lm l"><p class="bd b dl z fp lj fr fs lk fu fw dk translated">github.com</p></div></div><div class="ln l"><div class="lo l lp lq lr ln ls jw le"/></div></div></a></div><p id="5f20" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在您下载了 repo 并将您的模型(我们称之为 model.h5)添加到该文件夹后，使用命令行导航到该文件夹并键入:</p><pre class="lt lu lv lw gt lx ly lz ma aw mb bi"><span id="0b31" class="mc md iq ly b gy me mf l mg mh">python keras_to_tensorflow.py -input_model_file model.h5</span></pre><p id="f9b7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您将生成一个 Tensorflow model.pb 文件。请注意，除非指定，否则此。pb 模型将被称为 output_node，这对于下一个转换步骤非常重要。您还应该知道输入节点的名称，在本例中是 input_1。</p><p id="bd36" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们需要转换张量流。pb 文件到 Tensorflow Lite。使用 toco 工具创建 tflite 文件。不幸的是，我似乎无法让这个工具在 Windows 上正常工作，我看到许多论坛记录了其他人经历类似的挣扎。为了解决这个问题，我们将使用 Linux。</p><p id="ffd2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先下载 VirtualBox <a class="ae kc" href="https://www.virtualbox.org/wiki/Downloads" rel="noopener ugc nofollow" target="_blank">这里</a>(这是我们的虚拟机)和正确的 Ubuntu 版本(对我来说是 64 位)从<a class="ae kc" href="http://releases.ubuntu.com/16.04/" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="137f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我在这里找到了一篇关于如何用 Ubuntu 安装 VirtualBox 的优秀文章。跟着它走。我遇到的一个问题是 VirtualBox 只允许我安装 32 位版本的 Ubuntu。为了解决这个问题，我需要访问我的 BIOS 并启用虚拟化技术。</p><p id="0b2b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一旦你启动并运行了 Ubuntu，右击桌面打开一个终端。</p><p id="5bd3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您将需要安装 python，这可以通过使用:</p><pre class="lt lu lv lw gt lx ly lz ma aw mb bi"><span id="63bc" class="mc md iq ly b gy me mf l mg mh">$ sudo apt-get install python3.6<br/>$ sudo apt-get install python3-pip python3-dev</span></pre><p id="38f4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后安装 Tensorflow。</p><pre class="lt lu lv lw gt lx ly lz ma aw mb bi"><span id="525f" class="mc md iq ly b gy me mf l mg mh">$ pip3 install tensorflow==1.6.0</span></pre><p id="c23c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我发现 Tensorflow 1.5 无法转换我的模型的一些功能，但这个问题在 Tensorflow 1.6 中消失了。以后的任何事也应该是好的。</p><p id="2152" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们需要将我们的模型引入 Ubuntu。我个人就是用 Dropbox 做到的。在 Windows 中，我把这个模型添加到我的 dropbox 中，在 Ubuntu 中打开这个 dropbox，然后把它添加到我的桌面上。</p><p id="b714" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们准备好进行转换了。假设模型的输入是 299x299 RGB 图像，我们将编写以下命令。请注意这是如何影响我们放入- input_shape 参数中的内容的。此外，整个表彰应写成一行。</p><pre class="lt lu lv lw gt lx ly lz ma aw mb bi"><span id="950c" class="mc md iq ly b gy me mf l mg mh">/home/ryan/.local/bin/toco --input_file=Desktop/model.pb            --output_file=Desktop/model.tflite                                  --input_format=TENSORFLOW_GRAPHDEF <br/>--output_format=TFLITE --input_shape=1,299,299,3                    --input_array=input_1 --output_array=output_node                    --inference_type=FLOAT</span></pre><p id="b779" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您的桌面上应该有一个. tflite 文件。只需将它发送回 Windows(我再次使用 Dropbox)，瞧，你可以在你的 Android 程序中使用它。</p><p id="0cf0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">希望这篇文章能有所帮助，如果你有更好的方法将 Keras 神经网络从 Windows 安装到你的 Android 手机上，请在评论中告诉我！</p></div></div>    
</body>
</html>