<html>
<head>
<title/>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1/>
<blockquote>原文：<a href="https://towardsdatascience.com/sleep-stage-classification-from-single-channel-eeg-using-convolutional-neural-networks-5c710d92d38e?source=collection_archive---------9-----------------------#2018-10-01">https://towardsdatascience.com/sleep-stage-classification-from-single-channel-eeg-using-convolutional-neural-networks-5c710d92d38e?source=collection_archive---------9-----------------------#2018-10-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><p id="a8db" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">基于卷积神经网络的单通道脑电睡眠阶段分类</p></div><div class="ab cl jn jo hu jp" role="separator"><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js"/></div><div class="ij ik il im in"><figure class="jv jw jx jy gt jz gh gi paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="gh gi ju"><img src="../Images/b832583de1e509149a2e1870f8dc9911.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uQSV0dBbirktqit0BotLuA.jpeg"/></div></div><figcaption class="kg kh gj gh gi ki kj bd b be z dk">Photo by <a class="ae kk" href="https://unsplash.com/photos/7i9yLoUgoP8?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Paul M</a> on <a class="ae kk" href="https://unsplash.com/search/photos/owl?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="265e" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">高质量的睡眠是健康生活方式的重要组成部分，因为缺乏睡眠会导致一系列问题，比如更高的癌症风险和慢性疲劳。这意味着，拥有自动和轻松监控睡眠的工具可以有力地帮助人们睡得更好。<br/>医生使用一种叫做脑电图的信号记录，通过电极测量大脑的电活动来了解病人的睡眠阶段，并对他们的睡眠质量做出诊断。</p><p id="52a5" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">在这篇文章中，我们将训练一个神经网络从脑电图中自动进行睡眠阶段分类。</p><h1 id="f22d" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated"><strong class="ak">数据</strong></h1><p id="5d4f" class="pw-post-body-paragraph io ip iq ir b is lj iu iv iw lk iy iz ja ll jc jd je lm jg jh ji ln jk jl jm ij bi translated">在我们的输入中，我们有一系列 30 秒的 EEG 时段，其中每个时段都有一个标签<a class="ae kk" href="https://en.wikipedia.org/wiki/Sleep_cycle" rel="noopener ugc nofollow" target="_blank">{“W”、“N1”、“N2”、“N3”、“REM”}</a>。</p><figure class="jv jw jx jy gt jz gh gi paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="gh gi lo"><img src="../Images/f33bb64c4307b332cde70b93230d2df1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u_KIP2GOQ56_z4MzSfsXig.png"/></div></div><figcaption class="kg kh gj gh gi ki kj bd b be z dk">Fig 1 : EEG Epoch</figcaption></figure><figure class="jv jw jx jy gt jz gh gi paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="gh gi lo"><img src="../Images/b9fad7718d66e3cf8faceca5f74d95f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J8BPcoAYxjtc54pz9E47xA.png"/></div></div><figcaption class="kg kh gj gh gi ki kj bd b be z dk">Fig 2 : Sleep stages through the night</figcaption></figure><p id="5b82" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">这篇文章是基于一个公开的脑电图睡眠数据(<a class="ae kk" href="https://www.physionet.org/physiobank/database/sleep-edfx/" rel="noopener ugc nofollow" target="_blank"> Sleep-EDF </a>)，对 20 名受试者进行了研究，其中 19 人睡了整整两个晚上。我们使用本<a class="ae kk" href="https://github.com/akaraspt/deepsleepnet" rel="noopener ugc nofollow" target="_blank">报告</a>中可用的预处理脚本，并将训练/测试分开，这样就不会有研究对象同时出现在两者中。</p><p id="cb12" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">总体目标是从如图 1 所示的 1D 序列出发，预测如图 2 所示的输出睡眠图。</p><h1 id="dc48" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">模型描述</h1><p id="78c6" class="pw-post-body-paragraph io ip iq ir b is lj iu iv iw lk iy iz ja ll jc jd je lm jg jh ji ln jk jl jm ij bi translated">最近的方法<a class="ae kk" href="https://arxiv.org/pdf/1703.04046.pdf" rel="noopener ugc nofollow" target="_blank">【1】</a>使用子模型，该子模型将每个时段编码成固定大小的 1D 向量，然后使用第二个顺序子模型将每个时段的向量映射成来自<a class="ae kk" href="https://en.wikipedia.org/wiki/Sleep_cycle" rel="noopener ugc nofollow" target="_blank">{“W”、“N1”、“N2”、“N3”、“REM”}</a>的类别。</p><p id="0acc" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">在这里，我们使用一个 1D CNN 来编码每个时期，然后使用另一个 1D CNN 或 LSTM 来标记时期序列，以创建最终的<a class="ae kk" href="https://en.wikipedia.org/wiki/Hypnogram" rel="noopener ugc nofollow" target="_blank">睡眠图</a>。这允许对时期的预测考虑上下文。</p><figure class="jv jw jx jy gt jz gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/9e97601b0104072b60d6e3fc6c0b0576.png" data-original-src="https://miro.medium.com/v2/resize:fit:870/format:webp/1*JIdLNbXGjs9Ixfe62HELoA.png"/></div><figcaption class="kg kh gj gh gi ki kj bd b be z dk">Sub-model 1 : Epoch encoder</figcaption></figure><figure class="jv jw jx jy gt jz"><div class="bz fp l di"><div class="lq lr l"/></div></figure><figure class="jv jw jx jy gt jz gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/e71fae5003d41d39d2a71d42905968ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*UWL3Fk8viIXZ13WbmIDkZg.png"/></div><figcaption class="kg kh gj gh gi ki kj bd b be z dk">Sub-model 2 : Sequential model for epoch classification</figcaption></figure><figure class="jv jw jx jy gt jz"><div class="bz fp l di"><div class="lq lr l"/></div></figure><p id="0350" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">完整模型将 EEG 历元序列(每个 30 秒)作为输入，其中使用产生向量序列的<a class="ae kk" href="https://keras.io/" rel="noopener ugc nofollow" target="_blank"> Keras </a>的时间分布层将子模型 1 应用于每个历元。向量序列然后被馈送到另一个子模型，如 LSTM 或 CNN，产生输出标签序列。<br/>我们还为其中一个模型使用了线性链<a class="ae kk" href="https://en.wikipedia.org/wiki/Conditional_random_field" rel="noopener ugc nofollow" target="_blank"> CRF </a>，并表明它可以提高性能。</p><h1 id="557b" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">培训程序</h1><p id="a10e" class="pw-post-body-paragraph io ip iq ir b is lj iu iv iw lk iy iz ja ll jc jd je lm jg jh ji ln jk jl jm ij bi translated">使用 Adam optimizer 从头开始对完整模型进行端到端训练，初始学习率为 1e⁻，每次使用 ReduceLROnPlateau Keras 回调验证准确度达到稳定水平时，学习率都会降低。</p><figure class="jv jw jx jy gt jz gh gi paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="gh gi lt"><img src="../Images/4794e2aabaf2a31cb6c8e039ca9b44af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yBx4pvBJ7gd4MznL-CzXPw.png"/></div></div><figcaption class="kg kh gj gh gi ki kj bd b be z dk">Accuracy Training curves</figcaption></figure><h1 id="8029" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">结果</h1><p id="3d1a" class="pw-post-body-paragraph io ip iq ir b is lj iu iv iw lk iy iz ja ll jc jd je lm jg jh ji ln jk jl jm ij bi translated">我们比较了 3 种不同的模型:</p><ul class=""><li id="36cf" class="lu lv iq ir b is it iw ix ja lw je lx ji ly jm lz ma mb mc bi translated">CNN-CNN:这个使用了一个 1D CNN 进行纪元编码，然后另一个 1D CNN 进行序列标记。</li><li id="e222" class="lu lv iq ir b is md iw me ja mf je mg ji mh jm lz ma mb mc bi translated">CNN-CNN-CRF:该模型使用 1D CNN 进行纪元编码，然后使用 1D CNN-CRF 进行序列标记。</li><li id="ea01" class="lu lv iq ir b is md iw me ja mf je mg ji mh jm lz ma mb mc bi translated">CNN-LSTM:这个使用了 1D CNN 进行纪元编码，然后 LSTM 进行序列标记。</li></ul><p id="2966" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">我们在独立的测试集上评估每个模型，并得到以下结果:</p><ul class=""><li id="2b45" class="lu lv iq ir b is it iw ix ja lw je lx ji ly jm lz ma mb mc bi translated">CNN-CNN : F1 = 0.81，准确度= 0.87</li><li id="01c1" class="lu lv iq ir b is md iw me ja mf je mg ji mh jm lz ma mb mc bi translated">CNN-CNN-CRF : F1 = 0.82，精度=0.89</li><li id="83e9" class="lu lv iq ir b is md iw me ja mf je mg ji mh jm lz ma mb mc bi translated">CNN-LSTM : F1 = 0.71，准确度= 0.76</li></ul><p id="bff8" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">CNN-CNN-CRF 优于其他两个模型，因为 CRF 有助于学习类别之间的转移概率。基于 LSTM 的模型效果不佳，因为它对优化器和批量大小等超参数最敏感，并且需要大量调整才能良好运行。</p><figure class="jv jw jx jy gt jz gh gi paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="gh gi lo"><img src="../Images/b953372ff12f996dd5c7af9cab398561.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I2gql4RSqEU-SW3iYnEqmg.png"/></div></div><figcaption class="kg kh gj gh gi ki kj bd b be z dk">Ground Truth Hypnogram</figcaption></figure><figure class="jv jw jx jy gt jz gh gi paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="gh gi lo"><img src="../Images/e6e681de0cffc58337c2bc860c095cf0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UHQrdJLv4cSoW9JCp-i3wg.png"/></div></div><figcaption class="kg kh gj gh gi ki kj bd b be z dk">Predicted Hypnogram using CNN-CNN-CRF</figcaption></figure><p id="4258" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">这里有源代码:<a class="ae kk" href="https://github.com/CVxTz/EEG_classification" rel="noopener ugc nofollow" target="_blank">https://github.com/CVxTz/EEG_classification</a></p><p id="ef8a" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated">期待大家的建议和反馈。</p><p id="f372" class="pw-post-body-paragraph io ip iq ir b is it iu iv iw ix iy iz ja jb jc jd je jf jg jh ji jj jk jl jm ij bi translated"><a class="ae kk" href="https://arxiv.org/pdf/1703.04046.pdf" rel="noopener ugc nofollow" target="_blank">【1】deep Sleep net:基于原始单通道 EEG 的睡眠阶段自动评分模型</a></p></div></div>    
</body>
</html>