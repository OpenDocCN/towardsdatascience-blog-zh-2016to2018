<html>
<head>
<title>Build Your Own Convolution Neural Network in 5 mins</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 5 分钟内建立自己的卷积神经网络</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/build-your-own-convolution-neural-network-in-5-mins-4217c2cf964f?source=collection_archive---------0-----------------------#2018-05-18">https://towardsdatascience.com/build-your-own-convolution-neural-network-in-5-mins-4217c2cf964f?source=collection_archive---------0-----------------------#2018-05-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9a5f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">CNN 和代码介绍(Keras)</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/cf56f1239447b48cf1fb4ec69d770949.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*70Ftb9VIxcFMSRfSsRUvrA.jpeg"/></div></div></figure><h2 id="8839" class="kr ks iq bd kt ku kv dn kw kx ky dp kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">什么是卷积神经网络？？</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl ln"><img src="../Images/6fa52b065865d72e4036951ac006456c.png" data-original-src="https://miro.medium.com/v2/format:webp/1*N4h1SgwbWNmtrRhszM9EJg.png"/></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk">CNN</figcaption></figure><p id="7a79" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma la mb mc md le me mf mg li mh mi mj mk ij bi translated">在回答什么是卷积神经网络之前，我相信你们都知道什么是神经网络。如果你基础不扎实，看看这个<a class="ae ml" href="https://hackernoon.com/neural-networks-introduction-6048f69b68b0" rel="noopener ugc nofollow" target="_blank">链接</a>。继续前进。卷积神经网络类似于多层感知器网络。主要的区别是网络学习什么，它们是如何构造的，以及它们主要用于什么目的。卷积神经网络也受到生物过程的启发，它们的结构类似于动物的视觉皮层。CNN 广泛应用于计算机视觉领域，并在各种测试案例中取得了很好的效果。</p><h2 id="a3f0" class="kr ks iq bd kt ku kv dn kw kx ky dp kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">隐藏层学到了什么？？</h2><p id="2bb7" class="pw-post-body-paragraph ls lt iq lu b lv mm jr lx ly mn ju ma la mo mc md le mp mf mg li mq mi mj mk ij bi translated">CNN 中的隐藏层通常是卷积和汇集(缩减采样)层。在每个卷积层中，我们采用一个小尺寸的滤波器，并在图像中移动该滤波器，执行卷积运算。卷积运算只不过是滤波器值和图像中的像素之间的逐元素矩阵乘法，并将结果值相加。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mr ms l"/></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk">Convolution operations</figcaption></figure><p id="c215" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma la mb mc md le me mf mg li mh mi mj mk ij bi translated">滤波器的值通过训练的迭代过程来调整，并且在神经网络已经训练了一定数量的时期之后，这些滤波器开始寻找图像中的各种特征。以使用卷积神经网络的面部检测为例。网络的早期层寻找简单的特征，例如不同方向的边等。随着我们在网络中的进展，这些层开始检测更复杂的特征，当你观察最终层检测到的特征时，它们几乎看起来像一张脸。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mt"><img src="../Images/813d4ae8e959306c9111902768c5d2e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Hv4jsLa_iyo8UR6S.png"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk">Different features recognised at different layers</figcaption></figure><p id="28ce" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma la mb mc md le me mf mg li mh mi mj mk ij bi translated">现在，让我们继续池层。共用图层用于对图像进行缩减像素采样。图像将包含许多像素值，并且如果图像尺寸逐渐减小，网络通常很容易学习这些特征。池层有助于减少所需的参数数量，因此，这减少了所需的计算。合用也有助于避免过度拟合。有两种类型的池操作可以完成:</p><ul class=""><li id="76c3" class="mu mv iq lu b lv lw ly lz la mw le mx li my mk mz na nb nc bi translated">最大池化—选择最大值</li><li id="2a8c" class="mu mv iq lu b lv nd ly ne la nf le ng li nh mk mz na nb nc bi translated">平均池-将所有值相加，然后除以值的总数</li></ul><p id="ce0a" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma la mb mc md le me mf mg li mh mi mj mk ij bi translated">很少使用平均池，您可以在大多数示例中找到最大池。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl ln"><img src="../Images/ba9ad88d53d11eb9123319c95314fea2.png" data-original-src="https://miro.medium.com/v2/1*Feiexqhmvh9xMGVVJweXhg.gif"/></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk">Max Pooling</figcaption></figure><h2 id="9427" class="kr ks iq bd kt ku kv dn kw kx ky dp kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">密码</h2><p id="e0d3" class="pw-post-body-paragraph ls lt iq lu b lv mm jr lx ly mn ju ma la mo mc md le mp mf mg li mq mi mj mk ij bi translated">在我们开始编码之前，我想让你知道我们将使用的数据集是<a class="ae ml" href="http://yann.lecun.com/exdb/mnist/" rel="noopener ugc nofollow" target="_blank"> MNIST 数字数据集</a>，我们将使用 Keras 库和 Tensorflow 后端来构建模型。好了，够了。让我们做一些编码。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ni ms l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj ms l"/></div></figure><p id="a615" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma la mb mc md le me mf mg li mh mi mj mk ij bi translated">首先，让我们做一些必要的进口。keras 库帮助我们建立我们的卷积神经网络。我们通过 keras 下载 mnist 数据集。我们导入了一个顺序模型，这是一个预先构建的 keras 模型，您可以在其中添加层。我们导入卷积和池层。我们还导入密集层，因为它们用于预测标签。下降层减少过度拟合，展平层将三维向量扩展为一维向量。最后，我们为矩阵运算引入 numpy。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj ms l"/></div></figure><p id="428c" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma la mb mc md le me mf mg li mh mi mj mk ij bi translated">上面代码中的大部分语句都很琐碎，我只解释几行代码。我们重塑 x_train 和 x_test，因为我们的 CNN 只接受四维向量。值 60000 表示训练数据中的图像数量，28 表示图像大小，1 表示通道数量。如果图像是灰度图像，通道数设置为 1；如果图像是 RGB 格式，通道数设置为 3。我们还将目标值转换成二进制类矩阵。要知道二进制类矩阵是什么样子，请看下面的例子。</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="0f9c" class="kr ks iq nl b gy np nq l nr ns">Y = 2 # the value 2 represents that the image has digit 2 </span><span id="bf42" class="kr ks iq nl b gy nt nq l nr ns">Y = [0,0,1,0,0,0,0,0,0,0] # The 2nd position in the vector is made 1</span><span id="ad46" class="kr ks iq nl b gy nt nq l nr ns"># Here, the class value is converted into a binary class matrix</span></pre><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj ms l"/></div></figure><p id="0fe2" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma la mb mc md le me mf mg li mh mi mj mk ij bi translated">我们构建了一个顺序模型，并添加了卷积层和最大池层。我们还在两者之间添加了 dropout 层，dropout 随机关闭网络中的一些神经元，迫使数据找到新的路径。因此，这减少了过度拟合。我们在末尾添加了密集层，用于类别预测(0–9)。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nj ms l"/></div></figure><p id="1ea7" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma la mb mc md le me mf mg li mh mi mj mk ij bi translated">我们现在用分类交叉熵损失函数、Adadelta 优化器和准确性度量来编译该模型。然后，我们将数据集拟合到模型中，即我们针对 12 个时期训练模型。训练好模型后，我们在测试数据上评估模型的损耗和精度，并打印出来。</p><h2 id="f1e6" class="kr ks iq bd kt ku kv dn kw kx ky dp kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">输出</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nu"><img src="../Images/b8a33bfd1a3d40acd0df07a73c86308a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vOy6X9fTdDAVu03pFfC1EQ.png"/></div></div></figure><h2 id="f7c0" class="kr ks iq bd kt ku kv dn kw kx ky dp kz la lb lc ld le lf lg lh li lj lk ll lm bi translated">结论</h2><p id="b821" class="pw-post-body-paragraph ls lt iq lu b lv mm jr lx ly mn ju ma la mo mc md le mp mf mg li mq mi mj mk ij bi translated">卷积神经网络确实有一些由杰弗里·辛顿指出的缺点。他认为，如果我们希望在计算机视觉领域达到人类水平的精确度，他的<a class="ae ml" href="https://arxiv.org/pdf/1710.09829.pdf" rel="noopener ugc nofollow" target="_blank">胶囊网络</a>是必由之路。但是，到目前为止，CNN 似乎做得很好。如果你觉得这篇文章有用，请告诉我，谢谢:)</p></div></div>    
</body>
</html>