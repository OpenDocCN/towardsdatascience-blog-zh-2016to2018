<html>
<head>
<title>Convolutional Neural Network — II</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">卷积神经网络— II</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/convolutional-neural-network-ii-a11303f807dc?source=collection_archive---------7-----------------------#2018-03-26">https://towardsdatascience.com/convolutional-neural-network-ii-a11303f807dc?source=collection_archive---------7-----------------------#2018-03-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/96ff93bf1b025900fa00a870f2eefde5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/0*0MOpPcp99wIevuSk.png"/></div></figure><p id="d3bd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">继续我们在<a class="ae ks" rel="noopener" target="_blank" href="/cnn-part-i-9ec412a14cb1">上一篇文章</a>中的学习，我们将在这篇文章中讨论以下主题:</p><ul class=""><li id="8f38" class="kt ku iq jw b jx jy kb kc kf kv kj kw kn kx kr ky kz la lb bi translated">体积卷积</li><li id="abf9" class="kt ku iq jw b jx lc kb ld kf le kj lf kn lg kr ky kz la lb bi translated">一次多个过滤器</li><li id="b8c1" class="kt ku iq jw b jx lc kb ld kf le kj lf kn lg kr ky kz la lb bi translated">一层卷积网络</li><li id="df09" class="kt ku iq jw b jx lc kb ld kf le kj lf kn lg kr ky kz la lb bi translated">了解尺寸变化</li></ul><p id="2373" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我已经尽可能地通过插图来解释大多数主题。如果有些东西不容易理解，请告诉我。</p><blockquote class="lh li lj"><p id="7c4e" class="ju jv lk jw b jx jy jz ka kb kc kd ke ll kg kh ki lm kk kl km ln ko kp kq kr ij bi translated"><em class="iq">我们开始吧！</em></p></blockquote><h1 id="9088" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">体积卷积</h1><p id="5d4a" class="pw-post-body-paragraph ju jv iq jw b jx mm jz ka kb mn kd ke kf mo kh ki kj mp kl km kn mq kp kq kr ij bi translated">不要害怕读“音量”，这只是一种用一个以上的通道，即<code class="fe mr ms mt mu b">RGB</code>或任何其他通道来表达图像的方式。</p><p id="e16c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">到目前为止，我们只有一个通道，所以我们只关心图像的<code class="fe mr ms mt mu b">height</code>和<code class="fe mr ms mt mu b">width</code>。但是，如果增加一个以上的通道，我们需要考虑所涉及的滤波器，因为它们还应该包含所有通道的卷积(此处为3)。<br/>因此，如果图像尺寸为<code class="fe mr ms mt mu b">n x n x #channels</code>，那么之前的<code class="fe mr ms mt mu b">f x f</code>滤波器现在也需要尺寸为<code class="fe mr ms mt mu b">f x f x #channels</code>。</p><p id="5133" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">直观上，我们的输入数据不再是二维的，事实上，如果考虑通道，它是三维的，因此被命名为<strong class="jw ir"> volume </strong>。</p><p id="c6ee" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">下面是一个体积卷积的简单示例，图像的尺寸为<code class="fe mr ms mt mu b">6 x 6 x 3</code>，3表示3个通道R、G和b。类似地，滤波器的尺寸为<code class="fe mr ms mt mu b">3 x 3 x 3</code>。</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi mv"><img src="../Images/c87d8dac705bbe6d184c569e193124a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1FIYBBMDsTRkiGus.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk">Fig 1. Convolution over volume (colour image — 3 channels) with filter of dimension 3 x 3</figcaption></figure><p id="1c3e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在给定的例子中，滤波器的目的是检测垂直边缘。如果只需要在<code class="fe mr ms mt mu b">R</code>通道中检测边沿，那么只需要根据要求设置<code class="fe mr ms mt mu b">R</code>通道中的权重。如果您需要检测所有通道的垂直边缘，那么所有滤波器通道将具有如上所示的相同权重。</p><h1 id="5e8c" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">一次多个过滤器</h1><p id="6a7d" class="pw-post-body-paragraph ju jv iq jw b jx mm jz ka kb mn kd ke kf mo kh ki kj mp kl km kn mq kp kq kr ij bi translated">很有可能你需要从一幅图像中提取许多不同的特征，为此你将使用多个过滤器。如果单独的滤波器被分别卷积，将增加计算时间，因此直接一次使用所有需要的滤波器更方便。</p><p id="c674" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">与单个滤波器的情况一样，单独执行卷积，然后将两个卷积的结果合并在一个堆栈中，以形成具有代表滤波器数量的第三维的输出体积。</p><p id="9a5d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">下面的例子考虑了一个如上的<code class="fe mr ms mt mu b">6 x 6 x 3</code>图像，但是我们使用了2个维度为<code class="fe mr ms mt mu b">3 x 3 x 3</code>的过滤器(垂直边缘和水平边缘)。将每个<code class="fe mr ms mt mu b">4 x 4</code>的合成图像叠加在一起，得到一个<code class="fe mr ms mt mu b">4 x 4 x 2</code>的输出体积。</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi ni"><img src="../Images/b4e5f5c5bedc255ac8e5040cc67747fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gJRce3rd3yLaBD7H.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk">Fig 2. Convolution over volume with multiple filter of dimensions 3 x 3</figcaption></figure><p id="8c48" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">对于任何一般情况，可以使用以下公式计算输出尺寸:</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi nj"><img src="../Images/8b784f7ed902164edd654e673c6449eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*R04xglXO-7dN29Fr.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk">Fig 3. Equation governing the output image/signal dimension wrt input and filter dimension</figcaption></figure><p id="4feb" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这里，<code class="fe mr ms mt mu b">nc</code>是输入图像中的通道数，<code class="fe mr ms mt mu b">nf</code>是使用的滤波器数。</p><h1 id="2d3a" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">一层卷积网络</h1><p id="24cf" class="pw-post-body-paragraph ju jv iq jw b jx mm jz ka kb mn kd ke kf mo kh ki kj mp kl km kn mq kp kq kr ij bi translated">如果我们考虑一个卷积网络的一个层，而不考虑汇集层和展平，那么它将看起来接近这样:</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi nk"><img src="../Images/f925d51bfc4dab8809d90b7df684b454.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Tx-3BjReqdJRnYtJ.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk">Fig 4. Single layer of convolution network only with Relu activation</figcaption></figure><p id="28a3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">重要的是要理解，像在任何其他神经网络中一样，卷积神经网络也具有输入数据<code class="fe mr ms mt mu b">x</code>和模型权重，输入数据<code class="fe mr ms mt mu b">x</code>在这里是图像，模型权重由滤波器F1和F2给出，即<code class="fe mr ms mt mu b">W</code>。一旦权重和输入图像被卷积，我们得到加权输出<code class="fe mr ms mt mu b">W * x</code>，然后我们加上偏差<code class="fe mr ms mt mu b">b</code>。</p><p id="73df" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这里的一个关键功能是<code class="fe mr ms mt mu b">RELU</code>激活功能，它是一个整流线性单元。Relu帮助我们将非线性添加到学习模型中，并帮助我们更好地训练/学习通用情况下的模型权重。</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi nl"><img src="../Images/2900a815d816f187f0915aa34f473c3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*9VX8eHwA2-Gf3MAB.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk">Fig 5. Relu activation function</figcaption></figure><p id="e213" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">对于低于某个阈值(这里是0)的值，relu函数根本不更新参数。它就会死去。对于要考虑用于训练的特定训练示例，需要为要激活的神经元设置最小值。Relu还帮助我们减少在大多数深度神经网络中面临的消失和爆炸梯度问题，因为Relu提供了有效的梯度传播。</p><h1 id="df76" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">了解尺寸变化</h1><p id="2ae9" class="pw-post-body-paragraph ju jv iq jw b jx mm jz ka kb mn kd ke kf mo kh ki kj mp kl km kn mq kp kq kr ij bi translated">现在我们已经对单层中发生的事情有了概念性的了解，让我们用公式表示卷积网络的任何给定层<code class="fe mr ms mt mu b">l</code>的轮廓。</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="na nb di nc bf nd"><div class="gh gi nm"><img src="../Images/c4614ce4436a86002dfb8f749993bc07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-zjHFGVymDMb9XAZ.png"/></div></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk">Fig 6. Equations governing change in input dimensions based on filters, padding and stride</figcaption></figure><p id="b0e5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">计算单个组件尺寸后，层<code class="fe mr ms mt mu b">l</code>的最终尺寸<code class="fe mr ms mt mu b">n</code>可通过下式计算:</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/c3feadcee779509c2b9525472d001c0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:842/format:webp/0*b9TiY4V7RetCkTpn.png"/></div><figcaption class="ne nf gj gh gi ng nh bd b be z dk">Fig 7. Dimensions of last layer <strong class="bd no">l </strong>with filter size <strong class="bd no">f</strong>, padding <strong class="bd no">p </strong>and a stride of <strong class="bd no">s</strong></figcaption></figure><h1 id="f221" class="lo lp iq bd lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml bi translated">结论</h1><p id="f357" class="pw-post-body-paragraph ju jv iq jw b jx mm jz ka kb mn kd ke kf mo kh ki kj mp kl km kn mq kp kq kr ij bi translated">本文一开始，我们探讨了体积卷积，然后立即讨论了多个滤波器。很容易理解，这里的<em class="lk">体积</em>就是指图像数据的3个颜色通道。关于卷积网络的单个层的讨论对于掌握整个网络架构非常重要，所以要确保这些概念(relu、激活函数)是清楚的。最后一节讲述了我们如何根据滤波器卷积中使用的填充量和步幅来评估模型的层尺寸。</p><blockquote class="lh li lj"><p id="c833" class="ju jv lk jw b jx jy jz ka kb kc kd ke ll kg kh ki lm kk kl km ln ko kp kq kr ij bi translated">在下一篇文章中，我将详细解释各种CNN架构，并评估其独特的功能</p></blockquote></div><div class="ab cl np nq hu nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ij ik il im in"><p id="e334" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="lk">原载于2017年11月18日</em><a class="ae ks" href="https://mandroid6.github.io/2017/11/18/Convolutional-Neural-Networks-II/" rel="noopener ugc nofollow" target="_blank"><em class="lk">mandroid 6 . github . io</em></a><em class="lk">。</em></p><p id="b51c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><a class="ae ks" href="https://twitter.com/mandroid_6" rel="noopener ugc nofollow" target="_blank">https://twitter.com/mandroid_6</a></p><h2 id="e407" class="nw lp iq bd lq nx ny dn lu nz oa dp ly kf ob oc mc kj od oe mg kn of og mk oh bi translated">查看我关于机器学习和深度学习的其他帖子:<a class="ae ks" href="https://medium.com/@razzormandar" rel="noopener">https://medium.com/@razzormandar</a></h2></div></div>    
</body>
</html>