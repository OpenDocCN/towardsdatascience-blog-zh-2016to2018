<html>
<head>
<title>VideoFi — Annotating videos and finding insights simplified</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">VideoFi —简化视频注释和见解查找</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/videofi-annotating-videos-and-finding-insights-simplified-6c939c83b74c?source=collection_archive---------6-----------------------#2017-12-11">https://towardsdatascience.com/videofi-annotating-videos-and-finding-insights-simplified-6c939c83b74c?source=collection_archive---------6-----------------------#2017-12-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="c596" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">看视频很好玩，但是尝试手动分析视频，就没那么好玩了！你可能会错过重要的细节，这是非常耗时的。如果这个过程可以自动化呢？它肯定能让少数人的生活更轻松。</p><p id="4305" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">能够在传媒公司工作，一切都围绕着视频。这就像宝藏一样，当我们试图涉足最新的流行词——人工智能时，分析视频是我和我的团队想到的最有用的用例之一。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/e12632a6b9e93fe383efc58a323409bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*BaB6Ifxypa1spetJNbTPbQ.gif"/></div></figure><h1 id="6614" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated"><strong class="ak">先决条件</strong></h1><p id="1112" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">为了分析视频，我们必须采取的第一步是<strong class="jp ir">将视频转换成一系列图像</strong>。我们用 python 写了代码，用了一个叫做<a class="ae lw" href="https://www.ffmpeg.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> ffmpeg </strong> </a>的工具。在为 python 安装了 ffmpeg 库之后，我们以每秒 10 帧的速度从视频中提取图像。图像的名称反映了图像帧出现在视频中的时间。有了这个，我们就知道图像在视频中的位置。</p><p id="2099" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">可以在 github <a class="ae lw" href="https://github.com/turnerlabs/video-slicer/blob/batch/video_to_image.py" rel="noopener ugc nofollow" target="_blank">这里</a>找到将视频转换为一系列图像的代码。</p><h1 id="15aa" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated"><strong class="ak">我们想找的东西</strong></h1><p id="279d" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">当时，我们一直在使用 AWS API 构建 ML 模型，并认为尝试他们最近的人工智能服务(<a class="ae lw" href="https://aws.amazon.com/rekognition/?sc_channel=PS&amp;sc_campaign=pac_ps_q4&amp;sc_publisher=google&amp;sc_medium=rekognition_b_pac_q42017&amp;sc_content=aws_recognition_software_exact&amp;sc_detail=aws%20rekognition&amp;sc_category=rekognition&amp;sc_segment=webp&amp;sc_matchtype=e&amp;sc_country=US&amp;sc_geo=namer&amp;sc_outcome=pac&amp;s_kwcid=AL!4422!3!231564872550!e!!g!!aws%20rekognition&amp;ef_id=V57PWQAAACdeGRVo:20171117195804:s" rel="noopener ugc nofollow" target="_blank"> Amazon Rekognition </a> )—对象检测 API <em class="lx">(现在，对象和场景检测)</em>和名人识别 API 是一个好主意。</p><p id="7121" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以实际上，我们的目的是通过找到视频中的物品和名人的标签来发现视频中正在发生的事情。</p><h1 id="4f26" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated"><strong class="ak">拼接零件</strong></h1><p id="b6dd" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">这是我们用来完成使命的架构图:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi ly"><img src="../Images/268f6f56b767873d54b18b1f44ec0e77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*082OXfUKTgGT1CUKzeXl_Q.png"/></div></div><figcaption class="md me gj gh gi mf mg bd b be z dk">VideoFi Architecture</figcaption></figure><p id="038e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将提取的图像上传到 AWS s3 存储桶中。我们通过 Rekognition APIs 发送对每个图像的请求，并收到对每个图像的响应。然后我们过滤数据并使用我们需要的参数。让我进一步解释一下。</p><p id="0ee0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">名人识别一个图像的请求看起来像这样，其中每个图像被下载到本地机器上并被转换成字节:</p><pre class="km kn ko kp gt mh mi mj mk aw ml bi"><span id="8fb6" class="mm ku iq mi b gy mn mo l mp mq">client.recognize_celebrities(Image={'Bytes': imgBytes,})</span></pre><p id="d5aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对象检测 API 也有类似的请求。</p><p id="4aa0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">API 以下列格式返回响应:</p><pre class="km kn ko kp gt mh mi mj mk aw ml bi"><span id="0d64" class="mm ku iq mi b gy mn mo l mp mq">{<br/>    "CelebrityFaces": [<br/>        {<br/>            "Face": {<br/>                "BoundingBox": {<br/>                    "Height": 0.6766666769981384,<br/>                    "Left": 0.273333340883255,<br/>                    "Top": 0.09833333641290665,<br/>                    "Width": 0.4511111080646515<br/>                },<br/>                "Confidence": 99.9476089477539,<br/>                "Landmarks": [<br/>                ],<br/>                "Pose": {<br/>                },<br/>                "Quality": {<br/>                    "Brightness": 56.59690475463867,<br/>                    "Sharpness": 99.9945297241211<br/>                }<br/>            },<br/>            "Id": "1SK7cR8M",<br/>            <strong class="mi ir">"MatchConfidence": 100</strong>,<br/>            <strong class="mi ir">"Name": "Jeff Bezos"</strong>,<br/>            "Urls": [<br/>                "<a class="ae lw" href="http://www.imdb.com/name/nm1757263" rel="noopener ugc nofollow" target="_blank">www.imdb.com/name/nm1757263</a>"<br/>            ]<br/>        }<br/>    ],<br/>    "UnrecognizedFaces": []<br/>}</span></pre><p id="207d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们用来构建数据库的参数以<strong class="jp ir">粗体</strong> <em class="lx">(匹配置信度和名称)</em>突出显示。另一个重要的参数是<em class="lx">边框</em>，它可以用来在名人的脸周围画框，但是我们没有画那么多。</p><p id="add8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">来自标签检测 API 的响应更简单:</p><pre class="km kn ko kp gt mh mi mj mk aw ml bi"><span id="2b29" class="mm ku iq mi b gy mn mo l mp mq">{<br/>    "Labels": [<br/>        {<br/>            "Confidence": 99.25341796875,<br/>            "Name": "Skateboard"<br/>        },<br/>        {<br/>            "Confidence": 99.25341796875,<br/>            "Name": "Sport"<br/>        },<br/>        {<br/>            "Confidence": 99.24723052978516,<br/>            "Name": "People"<br/>        },<br/>],<br/>}</span></pre><p id="793a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们在这里使用了两个参数(<em class="lx">置信度和名称</em>)。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi mr"><img src="../Images/da2d77da92c88f9dec038646a13c4685.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PlCWPbqnGFj45ZmJMAaPZg.png"/></div></div><figcaption class="md me gj gh gi mf mg bd b be z dk">For all you DiCaprio fans — AWS Celebrity Recognition found him!</figcaption></figure><h2 id="f111" class="mm ku iq bd kv ms mt dn kz mu mv dp ld jy mw mx lh kc my mz ll kg na nb lp nc bi translated">构建数据库</h2><p id="08c7" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">得到响应后，我们构建了两个独立的表——一个用于名人，另一个用于物品。我们将每个图像的标签和置信度与图像名称、视频名称以及它们在视频中出现的时间戳粘贴在一起。随着我们收到更多的响应，我们不断地向表中添加行。为此，我们使用了 AWS 提供的 RDS DB。</p><p id="c677" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上面讨论的过程的代码可以在<a class="ae lw" href="https://github.com/turnerlabs/batch-rekognizer/blob/batch/rekognizer.py" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="909f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们使用 AWS batch 进行伸缩，以便可以同时运行多个流程。</p><p id="3a28" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">带有完整管道的 github repo 可以在<a class="ae lw" href="https://github.com/turnerlabs/batch-rekognizer/tree/batch" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h1 id="f3fb" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated"><strong class="ak">结果</strong></h1><p id="cc1c" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">事实证明，AWS 的对象检测和名人识别 API 的工作相当不错。它非常擅长探测物体，虽然它不能识别每个名人，但它能识别很多名人！</p><p id="50b1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们在这里学到的一点是，每秒的帧数很重要——每秒 2 或 3 帧无法捕捉到 10 帧所能捕捉到的信息。这是一个完美的数字——既不太高也不太低，给出了我们想要的结果。但是，作为一个起点，使用更少的帧数将是一件好事，因为调用 API 的次数会很少，并且可能会低于 AWS 提供的免费 API 调用限制。</p><p id="d040" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，API 返回结果的可信度也起着重要作用——它检测到了许多对象和名人，但它对此并不十分有信心，因此我们以 80%的可信度过滤结果，在应用该过滤器后，结果非常准确。</p><p id="f4bf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我们项目最终结果的一个简短演示——名人的名字在左上角，物品和标签在视频的正下方。尽情享受吧！</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/3af5ee389eadcd1cd2ae661bbeb8b879.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*rbl8QNbS7eMipxz-sLxJ5w.gif"/></div><figcaption class="md me gj gh gi mf mg bd b be z dk">VideoFi in Action</figcaption></figure><h1 id="cf61" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">限制</h1><p id="6b34" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">没有什么是完美的，我们的项目和结果也是如此。虽然我们使用的 API 训练有素，但我们缺少的一项能力是——能够用我们想要预测的数据类型(例如 NBA 球员)来训练 API。希望 AWS 在听！:)</p><h1 id="9b09" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">结论</h1><p id="a80c" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">这个原型的目的是展示人工智能和机器学习是如何变得如此容易，以至于任何想要解决其用例的人都可以用更少的复杂性和少量代码来完成。不仅仅是 AWS，还有其他云平台，比如 Google Cloud，Azure，IBM 等等。提供类似的服务。</p><p id="d1b8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我希望你喜欢这篇文章，并用它来解决至少一个你的 AI 用例。</p><p id="ea4d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后但同样重要的是，我要感谢我的团队成员<a class="ae lw" href="http://joshkurz.net/" rel="noopener ugc nofollow" target="_blank">乔希·库尔茨</a>和<a class="nd ne ep" href="https://medium.com/u/91de7c5e0e98?source=post_page-----6c939c83b74c--------------------------------" rel="noopener" target="_blank">瓦伦·沃赫拉</a>，他们是这个项目不可或缺的一部分。</p><p id="fb55" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您有任何问题或建议，请随时通过 LinkedIn 联系我们，地址是<a class="ae lw" href="https://www.linkedin.com/in/shivangishroff/" rel="noopener ugc nofollow" target="_blank"> Shivangi Shroff </a>和<a class="ae lw" href="https://www.linkedin.com/in/varunvohra94/" rel="noopener ugc nofollow" target="_blank"> Varun Vohra </a>。我们非常乐意与您联系并获得反馈。</p></div></div>    
</body>
</html>