<html>
<head>
<title>NLP Text Similarity, how it works and the math behind it</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">NLP 文本相似性，它是如何工作的，以及它背后的数学原理</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/nlp-text-similarity-how-it-works-and-the-math-behind-it-a0fb90a05095?source=collection_archive---------9-----------------------#2018-05-29">https://towardsdatascience.com/nlp-text-similarity-how-it-works-and-the-math-behind-it-a0fb90a05095?source=collection_archive---------9-----------------------#2018-05-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/eb11a144350a70f41bc5057686be2105.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ihoNOBwLyZGqDoVm3z86lw.jpeg"/></div></div></figure><p id="aaa9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">看看这几对句子，你觉得这几对中哪一对有<strong class="ka ir">相似的句子？</strong></p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div class="gh gi kw"><img src="../Images/0bc14ba212ef47a99e256f6603eef5e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:816/format:webp/1*1yVwhOAQqqr8Q7KaJ69WJA.png"/></div></figure><p id="9998" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可能对前两个很有信心，但对后两个就没那么有信心了。实际上，你是对的，因为前两对句子谈论的是同一件事(独立地)，所以非常相似。然而，最后两对中的句子谈论非常不同的事情，因此不会被视为相似的句子。</p><p id="ed79" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">令人惊讶的是，NLP 模型正好相反。根据<strong class="ka ir">文本相似度</strong>在自然语言处理中的工作方式，最后两对句子非常相似，但不是前两对！😮</p><p id="8ba4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在你开始判断 NLP 的能力之前，让我们看看它是如何工作的，以及它背后的数学原理。所以，我们来看看机器是怎么看这些句子的！</p><p id="371c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第一句:</strong>“全球变暖来了”</p><p id="7294" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">句子 2: </strong>“海洋温度正在上升”</p><p id="e41c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了使这两个句子相似，即使从机器的角度来看，你也需要探索一个全新的语义分析维度，根据这个维度，这两个句子非常相似。<a class="ae lb" href="https://www.paralleldots.com/semantic-analysis" rel="noopener ugc nofollow" target="_blank">点击此处</a>并键入这两个句子。</p><p id="be98" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，回到我们的 NLP 模型，是我们破解它的时候了！</p><p id="d631" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第一步:</strong>从两个句子中选出唯一的单词，等于<strong class="ka ir"> 7。</strong></p><p id="b3b5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">独特词汇:</strong> <em class="lc">全球，变暖，是，这里，海洋，温度，上升</em></p><p id="c177" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">第二步:统计每个句子中独特单词的出现次数</p><p id="1c72" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">分析句子 1 </strong></p><pre class="kx ky kz la gt ld le lf lg aw lh bi"><span id="fb3d" class="li lj iq le b gy lk ll l lm ln">global, 1<br/>warming, 1<br/>is, 1<br/>here, 1<br/>ocean, 0<br/>temperature, 0<br/>rising, 0</span></pre><p id="b7ef" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">分析第二句</strong></p><pre class="kx ky kz la gt ld le lf lg aw lh bi"><span id="f313" class="li lj iq le b gy lk ll l lm ln">global, 0<br/>warming, 0<br/>is, 1<br/>here, 0<br/>ocean, 1<br/>temperature, 1<br/>rising, 1</span></pre><p id="586e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">简单的部分已经结束了，在我们继续之前，你必须知道 NLP 的文本相似度是在<strong class="ka ir">余弦相似度的基础上工作的。</strong>余弦相似度基本上就是两个向量之间的角度的<strong class="ka ir">余弦。所以，我们想把句子转换成两个向量，我们已经完成了！</strong></p><p id="8b3d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">句子 1 的向量:</strong> [ 1，1，1，1，0，0，0 ]</p><p id="273a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">句子 2 的向量:</strong> [ 0，0，1，0，1，1，1]</p><p id="479d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我们把向量形象化。</p><p id="3e42" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请注意，在我们的例子中，我们有一个<strong class="ka ir"> 7D 矢量</strong>，因为不可能可视化一个<strong class="ka ir"> 7D </strong>矢量，我将向您展示两个<strong class="ka ir"> 3D 矢量</strong>并解释其工作原理。</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/a11311bde81bf856e458c682c3e95248.png" data-original-src="https://miro.medium.com/v2/resize:fit:718/format:webp/1*zXJOIv1Ouxegi-rE30fKLg.png"/></div></figure><p id="0c6b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以，这里我们有两个<strong class="ka ir"> 3D </strong>向量<strong class="ka ir">【1，1，1】</strong>和<strong class="ka ir">【0，0，1】</strong>。你可以把这些向量想象成总共有 3 个独特单词的两个句子。这里，<strong class="ka ir"> [ 1，1，1 ] </strong>将意味着所有 3 个唯一单词在第一句中出现一次，而<strong class="ka ir"> [ 0，0，1 ] </strong>将意味着只有第三个唯一单词在第二句中出现一次。</p><p id="c7cf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们只对这两个向量之间的角度感兴趣。两条线越近，角度就越小，因此相似性增加。因此，如果任何两个句子完全相似，你将在<strong class="ka ir"> 3D 空间中只看到一条线，</strong>因为两条线会相互重叠。</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/be9389df359bacd4676fc174c5aa9541.png" data-original-src="https://miro.medium.com/v2/resize:fit:638/format:webp/1*ipF4GqzTxDGf1cZqIfglug.png"/></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk">Vectors getting closer, similarity increases as both sentences now have 2 words in common</figcaption></figure><figure class="kx ky kz la gt jr gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/28548b79dfa8ad59d90ec12a372f5d12.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/format:webp/1*4slYq804eanHw7pqzHh23w.png"/></div><figcaption class="lq lr gj gh gi ls lt bd b be z dk">A perfect match of 2 sentences!</figcaption></figure><p id="61a3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我希望你能理解我们在这里想要达到的目标或者 NLP 想要做的事情。所以，让我们回到我们的原始向量，然后<strong class="ka ir">计算两者之间的余弦角</strong>。我们的载体:</p><p id="3e0f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">句子 1 的向量:</strong>【1，1，1，1，0，0，0】</p><p id="10f9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">句子 2 的向量:</strong> [ 0，0，1，0，1，1，1]</p><p id="7c48" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">测量两个矢量之间的角度</strong></p><p id="1fb4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这不是火箭科学，你需要知道的只是这个公式:</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/09a3a15b08c58f3a103869042e0311e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:350/format:webp/1*zpM7o4mYqK15J_zH9ifZpA.png"/></div></figure><p id="aea5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在分子中，我们有矢量的<strong class="ka ir">点积</strong>，在分母中，我们有两个矢量长度的乘积。</p><ol class=""><li id="7ed1" class="lw lx iq ka b kb kc kf kg kj ly kn lz kr ma kv mb mc md me bi translated">让我们为我们的例子找出点积:<br/> <strong class="ka ir">公式-&gt;</strong>(u<em class="lc">1 * v1)+</em>(U2<em class="lc">* v2)+…..+</em>(un<em class="lc">* VN)</em><strong class="ka ir"><em class="lc"><br/></em>那就-&gt;</strong>(1 * 0)+(1 * 0)+(1 * 1)+(1 * 0)+(1 * 0)+(1 * 0)+(1 * 0)= 1</li><li id="dcaf" class="lw lx iq ka b kb mf kf mg kj mh kn mi kr mj kv mb mc md me bi translated">求两个向量的长度:</li></ol><figure class="kx ky kz la gt jr gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/bd3e023ee6a6d0c4bc3f60e570eb8034.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/format:webp/1*GEMt1G0_blmq-hUTkl-e2Q.png"/></div></figure><p id="d641" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以，现在我们要计算:1 / 4 等于<strong class="ka ir"> 0.25 </strong></p><p id="ea1f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">总之，根据 NLP 文本相似度，两个句子“<strong class="ka ir">全球变暖在这里</strong>”和“<strong class="ka ir">海洋温度正在上升</strong>”只有<strong class="ka ir"> 25% </strong>相似，这与语义分析显示的完全相反。</p><p id="b159" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，让我们快速对另外一对句子执行相同的步骤:</p><p id="0448" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">句子 1: </strong>“这个地方很棒”</p><p id="c51b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">句子 2: </strong>“这是个好消息”</p><p id="e95d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">独特词汇:</strong> <em class="lc">这，是，伟大，地方，新闻</em></p><p id="992a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">句子 1 的向量:</strong>【1，1，1，1，0】</p><p id="15bf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">句子 2 的向量:</strong>【1，1，1，0，1】</p><p id="cd7c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将这些向量放入余弦公式，您会得到值<strong class="ka ir"> 0.75，</strong>表示相似度<strong class="ka ir"> 75% </strong></p><p id="28cb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请注意，<strong class="ka ir">值越大，角度</strong>越小，句子越相似。</p><p id="80e0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以，下次当你想到在你的项目中使用<strong class="ka ir"> NLP 文本相似度</strong>时，你就会知道它的真正目的以及它与<strong class="ka ir">语义分析的不同之处。</strong></p><p id="440f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> <em class="lc">干杯！</em> </strong></p></div></div>    
</body>
</html>