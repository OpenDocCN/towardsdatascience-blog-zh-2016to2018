<html>
<head>
<title>Mean Image Clustering on Pokemon Images</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">口袋妖怪图像的均值聚类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/color-difference-clustering-on-pokemon-images-68c6f0a3245b?source=collection_archive---------7-----------------------#2018-09-01">https://towardsdatascience.com/color-difference-clustering-on-pokemon-images-68c6f0a3245b?source=collection_archive---------7-----------------------#2018-09-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/7dd65af9c979fa54111772a2a02d4a3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cDngwBAgIvBkajg_UUyMRw.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Developing strategies to group similar Pokemon Images</figcaption></figure><p id="f226" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">探索性算法是在数字属性上明确定义的，通过提供描述性统计的摘要，然后是可视化，如直方图、散点图和其他一些可能与问题相关的内容。然而，简单的摘要更容易与图像数据集混淆。</p><p id="d375" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">图像数据聚类，也称为图像检索，有许多有趣的算法，如使用自动编码器来获得图像相似性。然而，这些算法很难实现，并且需要一些时间来训练。本文的目的是尝试一个简单的概念，根据与平均图像的距离对相似图像进行分组。</p><p id="f005" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在浏览 Kaggle 内核时，我看到了一个非常有趣的想法，即使用“平均图像”对国际足联球员数据库中的人脸图像进行聚类:</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lb"><img src="../Images/16c7cd3cb36a6737cc95ce88d2ead320.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-EdsmLRSALutWDT3GeohJw.png"/></div></div></figure><p id="8b01" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在面部数据集上，平均面部图像的概念是相当直观的，然而，我怀疑这将如何转化为其他数据集。</p><p id="ef08" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">尽管如此，我还是开始了这个项目，来看看在一个由口袋妖怪图像组成的数据集上，普通的图像会是什么样子。我最初的反应是，这种方法实现起来比构建卷积自动编码器简单得多，因此，如果这能产生有意义的聚类，它将是有用的。</p><p id="c08a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在本文中，我们将探索一个包含 150 个原始口袋妖怪图像的数据集，并根据它们与平均图像的差异对它们进行聚类。本文将进一步探讨均值图像的使用，以及如何使用它在图像数据中形成聚类。</p><p id="a55b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">图像聚类的一个潜在应用可能是改进数据扩充算法。图像聚类对于改进用于添加数据的生成对抗网络(GANs)的使用非常有用。我们将从本文中导出的集群中进行采样，而不是从整个数据集中进行采样。</p><p id="5472" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">以下是我们将遵循的形成口袋妖怪图像集群的工作流程:</p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="1bf9" class="ll lm iq lh b gy ln lo l lp lq"># Load Images<br/># Calculate Mean Image<br/># Calculate Distance from Mean to each Image<br/># Sort by Distance<br/># Select Clusters based on Distance Quantiles</span></pre><p id="68f0" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我已经在 Github <a class="ae la" href="https://github.com/CShorten/PokemonGANs" rel="noopener ugc nofollow" target="_blank">上传了我在这里使用的口袋妖怪图片</a>:</p><p id="1dca" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><em class="lr">所有代码都是用 Python 写的</em></p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="6147" class="ll lm iq lh b gy ln lo l lp lq"># Load Pokemon Images</span><span id="b3e6" class="ll lm iq lh b gy ls lo l lp lq">from PIL import Image<br/>import numpy as np<br/>import os<br/>from random import shuffle<br/>from tqdm import tqdm<br/>import matplotlib.pyplot as plt</span><span id="ef32" class="ll lm iq lh b gy ls lo l lp lq">DIR_NAME = './Pokemon'<br/>IMG_SIZE = 100</span><span id="e5b3" class="ll lm iq lh b gy ls lo l lp lq">pokemon = []<br/>for img in tqdm(os.listdir(DIR_NAME)):<br/>    path = os.path.join(DIR_NAME, img)<br/>    if "DS_Store" not in path:<br/>        img = Image.open(path)<br/>        img = img.convert('L')<br/>        img = img.resize((IMG_SIZE, IMG_SIZE), Image.ANTIALIAS)<br/>        pokemon.append(np.array(img))<br/>    <br/>print(type(pokemon[0]))<br/>print(pokemon[0].shape)<br/>plt.imshow(pokemon[0], cmap = 'gist_gray')<br/>plt.show()</span></pre><p id="216e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><em class="lr">现在我们已经加载了图像，我们想要计算整个数据集的平均图像:</em></p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="7298" class="ll lm iq lh b gy ln lo l lp lq"># Calculate Mean Image<br/>sums = np.zeros((100, 100))<br/>for x in range(len(pokemon)):<br/>    for i in range(100):<br/>        for j in range(100):<br/>            sums[i][j] += pokemon[x][i][j]<br/>#print(sums)<br/>for idx in range(100):<br/>    for idy in range(100):<br/>        sums[idx][idy] /= len(pokemon)<br/>#print(sums)<br/>plt.imshow(sums, cmap='gist_gray')<br/>plt.show()</span></pre><p id="6f3c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">平均图像:</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/68a897edb2c5e2da61b82c7455925893.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/format:webp/1*ww1OBkC_dQJV2dPw6UfBww.png"/></div></figure><p id="8bcb" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">前 5 幅图像的平均图像:</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/3c11aeb57562b33424144bd09cfa4cd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*ffbYhnRc14wpCLBjyHwfxA.png"/></div></figure><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="30ad" class="ll lm iq lh b gy ln lo l lp lq"># Define Distance function</span><span id="dd7f" class="ll lm iq lh b gy ls lo l lp lq">def SquaredDistance(x, y):<br/>    return (x-y)**2<br/>def ImageDistance(img1, img2):<br/>    distance = 0<br/>    for i in range(100):<br/>        for j in range(100):<br/>            distance += SquaredDistance(img1[i][j], img2[i][j])      <br/>    return distance</span></pre><p id="595f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们将使用距离的平方来计算每个口袋妖怪与平均口袋妖怪图像的距离。</p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="3ce3" class="ll lm iq lh b gy ln lo l lp lq"># Calculate Distance from Mean Image to each Image</span><span id="79ba" class="ll lm iq lh b gy ls lo l lp lq">mean_image = sums<br/>Distance_Dict = {}<br/>for i in range(len(pokemon)):<br/>    Distance_Dict[i] = ImageDistance(mean_image, pokemon[i])</span></pre><p id="5769" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">本词典采用以下形式:</p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="2a3d" class="ll lm iq lh b gy ln lo l lp lq">0: distance from image 0 to mean image<br/>1: distance from image 1 to mean image<br/>...<br/>150: distance from image 150 to mean image</span></pre><p id="8d74" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在，我们根据这个排序的分区对字典和集群进行排序:</p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="930d" class="ll lm iq lh b gy ln lo l lp lq">import operator<br/>sorted_d = sorted(Distance_Dict.items(), key=operator.itemgetter(1))<br/>print(sorted_d)</span></pre><p id="1331" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">最后，让我们想象一下每个集群中的一些图像，看看我们在这里做了什么…</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lv"><img src="../Images/bb1d570c61cf933bf0a4fa9140409875.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_RU0AHVryUuAVRvzoauItg.png"/></div></div></figure><p id="0a66" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">总之，使用均值距离来形成聚类并没有什么好处。虽然它在基于图像的集中暗度对图像进行聚类方面做得很好，但它没有捕捉到我们在图像聚类中想要的任何视觉相似性(除了第一组中的 Diglet 和 Dugtrio)。我很高兴能继续研究图像检索和相似性技术，以形成更有意义的基于除颜色密度之外的视觉特征的图像簇，感谢阅读！</p></div><div class="ab cl lw lx hu ly" role="separator"><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb mc"/><span class="lz bw bk ma mb"/></div><div class="ij ik il im in"><h1 id="e49a" class="md lm iq bd me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz bi translated"><a class="ae la" href="https://medium.com/@connorshorten300" rel="noopener"> CShorten </a></h1><p id="fc78" class="pw-post-body-paragraph kc kd iq ke b kf na kh ki kj nb kl km kn nc kp kq kr nd kt ku kv ne kx ky kz ij bi translated">Connor Shorten 是佛罗里达大西洋大学计算机科学专业的学生。对软件经济学、深度学习和软件工程感兴趣。</p></div></div>    
</body>
</html>