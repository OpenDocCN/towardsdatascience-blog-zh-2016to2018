<html>
<head>
<title>Deep Learning: Which Loss and Activation Functions should I use?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深度学习:应该使用哪些损失和激活函数？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/deep-learning-which-loss-and-activation-functions-should-i-use-ac02f1c56aa8?source=collection_archive---------1-----------------------#2018-07-26">https://towardsdatascience.com/deep-learning-which-loss-and-activation-functions-should-i-use-ac02f1c56aa8?source=collection_archive---------1-----------------------#2018-07-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/6103def9d2491e728a514f63db359509.png" data-original-src="https://miro.medium.com/v2/resize:fit:568/format:webp/1*85yYbdUgMBXpcKw1uHgqNg.png"/></div></figure><p id="ebaa" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这篇文章的目的是根据商业目标，为神经网络中最终层激活函数和损失函数的组合提供指导。</p><p id="701a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这篇文章假设读者了解激活函数。关于这些的概述可以在之前的帖子中看到:<a class="ae ks" href="https://medium.com/@srnghn/deep-learning-overview-of-neurons-and-activation-functions-1d98286cf1e4" rel="noopener">深度学习:神经元和激活功能概述</a></p><h1 id="3b3b" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">你想解决什么？</h1><p id="86a8" class="pw-post-body-paragraph ju jv iq jw b jx lr jz ka kb ls kd ke kf lt kh ki kj lu kl km kn lv kp kq kr ij bi translated">像所有机器学习问题一样，业务目标决定了你应该如何评估它的成功。</p><h2 id="f2b3" class="lw ku iq bd kv lx ly dn kz lz ma dp ld kf mb mc lh kj md me ll kn mf mg lp mh bi translated">你是想预测一个数值吗？</h2><p id="9e7e" class="pw-post-body-paragraph ju jv iq jw b jx lr jz ka kb ls kd ke kf lt kh ki kj lu kl km kn lv kp kq kr ij bi translated"><em class="mi">例子:预测产品的合适价格，或者预测每天的销售数量</em></p><p id="2702" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果是这样，参见<strong class="jw ir">回归:预测数值</strong>一节</p><h2 id="fda1" class="lw ku iq bd kv lx ly dn kz lz ma dp ld kf mb mc lh kj md me ll kn mf mg lp mh bi translated">你想预测一个明确的结果吗？</h2><p id="e34a" class="pw-post-body-paragraph ju jv iq jw b jx lr jz ka kb ls kd ke kf lt kh ki kj lu kl km kn lv kp kq kr ij bi translated"><em class="mi">例子:预测图像中看到的物体，或者预测对话的主题</em></p><p id="88f0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果是这样，接下来您需要考虑有多少个类以及您希望找到多少个标签。</p><p id="ca5d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果您的数据是二进制的，它是或不是一个类(例如，欺诈、诊断、可能购买)，请参见<strong class="jw ir">分类:预测二进制结果</strong>一节</p><p id="641b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">如果你有多个类别(例如图像中的对象、电子邮件中的主题、适合做广告的产品)并且它们是排他性的——每个项目只有一个标签——参见<strong class="jw ir">分类:从多个类别中预测单个标签</strong>。如果您的数据中有多个标签，那么您应该查看章节<strong class="jw ir">分类:从多个类中预测多个标签</strong>。</p><h1 id="ccc4" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">回归:预测数值</h1><p id="263f" class="pw-post-body-paragraph ju jv iq jw b jx lr jz ka kb ls kd ke kf lt kh ki kj lu kl km kn lv kp kq kr ij bi translated"><em class="mi">例如，预测产品价格</em></p><p id="d8ce" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">神经网络的最后一层将有一个神经元，它返回的值是一个连续的数值。</p><p id="977c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">为了了解预测的准确性，将其与真实值进行比较，真实值也是一个连续的数字。</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi mj"><img src="../Images/a1ac5a9ca388a941ac419e1f0f3a6f1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v83Le0f8ONiOSjywUTgemg.png"/></div></div></figure><h2 id="9a91" class="lw ku iq bd kv lx ly dn kz lz ma dp ld kf mb mc lh kj md me ll kn mf mg lp mh bi translated">最终激活函数</h2><p id="14db" class="pw-post-body-paragraph ju jv iq jw b jx lr jz ka kb ls kd ke kf lt kh ki kj lu kl km kn lv kp kq kr ij bi translated"><strong class="jw ir">线性</strong> —这产生了我们需要的数值</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/7f1bb4a4983d4a0a405bcc6cf5fe5815.png" data-original-src="https://miro.medium.com/v2/resize:fit:824/format:webp/1*sOsKmP59FYCLAIKkzxkAXA.png"/></div></figure><p id="4cce" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">或者</p><p id="d76a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir"> ReLU </strong> —这导致一个大于 0 的数值</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/46de061b415a187a1f0f6c0149d789ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/format:webp/1*YF_UhGcE1q_Kaia9fbZjKg.png"/></div></figure><h2 id="674d" class="lw ku iq bd kv lx ly dn kz lz ma dp ld kf mb mc lh kj md me ll kn mf mg lp mh bi translated">损失函数</h2><p id="4e4f" class="pw-post-body-paragraph ju jv iq jw b jx lr jz ka kb ls kd ke kf lt kh ki kj lu kl km kn lv kp kq kr ij bi translated"><strong class="jw ir">均方误差(MSE) </strong> —这是预测值和真实值之间的均方差</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi mu"><img src="../Images/da41b9771a2637947faf13bd5a58b503.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nZzH-sr4agNgICvRsoJ8hA.png"/></div></div></figure><h1 id="ced6" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">分类:预测二元结果</h1><p id="4f13" class="pw-post-body-paragraph ju jv iq jw b jx lr jz ka kb ls kd ke kf lt kh ki kj lu kl km kn lv kp kq kr ij bi translated"><em class="mi">例如，预测交易是否属于欺诈</em></p><p id="cf17" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">神经网络的最后一层将有一个神经元，并将返回一个介于 0 和 1 之间的值，可以推断为一个大概值。</p><p id="065e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">为了了解预测的准确性，将其与真实值进行比较。如果数据是该类，则真值为 1，否则为 0。</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/96732b68c28a3912e0876d9c93371d0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1346/format:webp/1*B0CoTaPsLxUbYcakSdQ8iw.png"/></div></figure><h2 id="23c9" class="lw ku iq bd kv lx ly dn kz lz ma dp ld kf mb mc lh kj md me ll kn mf mg lp mh bi translated">最终激活函数</h2><p id="7b1c" class="pw-post-body-paragraph ju jv iq jw b jx lr jz ka kb ls kd ke kf lt kh ki kj lu kl km kn lv kp kq kr ij bi translated"><strong class="jw ir"> Sigmoid </strong> —这导致一个介于 0 和 1 之间的值，我们可以推断该模型对该类中的示例有多确信</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/d004cdfe3e4c465ae654057be5d3f942.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*GyTBLJqNPbk8s5W4U-uTNA.png"/></div></figure><h2 id="a752" class="lw ku iq bd kv lx ly dn kz lz ma dp ld kf mb mc lh kj md me ll kn mf mg lp mh bi translated">损失函数</h2><p id="1542" class="pw-post-body-paragraph ju jv iq jw b jx lr jz ka kb ls kd ke kf lt kh ki kj lu kl km kn lv kp kq kr ij bi translated"><strong class="jw ir">二元交叉熵</strong> —交叉熵量化两个概率分布之间的差异。我们的模型预测{p，1-p}的模型分布，因为我们有一个二元分布。我们使用二进制交叉熵将其与真实分布{y，1-y}进行比较</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi mx"><img src="../Images/0de2ad2bf012231800cfe71e4173630d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NVpGlUvNjE8Tq3KrNBDqMg.png"/></div></div></figure><h1 id="9f57" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">分类:从多个类别中预测单个标签</h1><p id="c363" class="pw-post-body-paragraph ju jv iq jw b jx lr jz ka kb ls kd ke kf lt kh ki kj lu kl km kn lv kp kq kr ij bi translated"><em class="mi">例如预测文档的主题</em></p><p id="ac4d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">神经网络的最后一层将为每个类别提供一个神经元，它们将返回一个介于 0 和 1 之间的值，可以推断为一个可能值。输出结果是一个概率分布，其总和为 1。</p><p id="5397" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">为了了解预测的准确性，将每个输出与其对应的真实值进行比较。真值已经过一次热编码，意味着 1 出现在对应于正确类别的列中，否则出现 0</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi my"><img src="../Images/f6f6943de3642e8d137e4c2e81ecc65c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4SlLLYAdwMJ6OB90q51PlQ.png"/></div></div></figure><h2 id="d2f5" class="lw ku iq bd kv lx ly dn kz lz ma dp ld kf mb mc lh kj md me ll kn mf mg lp mh bi translated">最终激活函数</h2><p id="75fe" class="pw-post-body-paragraph ju jv iq jw b jx lr jz ka kb ls kd ke kf lt kh ki kj lu kl km kn lv kp kq kr ij bi translated"><strong class="jw ir"> Softmax </strong> —这导致每个输出的值在 0 和 1 之间，总和为 1。因此，这可以推断为一个概率分布</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/e6f5d14dcf25dddaacc29c493cf73016.png" data-original-src="https://miro.medium.com/v2/resize:fit:772/format:webp/1*ruKvFqd7i2dYIq8DoG5MQA.png"/></div></figure><h2 id="18ab" class="lw ku iq bd kv lx ly dn kz lz ma dp ld kf mb mc lh kj md me ll kn mf mg lp mh bi translated">损失函数</h2><p id="c815" class="pw-post-body-paragraph ju jv iq jw b jx lr jz ka kb ls kd ke kf lt kh ki kj lu kl km kn lv kp kq kr ij bi translated"><strong class="jw ir">交叉熵</strong> —交叉熵量化两个概率分布之间的差异。我们的模型预测了{p1，p2，p3}的模型分布(其中 p1+p2+p3 = 1)。我们使用交叉熵将其与真实分布{y1，y2，y3}进行比较</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi na"><img src="../Images/708114736c66af5f5281a8ed4aebdcaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gcIhjRGUPHbh0iQr81xVUA.png"/></div></div></figure><h1 id="e577" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">分类:从多个类别预测多个标签</h1><p id="e15f" class="pw-post-body-paragraph ju jv iq jw b jx lr jz ka kb ls kd ke kf lt kh ki kj lu kl km kn lv kp kq kr ij bi translated"><em class="mi">例如，预测图像中动物的存在</em></p><p id="0829" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">神经网络的最后一层将为每个类别提供一个神经元，它们将返回一个介于 0 和 1 之间的值，可以推断为一个可能值。</p><p id="31ce" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">为了了解预测的准确性，将每个输出与其对应的真实值进行比较。如果“真值”列中出现 1，则它对应的类别存在于数据中，否则出现 0。</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi nb"><img src="../Images/51407f2915fa1017b9e2971042ac1de5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kineGv8kBE0MbOG67yRCcg.png"/></div></div></figure><h2 id="09a3" class="lw ku iq bd kv lx ly dn kz lz ma dp ld kf mb mc lh kj md me ll kn mf mg lp mh bi translated">最终激活函数</h2><p id="2ff3" class="pw-post-body-paragraph ju jv iq jw b jx lr jz ka kb ls kd ke kf lt kh ki kj lu kl km kn lv kp kq kr ij bi translated"><strong class="jw ir"> Sigmoid </strong> —这导致一个介于 0 和 1 之间的值，我们可以推断出它在该类中的置信度</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/d004cdfe3e4c465ae654057be5d3f942.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*GyTBLJqNPbk8s5W4U-uTNA.png"/></div></figure><h2 id="2c5e" class="lw ku iq bd kv lx ly dn kz lz ma dp ld kf mb mc lh kj md me ll kn mf mg lp mh bi translated">损失函数</h2><p id="4549" class="pw-post-body-paragraph ju jv iq jw b jx lr jz ka kb ls kd ke kf lt kh ki kj lu kl km kn lv kp kq kr ij bi translated"><strong class="jw ir">二元交叉熵</strong> —交叉熵量化两个概率分布之间的差异。我们的模型预测每个类别的{p，1-p}(二元分布)的模型分布。我们使用二进制交叉熵将它们与每个类别的真实分布{y，1-y}进行比较，并总结它们的结果</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi nc"><img src="../Images/74016fcc9811406f5cc86a987c9b89b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C2sWPDEYdLV5wm7dNAmBOQ.png"/></div></div></figure><h1 id="cae7" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">一览表</h1><p id="0d50" class="pw-post-body-paragraph ju jv iq jw b jx lr jz ka kb ls kd ke kf lt kh ki kj lu kl km kn lv kp kq kr ij bi translated">下表总结了上述信息，以便您快速找到适合您的使用案例的最终层激活函数和损失函数</p><figure class="mk ml mm mn gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mo mp di mq bf mr"><div class="gh gi nd"><img src="../Images/4eb7ddd09d35747fd1c96e240994cffe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IhP8BdoUpAbssltq0VBafg.png"/></div></div></figure><p id="98de" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我希望这篇文章是有价值的！关于神经网络和最终激活函数的更多信息，请参见之前的帖子:</p><p id="7790" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><a class="ae ks" href="https://medium.com/@srnghn/deep-learning-overview-of-neurons-and-activation-functions-1d98286cf1e4" rel="noopener">深度学习:神经元和激活功能概述</a></p></div></div>    
</body>
</html>