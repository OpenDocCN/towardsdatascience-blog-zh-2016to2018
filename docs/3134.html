<html>
<head>
<title>Quantum Physics Visualization With Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Python实现量子物理可视化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/quantum-physics-visualization-with-python-35df8b365ff?source=collection_archive---------2-----------------------#2018-04-12">https://towardsdatascience.com/quantum-physics-visualization-with-python-35df8b365ff?source=collection_archive---------2-----------------------#2018-04-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/89b15512d8835191ee72ceab7ec77246.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OAhY4ox1uOeYsI0pCswGgw.png"/></div></div></figure><p id="611b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这个博客上，我决定复习一些大学水平的量子化学，来推导电子轨道。额外有趣的部分是，我们将会可视化波函数和电子概率..用Python！</p><h2 id="c4c0" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">薛定谔方程</h2><p id="0e6e" class="pw-post-body-paragraph jy jz iq ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">1926年，Erwin Schrodinger提出了著名的波动方程，将系统的能量与其波动特性联系起来。因为它在氢原子上的应用相当复杂，我们将首先用波动方程来求解盒中粒子。用1D表示的薛定谔波动方程是</p><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/f6a1790506f808c3673e6a4b7272d028.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*DP7hrTFGZ5WOhVDW9RA6jQ.png"/></div></figure><h2 id="99fe" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">可视化盒子中的粒子</h2><p id="b5c6" class="pw-post-body-paragraph jy jz iq ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">现在，为了简化我们的方程，我们假设盒子中有一个<strong class="ka ir">粒子。</strong></p><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/ee6f1272e0a7c00090341153128d1368.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*8cR-sK1COP8wSzEl2QDwwg.png"/></div><figcaption class="ma mb gj gh gi mc md bd b be z dk">Particle In A Box</figcaption></figure><p id="5128" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">盒子里的粒子问题并不对应于任何真实的化学系统。在我们的上下文中，它的用处在于它阐明了几个量子力学特征。势垒处的势能设为无穷大(即粒子不能逃逸)，势垒内的势能设为0。在这些条件下，经典力学预言，粒子在盒子的任何部分都有相等的概率，粒子的动能允许有任何值。考虑到这个假设，我们得到了粒子在势垒处和盒子内部的能量的不同方程。</p><p id="432d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在势垒处，V是无穷大，因此粒子不存在:</p><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi me"><img src="../Images/c5633c9aff0c0abeabf75a6f711ed4c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:682/format:webp/1*N_5et5DOOoelMXaHt6-3dQ.png"/></div></figure><p id="4175" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在盒子内部，V是零，因此波可以具有任何有限值:</p><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mf"><img src="../Images/b70357d18366cd0dc7e3dd1f2727b392.png" data-original-src="https://miro.medium.com/v2/resize:fit:662/format:webp/1*-dIfkGNqHBPjOdKGfvoKYA.png"/></div></div></figure><p id="a906" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在盒子里，我们可以重新排列方程式如下:</p><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/03e1d77f6831fa1a07eb7012cb563fbe.png" data-original-src="https://miro.medium.com/v2/resize:fit:484/format:webp/1*Xx_mjg8NuYcWytHWoGeqMw.png"/></div></figure><p id="f343" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如我们在上面看到的，波函数是这样的，如果微分两次，应该给出相同的函数乘以e。正弦函数具有这种行为。</p><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/67dbcd3cd322d74c2f2bd76a79484f6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:322/format:webp/1*d8MNBxc8qn-wKNKuMxU9Nw.png"/></div></figure><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/5a6c803f3955d7c7b1976a59f469e6eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:350/format:webp/1*IW_88CScVZbxlwq_fBiWvw.png"/></div></figure><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/1c4fc3b945d9a482dcc9024f630f8297.png" data-original-src="https://miro.medium.com/v2/resize:fit:286/format:webp/1*pNfzCFG-UZXbx5mjDFHumQ.png"/></div></figure><p id="0cbf" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，我们需要评估常数α和α的值。对于α，我们使用势垒处的波动方程，其中波函数等于0。</p><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/b7a9f07019787e100a0c5faad7c847b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:422/format:webp/1*37m8SNE8L2cbIdKAXHgfFQ.png"/></div></figure><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/72e421198d42dcfe49810477db2d5910.png" data-original-src="https://miro.medium.com/v2/resize:fit:228/format:webp/1*cxoOPrfCNheOWZnudqGZTg.png"/></div></figure><p id="37b1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在代入α的值:</p><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/400da1b8880c1479260027bdd5d99f7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:410/format:webp/1*BzgeDMHghE5IGArE8DoETQ.png"/></div></figure><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/55656cdccfb2b320cacdd826f7c345fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:296/format:webp/1*_wLoWUWKMUGv7_DfKcdi-A.png"/></div></figure><p id="2e68" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们可以通过要求波函数归一化来确定A的值。这是因为，粒子一定存在于盒子的某个地方。因此，在盒子中找到粒子的概率之和是1:</p><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/fc962115b30ae4aa8c5b4f99d4e19e9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:414/format:webp/1*zxaznHL2ZSzFEUlyueLjaQ.png"/></div></figure><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/284ec27dcc0bdfc8726a09e27d5f05fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:564/format:webp/1*QJU_OgIEv2qVdgbwM-PHxQ.png"/></div></figure><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/bc2dec7d2a77c82ada2c4295283db5fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:296/format:webp/1*1NJ6KBLNyfCsE1At0Gv2Ow.png"/></div></figure><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/6518879d12fa8077656185ce832e1bb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:250/format:webp/1*xPXfVau6_QG7Cciaa6ZIUQ.png"/></div></figure><p id="5fd4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">代入这些值，最终的波和能量方程为:</p><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/01d0626a2dffa708defad201043333a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:286/format:webp/1*eOv3eVkJ5CJSMjRUYpI3FQ.png"/></div></figure><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/5b4ded4112d88f491fb0394a69324ddc.png" data-original-src="https://miro.medium.com/v2/resize:fit:482/format:webp/1*YicoYG5K6Kz5sdYDbRNciQ.png"/></div></figure><p id="2083" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用Python可视化能量和波函数:</p><pre class="lv lw lx ly gt ms mt mu mv aw mw bi"><span id="ac50" class="kw kx iq mt b gy mx my l mz na">import matplotlib.pyplot as plt<br/>import numpy as np</span><span id="64e6" class="kw kx iq mt b gy nb my l mz na">#Constants<br/>h = 6.626e-34<br/>m = 9.11e-31</span><span id="0e62" class="kw kx iq mt b gy nb my l mz na">#Values for L and x<br/>x_list = np.linspace(0,1,100)<br/>L = 1</span><span id="6057" class="kw kx iq mt b gy nb my l mz na">def psi(n,L,x):<br/>    return np.sqrt(2/L)*np.sin(n*np.pi*x/L)</span><span id="3c61" class="kw kx iq mt b gy nb my l mz na">def psi_2(n,L,x):<br/>    return np.square(psi(n,L,x))</span><span id="52ac" class="kw kx iq mt b gy nb my l mz na">plt.figure(figsize=(15,10))<br/>plt.suptitle("Wave Functions", fontsize=18)</span><span id="3300" class="kw kx iq mt b gy nb my l mz na">for n in range(1,4):<br/>    #Empty lists for energy and psi wave<br/>    psi_2_list = []<br/>    psi_list = []<br/>    for x in x_list:<br/>        psi_2_list.append(psi_2(n,L,x))<br/>        psi_list.append(psi(n,L,x))</span><span id="098b" class="kw kx iq mt b gy nb my l mz na">    plt.subplot(3,2,2*n-1)<br/>    plt.plot(x_list, psi_list)<br/>    plt.xlabel("L", fontsize=13)<br/>    plt.ylabel("Ψ", fontsize=13)<br/>    plt.xticks(np.arange(0, 1, step=0.5))<br/>    plt.title("n="+str(n), fontsize=16)<br/>    plt.grid()</span><span id="257e" class="kw kx iq mt b gy nb my l mz na">    plt.subplot(3,2,2*n)<br/>    plt.plot(x_list, psi_2_list)<br/>    plt.xlabel("L", fontsize=13)<br/>    plt.ylabel("Ψ*Ψ", fontsize=13)<br/>    plt.xticks(np.arange(0, 1, step=0.5))<br/>    plt.title("n="+str(n), fontsize=16)<br/>    plt.grid()</span><span id="9a01" class="kw kx iq mt b gy nb my l mz na">plt.tight_layout(rect=[0, 0.03, 1, 0.95])</span></pre><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/e60bc185d9c80ab0366ef13a3e604945.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZYG6X_yUfYz5XrYJS9zcwA.png"/></div></div></figure><p id="58e6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请注意，在一些区域中，ψ<strong class="ka ir"/>和ψ<strong class="ka ir">*</strong>ψ在相同的区域中都为零。这就是所谓的节点。轨道的能级不是连续的。它们存在于不同的层次，由节点的位置来表示。此外，随着n值的增加，盒子内部的波密度也增加。</p><h2 id="0bcd" class="kw kx iq bd ky kz la dn lb lc ld dp le kj lf lg lh kn li lj lk kr ll lm ln lo bi translated">可视化轨道</h2><p id="1cb1" class="pw-post-body-paragraph jy jz iq ka b kb lp kd ke kf lq kh ki kj lr kl km kn ls kp kq kr lt kt ku kv ij bi translated">现在，为了得到关于量子数的波动方程，它需要以下3D格式:</p><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/838d8bf2bb63565dfe40f248b2308e49.png" data-original-src="https://miro.medium.com/v2/resize:fit:718/format:webp/1*SsiojnFh0JQezDEvyPRuvQ.png"/></div></figure><p id="e1cd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，变量的分离取决于原子的类型，这太复杂了，无法在这篇博文中讨论。相反，我们将直接为绘图编写解决方案。下面，我们将使用氢原子的R和Y的函数，而不用推导它们。</p><p id="c9ce" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，让我们看看1s轨道:</p><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ne"><img src="../Images/c11e80b3ac8fce6f905e17e8414c4c70.png" data-original-src="https://miro.medium.com/v2/resize:fit:712/format:webp/1*c0M1Q_n0tBXpsaTCTzU7IA.png"/></div></div></figure><p id="e8ae" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">1s波函数揭示了当我们远离原子核时，电子出现的概率呈指数下降。它也揭示了一个球形。</p><pre class="lv lw lx ly gt ms mt mu mv aw mw bi"><span id="cb89" class="kw kx iq mt b gy mx my l mz na">import matplotlib.pyplot as plt<br/>import numpy as np</span><span id="3fc9" class="kw kx iq mt b gy nb my l mz na">#Probability of 1s<br/>def prob_1s(x,y,z):<br/>    r=np.sqrt(np.square(x)+np.square(y)+np.square(z))<br/>    #Remember.. probability is psi squared!<br/>    return np.square(np.exp(-r)/np.sqrt(np.pi))</span><span id="8d60" class="kw kx iq mt b gy nb my l mz na">#Random coordinates<br/>x=np.linspace(0,1,30)<br/>y=np.linspace(0,1,30)<br/>z=np.linspace(0,1,30)</span><span id="bd1e" class="kw kx iq mt b gy nb my l mz na">elements = []<br/>probability = []</span><span id="867f" class="kw kx iq mt b gy nb my l mz na">for ix in x:<br/>    for iy in y:<br/>        for iz in z:<br/>            #Serialize into 1D object<br/>            elements.append(str((ix,iy,iz)))<br/>            probability.append(prob_1s(ix,iy,iz))<br/>            <br/>#Ensure sum of probability is 1<br/>probability = probability/sum(probability)</span><span id="08c3" class="kw kx iq mt b gy nb my l mz na">#Getting electron coordinates based on probabiliy<br/>coord = np.random.choice(elements, size=100000, replace=True, p=probability)<br/>elem_mat = [i.split(',') for i in coord]<br/>elem_mat = np.matrix(elem_mat)<br/>x_coords = [float(i.item()[1:]) for i in elem_mat[:,0]] <br/>y_coords = [float(i.item()) for i in elem_mat[:,1]] <br/>z_coords = [float(i.item()[0:-1]) for i in elem_mat[:,2]]</span><span id="8ca5" class="kw kx iq mt b gy nb my l mz na">#Plotting<br/>fig = plt.figure(figsize=(10,10))<br/>ax = fig.add_subplot(111, projection='3d')<br/>ax.scatter(x_coords, y_coords, z_coords, alpha=0.05, s=2)<br/>ax.set_title("Hydrogen 1s density")<br/>plt.show()</span></pre><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/62ef471f23b61f89d1398cf5fdada6a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1158/format:webp/1*C6dllXLSK-R9ONwEjGwXsA.png"/></div></figure><p id="8da6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">从上面的电子密度图中很难看出。然而，你可以看到它是球形的。当我们离中心越远，密度就越小。一般来说，截止点是当电子出现的概率为99%时。</p><p id="4e13" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于其他spdf轨道，也可以得到相同的密度图。希望这篇博客已经激发了你对量子物理和Python编程的兴趣！关于基于python的可视化的更多内容，请查看我的博客:<a class="ae ng" rel="noopener" target="_blank" href="/python-based-plotting-with-matplotlib-8e1c301e2799">基于Python的Matplotlib绘图</a></p></div></div>    
</body>
</html>