<html>
<head>
<title>Graph based recommendation engine for Amazon products</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于图形的亚马逊产品推荐引擎</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/graph-based-recommendation-engine-for-amazon-products-1a373e639263?source=collection_archive---------2-----------------------#2018-01-04">https://towardsdatascience.com/graph-based-recommendation-engine-for-amazon-products-1a373e639263?source=collection_archive---------2-----------------------#2018-01-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="1cf9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我攻读硕士学位期间，我和我的同事为大数据课程做了一个很酷的项目。我们发现了一个最近发布的包含亚马逊产品和评论的数据集，因此我们决定基于这些产品构建一个推荐引擎。我们最初看到了<a class="ae kl" href="https://www.cs.umd.edu/~samir/498/Amazon-Recommendations.pdf" rel="noopener ugc nofollow" target="_blank">协同过滤论文</a>，它是亚马逊和网飞等多家大公司推荐引擎的基础。然而，我们决定采用另一种方法，在一个大图中表示产品，并在图的边缘捕捉产品交互。在这篇文章中，我将描述我们使用的数据，我们如何建立图表，我们如何评估我们的系统，以及我们的引擎失败的不同情况，以及如何潜在地改进它。</p><h1 id="0b7f" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">数据</h1><p id="7318" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">我们在这个项目中使用了两个数据集。你可以从<a class="ae kl" href="http://jmcauley.ucsd.edu/data/amazon/links.html" rel="noopener ugc nofollow" target="_blank">这里</a>下载。第一个数据集包含从1996年5月到2014年7月在亚马逊上销售的产品的客户评论。每条评论都有一段用户体验的文字描述，一个有问题的产品的评级，以及一个有用性投票，它代表了这条评论对其他客户的帮助程度。原始数据有1.428亿条评论，但是，我们使用了该数据的子集，这样每个产品至少有5条评论。我们的子集数据有4113万条评论。</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi lp"><img src="../Images/5609c447d6c8a3a1e09959495b26d0a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x5DKsPMm3XyhlwKZorcqIg.png"/></div></div><figcaption class="mb mc gj gh gi md me bd b be z dk">Product review sample</figcaption></figure><ul class=""><li id="befb" class="mf mg iq jp b jq jr ju jv jy mh kc mi kg mj kk mk ml mm mn bi translated">reviewerID —审阅者的ID，例如A2SUAM1J3GNN3B</li><li id="9c4c" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">asin —产品的ID，例如0000013714</li><li id="5a42" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">审阅者姓名—审阅者的姓名</li><li id="db56" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">有帮助性—评价的帮助性等级，例如2/3</li><li id="1495" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">审阅文本—审阅的文本</li><li id="ee00" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">总体—产品评级</li><li id="7243" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">摘要—审核的摘要</li><li id="3bf2" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">unixReviewTime —查看的时间(unix时间)</li><li id="cc4f" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">审阅时间—审阅的时间(原始)</li></ul><p id="d097" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第二个数据集是产品元数据。它包括产品描述，价格，销售排名，品牌信息和共同购买链接。共同购买链接的划分如下</p><ul class=""><li id="19a5" class="mf mg iq jp b jq jr ju jv jy mh kc mi kg mj kk mk ml mm mn bi translated">也查看:客户在查看此产品后查看的其他产品</li><li id="0ae1" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">also _ built:客户购买该产品后购买的其他产品</li><li id="422f" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">buyed _ together:客户与目标产品一起购买(一揽子交易)的其他产品。</li></ul><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/a56d740951e90ae6febfe41c7129f8a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*9Aa0fjaKJstb-THLqWMcfg.png"/></div><figcaption class="mb mc gj gh gi md me bd b be z dk">Product metadata sample</figcaption></figure><ul class=""><li id="e84f" class="mf mg iq jp b jq jr ju jv jy mh kc mi kg mj kk mk ml mm mn bi translated">asin —产品的ID，例如0000031852</li><li id="a586" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">标题—产品的名称</li><li id="26b2" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">价格—以美元为单位的价格(爬行时)</li><li id="3cc5" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">imUrl —产品图像的Url</li><li id="efb5" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">相关—相关产品(也购买、也查看、一起购买、查看后购买)</li><li id="3bf5" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">销售等级-销售等级信息</li><li id="637a" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">品牌——品牌名称</li><li id="5822" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">类别—产品所属类别的列表。</li></ul><h1 id="b3d6" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">构建图表</h1><p id="076c" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">使用上述数据，我们构建了一个图，其中每个节点是一个产品，每个边是两个产品之间的关系。图中的每个节点都有一个权重，用于计算图的边权重。</p><h2 id="d362" class="mu kn iq bd ko mv mw dn ks mx my dp kw jy mz na la kc nb nc le kg nd ne li nf bi translated">产品得分</h2><p id="f593" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">我们使用第一个数据集来计算这个分数。对于一个目标产品，我们得到该产品的所有评论，对于每个评论，我们提取有用性投票和总得分。思维过程如下:总得分越高，产品越好。此外，有用性越高，购买该产品时考虑该评论的人就越多。因此，我们需要建立一个与总体分数和有用性投票成正比的产品分数。两个模型出现了:</p><ul class=""><li id="a285" class="mf mg iq jp b jq jr ju jv jy mh kc mi kg mj kk mk ml mm mn bi translated">乘法模型:得分=有用性*总体</li><li id="ae18" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">加法模型:得分= alpha*有用性+ (1-alpha) *总体</li></ul><p id="f1ce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们考虑这两个模型进行评估，看看哪一个表现更好。</p><h2 id="6af2" class="mu kn iq bd ko mv mw dn ks mx my dp kw jy mz na la kc nb nc le kg nd ne li nf bi translated">图形边缘</h2><p id="e8cb" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">使用第二个数据集，我们创建产品之间的边。使用共同购买的链接，我们在目标产品和每个共同购买的产品之间构建边，如下所示:</p><ul class=""><li id="4ae7" class="mf mg iq jp b jq jr ju jv jy mh kc mi kg mj kk mk ml mm mn bi translated">对于buy _ together产品，权重=1的边</li><li id="5394" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">对于同时购买的产品，权重=2的边</li><li id="e592" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">对于同时查看的产品，权重=3的边</li></ul><p id="204d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在创建初始边权重之后，我们基于每个节点的乘积分数和初始边权重来计算新的权重。产品P1和产品P2之间边E的新得分如下:</p><p id="8d52" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">E(P1，P2) =初始边权重*(1-产品得分P1)*(1-产品得分P2)</p><p id="cf7d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这样，具有较高产品分数和较好初始交互的产品在图中更接近。</p><p id="f2fb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这样，我们构建了一个包含150万个节点和5200万条边的图。</p><h1 id="63b3" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">搜索K-最近产品</h1><p id="efe9" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">为了找到每个目标产品的推荐，我们搜索k个最接近的产品，并将它们返回给用户。</p><ol class=""><li id="1ea1" class="mf mg iq jp b jq jr ju jv jy mh kc mi kg mj kk ng ml mm mn bi translated">首先将产品A的所有直接连接添加到候选列表中</li><li id="5dfd" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk ng ml mm mn bi translated">对于候选列表中的每个项目:<br/>-如果候选列表中没有K个项目，则添加它<br/>-否则，只有到产品A的距离小于列表中所有产品的最大距离时，才添加它</li><li id="5631" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk ng ml mm mn bi translated">对候选人排序</li><li id="52b1" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk ng ml mm mn bi translated">返回前K个作为推荐</li></ol><h1 id="6c08" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">估价</h1><p id="a0b7" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">这就是我们最初陷入困境的地方，不知道如何评估我们的模型。这不是我们训练一个模型并在子集数据上测试它的情况。经过研究，我们发现推荐系统通常用行业中的A/B测试来测试，其中业务相关的指标(例如总销售额)在用户的统计代表性样本上被跟踪。我们决定做一个迷你版。我们随机选择了10种产品，并考虑了这4种型号的建议:</p><ul class=""><li id="aeff" class="mf mg iq jp b jq jr ju jv jy mh kc mi kg mj kk mk ml mm mn bi translated">乘法模型</li><li id="becb" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">alpha=0.25的加法模型</li><li id="4753" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">alpha=0.5的加法模型</li><li id="37e3" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">alpha=0.75的加法模型</li><li id="3650" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">以Amazon.com的亚马逊推荐为基准</li></ul><p id="21ef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将这些建议提供给5名参与者，并要求他们报告每个目标产品中哪些项目是相关的建议。从那里，我们能够计算相关性分数，作为来自全部样本的全部相关推荐的比率。</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi nh"><img src="../Images/79bca1f37dc27c634611b431e9ac92de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D6xnpMgZ_VXA358c6ikcTg.png"/></div></div><figcaption class="mb mc gj gh gi md me bd b be z dk">Relevancy scores</figcaption></figure><p id="d054" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如所料，亚马逊的推荐是最相关的(否则我们会成为亿万富翁)。对于我们的模型，加法模型比乘法模型表现更好。经过一些调查，我们发现许多评论的有用性得分为0，因此无论总得分是多少，产品得分都是0。</p><p id="01ae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">至于相加模型，我们发现，与其中一个参数占主导地位的情况相比，对产品总体得分和有用性赋予相同的权重会产生略好的结果。</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi ni"><img src="../Images/977f4ecece6d18bac8249d14727c1e6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6oRcTJ7VZjkQwvw3QdhC-w.png"/></div></div></figure><h1 id="57b3" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">个案研究</h1><p id="6b23" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">在我们用于评估的10个产品中，我们有一个案例，我们的系统比亚马逊提供了更好的推荐。目标产品是儿童相关产品，我们的模型给出了4个儿童相关产品，而亚马逊给出了2个儿童相关产品和3部手机。</p><p id="fbc9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在另一个案例中，目标产品是迈克尔·杰克逊的音乐专辑。亚马逊推荐了同一位艺术家的其他音乐专辑。我们的系统确实推荐了其他音乐专辑，但它们来自不同的艺术家。</p><p id="bc55" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，有一次我们的系统没有给出任何建议。这是因为选择的产品与任何其他产品都没有优势，因此搜索无法找到任何可推荐的产品。</p><h1 id="641d" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">进一步改进</h1><p id="eafe" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">如果有更多的时间在这个项目上工作，我们有几个想法要进一步实施。其中之一是对评论文本执行NLP，以从每个评论中提取情感。我们会根据评论的积极或消极程度来打分。这将导致我们计算不同的产品得分函数。我们可以通过使用元数据数据集中给出的产品在其类别中的排名来进一步提高产品得分。</p><p id="710e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">另一种可能性是为每个产品添加一个类别特性。通过介绍类别是如何相似的，我们确保没有产品是没有边连接的，因为这将在相似类别的产品之间创建新的边。</p><p id="c4f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">评估方面，我们可以添加更多的参与者和更多的产品，以更好地评估我们产品的相关性。这将通过创建一个为用户提供选择建议的应用程序来简化。</p><p id="ee8a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这种方法的优点是只需要构建一次图。之后，只需向其他产品添加节点和边，就可以非常容易地向其中添加产品。此外，搜索算法是在线功能，在返回推荐方面速度很快。</p><p id="fee3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">谢谢你。</p></div><div class="ab cl nj nk hu nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="ij ik il im in"><p id="3627" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这篇文章最初发表在我的<a class="ae kl" href="https://maviator.github.io/2018/01/04/Recommendation-engine/" rel="noopener ugc nofollow" target="_blank">博客</a></p></div></div>    
</body>
</html>