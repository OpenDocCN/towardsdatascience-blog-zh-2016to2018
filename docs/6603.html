<html>
<head>
<title>Designing a Machine Learning model and deploying it using Flask on Heroku</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">设计一个机器学习模型并使用 Flask 在 Heroku 上部署它</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/designing-a-machine-learning-model-and-deploying-it-using-flask-on-heroku-9558ce6bde7b?source=collection_archive---------1-----------------------#2018-12-21">https://towardsdatascience.com/designing-a-machine-learning-model-and-deploying-it-using-flask-on-heroku-9558ce6bde7b?source=collection_archive---------1-----------------------#2018-12-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9fc4" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">从创建机器学习模型到在网络上部署它——简明指南</h2></div><p id="fea6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们使用不同的机器学习算法和分类器对历史数据建立预测模型，绘制结果并计算模型对测试数据的准确性。现在怎么办？为了使用它来预测新的数据，我们必须将它部署在互联网上，以便外部世界可以使用它。在这篇文章中，我讲述了我如何训练一个机器学习模型，如何使用<a class="ae lb" href="http://flask.pocoo.org/" rel="noopener ugc nofollow" target="_blank"> Flask </a>在其上创建一个 web 应用程序，以及如何使用<a class="ae lb" href="https://www.heroku.com/" rel="noopener ugc nofollow" target="_blank"> Heroku </a>部署它。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="8ace" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated">训练决策树</h1><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mb"><img src="../Images/a276341bcbdcf7b995c943e43a9d0b33.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/1*m8RjcDTvGtfC7jZp5A86Ug.gif"/></div></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk"><a class="ae lb" href="https://gaps.cornell.edu/sites/gaps.cornell.edu/files/shared/images/Decision-Tree-4.gif" rel="noopener ugc nofollow" target="_blank">source</a></figcaption></figure><p id="0fb5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">决策树是一种众所周知的监督机器学习算法，因为它易于使用，弹性和灵活性。我已经在来自 UCI 机器学习知识库<a class="ae lb" href="https://archive.ics.uci.edu/ml/datasets/adult" rel="noopener ugc nofollow" target="_blank">的<em class="mr">成人数据集</em>上实现了该算法。在我以前的一篇文章中，我已经深入解释了数据集，并比较了我在其上训练的不同分类器。请随时查看[ </a><a class="ae lb" rel="noopener" target="_blank" href="/comparative-study-of-classifiers-in-predicting-the-income-range-of-a-person-from-a-census-data-96ce60ee5a10">此处</a>。</p><h2 id="71fa" class="ms lk iq bd ll mt mu dn lp mv mw dp lt ko mx my lv ks mz na lx kw nb nc lz nd bi translated">预处理数据集</h2><p id="ba3a" class="pw-post-body-paragraph kf kg iq kh b ki ne jr kk kl nf ju kn ko ng kq kr ks nh ku kv kw ni ky kz la ij bi translated">它由 14 个属性和一个类别标签组成，说明个人的年收入是低于还是高于 50K。这些属性的范围从人的年龄、工人阶级标签到关系状态和人所属的种族。关于所有属性的信息可以在<a class="ae lb" href="https://archive.ics.uci.edu/ml/datasets/adult" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="5159" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，我们从数据中找出并删除任何丢失的值。我已经用该列中的模式值替换了缺失的值。有许多其他方法可以替换缺失值，但对于这种类型的数据集来说，这似乎是最理想的。</p><p id="d126" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了将数据拟合到预测模型中，我们需要将分类值转换为数值。在此之前，我们将评估是否有必要对分类列进行任何转换。离散化是使分类数据更加整洁和有意义的常用方法。我对婚姻状况一栏进行了离散化处理，将它们缩小到只包含已婚或未婚的值。后来，我在剩余的数据列中应用了标签编码器。还有两个多余的列{'education '，' education-num ' }，因此我删除了其中的一个。</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="2041" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是数据集的样子:</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi nl"><img src="../Images/90b71b7efb45880515fda74c075c08aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gUZlltAO4rT-oYr4vz4Lbg.png"/></div></div></figure><h2 id="3f16" class="ms lk iq bd ll mt mu dn lp mv mw dp lt ko mx my lv ks mz na lx kw nb nc lz nd bi translated">拟合模型</h2><p id="5c0b" class="pw-post-body-paragraph kf kg iq kh b ki ne jr kk kl nf ju kn ko ng kq kr ks nh ku kv kw ni ky kz la ij bi translated">在根据数据的输入方式对每个分类器的数据进行预处理之后，我们对数据进行切片，将标签和属性分开。现在，我们将数据集分成两半，一部分用于训练，一部分用于测试。这是使用 sklearn 的 train_test_split()函数实现的。</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="594e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样，我们可以达到大约 84%的精确度。现在，为了将该模型用于新的未知数据，我们需要保存该模型，以便我们可以在以后预测这些值。为此，我们利用 python 中的<a class="ae lb" href="https://docs.python.org/2/library/pickle.html" rel="noopener ugc nofollow" target="_blank"> pickle </a>，这是一种用于序列化和反序列化 Python 对象结构的强大算法。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="e68b" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated">使用 Flask 创建简单的 Web 应用程序</h1><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi nm"><img src="../Images/a909253616903bfe0fe60f3cafa0ff97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fkgtfwm-q3Cbm4gt7ZiRpg.png"/></div></div></figure><p id="4b9c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有很多用 javascript 编写的 web 开发框架，比如 Angular.js、React.js、Node.js，还有 PHP、ASP.net 等等。但是在这里，我们已经使用 python 来训练我们的机器学习模型，为什么不使用同样的方法创建一个 web 应用程序呢？Flask 是一个基于 python 的微框架，用于开发小型网站。让我们继续吧！</p><h2 id="26cf" class="ms lk iq bd ll mt mu dn lp mv mw dp lt ko mx my lv ks mz na lx kw nb nc lz nd bi translated">HTML 表单</h2><p id="536d" class="pw-post-body-paragraph kf kg iq kh b ki ne jr kk kl nf ju kn ko ng kq kr ks nh ku kv kw ni ky kz la ij bi translated">为了从各种属性中预测收入，我们首先需要收集数据(新的属性值)，然后使用我们上面构建的决策树模型来预测收入是大于 50K 还是小于 50K。因此，为了收集数据，我们创建了<strong class="kh ir"> html 表单</strong>，其中包含了从每个属性中选择的所有不同选项。这里，我只用 html 创建了一个简单的表单。可以从<a class="ae lb" href="https://github.com/ritvikkhanna09/Income-Prediction-Webapp/blob/master/WebApp/flaskr/templates/index.html" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir">这里</strong> </a>复习代码。如果你想让表单更具交互性，你也可以这样做。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/2affc3486cac3b72a022760a2bf728e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*Bz-wIFBd0W-IO8RxHXQ6bA.png"/></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk">Example of the form</figcaption></figure><blockquote class="no np nq"><p id="2a8b" class="kf kg mr kh b ki kj jr kk kl km ju kn nr kp kq kr ns kt ku kv nt kx ky kz la ij bi translated"><strong class="kh ir">重要提示:为了正确预测数据，每个标签的相应值应该与每个选定输入的值相匹配。</strong></p></blockquote><p id="8080" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，在属性<strong class="kh ir">关系<em class="mr"> </em> </strong>中，有 6 个分类值。这些转换成数值就像这样<strong class="kh ir"> <em class="mr"> { '夫':0，'非内亲':1，'他亲':2，'亲生':3，'未婚':4，'妻':5}。</em> </strong>因此我们需要把相同的值放到 html 表单中。</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="4610" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在上面的 gist <em class="mr"> preprocessing.py </em>中，我创建了一个字典<em class="mr"> mapping_dict </em>，它以键和值的形式存储所有分类标签的数值。这将有助于创建 html 表单。</p><blockquote class="no np nq"><p id="b610" class="kf kg mr kh b ki kj jr kk kl km ju kn nr kp kq kr ns kt ku kv nt kx ky kz la ij bi translated">到目前为止，我们已经创建了 html 表单，现在要托管静态页面，我们需要使用 flask。</p></blockquote></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h2 id="a90e" class="ms lk iq bd ll mt mu dn lp mv mw dp lt ko mx my lv ks mz na lx kw nb nc lz nd bi translated">烧瓶脚本</h2><p id="3c02" class="pw-post-body-paragraph kf kg iq kh b ki ne jr kk kl nf ju kn ko ng kq kr ks nh ku kv kw ni ky kz la ij bi translated">在开始编码部分之前，我们需要下载 flask 和其他一些库。在这里，我们利用虚拟环境，在虚拟环境中管理所有的库，并使开发和部署工作变得更加容易。</p><pre class="mc md me mf gt nu nv nw nx aw ny bi"><span id="dd9b" class="ms lk iq nv b gy nz oa l ob oc"><strong class="nv ir">mkdir income-prediction<br/>cd income-prediction<br/>python3 -m venv venv</strong></span></pre><p id="c5c8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">创建虚拟环境后，我们激活它。</p><pre class="mc md me mf gt nu nv nw nx aw ny bi"><span id="8a0b" class="ms lk iq nv b gy nz oa l ob oc"><strong class="nv ir">source venv/bin/activate</strong></span></pre><p id="0501" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在让我们安装烧瓶。</p><pre class="mc md me mf gt nu nv nw nx aw ny bi"><span id="27f5" class="ms lk iq nv b gy nz oa l ob oc"><strong class="nv ir">pip install flask</strong></span></pre><p id="3c48" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们创建文件夹<strong class="kh ir">模板</strong>。在您的应用程序中，您将使用模板来呈现将在用户浏览器中显示的 HTML。这个文件夹包含我们的 html 表单文件<em class="mr">index.html。</em></p><pre class="mc md me mf gt nu nv nw nx aw ny bi"><span id="fbce" class="ms lk iq nv b gy nz oa l ob oc"><strong class="nv ir">mkdir templates</strong></span></pre><p id="9373" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在项目文件夹中创建 script.py 文件，并复制以下代码。</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="596f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里我们导入库，然后使用<code class="fe od oe of nv b"> app=Flask(__name__)</code>创建 flask 的一个实例。<code class="fe od oe of nv b">@app.route('/')</code>用于告诉 flask 哪个 url 应该触发函数索引()，在函数索引中，我们使用<code class="fe od oe of nv b">render_template('index.html')</code>在浏览器中显示脚本<em class="mr">index.html</em>。</p><p id="5422" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们运行应用程序</p><pre class="mc md me mf gt nu nv nw nx aw ny bi"><span id="ee19" class="ms lk iq nv b gy nz oa l ob oc"><strong class="nv ir">export FLASK_APP=script.py<br/>run flask</strong></span></pre><p id="8f28" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这将运行应用程序并启动一个简单的服务器。打开<a class="ae lb" href="http://127.0.0.1:5000/" rel="noopener ugc nofollow" target="_blank"> http://127.0.0.1:5000/ </a>查看 html 表单。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h2 id="5855" class="ms lk iq bd ll mt mu dn lp mv mw dp lt ko mx my lv ks mz na lx kw nb nc lz nd bi translated">预测收入值</h2><p id="1892" class="pw-post-body-paragraph kf kg iq kh b ki ne jr kk kl nf ju kn ko ng kq kr ks nh ku kv kw ni ky kz la ij bi translated">当有人提交表单时，网页应该显示收入的预测值。为此，我们需要之前创建的模型文件(<strong class="kh ir"> <em class="mr"> model.pkl </em> </strong>)，在同一个项目文件夹中。</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="85e8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里表单提交后，表单值以字典的形式存储在变量<em class="mr"> to_predict_list </em>中。我们将其转换成字典值的列表，并将其作为参数传递给<em class="mr"> ValuePredictor() </em>函数。在这个函数中，我们加载了<em class="mr"> model.pkl </em>文件，并预测新值并返回结果。</p><p id="e722" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个结果/预测(<em class="mr">收入多于或少于 50k </em>)然后作为一个参数传递给模板引擎，并显示 html 页面。</p><p id="99f3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">创建下面的<em class="mr">result.html</em>文件，并将其添加到模板文件夹中。</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="4681" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">再次运行应用程序，它应该在提交表单后预测收入。</p><blockquote class="no np nq"><p id="9c47" class="kf kg mr kh b ki kj jr kk kl km ju kn nr kp kq kr ns kt ku kv nt kx ky kz la ij bi translated">我们已经成功创建了 Webapp。现在该用 heroku 来部署了。</p></blockquote><p id="f362" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是我们项目布局的样子——</p><pre class="mc md me mf gt nu nv nw nx aw ny bi"><span id="edee" class="ms lk iq nv b gy nz oa l ob oc"><strong class="nv ir">/income-prediction<br/>   ├── templates<br/>   │   └── index.html<br/>   ├── venv/<br/>   ├── model.pkl<br/>   └── setup.py</strong></span></pre></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="c8d7" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated">使用 Heroku 部署 Flask 应用程序</h1><figure class="mc md me mf gt mg gh gi paragraph-image"><div class="ab gu cl og"><img src="../Images/84ed92bcaf632645c260e8cea0ab9d88.png" data-original-src="https://miro.medium.com/v2/format:webp/1*fIjRtO5P8zc3pjs0E5hYkw.png"/></div></figure><p id="96e8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae lb" href="https://www.heroku.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir"> Heroku </strong> </a>是一个平台即服务(PaaS)，使开发者能够完全在云中构建、运行和操作应用。在这个项目中，我们使用<a class="ae lb" href="https://devcenter.heroku.com/articles/git" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir">heroku git</strong></a><strong class="kh ir">进行部署。</strong></p><p id="9dbd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们需要在我们的系统上安装 git 和 heroku CLI。请参考这些链接——<strong class="kh ir"/><a class="ae lb" href="https://git-scm.com/book/en/v2/Getting-Started-Installing-Git" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir">Git</strong></a><strong class="kh ir"/><a class="ae lb" href="https://devcenter.heroku.com/articles/heroku-cli" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir">Heroku</strong></a><strong class="kh ir">】。现在，访问 Heroku 并创建一个帐户。</strong></p><p id="ae38" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们开始吧—</p><h2 id="95c9" class="ms lk iq bd ll mt mu dn lp mv mw dp lt ko mx my lv ks mz na lx kw nb nc lz nd bi translated">第一步:</h2><p id="93be" class="pw-post-body-paragraph kf kg iq kh b ki ne jr kk kl nf ju kn ko ng kq kr ks nh ku kv kw ni ky kz la ij bi translated">首先我们需要将<strong class="kh ir"> gunicorn </strong>下载到我们的虚拟环境 venv 中。我们可以用 pip 下载。</p><pre class="mc md me mf gt nu nv nw nx aw ny bi"><span id="955a" class="ms lk iq nv b gy nz oa l ob oc"><strong class="nv ir">pip install gunicorn</strong></span></pre><p id="2878" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Gunicorn 非常容易地处理请求并处理复杂的事情，如线程，当我们开发应用程序时，我们用来本地运行 Flask 的服务器不擅长处理真正的请求，因此我们使用 gunicorn。</p><h2 id="62b1" class="ms lk iq bd ll mt mu dn lp mv mw dp lt ko mx my lv ks mz na lx kw nb nc lz nd bi translated">第二步:</h2><p id="f44f" class="pw-post-body-paragraph kf kg iq kh b ki ne jr kk kl nf ju kn ko ng kq kr ks nh ku kv kw ni ky kz la ij bi translated">在我们的本地机器上，我们安装了很多库和其他重要文件，如 flask、gunicorn、sklearn 等。我们需要告诉 heroku，我们的项目需要所有这些库来成功运行应用程序。这是通过创建一个<strong class="kh ir"> requirements.txt </strong>文件来完成的。</p><pre class="mc md me mf gt nu nv nw nx aw ny bi"><span id="33dd" class="ms lk iq nv b gy nz oa l ob oc"><strong class="nv ir">pip freeze &gt; requirements.txt</strong></span></pre><h2 id="3582" class="ms lk iq bd ll mt mu dn lp mv mw dp lt ko mx my lv ks mz na lx kw nb nc lz nd bi translated">第三步:</h2><p id="7aa9" class="pw-post-body-paragraph kf kg iq kh b ki ne jr kk kl nf ju kn ko ng kq kr ks nh ku kv kw ni ky kz la ij bi translated"><strong class="kh ir"> Procfile </strong>是应用根目录下的一个文本文件，用来明确声明启动应用应该执行什么命令。这是对 heroku 的基本要求。</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="2560" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个文件告诉 heroku 我们想要使用带有命令 gunicorn 和应用程序名称的 web 进程。</p><h2 id="6a92" class="ms lk iq bd ll mt mu dn lp mv mw dp lt ko mx my lv ks mz na lx kw nb nc lz nd bi translated">第四步:</h2><p id="dc98" class="pw-post-body-paragraph kf kg iq kh b ki ne jr kk kl nf ju kn ko ng kq kr ks nh ku kv kw ni ky kz la ij bi translated">在我们的项目文件夹中，我们有许多隐藏的或不必要的文件，我们不想部署到 heroku。例如 venv、实例文件夹或。缓存文件。为了不包含它们，我们创建了一个. gitignore 文件。</p><figure class="mc md me mf gt mg"><div class="bz fp l di"><div class="nj nk l"/></div></figure><p id="2e70" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是我们项目布局的样子——</p><pre class="mc md me mf gt nu nv nw nx aw ny bi"><span id="1b59" class="ms lk iq nv b gy nz oa l ob oc"><strong class="nv ir">/income-prediction<br/>   ├── templates<br/>   │   └── index.html<br/>   ├── venv/<br/>   ├── Procfile<br/>   ├── requirements.txt<br/>   ├── .gitignore<br/>   ├── model.pkl<br/>   └── setup.py</strong></span></pre><p id="a897" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们的项目准备推向 heroku。</p><p id="b568" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第五步:</p><p id="1249" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">打开终端并执行以下命令—</p><pre class="mc md me mf gt nu nv nw nx aw ny bi"><span id="7549" class="ms lk iq nv b gy nz oa l ob oc"><strong class="nv ir">heroku login</strong></span></pre><p id="3e7a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这将要求你的 heroku 证书。现在，我们需要创建一个 heroku 应用程序。</p><pre class="mc md me mf gt nu nv nw nx aw ny bi"><span id="8340" class="ms lk iq nv b gy nz oa l ob oc"><strong class="nv ir">heroku create</strong></span></pre><p id="3203" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这将使用系统生成的 url 创建一个 heroku 应用程序。我们可以稍后使用一组命令手动更改 url。</p><pre class="mc md me mf gt nu nv nw nx aw ny bi"><span id="ecb7" class="ms lk iq nv b gy nz oa l ob oc"><strong class="nv ir">git init<br/>git add .<br/>git commit -m 'initial commit'</strong></span></pre><p id="12e2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这将初始化回购，添加所有代码，并提交一条消息。</p><pre class="mc md me mf gt nu nv nw nx aw ny bi"><span id="4ad1" class="ms lk iq nv b gy nz oa l ob oc"><strong class="nv ir">git push heroku master<br/>heroku open</strong></span></pre><p id="ba06" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这将在 heroku 上推送整个应用程序，并在浏览器中打开网址。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="82f3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">搞定！</strong></p><p id="161d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就这么简单。我们创建了一个<strong class="kh ir">机器学习模型</strong>，对其进行训练，创建了一个<strong class="kh ir">网络应用</strong>来使用该模型预测新数据，并使用<strong class="kh ir"> heroku </strong>将其部署在互联网上。而且都是用<strong class="kh ir"> python </strong>做的！</p><blockquote class="no np nq"><p id="3d81" class="kf kg mr kh b ki kj jr kk kl km ju kn nr kp kq kr ns kt ku kv nt kx ky kz la ij bi translated"><strong class="kh ir">web app 的链接—</strong><a class="ae lb" href="https://income-predictor-from-census.herokuapp.com" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir">https://income-predictor-from-census.herokuapp.com</strong></a></p></blockquote></div></div>    
</body>
</html>