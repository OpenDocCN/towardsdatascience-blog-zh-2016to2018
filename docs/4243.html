<html>
<head>
<title>Coding Deep Learning for Beginners — Linear Regression (Part 1): Initialization and Prediction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">初学者的编码深度学习—线性回归(第一部分):初始化和预测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/coding-deep-learning-for-beginners-linear-regression-part-1-initialization-and-prediction-7a84070b01c8?source=collection_archive---------2-----------------------#2018-08-01">https://towardsdatascience.com/coding-deep-learning-for-beginners-linear-regression-part-1-initialization-and-prediction-7a84070b01c8?source=collection_archive---------2-----------------------#2018-08-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/e24d96eac761c12f4b226d0941b10591.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eTuQjEvXDbNwiK9Ke3FmxQ.jpeg"/></div></div></figure><div class=""/><p id="4974" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是“<strong class="ka jc">初学者深度学习编码</strong>”系列的第 3 篇文章。在这里，你可以在第一篇文章  <em class="kw">的底部找到所有文章</em>、<em class="kw">议程的<em class="kw">链接，以及关于下一篇文章</em> <a class="ae kx" href="https://medium.com/@krzyk.kamil/coding-deep-learning-for-beginners-start-a84da8cb5044" rel="noopener"> <em class="kw">预计发布日期的一般信息。</em>它们也可以在我的</a><a class="ae kx" href="https://github.com/FisherKK/F1sherKK-MyRoadToAI" rel="noopener ugc nofollow" target="_blank">开源文件夹— <strong class="ka jc"> MyRoadToAI </strong> </a>中找到，还有一些迷你项目、演示、教程和链接。</em></p><p id="2134" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你也可以<a class="ae kx" href="https://kamilkrzyk.com/article/coding_deep_learning_series/2018/08/01/coding-deep-learning-for-begginers-linear-regression-initialization-and-prediction" rel="noopener ugc nofollow" target="_blank">在我的个人网站</a>上阅读这篇文章，为了提高可读性(支持代码语法高亮、LaTeX 方程式等等)，我的个人网站由<a class="ae kx" href="https://jekyllrb.com/" rel="noopener ugc nofollow" target="_blank"> Jekyll </a>主办。</p><h1 id="ad43" class="ky kz jb bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">为什么是线性回归？</h1><p id="5faa" class="pw-post-body-paragraph jy jz jb ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">你们中的一些人可能想知道，为什么关于解释和编码神经网络的系列文章是从<strong class="ka jc">基本机器学习算法</strong>开始的，比如线性回归。从那里入手是很有道理的。首先，它是一个非常简单的算法，因此读者可以掌握对基本机器学习概念的<strong class="ka jc">理解，例如<em class="kw">监督学习</em>、<em class="kw">成本函数</em>和<em class="kw">梯度下降</em>。此外，在学习线性回归之后，理解逻辑回归算法是非常容易的，不管你信不信，可以将它归类为小型神经网络。在接下来的几篇文章中，您将会看到所有这些，甚至更多！</strong></p><h1 id="6249" class="ky kz jb bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">工具</h1><p id="a6ce" class="pw-post-body-paragraph jy jz jb ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">让我们介绍一下<strong class="ka jc">最流行的库</strong>，它们可以在每一个基于 Python 的机器学习或数据科学相关项目中找到。</p><ul class=""><li id="d729" class="mb mc jb ka b kb kc kf kg kj md kn me kr mf kv mg mh mi mj bi translated"><a class="ae kx" href="http://www.numpy.org/" rel="noopener ugc nofollow" target="_blank"> NumPy </a> —一个科学计算库，非常适合多变量微积分&amp;线性代数。提供<a class="ae kx" href="https://docs.scipy.org/doc/numpy-1.14.0/reference/generated/numpy.ndarray.html" rel="noopener ugc nofollow" target="_blank"> ndarray </a>类，可与<strong class="ka jc"> Python 列表进行比较，可被视为矢量或矩阵</strong>。</li><li id="8e6b" class="mb mc jb ka b kb mk kf ml kj mm kn mn kr mo kv mg mh mi mj bi translated"><a class="ae kx" href="https://matplotlib.org/" rel="noopener ugc nofollow" target="_blank">Matplotlib</a>—<strong class="ka jc">数据可视化工具包</strong>，允许创建各种 2d 和 3d 图形。</li><li id="7900" class="mb mc jb ka b kb mk kf ml kj mm kn mn kr mo kv mg mh mi mj bi translated"><a class="ae kx" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank">熊猫</a>—这个库是 Matplotlib 和 NumPy 库的包装器。它提供了<a class="ae kx" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html" rel="noopener ugc nofollow" target="_blank">数据帧</a>类。它<strong class="ka jc">将 NumPy 矩阵视为表</strong>，允许通过附加的名称访问行和列。在<strong class="ka jc">数据加载、保存、争论和探索过程</strong>中非常有帮助。提供一个功能接口，使部署更快。</li></ul><p id="229d" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用<a class="ae kx" href="https://pypi.org/project/pip/" rel="noopener ugc nofollow" target="_blank"> Python PyPi </a>可以单独安装每个库。它们将以下列别名导入到每篇文章的代码中。</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><h1 id="edd3" class="ky kz jb bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">什么是线性回归？</h1><p id="cdad" class="pw-post-body-paragraph jy jz jb ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">这是一个<strong class="ka jc">监督学习算法</strong>，其目标是<strong class="ka jc">基于给定的数据输入</strong>预测连续的数值。从几何角度来看，每个数据样本都是一个点。线性回归试图<strong class="ka jc">找到线性函数</strong>的参数，因此<strong class="ka jc">所有点与直线之间的距离尽可能小</strong>。用于参数更新的算法称为<strong class="ka jc">梯度下降</strong>。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mv"><img src="../Images/c2ea50b8415680cb98383ac2183dbc99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*IjxpxWcKX8EJUVFBNFeKdA.gif"/></div></div><figcaption class="mw mx gj gh gi my mz bd b be z dk">Training of Linear Regression model. The left graph displays the change of linear function parameters over time. The plot on the right renders the linear function using current parameters (source: <a class="ae kx" href="https://github.com/llSourcell/linear_regression_live" rel="noopener ugc nofollow" target="_blank">Siraj Raval GitHub</a>).</figcaption></figure><p id="8549" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">例如，如果我们有一个由某个特定区域的公寓属性及其价格组成的数据集，可以使用线性回归算法来查找一个数学函数，该函数将尝试根据其属性来估计不同公寓(在数据集之外)的价值。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi na"><img src="../Images/29dab43bc21e5bf5b7631bc2ff2b020c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eOrewomaMFP0E1fNyt8waw.png"/></div></div></figure><p id="e9b4" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">另一个例子是根据销售数据预测杂货店的食品供应量。这样，企业可以减少不必要的食物浪费。<strong class="ka jc">这种映射对于任何相关的输入输出数据对都是可以实现的。</strong></p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nb"><img src="../Images/67e3de2a0e3b20f310ae8af242b89286.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1lagOXTq9rdWyJz-zUr-yQ.png"/></div></div></figure><h1 id="f1a4" class="ky kz jb bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">数据准备</h1><p id="d759" class="pw-post-body-paragraph jy jz jb ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">在编码线性回归部分之前，最好有一些问题要解决。在像<a class="ae kx" href="https://archive.ics.uci.edu/ml/index.php" rel="noopener ugc nofollow" target="_blank"> UCI 知识库</a>或<a class="ae kx" href="https://www.kaggle.com/" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>这样的网站上可以找到很多数据集。在经历了许多之后，没有一个适合本文的研究案例。</p><p id="1c9d" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了获得数据，我进入了波兰网站<a class="ae kx" href="https://www.dominium.pl/pl/szukaj/mieszkania/nowe" rel="noopener ugc nofollow" target="_blank"> dominium.pl </a>，这是一个在我居住的克拉科夫市寻找公寓的搜索引擎。我完全随机选择了 76 套公寓，写下它们的属性并保存到<strong class="ka jc">。csv 文件</strong>。目标是<strong class="ka jc">训练能够预测克拉科夫公寓价格的线性回归模型</strong>。</p><p id="9b3a" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">数据集在我的 Dropbox 上的这个<a class="ae kx" href="https://www.dropbox.com/s/1octs0jg5o5j82o/cracow_apartments.csv?dl=0" rel="noopener ugc nofollow" target="_blank">链接</a>下。</p><h2 id="d873" class="nc kz jb bd la nd ne dn le nf ng dp li kj nh ni lm kn nj nk lq kr nl nm lu nn bi translated">加载数据</h2><p id="b520" class="pw-post-body-paragraph jy jz jb ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">让我们从读取数据开始。csv 文件转换为熊猫的 DataFrame 对象并显示一些数据行。为了达到这个目的，将使用 read_csv 函数。数据用冒号分隔，这就是添加<code class="fe no np nq nr b">sep=","</code>参数的原因。函数<a class="ae kx" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.head.html" rel="noopener ugc nofollow" target="_blank"> head </a>以易读的 HTML 表格的形式呈现前五行数据。</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="3cf2" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">代码的输出如下所示:</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ns"><img src="../Images/78c5b240515565da19ceb933a60b3c0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y2uKxTDyKCSJd-K8eUGvrw.png"/></div></div><figcaption class="mw mx gj gh gi my mz bd b be z dk">DataFrame visualisation in <a class="ae kx" href="http://jupyter.org/" rel="noopener ugc nofollow" target="_blank">Jupyter Notebook</a>.</figcaption></figure><p id="c7ec" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如表中所示，有四个特征<strong class="ka jc">描述公寓属性:</strong></p><ul class=""><li id="0676" class="mb mc jb ka b kb kc kf kg kj md kn me kr mf kv mg mh mi mj bi translated"><strong class="ka jc">distance _ to _ city _ center</strong>-步行从住所到<a class="ae kx" href="https://en.wikipedia.org/wiki/Main_Square,_Krak%C3%B3w" rel="noopener ugc nofollow" target="_blank">克拉科夫主广场</a>的距离，用谷歌地图测得，</li><li id="995b" class="mb mc jb ka b kb mk kf ml kj mm kn mn kr mo kv mg mh mi mj bi translated"><strong class="ka jc">房间</strong> -公寓房间数，</li><li id="d6fd" class="mb mc jb ka b kb mk kf ml kj mm kn mn kr mo kv mg mh mi mj bi translated"><strong class="ka jc">面积</strong> -户型面积以平方米计量，</li><li id="e67d" class="mb mc jb ka b kb mk kf ml kj mm kn mn kr mo kv mg mh mi mj bi translated"><strong class="ka jc">价格</strong> -目标值(需要模型预测的)，以波兰国家货币计量的公寓成本——<a class="ae kx" href="https://en.wikipedia.org/wiki/Polish_z%C5%82oty" rel="noopener ugc nofollow" target="_blank">兹罗提</a>。</li></ul><h2 id="1b48" class="nc kz jb bd la nd ne dn le nf ng dp li kj nh ni lm kn nj nk lq kr nl nm lu nn bi translated">可视化数据</h2><p id="f16a" class="pw-post-body-paragraph jy jz jb ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">始终理解数据的结构非常重要。功能越多越难。在这种情况下，<a class="ae kx" href="https://en.wikipedia.org/wiki/Scatter_plot" rel="noopener ugc nofollow" target="_blank">散点图</a>用于<strong class="ka jc">显示目标和训练特征</strong>之间的关系。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nt"><img src="../Images/25f402f7fb1458b02b45be9e2a5c6256.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NmeKDxBgGdt7D2SvaXroAg.png"/></div></div><figcaption class="mw mx gj gh gi my mz bd b be z dk">Charts show whole data from cracow_apartments.csv. It was prepared with Matplotlib library in Jupyter Notebook. The code used to create these charts can be found under this <a class="ae kx" href="https://gist.github.com/FisherKK/0113b1eda361856a1cd29ad4fbd180d2" rel="noopener ugc nofollow" target="_blank">link</a>.</figcaption></figure><p id="891f" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">根据需要显示的内容，一些其他类型的可视化(例如<a class="ae kx" href="https://en.wikipedia.org/wiki/Box_plot" rel="noopener ugc nofollow" target="_blank">盒状图</a>)和技术可能是有用的(例如<a class="ae kx" href="https://en.wikipedia.org/wiki/Cluster_analysis" rel="noopener ugc nofollow" target="_blank">聚类</a>)。这里，可以观察到特征之间的<strong class="ka jc">线性相关性</strong>——随着 x 轴上值的增加，y 轴上的值也相应地线性增加或减少。这很好，因为如果不是这样(例如，关系将是指数的)，那么将很难拟合一条穿过所有点的线，并且应该考虑不同的算法。</p><h1 id="c10a" class="ky kz jb bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">公式</h1><p id="97b3" class="pw-post-body-paragraph jy jz jb ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">线性回归<strong class="ka jc">模型是一个数学公式</strong>，它以<strong class="ka jc">的数值向量</strong>(单个数据样本的属性)作为输入，并使用它们<strong class="ka jc">进行预测</strong>。</p><p id="68e3" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将相同的陈述映射到所呈现的问题的上下文中，有 76 个样本包含 Cracow 公寓的属性，其中每个样本从数学角度来看都是向量。每个<strong class="ka jc">特征向量与目标值</strong>配对(公式的预期结果)。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nu"><img src="../Images/29f2bf5a4f6672378f9856a378e5f5d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rRubXYPCZO-ZuEwGEaF4uw.png"/></div></div></figure><p id="8b5d" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">根据该算法，<strong class="ka jc">每个特征都分配有一个权重参数。</strong>表示其对模型的<strong class="ka jc">重要性</strong>。目标是找到权重值，因此每个公寓数据都满足以下等式。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nv"><img src="../Images/e66e1ccc3bf16e9ce66d5091331fc16d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xTNtQFAzNYsW_Amw1Mifxw.png"/></div></div></figure><p id="56ab" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">等式的左侧是一个线性函数<strong class="ka jc"/>。如<strong class="ka jc">操纵权重值可以改变线条的角度</strong>。<strong class="ka jc"> </strong>虽然，还是缺少了一个元素。当前函数总是通过坐标系的(0，0)点。为了解决这个问题，增加了另一个可训练参数。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nw"><img src="../Images/763d7ec71a35e33a0ac4b0feb7311bc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gwJByt1-1THrDvWjNI_-Vg.png"/></div></div></figure><p id="7080" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">该参数被命名为<strong class="ka jc">偏差，它赋予公式在 y 轴上上下移动的自由度</strong>。</p><p id="fc75" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">紫色参数属于模型，用于预测每个传入的样本。这就是为什么找到一种对所有样品都最有效的解决方案是必要的。形式上，该公式可以写成:</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nx"><img src="../Images/6ff4f369289f9d886d8e215c3c81595d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mtQi7bOrBYkTLAt541CHkA.png"/></div></div></figure><h1 id="8511" class="ky kz jb bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">初始化</h1><p id="80a3" class="pw-post-body-paragraph jy jz jb ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">这是一个创建<strong class="ka jc">第一个模型版本的阶段</strong>。初始化后的模型已经可以用于预测，但如果没有训练过程，结果将远远不是好的。有两件事要做:</p><ul class=""><li id="0eac" class="mb mc jb ka b kb kc kf kg kj md kn me kr mf kv mg mh mi mj bi translated"><strong class="ka jc">在代表权重和偏差参数的代码</strong>中创建变量，</li><li id="a848" class="mb mc jb ka b kb mk kf ml kj mm kn mn kr mo kv mg mh mi mj bi translated"><strong class="ka jc">决定模型参数的初始值</strong>。</li></ul><p id="d972" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">模型参数的初始值对于神经网络来说是非常重要的。在线性回归<strong class="ka jc">的情况下，参数值可以在开始时设置为零</strong>。</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="0bfc" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">函数<code class="fe no np nq nr b">init(n)</code>返回包含模型参数的字典。根据数学公式下方图例中的术语，<em class="kw"> n 是用于描述数据样本的特征数</em>。NumPy 库的<a class="ae kx" href="https://docs.scipy.org/doc/numpy-1.14.0/reference/generated/numpy.zeros.html" rel="noopener ugc nofollow" target="_blank"> zeros </a>函数使用它来返回一个 ndarray 类型的向量，该向量有 n 个元素，每个元素都赋有零值。Bias 是一个设置为 0.0 和<strong class="ka jc">的标量，将变量保持为浮点数而不是整数</strong>是一个好习惯。相应地，权重和偏差都可以在“w”和“b”字典键下访问。</p><p id="078b" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于 Cracow 公寓数据集，有三个特征描述每个样本。下面是调用<code class="fe no np nq nr b">init(3)</code>的结果:</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ny"><img src="../Images/2fea21409e01fcbe5d8d422f991a5895.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oXFspX1GcZSOIorvnezazw.png"/></div></div></figure><h1 id="827d" class="ky kz jb bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">预言；预测；预告</h1><p id="9fbb" class="pw-post-body-paragraph jy jz jb ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">模型可以使用创建的模型参数进行预测。公式已经显示出来了。现在是时候把它变成 Python 代码了。首先，每个特征都必须乘以其相应的权重并求和。那么偏差参数需要加到前面操作的乘积上。结果是一个预测。</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="8a21" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">函数<code class="fe no np nq nr b">predict(x, parameters)</code>有两个参数:</p><ul class=""><li id="5a77" class="mb mc jb ka b kb kc kf kg kj md kn me kr mf kv mg mh mi mj bi translated">代表数据样本的特征向量<code class="fe no np nq nr b">x</code>(例如单身公寓)，</li><li id="44ac" class="mb mc jb ka b kb mk kf ml kj mm kn mn kr mo kv mg mh mi mj bi translated">Python 字典<code class="fe no np nq nr b">parameters</code>存储了模型的参数及其当前状态。</li></ul><h1 id="6634" class="ky kz jb bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated"><strong class="ak">组装</strong></h1><p id="ff71" class="pw-post-body-paragraph jy jz jb ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">让我们将创建的所有代码部分放在一起，并显示在结果中。</p><figure class="mp mq mr ms gt is"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="1280" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka jc">只有一个特征用于预测</strong>什么<strong class="ka jc"> </strong>简化公式形成:</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nz"><img src="../Images/ae6ed2e3b992cebdbf129f06688a0ed2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y41rsL-etM_NFXKC42zU7A.png"/></div></div></figure><p id="5d83" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是有意为之，因为<strong class="ka jc">显示超过 1-2-3 维的数据的结果变得很麻烦</strong>，除非使用<a class="ae kx" href="https://en.wikipedia.org/wiki/Dimensionality_reduction" rel="noopener ugc nofollow" target="_blank">降维</a>技术(例如<a class="ae kx" href="https://en.wikipedia.org/wiki/Principal_component_analysis" rel="noopener ugc nofollow" target="_blank"> PCA </a>)。从现在起，出于学习目的，所有代码开发将只在<strong class="ka jc">尺寸</strong>特征上进行。当线性回归代码完成时，将显示使用所有功能的结果。</p><figure class="mp mq mr ms gt is gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/3856d618456d20de7a836d9119a63c38.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/format:webp/1*8ImNJi8Bbzgb3GdjtgR56A.png"/></div><figcaption class="mw mx gj gh gi my mz bd b be z dk">Line used to fit the data by Linear Regression model with current parameters. Code for visualisation is available under this <a class="ae kx" href="https://gist.github.com/FisherKK/a78a54d4fa9bdd56c9512f24b98df5f9" rel="noopener ugc nofollow" target="_blank">link</a>.</figcaption></figure><p id="d34f" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">模型参数用零值初始化，这意味着公式的输出将总是等于零。因此，<code class="fe no np nq nr b">prediction</code>是一个包含 76 个零值的 Python 列表，它们分别是每套公寓的预测价格。但是现在没关系。<strong class="ka jc">使用并解释梯度下降训练后，模型行为将会改善。</strong></p><p id="c2c0" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">代码片段的额外收获是:</p><ul class=""><li id="f562" class="mb mc jb ka b kb kc kf kg kj md kn me kr mf kv mg mh mi mj bi translated">模型使用的特征和目标值存储在<code class="fe no np nq nr b">features</code>和<code class="fe no np nq nr b">target</code> Python 列表中。由于这一点，如果要使用一组不同的特性，就不需要修改整个代码。</li><li id="43bb" class="mb mc jb ka b kb mk kf ml kj mm kn mn kr mo kv mg mh mi mj bi translated">使用<a class="ae kx" href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.as_matrix.html" rel="noopener ugc nofollow" target="_blank"> as_matrix </a>函数可以将 DataFrame 对象解析为 ndarray。</li></ul></div><div class="ab cl ob oc hu od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="ij ik il im in"><h1 id="f321" class="ky kz jb bd la lb oi ld le lf oj lh li lj ok ll lm ln ol lp lq lr om lt lu lv bi translated">摘要</h1><p id="8402" class="pw-post-body-paragraph jy jz jb ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">在本文中，我介绍了我将在整个文章系列中使用的工具。然后我提出了我要用线性回归算法解决的问题。最后，我展示了如何创建线性回归模型并使用它进行预测。</p><p id="f0b2" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在下一篇文章中，我将解释如何比较参数集和测量模型性能。最后，我将展示如何用梯度下降算法更新模型参数。</p><h1 id="d96e" class="ky kz jb bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated"><strong class="ak">下一篇</strong></h1><p id="1600" class="pw-post-body-paragraph jy jz jb ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">下一篇文章可点击<a class="ae kx" href="https://medium.com/@krzyk.kamil/coding-deep-learning-for-beginners-linear-regression-part-2-cost-function-49545303d29f" rel="noopener">这里</a>。</p></div></div>    
</body>
</html>