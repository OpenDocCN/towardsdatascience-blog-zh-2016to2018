<html>
<head>
<title>Keep it Simple!! — How to simplify understanding of algorithms like Gradient Descent</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">保持简单！！—如何简化对梯度下降等算法的理解</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/keep-it-simple-how-to-simplify-understanding-of-algorithms-like-gradient-descent-19cb418d4276?source=collection_archive---------3-----------------------#2017-04-16">https://towardsdatascience.com/keep-it-simple-how-to-simplify-understanding-of-algorithms-like-gradient-descent-19cb418d4276?source=collection_archive---------3-----------------------#2017-04-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/acdfec797114dae218db6c4fb97982a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vr1BAOqIqagBt7_V3hEPmg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Source: dilbert.com</figcaption></figure><p id="8402" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">当我第一次开始学习机器学习算法时，获得算法正在做什么的直觉是一项相当艰巨的任务。不仅仅是因为它很难理解所有的数学理论和符号，而且也很无聊。当我转向在线教程寻求答案时，我再次只能看到方程或高级解释，而没有浏览大多数情况下的细节。</p><p id="8475" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">就在那时，我的一位数据科学同事向我介绍了在excel表格中计算算法的概念。这对我产生了奇迹。任何新的算法，我都试着在excel中小规模地学习，相信我，它能奇迹般地增强你的理解，帮助你充分欣赏算法的美。</p><p id="2287" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">让我用一个例子来解释以上内容。</p><p id="d9b9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">大多数数据科学算法都是优化问题，最常用的算法之一是梯度下降算法。</p><p id="0a48" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在，对于初学者来说，梯度下降算法这个名字听起来可能有点吓人，但是，希望在看完这篇文章之后，这种情况会有所改变。</p><p id="f247" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">让我们以从住房数据预测新价格的价格为例。</p><p id="d50a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">给定<strong class="ke ir">历史住房数据，</strong>任务是创建一个模型，在给定房子大小的情况下预测新房子的价格。</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/5cfaa45d46e40b881d78b29f62be3571.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x7IkIjCfpb5pSrpRfB3qnA.png"/></div></div></figure><p id="6402" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">任务——对于一栋新房子，给定它的大小(X ),它的价格(Y)是多少？</p><p id="5748" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">让我们从绘制历史住房数据开始:</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/bfee15f1e35001cc5c288794c22cc6f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fI9WXJSogauVkxGDpdDwvg.png"/></div></div></figure><p id="3c35" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在，我们将使用一个简单的线性模型，其中我们在历史数据上拟合一条线，以预测给定其大小(X)的新房子的价格(Ypred)</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/8fe0a679f46b3b4a9f56875cbb4446b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*luIt-uUaGnjIopLP_ilMVA.png"/></div></div></figure><p id="c29f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在上图中，红线给出了给定房屋面积(X)的预测房价(Ypred)。Ypred = a+bX</p><p id="b0ed" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">蓝线给出了历史数据中的实际房价(Yactual)</p><p id="5ff1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">Yactual和Ypred之间的差异(由黄色虚线给出)是预测误差(E)</p><p id="d4b2" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">因此，我们需要找到一条具有最佳值a、b(称为权重)的线，通过减少预测误差来最佳拟合历史数据。</p><p id="17ab" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">因此，我们的目标是找到最优的<strong class="ke ir"> a，b </strong>，使房价的实际值和预测值之间的误差最小化:</p><p id="5fc6" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">误差平方和(SSE) = ∑(实际房价-预测房价)</strong></p><p id="cc2f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir"> = ∑ </strong> ( <strong class="ke ir"> Y — Ypred) </strong></p><p id="8345" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">(请注意，还有其他测量误差的方法。上交所只是其中之一。)</p><p id="c108" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这就是梯度下降的由来。梯度下降是一种优化算法，它找到减少预测误差的最佳权重(a，b)。</p><p id="ca97" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在让我们一步步来理解<strong class="ke ir">梯度下降算法:</strong></p><p id="96ec" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">步骤1:用随机值初始化权重(a &amp; b)并计算误差(SSE) </strong></p><p id="acec" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">步骤2:计算梯度，即当权重(a &amp; b)从其原始随机初始化值改变一个非常小的值时SSE的变化。这有助于我们将a &amp; b的值向SSE最小化的方向移动。</strong></p><p id="4785" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">步骤3:用梯度调整权重，向SSE最小的最优值移动</strong></p><p id="4dfc" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">步骤4:使用新的权重进行预测，并计算新的SSE </strong></p><p id="bdf8" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">第5步:重复第2步和第3步，直到对权重的进一步调整没有显著减少误差</strong></p><p id="78c9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们现在将详细讨论每个步骤(我已经在excel中完成了上面的步骤，粘贴在下面)。但在此之前，我们必须将数据标准化，因为这可以加快优化过程。</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/8d72159ba352bb177226a7f01b1744d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*erErbRP-hq5CcI8yBKjjGw.png"/></div></div></figure><p id="90df" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">步骤1: </strong>拟合直线Ypred = a + b X，从a和b的随机值开始，计算预测误差(SSE)</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi le"><img src="../Images/e8c3d7867b14615d45a3212e3335b30f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PsAE40NoLIE7O_V5A-CMmA.png"/></div></div></figure><p id="fa2e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">步骤2: </strong>根据权重计算误差梯度</p><p id="6595" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">∂SSE/∂a =-(Y-YP)</p><p id="eeb4" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">∂SSE/∂b =-(Y-YP)X</p><p id="82de" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这里，SSE= (Y-YP) = (Y-(a+bX))</p><p id="ed51" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这里有一点微积分，但仅此而已！！</p><p id="b20d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">∂SSE/∂a和∂SSE/∂b是<strong class="ke ir">梯度</strong>，它们给出了a，b w.r.t向SSE移动的方向。</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi le"><img src="../Images/3da5e9b6bf2cbbf80e455bc955a6a119.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VZlTMYkRQ7_AXo9ah5w0tA.png"/></div></div></figure><p id="2662" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">步骤3: </strong>用梯度调整权重，以达到SSE最小的最佳值</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lf"><img src="../Images/03a36091d800af8f70d415b9ed294339.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*4_PXeFKHhjoDZhw6kiRcfg.png"/></div></div></figure><p id="b455" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们需要更新a，b的随机值，使我们朝着最优a，b的方向前进。</p><p id="77d2" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">更新规则:</p><p id="82ac" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">①一个-∂SSE/∂a</p><p id="3cd1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">2)-∂sse/∂b</p><p id="a198" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">所以，更新规则:</p><ol class=""><li id="9762" class="lg lh iq ke b kf kg kj kk kn li kr lj kv lk kz ll lm ln lo bi translated">新的a = a-r *<strong class="ke ir">∂sse/∂a =</strong>0.45–0.01 * 3.300 = 0.42</li><li id="a1bf" class="lg lh iq ke b kf lp kj lq kn lr kr ls kv lt kz ll lm ln lo bi translated">新的b = b-r *<strong class="ke ir">∂sse/∂b</strong><strong class="ke ir">=</strong>0.75–0.01 * 1.545 = 0.73</li></ol><p id="f801" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这里，r是学习率= 0.01，这是对权重的调整速度。</p><p id="cb5a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">步骤4: </strong>使用新的a和b进行预测，并计算新的总SSE</p><figure class="la lb lc ld gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi le"><img src="../Images/57ded9103b5407c45013c96030a34f8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n0GLUShgF7OgL4s8faueSg.png"/></div></div></figure><p id="8a9f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">你可以看到，随着新的预测，总上证指数已经下降(0.677至0.553)。这意味着预测的准确性提高了。</p><p id="fb0c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">第5步:</strong>重复第3步和第4步，直到对a、b的进一步调整不会显著减小误差。这时候，我们已经到达了预测精度最高的最优a，b。</p><p id="867a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这是梯度下降算法。这种优化算法及其变体形成了许多机器学习算法的核心，如神经网络甚至深度学习。</p><p id="e59d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">喜欢你读的书吗？要以类似的简化方式学习其他算法，请在<a class="ae lu" href="http://www.deeplearningtrack.com" rel="noopener ugc nofollow" target="_blank">www.deeplearningtrack.com</a>注册为期8周的数据科学课程。通过访问www.deeplearningtrack.com<a class="ae lu" href="http://www.deeplearningtrack.com" rel="noopener ugc nofollow" target="_blank"><strong class="ke ir"><em class="lv">注册参加2017年4月22日的免费演示会</em></strong></a></p><p id="b253" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir"> <em class="lv"> Jahnavi </em> </strong>是一位机器学习和深度学习的爱好者，在过去的13年里，他在美国运通领导了多个机器学习团队。她是Deeplearningtrack的联合创始人，这是一个在线讲师指导的数据科学培训平台—<a class="ae lu" href="http://www.deeplearningtrack.com" rel="noopener ugc nofollow" target="_blank">www.deeplearningtrack.com</a></p></div></div>    
</body>
</html>