<html>
<head>
<title>Metastasis Detection Using CNNs, Transfer Learning and Data Augmentation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用细胞神经网络、迁移学习和数据增强的转移检测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/metastasis-detection-using-cnns-transfer-learning-and-data-augmentation-684761347b59?source=collection_archive---------17-----------------------#2018-11-20">https://towardsdatascience.com/metastasis-detection-using-cnns-transfer-learning-and-data-augmentation-684761347b59?source=collection_archive---------17-----------------------#2018-11-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/a246d8f143ee129a4d2f807c0cf50a48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lLtFfldN2J1B5viyZFMpbA.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/photos/REL986jyuX4?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Lurm</a> on <a class="ae kc" href="https://unsplash.com/search/photos/cells?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="fb1c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本项目的目标是使用 Kaggle 上托管的 PatchCamelyon 数据集<a class="ae kc" href="https://github.com/basveeling/pcam" rel="noopener ugc nofollow" target="_blank">【1】</a>在淋巴结的组织病理学图像上检测癌症转移。</p><p id="412c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对疾病进展的正确诊断对于选择最合适的治疗方案至关重要，这就是为什么医生依赖于可能存在转移的活检组织的组织病理学图像。在这个项目中，我们将训练一个模型来自动检测恶性肿瘤的证据，以帮助医生做出更好的决定，并有望为癌症患者提供更好的护理。</p><p id="88ef" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里介绍的步骤也可以为任何一般的图像分类问题提供一个强有力的基础:</p><h1 id="8055" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">数据</h1><p id="da9c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">该数据集是一组 96×96 的图像，其中如果在图像的 32×32 中心部分有恶性肿瘤的证据，则每个图像被标记为 1，否则被标记为 0。</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi me"><img src="../Images/99fece2f76ffe07422afa2c9242d360d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*994tgmGJLssN4R4076QEog.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Examples from the training set</figcaption></figure><h1 id="def9" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">增大</h1><p id="efe5" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">为了减少过度拟合并增加模型的泛化能力，我们使用数据扩充，这是应用于图像的随机扰动序列，保留了标签信息。用这些扰动进行训练也使模型对噪声更鲁棒，并增加其对平移和旋转的不变性。</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi me"><img src="../Images/1502d0a37b9ce623184a9ead5aea4215.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pYIVaZQPxLvK0RRg0psJSQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Random Augmentations applied to the same input image</figcaption></figure><h1 id="3e23" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">模型</h1><p id="a06e" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们使用在 ImageNet 上预先训练的 NasNet mobile(参见<a class="ae kc" href="https://en.wikipedia.org/wiki/Transfer_learning" rel="noopener ugc nofollow" target="_blank">迁移学习</a>)，因为它速度快，因此可以在 6 小时的时间限制内完全在 Kaggle 内核上训练。</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mj"><img src="../Images/61846688c5eda52799ae4d1656ae2223.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g-QOg_7Rpm0VZ1E2uYmo4g.png"/></div></div></figure><h1 id="3a7e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">培养</h1><p id="1874" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们使用训练集的一小部分作为验证，然后使用模型<a class="ae kc" href="https://keras.io/callbacks/#modelcheckpoint" rel="noopener ugc nofollow" target="_blank">检查点</a> Keras 回调来保存最佳权重，并在我们对排行榜数据进行预测之前加载它们。</p><h1 id="b74b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">预测和后处理</h1><p id="560c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">对于测试集的每个图像，我们平均原始图像的预测和水平/垂直翻转版本的预测。</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mk"><img src="../Images/2fa7c4137e40e49ab9ab2897bec0cdb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bqhiBi-l5aY4crzJsBiJAg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Leaderboard Result</figcaption></figure><p id="e796" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这种方法获得了<strong class="kf ir"> 0.9709 </strong>的<a class="ae kc" href="https://en.wikipedia.org/wiki/Receiver_operating_characteristic" rel="noopener ugc nofollow" target="_blank"> AUC </a>分数，与最先进的<strong class="kf ir"> 0.963 </strong>的<a class="ae kc" href="https://arxiv.org/abs/1806.03962" rel="noopener ugc nofollow" target="_blank">数字病理学</a>旋转等变 CNNs 相当。</p><p id="fcd8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">可以在 Kaggle 上在线运行模型:<a class="ae kc" href="https://www.kaggle.com/CVxTz/cnn-starter-nasnet-mobile-0-9709-lb" rel="noopener ugc nofollow" target="_blank">https://www . ka ggle . com/cvx tz/CNN-starter-nasnet-mobile-0-9709-lb</a></p><p id="70b1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">github Repo:<a class="ae kc" href="https://github.com/CVxTz/malignancy_detection/tree/master/code" rel="noopener ugc nofollow" target="_blank">https://github . com/CVxTz/恶性肿瘤 _ 检测/tree/master/code </a></p><p id="51ae" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">[1]https://github.com/basveeling/pcam<a class="ae kc" href="https://github.com/basveeling/pcam" rel="noopener ugc nofollow" target="_blank"/></p></div></div>    
</body>
</html>