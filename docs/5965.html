<html>
<head>
<title>Deploying a Python Web App on AWS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 AWS 上部署 Python Web 应用程序</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/deploying-a-python-web-app-on-aws-57ed772b2319?source=collection_archive---------0-----------------------#2018-11-19">https://towardsdatascience.com/deploying-a-python-web-app-on-aws-57ed772b2319?source=collection_archive---------0-----------------------#2018-11-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/248a08752bb99b18d0c45766ee3f15fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Rk_2DOiDynMKs0yukrfNw.jpeg"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">(<a class="ae jd" href="https://www.pexels.com/photo/trees-surrounded-by-green-grass-field-during-daytime-164025/" rel="noopener ugc nofollow" target="_blank">Source</a>)</figcaption></figure><div class=""/><div class=""><h2 id="bb2c" class="pw-subtitle-paragraph kd jf jg bd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku dk translated">如何与世界分享您的 Python 项目</h2></div><p id="a912" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">虽然我喜欢做数据科学和编程项目，因为我个人喜欢构建自己的东西，但与世界上的任何人在线分享您的项目也是一种快乐。幸运的是，多亏了亚马逊网络服务(AWS ),在几分钟内，我们就可以向全世界免费部署一个 Python 网络应用程序。</p><p id="d706" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在本文中，我们将了解如何在免费的 EC2 实例上将深度学习 web 应用部署到 AWS。本文将使用内置于<a class="ae jd" rel="noopener" target="_blank" href="/deploying-a-keras-deep-learning-model-as-a-web-application-in-p-fc0f2354a7ff">的应用程序，部署一个 Keras 深度学习模型作为 Python </a>中的 Web 应用程序，通过 Python 中的示例使用在<a class="ae jd" rel="noopener" target="_blank" href="/recurrent-neural-networks-by-example-in-python-ffd204f99470">递归神经网络中开发的模型。这两个都不是必需的，只需知道我们的应用程序使用 RNN 生成新颖的专利摘要。项目的所有代码都可以在 GitHub </a>上找到<a class="ae jd" href="https://github.com/WillKoehrsen/recurrent-neural-networks" rel="noopener ugc nofollow" target="_blank">。</a></p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="f6e4" class="lz ma jg bd mb mc md dn me mf mg dp mh le mi mj mk li ml mm mn lm mo mp mq mr bi translated">亚马逊网络服务 EC2</h2><p id="e9c3" class="pw-post-body-paragraph kv kw jg kx b ky ms kh la lb mt kk ld le mu lg lh li mv lk ll lm mw lo lp lq ij bi translated"><a class="ae jd" href="https://aws.amazon.com/" rel="noopener ugc nofollow" target="_blank">亚马逊网络服务</a>是亚马逊云计算产品系列的总称。我们将使用亚马逊弹性计算云(EC2) ，这是一项服务，我们在云中租用虚拟计算机来运行应用程序。AWS EC2 提供了一个免费层<a class="ae jd" href="https://aws.amazon.com/free/" rel="noopener ugc nofollow" target="_blank"/>,因此我们可以不花一分钱进行部署。</p><p id="4fe9" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">首先，创建一个 AWS 账户，然后前往位于<a class="ae jd" href="https://console.aws.amazon.com/ec2" rel="noopener ugc nofollow" target="_blank">https://console.aws.amazon.com/ec2</a>的 EC2 控制台。点击 Launch Instance 按钮，选择一个<a class="ae jd" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/AMIs.html" rel="noopener ugc nofollow" target="_blank">Amazon Machine Instance(AMI)</a>“包含启动实例所需的软件配置(操作系统)的模板”你可以使用任何你熟悉的操作系统(尽管有些不符合免费层的条件)，但我将使用 Ubuntu Server 18.04:</p><figure class="my mz na nb gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mx"><img src="../Images/0caaf0d326531756372101a0ac11fb5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uEsKdYXcg3whZGoXITZpwg.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">AMI type (Ubuntu 18.04)</figcaption></figure><p id="6eb0" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">点击 Select，然后在下一页选择符合条件的 t2.micro 实例(实例是我们 AMI 的硬件)。这只有 1 个 CPU 和 1 GB 的 RAM，但实际上足以运行我们预先训练的递归神经网络应用程序！如果你期望更多的流量或者运行一个 cpu 密集型的应用程序，你可能不得不付钱。</p><h2 id="8687" class="lz ma jg bd mb mc md dn me mf mg dp mh le mi mj mk li ml mm mn lm mo mp mq mr bi translated">安全组</h2><p id="c0f3" class="pw-post-body-paragraph kv kw jg kx b ky ms kh la lb mt kk ld le mu lg lh li mv lk ll lm mw lo lp lq ij bi translated">选择所需的实例类型，然后转到选项卡 6。在页面顶部配置安全组。<a class="ae jd" href="https://cloudacademy.com/blog/aws-security-groups-instance-level-security/" rel="noopener ugc nofollow" target="_blank">安全组</a>过滤进出我们实例的流量——基本上，谁可以访问我们的虚拟计算机。</p><p id="968a" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您(只有您)需要通过<code class="fe nc nd ne nf b">ssh</code>访问实例，所以添加一个规则，允许 SSH 使用<code class="fe nc nd ne nf b">Source</code>“My IP”。我们希望<em class="lr"> others </em>能够在网络浏览器中访问我们的应用程序，所以添加一个规则来允许所有来源的 HTTP 访问。最终的安全配置是:</p><figure class="my mz na nb gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ng"><img src="../Images/ae30b68cc5c67057fa4978db324a6bf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IKNRdJSfpBX7suEmHFvfog.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Security group rules</figcaption></figure><p id="7cf9" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">接下来，点击查看和启动，然后启动。这将显示使用<a class="ae jd" href="https://www.comodo.com/resources/small-business/digital-certificates2.php" rel="noopener ugc nofollow" target="_blank">密钥对</a>的选项。你需要这个来通过<code class="fe nc nd ne nf b">ssh</code>访问服务器，所以请确保创建一个新的密钥对，并将私钥保存在你记得的地方。如果丢失，您将无法再次访问您的实例！</p><p id="b474" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最后，点击 Launch Instances，Amazon 将启动您自己的虚拟机，该虚拟机实际位于… <a class="ae jd" href="https://aws.amazon.com/about-aws/global-infrastructure/" rel="noopener ugc nofollow" target="_blank">某处</a>。等待几分钟，让实例启动，然后进入下一步:连接到实例。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="8743" class="nh ma jg bd mb ni nj nk me nl nm nn mh km no kn mk kp np kq mn ks nq kt mq nr bi translated">通过 SSH 连接到服务器</h1><p id="debb" class="pw-post-body-paragraph kv kw jg kx b ky ms kh la lb mt kk ld le mu lg lh li mv lk ll lm mw lo lp lq ij bi translated">一旦实例启动并运行，在 EC2 <a class="ae jd" href="https://console.aws.amazon.com/ec2/v2/home?region=us-east-1" rel="noopener ugc nofollow" target="_blank">实例仪表板</a>上选择它(服务&gt; EC2 &gt;运行实例)并点击 Connect。这将为我们提供连接到实例的确切命令。</p><figure class="my mz na nb gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ns"><img src="../Images/8729abe92e06377c5952906a11af9c74.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R2sZWzfZKOeUlFFTTjKMmQ.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Connect dialog from EC2 running instances dashboard.</figcaption></figure><p id="325c" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">复制示例代码，并将其粘贴到 Bash 中，或者粘贴到在带有您的私钥的文件夹中运行的命令提示符中(在启动您的实例时生成)。假设一切顺利，您将登录到您的实例并看到一个熟悉的终端命令提示符。</p><h2 id="c2a2" class="lz ma jg bd mb mc md dn me mf mg dp mh le mi mj mk li ml mm mn lm mo mp mq mr bi translated">安装要求</h2><p id="a7a3" class="pw-post-body-paragraph kv kw jg kx b ky ms kh la lb mt kk ld le mu lg lh li mv lk ll lm mw lo lp lq ij bi translated">这个 AMI 配备了<a class="ae jd" href="https://www.python.org/downloads/release/python-360/" rel="noopener ugc nofollow" target="_blank"> Python 3.6 </a>，所以我们只需要克隆存储库并安装应用依赖项。首先，获取存储库:</p><pre class="my mz na nb gt nt nf nu nv aw nw bi"><span id="9774" class="lz ma jg nf b gy nx ny l nz oa">git clone <a class="ae jd" href="https://github.com/WillKoehrsen/recurrent-neural-networks.git" rel="noopener ugc nofollow" target="_blank">https://github.com/WillKoehrsen/recurrent-neural-networks.git</a></span></pre><p id="c059" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后安装<code class="fe nc nd ne nf b">pip</code>，移入资源库，安装需求。</p><pre class="my mz na nb gt nt nf nu nv aw nw bi"><span id="7c9e" class="lz ma jg nf b gy nx ny l nz oa">sudo apt-get update<br/>sudo apt-get install python3-pip<br/>cd recurrent-neural-networks<br/>pip3 install --user -r requirements.txt</span></pre><h2 id="b1b6" class="lz ma jg bd mb mc md dn me mf mg dp mh le mi mj mk li ml mm mn lm mo mp mq mr bi translated">运行和访问 Web 应用程序</h2><p id="bdaf" class="pw-post-body-paragraph kv kw jg kx b ky ms kh la lb mt kk ld le mu lg lh li mv lk ll lm mw lo lp lq ij bi translated">运行应用程序很简单(第二个命令可能需要<code class="fe nc nd ne nf b">sudo</code>):</p><pre class="my mz na nb gt nt nf nu nv aw nw bi"><span id="27d2" class="lz ma jg nf b gy nx ny l nz oa">cd deployment<br/>python3 run_keras_server.py</span></pre><p id="7f4e" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">(如果你想了解 web 应用程序中发生了什么，看看<a class="ae jd" rel="noopener" target="_blank" href="/deploying-a-keras-deep-learning-model-as-a-web-application-in-p-fc0f2354a7ff">以前的文章</a>中的开发过程)。</p><p id="39dd" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您应该在终端中看到以下输出:</p><figure class="my mz na nb gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ob"><img src="../Images/354be12dbe55935e0669d48ded41d70d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t0n3RWcaOR2KBKKL93VJrg.png"/></div></div></figure><p id="4572" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">虽然看起来这个应用运行在 localhost:80/上，但那是在<em class="lr">虚拟机</em>上。为了访问 web 应用程序，我们必须使用实例的<a class="ae jd" href="https://en.wikipedia.org/wiki/IPv4" rel="noopener ugc nofollow" target="_blank">公共 DNS IPv4 </a>，它可以在正在运行的实例仪表板上找到。</p><figure class="my mz na nb gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oc"><img src="../Images/44b3a8a35dcc78934fbce422acd1a27e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1oJJfK0ucS-s6NNZlNqTOg.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Public DNS for running instance.</figcaption></figure><p id="6295" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">将地址复制并粘贴到您的浏览器中，您将看到该应用程序！</p><figure class="my mz na nb gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi od"><img src="../Images/ef888d72b521bbb6edca3d5d62423f0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9b1B9ByHGnhemHFQDjze8Q.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Homepage of the web application.</figcaption></figure><p id="7f99" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">请随意使用递归神经网络应用程序。它所做的是用一个递归神经网络生成新的专利摘要，这个神经网络用关键词“神经网络”训练成千上万的摘要，你可以输入<code class="fe nc nd ne nf b">random</code>作为随机的开始序列，或者你自己的序列。(要看发展，查看<a class="ae jd" rel="noopener" target="_blank" href="/recurrent-neural-networks-by-example-in-python-ffd204f99470">这篇文章</a>或者<a class="ae jd" href="https://github.com/WillKoehrsen/recurrent-neural-networks/blob/master/notebooks/Deep%20Dive%20into%20Recurrent%20Neural%20Networks.ipynb" rel="noopener ugc nofollow" target="_blank">这个笔记本</a>)。</p><figure class="my mz na nb gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oe"><img src="../Images/fc364d03168ff7089494db6310c262f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*CmoIXCNs2E6rnAzbInHIvA.gif"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Keras recurrent neural network application.</figcaption></figure><p id="b97c" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，世界上任何人都可以通过 IPv4 访问您的应用程序。如果您想让应用程序在您注销实例后继续运行，请在<a class="ae jd" href="https://www.gnu.org/software/screen/manual/screen.html" rel="noopener ugc nofollow" target="_blank">屏幕会话</a>中运行它。(<a class="ae jd" href="https://www.gnu.org/software/screen/" rel="noopener ugc nofollow" target="_blank"> Screen 是一个方便的程序</a>，它可以让你使用虚拟控制台从一个终端窗口运行终端会话。)</p><pre class="my mz na nb gt nt nf nu nv aw nw bi"><span id="f12d" class="lz ma jg nf b gy nx ny l nz oa"># From within recurrent-neural-networks/deployment<br/>screen -R deploy<br/>python3 run_keras_server.py</span></pre><p id="6d41" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我的(如果我没有关闭它或遇到错误)应用程序应该在<a class="ae jd" href="http://54.173.255.177/" rel="noopener ugc nofollow" target="_blank">http://54.173.255.177/</a>运行。因为我使用的是 t2.micro 实例，所以永久运行这个 web 应用程序的成本正好是$0.00！如果你想要一个域名，你可以从<a class="ae jd" href="https://en.wikipedia.org/wiki/Domain_name_registrar" rel="noopener ugc nofollow" target="_blank">域名注册商</a>比如<a class="ae jd" href="https://www.hover.com/" rel="noopener ugc nofollow" target="_blank">哈弗</a>那里拿一个。</p><h2 id="e0cc" class="lz ma jg bd mb mc md dn me mf mg dp mh le mi mj mk li ml mm mn lm mo mp mq mr bi translated">后续步骤</h2><p id="974b" class="pw-post-body-paragraph kv kw jg kx b ky ms kh la lb mt kk ld le mu lg lh li mv lk ll lm mw lo lp lq ij bi translated">尽管这是一个快速部署个人项目的不错的解决方案，但这不是一个<a class="ae jd" href="http://guides.beanstalkapp.com/deployments/best-practices.html" rel="noopener ugc nofollow" target="_blank">生产就绪的部署</a>！为此，你要确保使用<a class="ae jd" href="https://blog.miguelgrinberg.com/post/running-your-flask-application-over-https" rel="noopener ugc nofollow" target="_blank">适当的安全措施(HTTPS 和认证证书)</a>。您还需要确保您的<a class="ae jd" href="https://github.com/locustio/locust" rel="noopener ugc nofollow" target="_blank">应用程序能够处理预期的流量。</a>仅将此特定解决方案用于没有敏感数据的小型项目。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="10a7" class="nh ma jg bd mb ni nj nk me nl nm nn mh km no kn mk kp np kq mn ks nq kt mq nr bi translated">结论</h1><p id="b652" class="pw-post-body-paragraph kv kw jg kx b ky ms kh la lb mt kk ld le mu lg lh li mv lk ll lm mw lo lp lq ij bi translated">我们确实生活在一个不可思议的时代:使用 Flask，我们可以在几分钟内开发一个 Python web 应用程序，然后我们可以使用 AWS 将其免费部署到世界各地。我们遵循的一般流程是:开发一个 web 应用程序(最好用 Python)，从云提供商那里租用商用硬件，然后向全世界部署一个 web 应用程序。</p><p id="5641" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果您能够遵循所有教程，从递归神经网络的<a class="ae jd" rel="noopener" target="_blank" href="/recurrent-neural-networks-by-example-in-python-ffd204f99470">实现</a>到<a class="ae jd" rel="noopener" target="_blank" href="/deploying-a-keras-deep-learning-model-as-a-web-application-in-p-fc0f2354a7ff">开发本地 web 应用</a>到在 AWS 上部署，那么您将完成一个令人印象深刻的项目！从一个空白文件到一个正在运行的 web 应用程序的整个过程可能令人望而生畏，但是像大多数技术问题一样，如果你把它分解，每一步都不是压倒性的，有许多开源工具可以使这个过程变得容易。如果你是一个厌倦了在 Jupyter 笔记本上做独立分析的数据科学家，那就主动做一个可以作为应用程序部署的项目。扩展到其他学科是很好的，构建和部署 web 应用程序是学习一些新技能的好机会。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="71ea" class="pw-post-body-paragraph kv kw jg kx b ky kz kh la lb lc kk ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">一如既往，我欢迎反馈和建设性的批评。可以通过 Twitter <a class="ae jd" href="http://twitter.com/@koehrsen_will" rel="noopener ugc nofollow" target="_blank"> @koehrsen_will </a>或者通过我的个人网站<a class="ae jd" href="https://willk.online" rel="noopener ugc nofollow" target="_blank"> willk.online </a>找到我。</p></div></div>    
</body>
</html>