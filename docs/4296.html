<html>
<head>
<title>Implement CRISP Data Science with AWS SageMaker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用 AWS SageMaker 实现清晰的数据科学</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/implement-crisp-data-science-with-aws-sagemaker-59163a63b0ad?source=collection_archive---------6-----------------------#2018-08-05">https://towardsdatascience.com/implement-crisp-data-science-with-aws-sagemaker-59163a63b0ad?source=collection_archive---------6-----------------------#2018-08-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/da68d83526d2d591a65ad3f6b6ccf91d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FNJ3zKxpDOJiuQsD6s7_ew.jpeg"/></div></div></figure><p id="6302" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">本文旨在展示 AWS 开发和托管行业标准机器学习产品和研究级算法的能力和敏捷性。</p><p id="80c9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">该概念通过使用“对象检测算法”示例(<a class="ae kw" href="https://github.com/wutianchen/object-detection-algo" rel="noopener ugc nofollow" target="_blank">https://github.com/wutianchen/object-detection-algo</a>)在 AWS 云上实施 CRISP 数据科学工作流得到验证。</p><h1 id="94ff" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">数据科学中关注点的分离</h1><p id="2568" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">CRISP(数据挖掘的跨行业标准流程)是一个敏捷的工作流或框架，它很好地捕捉了数据科学中关注点的分离。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ma"><img src="../Images/cca921df1d3d82d8a56d1f3e4485d449.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*28xVJbiWqyGn65X35dcLPQ.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">CRISP Workflow</figcaption></figure><p id="b374" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">标准 CRISP 包括上述 7 个组件和 4 个阶段。</p><ol class=""><li id="1c9a" class="mj mk iq ka b kb kc kf kg kj ml kn mm kr mn kv mo mp mq mr bi translated">形成业务问题并收集数据</li><li id="3693" class="mj mk iq ka b kb ms kf mt kj mu kn mv kr mw kv mo mp mq mr bi translated">处理数据并基于数据建立模型</li><li id="fea4" class="mj mk iq ka b kb ms kf mt kj mu kn mv kr mw kv mo mp mq mr bi translated">将模型打包到数据产品中并部署</li><li id="25d9" class="mj mk iq ka b kb ms kf mt kj mu kn mv kr mw kv mo mp mq mr bi translated">监控模型并收集信息</li></ol><p id="1aa0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">过程中来来回回并不少见。例如，我们可能被迫收集某些数据来回答一个业务问题，或者尝试各种统计模型来提高模型的准确性。</p><h1 id="1ac8" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">SageMaker—CRISP 的 AWS 实现</h1><p id="f299" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated"><a class="ae kw" href="https://github.com/awslabs/amazon-sagemaker-examples" rel="noopener ugc nofollow" target="_blank"> SageMaker </a>涵盖了从“数据理解”到“监控”的脆。前 SageMaker 时代的另一个类似工具是<a class="ae kw" href="https://github.com/ottogroup/palladium" rel="noopener ugc nofollow" target="_blank">钯</a>。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mx"><img src="../Images/c002f6834d04e3e2c33cf64ae40a3b79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FlvcidR5fhZkBuURlN2t1w.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">SageMaker and CRISP</figcaption></figure><p id="2b17" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> SageMaker 笔记本:</strong> (Jupyter 笔记本)启用从数据处理到统计建模，从分布式模型训练到评估的所有数据科学工作。</p><p id="2ca3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">SageMaker 既允许<a class="ae kw" href="https://github.com/awslabs/amazon-sagemaker-examples/blob/master/advanced_functionality/scikit_bring_your_own/scikit_bring_your_own.ipynb" rel="noopener ugc nofollow" target="_blank">定制算法</a>，也允许<a class="ae kw" href="https://aws.amazon.com/blogs/machine-learning/amazon-sagemaker-now-supports-pytorch-and-tensorflow-1-8/" rel="noopener ugc nofollow" target="_blank">内置算法</a>。</p><p id="17be" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> SageMaker 端点:</strong>利用微服务容器架构部署数据科学的成果。也允许在单个端点后部署集合模型(加权模型集合)。</p><p id="a91d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">sage maker 和 Cloudtrail 的集成:</strong>自动记录结果。监控对于数据科学非常重要，因为它可以检测模型在现实世界中的“真实”准确性和数据分布漂移，以支持下一次清晰迭代中的决策。</p><h1 id="2278" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">一个例子——检测图像中的对象</h1><ul class=""><li id="7721" class="mj mk iq ka b kb lv kf lw kj my kn mz kr na kv nb mp mq mr bi translated"><strong class="ka ir">我们来形成一个问题:</strong></li></ul><p id="2515" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">用概率检测图像中预定义对象列表的位置和标签。</p><ul class=""><li id="ade4" class="mj mk iq ka b kb kc kf kg kj ml kn mm kr mn kv nb mp mq mr bi translated"><strong class="ka ir">问题需要算法:</strong></li></ul><p id="08da" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了解决这个问题，我们借用 Keras RetinaNet 对象检测算法(后端 tensorflow)的<a class="ae kw" href="https://github.com/fizyr/keras-retinanet" rel="noopener ugc nofollow" target="_blank">实现，在论文</a><a class="ae kw" href="https://arxiv.org/abs/1708.02002" rel="noopener ugc nofollow" target="_blank">密集对象检测的焦损失</a>中有详细描述。</p><p id="efe6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用快速 R-CNN 实现的以前版本的解决方案可以在这里找到(博客:<a class="ae kw" href="https://softwaremill.com/counting-objects-with-faster-rcnn/" rel="noopener ugc nofollow" target="_blank">用更快的 R-CNN </a>计算对象)</p><p id="f819" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">可以在<a class="ae kw" href="http://host.robots.ox.ac.uk/pascal/VOC/" rel="noopener ugc nofollow" target="_blank"> Pascal VOC 数据集</a>以及<a class="ae kw" href="http://cocodataset.org/#home" rel="noopener ugc nofollow" target="_blank"> MS COCO 数据集</a>等上轻松训练模型。使用存储库中提供的脚本。然后在特定领域数据集上应用迁移学习来提高其回答特定问题的性能。</p><p id="9d86" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">由于关注点的分离，模型可以在不涉及项目其他部分的情况下被改变和部署。</p><blockquote class="nc nd ne"><p id="36a0" class="jy jz nf ka b kb kc kd ke kf kg kh ki ng kk kl km nh ko kp kq ni ks kt ku kv ij bi translated">把算法的东西还给算法，把基础设施的东西还给基础设施。</p></blockquote><ul class=""><li id="6c3c" class="mj mk iq ka b kb kc kf kg kj ml kn mm kr mn kv nb mp mq mr bi translated"><strong class="ka ir">算法需要一个 web 服务器:</strong></li></ul><p id="4d4b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了在 AWS 上部署该算法，必须实现两个接口。</p><ol class=""><li id="b670" class="mj mk iq ka b kb kc kf kg kj ml kn mm kr mn kv mo mp mq mr bi translated">web 服务器路由接口</li><li id="b004" class="mj mk iq ka b kb ms kf mt kj mu kn mv kr mw kv mo mp mq mr bi translated">预测功能界面</li></ol><p id="a86f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">(由于 AWS Lambda 的上传限制，以无服务器方式在 AWS 上部署机器学习算法仍然很困难。)</p><p id="71f9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">实现 web 服务器路由接口(/ping 和/invocations)</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nj"><img src="../Images/97783c0e4271a555098eda136f86a57a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qWrGv539A-kzlqofbQUTtQ.png"/></div></div></figure><p id="17b0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">实现预测接口(get_model 和 predict 函数)</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nk"><img src="../Images/e311628e90fa890a7c4649126d721cfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RRIz1acYTedYBRVagu21ww.png"/></div></div></figure><p id="39e6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">带有轻量级 python web 服务器 flask 和 docker 脚本的通用模板可以在<a class="ae kw" href="https://github.com/awslabs/amazon-sagemaker-examples/blob/master/advanced_functionality/scikit_bring_your_own/" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><ul class=""><li id="57f1" class="mj mk iq ka b kb kc kf kg kj ml kn mm kr mn kv nb mp mq mr bi translated"><strong class="ka ir">服务器需要端点:</strong></li></ul><p id="3c1b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用 Sagemaker，有两种面向客户端的端点可能性</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/41956827c93229960a764730b807c4fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6sp5LQ5hcLuqnxHAo73rPw.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">Build Endpoint for ML Model</figcaption></figure><ol class=""><li id="026a" class="mj mk iq ka b kb kc kf kg kj ml kn mm kr mn kv mo mp mq mr bi translated">HTTP 端点(<a class="ae kw" href="https://aws.amazon.com/blogs/machine-learning/call-an-amazon-sagemaker-model-endpoint-using-amazon-api-gateway-and-aws-lambda/" rel="noopener ugc nofollow" target="_blank">https://AWS . Amazon . com/blogs/machine-learning/call-an-Amazon-sage maker-model-Endpoint-using-Amazon-API-gateway-and-AWS-lambda/</a>)</li><li id="6fcb" class="mj mk iq ka b kb ms kf mt kj mu kn mv kr mw kv mo mp mq mr bi translated">SageMaker API 端点(<a class="ae kw" href="https://docs.aws.amazon.com/sagemaker/latest/dg/API_runtime_InvokeEndpoint.html" rel="noopener ugc nofollow" target="_blank">https://docs . AWS . Amazon . com/SageMaker/latest/DG/API _ runtime _ invokeendpoint . html</a></li></ol><p id="f8ff" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">模型被打包到 docker 容器中，并自动部署到 AWS ECR 上。然后可以通过端点调用 predict()方法来提供推断。</p><ul class=""><li id="f70d" class="mj mk iq ka b kb kc kf kg kj ml kn mm kr mn kv nb mp mq mr bi translated"><strong class="ka ir">测试终点:</strong></li></ul><p id="58ce" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们可以用 Sagemaker Notebook 调用和测试已部署的 ML 端点，并可视化结果。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/4c6f4254c355288f85b79655a2e46c27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2LXwZi3NQIK7xbCc8qmZ9Q.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">Invoke the Endpoint</figcaption></figure><p id="5ef8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在原始图像上绘制结果:</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nn"><img src="../Images/3028a9a733791cf00be67faa6fd72f62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7sxqpO20rH-mFvCGMmu-dA.png"/></div></div></figure><h1 id="1ae2" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">总结和下一次迭代</h1><p id="7291" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">总之，AWS SageMaker 是目前市场上在敏捷框架下实现数据科学概念的最佳工具。它还集成了其他 AWS 本地服务，如 S3，红移，AWS Lambda，AWS IoT 等。很好。例如，结合 Kinesis KVS，我们可以将图像对象检测扩展到视频流中的对象检测。</p><p id="fc9e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因为这是敏捷的…所以我们从简单开始，经过多次迭代来添加特性。</p></div></div>    
</body>
</html>