<html>
<head>
<title>Cross- Validation Code Visualization: Kind of Fun</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">交叉验证代码可视化:有点意思</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/cross-validation-code-visualization-kind-of-fun-b9741baea1f8?source=collection_archive---------3-----------------------#2017-08-28">https://towardsdatascience.com/cross-validation-code-visualization-kind-of-fun-b9741baea1f8?source=collection_archive---------3-----------------------#2017-08-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="ff9f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们<strong class="jp ir">想象</strong>来改善你的预测…</p><p id="027e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们说，你正在编写一个漂亮和干净的机器学习代码(例如线性回归)。你的代码是好的，首先你像往常一样用像<em class="kl"> train_test_split </em>这样的函数和一些<em class="kl">随机因子把你的数据集分成两部分“训练集和测试集”。</em>如下图所示，您的预测可能会略微偏低或偏高。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi km"><img src="../Images/ef98aa94a43c93978aacb91c6d41cb5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*0Z42x0nYm-WyftKiALjZLg.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Fig:Under and Over-Fit Prediction</figcaption></figure><p id="7790" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">结果也没有改变。那么我们能做什么呢？</p></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><p id="9654" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">顾名思义，交叉验证是学习<em class="kl">线性回归</em>之后的下一件有趣的事情，因为它有助于使用<strong class="jp ir"> <em class="kl"> K 倍</em> </strong>策略来改进你的预测。你问的 K 倍是多少？下面用<strong class="jp ir">代码</strong>解释一切。</p><p id="6278" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完整代码:)</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi lf"><img src="../Images/4cec3fc62f725eccf6b0a8494481d951.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vhcivhf78YxOHV2opJCJig.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Fig:- Cross Validation with Visualization</figcaption></figure><p id="9306" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">代码洞察:</p><p id="caaf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以上代码分为 4 个步骤…</p><ol class=""><li id="cfc2" class="lk ll iq jp b jq jr ju jv jy lm kc ln kg lo kk lp lq lr ls bi translated"><strong class="jp ir">加载</strong>和<strong class="jp ir">分割目标</strong>数据集。</li></ol><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/ab1571c89c84e690a7d82e900d1a6075.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*Pxt_DjJfvTxRItkRByl2Rg.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Fig:-Load the dataset</figcaption></figure><p id="596a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们正在将数据集中的目标复制到<em class="kl"> y </em>变量<em class="kl">中。</em>要查看数据集，取消<em class="kl"> print </em>行的注释。</p><p id="e327" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.<strong class="jp ir">型号选择</strong></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/19cf91eae51ff714d9572e016b8a9f5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*9Diy5bR8aWuIUv4g9zcDHw.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Fig:- Model Selection (LinearRegression())</figcaption></figure><p id="7884" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了简单起见，我们将使用线性回归。要了解更多信息，请点击“<a class="ae lv" href="https://medium.com/@sagarsharma4244/linear-regression-the-easier-way-6f941aa471ea" rel="noopener">线性回归:更简单的方法</a>”帖子。</p><p id="1eae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> 3。交叉验证:)</strong></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/79f7f9b5fb5b5582cdeda934778bef9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*X8MWzwLc7Trt3fvvWHb6TA.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Fig:- Cross Validation in sklearn</figcaption></figure><p id="e41e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是一个过程，也是 sklearn 中的一个功能</p><p id="62eb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"><em class="kl">【cross _ val _ predict(模型，数据，目标，cv) </em> </strong></p><p id="7bcc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在哪里，</p><p id="5caa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl">模型</em> </strong>是我们选择的要进行交叉验证的模型</p><p id="9ca5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl">数据</em> </strong>是数据。</p><p id="7186" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl">目标</em> </strong>是 w.r.t .数据的目标值。</p><p id="3ab6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl"> cv </em> </strong>(可选)为总折叠数(又名<em class="kl"> K-Fold </em>)。</p><p id="b309" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个过程中，我们不像通常那样将数据分为两组(训练集和测试集)，如下所示。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi lx"><img src="../Images/3514599dcc4c37f8b0c873a0b19af355.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fDK2iB1t7f2Gdyqfv3PMBg.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Fig:- Train set (Blue)and Test set (Red)</figcaption></figure><p id="8ac4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是我们把数据集分成相等的<em class="kl"> K </em>部分(<em class="kl"> K 倍或者</em> <strong class="jp ir"> <em class="kl"> cv </em> </strong>)。<strong class="jp ir">改进预测，更好地推广。</strong>然后在较大的数据集上训练模型，在较小的数据集上测试。我们姑且说<strong class="jp ir"> <em class="kl"> cv </em> </strong> <em class="kl"> </em>就是<strong class="jp ir"> 6。</strong></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/153a897796808e2dd4a4fc85e61cefcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*JnKOeRJVhkLWsO7IDF8cUw.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Fig:- 6 equal folds or parts</figcaption></figure><p id="91da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，模型分割的第一次迭代看起来像这样，红色是测试数据，蓝色是训练数据。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/08fdfc8aade378295db90f51dd27fde0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/1*NpzABcZwTgDy1Xsn3gPuog.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Fig:- cross_val first iteration</figcaption></figure><p id="a215" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第二次迭代将如下图所示。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/e346a7aedc546a5e720b2bb2c39b5084.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*9TwfQwZe7e8IVCTfO8ja6g.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Fig:- cross_val second iteration</figcaption></figure><p id="5ad5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">依此类推，直到最后一次或第六次迭代，看起来会像下图这样。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/0e0f9b2a7701fc3499ba61ccc3db1353.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*j2fqzW4qFey-rd1FdXILqQ.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Fig:- cross_val sixth iteration</figcaption></figure><p id="061f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.<strong class="jp ir">用<strong class="jp ir"> Matplotlib </strong>可视化</strong>数据。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/110dab10fbf2efa6b627c832b2ba2214.png" data-original-src="https://miro.medium.com/v2/resize:fit:1326/format:webp/1*z6vxTbLwrDIfF_B88k9JGg.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Fig:- Visualize with Matplotlib</figcaption></figure><p id="3fc2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了可视化，我们正在导入<strong class="jp ir"> <em class="kl"> matplotlib </em> </strong>库。然后制作一个<strong class="jp ir"> <em class="kl">支线剧情</em> </strong>。</p><p id="cc56" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">用黑色(即(0，0，0))轮廓或<em class="kl">边缘颜色</em>创建<strong class="jp ir"> <em class="kl">散点</em> </strong>。</p><p id="01bf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用<strong class="jp ir"> <em class="kl"> ax.plot </em> </strong>给出两轴的最小值&amp;最大值，用“<strong class="jp ir"> <em class="kl"> k - </em> </strong>”表示线条的类型与线宽，即<strong class="jp ir"><em class="kl">lw</em></strong><em class="kl"/><strong class="jp ir"><em class="kl">= 4</em></strong>。</p><p id="9345" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，给 x 和 y 轴加标签。</p><p id="eece" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"><em class="kl">【PLT . show()】</em></strong>最后显示图形。</p><h2 id="3a9c" class="md me iq bd mf mg mh dn mi mj mk dp ml jy mm mn mo kc mp mq mr kg ms mt mu mv bi translated">结果呢</h2><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/728be7729e2bf2837da530a3bad214f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1164/format:webp/1*tGIm55wwRHYkQ3WflI-SKA.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Fig:- Prediction</figcaption></figure><p id="827c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此图显示了使用线性回归模型对波士顿数据集进行的 k 重交叉验证。</p></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><p id="d2ce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我确信人们实现了许多类型的交叉验证，但是 K-folds 是一个好的并且容易开始的类型。</p><p id="e8d1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要获得完整代码，请访问 github 链接:<a class="ae lv" href="https://github.com/Sagarsharma4244/Cross-Validation" rel="noopener ugc nofollow" target="_blank"> Github </a></p><p id="eb13" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">关注我在<a class="ae lv" href="https://medium.com/@sagarsharma4244" rel="noopener">媒体</a>获得类似的职位。</p><p id="94cc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我将每周发布 2 篇帖子，所以不要错过<strong class="jp ir">代码</strong>教程。</p><p id="0f5d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<a class="ae lv" href="https://www.facebook.com/profile.php?id=100003188718299" rel="noopener ugc nofollow" target="_blank">脸书</a>、<a class="ae lv" href="https://twitter.com/SagarSharma4244" rel="noopener ugc nofollow" target="_blank">推特</a>、<a class="ae lv" href="https://www.linkedin.com/in/sagar-sharma-232a06148/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>、<a class="ae lv" href="https://plus.google.com/+SAGARSHARMA4244" rel="noopener ugc nofollow" target="_blank"> Google+ </a>上联系我。</p><p id="c737" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">任何评论或者如果你有任何问题，请写在评论里。</p><p id="518c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">鼓掌吧！分享一下！跟我来。</strong></p><p id="1b93" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">乐意帮忙。荣誉……..</p></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><h1 id="93df" class="mx me iq bd mf my mz na mi nb nc nd ml ne nf ng mo nh ni nj mr nk nl nm mu nn bi translated">你会喜欢的以前的故事:</h1><ol class=""><li id="2649" class="lk ll iq jp b jq no ju np jy nq kc nr kg ns kk lp lq lr ls bi translated"><a class="ae lv" href="https://medium.com/towards-data-science/activation-functions-neural-networks-1cbd9f8d91d6" rel="noopener">激活功能解释:神经网络</a></li></ol><p id="2d53" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.<a class="ae lv" href="https://medium.com/towards-data-science/linear-regression-the-easier-way-6f941aa471ea" rel="noopener">线性回归:更简单的方法</a></p><p id="9cc4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.<a class="ae lv" href="https://medium.com/towards-data-science/linear-regression-the-easier-way-6f941aa471ea" rel="noopener"> DIY Arduino 无线键盘</a></p><p id="03e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.<a class="ae lv" href="https://medium.com/@sagarsharma4244/what-the-hell-is-perceptron-626217814f53" rel="noopener">感知器</a>是什么鬼？</p><p id="74cb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">5.<a class="ae lv" href="https://hackernoon.com/what-the-hell-is-tensor-in-tensorflow-e40dbf0253ee" rel="noopener ugc nofollow" target="_blank">Tensor flow 中的“张量”是什么鬼？</a></p></div></div>    
</body>
</html>