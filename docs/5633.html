<html>
<head>
<title>Analytical Solution of Linear Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">线性回归的解析解</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/analytical-solution-of-linear-regression-a0e870b038d5?source=collection_archive---------3-----------------------#2018-10-31">https://towardsdatascience.com/analytical-solution-of-linear-regression-a0e870b038d5?source=collection_archive---------3-----------------------#2018-10-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c9311b94e8c12c341c8cdea07ca422ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2_bC5xof2OHqQktTjPd8xw.jpeg"/></div></div></figure><h1 id="08ff" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">介绍</h1><p id="35c1" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">我们知道像梯度下降这样的优化方法可以用来最小化线性回归的成本函数。但是对于线性回归，存在一个解析解。这意味着我们可以通过使用正确的公式，在一步计算中获得线性回归的变量。在本帖中，我们将探究线性回归及其衍生的解析解。</p><h1 id="d199" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">解析</h1><p id="7940" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">我们首先给出了线性回归的解析解公式。如果你对导数不感兴趣，你可以用这个公式来计算线性回归变量。解决方案是:</p><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/17b31da357d70ceb25e01b3532adcfd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:448/format:webp/1*Vo9FqX79gaoTS9L8bT5-DQ.png"/></div></figure><p id="c4a0" class="pw-post-body-paragraph kw kx iq ky b kz lz lb lc ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt ij bi translated">在这个公式中，所有符号都是矢量化的。如果你不熟悉线性代数或者矢量化，可以参考这篇<a class="ae me" rel="noopener" target="_blank" href="/vectorization-implementation-in-machine-learning-ca652920c55d">博客</a>。在这个公式中，X 是一个 m 乘 n 的矩阵，这意味着我们有 m 个样本和 n 个特征。符号 y 是代表目标标签的 m 乘 1 向量，θ是代表每个特征所需的所有系数的 n 乘 1 向量。</p><h1 id="5b47" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">派生</h1><p id="f6b2" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">我们知道线性回归代价函数的矢量化表达式(更多细节请参考<a class="ae me" rel="noopener" target="_blank" href="/vectorization-implementation-in-machine-learning-ca652920c55d">博客</a>)可以表示为:</p><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/e650a2252fa8fccc4bece61745a65e8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*2ndbCb0yR2utvVfqXkY19A.png"/></div></figure><p id="e8f4" class="pw-post-body-paragraph kw kx iq ky b kz lz lb lc ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt ij bi translated">由于 1/(2*m)是一个常数，当我们最小化一个函数时，将成本函数乘以或除以一个非零常数不会影响最小化结果，因此在这种情况下，我们忽略这个常数项。为方便起见，我们的成本函数变为:</p><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/9ca0bb5d4b7c119f738df9a6e92c2659.png" data-original-src="https://miro.medium.com/v2/resize:fit:606/format:webp/1*Mr4-4eKulLI9vM5Ecd0iSg.png"/></div></figure><p id="749c" class="pw-post-body-paragraph kw kx iq ky b kz lz lb lc ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt ij bi translated">这可以进一步简化为:</p><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/a409a20cf84581d518d0d587cca1adea.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*chIUcEG0srcfRlYGXMVpiQ.png"/></div></figure><p id="3bf8" class="pw-post-body-paragraph kw kx iq ky b kz lz lb lc ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt ij bi translated">我们将其扩展为:</p><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/f6f66d845996386497a34d393674429b.png" data-original-src="https://miro.medium.com/v2/resize:fit:962/format:webp/1*66nve1ZwWxSIVymMT1wZvA.png"/></div></figure><p id="d935" class="pw-post-body-paragraph kw kx iq ky b kz lz lb lc ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt ij bi translated">现在第二学期需要一些转变。我们知道 X 是一个 m 乘 n 矩阵，θ是 n 乘 1 矩阵，因此 Xθ的维数为 m 乘 1，其转置矩阵的维数为 1 乘 m，由于 y 是 m 乘 1，因此第二项的维数为 1。换句话说，第二项是标量。我们知道标量的转置等于其自身，因此我们取第二项的转置得到:</p><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/19331a79cc2021ed2b192ff82ca8e49e.png" data-original-src="https://miro.medium.com/v2/resize:fit:506/format:webp/1*7_ZopFsnZO5dkRn-hHaEUw.png"/></div></figure><p id="fe84" class="pw-post-body-paragraph kw kx iq ky b kz lz lb lc ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt ij bi translated">我们将 is 代入成本函数，得到:</p><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/7f72d10eb1745e1818a80ab9860942bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*qac_xh6jx1HmWJ2515Y2xQ.png"/></div></figure><p id="ed02" class="pw-post-body-paragraph kw kx iq ky b kz lz lb lc ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt ij bi translated">此外，我们可以把它写成:</p><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/2202d6ff730ab63d075a1b50baf116c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:738/format:webp/1*u9im7u8at_L6fVSLtFZQWw.png"/></div></figure><p id="c6d4" class="pw-post-body-paragraph kw kx iq ky b kz lz lb lc ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt ij bi translated">现在我们需要对成本函数求导。为方便起见，列出了常见的矩阵导数公式作为参考:</p><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/9c62c1d1134a362ba49f58a229451af0.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/format:webp/1*7hxeySiRxs_WKKd3rTVpMA.png"/></div></figure><p id="c781" class="pw-post-body-paragraph kw kx iq ky b kz lz lb lc ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt ij bi translated">使用上述公式，我们可以推导出关于θ的成本函数:</p><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/dec174aa48fcfbbf7f6425ddfebe0cdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1134/format:webp/1*FZs8YC2hvnczvlw_DrHY9A.png"/></div></figure><p id="03db" class="pw-post-body-paragraph kw kx iq ky b kz lz lb lc ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt ij bi translated">为了求解变量，我们需要使上面的推导等于零，即:</p><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/6c5e470878159a82a507bb86128a0771.png" data-original-src="https://miro.medium.com/v2/resize:fit:492/format:webp/1*W2U82wOCzUqhD92fbWODKw.png"/></div></figure><p id="fa6c" class="pw-post-body-paragraph kw kx iq ky b kz lz lb lc ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt ij bi translated">我们可以将其简化为:</p><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/573dd48ecd2478b2dec2a0e2a0869b2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:378/format:webp/1*9ZU3rkLIt2zcWkkYWkDlIA.png"/></div></figure><p id="5d63" class="pw-post-body-paragraph kw kx iq ky b kz lz lb lc ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt ij bi translated">因此，我们可以将θ计算为:</p><figure class="lv lw lx ly gt jr gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/d4a61460e2d2d93c0ae09c334fcae97f.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/format:webp/1*pD0YHCgCufqFQJXC_g9MCQ.png"/></div></figure><h1 id="d644" class="jy jz iq bd ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv bi translated">结论</h1><p id="a0ec" class="pw-post-body-paragraph kw kx iq ky b kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">在这篇博客中，我们给出了求解线性回归变量的解析解。我们详细介绍了如何从成本函数的推导中得出这个结果的步骤。</p></div></div>    
</body>
</html>