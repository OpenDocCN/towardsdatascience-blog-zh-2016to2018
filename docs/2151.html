<html>
<head>
<title>Neural Networks with Google CoLaboratory | Machine Learning Getting started</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">谷歌协作的神经网络|机器学习入门</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/neural-networks-with-google-colaboratory-artificial-intelligence-getting-started-713b5eb07f14?source=collection_archive---------0-----------------------#2017-12-25">https://towardsdatascience.com/neural-networks-with-google-colaboratory-artificial-intelligence-getting-started-713b5eb07f14?source=collection_archive---------0-----------------------#2017-12-25</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/00aa300060ba9a4d3d5c5e406cd73d5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9BXU3tLs2KPdlr5XuL7ofw.png"/></div></div></figure><p id="d0b5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">谷歌最近推出了内部工具，用于协作编写数据科学代码。这个名为Google co laboratory(<a class="ae kz" href="http://g.co/colab" rel="noopener ugc nofollow" target="_blank">g.co/colab</a>)的项目基于Jupyter开源项目，并与Google Drive集成在一起。Colaboratory允许用户在Jupyter笔记本上工作，就像在Google Docs或电子表格上工作一样简单。</p><h1 id="06c1" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">合作实验室</h1><p id="114c" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">首先，您可以访问<a class="ae kz" href="http://g.co/colab" rel="noopener ugc nofollow" target="_blank">联合实验室网站</a>，并注册以收到使用该工具的邀请。确认邮件通常需要一天时间才会进入你的收件箱。CoLaboratory让你使用谷歌的一个虚拟机来执行你的机器学习任务和制作模型，而不用担心你的计算能力的限制。而且是免费的。</p><p id="51d0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当你第一次打开colaboratory时，你会看到一个<em class="md"> Hello，Colaboratory </em>文件，其中包含一些你可以用它做的事情的基本示例。我建议你尝尝它们。</p><p id="43ce" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">使用colaboratory，您可以像在Jupyter笔记本上一样编写代码。您编写并执行(Shift + Enter)代码单元格，并在单元格下获得您的输出。</p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi me"><img src="../Images/90e2647fb451fdf2f4d980874780618e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VgMgTj0JgxMLLjUHyImwAg.png"/></div></div></figure><p id="bb97" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">除了写代码之外，这个程序还有几个锦囊妙计。您可以编写以“！”开头的shell命令在笔记本里。<br/>例如，<code class="fe mj mk ml mm b">!pip install -q keras</code>。<br/>这让你对谷歌允许你使用的虚拟机有相当大的控制权。这些代码片段可以通过点击左上角的小黑按钮(在菜单下)找到。</p><p id="a3cc" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我写这篇文章的目的是演示如何使用协同实验室来训练神经网络。我们将通过一个例子，在这个例子中，我们在由<a class="ae kz" href="http://archive.ics.uci.edu/ml/datasets" rel="noopener ugc nofollow" target="_blank"> UCI机器学习库</a>提供的乳腺癌威斯康星州数据集上训练一个神经网络。这里的练习相当简单。</p><p id="3814" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这里是我为这篇文章制作的<a class="ae kz" href="https://colab.research.google.com/notebook#fileId=1aQGl_sH4TVehK8PDBRspwI4pD16xIR0r" rel="noopener ugc nofollow" target="_blank">协作笔记本</a>的链接。</p><h1 id="ed74" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">深度学习</h1><p id="1f98" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated">深度学习是一种机器学习技术，它使用的计算技术在某种程度上模拟了生物神经元的工作。分层排列的神经元网络从输入到输出来回传递信息，直到它调整其权重，以生成特征和目标之间潜在关系的算法。</p><p id="1fc2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">要了解更多关于神经网络的知识，你可以参考卡洛斯·格雷申森的这篇非常简单的<a class="ae kz" href="https://arxiv.org/pdf/cs/0308031.pdf" rel="noopener ugc nofollow" target="_blank">论文。你也可以在medium上找到在线资源。</a></p><p id="7e71" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">对于那些还不了解神经网络的人，不要担心。这里的想法是一毫米一毫米地进步。继续…</p><h1 id="fbb7" class="la lb it bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">密码</h1><p id="c335" class="pw-post-body-paragraph kb kc it kd b ke ly kg kh ki lz kk kl km ma ko kp kq mb ks kt ku mc kw kx ky im bi translated"><strong class="kd iu">问题:<br/> </strong>研究人员获得了乳腺肿块的细针抽吸(FNA)并生成了它的数字化图像。数据集包含描述这些图像中细胞核特征的实例。每个实例都标有两种诊断中的一种:“M”(恶性)或“良性”)。鉴于上述特征，我们的任务是根据这些数据训练一个神经网络来诊断乳腺癌。</p><p id="3e58" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">当您打开colaboratory时，会看到一个新的untitled.ipynb文件供您使用。</p><p id="b427" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">Google允许你在他们的服务器上使用一个虚拟的linux机器，这样你就可以访问终端来为你的项目安装特定的包。如果您只是在一个代码单元中传递一个<code class="fe mj mk ml mm b">!ls</code>命令(记住在任何命令之前加上！)，你会在你的机器里得到一个名为<code class="fe mj mk ml mm b">datalab</code>的文件夹。</p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mn"><img src="../Images/d0b8f412ec4855d947e860e738898a01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*czr1UOQdd-TMvP_G8R_44g.png"/></div></div></figure><p id="48f2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们的任务是将我们的数据集放到这台机器上，以便我们的笔记本可以访问它。你可以用..</p><figure class="mf mg mh mi gt ju"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="8184" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">一旦你的文件在机器上，你可以检查文件是否在那里。<br/> <code class="fe mj mk ml mm b">!ls</code> <br/>你应该看到一个<code class="fe mj mk ml mm b">datalab</code>目录和你的文件列表中的“<code class="fe mj mk ml mm b">breast_cancer_data.csv</code>”。</p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mq"><img src="../Images/4440878ed735f52f00b1bdc0937e0660.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PVG_Ok9ukgokwco15IBm0g.png"/></div></div></figure><p id="8ea3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">数据预处理:</strong></p><p id="a7b1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在我们的数据已经在我们的机器上了，让我们使用pandas将它导入到项目中。</p><figure class="mf mg mh mi gt ju"><div class="bz fp l di"><div class="mo mp l"/></div></figure><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mr"><img src="../Images/303a2f857a1a74303b3fbd58584cb967.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OGRDI_yO8VlJVT6T89eELA.png"/></div></div><figcaption class="ms mt gj gh gi mu mv bd b be z dk">This is how the Output looks on Colaboratory</figcaption></figure><p id="f507" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在，分离因变量和自变量。</p><figure class="mf mg mh mi gt ju"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="db07" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">y由一个列组成，列中的“M”和“B”分别代表“是”(恶性)和“否”(良性)。这些需要被编码成数学上相关的形式，即‘1’和‘0’。这可以通过标签编码器类来完成。</p><figure class="mf mg mh mi gt ju"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="f205" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">(当您遇到两类以上的数据时，请使用OneHotEncoder)</p><p id="97ad" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在我们的数据已经准备好了，让我们把它分成训练集和测试集。我们使用Scikit-Learn中的<code class="fe mj mk ml mm b">train_test_split</code>类，这使得工作变得非常容易。</p><figure class="mf mg mh mi gt ju"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="bde6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">参数<code class="fe mj mk ml mm b">test_size = 0.2</code>定义了测试集比例。这里，80%的训练和20%的测试集。继续前进。</p><p id="dfe2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">Keras<br/></strong><em class="md">Keras</em>是用于构建人工神经网络的高级API。它使用<em class="md"> Tensorflow </em>或<em class="md">the no</em>后端进行其幕后操作。要安装Keras，您必须在计算机上安装Tensorflow。联合实验室已经在虚拟机上安装了Tensorflow。如果你想检查你可以使用的安装</p><p id="49c1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><code class="fe mj mk ml mm b">!pip show tensorflow</code></p><p id="293b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">查看您使用的tensorflow版本。如果需要，您还可以使用<code class="fe mj mk ml mm b">!pip install tensorflow==1.2</code>安装Tensorflow的特定版本</p><p id="0b1d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">或者，如果你喜欢使用Theano后端，你可以在这里阅读文档<a class="ae kz" href="https://keras.io/backend/" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="560c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">安装Keras:<br/>T2】</p><figure class="mf mg mh mi gt ju"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="5bed" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">顺序类和密集类用于指定神经网络的节点、连接和规格。正如上一节所看到的，我们将需要这些来定制我们的学习网络的参数并对它们进行调整。</p><p id="5b04" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为了初始化神经网络，我们将创建一个<code class="fe mj mk ml mm b">Sequential</code>类的对象。</p><figure class="mf mg mh mi gt ju"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="d181" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在我们需要设计网络。</p><p id="bee3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">对于每个隐藏层，我们需要定义三个基本参数— <code class="fe mj mk ml mm b">units</code>、<code class="fe mj mk ml mm b">kernel_initializer</code>和<code class="fe mj mk ml mm b">activation</code>。<code class="fe mj mk ml mm b">units</code>参数定义了该层将包含的神经元数量。<code class="fe mj mk ml mm b">Kernel_initializer</code>定义神经元将对数据输入进行操作的初始权重(更多信息请参见<a class="ae kz" href="https://faroit.github.io/keras-docs/1.2.2/initializations/" rel="noopener ugc nofollow" target="_blank"/>)。而<code class="fe mj mk ml mm b">activation</code>定义了我们选择用于数据的激活函数。<br/>注意:如果这些术语现在让人不知所措，也没关系。随着时间的推移，它们会变得更加清晰。</p><p id="160f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">第一层:</p><p id="00b5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">对于第一层，我们放置16个神经元，这些神经元具有由ReLU激活函数激活的一致初始化的权重。此外，我们将参数<code class="fe mj mk ml mm b">input_dim = 30</code>定义为输入层的规范。请注意，我们的数据集中有30个要素列。</p><p id="8f41" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">作弊:<br/>我们是如何决定层中单位的数量的？人们会告诉你这是一门艺术，需要经验和专业知识。对于初学者来说，一个简单的方法是将X和y中的列总数相加，然后除以2。(30+1)/2 = 15.5 ~ 16.于是，<code class="fe mj mk ml mm b">units = 16</code>。</p><p id="4fef" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">第二层:第二层与第一层相同，但没有input_dim参数。</p><p id="4d1d" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">输出层:由于我们的输出是两个值中的任何一个，我们可以使用一个具有统一初始化权重的单元。然而，这里我们使用sigmoid激活函数(关于激活函数的单独文章即将推出)。</p><figure class="mf mg mh mi gt ju"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="05e3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">拟合:<br/>运行人工神经网络，让backprop魔法发生。你应该在合作实验室而不是你自己的机器上看到所有这些加工过程。</p><figure class="mf mg mh mi gt ju"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="decc" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这里，<code class="fe mj mk ml mm b">batch_size</code>是您希望同时处理的输入数量。而<code class="fe mj mk ml mm b">epoch</code>是你所有的数据通过神经网络一次的整个周期。它是这样出现在合作笔记本上的:</p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mw"><img src="../Images/0fee3b487a7f139cf8c6b07878f4d630.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OXfikjBRn04DLkdhabCDlg.png"/></div></div></figure><p id="8c35" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">做出预测和混淆矩阵。</p><figure class="mf mg mh mi gt ju"><div class="bz fp l di"><div class="mo mp l"/></div></figure><p id="be37" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">一旦您训练了您的网络，您就可以在X_test集合(我们之前放在一边)上进行预测，以检查您的模型在新数据上的表现如何。在单元格中键入并执行<code class="fe mj mk ml mm b">cm</code>来查看它。</p><p id="97ce" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">混淆矩阵</strong> <br/>混淆矩阵，顾名思义，显示了你的模型做出的正确和错误预测的矩阵表示。当您需要单独调查哪些预测与其他预测相混淆时，该矩阵非常方便。这是一个2×2的困惑，马迪克斯解释道。</p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/11ee7b900adf4000cd5a669b48bd6667.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*Z4ZHPwVnU4aBYI25au34jg.png"/></div></figure><p id="fb17" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这就是我们的困惑矩阵的样子。[ <code class="fe mj mk ml mm b">cm</code> (Shift+Enter)]</p><figure class="mf mg mh mi gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi my"><img src="../Images/7e686a7b79c58947e9ee97f692ed4dd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*S4jgV_kI74qM8gfC3PLBfw.png"/></div></div></figure><p id="208b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这是怎么读的:<em class="md"> 70真阴性，</em> <strong class="kd iu"> 1假阳性，1假阴性</strong>，<em class="md"> 42真阳性</em>。很简单。当分类类别的等级增加时，方阵的大小增加。</p><p id="342f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">就像这个例子一样，我们有几乎100%的准确率。只有两个错误的预测。这一点也不坏。但情况可能并不总是如此。其他时候，你可能需要投入更多的时间，调查你的模型的行为，并提出更好、更复杂的解决方案。如果网络表现不佳，可以进行超参数调整来改进模型。我将很快就这个话题写一整篇文章。</p><p id="6450" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我希望这能帮助您开始使用Colaboratory。<a class="ae kz" href="https://colab.research.google.com/notebook#fileId=1aQGl_sH4TVehK8PDBRspwI4pD16xIR0r" rel="noopener ugc nofollow" target="_blank">在此找到本教程的笔记本。</a></p><p id="c9b7" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><em class="md">注:本文重点介绍</em> <strong class="kd iu"> <em class="md">协同</em> </strong> <em class="md">的使用，并举例说明。对于一些读者可能没有理解清楚的概念的详细解释，我表示歉意，并请求您等待更多的文章。</em></p></div></div>    
</body>
</html>