<html>
<head>
<title>Only Numpy: Vanilla Recurrent Neural Network Deriving Back propagation Through Time Practice — part 1/2</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Only Numpy:通过时间实践推导反向传播的普通递归神经网络—第1/2部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/only-numpy-vanilla-recurrent-neural-network-back-propagation-practice-math-956fbea32704?source=collection_archive---------3-----------------------#2017-12-22">https://towardsdatascience.com/only-numpy-vanilla-recurrent-neural-network-back-propagation-practice-math-956fbea32704?source=collection_archive---------3-----------------------#2017-12-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="cf5e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我在Medium发表的第一篇正式的教育文章，我不得不说Medium是一个非常棒的博客平台。不管怎样，我们开始吧。问题很简单，我们将使用RNN来计算给定数据中有多少个1。如果你只是想要视频教程和代码，请点击下面的链接。</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="kq kr l"/></div></figure><p id="0bbe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Github链接:<a class="ae ks" href="https://github.com/JaeDukSeo/Only_Numpy_Basic/blob/master/rnn/a_rnn_simple.py" rel="noopener ugc nofollow" target="_blank">https://github . com/JaeDukSeo/Only _ Numpy _ Basic/blob/master/rnn/a _ rnn _ simple . py</a></p></div><div class="ab cl kt ku hu kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ij ik il im in"><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi la"><img src="../Images/2e92e938b83c08f2d4978c8c74392378.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pi_aesW5MPFf7vsVTg3GvA.jpeg"/></div></div></figure><p id="1472" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如上文(a)所示，训练数据是X，测试数据是Y(地面实况)。(b)我们将只有两个权重，Wx(其中我们将乘以输入x)和Wrec(其中我们将乘以先前的状态)</p><p id="aacb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">理解(c)非常重要，因为我们的网络架构是我们网络架构的展开版本。然而，它清楚地显示了状态0(表示为S0)与状态1(表示为S1)具有某种关系。那关系如下图！</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi la"><img src="../Images/5551ea041c60104642837f38153588a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*W_UHqjQ5NCGXB99ZnatAjA.jpeg"/></div></div></figure><p id="1088" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在(E)下，我们可以看到一个等式，它阐明了状态之间的关系。</p><p id="9476" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当前状态K =先前状态K * Wrec +当前输入X * Wx</p><p id="52b9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这条数学线是状态0和状态1之间的关系。但是每个州下面的数字呢？很简单，这些是每个状态的输入，所以在状态1，输入x是一个向量[0，0，1]。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi la"><img src="../Images/defff2d5414a44849621e1adf9f1485e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZKeQFVEryAYY2WZA4A5OFw.jpeg"/></div></div><figcaption class="lh li gj gh gi lj lk bd b be z dk">Same Color Box indicate inputs at each state</figcaption></figure><p id="166c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可能会问，<strong class="jp ir">状态0呢？</strong>大问题他们<strong class="jp ir">全是零！</strong></p></div><div class="ab cl kt ku hu kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ij ik il im in"><p id="511b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以让我们用数学来弄脏——前馈。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi ll"><img src="../Images/31adf4d7c6cb21ff88500ef4b51aba13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bQulxubkw7CENLFftJ5NhA.jpeg"/></div></div></figure><p id="8dca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就是这样！我们完成了前馈传播。另外，还有一点需要注意的是，我们将使用MSE作为成本函数，从现在开始，我们将只使用星号旁边的符号来表示成本函数。(抱歉我不是数学专业的，我不知道那个符号叫什么。)</p></div><div class="ab cl kt ku hu kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ij ik il im in"><p id="a73b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们通过时间执行反向传播。我们必须对每个状态的Wx和Wrec求导。而这正是我们下面所做的！</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi ll"><img src="../Images/0e6cde9e8d72b795e38de41ea731dc82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gpVroHTOUUqbJ8ZOa7R8Fw.jpeg"/></div></div></figure><p id="28b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">原来如此！训练RNN背后的简单数学。但是，尽量自己填状态1。但是有一个有趣的事实需要注意，当得到Wx和Wrec的导数时，有很多数学符号会随着时间的推移而重复出现，请看下图。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi ll"><img src="../Images/d6b3bf2e546afb44508b3b8798a31c08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YajZI_nnTJnlreml-jgYJQ.jpeg"/></div></div></figure><p id="cef2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在矩阵中得到那些重复的值，并在以后通过乘以适当的X或State来使用它们，这在计算上会更有效。这正是我在视频教程中所做的！</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi lm"><img src="../Images/5abb359f3fd5a9eb3328e43292e12ea6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CnusFcXUCL6JokOV0DzVDA.png"/></div></div><figcaption class="lh li gj gh gi lj lk bd b be z dk">Calculate the repeating terms</figcaption></figure><p id="c3e6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">另一个需要注意的重要事情是，当我们得到导数时，我们要乘以Wrec的倍数，换句话说，变量起着关键作用！(我不打算进一步解释，但这个话题很重要！)</p><p id="3f36" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，让我们通过随机梯度下降来执行权重更新。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="lb lc di ld bf le"><div class="gh gi la"><img src="../Images/cd9078348d6d91419d36ce4608a2fa62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*19Ac-HS6vU9DCP5clIpwag.jpeg"/></div></div></figure><p id="4049" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在右上角，我们相应地将各项相加，并执行SGD。</p><p id="549b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">更新！下面是第二部分:</strong> <a class="ae ks" href="http://Only Numpy: Vanilla Recurrent Neural Network Deriving Back propagation Through Time Practice — part 1/2" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">链接</strong> </a></p><p id="545a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后提醒一下，我用了很多彼得的素材！请点击下面的链接查看这个令人惊奇的教程！这是我的第一篇帖子，我仍在学习如何制作优秀的教程，任何反馈都将是有益的！<br/>【请客气:’(]谢谢！</p><div class="ln lo gp gr lp lq"><a href="http://peterroelants.github.io/posts/rnn_implementation_part01/#Updating-the-parameters" rel="noopener  ugc nofollow" target="_blank"><div class="lr ab fo"><div class="ls ab lt cl cj lu"><h2 class="bd ir gy z fp lv fr fs lw fu fw ip bi translated">彼得的笔记</h2><div class="lx l"><h3 class="bd b gy z fp lv fr fs lw fu fw dk translated">关于人工智能、机器学习、神经网络的笔记和代码样本</h3></div><div class="ly l"><p class="bd b dl z fp lv fr fs lw fu fw dk translated">peterroelants.github.io</p></div></div><div class="lz l"><div class="ma l mb mc md lz me lf lq"/></div></div></a></div><p id="84fc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">更多教程请查看我的网站和我的Youtube频道！</p><p id="458c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">网址:<a class="ae ks" href="https://jaedukseo.me/" rel="noopener ugc nofollow" target="_blank">https://jaedukseo.me/</a></p><p id="1c4e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">YouTube频道:<a class="ae ks" href="https://www.youtube.com/c/JaeDukSeo" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/c/JaeDukSeo</a></p><div class="ln lo gp gr lp lq"><a href="https://jaedukseo.me/" rel="noopener  ugc nofollow" target="_blank"><div class="lr ab fo"><div class="ls ab lt cl cj lu"><h2 class="bd ir gy z fp lv fr fs lw fu fw ip bi translated">宰德徐- DJ徐</h2><div class="lx l"><h3 class="bd b gy z fp lv fr fs lw fu fw dk translated">嗨，我叫Jae，我爱机器学习，请进来看看吧！数据科学家Jae的个人网站…</h3></div><div class="ly l"><p class="bd b dl z fp lv fr fs lw fu fw dk translated">jaedukseo.me</p></div></div></div></a></div><div class="ln lo gp gr lp lq"><a href="https://www.youtube.com/channel/UCf5jue1EwgWrYw9bjTynV4g/featured?view_as=subscriber" rel="noopener  ugc nofollow" target="_blank"><div class="lr ab fo"><div class="ls ab lt cl cj lu"><h2 class="bd ir gy z fp lv fr fs lw fu fw ip bi translated">宰德徐</h2><div class="lx l"><h3 class="bd b gy z fp lv fr fs lw fu fw dk translated">你好！我叫Jae，这是我的youtube频道。我喜欢狗和人工智能，医疗保健和区块链…</h3></div><div class="ly l"><p class="bd b dl z fp lv fr fs lw fu fw dk translated">www.youtube.com</p></div></div></div></a></div></div></div>    
</body>
</html>