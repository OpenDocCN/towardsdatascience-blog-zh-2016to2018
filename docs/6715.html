<html>
<head>
<title>How neuroscientists analyze data from transparent fish brains : part 1, pre-processing.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">神经科学家如何分析来自透明鱼脑的数据:第 1 部分，预处理。</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-neuroscientists-analyze-data-from-transparent-fish-brains-part-1-pre-processing-63a09436ea93?source=collection_archive---------20-----------------------#2018-12-27">https://towardsdatascience.com/how-neuroscientists-analyze-data-from-transparent-fish-brains-part-1-pre-processing-63a09436ea93?source=collection_archive---------20-----------------------#2018-12-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a660" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">从鱼脑的视频到可利用的数据集。</h2></div><p id="14f6" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">大脑很酷。不仅仅是人脑。在神经科学中，许多动物模型被用来研究大脑回路:小鼠、大鼠、苍蝇、蠕虫和我最喜欢的一种——鱼。但不仅仅是任何鱼:T2 斑马鱼。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi ld"><img src="../Images/b55f5a54e31cc95ef3a6912d534fed71.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/format:webp/0*_-ivCO00CZ02Tceb.jpg"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk">An adult zebrafish (wikipedia)</figcaption></figure><p id="61c9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">斑马鱼最初来自南亚，现在可以在任何普通的水族馆和商店里找到。它们很小，有漂亮的条纹，喜欢温暖的水。但是让科学家们感兴趣的是，一些斑马鱼发生了突变，阻止它们产生黑色色素，因此它们拥有完全透明的皮肤<strong class="kh ir"/>。如果想研究大脑，这是一个很好的特性。不需要打开头骨，不需要切开任何东西，只需要把一条鱼放在显微镜下，你就可以研究它的大脑。或者……差不多。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi ld"><img src="../Images/b6c368f02c99fb51f65443bfdfb081cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:440/format:webp/0*UHJNV1cI4LLaGLfI.png"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk">Below, a transparent zebrafish (wikipedia)</figcaption></figure><p id="5b3e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">斑马鱼真的很棒，因为它们的基因组是已知的，科学家能够精确地产生一些突变，使鱼的神经元在活跃时发出荧光(所有这些都不会影响大脑的功能或斑马鱼的健康！).你可以想象这背后的大量工作和研究，但这是一个数据科学博客，所以我现在将专注于这种数据的分析。</p></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><p id="7b49" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是原始数据的样子:这是一个斑马鱼大脑的视频，每一个圆形的白色斑块都是一个变得活跃的神经元。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/ead70daade482e985904bfb16c41b72c.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/1*RT4lKWUliy8UpVC_5PT4zA.gif"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk">Courtesy of <a class="ae lc" href="https://yaksilab.com/" rel="noopener ugc nofollow" target="_blank">Yaksi lab</a> <strong class="bd lx">©</strong>, NTNU in Trondheim, Norway</figcaption></figure><p id="9430" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">已经很酷了！然而，在能够使用一些机器学习算法(如 PCA 或聚类)之前，我们需要将该视频转换为可利用的数据集，即[神经元 x 时间]的 2D 矩阵，其中每个元素都是特定神经元在特定时间点的活动程度。“预处理”管道有 3 个主要步骤:</p><ol class=""><li id="373a" class="ly lz iq kh b ki kj kl km ko ma ks mb kw mc la md me mf mg bi translated">对齐</li><li id="8c77" class="ly lz iq kh b ki mh kl mi ko mj ks mk kw ml la md me mf mg bi translated">细胞检测</li><li id="6510" class="ly lz iq kh b ki mh kl mi ko mj ks mk kw ml la md me mf mg bi translated">荧光提取</li></ol><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gh gi mm"><img src="../Images/9e23d6e6d4bbdcbbb4e8a5fb7f1122e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*397Zotaji-TvwWMT6jiEgQ.png"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk">The preprocessing pipeline that extracts the activity of each neuron in time, from the raw images.</figcaption></figure></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><p id="b5b4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第一步是<strong class="kh ir">对准</strong>。在实验过程中，鱼是活着的，可以自由移动尾巴(只有头部和腹部被一些琼脂糖凝胶保持不动)。这可能会导致录制过程中的一些运动，因此，图像可能会轻微平移或旋转。因此，图像必须重新对齐，以适合用户选择的一个“参考”图像的方向。这是<strong class="kh ir">图像配准</strong>的过程。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/86fed1381c3097fa5875d713f446b295.png" data-original-src="https://miro.medium.com/v2/resize:fit:1172/format:webp/0*z4aQlWguk8BL-D3K.jpg"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk">An illustration of image registration with <a class="ae lc" href="https://fr.mathworks.com/help/images/register-an-aerial-photograph-to-a-digital-orthophoto.html" rel="noopener ugc nofollow" target="_blank">Matlab</a></figcaption></figure><p id="0b58" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这可以通过多种方式完成，例如(除其他方式外)使用<a class="ae lc" href="https://fr.mathworks.com/discovery/image-registration.html" rel="noopener ugc nofollow" target="_blank"> Matlab </a>或使用开源图像处理软件<a class="ae lc" href="https://imagej.net/Register_Virtual_Stack_Slices" rel="noopener ugc nofollow" target="_blank"> ImageJ / Fiji </a>。为了保持这篇文章(相对)简短，我将不详细说明这一步，而是将重点放在细胞检测。</p></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><p id="6879" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一旦运动伪影被校正，第二步检测神经元在图像中的位置。同样，神经科学家目前正在使用或开发许多不同的方法，但我想在这里介绍的方法使用<strong class="kh ir">模板匹配</strong>。基本上，用户可以创建一个细胞应该是什么样子的模板，算法将在整个图像中寻找这个特定的形状。</p><p id="cec9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，在<em class="lb">参考图像</em>中对对应于期望时间段的所有记录图像进行平均。然后，通过高斯滤波器对该图像进行平滑，以统一背景并调整所有细胞的对比度。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gh gi ms"><img src="../Images/8d3e2459fe7bd48d233eab081e9e77d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tF5Xk2jVUy7E9BGKjnF7Pg.png"/></div></div></figure><p id="45fd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这可以通过使用高斯滤波器(或<a class="ae lc" href="https://en.wikipedia.org/wiki/Kernel_(image_processing)#Convolution" rel="noopener ugc nofollow" target="_blank"> <em class="lb">内核</em> </a>)的 2D 卷积来完成。每个像素的值将被原始图像和高斯核之间的卷积所取代。这在下面的示意图中有很好的描述:</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/ffbcdb7f5c3797bf72432c90a83b9483.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/0*yAvmLEk7Ygu2zH1e.jpg"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk">From <a class="ae lc" href="https://developer.apple.com/library/archive/documentation/Performance/Conceptual/vImage/ConvolutionOperations/ConvolutionOperations.html" rel="noopener ugc nofollow" target="_blank">developer.apple.com</a></figcaption></figure><p id="1e01" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">其次，生成细胞的模板。用户可以选择模板的形状和大小(取决于你正在研究的大脑区域，神经元可以更小或更大)。然后，该模板将在<em class="lb">参考图像</em>上传递，并且——对于每个图像块——将使用该模板计算相关性。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/958dd1349c9dec772fc3992efaad80a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:160/format:webp/1*8txpj1EV21bQEeL9wq68bg.png"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk">A cell-like donut template</figcaption></figure><p id="16fc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">相关性</strong>值表示模板与图像部分的匹配程度。结果将由一个<em class="lb"> correlationMap </em>组成，其中颜色代表模板与以像素为中心的区域的匹配程度。基于相关值的直方图，用户可以选择一个阈值来仅选择具有高相关性的像素(在本例中为 0.5)。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gh gi mv"><img src="../Images/3dfde7ff6457978562ebf315ee995c18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ABL3u9hXwa5U0DJHeuWOBg.png"/></div></div></figure><p id="d4f0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于选定的像素只是我们神经元的中心，所以需要一个膨胀步骤来在其周围添加更多的像素。此后，所有像素被认为属于一个神经元:它们可以被标记(例如用 Matlab 函数<a class="ae lc" href="https://fr.mathworks.com/help/images/ref/bwlabel.html" rel="noopener ugc nofollow" target="_blank"> <em class="lb"> bwlabel </em> </a>)，这意味着它们被赋予一个新的数字，代表它们所属的神经元的身份。该结果随后显示给用户，用户可以手动消除任何检测错误。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/27d5d8dbd693481ba92f8678852f73d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:542/format:webp/1*wusAMUVKh2CGHCjsXrYCBA.png"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk">neuronLabels</figcaption></figure><p id="7dfd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于不同尺寸和形状的不同模板，可以重复这个过程。最终的输出是原始图像大小的一个“遮罩”:如果每个像素不属于一个神经元，它就会被标记为 0，或者是一个介于 1、2、3 之间的数字。550，如果它属于一(550 是在这个特定例子中发现的神经元的数量)。这用于最后一步:提取每个神经元在一段时间内的荧光值。</p></div><div class="ab cl lp lq hu lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ij ik il im in"><p id="4d36" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了及时提取每个神经元的荧光水平，将掩模应用于图像，并且对属于组成神经元的像素的所有值进行平均。这为每个神经元创建了一个向量，显示其在时间上的活动:</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/f819d39eb4d1d6efa4ab19a9f10ba0e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*Bsy874oe8obT8aq84BOU7Q.png"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk">Activity profiles of 5 neurons during 20min</figcaption></figure><p id="ddfb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是当你有 550 个神经元的时候，不可能一个个去看。同时查看几个神经元的更有效的方法是绘制活动图(x 轴:时间，y 轴:神经元标签，颜色:活动):</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gh gi my"><img src="../Images/ea11ad55b17ad73de249725ba6a60e18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7G-r7zTx606MljdZjW5vBg.png"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk">Activity map</figcaption></figure><p id="623e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这样，预处理就完成了。现在，有趣的事情可以开始了，这将是第二篇文章的目标，我们将看看一些聚类算法和 PCA:神经科学家如何分析来自透明鱼脑的数据:第二部分，聚类神经数据。</p></div></div>    
</body>
</html>