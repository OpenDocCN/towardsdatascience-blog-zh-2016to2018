<html>
<head>
<title>Probability calibration for boosted trees</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">增强树的概率校准</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/probability-calibration-for-boosted-trees-24cbd0f0ccae?source=collection_archive---------2-----------------------#2017-07-21">https://towardsdatascience.com/probability-calibration-for-boosted-trees-24cbd0f0ccae?source=collection_archive---------2-----------------------#2017-07-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="aace" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">背景:</strong>概率校准的开创性论文:<a class="ae ko" href="http://www.cs.cornell.edu/~caruana/niculescu.scldbst.crc.rev4.pdf" rel="noopener ugc nofollow" target="_blank">http://www . cs . Cornell . edu/~ caru ana/Niculescu . scldbst . CRC . rev 4 . pdf</a></p><p id="d3d2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">增强决策树通常会产生良好的准确度、精确度和ROC面积。然而，因为来自增强的输出不是很好校准的后验概率，所以增强产生差的平方误差和交叉熵。它倾向于保守地预测概率，意味着更接近于中间值而不是极端值。以下是提升对预测概率的影响:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/fa02e5509c3de441788571b47c8a819a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MrP1-z4kEADoCskA."/></div></div></figure><p id="8780" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae ko" href="https://scikit-learn.org/stable/modules/calibration.html" rel="noopener ugc nofollow" target="_blank">校准良好的分类器是概率分类器，其模型的输出可以直接解释为置信度。例如，校准良好的(二元)分类器应该对样本进行分类，使得在它给出接近0.8的预测值的样本中，大约80%实际上属于正类。</a>下图比较了不同分类器的概率预测的校准情况:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi lb"><img src="../Images/8a9ebe1a059bc52a9c5b32860abfde4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7QnLFgdmh2XjgM6O."/></div></div></figure><p id="c60b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">默认情况下，LogisticRegression返回校准良好的预测，因为它直接优化了对数损失。相反，其他方法返回有偏差的概率；带着不同的偏见。</p><p id="7e17" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">执行概率预测校准的两种方法是:基于Platt的sigmoid模型的参数方法和基于保序回归的非参数方法。应使用不用于模型拟合的测试/验证数据进行概率校准。</p><h2 id="026a" class="lc ld it bd le lf lg dn lh li lj dp lk kb ll lm ln kf lo lp lq kj lr ls lt lu bi translated">普拉特标度:</h2><p id="b379" class="pw-post-body-paragraph jq jr it js b jt lv jv jw jx lw jz ka kb lx kd ke kf ly kh ki kj lz kl km kn im bi translated">普拉特的缩放相当于在分类器输出上训练逻辑回归模型。</p><p id="3df4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您实际上创建了一个新的数据集，它具有相同的标签，但只有一个维度(未校准分类器的概率输出)。然后，在这个新的数据集上进行训练，并将未校准的分类器的概率输出作为这个校准方法的输入，该方法返回一个校准的概率。在Platt的情况下，我们本质上只是对未校准分类器相对于真实类别标签的概率输出执行逻辑回归。</p><p id="b311" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">逻辑回归模型是f(x)= y。y是输入数据的真实标签，x是基本分类器的预测概率。现在，您使用逻辑回归的预测概率作为校准分类器的真实概率。</p><h2 id="cb42" class="lc ld it bd le lf lg dn lh li lj dp lk kb ll lm ln kf lo lp lq kj lr ls lt lu bi translated">保序回归:</h2><p id="f8c5" class="pw-post-body-paragraph jq jr it js b jt lv jv jw jx lw jz ka kb lx kd ke kf ly kh ki kj lz kl km kn im bi translated">其思想是拟合分段常数非减函数，而不是逻辑回归。分段常数非递减意味着阶梯形。通过池相邻违规者算法(PAVA)实现。PAVA是线性排序保序回归的线性时间(和线性记忆)算法。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi ma"><img src="../Images/14e5e078066f9e6c957f436b9e877443.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9DtbKvBHwO1N72oZ."/></div></div></figure><p id="c578" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">训练保序回归的方法是相似的:</p><p id="7514" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">f(x) = y，y是输入数据的真实标签，x是基本分类器的预测概率。等渗模型将通过x(基础分类器的预测概率)对数据进行分类，然后拟合一个阶跃函数来给出真实标签的概率。</p><p id="4ccd" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">其他资源:</p><p id="33a9" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><a class="ae ko" href="http://fastml.com/classifier-calibration-with-platts-scaling-and-isotonic-regression/" rel="noopener ugc nofollow" target="_blank">http://fastml . com/classifier-calibration-with-Platts-scaling-and-isotonic-regression/</a></p><p id="8c0a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">https://jmetzen.github.io/2015-04-14/calibration.html<a class="ae ko" href="https://jmetzen.github.io/2015-04-14/calibration.html" rel="noopener ugc nofollow" target="_blank"/></p><p id="ae04" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">【https://scikit-learn.org/stable/modules/calibration.html T4】</p></div></div>    
</body>
</html>