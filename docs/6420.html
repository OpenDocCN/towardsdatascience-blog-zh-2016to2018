<html>
<head>
<title>Music Genre Classification with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Python 进行音乐流派分类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/music-genre-classification-with-python-c714d032f0d8?source=collection_archive---------1-----------------------#2018-12-13">https://towardsdatascience.com/music-genre-classification-with-python-c714d032f0d8?source=collection_archive---------1-----------------------#2018-12-13</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0b4a" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">Python 中的音频/音乐信号分析指南</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/818a1316a0acba19db5a5608ff17d9de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EfWqZYlS-GfMmqLj"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Photo by <a class="ae ky" href="https://unsplash.com/@dotgrid?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Jean</a> on <a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><blockquote class="kz"><p id="e751" class="la lb it bd lc ld le lf lg lh li lj dk translated">音乐就像一面镜子，它告诉人们你是谁，你关心什么，不管你喜欢与否。我们喜欢说“你就是你流的东西”:Spotify</p></blockquote><p id="e955" class="pw-post-body-paragraph lk ll it lm b ln lo ju lp lq lr jx ls lt lu lv lw lx ly lz ma mb mc md me lj im bi translated">拥有<a class="ae ky" href="https://www.cnbc.com/2018/04/04/spotify-chiefs-net-worth-tops-2-billion-after-nyse-debut.html" rel="noopener ugc nofollow" target="_blank">260 亿美元</a>净资产的 Spotify ，如今统治着<a class="ae ky" href="https://en.wikipedia.org/wiki/Comparison_of_on-demand_streaming_music_services" rel="noopener ugc nofollow" target="_blank">音乐流媒体平台</a>。目前，它的数据库中有数百万首歌曲，并声称拥有适合每个人的音乐配乐。Spotify 的 Discover Weekly 服务在千禧一代中大受欢迎。不用说，Spotify 在研究方面投入了大量资金，以改善用户查找和收听音乐的方式。机器学习是他们研究的核心。从 NLP 到协同过滤再到深度学习，Spotify 都用上了。歌曲基于它们的数字签名被分析一些因素，包括速度、声学、能量、可跳舞性等。来回答第一次约会时那个不可能回答的问题:<strong class="lm iu">你喜欢哪种音乐？</strong></p></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h1 id="9438" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">目标</h1><p id="db2b" class="pw-post-body-paragraph lk ll it lm b ln ne ju lp lq nf jx ls lt ng lv lw lx nh lz ma mb ni md me lj im bi translated"><a class="ae ky" href="http://cs229.stanford.edu/proj2016/report/BurlinCremeLenain-MusicGenreClassification-report.pdf" rel="noopener ugc nofollow" target="_blank">公司</a>如今使用音乐分类，要么是为了能够向他们的客户进行推荐(如 Spotify、Soundcloud)，要么只是作为一种产品(如 Shazam)。确定音乐流派是朝着这个方向迈出的第一步。机器学习技术已被证明在从大型数据池中提取趋势和模式方面相当成功。同样的原理也适用于音乐分析。</p><p id="d089" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated"><em class="no">在本文中，我们将学习如何用 Python 分析音频/音乐信号。然后，我们将利用学到的技能</em> <strong class="lm iu"> <em class="no">将音乐片段分类成不同的流派。</em>T19】</strong></p><h1 id="f019" class="mm mn it bd mo mp np mr ms mt nq mv mw jz nr ka my kc ns kd na kf nt kg nc nd bi translated">使用 Python 进行音频处理</h1><p id="45a9" class="pw-post-body-paragraph lk ll it lm b ln ne ju lp lq nf jx ls lt ng lv lw lx nh lz ma mb ni md me lj im bi translated">声音以一种<strong class="lm iu">音频</strong>信号的形式呈现，该信号具有诸如频率、带宽、分贝等参数。典型的音频信号可以表示为幅度和时间的函数。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi nu"><img src="../Images/447a7e894a24ef7ae4cd4a222ad173ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*akRbhl8739UEDuKHkOUR1Q.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk"><a class="ae ky" href="https://docs.google.com/presentation/d/1zzgNu_HbKL2iPkHS8-qhtDV20QfWt9lC3ZwPVZo8Rw0/pub?start=false&amp;loop=false&amp;delayms=3000&amp;slide=id.g5a7a9806e_0_84" rel="noopener ugc nofollow" target="_blank">source</a></figcaption></figure><p id="e3e9" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated">这些声音有多种格式，使得计算机能够读取和分析它们。一些例子是:</p><ul class=""><li id="8a93" class="nv nw it lm b ln nj lq nk lt nx lx ny mb nz lj oa ob oc od bi translated"><strong class="lm iu"> mp3 格式</strong></li><li id="c199" class="nv nw it lm b ln oe lq of lt og lx oh mb oi lj oa ob oc od bi translated"><strong class="lm iu"> WMA (Windows Media Audio)格式</strong></li><li id="1730" class="nv nw it lm b ln oe lq of lt og lx oh mb oi lj oa ob oc od bi translated"><strong class="lm iu"> wav(波形音频文件)格式</strong></li></ul><h1 id="1a0c" class="mm mn it bd mo mp np mr ms mt nq mv mw jz nr ka my kc ns kd na kf nt kg nc nd bi translated">音频库</h1><p id="e66c" class="pw-post-body-paragraph lk ll it lm b ln ne ju lp lq nf jx ls lt ng lv lw lx nh lz ma mb ni md me lj im bi translated">Python 有一些很棒的<a class="ae ky" href="https://wiki.python.org/moin/Audio/" rel="noopener ugc nofollow" target="_blank">库</a>用于音频处理，比如 Librosa 和 PyAudio。还有一些基本音频功能的内置模块。</p><p id="48b9" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated">我们将主要使用两个库进行音频采集和回放:</p><h2 id="b3e7" class="oj mn it bd mo ok ol dn ms om on dp mw lt oo op my lx oq or na mb os ot nc ou bi translated">1.利布罗萨</h2><p id="8279" class="pw-post-body-paragraph lk ll it lm b ln ne ju lp lq nf jx ls lt ng lv lw lx nh lz ma mb ni md me lj im bi translated">这是一个 Python 模块，用于分析一般的音频信号，但更适合音乐。它包括建立一个 MIR(音乐信息检索)系统的具体细节。它已经被很好地<a class="ae ky" href="https://librosa.github.io/librosa/" rel="noopener ugc nofollow" target="_blank">记录了</a>，还有很多例子和教程。</p><p id="6d6b" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated"><em class="no">关于描述包装设计原理的更高级介绍，请参考</em> <a class="ae ky" href="http://conference.scipy.org/proceedings/scipy2015/pdfs/brian_mcfee.pdf" rel="noopener ugc nofollow" target="_blank"> <em class="no"> librosa 论文</em></a><em class="no">at</em><a class="ae ky" href="http://scipy2015.scipy.org/" rel="noopener ugc nofollow" target="_blank"><em class="no">SciPy 2015</em></a><em class="no">。</em></p><p id="f04b" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated"><strong class="lm iu">安装</strong></p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="a006" class="oj mn it ow b gy pa pb l pc pd">pip install librosa<br/>or<br/>conda install -c conda-forge librosa</span></pre><p id="0188" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated">为了提供更多的音频解码能力，你可以安装许多音频解码器附带的<em class="no"> FFmpeg、</em>。</p><h2 id="1edb" class="oj mn it bd mo ok ol dn ms om on dp mw lt oo op my lx oq or na mb os ot nc ou bi translated">2.IPython.display .音频</h2><p id="d046" class="pw-post-body-paragraph lk ll it lm b ln ne ju lp lq nf jx ls lt ng lv lw lx nh lz ma mb ni md me lj im bi translated"><code class="fe pe pf pg ow b"><a class="ae ky" href="https://ipython.org/ipython-doc/stable/api/generated/IPython.display.html#IPython.display.Audio" rel="noopener ugc nofollow" target="_blank"><strong class="lm iu">IPython.display.Audio</strong></a></code>让您直接在 jupyter 笔记本上播放音频。</p><h1 id="135e" class="mm mn it bd mo mp np mr ms mt nq mv mw jz nr ka my kc ns kd na kf nt kg nc nd bi translated">载入音频文件</h1><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="a6b1" class="oj mn it ow b gy pa pb l pc pd">import librosa</span><span id="277c" class="oj mn it ow b gy ph pb l pc pd">audio_path = '../<a class="ae ky" href="https://github.com/parulnith/Data-Science-Articles/blob/main/Music-Genre-Classification-with-Python-master/T08-violin.wav" rel="noopener ugc nofollow" target="_blank">T08-violin</a>.wav'<br/>x , sr = librosa.load(audio_path)</span><span id="3c85" class="oj mn it ow b gy ph pb l pc pd">print(type(x), type(sr))<br/>&lt;class 'numpy.ndarray'&gt; &lt;class 'int'&gt;</span><span id="e130" class="oj mn it ow b gy ph pb l pc pd">print(x.shape, sr)<br/>(396688,) 22050</span></pre><p id="2e06" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated">这会以 numpy 数组的形式返回音频时间序列，默认采样速率(sr)为 22KHZ 单声道。我们可以这样改变这种行为:</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="59d3" class="oj mn it ow b gy pa pb l pc pd">librosa.load(audio_path, sr=44100)</span></pre><p id="83d8" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated">以 44.1KHz 的频率重新采样，或者</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="508e" class="oj mn it ow b gy pa pb l pc pd">librosa.load(audio_path, sr=None)</span></pre><p id="841a" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated">禁用重采样。</p><p id="ba74" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated">采样率是每秒传送的音频样本数，以赫兹或千赫兹为单位。</p><h1 id="a8fd" class="mm mn it bd mo mp np mr ms mt nq mv mw jz nr ka my kc ns kd na kf nt kg nc nd bi translated">播放音频</h1><p id="4301" class="pw-post-body-paragraph lk ll it lm b ln ne ju lp lq nf jx ls lt ng lv lw lx nh lz ma mb ni md me lj im bi translated">使用，<code class="fe pe pf pg ow b"><strong class="lm iu">IPython.display.Audio</strong></code>来播放音频</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="9b63" class="oj mn it ow b gy pa pb l pc pd">import IPython.display as ipd<br/>ipd.Audio(audio_path)</span></pre><p id="7bb0" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated">这将在 jupyter 笔记本中返回一个音频小部件，如下所示:</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/625e088b83866465df383bf8ec4dafe4.png" data-original-src="https://miro.medium.com/v2/resize:fit:684/format:webp/1*ktoXTt51zFSTMgiuv5ZCgg.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">screenshot of the Ipython audio widget</figcaption></figure><p id="862e" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated">这个小工具在这里不能用，但是可以用在你的笔记本上。我已经把它上传到了 SoundCloud，这样我们就可以听了。</p><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pj pk l"/></div></figure><p id="9a2d" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated">对于音频示例，您甚至可以使用 mp3 或 WMA 格式。</p><h1 id="a642" class="mm mn it bd mo mp np mr ms mt nq mv mw jz nr ka my kc ns kd na kf nt kg nc nd bi translated">可视化音频</h1><h2 id="3660" class="oj mn it bd mo ok ol dn ms om on dp mw lt oo op my lx oq or na mb os ot nc ou bi translated">波形</h2><p id="463f" class="pw-post-body-paragraph lk ll it lm b ln ne ju lp lq nf jx ls lt ng lv lw lx nh lz ma mb ni md me lj im bi translated">我们可以使用<code class="fe pe pf pg ow b"><a class="ae ky" href="https://librosa.github.io/librosa/generated/librosa.display.waveplot.html#librosa.display.waveplot" rel="noopener ugc nofollow" target="_blank"><strong class="lm iu">librosa.display.waveplot</strong></a></code>来绘制音频数组:</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="e70d" class="oj mn it ow b gy pa pb l pc pd">%matplotlib inline<br/>import matplotlib.pyplot as plt<br/>import librosa.display</span><span id="d6e5" class="oj mn it ow b gy ph pb l pc pd">plt.figure(figsize=(14, 5))<br/>librosa.display.waveplot(x, sr=sr)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pl"><img src="../Images/df6adb03760f1a9f3944901248c305c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tspcooMfQnmYPwxMKWhTmg.png"/></div></div></figure><p id="3fcc" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated">这是波形的幅度包络图。</p><h2 id="6405" class="oj mn it bd mo ok ol dn ms om on dp mw lt oo op my lx oq or na mb os ot nc ou bi translated">光谱图</h2><p id="5128" class="pw-post-body-paragraph lk ll it lm b ln ne ju lp lq nf jx ls lt ng lv lw lx nh lz ma mb ni md me lj im bi translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/Spectrogram" rel="noopener ugc nofollow" target="_blank"> <strong class="lm iu">声谱图</strong> </a>是<a class="ae ky" href="https://en.wikipedia.org/wiki/Sound" rel="noopener ugc nofollow" target="_blank">声音</a>或其他信号的<a class="ae ky" href="https://en.wikipedia.org/wiki/Frequencies" rel="noopener ugc nofollow" target="_blank">频率</a>的<a class="ae ky" href="https://en.wikipedia.org/wiki/Spectral_density" rel="noopener ugc nofollow" target="_blank">频谱</a>随时间变化的直观表示。声谱图有时被称为<strong class="lm iu">声谱图</strong>、<strong class="lm iu">声纹</strong>或<strong class="lm iu">声谱图</strong>。当数据以 3D 图表示时，它们可以被称为<strong class="lm iu">瀑布</strong>。在二维数组中，第一个轴是频率，而第二个轴是时间。</p><p id="ee3f" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated">我们可以用。<code class="fe pe pf pg ow b"><a class="ae ky" href="https://librosa.github.io/librosa/generated/librosa.display.specshow.html" rel="noopener ugc nofollow" target="_blank"><strong class="lm iu">librosa.display.specshow</strong></a><strong class="lm iu">.</strong></code></p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="336a" class="oj mn it ow b gy pa pb l pc pd">X = librosa.stft(x)<br/>Xdb = librosa.amplitude_to_db(abs(X))<br/>plt.figure(figsize=(14, 5))<br/>librosa.display.specshow(Xdb, sr=sr, x_axis='time', y_axis='hz')<br/>plt.colorbar()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi pm"><img src="../Images/abc477c8df37ce0237dafc24df665f50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7jZRCE58z2QTulOIIHw_LA.png"/></div></div></figure><p id="dfb6" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated">纵轴显示频率(从 0 到 10kHz)，横轴显示剪辑的时间。因为所有的行为都发生在光谱的底部，我们可以把频率轴转换成对数轴。</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="f693" class="oj mn it ow b gy pa pb l pc pd">librosa.display.specshow(Xdb, sr=sr, x_axis='time', y_axis='log')<br/>plt.colorbar()</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pn"><img src="../Images/ba86a4f49dd0e01017b97751f7801175.png" data-original-src="https://miro.medium.com/v2/resize:fit:946/format:webp/1*JttzQLEFRzAb3clp7dkfKg.png"/></div></figure><h1 id="d805" class="mm mn it bd mo mp np mr ms mt nq mv mw jz nr ka my kc ns kd na kf nt kg nc nd bi translated">编写音频</h1><p id="6aa0" class="pw-post-body-paragraph lk ll it lm b ln ne ju lp lq nf jx ls lt ng lv lw lx nh lz ma mb ni md me lj im bi translated"><code class="fe pe pf pg ow b"><a class="ae ky" href="https://librosa.github.io/librosa/generated/librosa.output.write_wav.html#librosa.output.write_wav" rel="noopener ugc nofollow" target="_blank"><strong class="lm iu">librosa.output.write_wav</strong></a></code>将 NumPy 数组保存到 WAV 文件。</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="c299" class="oj mn it ow b gy pa pb l pc pd">librosa.output.write_wav('example.wav', x, sr)</span></pre><h1 id="8bd6" class="mm mn it bd mo mp np mr ms mt nq mv mw jz nr ka my kc ns kd na kf nt kg nc nd bi translated">创建音频信号</h1><p id="958c" class="pw-post-body-paragraph lk ll it lm b ln ne ju lp lq nf jx ls lt ng lv lw lx nh lz ma mb ni md me lj im bi translated">现在让我们创建一个 220 赫兹的音频信号。一个音频信号是一个 numpy 数组，所以我们应该创建一个并把它传递给 audio 函数。</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="0b5c" class="oj mn it ow b gy pa pb l pc pd">import numpy as np<br/>sr = 22050 <em class="no"># sample rate</em><br/>T = 5.0    <em class="no"># seconds</em><br/>t = np.linspace(0, T, int(T*sr), endpoint=<strong class="ow iu">False</strong>) <em class="no"># time variable</em><br/>x = 0.5*np.sin(2*np.pi*220*t)<em class="no"># pure sine wave at 220 Hz</em></span><span id="2717" class="oj mn it ow b gy ph pb l pc pd"><strong class="ow iu">Playing the audio</strong><br/>ipd.Audio(x, rate=sr) <em class="no"># load a NumPy array</em></span><span id="01f3" class="oj mn it ow b gy ph pb l pc pd"><strong class="ow iu">Saving the audio</strong><br/>librosa.output.write_wav('tone_220.wav', x, sr)</span></pre><figure class="kj kk kl km gt kn"><div class="bz fp l di"><div class="pj pk l"/></div></figure><p id="b55b" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated">这是你创造的第一个声音信号。🙌</p><h1 id="aa21" class="mm mn it bd mo mp np mr ms mt nq mv mw jz nr ka my kc ns kd na kf nt kg nc nd bi translated">特征抽出</h1><p id="ba48" class="pw-post-body-paragraph lk ll it lm b ln ne ju lp lq nf jx ls lt ng lv lw lx nh lz ma mb ni md me lj im bi translated">每个音频信号都包含许多特征。然而，我们必须提取与我们试图解决的问题相关的特征。提取特征以用于分析的过程称为特征提取。让我们详细研究几个特征。</p><ul class=""><li id="8de6" class="nv nw it lm b ln nj lq nk lt nx lx ny mb nz lj oa ob oc od bi translated"><strong class="lm iu">过零率</strong></li></ul><p id="d04d" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/Zero-crossing_rate" rel="noopener ugc nofollow" target="_blank">过零率</a>是信号随符号变化的速率，即信号从正变到负或反变的速率。这个功能在<a class="ae ky" href="https://en.wikipedia.org/wiki/Speech_recognition" rel="noopener ugc nofollow" target="_blank">语音识别</a>和<a class="ae ky" href="https://en.wikipedia.org/wiki/Music_information_retrieval" rel="noopener ugc nofollow" target="_blank">音乐信息检索</a>中都被大量使用。它通常具有较高的值，适用于像金属和摇滚这样的高敲击声。</p><p id="0be0" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated">让我们计算示例音频剪辑的<strong class="lm iu">过零率</strong>。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi po"><img src="../Images/d56cd59a43405bca10744fb38dfb9d48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*Re6tj77KWLypP3gY7MaXjA.png"/></div></figure><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="0937" class="oj mn it ow b gy pa pb l pc pd"># Load the signal<br/>x, sr = librosa.load('../T08-violin.wav')</span><span id="12fa" class="oj mn it ow b gy ph pb l pc pd">#Plot the signal:<br/>plt.figure(figsize=(14, 5))<br/>librosa.display.waveplot(x, sr=sr)</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pp"><img src="../Images/12e9c481c70ac9101fc03abaf97ceb96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1396/format:webp/1*m3v38dqyykefBp0OiNRBPg.png"/></div></figure><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="b8e6" class="oj mn it ow b gy pa pb l pc pd"># Zooming in<br/>n0 = 9000<br/>n1 = 9100<br/>plt.figure(figsize=(14, 5))<br/>plt.plot(x[n0:n1])<br/>plt.grid()</span></pre><p id="1266" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated">似乎有 6 个过零点。让我们向 librosa 核实一下。</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="aab7" class="oj mn it ow b gy pa pb l pc pd">zero_crossings = librosa.zero_crossings(x[n0:n1], pad=False)<br/>print(sum(zero_crossings))</span><span id="9c31" class="oj mn it ow b gy ph pb l pc pd"><strong class="ow iu">6</strong></span></pre><ul class=""><li id="dabf" class="nv nw it lm b ln nj lq nk lt nx lx ny mb nz lj oa ob oc od bi translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/Spectral_centroid" rel="noopener ugc nofollow" target="_blank"> <strong class="lm iu">光谱质心</strong> </a></li></ul><p id="ed7f" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated">它表示声音的“质量中心”所在的位置，计算方法是声音中频率的加权平均值。考虑两首歌曲，一首来自蓝调流派，另一首属于金属。现在，与布鲁斯流派歌曲相比，它的长度是一样的，金属歌曲在结尾有更多的频率。<strong class="lm iu">因此蓝调歌曲的频谱质心将位于其频谱的中间附近，而金属歌曲的频谱质心将接近其末端。</strong></p><p id="cbc3" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated"><code class="fe pe pf pg ow b"><a class="ae ky" href="https://librosa.github.io/librosa/generated/librosa.feature.spectral_centroid.html#librosa.feature.spectral_centroid" rel="noopener ugc nofollow" target="_blank"><strong class="lm iu">librosa.feature.spectral_centroid</strong></a></code>计算信号中每一帧的频谱质心:</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="1751" class="oj mn it ow b gy pa pb l pc pd">spectral_centroids = librosa.feature.spectral_centroid(x, sr=sr)[0]<br/>spectral_centroids.shape<br/>(775,)</span><span id="ac67" class="oj mn it ow b gy ph pb l pc pd"># Computing the time variable for visualization<br/>frames = range(len(spectral_centroids))<br/>t = librosa.frames_to_time(frames)</span><span id="ea33" class="oj mn it ow b gy ph pb l pc pd"># Normalising the spectral centroid for visualisation<br/>def normalize(x, axis=0):<br/>    return sklearn.preprocessing.minmax_scale(x, axis=axis)</span><span id="af02" class="oj mn it ow b gy ph pb l pc pd">#Plotting the Spectral Centroid along the waveform<br/>librosa.display.waveplot(x, sr=sr, alpha=0.4)<br/>plt.plot(t, normalize(spectral_centroids), color='r')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pq"><img src="../Images/50957fc7b800e2928e6ee5d855e284da.png" data-original-src="https://miro.medium.com/v2/resize:fit:892/format:webp/1*1Vu8GXxY_CmMBLmcypEjvw.png"/></div></figure><p id="36dc" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated">光谱质心在接近末端时上升。</p><ul class=""><li id="ce60" class="nv nw it lm b ln nj lq nk lt nx lx ny mb nz lj oa ob oc od bi translated"><strong class="lm iu">光谱衰减</strong></li></ul><p id="d56f" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated">它是信号形状的度量。它表示总频谱能量的特定百分比(例如 85%)低于的频率。</p><p id="0331" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated"><code class="fe pe pf pg ow b"><a class="ae ky" href="https://librosa.github.io/librosa/generated/librosa.feature.spectral_rolloff.html#librosa.feature.spectral_rolloff" rel="noopener ugc nofollow" target="_blank"><strong class="lm iu">librosa.feature.spectral_rolloff</strong></a></code>计算信号中每一帧的滚降频率:</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="a63b" class="oj mn it ow b gy pa pb l pc pd">spectral_rolloff = librosa.feature.spectral_rolloff(x+0.01, sr=sr)[0]<br/>librosa.display.waveplot(x, sr=sr, alpha=0.4)<br/>plt.plot(t, normalize(spectral_rolloff), color='r')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pr"><img src="../Images/f03a5aef465e39e6201c8804b73ac2a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*pOp0miIvDc1wxvS1iwrwCQ.png"/></div></figure><ul class=""><li id="676e" class="nv nw it lm b ln nj lq nk lt nx lx ny mb nz lj oa ob oc od bi translated"><a class="ae ky" href="https://en.wikipedia.org/wiki/Mel-frequency_cepstrum" rel="noopener ugc nofollow" target="_blank"> <strong class="lm iu">梅尔倒谱系数</strong> </a></li></ul><p id="6b4e" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated">信号的 Mel 频率倒谱系数(MFCCs)是一小组特征(通常约为 10–20)，它们简明地描述了频谱包络的整体形状。它模拟了人类声音的特征。</p><p id="2306" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated">这次让我们用一个<a class="ae ky" href="https://github.com/parulnith/Data-Science-Articles/blob/main/Music-Genre-Classification-with-Python-master/simple_loop.wav" rel="noopener ugc nofollow" target="_blank">简单循环</a>波来工作。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi ps"><img src="../Images/525841863b3bef5695bf3f1a948b95d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:882/format:webp/1*kLln6ejJJsTDn9B0zLALUA.png"/></div></figure><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="481a" class="oj mn it ow b gy pa pb l pc pd">x, fs = librosa.load('../simple_loop.wav')<br/>librosa.display.waveplot(x, sr=sr)</span></pre><p id="b32f" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated"><code class="fe pe pf pg ow b"><a class="ae ky" href="https://bmcfee.github.io/librosa/generated/librosa.feature.mfcc.html#librosa.feature.mfcc" rel="noopener ugc nofollow" target="_blank"><strong class="lm iu">librosa.feature.mfcc</strong></a></code>计算音频信号的 MFCCs:</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="92cf" class="oj mn it ow b gy pa pb l pc pd">mfccs = librosa.feature.mfcc(x, sr=fs)<br/><strong class="ow iu">print</strong> mfccs.shape<br/>(20, 97)</span><span id="e2e9" class="oj mn it ow b gy ph pb l pc pd">#Displaying  the MFCCs:<br/>librosa.display.specshow(mfccs, sr=sr, x_axis='time')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pt"><img src="../Images/2e7df74b058a18906089af08e1efbf56.png" data-original-src="https://miro.medium.com/v2/resize:fit:770/format:webp/1*a6OcRvqCNDEix02CI5dK6w.png"/></div></figure><p id="1843" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated">这里 mfcc 计算了 97 帧中的 20 个 MFCC。</p><p id="ec78" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated">我们还可以执行特征缩放，使得每个系数维度具有零均值和单位方差:</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="f1b4" class="oj mn it ow b gy pa pb l pc pd">import sklearn<br/>mfccs = sklearn.preprocessing.scale(mfccs, axis=1)<br/>print(mfccs.mean(axis=1))<br/>print(mfccs.var(axis=1))</span><span id="ca8f" class="oj mn it ow b gy ph pb l pc pd">librosa.display.specshow(mfccs, sr=sr, x_axis='time')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pu"><img src="../Images/b45b1e2a6c5b1126a2ebb48b81f10954.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/format:webp/1*6ar_u2SROhmOnvgimnI48Q.png"/></div></figure><ul class=""><li id="d4aa" class="nv nw it lm b ln nj lq nk lt nx lx ny mb nz lj oa ob oc od bi translated"><a class="ae ky" href="https://labrosa.ee.columbia.edu/matlab/chroma-ansyn/" rel="noopener ugc nofollow" target="_blank"> <strong class="lm iu">色度频率</strong> </a></li></ul><p id="1d51" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated">色度特征是音乐音频的一种有趣而强大的表示，其中整个频谱被投影到表示音乐八度音阶的 12 个不同半音(或色度)的 12 个箱上。</p><p id="3b50" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated"><code class="fe pe pf pg ow b"><a class="ae ky" href="https://librosa.github.io/librosa/generated/librosa.feature.chroma_stft.html#librosa.feature.chroma_stft" rel="noopener ugc nofollow" target="_blank">librosa.feature.chroma_stft</a> </code>用于计算</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="5288" class="oj mn it ow b gy pa pb l pc pd"># Loadign the file<br/>x, sr = librosa.load('../simple_piano.wav')</span><span id="e689" class="oj mn it ow b gy ph pb l pc pd">hop_length = 512<br/>chromagram = librosa.feature.chroma_stft(x, sr=sr, hop_length=hop_length)<br/>plt.figure(figsize=(15, 5))<br/>librosa.display.specshow(chromagram, x_axis='time', y_axis='chroma', hop_length=hop_length, cmap='coolwarm')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi pv"><img src="../Images/8192faa9f9244624c8cafc434242c55c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*31ZW3GzKofk4jsSyRMwubg.png"/></div></figure></div><div class="ab cl mf mg hx mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="im in io ip iq"><h1 id="2093" class="mm mn it bd mo mp mq mr ms mt mu mv mw jz mx ka my kc mz kd na kf nb kg nc nd bi translated">案例分析:将歌曲分为不同的类型。</h1><p id="9f84" class="pw-post-body-paragraph lk ll it lm b ln ne ju lp lq nf jx ls lt ng lv lw lx nh lz ma mb ni md me lj im bi translated"><em class="no">在概述了声音信号、其特征及其特征提取过程之后，是时候利用我们新开发的技能来解决机器学习问题了。</em></p><h2 id="b227" class="oj mn it bd mo ok ol dn ms om on dp mw lt oo op my lx oq or na mb os ot nc ou bi translated">目标</h2><p id="ff70" class="pw-post-body-paragraph lk ll it lm b ln ne ju lp lq nf jx ls lt ng lv lw lx nh lz ma mb ni md me lj im bi translated">在他的章节中，我们将尝试建立一个分类器来将歌曲分类成不同的流派。让我们假设一个场景，由于某种原因，我们在硬盘上发现了一堆随机命名的 MP3 文件，这些文件被认为包含音乐。我们的任务是根据音乐类型将它们分类到不同的文件夹中，如爵士、古典、乡村、流行、摇滚和金属。</p><h2 id="1a43" class="oj mn it bd mo ok ol dn ms om on dp mw lt oo op my lx oq or na mb os ot nc ou bi translated">资料组</h2><p id="81af" class="pw-post-body-paragraph lk ll it lm b ln ne ju lp lq nf jx ls lt ng lv lw lx nh lz ma mb ni md me lj im bi translated">我们将使用著名的<a class="ae ky" href="http://marsyasweb.appspot.com/download/data_sets/" rel="noopener ugc nofollow" target="_blank"> GITZAN </a>数据集进行案例研究。该数据集用于 G. Tzanetakis 和 P. Cook 在 2002 年 IEEE 音频和语音处理汇刊中的著名论文“音频信号的流派分类”<a class="ae ky" href="https://ieeexplore.ieee.org/document/1021072" rel="noopener ugc nofollow" target="_blank">音乐流派分类</a>。</p><p id="683f" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated">该数据集由 1000 首音轨组成，每首音轨时长 30 秒。它包含十种风格:布鲁斯、古典、乡村、迪斯科、嘻哈、爵士、雷鬼、摇滚、金属和流行。每种体裁由 100 个声音片段组成。</p><h2 id="1482" class="oj mn it bd mo ok ol dn ms om on dp mw lt oo op my lx oq or na mb os ot nc ou bi translated">预处理数据</h2><p id="72b4" class="pw-post-body-paragraph lk ll it lm b ln ne ju lp lq nf jx ls lt ng lv lw lx nh lz ma mb ni md me lj im bi translated">在训练分类模型之前，我们必须将来自音频样本的原始数据转换成更有意义的表示。音频剪辑需要从。au 格式到。wav 格式，使其与 python 的 wave 模块兼容，用于读取音频文件。我使用开源的 SoX 模块进行转换。这里有一个方便的关于 SoX 转换的<a class="ae ky" href="https://www.stefaanlippens.net/audio_conversion_cheat_sheet/" rel="noopener ugc nofollow" target="_blank">备忘单</a>。</p><pre class="kj kk kl km gt ov ow ox oy aw oz bi"><span id="5d42" class="oj mn it ow b gy pa pb l pc pd">sox input.au output.wav</span></pre><h2 id="e9a0" class="oj mn it bd mo ok ol dn ms om on dp mw lt oo op my lx oq or na mb os ot nc ou bi translated">分类</h2><ul class=""><li id="145f" class="nv nw it lm b ln ne lq nf lt pw lx px mb py lj oa ob oc od bi translated"><strong class="lm iu">特征提取</strong></li></ul><p id="bbf7" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated">然后，我们需要从音频文件中提取有意义的特征。我们将选择五个特征来分类我们的音频剪辑，即梅尔频率倒谱系数、频谱质心、过零率、色度频率、频谱滚降。然后将所有特征追加到一个. csv 文件中，以便可以使用分类算法。</p><ul class=""><li id="3b5b" class="nv nw it lm b ln nj lq nk lt nx lx ny mb nz lj oa ob oc od bi translated"><strong class="lm iu">分类</strong></li></ul><p id="7fef" class="pw-post-body-paragraph lk ll it lm b ln nj ju lp lq nk jx ls lt nl lv lw lx nm lz ma mb nn md me lj im bi translated">一旦提取了特征，我们可以使用现有的分类算法将歌曲分类成不同的流派。您可以直接使用光谱图图像进行分类，也可以提取特征并对其使用分类模型。</p><h1 id="5fa3" class="mm mn it bd mo mp np mr ms mt nq mv mw jz nr ka my kc ns kd na kf nt kg nc nd bi translated">后续步骤</h1><p id="9bb9" class="pw-post-body-paragraph lk ll it lm b ln ne ju lp lq nf jx ls lt ng lv lw lx nh lz ma mb ni md me lj im bi translated">音乐流派分类是<a class="ae ky" href="https://en.wikipedia.org/wiki/Music_information_retrieval" rel="noopener ugc nofollow" target="_blank">音乐信息检索</a>的众多分支之一。从这里，您可以对音乐数据执行其他任务，如节拍跟踪、音乐生成、推荐系统、音轨分离和乐器识别等。音乐分析是一个多样化的领域，也是一个有趣的领域。音乐会话在某种程度上代表了用户的某个时刻。在数据科学领域，找到并描述这些时刻是一个有趣的挑战。</p></div></div>    
</body>
</html>