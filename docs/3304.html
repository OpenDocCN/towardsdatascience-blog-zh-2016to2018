<html>
<head>
<title>How to create your first web app using Python, Plotly Dash, and Google Sheets API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用 Python、Plotly Dash 和 Google Sheets API 创建您的第一个 web 应用程序</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-create-your-first-web-app-using-python-plotly-dash-and-google-sheets-api-7a2fe3f5d256?source=collection_archive---------2-----------------------#2018-05-01">https://towardsdatascience.com/how-to-create-your-first-web-app-using-python-plotly-dash-and-google-sheets-api-7a2fe3f5d256?source=collection_archive---------2-----------------------#2018-05-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c9c0aab8955a009f9926ed8cea63e2f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xoDRYTVS037qxORKz3h6MA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">The final product from this step-by-step guide to developing web dashboards using Plotly Dash, Python and Google Sheets API</figcaption></figure><p id="0bf1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">更新 09/21/2018: <br/> </strong>下面教程第一部分创建的 app 现在<a class="ae la" href="https://github.com/dcbark01/DashAppTemplate" rel="noopener ugc nofollow" target="_blank">在这个 Github 仓库</a>中可用。虽然在功能方面进行了简化，但是将那里的代码与这里的教程结合起来，应该可以让您立即开始使用 Dash。<br/> — — — — — — — —</p><p id="8504" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我最近写了几个简短的教程，讲述如何使用 Plotly 的人提供的令人敬畏的“Dash”Python 库来创建 web 应用程序。该库对于数据科学项目(或任何项目)的快速原型开发的力量是不可低估的。</p><p id="e438" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">然而，默认情况下，Dash 应用程序只能在本地机器上运行。显然，任何 web 应用程序的主要好处是能够与受众分享。幸运的是，Dash 库是建立在非常流行的“Flask”库之上的，Dash 应用程序可以部署为以同样的方式提供内容。我们将利用通过使用<a class="ae la" href="http://www.heroku.com" rel="noopener ugc nofollow" target="_blank"> Heroku </a>获得的简单部署过程，而不是从头开始配置服务器。一旦我们有了一些在 Heroku 上运行的示例代码，我们将更新应用程序，通过 Python API 从 Google Docs 电子表格中访问数据。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><p id="e4f6" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">步骤 1:创建和设置虚拟环境</strong></p><p id="1b31" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">使用您最喜欢的虚拟环境，创建一个新的环境来存放应用程序。使用 Anaconda，我们只需输入:</p><pre class="li lj lk ll gt lm ln lo lp aw lq bi"><span id="89dd" class="lr ls iq ln b gy lt lu l lv lw">$ conda create --name &lt;your env name&gt; python=3.6</span></pre><p id="cc07" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">创建环境后，在命令提示符下激活它(根据您的操作系统，您可能不需要在前面加上“source”)，然后创建一个文件夹，我们将在后续步骤中使用它来存放所有各种应用程序文件。</p><pre class="li lj lk ll gt lm ln lo lp aw lq bi"><span id="eabf" class="lr ls iq ln b gy lt lu l lv lw">$ source activate &lt;your env name&gt;<br/>$ mkdir venv<br/>$ cd venv</span></pre><p id="35c6" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在，安装应用程序所需的依赖项。</p><pre class="li lj lk ll gt lm ln lo lp aw lq bi"><span id="03aa" class="lr ls iq ln b gy lt lu l lv lw">$ pip install dash<br/>$ pip install dash-renderer<br/>$ pip install dash-core-components<br/>$ pip install dash-html-components<br/>$ pip install plotly<br/>$ pip install dash-table-experiments <br/>$ pip install numpy<br/>$ pip install pandas<br/>$ pip install gunicorn<br/>$ pip install --upgrade google-api-python-client</span><span id="da59" class="lr ls iq ln b gy lx lu l lv lw">$ pip install numpy<br/>$ pip install pandas<br/>$ pip install gunicorn</span></pre><p id="ae71" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">验证您是否在先前为项目创建的“venv”目录中。在此初始化一个空的 git 存储库。</p><pre class="li lj lk ll gt lm ln lo lp aw lq bi"><span id="13ba" class="lr ls iq ln b gy lt lu l lv lw">$ git init</span></pre><p id="3f89" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">步骤 2:创建文件结构和初始 app 文件</strong></p><p id="473b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">与简单地在本地机器上运行相比，在 Heroku 上部署一个网站需要一些额外的文件和文件夹。为了确保事情顺利进行，我们需要根据以下结构创建几个文件:</p><pre class="li lj lk ll gt lm ln lo lp aw lq bi"><span id="0025" class="lr ls iq ln b gy lt lu l lv lw">venv/<br/>   app.py<br/>   .gitignore<br/>   .Procfile<br/>   .requirements.txt<br/>   credentials/<br/>      __init__.py<br/>      Credentials.py</span></pre><p id="3085" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在之前创建的“venv”文件夹中，创建一个名为“app.py”的新文件。我们可以使用这里的代码(<a class="ae la" href="https://dash.plot.ly/deployment" rel="noopener ugc nofollow" target="_blank">链接到原始源代码</a>)进行初始测试。</p><figure class="li lj lk ll gt jr"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="dcb7" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在，创建一个“credentials”文件夹，并在该文件夹中创建两个文件，“__init__”。py”和“Credentials.py”。__init__ 文件只是让 Python 知道我们希望这个文件夹是一个可导入的模块——我们可以将文件本身留空。第二个文件是我们用来存储访问 Google 工作表数据的 Google API 键的地方，但是我们稍后会更新这些键。</p><p id="31e7" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">*重要提示:</strong>在将代码上传到任何公共 Git 存储库之前，请确保更新 gitignore 文件以排除 credentials 文件夹！</p><p id="ddb2" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在“venv”文件夹中，创建。gitignore 文件(我喜欢用<a class="ae la" href="https://www.gitignore.io/" rel="noopener ugc nofollow" target="_blank"> gitignore.io </a>作为启动模板)。</p><pre class="li lj lk ll gt lm ln lo lp aw lq bi"><span id="bb1b" class="lr ls iq ln b gy lt lu l lv lw"># At a minimum, make sure .gitignore file contains these items<br/>*.pyc<br/>.DS_Store<br/>.env</span></pre><p id="cb8b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">接下来，同样在“venv”文件夹中，创建一个名为“Procfile”的文件，其内容如下:</p><pre class="li lj lk ll gt lm ln lo lp aw lq bi"><span id="5a35" class="lr ls iq ln b gy lt lu l lv lw">web: gunicorn app:server</span></pre><p id="72b9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">最后，我们需要在“requirements.txt”文件中创建一个项目依赖关系列表。只需在提示符下键入以下命令，即可轻松生成该列表:</p><pre class="li lj lk ll gt lm ln lo lp aw lq bi"><span id="889b" class="lr ls iq ln b gy lt lu l lv lw">$ pip freeze &gt; requirements.txt</span></pre><p id="56e1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">第三步:将测试应用部署到 Heroku </strong></p><p id="9b87" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">对于这一步，您需要在您的机器上安装一个 Heroku 帐户和命令行提示符(<a class="ae la" href="https://devcenter.heroku.com/articles/heroku-cli" rel="noopener ugc nofollow" target="_blank">参见 Heroku 帐户设置的链接</a>)。</p><pre class="li lj lk ll gt lm ln lo lp aw lq bi"><span id="2840" class="lr ls iq ln b gy lt lu l lv lw">$ heroku create lava-vino # replace "lava-vino" with your-app-name<br/>$ git add . <br/>$ git commit -m "Initial commit"<br/>$ git push heroku master <br/>$ heroku ps:scale web=1</span></pre><p id="f81c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">验证该应用程序在<a class="ae la" href="https://lava-vino.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">https://lava-vino.herokuapp.com/</a>(或您的应用程序的等效名称)上可见。</p><figure class="li lj lk ll gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ma"><img src="../Images/ac2dc1b717c8e0d37c095f412dddcb81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_nQze1o5-OZWNR1fh5v9Ig.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">The test app shows up in the browser — Success!</figcaption></figure><p id="a64a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">第五步:更新应用程序，从 Google API 中提取数据，并将数据可视化</strong></p><p id="629b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><a class="ae la" href="https://medium.com/@daniel_c_barker/how-to-access-google-sheet-data-using-the-python-api-and-convert-to-pandas-dataframe-5ec020564f0e" rel="noopener">在之前的教程</a>中，我解释了如何使用 Google 的 Python API 访问 Google 工作表数据。为了可视化该教程中提到的火山葡萄酒数据集，我们需要更新我们的应用程序，并提供适当的 Google API 凭证。稍微修改一下该教程中描述的步骤，将“client_secret.json”文件复制到我们在上一步中创建的“credentials”文件夹中。此外，您需要用您的地图框 ID 令牌更新“Credentials.py”文件。</p><p id="ac1e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">重要提示:</strong>在将代码上传到任何公共 Git 存储库之前，一定要更新 gitignore 文件，以排除 credentials 文件夹！</p><p id="75b3" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">接下来，用下面的代码更新‘app . py’文件(确保包含您自己的 Mapbox ID 标记，和/或更新 Google 工作表名称、ID 和数据解析方法以适应您自己的数据集)。</p><figure class="li lj lk ll gt jr"><div class="bz fp l di"><div class="ly lz l"/></div></figure><p id="0715" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们几乎准备好将更新的应用程序部署到 Heroku，但是首先，我们需要在本地机器上运行应用程序，以便生成 Google API 凭证文件。继续在本地计算机上运行“app.py”文件；您应该会收到一条警告，提示您访问一个链接，以使用您的 Google 帐户验证您的应用程序。单击链接进行身份验证—如果成功，您现在应该在 credentials 文件夹中有一个新的“credentials.json”文件。</p><figure class="li lj lk ll gt jr gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/8d5fe9dcf8004146c5968a0c6f012c57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*6Bj7w6KAIi3QPzo30CvqEA.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">After running the app on your local machine, click the link to authenticate access request for the Google API</figcaption></figure><p id="faf3" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">生成凭证文件后，您就可以使用以下命令将更新后的应用程序部署到 Heroku 了:</p><pre class="li lj lk ll gt lm ln lo lp aw lq bi"><span id="50fd" class="lr ls iq ln b gy lt lu l lv lw">$ git status # view the changes<br/>$ git add .  # add all the changes<br/>$ git commit -m "Updated app"<br/>$ git push heroku master</span></pre><p id="f04e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">关键时刻……导航到<a class="ae la" href="https://lava-vino.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">https://lava-vino.herokuapp.com/</a>(或者你的应用程序名称的网址，祈祷成功吧！我们的 web 应用程序已成功部署到世界各地！</p><figure class="li lj lk ll gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c9c0aab8955a009f9926ed8cea63e2f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xoDRYTVS037qxORKz3h6MA.png"/></div></div></figure><figure class="li lj lk ll gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mc"><img src="../Images/d287cfdc31a382c2775b040e96c722d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GMdWnkRq1EzZQjCxK-65aQ.png"/></div></div></figure><p id="7e8d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如您所见，创建 Dash 应用程序并通过 Heroku 进行部署相对简单，而且所有这些都无需编写任何 HTML、Javascript 或 CSS 代码。显然，这个应用程序还有很多工作要做——交叉引用葡萄酒名称数据、可视化数据、创建友好的用户界面等。我们将在以后的教程中讨论这些内容。我还将尝试上传一个项目的精简版本到它自己的 Git 存储库中，这样它就可以很容易地被克隆为一个模板。与此同时，希望这能让你开始运行自己的 Dash 应用程序！</p></div></div>    
</body>
</html>