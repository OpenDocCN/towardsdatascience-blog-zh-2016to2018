# 使用 Doc2Vec 的自动主题聚类

> 原文：<https://towardsdatascience.com/automatic-topic-clustering-using-doc2vec-e1cea88449c?source=collection_archive---------0----------------------->

假设你是一家大公司的经理，想要保存你的客户数据。这意味着你必须跟上当前网络安全的趋势和威胁。然而，网络安全领域发展非常迅速，因此很难跟上形势。”。

这是我们上周末在 [HackDelft](https://hackdelft.com/) 黑客马拉松上做的推介的开始。我们项目的目标是创造一种向管理者展示网络安全趋势的新方式。在这篇博客中，我将解释我们是如何解决这个问题的，以及我们使用了什么技术。

目前，毕马威和 Owlin(我们案例的发起人)有一个[门户](https://cyber.kpmg.nl/#trends/)，提供按重要性排序的关于网络安全话题的文章。这些都很好，但是为了能够理解这些趋势，你仍然需要阅读大量的文章。因此，我们希望建立一个门户，可以将最近的文章聚集到主题中，并在旁边附上该主题的摘要。这样你就能一眼看出当前重要的是什么。

LDA 是一种常用的主题发现算法。不过以我的经验 LDA 可以吐槽一些难以理解的话题簇。另一种方法可以是基于 [tf-idf](https://en.wikipedia.org/wiki/Tf%E2%80%93idf) 向量的聚类，但因为 Word2Vec 和 Doc2Vec 已经显示出在自然语言处理场景中生成令人敬畏的结果，我们决定尝试这些，只是为了好玩。

Word2Vec 是谷歌开发的一种无监督算法，它试图从文本数据集中学习单词的有意义的矢量表示。它这样做是基于*分布假设，*假设出现在相同上下文中的单词可能有相似的意思。
你可以用这些词向量做很酷的事情，比如做下面的向量计算: *King - Man + Woman* 会给你一个和 Queen 的词向量非常接近的向量。如果你想自己尝试这些，你可以在这里做[。此外，Google 在这里](http://bionlp-www.utu.fi/wv_demo/)提供了一个预训练的 Word2Vec 模型[。Doc2Vec(也称为段落向量)是 Word2Vec 的扩展，它学习文档的意思，而不是单词。](https://drive.google.com/file/d/0B7XkCwpI5KDYNlNUTTlSS21pQmM/edit?usp=sharing)

[本文](https://arxiv.org/pdf/1607.05368.pdf)表明，通过一起训练 Word2Vec 和 Doc2Vec，文档的向量被放置在描述那些文档的主题的单词附近。这给了我们以下的想法:*如果我们聚类文档，取这些聚类的平均值，并查看与这些平均值的向量表示相似的单词，会怎么样？*也许这会给我们一些描述星团的词汇。

我们首先在数据集上一起训练 Doc2Vec 和 Word2Vec，由 KPMG 和 Owlin 提供，使用 [Gensim](https://radimrehurek.com/gensim/) Python 库。这个数据集包含了过去 200 天的大约 10 万篇新闻文章。因为它包含了许多重复的内容，我们必须先删除它们。此外，我们还删除了特殊字符和网址，并在训练前降低所有内容的大小写，以消除噪音。

训练后，我们从过去 3 天的新闻文章中提取，并使用训练好的 Doc2Vec 模型检索这些文章的向量表示。然后我们使用 K-means 算法(来自 [nltk](http://www.nltk.org/) python 库)对向量进行聚类。因为相似性通常使用*余弦距离来度量，*我们使用余弦距离来代替欧几里德距离。

这给了我们一些很好的结果。它生成的集群的一些示例如下:

*   川普解雇联邦调查局局长詹姆斯·科米
*   三星 Z4 手机的发布
*   传播中的勒索病毒 WannaCry
*   Wannacry 袭击了很多医院
*   微软发布 Windows XP 补丁

有趣的是，它把关于惠普笔记本电脑键盘记录器的文章和关于三星智能手机发布的文章放在了一起。也许它了解到两家公司都在开发消费硬件？此外，它还产生了多个关于[*wanna cry*](https://en.wikipedia.org/wiki/WannaCry_ransomware_attack)*:*的集群，一个关于它的传播，一个关于它袭击了许多医院，一个关于微软为它发布了 Windows XP 补丁。

不幸的是，我们关于使用 Word2Vec 总结集群的想法没有实现。它产生的单词根本不能概括集群。相反，我们尝试了一种简单得多的方法:我们从每组中取出所有标题，去掉停用词和数字，并计算每个词出现的次数。然后，我们选择每个聚类中出现次数最多的 5 个单词作为该聚类的关键字。这种方法出奇地有效。
以下是一些例子:

*   三星、tizen、安卓、惠普、z4
*   特朗普，科米，联邦调查局，维基解密，总统
*   勒索软件，攻击，恶意软件，wannacry，攻击
*   勒索软件，攻击，国家，医院，hit
*   市场，证券，报告，全球，研究

最后，我们创建了一个模型，能够使用 Doc2Vec 对相似的文章进行聚类，并在 24 小时内生成描述这些聚类内容的关键字。我们已经在 Github [这里](https://github.com/olafmaas/hackdelft)发布了我们的代码，所以你可以自己玩。它在周末生成的集群可以在[这个](https://raw.githubusercontent.com/olafmaas/hackdelft/master/hackdelft/doc2vec/output.json) JSON 文件中找到。