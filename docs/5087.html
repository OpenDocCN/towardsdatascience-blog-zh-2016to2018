<html>
<head>
<title>Example of Random Forest application in Finance : Option Pricing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">随机森林在金融中的应用实例:期权定价</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/example-of-random-forest-application-in-finance-option-pricing-d6ee06356c6e?source=collection_archive---------9-----------------------#2018-09-26">https://towardsdatascience.com/example-of-random-forest-application-in-finance-option-pricing-d6ee06356c6e?source=collection_archive---------9-----------------------#2018-09-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="eea8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">今天，【2018 年 9 月 9 日下午 1.56，在埃隆·马斯克被发现在电视直播中吸烟后，特斯拉的股票价值<strong class="jp ir"> 263.24 </strong>美元。</p><p id="2adc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">假设我预计接下来几天还会有埃隆马斯克的丑闻。</p><p id="4291" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我预见到上述股票价格的下跌，所以我给你提供一个购买的选择，在任何时候，一个月内，每股 264 美元。万一我错了，股价上涨超过 264 美元，你就可以在市场上买卖你的股票并赚钱！</p><p id="8538" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是，如果特斯拉股票不断减少，你将永远不会行使你的期权，我会积极的，感谢你为这个期权支付的溢价。</p><p id="dbaf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">问题，你愿意为这样的期权支付多少钱？当我在这个选项中加入其他股票时会发生什么？</strong></p></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><h1 id="20d8" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">期权定价</h1><p id="ba71" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">这就是所谓的期权定价理论，自 1973 年 Black 和 Scholes 模型首次出现以来，这是文献中一个众所周知的主题。</p><p id="06e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上述期权被称为美式期权(实际上是百慕大期权，即你只能在 T2 时间{T0，T1，..其中 T 是到期日或期权到期日)。</p></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><p id="a7fd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">常见的方法，特别是在银行中应用的方法，回忆动态规划和 Longstaff Schwartz 算法来解决这个问题。</p><p id="2499" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">直觉上，你可以把它想成一个逆向过程，你在 T 点的期权收益是</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/633b9b0728e5a740f77bbf3c9a4af0ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:374/format:webp/1*3LW-JmZXkeKax4tf-8c2fg.png"/></div></figure><p id="bc4b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">其中 X_T 是特斯拉到期时的股价。</p><p id="dfb2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">动态编程完全是一个视角问题！</p><p id="0c63" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">假设我们在一个月内只能行使两次期权(两周时间，用 2W 表示，一个月内，用 T=1M 表示)。</p><p id="df72" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那么在时间 t=2W 时你只有两个选择:</p><ul class=""><li id="df11" class="me mf iq jp b jq jr ju jv jy mg kc mh kg mi kk mj mk ml mm bi translated">你要么运动(如果 X(2W) &gt; K)。然后，你将得到(X(2W)- K)$投资于一个自由风险账户，每天支付无风险利率 r，并在时间 T=1M 时得到(1+r)⁴*(x(2w)-k)$ 14(账户每天支付的两周的指数)，</li><li id="ee08" class="me mf iq jp b jq mn ju mo jy mp kc mq kg mr kk mj mk ml mm bi translated">或者你<strong class="jp ir">期望</strong>特斯拉份额在 T 点更高(你这个疯狂的傻瓜)，因此增加你的期权价值(所以你会等到 T 点)。</li></ul><p id="c543" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">设 Y 为该期权价值价格。你在直观地解下面的逆向方程，</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mt mu di mv bf mw"><div class="gh gi ms"><img src="../Images/f6ff75637d08ab2fb5f4a5ea0577a761.png" data-original-src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*roaDKialOieG8-3IdNb_oQ.png"/></div></div></figure><p id="db4e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上述方程没有封闭形式的公式，但我们可以在数值上提供近似值。</p><p id="2a48" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们如何获得上述方程的近似值？</p></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><h1 id="3562" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">回归</h1><p id="f169" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">假设我们知道特斯拉股票在 2W 的价格。</p><p id="5e5c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">已知 t=2W 时的所有信息，我们唯一的未知数是未来期权价值(Y_T)。换句话说，如果你在两周内(即未来)，你的投资组合的期望值是多少，由这一个美式期权组成。</p><p id="424a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这时回归就出现了。</p><p id="fac7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你有 2W 的信息，你想预测 100 万英镑的期权价值。</p><p id="ce97" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl">输入/标签</em></strong>:t = 2W 时特斯拉股价的所有样本</p><p id="9f6f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl">输出【at t = T = 1M 时的选项值</em></strong></p><h2 id="28bb" class="mx ku iq bd kv my mz dn kz na nb dp ld jy nc nd lh kc ne nf ll kg ng nh lp ni bi translated">正向模拟</h2><p id="95b9" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">事先，我们需要模拟特斯拉股价的多种情景。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/03a26d04ecd36a6fb03de5091e5a7a09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*IL5ssEhidQjZI7BPfcFizA.png"/></div><figcaption class="nk nl gj gh gi nm nn bd b be z dk">Geometric Brownian Motion simulation applied on Tesla Share</figcaption></figure><p id="69b4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了简化模型，我们假设特斯拉股票遵循几何布朗运动路径，平均 r(无风险利率)和波动率适马= 20%(我们让感兴趣的读者参考<a class="ae no" href="http://www.math.harvard.edu/~knill/books/KnillProbability.pdf" rel="noopener ugc nofollow" target="_blank">随机过程理论</a>)。</p><p id="621f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意:1 个月的时间大约相当于 0.08 年的时间。因此在这张图上 T = 0.08，2W = 0.04。</p><h2 id="6e33" class="mx ku iq bd kv my mz dn kz na nb dp ld jy nc nd lh kc ne nf ll kg ng nh lp ni bi translated">数据可视化</h2><p id="026f" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">在左边，我们画出了 T 时对特斯拉股价的回报(你可以在这里认出非线性的 max 函数，或者深度学习读者的 ReLu 激活函数)，在右边，画出了 t=2W 时对特斯拉股价的回报。</p><div class="lx ly lz ma gt ab cb"><figure class="np mb nq nr ns nt nu paragraph-image"><img src="../Images/4379d59e91849262785e9d01a1bf63b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:856/format:webp/1*TLqemm6B5CnIixhym96nvQ.png"/></figure><figure class="np mb nq nr ns nt nu paragraph-image"><img src="../Images/050610b14078334ca91eb94bdd85786d.png" data-original-src="https://miro.medium.com/v2/resize:fit:856/format:webp/1*4ei_0GQ92rn58U6vv-yO8Q.png"/><figcaption class="nk nl gj gh gi nm nn bd b be z dk nv di nw nx">Left : Payoff against Stock price at t=1M— — Right : Payoff against Stock price at t=2W</figcaption></figure></div><p id="8cff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">回归</strong></p><p id="cfab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">存在多种回归方法，在准确性和时间方面表现良好，以解决这种预测问题。在一个维度上(即只有一只股票，这里是特斯拉)，我们可以想到多项式回归(你可以查看<a class="ny nz ep" href="https://medium.com/u/e2be6afa4436?source=post_page-----d6ee06356c6e--------------------------------" rel="noopener" target="_blank">比约恩·哈特曼</a>关于此事的帖子)，或者<a class="ae no" href="http://mccormickml.com/2014/02/26/kernel-regression/" rel="noopener ugc nofollow" target="_blank">高斯核回归</a>。</p><p id="1886" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第一个会导致角点问题(见下文，在 240 之前，回归在拟合数据下开始)，而第二个在计算上可能是昂贵的。</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="f4eb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> NB </strong>:如果上面的交互代码无法加载，我在下面添加了预期的输出(感谢<a class="ny nz ep" href="https://medium.com/u/e2f299e30cb9?source=post_page-----d6ee06356c6e--------------------------------" rel="noopener" target="_blank"> William Koehrsen </a>，他的文章“如何在一篇中等大小的文章中放置完全交互的、可运行的代码”)和 Jupyter 笔记本(使用<a class="ny nz ep" href="https://medium.com/u/fd2fe2bc0784?source=post_page-----d6ee06356c6e--------------------------------" rel="noopener" target="_blank"> Vera Chernova </a>的建议)。</p><div class="lx ly lz ma gt ab cb"><figure class="np mb nq nr ns nt nu paragraph-image"><img src="../Images/c113a2cb8f8024e8e895d37941cd4db3.png" data-original-src="https://miro.medium.com/v2/resize:fit:856/format:webp/1*vnibkQlNPT8Sa3woEQaVDA.png"/></figure><figure class="np mb nq nr ns nt nu paragraph-image"><img src="../Images/24dda30a9afe0a9546e2bf252f8cf9dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:856/format:webp/1*_HqVZspfkEL1o-T16xVrCw.png"/></figure></div></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><p id="596d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是，你是一个真正的玩家！</p><p id="4f0a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你查看新闻，注意到大众和脸书的股票正在慢慢恢复过去的势头。</p><p id="ac64" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我阅读了我这边的新闻，决定值得冒险，并向你提供一个类似的美式期权，这次到期日为 1 年，可以行使 4 次，几何平均回报(即，当你行使时，如果你希望你的银行账户为正，你需要特斯拉 x FB x VW 立方根的乘积大于我们今天定义的罢工)。</p><ul class=""><li id="a64b" class="me mf iq jp b jq jr ju jv jy mg kc mh kg mi kk mj mk ml mm bi translated">如今，这一几何平均值将等于(263.24 x 158.97 x 165.94)^(1/3)~ 190.78 美元</li><li id="5518" class="me mf iq jp b jq mn ju mo jy mp kc mq kg mr kk mj mk ml mm bi translated">让我们解决一个罢工 K = 191 美元(我们称之为货币期权，因为它几乎是今天的价格)。</li></ul><p id="8085" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这种情况下，我们仍然可以利用多项式回归，但如果我们决定玩更多的份额，它就不是<strong class="jp ir">可伸缩的</strong>！</p><p id="8a91" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">我们如何在高维空间(即多股)为期权定价？</strong></p></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><h2 id="7171" class="mx ku iq bd kv my mz dn kz na nb dp ld jy nc nd lh kc ne nf ll kg ng nh lp ni bi translated">我们叫一个朋友，随机森林！</h2><p id="9bf1" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">我邀请你提前(为新人)阅读一下<a class="ae no" href="https://medium.com/@williamkoehrsen/random-forest-simple-explanation-377895a60d2d" rel="noopener">威廉·科尔森</a>的这篇关于随机森林回归的杰出解释。</p><p id="9203" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">尽管在一维空间使用它听起来像使用核武器，但它显示了在解决高维情况时的高效性。</p><p id="a7a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">回到我们的一维模型(只有特斯拉份额)，应用随机森林回归看起来像</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/2e190a84dbfa721daa838ffa40f6dd92.png" data-original-src="https://miro.medium.com/v2/resize:fit:856/format:webp/1*rJ8xdjP7-u4KGqkQguHzMw.png"/></div></figure><p id="fedd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它在精确地建模和预测(从图中)，甚至可能太多(过度拟合)。</p><p id="006a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然而，使用一些方差减少方法(如 Picard 迭代)，并调整随机森林超参数，我们可以与文献中提到的大多数方法竞争(例如<a class="ae no" href="https://core.ac.uk/download/pdf/52897448.pdf" rel="noopener ugc nofollow" target="_blank"> Gobet 的超立方体</a>、<a class="ae no" href="http://www.columbia.edu/~mnb2/broadie/Assets/mesh_working_paper.pdf" rel="noopener ugc nofollow" target="_blank"> Glasserman 和 Broadie s' Mesh </a>，..).</p><p id="86dd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当将随机森林应用于相关资产或超过 20 项资产的期权时，这一发现更加真实。</p></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><h1 id="3f64" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">结论</h1><p id="d92a" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">我们在这里展示了机器学习方法如何应用于历史金融问题，如期权定价，以及它如何用于处理巨大的投资组合。</p></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><p id="5568" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="kl"> NB </em> </strong>:下面是上面模拟用的 Jupyter 笔记本。</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="od ob l"/></div></figure><p id="cf62" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">我向感兴趣的读者推荐</em> <a class="ae no" href="http://scholarbank.nus.sg/bitstream/10635/136056/1/RabiaM.pdf" rel="noopener ugc nofollow" target="_blank"> <em class="kl">我在 2017 年 6 月提交给新加坡国立大学(应用概率统计系)的理学硕士论文</em> </a> <em class="kl">，其中我们重点比较了用于期权定价的多种行业方法，包括随机森林、核回归、Mesh、… </em></p></div></div>    
</body>
</html>