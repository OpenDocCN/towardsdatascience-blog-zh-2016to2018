<html>
<head>
<title>What’s happened in a world last month: world news analysis Part II</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">上个月世界发生了什么:世界新闻分析第二部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/whats-happened-in-a-world-last-month-world-news-analysis-part-ii-1c8c284a6691?source=collection_archive---------17-----------------------#2018-11-09">https://towardsdatascience.com/whats-happened-in-a-world-last-month-world-news-analysis-part-ii-1c8c284a6691?source=collection_archive---------17-----------------------#2018-11-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/></div><div class="ab cl jn jo hu jp" role="separator"><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js"/></div><div class="ij ik il im in"><p id="e63c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">你好！那些没有看到我的第一部分的人，我强烈推荐他们去做一个基本的了解。</p><p id="4338" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">第一部分——上个月世界发生了什么:世界新闻分析</p><p id="a5fe" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">所以，我们仍然在收集最新的新闻，现在我们有来自 24 个国家的 53.115 条新闻摘要。我们可以看到大部分是在星期三:</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi kt"><img src="../Images/40e23491c919f3897aab6c277ab0de2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:998/format:webp/1*iNG6VY9GUGYfvwDmz1wDbA.png"/></div></figure><p id="d2c5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在我们分析的第一部分，我们应用了单词检测功能和可视化来快速获得这样的结果(我在之前的帖子中没有画出这个图，但我认为值得在这里看一看):</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lb"><img src="../Images/8045e05ca156b19e05cb1c5bbd098ab3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GF7SnhNmHXN0aWyDImk8ZQ.png"/></div></div></figure><p id="57e3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们可能会看到一些国家(意大利和俄罗斯)严重依赖体育新闻，对科学、健康和艺术话题关注不够。但是有一些国家，如英国、新加坡、澳大利亚和马来西亚，拥有最多的科学报道。真正让我吃惊的是:德国和奥地利比其他国家拥有更多的关于健康的新闻。</p><p id="d1a5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">比较体育和科学话题，我们可以画出这两者之间的总差异。</p><pre class="ku kv kw kx gt lg lh li lj aw lk bi"><span id="5df6" class="ll lm iq lh b gy ln lo l lp lq">Science &lt;- test %&gt;%<br/>  filter(<br/>    str_detect(<br/>      text,<br/>      "science|research|scientific|scientist|科学|wissenschaft|Gelehrte|wissenschaftlich| наука | ученые "<br/>    )<br/>  ) %&gt;%<br/>  count(Date)<br/>Science$id &lt;- "science"</span><span id="24df" class="ll lm iq lh b gy lr lo l lp lq">Sport &lt;- test %&gt;%<br/>  filter(str_detect(text, "sport|спорт|运动|deporte")) %&gt;%<br/>  count(Date)<br/>Sport$id &lt;- "sport"</span><span id="1b61" class="ll lm iq lh b gy lr lo l lp lq"><br/>popularity &lt;- merge(x = Science,<br/>                    y = Sport,<br/>                    by = "Date",<br/>                    all.x = TRUE)<br/><br/>colnames(popularity)[which(names(popularity) == "n.x")] &lt;- "science"<br/>colnames(popularity)[which(names(popularity) == "n.y")] &lt;- "sport"<br/><br/>popularity[is.na(popularity)] &lt;- 0<br/><br/>drops &lt;- c("id.x", "id.y")<br/>popularity &lt;- popularity[,!(names(popularity) %in% drops)]</span><span id="5728" class="ll lm iq lh b gy lr lo l lp lq">ggplot(popularity, aes(x = Date)) +<br/>  geom_area(aes(y = science + sport, fill = "science")) +<br/>  geom_area(aes(y = sport, fill = "sport")) +<br/>  labs(<br/>    title = "Area chart on selected topics",<br/>    subtitle = "Total news",<br/>    caption = "",<br/>    x = "",<br/>    y = ""<br/>  )</span></pre><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/9100eeacf15559ce318ef6b0f73b7cf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1326/format:webp/1*5Q0TpBQKwd6TqP-5RPuIJA.png"/></div></figure><p id="86df" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">看起来体育新闻有时会登上榜首。我们将使用一些定量文本分析工具来找出为什么会发生这种情况。我们从搭配分析开始。为此，我们将使用 quanteda R 包进行定量文本分析。它帮助我们<strong class="jw ir">识别在我们的数据集</strong>中频繁出现的多词表达。经过一些基本操作，如构建语料库、按日期排列变量和创建令牌，我们得到了这个:</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/84bf16512deef92c5ad6287b81a9c84b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*MxxswkB4vHgN_QBEsC9m3g.png"/></div></figure><p id="ec9c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这就是我们之前关于体育新闻问题的答案。我们清楚地看到在我们的数据中出现的主要表达:从游戏和产品到重要的名字、行动和英超联赛。以下是完整的代码:</p><pre class="ku kv kw kx gt lg lh li lj aw lk bi"><span id="84d9" class="ll lm iq lh b gy ln lo l lp lq">news_corp &lt;- test<br/>news_corp$text &lt;- as.character(news_corp$text)<br/>news_corp &lt;- corpus(news_corp)<br/>ndoc(news_corp)</span><span id="29c9" class="ll lm iq lh b gy lr lo l lp lq">range(docvars(news_corp, 'Date'))</span><span id="5ea7" class="ll lm iq lh b gy lr lo l lp lq">news_toks &lt;- tokens(news_corp) %&gt;%<br/>  tokens_remove(stopwords('english'), padding = TRUE) %&gt;%<br/>  tokens_remove('[\\p{P}\\p{S}]', valuetype = 'regex', padding = TRUE)</span><span id="6654" class="ll lm iq lh b gy lr lo l lp lq">cap_toks &lt;-<br/>  tokens_select(<br/>    news_toks,<br/>    '^[A-Z]',<br/>    valuetype = 'regex',<br/>    case_insensitive = FALSE,<br/>    padding = TRUE<br/>  )<br/>head(cap_toks[[1]], 50)</span><span id="8f23" class="ll lm iq lh b gy lr lo l lp lq">cap_col &lt;-<br/>  textstat_collocations(cap_toks, min_count = 10, tolower = FALSE)<br/>head(cap_col, 20) %&gt;%<br/>  View()</span><span id="4d3b" class="ll lm iq lh b gy lr lo l lp lq">cap_col %&gt;%<br/>  arrange(desc(count)) %&gt;%<br/>  head(30) %&gt;%<br/>  ggplot(aes(collocation, count, color = collocation, size = count)) +<br/>  geom_point() +<br/>  coord_flip() +<br/>  expand_limits(y = 0) +<br/>  theme(legend.position = "none") +<br/>  labs(<br/>    title = "Most frequent multi-word expressions",<br/>    subtitle = "",<br/>    x = "",<br/>    y = ""<br/>  )</span></pre><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lu"><img src="../Images/4847ce0865bd13d8cf3fa31682871d5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sT5dHvN-EFy3ndKVU5U_pQ.png"/></div></div></figure><p id="0b58" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">为了改进我们的结果，我们应该只选择强关联的多词表达式。</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/7b6385127b0f2e7eaa556a8aeafebcb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*ADQKY1z0iNH2_V-2DCoGyA.png"/></div></figure><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lw"><img src="../Images/720c0d164df496bf3c65afb7e3d0372b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*601utd79rwkxQRxQRxI6wg.png"/></div></div></figure><p id="7258" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">正如我们所见，Rockstar Games 的新游戏“红色死亡救赎”在我们的数据集中为每个国家都赢得了不错的分数。但是如果我们不知道这到底是一个游戏还是别的什么呢？有针对性的词语搭配帮助我们发现:</p><pre class="ku kv kw kx gt lg lh li lj aw lk bi"><span id="04bb" class="ll lm iq lh b gy ln lo l lp lq">rdr &lt;- c('Red Dead Redemption')<br/>rdr_dfm &lt;-<br/>  tokens_keep(news_toks, phrase(rdr), window = 10) %&gt;% dfm()<br/>not_rdr_dfm &lt;-<br/>  tokens_remove(news_toks, phrase(rdr), window = 10) %&gt;% dfm()<br/>rdr_key &lt;-<br/>  textstat_keyness(rbind(rdr_dfm, not_rdr_dfm), seq_len(ndoc(rdr_dfm)))</span><span id="c5a6" class="ll lm iq lh b gy lr lo l lp lq">rdr_key &lt;- rdr_key[rdr_key$n_target &gt; 10, ]<br/>head(rdr_key, 50)</span><span id="d674" class="ll lm iq lh b gy lr lo l lp lq">rdr_key %&gt;%<br/>  mutate(feature = fct_reorder(feature, chi2)) %&gt;%<br/>  head(30) %&gt;%<br/>  ggplot(aes(feature, chi2, fill = feature)) +<br/>  geom_col() +<br/>  coord_flip() +<br/>  expand_limits(y = 0) +<br/>  theme(legend.position = "none") +<br/>  labs(<br/>    title = "Targeted frequency analysis on 'Red Dead Redemption'",<br/>    subtitle = "",<br/>    x = "",<br/>    y = ""<br/>  )</span></pre><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi lx"><img src="../Images/fca2e11d9bad571e34baa1b2a9db276b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Da8PpEsHjLh956VvkwGrOg.png"/></div></div></figure><p id="8898" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">应用主题建模算法，我们将得到 100 个主题(<a class="ae ks" rel="noopener" target="_blank" href="/whats-happened-in-a-world-last-month-world-news-analysis-b7e540d45d64">见我之前的帖子</a>):</p><pre class="ku kv kw kx gt lg lh li lj aw lk bi"><span id="8903" class="ll lm iq lh b gy ln lo l lp lq">gamma_terms %&gt;%<br/>  top_n(20, gamma) %&gt;%<br/>  ggplot(aes(topic, gamma, label = terms, fill = topic)) +<br/>  geom_col(show.legend = FALSE) +<br/>  geom_text(<br/>    hjust = 0,<br/>    nudge_y = 0.0005,<br/>    size = 3<br/>  ) +<br/>  coord_flip() +<br/>  scale_y_continuous(expand = c(0, 0),<br/>                     limits = c(0, 0.09),<br/>                     labels = percent_format()) +<br/>  labs(<br/>    x = NULL,<br/>    y = expression(gamma),<br/>    title = "Top 20 topics by prevalence in the our dataset",<br/>    subtitle = "With the top words that contribute to each topic"<br/>  )</span></pre><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi ly"><img src="../Images/ca6e8087ca6abd7a4e67d52bf12fc38f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QIdVqQ-_FQbGE2tlvYy5vg.png"/></div></div></figure><p id="c4ed" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在顶部，我们有与总统和政府、体育和一些研究相关的新闻。太好了！接下来，我们将应用相对频率分析。在我的上一篇文章中，我们做了一个“新闻中精选品牌的引用”图表。现在我们比较他们两个的得分。</p><blockquote class="lz ma mb"><p id="871a" class="ju jv mc jw b jx jy jz ka kb kc kd ke md kg kh ki me kk kl km mf ko kp kq kr ij bi translated">textstat_keyness 函数计算“keyness”，这是不同类别中不同出现的特征的得分。这里，通过参考 dfm 中的“目标”文档索引来定义类别，参考组由所有其他文档组成。</p><p id="2387" class="ju jv mc jw b jx jy jz ka kb kc kd ke md kg kh ki me kk kl km mf ko kp kq kr ij bi translated">参考文献<br/>邦迪、玛丽娜和迈克·斯科特合编。2010.文本中的基调。阿姆斯特丹，费城:约翰·本杰明，2010 年。</p><p id="4322" class="ju jv mc jw b jx jy jz ka kb kc kd ke md kg kh ki me kk kl km mf ko kp kq kr ij bi translated">斯塔布斯，迈克尔。2010.“关键词的三个概念”。文本中的基调，玛丽娜邦迪和迈克·斯科特编辑。pp21 <u> 42。阿姆斯特丹，费城:约翰·本杰明。</u></p><p id="041f" class="ju jv mc jw b jx jy jz ka kb kc kd ke md kg kh ki me kk kl km mf ko kp kq kr ij bi translated">斯科特，m .和特里布尔，2006 年。语言教育中的关键词和语料库分析。阿姆斯特丹:本雅明，第 55 页。</p><p id="9b86" class="ju jv mc jw b jx jy jz ka kb kc kd ke md kg kh ki me kk kl km mf ko kp kq kr ij bi translated">邓宁泰德。1993.“统计意外和巧合的精确方法”，《计算语言学》，第 19 卷，第 1 期，第 61-74 页。</p></blockquote><p id="3f5a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">让我们看看作为目标值的“Apple”和预期的“Samsung”之间的相对频率。谁知道也许我们会看到一些关系？结果，我们得到了这个具有卡方值的图(如果目标中的观察值超过其预期值，则符号为正)</p><pre class="ku kv kw kx gt lg lh li lj aw lk bi"><span id="5b36" class="ll lm iq lh b gy ln lo l lp lq">Apple &lt;- test %&gt;%<br/>  filter(str_detect(text, " Apple "))<br/>Apple$id &lt;- "Apple"</span><span id="07e0" class="ll lm iq lh b gy lr lo l lp lq">Samsung &lt;- test %&gt;%<br/>  filter(str_detect(text, " Samsung "))<br/>Samsung$id &lt;- "Samsung"</span><span id="9d07" class="ll lm iq lh b gy lr lo l lp lq">popularity &lt;- rbind(Samsung, Apple)<br/>popularity$text &lt;- as.character(popularity$text)</span><span id="e912" class="ll lm iq lh b gy lr lo l lp lq">my_corpus &lt;- corpus(popularity)</span><span id="4187" class="ll lm iq lh b gy lr lo l lp lq"># Create a dfm <br/>pres_dfm &lt;-<br/>  dfm(<br/>    my_corpus,<br/>    groups = "id",<br/>    remove = stopwords("english"),<br/>    remove_punct = TRUE<br/>  )</span><span id="48b4" class="ll lm iq lh b gy lr lo l lp lq"># Calculate keyness <br/>result_keyness &lt;- textstat_keyness(pres_dfm, target = "Apple")</span></pre><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi mg"><img src="../Images/a8cf870c31666bc84b2b12fb99e30e53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sm03rplOilFn0NUhQP-Srg.png"/></div></div></figure><p id="0335" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们看到目标变量和预期之间的巨大差异:比如三星的可折叠智能手机和苹果的新 macbook。接下来，我们将构建一个 wordfish。Wordfish 是一种缩放技术，它不需要任何锚定文档来执行分析。相反，它依赖于字数的统计模型。这是它寻找“机器人”的方式。</p><pre class="ku kv kw kx gt lg lh li lj aw lk bi"><span id="f017" class="ll lm iq lh b gy ln lo l lp lq">test &lt;- test %&gt;%<br/>  filter(str_detect(text, "Android")) <br/>test$text&lt;-as.character(test$text)<br/>my_corpus &lt;- corpus(test)</span><span id="ca3d" class="ll lm iq lh b gy lr lo l lp lq">wf &lt;- textmodel_wordfish(dfm(my_corpus), dir = c(6,5))</span><span id="2000" class="ll lm iq lh b gy lr lo l lp lq"># Plot estimated word positions<br/>textplot_scale1d(wf, margin = "features", <br/>                 highlighted = c("foldable", "android", <br/>                                 "performance", "samsung"), <br/>                 highlighted_color = "red")</span></pre><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi mh"><img src="../Images/3e2fb0e03d74269f712458a9c8ceff92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yk9OP2nDFXyTRhwm8Jifdg.png"/></div></div></figure><p id="2857" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我最不想尝试的是新闻地图功能。它基于对数据中关联最强的国家的预测。我们已经看了新闻中对选定国家的引用，比如这个图:</p><pre class="ku kv kw kx gt lg lh li lj aw lk bi"><span id="d89a" class="ll lm iq lh b gy ln lo l lp lq">US &lt;- test %&gt;%<br/>  filter(str_detect(text, " United States | US | USA | Stati Uniti | Etats-Unis| США | 美国")) %&gt;%<br/>  count(name, Date)<br/>US$id &lt;- "United States"</span><span id="89bc" class="ll lm iq lh b gy lr lo l lp lq">Germany &lt;- test %&gt;%<br/>  filter(str_detect(<br/>    text,<br/>    " Germany | Deutschland | Alemania | Germania | Allemagne | Германия |德国"<br/>  )) %&gt;%<br/>  count(name, Date)<br/>Germany$id &lt;- "Germany"</span><span id="1c30" class="ll lm iq lh b gy lr lo l lp lq">China &lt;- test %&gt;%<br/>  filter(str_detect(text, " China | Chine | Cina |Китай| 中国")) %&gt;%<br/>  count(name, Date)<br/>China$id &lt;- "China"</span><span id="5a6b" class="ll lm iq lh b gy lr lo l lp lq">Russia &lt;- test %&gt;%<br/>  filter(str_detect(text, " Russia | Russland| Rusia | Russie |Россия|俄罗斯")) %&gt;%<br/>  count(name, Date)<br/>Russia$id &lt;- "Russia"</span><span id="3d01" class="ll lm iq lh b gy lr lo l lp lq">popularity &lt;- rbind(US, Germany, China, Russia)</span><span id="cf11" class="ll lm iq lh b gy lr lo l lp lq">popularity %&gt;%<br/>  group_by(id) %&gt;%<br/>  ggplot(aes(Date, n, color = id)) +<br/>  geom_line(size = 0.9) +<br/>  facet_wrap( ~ name, scales = 'free_y') +<br/>  labs(<br/>    title = "Citations on selected countries in a news",<br/>    subtitle = "Breakdown by Country",<br/>    x = "",<br/>    y = ""<br/>  )</span></pre><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi mi"><img src="../Images/b5f5f8aebb86e835fa6a78d14b34ad95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H61FnvLHtRqhxjT1LrcuzA.png"/></div></div></figure><p id="73fd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">但现在我们将尝试预测国家引用并在地图上绘制出来。</p><blockquote class="lz ma mb"><p id="a406" class="ju jv mc jw b jx jy jz ka kb kc kd ke md kg kh ki me kk kl km mf ko kp kq kr ij bi translated">Newsmap 是用于地理文档分类的半监督模型。虽然(完全)监督模型是在人工分类的数据上训练的，但这种半监督模型是从字典中的“种子词”学习的。</p></blockquote><pre class="ku kv kw kx gt lg lh li lj aw lk bi"><span id="b68e" class="ll lm iq lh b gy ln lo l lp lq">test$text &lt;- as.character(test$text)<br/>test&lt;- corpus(test)</span><span id="47fa" class="ll lm iq lh b gy lr lo l lp lq">ndoc(test)</span><span id="5b7a" class="ll lm iq lh b gy lr lo l lp lq">range(docvars(test, 'Date'))</span><span id="2d47" class="ll lm iq lh b gy lr lo l lp lq">month &lt;- c(<br/>  'January',<br/>  'February',<br/>  'March',<br/>  'April',<br/>  'May',<br/>  'June',<br/>  'July',<br/>  'August',<br/>  'September',<br/>  'October',<br/>  'November',<br/>  'December'<br/>)<br/>day &lt;-<br/>  c('Sunday',<br/>    'Monday',<br/>    'Tuesday',<br/>    'Wednesday',<br/>    'Thursday',<br/>    'Friday',<br/>    'Saturday')<br/>agency &lt;- c('AP', 'AFP', 'Reuters', 'CNN', 'BBC')</span><span id="fcfa" class="ll lm iq lh b gy lr lo l lp lq">toks &lt;- tokens(test)<br/>toks &lt;-<br/>  tokens_remove(toks,<br/>                stopwords('english'),<br/>                valuetype = 'fixed',<br/>                padding = TRUE)<br/>toks &lt;-<br/>  tokens_remove(toks,<br/>                c(month, day, agency),<br/>                valuetype = 'fixed',<br/>                padding = TRUE)</span><span id="6dd9" class="ll lm iq lh b gy lr lo l lp lq">label_toks &lt;-<br/>  tokens_lookup(toks, data_dictionary_newsmap_en, levels = 3) # level 3 is countries<br/>label_dfm &lt;- dfm(label_toks, tolower = FALSE)</span><span id="2b73" class="ll lm iq lh b gy lr lo l lp lq">feat_dfm &lt;- dfm(toks, tolower = FALSE)<br/>feat_dfm &lt;-<br/>  dfm_select(feat_dfm,<br/>             "^[A-Z][A-Za-z1-2]+",<br/>             valuetype = 'regex',<br/>             case_insensitive = FALSE)<br/>feat_dfm &lt;- dfm_trim(feat_dfm, min_termfreq = 10)</span><span id="8c56" class="ll lm iq lh b gy lr lo l lp lq">model &lt;- textmodel_newsmap(feat_dfm, label_dfm)</span><span id="cdae" class="ll lm iq lh b gy lr lo l lp lq">coefficients &lt;-<br/>  coef(model, n = 10)[c("US", "GB", "FR", "BR", "JP", "RU")]<br/>coefficients &lt;- as.tibble(coefficients)</span><span id="cf9b" class="ll lm iq lh b gy lr lo l lp lq">pred &lt;- predict(model)<br/>head(pred, 20)</span><span id="df23" class="ll lm iq lh b gy lr lo l lp lq">count &lt;-<br/>  sort(table(factor(pred, levels = colnames(label_dfm))), decreasing = TRUE)<br/>head(count, 20)</span><span id="6a1e" class="ll lm iq lh b gy lr lo l lp lq">data_country &lt;- as.data.frame(count, stringsAsFactors = FALSE)<br/>colnames(data_country) &lt;- c("id", "frequency")<br/>data_country &lt;- data_country %&gt;%<br/>  filter(id != "ET")</span><span id="98ca" class="ll lm iq lh b gy lr lo l lp lq">world_map &lt;- map_data(map = "world")<br/>world_map$region &lt;-<br/>  iso.alpha(world_map$region) # convert contry name to ISO code</span><span id="5ac5" class="ll lm iq lh b gy lr lo l lp lq">ggplot(data_country, aes(map_id = id)) +<br/>  geom_map(aes(fill = frequency), map = world_map) +<br/>  expand_limits(x = world_map$long, y = world_map$lat) +<br/>  scale_fill_continuous(name = "Frequency") +<br/>  theme_void() +<br/>  coord_fixed()</span></pre><p id="70f8" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在我们用与国家/地区相关联的附加摘录构建模型之后，我们可以检查它们:</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi mj"><img src="../Images/42021a6ca500f80c4418b759099185b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VFzw7i8RlmnSJqRrCiyxAQ.png"/></div></div></figure><p id="30ef" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">一切都很好，但有些特征很奇怪。俄罗斯的“圣雅克”？让我们看看新闻来源:</p><blockquote class="lz ma mb"><p id="be61" class="ju jv mc jw b jx jy jz ka kb kc kd ke md kg kh ki me kk kl km mf ko kp kq kr ij bi translated">加拿大宇航员大卫·圣·雅克说，他对俄罗斯联盟号火箭助推器比以往任何时候都更有信心</p></blockquote><p id="fbfa" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">好吧，这是可以接受的，现在我们可以做一个预测，并创建一个地图:</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="lc ld di le bf lf"><div class="gh gi mk"><img src="../Images/d40bda1f7bfa872e3116774ac34598e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8OoU3TMXuwm-uo9sZG6Eww.png"/></div></div></figure><p id="7626" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">它看起来非常类似于以前的地图，但有一些例外。我们之前的地图是基于每个国家的新闻总数，而这张地图是基于对新闻中国家引用的预测。较亮的颜色显示一个国家的最大引用排名，我们对美国的排名很突出，对欧洲、中国、澳大利亚和拉丁美洲的排名略低。</p></div><div class="ab cl jn jo hu jp" role="separator"><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js"/></div><div class="ij ik il im in"><p id="1ffd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">看起来很有趣？以下是更多信息:</p><h2 id="11a9" class="ll lm iq bd ml mm mn dn mo mp mq dp mr kf ms mt mu kj mv mw mx kn my mz na nb bi translated"><a class="ae ks" rel="noopener" target="_blank" href="/whats-happened-in-a-world-last-month-world-news-analysis-b7e540d45d64">第一部分——上个月世界发生了什么:世界新闻分析</a></h2><h2 id="d3ab" class="ll lm iq bd ml mm mn dn mo mp mq dp mr kf ms mt mu kj mv mw mx kn my mz na nb bi translated"><a class="ae ks" rel="noopener" target="_blank" href="/youtube-channel-analysis-identifying-influencers-and-haters-8d7a4c0790c7"> <strong class="ak"> Youtube 频道分析:识别影响者和憎恨者</strong> </a></h2></div></div>    
</body>
</html>