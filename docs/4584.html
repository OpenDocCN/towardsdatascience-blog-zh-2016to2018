<html>
<head>
<title>Land use/Land cover classification with Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于深度学习的土地利用/土地覆盖分类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/land-use-land-cover-classification-with-deep-learning-9a5041095ddb?source=collection_archive---------4-----------------------#2018-08-24">https://towardsdatascience.com/land-use-land-cover-classification-with-deep-learning-9a5041095ddb?source=collection_archive---------4-----------------------#2018-08-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/9b6fc7646e3490533337374c1754cf2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*g2kCB-eESXSv0kAC.jpg"/></div></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Land use classes</figcaption></figure><p id="c178" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">在环境监测和许多其他子领域中，识别地球表面的物理方面(土地覆盖)以及我们如何开发土地(土地利用)是一个具有挑战性的问题。这可以通过实地调查或分析卫星图像(遥感)来完成。虽然进行实地调查更加全面和权威，但这是一个昂贵的项目，而且大多需要很长时间来更新。</p><p id="e46f" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">随着最近航天工业的发展和卫星图像(免费和商业)可用性的增加，深度学习和卷积神经网络在土地利用分类方面显示了有希望的结果。</p><p id="5b0c" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">在这个项目中，我使用了免费提供的 Sentinel-2 卫星图像对 9 个土地利用类别和 24000 张带标签的图像进行了分类(图 2)。原始数据集包含 10 个类和 27000 个带标签的图像，可从<a class="ae ld" href="http://madm.dfki.de/downloads" rel="noopener ugc nofollow" target="_blank">这里</a>获得。</p><figure class="le lf lg lh gt ju gh gi paragraph-image"><div class="ab gu cl li"><img src="../Images/d48f80c2baeb365133fae5f7aa7d8cdd.png" data-original-src="https://miro.medium.com/v2/format:webp/1*6uXn-AI5b5dS-_O6l8UPDA.jpeg"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Figure 2— Land use classes</figcaption></figure><p id="708d" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">这里有一些不同土地利用类型的可视化图像。</p><figure class="le lf lg lh gt ju gh gi paragraph-image"><div class="ab gu cl li"><img src="../Images/c0bf49d1a8d0c8d6eede3a30a1d98fa7.png" data-original-src="https://miro.medium.com/v2/format:webp/1*OsWM9eabVyED1wXGRcqoRg.png"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Figure 2- Visualization</figcaption></figure><p id="f13e" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">Sentinel-2 的数据是多光谱的，在可见光、近红外和短波红外光谱中有 13 个波段。这些波段具有不同的空间分辨率，从 10 米到 60 米不等，因此图像可被归类为高-中分辨率。虽然有其他分辨率更高的卫星可用(1 米至 0.5 厘米)，但 Sentinel-2 的数据是免费的，重访时间长(5 天)，这使它成为监测土地利用的最佳选择。</p><figure class="le lf lg lh gt ju gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/54fec52ac771c830185d31b74ba33cfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1050/format:webp/0*DgFhsfqk2mFeolF4.png"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Sentinel-2 Bands, Wavelength, and Resolution</figcaption></figure><h1 id="6596" class="lk ll it bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">数据预处理</h1><p id="9b51" class="pw-post-body-paragraph kf kg it kh b ki mi kk kl km mj ko kp kq mk ks kt ku ml kw kx ky mm la lb lc im bi translated">虽然一些深度学习架构可以将所有 13 个波段作为输入，但有必要对数据进行预处理。这些图像是 TIFF 格式的，我尝试的一些架构不能适应它。我选择使用 GDAL 和 Rasterio，这是我最喜欢的工具，也是我最熟悉的工具，将它们转换成 JPG 格式并选择乐队。gdal_translate 成功了。</p><pre class="le lf lg lh gt mn mo mp mq aw mr bi"><span id="8ef4" class="ms ll it mo b gy mt mu l mv mw">gdal_translate -of GTiff -b 1 -b 10 -b 13 input_sentinel_13_band.tif output_RGB.tif</span></pre><p id="f62f" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">这些是我尝试过的一些乐队组合:</p><ul class=""><li id="6861" class="mx my it kh b ki kj km kn kq mz ku na ky nb lc nc nd ne nf bi translated">所有 13 个乐队</li><li id="540e" class="mx my it kh b ki ng km nh kq ni ku nj ky nk lc nc nd ne nf bi translated">红、绿、蓝(RGB)波段</li><li id="41a4" class="mx my it kh b ki ng km nh kq ni ku nj ky nk lc nc nd ne nf bi translated">短波红外线(SWIR)</li><li id="9453" class="mx my it kh b ki ng km nh kq ni ku nj ky nk lc nc nd ne nf bi translated">高分辨率波段(10-20 米波段)</li><li id="ea1b" class="mx my it kh b ki ng km nh kq ni ku nj ky nk lc nc nd ne nf bi translated">特殊波段组合——遥感领域的知识很有帮助。一些波段组合可以引出农业、植被、水或土地。</li><li id="0570" class="mx my it kh b ki ng km nh kq ni ku nj ky nk lc nc nd ne nf bi translated">使用不同组合的数据增强(即具有特殊波段的 RGB)</li></ul><h1 id="728b" class="lk ll it bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">建模</h1><p id="b656" class="pw-post-body-paragraph kf kg it kh b ki mi kk kl km mj ko kp kq mk ks kt ku ml kw kx ky mm la lb lc im bi translated">我用 Fastai 库的迁移学习(Resnet50)来训练我的模型。感谢 Fastai 团队令人惊叹的深度学习课程，这里使用的技术来自深度学习课程材料。我训练模型的步骤是:</p><ul class=""><li id="064b" class="mx my it kh b ki kj km kn kq mz ku na ky nb lc nc nd ne nf bi translated">训练最后一层</li><li id="06fc" class="mx my it kh b ki ng km nh kq ni ku nj ky nk lc nc nd ne nf bi translated">试试数据扩充</li><li id="1203" class="mx my it kh b ki ng km nh kq ni ku nj ky nk lc nc nd ne nf bi translated">冻结所有层并从头开始重新训练</li></ul><p id="cb48" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">建模中使用的技术包括:学习率查找器、带重启的随机梯度下降和退火。</p><h1 id="adb1" class="lk ll it bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">结果</h1><p id="b828" class="pw-post-body-paragraph kf kg it kh b ki mi kk kl km mj ko kp kq mk ks kt ku ml kw kx ky mm la lb lc im bi translated">正如在预处理部分提到的，我已经试验了不同的波段组合。我的模型的最高精度为 0.94，虽然这低于原始论文中报告的数据集的精度(0.98)，但对于我的项目及其目标来说，这是相对较高的。我所有实验的结果都在下表中(对关键要点的思考部分):</p><pre class="le lf lg lh gt mn mo mp mq aw mr bi"><span id="c94d" class="ms ll it mo b gy mt mu l mv mw">        +------------------------+-----------------------------+<br/>        |   Bands                |   Result(Accuracy)          |     <br/>        +------------------------+-----------------------------+<br/>        | All Bands              |     0.83                    | <br/>        | RGB                    |     0.84                    | <br/>        | High Resolution Bands  |     0.81                    | <br/>        | <strong class="mo iu">Special Bands</strong>          |     <strong class="mo iu">0.94  </strong>                  |  <br/>        | RGB+Special Bands      |     0.80                    |<br/>        +------------------------+-----------------------------+</span></pre><p id="e5fa" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">模型发现难以区分的一些类别是森林和海湖，如混淆矩阵所示(图 3)。仔细观察这两类的图像，人们可以推断，即使是人眼也很难清楚地区分。</p><figure class="le lf lg lh gt ju gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/68d3c5de121722ed73666aedb9570282.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*DMBLVKYIl00bm0AMSuNJrg.png"/></div><figcaption class="kb kc gj gh gi kd ke bd b be z dk">Figure 3 — Confusion Matrix</figcaption></figure><h1 id="a711" class="lk ll it bd lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh bi translated">关键要点:</h1><p id="df95" class="pw-post-body-paragraph kf kg it kh b ki mi kk kl km mj ko kp kq mk ks kt ku ml kw kx ky mm la lb lc im bi translated">波段组合的领域知识有助于改进这一特定模型。我在土地利用/土地覆被分类的深度学习应用中看到的所有文献都使用相同的波段作为所有的类输入(即 RGB 或 SWIR)。我的方法让我提高了将近 10%的准确率。</p><p id="5f53" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">虽然我假设更多的波段肯定会改善我的模型，但我发现事实并非如此。使用所有 13 个波段效果不佳。这可归因于包含了低分辨率波段。但同样，仅使用高分辨率波段的精度最低(0.81)。</p><p id="cf80" class="pw-post-body-paragraph kf kg it kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">另一个实验是通过将 RGB 图像和特殊波段组合添加到同一个文件夹中来增加数据集，从而使可用于训练的图像数量翻倍。这个精度最低(0.80)。笔记本在这里<a class="ae ld" href="https://github.com/shakasom/Deep-Learning-for-Satellite-Imagery/blob/master/LULC_Final.ipynb" rel="noopener ugc nofollow" target="_blank">可用。</a></p></div></div>    
</body>
</html>