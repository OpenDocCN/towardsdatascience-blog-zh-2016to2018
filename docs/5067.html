<html>
<head>
<title>How to create a sequential model in Keras for R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在 Keras 中为 R 创建序列模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-create-a-sequential-model-in-keras-for-r-1437aaf778e2?source=collection_archive---------14-----------------------#2018-09-25">https://towardsdatascience.com/how-to-create-a-sequential-model-in-keras-for-r-1437aaf778e2?source=collection_archive---------14-----------------------#2018-09-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="fc74" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">TL；dr:本教程将介绍 Keras 的深度学习分类任务。我们将特别关注数组的形状，这是最常见的陷阱之一。</p><p id="fffb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将讨论的主题有:</p><ul class=""><li id="4e9d" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">如何进行一键编码</li><li id="79cc" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">选择层中的输入和输出形状/尺寸</li><li id="ccf5" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">如何训练模型</li><li id="0bc2" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">如何评估模型(培训与测试)</li></ul><p id="e2b0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以在 Github 上找到<a class="ae kz" href="https://github.com/pablo14/Keras-R-tutorials/blob/master/keras_sequential_model.R" rel="noopener ugc nofollow" target="_blank">这个教程的完整代码👇</a></p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi la"><img src="../Images/6014b80babba9514c4f1dc21ed691477.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*JND_ryB2DGSKhUTk.gif"/></div></div></figure><h1 id="a56f" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">创建数据</h1><p id="5610" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">输入数据将是来自均匀分布的 10000 行和 3 列。</p><h1 id="297e" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">创建数据</h1><p id="763b" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">输入数据将是来自均匀分布的 10000 行和 3 列。</p><p id="46d2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该模型将识别出这三个数字的总和高于阈值<code class="fe mp mq mr ms b">1.5</code>，否则将为 0。</p><pre class="lb lc ld le gt mt ms mu mv aw mw bi"><span id="91c6" class="mx ln iq ms b gy my mz l na nb"># Input: 10000 rows and 3 columns of uniform distribution<br/>x_data=matrix(data=runif(30000), nrow=10000, ncol=3)</span><span id="e275" class="mx ln iq ms b gy nc mz l na nb"># Output<br/>y_data=ifelse(rowSums(x_data) &gt; 1.5, 1, 0)</span><span id="08ca" class="mx ln iq ms b gy nc mz l na nb">head(x_data)</span><span id="fa41" class="mx ln iq ms b gy nc mz l na nb">##            [,1]      [,2]      [,3]<br/>## [1,] 0.49224109 0.6096538 0.7855929<br/>## [2,] 0.56710301 0.8707570 0.3428543<br/>## [3,] 0.08246592 0.7504529 0.6979251<br/>## [4,] 0.79197829 0.6330420 0.7307403<br/>## [5,] 0.65170373 0.9052915 0.1395298<br/>## [6,] 0.23479406 0.2611791 0.2780037</span><span id="ceab" class="mx ln iq ms b gy nc mz l na nb">head(y_data)</span><span id="8d2e" class="mx ln iq ms b gy nc mz l na nb">## [1] 1 1 1 1 1 0</span></pre><h1 id="35f8" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">安装/加载 Keras</h1><pre class="lb lc ld le gt mt ms mu mv aw mw bi"><span id="6624" class="mx ln iq ms b gy my mz l na nb"># install.packages("keras")<br/>library(keras)<br/>library(tidyverse)</span></pre><h1 id="6cc1" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">Keras 中的一键编码</h1><p id="3889" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">深度学习的一个关键点是理解模型需要的向量、矩阵和/或数组的维数。我发现这些都是 Keras 支持的类型。</p><p id="10e7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">用 Python 的话说，就是数组的形状。</p><p id="6217" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了完成二进制分类任务，我们将创建一个单热点向量。对于 2 个以上的类，它以相同的方式工作。</p><p id="f4a0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如:</p><ul class=""><li id="d795" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">值<code class="fe mp mq mr ms b">1</code>将是矢量<code class="fe mp mq mr ms b">[0,1]</code></li><li id="e070" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">值<code class="fe mp mq mr ms b">0</code>将是矢量<code class="fe mp mq mr ms b">[1,0]</code></li></ul><p id="2c73" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Keras 提供了<code class="fe mp mq mr ms b">to_categorical</code>函数来实现这个目标。</p><pre class="lb lc ld le gt mt ms mu mv aw mw bi"><span id="ee53" class="mx ln iq ms b gy my mz l na nb">y_data_oneh=to_categorical(y_data, num_classes = 2)</span><span id="447d" class="mx ln iq ms b gy nc mz l na nb">head(y_data_oneh)</span><span id="a556" class="mx ln iq ms b gy nc mz l na nb">##      [,1] [,2]<br/>## [1,]    0    1<br/>## [2,]    0    1<br/>## [3,]    0    1<br/>## [4,]    0    1<br/>## [5,]    0    1<br/>## [6,]    1    0</span></pre><p id="6c25" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">很容易得到分类变量，如:“是/否”、“CatA、CatB、CatC”等。但是<code class="fe mp mq mr ms b">to_categorical</code>不接受非数值作为输入。我们需要首先转换它们。</p><p id="3ef0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mp mq mr ms b">num_classes</code>是创建矢量长度所必需的。</p><p id="99da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mp mq mr ms b">to_categorical</code>的替代品:</p><ul class=""><li id="489c" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">包<code class="fe mp mq mr ms b">CatEncoders</code>，<a class="ae kz" href="https://cran.r-project.org/web/packages/CatEncoders/CatEncoders.pdf" rel="noopener ugc nofollow" target="_blank"> OneHotEncoder </a>(同 Python <code class="fe mp mq mr ms b">scikit-learn</code>)。</li><li id="6bbc" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">封装<code class="fe mp mq mr ms b">caret</code>，功能<a class="ae kz" href="https://amunategui.github.io/dummyVar-Walkthrough/" rel="noopener ugc nofollow" target="_blank"> dummyVars </a>。</li></ul><p id="2937" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意:我们不需要转换<strong class="jp ir">输入变量</strong>，因为它们是数值。</p><h1 id="ef71" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">在 Keras 中创建顺序模型</h1><p id="500b" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">Keras 中最简单的模型是<strong class="jp ir">序列</strong>，它是通过顺序堆叠层而构建的。</p><p id="a320" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在下一个示例中，我们堆叠了三个密集图层，keras 使用 input_shape 参数用您的数据构建了一个隐式输入图层。因此，我们总共有一个输入层和一个输出层。</p><pre class="lb lc ld le gt mt ms mu mv aw mw bi"><span id="75e1" class="mx ln iq ms b gy my mz l na nb">model = keras_model_sequential() %&gt;%   <br/>  layer_dense(units = 64, activation = "relu", input_shape = ncol(x_data)) %&gt;%<br/>  layer_dense(units = 64, activation = "relu") %&gt;%<br/>  layer_dense(units = ncol(y_data_oneh), activation = "softmax")</span></pre><p id="47ec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">目前最重要的参数是:</p><ul class=""><li id="6c16" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">在第一层中，<code class="fe mp mq mr ms b">input_shape</code>代表一个值为 3 ( <code class="fe mp mq mr ms b">ncol(x_data)</code>)的向量，表示输入变量的数量。在深度学习中，几乎所有东西都是向量(或张量)。</li><li id="2528" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">第二层没有<code class="fe mp mq mr ms b">input_shape</code>，因为 Keras 是从前一层推断出来的。</li><li id="8949" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">第三个<code class="fe mp mq mr ms b">layer_dense</code>，代表最终输出，有 2 个(<code class="fe mp mq mr ms b">ncol(y_data_oneh)</code>)单位代表两种可能的结果。</li></ul><p id="fe7d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以检查每个图层的模型和形状:</p><pre class="lb lc ld le gt mt ms mu mv aw mw bi"><span id="ea07" class="mx ln iq ms b gy my mz l na nb">model</span><span id="2ee3" class="mx ln iq ms b gy nc mz l na nb">## Model<br/>## ___________________________________________________________________________<br/>## Layer (type)                     Output Shape                  Param #     <br/>## ===========================================================================<br/>## dense_28 (Dense)                 (None, 64)                    256         <br/>## ___________________________________________________________________________<br/>## dense_29 (Dense)                 (None, 64)                    4160        <br/>## ___________________________________________________________________________<br/>## dense_30 (Dense)                 (None, 2)                     130         <br/>## ===========================================================================<br/>## Total params: 4,546<br/>## Trainable params: 4,546<br/>## Non-trainable params: 0<br/>## ___________________________________________________________________________</span></pre><p id="6b38" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在是时候定义损失和优化器函数，以及要优化的指标了。</p><p id="7510" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">虽然它说的是“准确性”，但 keras 识别输出的性质(分类)，并在后端使用<code class="fe mp mq mr ms b">categorical_accuracy</code>。</p><pre class="lb lc ld le gt mt ms mu mv aw mw bi"><span id="8d01" class="mx ln iq ms b gy my mz l na nb">compile(model, loss = "categorical_crossentropy", optimizer = optimizer_rmsprop(), metrics = "accuracy")</span></pre><p id="113a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们来拟合(训练)模型:</p><pre class="lb lc ld le gt mt ms mu mv aw mw bi"><span id="a148" class="mx ln iq ms b gy my mz l na nb">history = fit(model,  x_data, y_data_oneh, epochs = 20, batch_size = 128, validation_split = 0.2)</span></pre><figure class="lb lc ld le gt lf gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/e3fd0a09392b8efabbf144219aca55c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/1*WTwrb2LTuPlURDoCP3oHug.gif"/></div></figure><p id="3c6a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">搞定了。</p><p id="b41e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">绘图结果:</p><pre class="lb lc ld le gt mt ms mu mv aw mw bi"><span id="ad61" class="mx ln iq ms b gy my mz l na nb">plot(history)</span></pre><figure class="lb lc ld le gt lf gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/58257ed6a602b2d25ede8c333af309e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*fw2CCSvOCEZCavrdrxvStA.png"/></div><figcaption class="nf ng gj gh gi nh ni bd b be z dk">Keras results in ggplot2</figcaption></figure><h1 id="5545" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">用看不见的数据验证</h1><p id="0b31" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">创建“看不见的”输入测试数据(1000 行，3 列):</p><pre class="lb lc ld le gt mt ms mu mv aw mw bi"><span id="cb04" class="mx ln iq ms b gy my mz l na nb">x_data_test=matrix(data=runif(3000), nrow=1000, ncol=3)<br/>dim(x_data_test)</span><span id="a193" class="mx ln iq ms b gy nc mz l na nb">## [1] 1000    3</span></pre><p id="37bc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">预测新病例:</p><pre class="lb lc ld le gt mt ms mu mv aw mw bi"><span id="2eeb" class="mx ln iq ms b gy my mz l na nb">y_data_pred=predict_classes(model, x_data_test)</span><span id="02c1" class="mx ln iq ms b gy nc mz l na nb">glimpse(y_data_pred)</span><span id="3f7a" class="mx ln iq ms b gy nc mz l na nb">##  num [1:1000(1d)] 0 0 1 1 1 1 0 1 0 1 ...</span></pre><p id="4e3f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请注意，维度是 1000 行和 2 列。<code class="fe mp mq mr ms b">predict_classes</code>自动执行一键解码。</p><p id="cf5d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">相反，<code class="fe mp mq mr ms b">predict</code>返回训练时收到的相同维度(n 行，n 类预测)。</p><pre class="lb lc ld le gt mt ms mu mv aw mw bi"><span id="08e8" class="mx ln iq ms b gy my mz l na nb">y_data_pred_oneh=predict(model, x_data_test)</span><span id="8ae4" class="mx ln iq ms b gy nc mz l na nb">dim(y_data_pred_oneh)</span><span id="1cd7" class="mx ln iq ms b gy nc mz l na nb">## [1] 1000    2</span><span id="05ff" class="mx ln iq ms b gy nc mz l na nb">head(y_data_pred_oneh)</span><span id="ba9d" class="mx ln iq ms b gy nc mz l na nb">##                     [,1]              [,2]<br/>## [1,] 0.99207872152328491 0.007921278476715<br/>## [2,] 1.00000000000000000 0.000000001157425<br/>## [3,] 0.00000002739444227 1.000000000000000<br/>## [4,] 0.41273152828216553 0.587268412113190<br/>## [5,] 0.03470309823751450 0.965296924114227<br/>## [6,] 0.00000000007147296 1.000000000000000</span></pre><p id="a9fd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在分类中，总是建议返回每个类别的概率，就像我们对<code class="fe mp mq mr ms b">predict</code>所做的那样(行和为 1)。更多信息请访问:<a class="ae kz" href="https://livebook.datascienceheroes.com/model-performance.html#scoring_data" rel="noopener ugc nofollow" target="_blank"> DSLB -得分数据</a>。</p><h1 id="2718" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">softmax 激活</h1><p id="f5f8" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">多亏了最后一层的<code class="fe mp mq mr ms b">activation = "softmax"</code>,我们得到了概率。</p><p id="ab39" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于每个类，softmax 的输出范围从 0 到 1，所有类的总和自然是 1。</p><h1 id="1aca" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">评估模型(培训与测试)</h1><p id="4d57" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">创建“真实”y 目标，与预测目标进行比较:</p><pre class="lb lc ld le gt mt ms mu mv aw mw bi"><span id="d312" class="mx ln iq ms b gy my mz l na nb">y_data_real=ifelse(rowSums(x_data_test) &gt; 1.5, 1, 0)<br/>y_data_real_oneh=to_categorical(y_data_real)</span><span id="5e56" class="mx ln iq ms b gy nc mz l na nb">## Training data<br/>evaluate(model, x_data, y_data_oneh, verbose = 0)</span><span id="4dd1" class="mx ln iq ms b gy nc mz l na nb">## $loss<br/>## [1] 0.03008356<br/>## <br/>## $acc<br/>## [1] 0.9918</span><span id="d570" class="mx ln iq ms b gy nc mz l na nb">## Test data (we need the one-hot version)<br/>evaluate(model, x_data_test, y_data_real_oneh, verbose = 0)</span><span id="b72b" class="mx ln iq ms b gy nc mz l na nb">## $loss<br/>## [1] 0.03146484<br/>## <br/>## $acc<br/>## [1] 0.991</span></pre><p id="84e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">看不见的数据的精度几乎是完美的:大约在<code class="fe mp mq mr ms b">1</code>(以及接近 0 的损失，这比精度更重要)。</p><p id="193a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">神经网络学习了我们一开始定义的模式🎉！</p><figure class="lb lc ld le gt lf gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/713ed617989690b5b66fa33f497ba638.png" data-original-src="https://miro.medium.com/v2/resize:fit:852/1*DN6ac4WjjCBY8mLcrkeaiQ.gif"/></div></figure><h1 id="3223" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">一些问题🤔</h1><p id="1cc4" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated"><em class="nk">需要多少层？</em>我们尝试了 3，但是 4 怎么样？它将学习同样的东西，但是需要更多的时间。但是在其他情况下，性能会提高。这取决于每个案例。</p><p id="aba2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="nk">每层需要多少个神经元？</em>和以前一样的推理。我们应该期望用最简单的网络获得最大的精度。倾向于进行良好的标准拟合的一种方法是从具有(即)128 个神经元的层开始。然后加一层 64，另一层 16。模式是减少每层神经元的数量。</p><h1 id="babc" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">你自己试试🙌</h1><p id="362b" class="pw-post-body-paragraph jn jo iq jp b jq mk js jt ju ml jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">阅读只是学习的一个很小的部分，你可以自己尝试，比如改变我们使用的函数(我们尝试了<code class="fe mp mq mr ms b">y &gt; 1.5 = 1</code>)并让网络来学习它。</p><p id="d8bc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过编码学习，并暴露你的实践中的错误🙂</p><h1 id="bd6b" class="lm ln iq bd lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj bi translated">进一步阅读</h1><ul class=""><li id="5636" class="kl km iq jp b jq mk ju ml jy nl kc nm kg nn kk kq kr ks kt bi translated"><a class="ae kz" href="https://keras.rstudio.com/articles/sequential_model.html" rel="noopener ugc nofollow" target="_blank">系列车型指南</a>(来自 Rstudio)</li><li id="c097" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated"><a class="ae kz" href="https://blog.rstudio.com/2018/09/12/getting-started-with-deep-learning-in-r" rel="noopener ugc nofollow" target="_blank">R 中深度学习入门</a>(来自 Rstudio)</li><li id="1871" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated"><a class="ae kz" href="https://blog.datascienceheroes.com/sample-size-and-class-balance-on-model-performance" rel="noopener ugc nofollow" target="_blank">样本大小和类别对模型性能的平衡</a>(底层模型是用 Keras 构建的)</li></ul></div><div class="ab cl no np hu nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ij ik il im in"><p id="d4a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="nk">本帖最初发布于:</em><a class="ae kz" href="https://blog.datascienceheroes.com/how-to-create-a-sequential-model-in-keras-for-r/" rel="noopener ugc nofollow" target="_blank"><em class="nk">https://blog . datascienceheroes . com/how-to-create-a-sequential-model-in-keras-for-r/</em></a></p><p id="7fa4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有什么问题吗？把它们留在下面📩</p><p id="7770" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">感谢</strong>阅读！🚀</p><p id="4854" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">📗<a class="ae kz" href="http://livebook.datascienceheroes.com/" rel="noopener ugc nofollow" target="_blank">数据科学 Live Book </a> —学习机器学习的在线书籍</p><p id="2821" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kz" href="https://blog.datascienceheroes.com/how-to-create-a-sequential-model-in-keras-for-r/blog.datascienceheroes.com" rel="noopener ugc nofollow" target="_blank">更多数据故事:博客</a>|<a class="ae kz" href="https://www.linkedin.com/in/pcasas/" rel="noopener ugc nofollow" target="_blank">Linkedin</a>|<a class="ae kz" href="https://twitter.com/pabloc_ds" rel="noopener ugc nofollow" target="_blank">Twitter</a></p></div></div>    
</body>
</html>