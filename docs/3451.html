<html>
<head>
<title>3 Small But Powerful Convolutional Networks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">3 个小而强大的卷积网络</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/3-small-but-powerful-convolutional-networks-27ef86faa42d?source=collection_archive---------2-----------------------#2018-05-13">https://towardsdatascience.com/3-small-but-powerful-convolutional-networks-27ef86faa42d?source=collection_archive---------2-----------------------#2018-05-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="2bc3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了在 ImageNet 上获得最佳精度，已经开发了许多 CNN 架构。计算能力不限这个比赛，何苦呢？</p><p id="6db4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然而，您可能希望在旧的笔记本电脑上运行您的模型，可能没有 GPU，甚至在您的移动电话上。让我们看看三种 CNN 架构，它们效率很高，但精度性能却很低。</p></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><h1 id="3d4f" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">MobileNet</h1><p id="d91a" class="pw-post-body-paragraph jn jo iq jp b jq lq js jt ju lr jw jx jy ls ka kb kc lt ke kf kg lu ki kj kk ij bi translated">Arxiv 链接:<a class="ae lv" href="https://arxiv.org/abs/1704.04861" rel="noopener ugc nofollow" target="_blank">(霍华德等人，2017) </a></p><p id="e4a0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">MobileNet 使用<strong class="jp ir">深度方向可分离</strong>T4 卷积。这个卷积块最初由<a class="ae lv" href="https://arxiv.org/abs/1610.02357" rel="noopener ugc nofollow" target="_blank">异常</a>引入。深度方向可分离卷积由两种运算组成:深度方向卷积和点方向卷积。</p><p id="ce1a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">标准卷积</strong>作用于特征图的空间维度以及输入和输出通道。它的计算成本为<strong class="jp ir">Df * M * N * Dk</strong>；Df 表示输入特征映射的维数，M 和 N 表示输入和输出通道的数量，Dk 表示内核大小。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi lw"><img src="../Images/b4ed04aced716563ec4b093720111860.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZbeQ1-KHpegpYbz7ODXZYw.png"/></div></div></figure><p id="e785" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">深度方向卷积</strong>分别在每个输入通道上映射一个卷积。因此它的输出通道数与输入通道数相同。It 计算成本为<strong class="jp ir"> Df * M * Dk </strong>。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mi"><img src="../Images/6f01b0ffd1b5369e9684b5bd8134b430.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LVyPaSrFFKkjmktzH1cYzg.png"/></div></div></figure><p id="3162" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后一个操作是<strong class="jp ir">逐点卷积</strong>。这是一个核大小为 1×1 的卷积，它简单地组合了由深度方向卷积创建的特征。It 计算成本为<strong class="jp ir"> M * N * Df </strong>。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mj"><img src="../Images/744ab759658a5e87ae3ab08f1cc6befb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KiirgK6_dilzs8-muumnIw.png"/></div></div></figure><p id="a394" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">深度方向可分离卷积的计算成本是深度方向和点方向操作的成本之和。与普通卷积相比，它提供了<strong class="jp ir"> 1/N + 1/Dk </strong>的计算减少。内核大小为 3x3 时，操作次数减少了 8 倍！</p><p id="28ab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">MobileNet 还提供了两个参数，允许进一步减少其操作数量:<strong class="jp ir">宽度乘数</strong>(在 0 和 1 之间)减少通道数量。在每一层，不是产生 N 个通道，而是产生 alpha * N。该乘数可用于处理所需延迟和性能之间的权衡。另一个乘数存在:分辨率乘数<strong class="jp ir"/>。它缩放图像的输入大小，在 224 到 128 之间。因为 MobileNet 使用全局平均池而不是 flatten，所以您可以在 224x224 图像上训练您的 MobileNet，然后在 128x128 图像上使用它！事实上，对于全局池，网络末端的全连接分类器仅取决于通道的数量，而不是特征映射的空间维度。</p></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><h1 id="1ecb" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">沙狐球网</h1><p id="bd5e" class="pw-post-body-paragraph jn jo iq jp b jq lq js jt ju lr jw jx jy ls ka kb kc lt ke kf kg lu ki kj kk ij bi translated">Arxiv 链接:<a class="ae lv" href="https://arxiv.org/abs/1707.01083" rel="noopener ugc nofollow" target="_blank">(张等，2017) </a></p><p id="94ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ShuffleNet 引入了三种不同的随机单元。由<strong class="jp ir">组卷积</strong>和<strong class="jp ir">信道洗牌</strong>组成。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mk"><img src="../Images/a9fc973e5880a64c9ca549c39806333b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SHyel9_UZuy3C5799vL86g.png"/></div></div></figure><p id="f710" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一个<strong class="jp ir">组卷积</strong>就是几个卷积，每个卷积取输入通道的一部分。在下图中，您可以看到一个组卷积，有 3 个组，每个组取 3 个输入通道中的一个。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/d95b0dc479c82c4e738c9e471822a06b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/1*Du6kevcjT2Gj1w55xYFymQ.png"/></div></figure><p id="7712" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">AlexNet <a class="ae lv" href="https://papers.nips.cc/paper/4824-imagenet-classification-with-deep-convolutional-neural-networks" rel="noopener ugc nofollow" target="_blank"> (Krizhevsky et al，2012) </a>首先提出将一个网络分成两个 GPU。</p><p id="9623" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这大大减少了计算成本。让我们举一个可行的例子:如果有 4 个输入通道和 8 个输出通道，我们选择两组，每组有 2 个输入通道和 4 个输出通道。</p><p id="722d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于一个组，计算成本将是<strong class="jp ir"> Df * Dk * 4 * 8 </strong>，而对于两个组，成本是(Df * Dk * 2 * 4) * 2 或<strong class="jp ir"> Df * Dk * 4 * 4 </strong>。一半的手术！作者用 8 组达到了最好的结果，因此减少甚至更重要。</p><p id="5f1b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，作者添加了一个<strong class="jp ir">通道混洗</strong>，随机混合组卷积的输出通道。产生这种随机性的诀窍可以在<a class="ae lv" href="https://github.com/arthurdouillard/keras-shufflenet/blob/master/shufflenet.py#L37-L48" rel="noopener ugc nofollow" target="_blank">这里</a>看到。</p></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><h1 id="34ba" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">EffNet</h1><p id="4a99" class="pw-post-body-paragraph jn jo iq jp b jq lq js jt ju lr jw jx jy ls ka kb kc lt ke kf kg lu ki kj kk ij bi translated">Arxiv 链接:<a class="ae lv" href="https://arxiv.org/abs/1801.06434" rel="noopener ugc nofollow" target="_blank"> (Freeman 等，2018) </a></p><p id="a0b8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">EffNet 使用<strong class="jp ir">空间可分离卷积</strong>。它非常类似于 MobileNet 的深度方向可分卷积。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mm"><img src="../Images/0ee928898b0321b454496d22eb0d4066.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kgQt2D0U_Uuw69tE6o3-ig.png"/></div></div></figure><p id="ed0a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">可分离的深度方向卷积是 EffNet 块的蓝色矩形。它由与行核(1x3)的深度方向卷积组成，随后是可分离池，最后是与列核(3x1)的深度方向卷积。</p><p id="394b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们看看计算增益。使用 3x3 内核的正常深度方向的成本为 3 * Df * M。使用 1x3 内核的第一个深度方向的计算成本为 3 * Df * M。可分离池将特征映射高度减半，具有边际成本。具有 3×1 内核的第二深度方向的成本为 3 * Df /2 * M。因此，总成本为<strong class="jp ir"> 1.5 * (3 * Df * M) </strong>。比正常深度少一半！</p><p id="1443" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">EffNet 相对于 MobileNet 和 ShuffleNet 所做的另一项优化是在开始时没有“正常卷积”:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mn"><img src="../Images/ffabd24c4a3d22625feabf594146497b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wJHTHDO8-r-RMUJgB0gsSA.png"/></div></div></figure><p id="eb00" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">引用作者的话:</p><blockquote class="mo mp mq"><p id="4106" class="jn jo mr jp b jq jr js jt ju jv jw jx ms jz ka kb mt kd ke kf mu kh ki kj kk ij bi translated">MobileNet 和 ShuffleNet 都避免替换第一层，声称这一层已经相当便宜了。我们恭敬地不同意这种说法，并认为每一次优化都是有价值的。在优化了网络中的其余层之后，第一层成比例地变大。在我们的实验中，<strong class="jp ir">用我们的 EffNet 块替换第一层为相应的层</strong>节省了 30%的计算。</p></blockquote></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><h1 id="285f" class="ks kt iq bd ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp bi translated">TL；速度三角形定位法(dead reckoning)</h1><p id="5a79" class="pw-post-body-paragraph jn jo iq jp b jq lq js jt ju lr jw jx jy ls ka kb kc lt ke kf kg lu ki kj kk ij bi translated">MobileNet、ShuffleNet 和 EffNet 是 CNN 架构，旨在优化操作数量。每个人都用自己的版本取代了经典卷积。</p><p id="b1e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> MobileNet </strong> ( <a class="ae lv" href="https://github.com/arthurdouillard/keras-mobilenet" rel="noopener ugc nofollow" target="_blank"> github </a>)深度方向可分离卷积使用深度方向卷积，后跟点方向卷积。此外，它还引入了两个超参数:减少通道数量的宽度乘数和减少特征映射空间维度的分辨率乘数。</p><p id="84aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">shuffle net</strong>(<a class="ae lv" href="https://github.com/arthurdouillard/keras-shufflenet" rel="noopener ugc nofollow" target="_blank">github</a>)分组使用逐点卷积。为了组合每个组产生的特征，还引入了洗牌层。</p><p id="e4b8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，<strong class="jp ir">EffNet</strong>(<a class="ae lv" href="https://github.com/arthurdouillard/keras-effnet" rel="noopener ugc nofollow" target="_blank">github</a>)使用空间可分离卷积，它只是沿 x 和 y 轴分离的深度方向卷积，它们之间有一个可分离池。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/b87489814a72f0a91192d56a5c8a5269.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*969RyOFq7uEtlcxeLuRryQ.png"/></div><figcaption class="mw mx gj gh gi my mz bd b be z dk">Benchmark on CIFAR 10</figcaption></figure><p id="d0de" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这篇文章已经被翻译成中文了！<a class="ae lv" href="https://yq.aliyun.com/articles/592935" rel="noopener ugc nofollow" target="_blank">此处</a>。</p></div></div>    
</body>
</html>