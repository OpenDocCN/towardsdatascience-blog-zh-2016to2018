# numpy——Python 变得高效

> 原文：<https://towardsdatascience.com/numpy-python-made-efficient-f82a2d84b6f7?source=collection_archive---------9----------------------->

![](img/707bd6a3a451f08db8805691d32ddeed.png)

“person holding sticky note” by [Hitesh Choudhary](https://unsplash.com/@hiteshchoudhary?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

几天前，我的一个朋友问我他如何使用 *git 命令*来更改提交消息的名称。因为我已经在我的一篇文章中记录了同样的内容，所以我能够指引他去那里，他也能够自己做出必要的改变。就在那时，我意识到我的工作不仅帮助了未来的自己，也帮助了我的朋友和同事。因此，我决定记录下我将学到的任何新东西，因为它可能也会指导其他人。

在本文中，我将介绍 Numpy 的基础知识以及我最近了解到的一些策略。我将每个`print()`语句的输出作为注释包含在 Github gist 语句的后面。整个项目也可以作为[理解 Numpy](https://github.com/kb22/Understanding-Numpy) 库。

# **Numpy(数字 Python)**

几天前，当我研究机器学习时，我开始使用 Python 的 Numpy 库。在看过如此多的视频系列和文件后，我确信它的巨大潜力和它带来的计算效率。

对于数据密集型计算，Numpy 为我们提供了广泛的方法，使 Python 中的数据操作变得非常快速和简单。虽然在循环过程中，Python 的执行速度比 Fortran 等其他语言慢，但 Numpy 通过将重复代码转换为编译形式来加快 Python 的操作。

> NumPy 是使用 Python 进行科学计算的基础包。— [数量](http://www.numpy.org/)

这确实是真的。它提供了大量的选项，并且人们可以用简单的语句做大量的事情，这是非常了不起的。

```
import numpy as np
```

首先，我首先使用 Python 的 import 语句导入 Numpy。我把它命名为`np`,这样我就不用每次使用它的一个函数时都写`numpy`。这是导入库时遵循的一般惯例。

# 数字阵列

Numpy 数组非常类似于 Python 列表，但有一个特殊条件，即它的所有元素都必须是同一类型。我们使用函数`array()`在 numpy 中定义一个数组。它接受第一个参数作为数组，第二个参数作为元素类型，例如 *int* 、 *float* 等。在这个例子中，我们定义了一个包含 int (integer)类型的元素 1、2、3 和 4 的数组。

我们可以索引元素。numpy 数组中的 Index 也是从 0 开始的，所以`integerArray[0]`指的是第一个为 1 的元素。我们也可以定义一个范围，比如`[:2]`，它打印从 0 到 1 的所有值。创建这样一个数组非常有用，因为它有巨大的潜力，就像简单地检查数组中的一个元素一样`2 in integerArray`返回`True`。

此外，我们可以使用`concatenate()`函数连接两个 numpy 数组。创建不同的数组也变得非常容易。我们可以使用函数`zeros()`创建任意给定大小的 0 数组，使用`ones()`创建任意给定大小的 1 数组，并通过定义一个`range()`而不是实际的 Python 列表来创建一个随机数数组。每个函数还接受第二个参数作为可选的元素类型。

## 多维数组

我们可以使用 numpy 库在 Python 中定义多维数组。只需将完整的数组集定义为数组字段的第一个参数。在上面的例子中，我们创建了一个二维数组(矩阵)。使用`reshape()`函数可以将一维数组转换成二维数组，反之亦然。

`concatenate()`函数也适用于 numpy 中的多维数组。默认情况下，连接发生在第一维上。然而，我们也可以使用`axis`参数定义串联轴。对于表示为`matrix[row][column]`的矩阵，我们可以通过使用`axis = 0`连接行或使用`axis = 1`连接列来连接。

## Numpy 数组操作

我们可以在 numpy 数组上应用多种操作。

Numpy 重载了所有的基本函数，以便它们可以对数组进行操作，例如加号运算符`+`、乘号运算符`*`等。都是为数组重载的。平方根和对数等特殊函数也是可用的。这些操作是按元素进行的，因此当与多个数组交互时，它们必须都具有相同的形状。还有许多其他可能的操作，如`exp`、`sin`、`cos`、`tan`和`abs`。我们还可以`sort()`，找到`min()`和`max()`，确定`unique()`值，矩阵的`diagonal()`元素和`sort()`元素。如果我们在 min 或 max 前面加上`arg`，也可以得到数组中最小值或最大值的索引。

## 比较数组

numpy 数组也可以进行元素比较。这些函数返回布尔值，可以再次用于从结果为真的数组中提取值。

## 向量和矩阵运算

上面提到的所有函数都非常有用，并导致了使用向量和矩阵的更大目标。所有函数都处理向量和矩阵，使我们能够将 Numpy 用于统计和机器学习应用。

这个清单并没有到此为止。numpy 库中内置了最重要的函数，如`dot()`和`cross()`矩阵运算。令人惊讶的是，我们也可以计算`outer()`和`inner()`。

## 随机阵列

使用 numpy，很容易定义随机数组和随机矩阵。

`np.random`使我们能够定义随机数组。如果自变量包括单个整数，例如上面示例中的`5`，函数`rand()`定义一个随机数组；如果自变量是整数的组合，例如上面矩阵示例中的`(5,4)`，函数`rand()`定义一个随机矩阵。这个函数返回 0 到 1 范围内的值，但是如果我们想要整数，我们应该使用`randint()`。它将第一个参数作为起始值，第二个参数作为结束值，第三个参数作为数组的形状。

# 数字策略

![](img/afee1f59facc3e1608fdd4dd1017bdf6.png)

“four person fist bumping” by [rawpixel](https://unsplash.com/@rawpixel?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

我们现在非常熟悉 numpy 数组以及可以在其上执行的无限功能。在部署这些功能时，我们使用了一些固有的策略，包括:

1.  通用函数
2.  聚集
3.  广播
4.  切片、蒙版和花式索引

我们已经在上面的例子中使用了它们，但是现在我们可以明确地定义和区分它们。我在 PyCon 2015 youtube 视频中发现了这些关于[丢失循环](https://www.youtube.com/watch?v=EEUXKG97YRw)的策略。

## 通用函数

这些函数被定义为对数组元素进行元素操作的函数，不管它是一个单维数组还是多维数组。

上面的例子使用通用函数将数组`arr`的每个元素乘以 10，生成一个新的数组。

## 聚合函数

当我们希望总结数组中包含的信息时，这些函数非常有用。

上面的例子显示了我们如何使用`std()`函数来计算数组元素的标准偏差，它大约是`2.87`。

## 广播

这些是通用函数如何在 numpy 数组上操作的一组规则。

在上面的例子中，我们看到一方面我们有一个矩阵`mat`，另一方面我们有一个数组`arr`。在添加这两个时，broadcasting 复制数组两次(理解为用两行创建一个临时矩阵作为`[1,1,1]`)并添加这两个，这是可能的，因为它们现在具有相同的维度并产生结果。

## 切片、蒙版和花式索引

最后一个策略也包含了一些技巧。

我们可以使用一系列索引来索引数组，例如上面示例中的`0 to 4`。当我们将值设置为`[:5]`时，它从索引`0`的开头开始读取，直到比索引`4`的结尾小 1。

屏蔽使我们能够使用运算符来获得满足条件的数组中每个元素的布尔答案。如果条件满足，返回值为`True`，否则为`False`。例如，在上面的例子中，当我们定义掩码`bigArray > 6 | bigArray < 3`时，我们得到掩码为`[True True True False False False False True True True]`。然后，我们可以使用它来定义要在`bigArray`数组中读取的值，并获得输出。

花式索引是指我们定义一个索引列表，然后用它来获取`bigArray`数组的元素。

最后，我们可以将它们结合起来。在上面的最后一个例子中，我们首先选择值大于 6 的所有值，因此我们得到布尔值`[False False False False False False False True True True]`，它通过`bigArray[bigArray > 6]`返回`[7,8,9]`，我们从中选择第一个元素，从而得到输出`[7]`。

# 结论

本文详细介绍了什么是 Numpy 数组及其众多的功能和策略。理解 Numpy 有助于我们理解基于它的许多其他库，例如 Sklearn。

希望你喜欢我的作品。请分享、评论和表达你的想法和观点。