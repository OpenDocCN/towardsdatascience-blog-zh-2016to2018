<html>
<head>
<title>On-premise (DIY) vs Cloud GPU</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">内部部署(DIY)与云 GPU</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/on-premise-diy-vs-cloud-gpu-d5280320d53d?source=collection_archive---------3-----------------------#2017-09-05">https://towardsdatascience.com/on-premise-diy-vs-cloud-gpu-d5280320d53d?source=collection_archive---------3-----------------------#2017-09-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/47e056a32ff7654f7666600fcc4c0456.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ew1FgyeFoVNWibp3gpC6EQ.png"/></div></figure><p id="8c1a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">早些时候，我的第一个故事在 CPU 和 GPU 之间做了一个非常简单的比较，对于这个故事，我将在速度和价格比较方面对 DIY GPU 和 cloud one 进行更多的比较。</p><p id="7420" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">目前我将介绍<a class="ae ks" href="https://aws.amazon.com/ec2/elastic-gpus/" rel="noopener ugc nofollow" target="_blank">亚马逊</a>和<a class="ae ks" href="https://blogs.nvidia.com/blog/2016/01/21/alicloud-artificial-intelligence-gpu/" rel="noopener ugc nofollow" target="_blank">阿里云</a>，亚马逊使用的是<a class="ae ks" href="http://www.nvidia.com/object/tesla-k80.html" rel="noopener ugc nofollow" target="_blank"> NVIDIA K80 </a>和实例类型<strong class="jw ir"> p2.xlarge </strong>，而阿里云使用的是<a class="ae ks" href="http://www.nvidia.com/object/tesla-p100.html" rel="noopener ugc nofollow" target="_blank"> NVIDIA P100 </a>和实例类型<strong class="jw ir"> ecs.gn5-c4g1.xlarge </strong>。最后，现场 DIY 的是<a class="ae ks" href="https://www.nvidia.com/en-us/geforce/products/10series/geforce-gtx-1070/" rel="noopener ugc nofollow" target="_blank">英伟达 1070 GTX </a>。</p><p id="3877" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">基本上，测试使用的是利用 GPU 进行处理的<a class="ae ks" href="https://github.com/lengstrom/fast-style-transfer" rel="noopener ugc nofollow" target="_blank">快速风格传输</a>。测试将使用 rain-princess.ckpt 处理一个分辨率为 4242 × 2828 的 JPEG，命令如下</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="f9bf" class="lc ld iq ky b gy le lf l lg lh">time python evaluate.py — checkpoint ./rain-princess.ckpt — in-path lesu-0596.jpg — out-path lesu-0596-style.jpg</span></pre><p id="1189" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">关于 Amazon 的一个快速提示是，我们需要申请增加限制，否则我们将无法启动 gpu 实例！</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi li"><img src="../Images/31599668ee653bcbd4659eaf645f2ab1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8VWs6EL6WL9rP3d_GtNoSw.png"/></div></div></figure><p id="7245" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">阿里云是一个相当麻烦的改变实例类型，因为我们需要释放和重新创建实例。至于亚马逊是相当直截了当，没有破坏实例，希望阿里云将在这段时间内改善。当我们的脚本只改变深度学习的实例类型，而不是全天候运行时，这是非常有利的，因为对于云中的 GPU 实例类型来说，这非常昂贵。</p><p id="b8ed" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">用于 Amazon 输出的 nvidia-smi 命令</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div class="gh gi ln"><img src="../Images/1e9c9200e1aab02fd9d448fdaf35d6c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1166/format:webp/1*qgyaBpMg_dI33FtOKGKU3w.png"/></div></figure><p id="c10b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">阿里云如下</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/81363be27d7c2fef83c250f7aa204436.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*iejRsf_jzOT9aM2AaDpHJg.png"/></div></figure><p id="9fba" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">每个平台的时间如下</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi lp"><img src="../Images/1e549741b95d4355aeee929ccb99863f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XMG_DzN-6of9iYOzt714Ig.png"/></div></div></figure><p id="f3ee" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">至于定价，亚马逊有以下定价层</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/059f0bf002673df5699b63c92df9c395.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*CzvUF-7leBVZQbXGIw4mKA.png"/></div></figure><p id="c4dc" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">目前，阿里云的 gpu 没有基于订阅/保留的定价</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi lr"><img src="../Images/0024f0e45d6e95060e8c7fd5c7ce2b80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ln0YjWuXetDacUYUb1g3Og.png"/></div></div></figure><p id="6ec4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">对价格的粗略估计如下，假设我们每天只使用该实例 12 小时，持续 30 天</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/d2766083aa8b1326f801c5e3c9a96595.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/1*Ur0Xzkz-gz9S_o1uWGYZeA.png"/></div></figure><p id="7b97" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">与<a class="ae ks" href="https://pcpartpicker.com/list/Dwcpcc" rel="noopener ugc nofollow" target="_blank"> DIY 方式</a>相比，DIY 方式初始投资【USD1305.33 美元，不含电费，可能在 2 个月内收回成本。但是我使用的版本是酷睿 i3，而不是拥有更好 CPU 的云。</p><p id="694a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">最后，我想我们总是在使用成本更高的云选项之前尝试在内部进行培训以节省成本。内部部署的另一个优势是我们不会与其他人共享资源。我一直相信混合方法可以最大限度地提高性能和成本，就像<a class="ae ks" href="https://www.nvidia.com/en-us/gpu-cloud/" rel="noopener ugc nofollow" target="_blank"> Nvidia Cloud </a>提供的一样</p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi lt"><img src="../Images/e05576bcbfe34763035efcb33c4b61f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VK7xj-90GOOhPP3JmV0Djw.png"/></div></div></figure></div></div>    
</body>
</html>