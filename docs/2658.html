<html>
<head>
<title>Query Data Effectively in Hadoop to Feed Your Hungry Data Science Ideas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Hadoop中有效地查询数据，满足您对数据科学的渴望</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/query-data-effectively-in-hadoop-to-feed-your-hungry-data-science-ideas-c0a23fc4b9e0?source=collection_archive---------5-----------------------#2018-02-17">https://towardsdatascience.com/query-data-effectively-in-hadoop-to-feed-your-hungry-data-science-ideas-c0a23fc4b9e0?source=collection_archive---------5-----------------------#2018-02-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/242bb2d07b2a305c8027dbfa4322e942.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cna5XVqbS2DW0bIurj9pYQ.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Elephants in safari</figcaption></figure><p id="2a75" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我的公司的大数据越来越大，Hadoop是2015年的热门话题，顺应这一趋势，我的公司决定从使用Netezza迁移到使用Hadoop。因为我很久以前就在科技新闻中读到过Hadoop，所以我对即将到来的迁移感到兴奋，并且想玩一玩这个新玩具。</p><h1 id="8c70" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">从蜂巢到黑斑羚</h1><p id="d6d5" class="pw-post-body-paragraph kc kd iq ke b kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv mc kx ky kz ij bi translated">在2016年末和2017年，我进入了我们的Hadoop环境，开始使用Hive、Impala、Spark SQL为我的分析项目广泛查询HDFS数据。在Hive中进行了几次查询后，我开始发现Hadoop比我预期的慢(比Netezza慢)。我的同事提醒我，Hive是为大批量map reduce作业设计的，而不是为快速分析查询设计的。后来，由于内存问题和其他问题，我的Hive作业开始失败，我不得不使用许多设置，如'<em class="md">'设置MapReduce . map . memory . MB = 9000；set MapReduce . map . Java . opts =-xmx 7200m；</em>‘让我的蜂巢工作正常运转。在我的Hive作业中，我使用了两个以上的设置来实现正确的配置和期望的性能。</p><p id="48ab" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">使用Hive设置促使我获得关于Hadoop架构和集群操作的知识。然而，分布式系统中的DevOps毕竟不是我的游戏。很快，我转向Spark SQL和Impala寻求更好的解决方案。在Spark SQL中，我面临类似的配置挑战(还记得Spark config设置命令吗？<code class="fe me mf mg mh b">./bin/spark-submit --name "My app" --master yarn --conf spark.executor.memory=4 g myApp.jar</code>)而我在Spark SQL(这是Spark 1.6)中运行复杂查询时遇到了失败。尽管Spark SQL可以无缝连接查询数据和建模数据，如下面的代码片段所示:</p><blockquote class="mi mj mk"><p id="bbbd" class="kc kd md ke b kf kg kh ki kj kk kl km ml ko kp kq mm ks kt ku mn kw kx ky kz ij bi translated"><code class="fe me mf mg mh b">data = sqlContet.sql("select outcomes, label1, lable2 from sampleTable") labeled_data = data.map(lambda line: LabeledPoint(line[0],line[1:])) training, test = labeled_data.randomSplit([0.6,0.4], seed=1) model=LogisticRegressionWithLBFGS.train(training, intercept=1,validateData=1)</code></p></blockquote><p id="0516" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我最终选择了Impala作为我的主要查询工具，因为我发现Impala不仅比Hive和Spark SQL快，而且只需要最小的性能调优开销。</p><p id="429d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">当然，我不能不小心使用黑斑羚。为了获得良好的Impala性能，我需要仔细制定查询策略，并努力管理元数据。在长时间运行的作业中，黑斑羚不如Hive可靠，因此我会将黑斑羚的作业重写到Hive中，以用于生产目的。下面的链接是一篇比较Hive、Impala和Spark SQL的IEEE文章。这篇文章大部分支持我所经历的。</p><div class="mo mp gp gr mq mr"><a href="http://ieeexplore.ieee.org/document/7334737/" rel="noopener  ugc nofollow" target="_blank"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd ir gy z fp mw fr fs mx fu fw ip bi translated">Hive、Impala和Spark的性能比较SQL - IEEE会议出版物</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">大数据中的快速查询对于挖掘有价值的信息以提高系统性能非常重要。至…</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">ieeexplore.ieee.org</p></div></div></div></a></div><h1 id="a028" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">查询工具选择及更多</h1><figure class="nb nc nd ne gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/0958cf13d45a96d19006ef380168b2ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RMS4Elt9B2ufzjeQiMOUQA.jpeg"/></div></div></figure><p id="0ee7" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这三种查询技术在大数据生态系统中都有自己的位置，但是当涉及到数据科学工作的迭代和探索方面时，我确实认为Impala等快速查询可以最有效地帮助数据科学家为他们的数据科学实验选择和整合数据源(然后使用Spark SQL/Spark进行建模，使用Hive进行生产级数据管道)。大的东西有很多小的部分。为了实现大的飞跃，我们需要快速测试小步骤的能力。在查询工具选择决策上，既要考虑其在大数据环境下的性能，也要考虑其在中等数据环境下的性能，既要考虑批处理模式下的性能，也要考虑交互模式下的性能。</p><p id="d6ec" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">数据科学家对数据、洞察和模型非常感兴趣，而DevOps或DataOps对他们的吸引力并不大。我认为减少开发工作对数据科学家来说是可取的，他们可以把更多的时间花在他们的增值上。我花在为Hive寻找合适的内存设置上的时间并不是很有趣。今天，我的公司在内部使用Hadoop，我的公司可能很快就会开始在云中使用Hadoop。许多大数据云平台承诺最小开发运维。这听起来很棒，但我愿意在接受之前仔细评估这个承诺。</p><p id="05c0" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在模型创建生命周期中，数据准备非常耗时。好的查询工具可以帮助我们更快地建立模型，因此我们应该给予查询工具更多的关注。在这里分享我的经验和观点，我也有兴趣从读者那里了解潜在的不同体验。在下面留下评论或者直接给我发Twitter消息@yuzhouyz。</p></div></div>    
</body>
</html>