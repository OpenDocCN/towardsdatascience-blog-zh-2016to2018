<html>
<head>
<title>Why and how to Cross Validate a Model?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么以及如何交叉验证模型？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/why-and-how-to-cross-validate-a-model-d6424b45261f?source=collection_archive---------1-----------------------#2018-11-13">https://towardsdatascience.com/why-and-how-to-cross-validate-a-model-d6424b45261f?source=collection_archive---------1-----------------------#2018-11-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="cca2" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">交叉验证技术的重要性和类型..</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/778b204ef1440cfa735b739311101bcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SEBYJsfhpcYC43CutV1V5g.png"/></div></div></figure><p id="e87a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">一旦我们完成了对模型的训练，我们就不能假设它会在以前没有见过的数据上很好地工作。换句话说，我们不能确定模型在生产环境中会有期望的准确性和变化。我们需要对我们的模型做出的预测的准确性有某种保证。为此，我们需要验证我们的模型。确定量化变量之间假设关系的数值结果是否可接受作为数据描述的过程称为验证..</p><p id="2281" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了评估任何机器学习模型的性能，我们需要在一些看不见的数据上测试它。基于模型对未知数据的表现，我们可以说我们的模型是否欠拟合/过拟合/良好概括。交叉验证(CV)是一种用于测试机器学习模型有效性的技术，它也是一种用于在数据有限的情况下评估模型的重新采样过程。为了执行 CV，我们需要保留未用于训练模型的样本/部分数据，稍后使用该样本进行测试/验证。</p><p id="210b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">下面是一些常用于 CV 的技巧。</p><ol class=""><li id="676a" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated"><strong class="kt ir">列车 _ 测试分流方法</strong>。</li></ol><p id="6103" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在这种方法中，我们将完整的数据随机分为训练集和测试集。然后对训练集执行模型训练，并使用测试集进行验证，理想情况下将数据分成 70:30 或 80:20。使用这种方法，如果我们的数据有限，就有可能出现较高的偏差，因为我们会错过一些没有用于训练的数据信息。如果我们的数据很大，并且我们的测试样本和训练样本具有相同的分布，那么这种方法是可以接受的。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/4a038b10572a6dec1dcc162a1269d560.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*n2OWaxMuMcbBkJ31_Zckxg.png"/></div></figure><p id="73d4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们可以使用切片将数据手动分割成训练集和测试集，或者我们可以使用 scikit-learn 方法的<strong class="kt ir"> train_test_split </strong>来完成这项任务。完整的文档可在<a class="ae lx" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html" rel="noopener ugc nofollow" target="_blank">这里</a>获得。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ly"><img src="../Images/6f3d706394e3cbdb8b2995fec0e29973.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qYsKY-w3xlHZc6PgGDDbug.png"/></div></div></figure><p id="fd97" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> 2。k 重交叉验证</strong>:</p><p id="8bcf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">K-Folds 技术是一种流行且易于理解的技术，与其他方法相比，它通常会产生一个偏差较小的模型。因为它确保了原始数据集中的每个观察值都有机会出现在训练集和测试集中。如果我们的输入数据有限，这是最好的方法之一。该方法遵循以下步骤。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/87ef51129ff7bfad7de0bb3587cb8de5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1046/format:webp/1*C5FJt_NH1BWJrFSvw_6jtw.png"/></div><figcaption class="ma mb gj gh gi mc md bd b be z dk">Image Sourced From Wikipedia</figcaption></figure><ol class=""><li id="81c2" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated">将整个数据随机分成 K 份(K 的值不应该太小或太高，理想情况下我们根据数据大小选择 5 到 10)。K 值越高，模型偏差越小(但较大的方差可能会导致过度拟合)，而 K 值越低，则类似于我们之前看到的训练测试分割方法。</li><li id="30e1" class="ln lo iq kt b ku me kx mf la mg le mh li mi lm ls lt lu lv bi translated">然后使用 K-1 (K 减 1)个折叠来拟合模型，并使用剩余的第 K 个折叠来验证模型。记下分数/错误。</li><li id="15e5" class="ln lo iq kt b ku me kx mf la mg le mh li mi lm ls lt lu lv bi translated">重复这个过程，直到每个 K 倍作为测试集。然后取你记录分数的平均值。这将是该模型的性能指标。</li></ol><p id="eed6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们可以手动编写一个逻辑来执行此操作，或者我们可以使用 scikit_learn 库中内置的<strong class="kt ir"> cross_val_score </strong>(返回每个测试折叠的分数)/ <strong class="kt ir"> corss_val_predict </strong>(返回输入数据集中每个观察值的预测分数，当它是测试集的一部分时)。</p><p id="312a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果 esitmator(模型)是一个分类器，且' y '(目标变量)是二进制/多进制，则默认使用'<strong class="kt ir"> StratifiedKfold </strong>'技术。在所有其他情况下，默认使用'<strong class="kt ir"> K_Fold </strong>'技术来分割和训练模型。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/4ecf287f4a759db24c21c472df5ff72a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1158/format:webp/1*fHIaDmWuums7E7cU8CWHFw.png"/></div></figure><p id="a916" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">类似于 K_Fold 交叉验证器，StratifiedKfold 返回分层的折叠，即在进行折叠时，它保持每个折叠中每个类的样本百分比。因此该模型为训练/测试折叠获得均匀分布的数据。</p><p id="47f1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们可以使用 K-Fold 中的折叠作为迭代器，并在 for 循环中使用它来对 pandas 数据帧进行训练。下面是例子。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/a55ca8da34dcec1feb910e7542f94493.png" data-original-src="https://miro.medium.com/v2/resize:fit:1118/format:webp/1*9n5-Pc7SYOjCLCPF37DjIQ.png"/></div></figure><p id="ac51" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">完整的代码可在<a class="ae lx" href="https://github.com/Msanjayds/Machine_Learning_Projects/blob/master/2.%20CrossValidation.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>获得。</p><p id="f571" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">就这些了，非常感谢你的阅读。如果有任何更正/建议，请告诉我。请吧👏如果你喜欢邮报。提前感谢…😉</p></div></div>    
</body>
</html>