<html>
<head>
<title>Hierarchical Agglomerative Clustering Algorithm Example In Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 中的层次凝聚聚类算法实例</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-algorithms-part-12-hierarchical-agglomerative-clustering-example-in-python-1e18e0075019?source=collection_archive---------1-----------------------#2018-12-31">https://towardsdatascience.com/machine-learning-algorithms-part-12-hierarchical-agglomerative-clustering-example-in-python-1e18e0075019?source=collection_archive---------1-----------------------#2018-12-31</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/8feabc19987671e04e93ef482cece815.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_08o46TwC-wlJlWF.png"/></div></div></figure><div class=""/><p id="e6af" class="pw-post-body-paragraph kf kg je kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">分层聚类算法将相似的对象分组为称为<strong class="kh jf">簇</strong>的组。有两种类型的分层聚类算法:</p><ul class=""><li id="9303" class="ld le je kh b ki kj km kn kq lf ku lg ky lh lc li lj lk ll bi translated">凝聚—自下而上的方法。从许多小集群开始，将它们合并在一起以创建更大的集群。</li><li id="5d1b" class="ld le je kh b ki lm km ln kq lo ku lp ky lq lc li lj lk ll bi translated">分裂——自上而下的方法。从单个集群开始，然后将它分成更小的集群。</li></ul><figure class="ls lt lu lv gt iv gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/796857193ebf025e200232005c1b9af4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/0*E-qictlO_9isi0Dl.png"/></div></figure><h1 id="8017" class="lw lx je bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">分层聚类的一些优点和缺点</h1><h2 id="65ba" class="mu lx je bd ly mv mw dn mc mx my dp mg kq mz na mk ku nb nc mo ky nd ne ms nf bi translated">赞成的意见</h2><ul class=""><li id="0750" class="ld le je kh b ki ng km nh kq ni ku nj ky nk lc li lj lk ll bi translated">不假设特定数量的聚类(即 k 均值)</li><li id="c890" class="ld le je kh b ki lm km ln kq lo ku lp ky lq lc li lj lk ll bi translated">可能对应有意义的分类法</li></ul><h2 id="248e" class="mu lx je bd ly mv mw dn mc mx my dp mg kq mz na mk ku nb nc mo ky nd ne ms nf bi translated">骗局</h2><ul class=""><li id="88e7" class="ld le je kh b ki ng km nh kq ni ku nj ky nk lc li lj lk ll bi translated">一旦决定合并两个集群，就无法撤销</li><li id="b33f" class="ld le je kh b ki lm km ln kq lo ku lp ky lq lc li lj lk ll bi translated">对于大型数据集太慢，O(𝑛2 log(𝑛))</li></ul><h1 id="a52c" class="lw lx je bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">它是如何工作的</h1><ol class=""><li id="6f91" class="ld le je kh b ki ng km nh kq ni ku nj ky nk lc nl lj lk ll bi translated">使每个数据点成为一个群集</li></ol><figure class="ls lt lu lv gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nm"><img src="../Images/00217283049a1a8fed4d240d41a34f8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PPmCcLOkDIEVbv1ZAMF18g.png"/></div></div></figure><p id="eb05" class="pw-post-body-paragraph kf kg je kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">2.取两个最近的集群，并使它们成为一个集群</p><figure class="ls lt lu lv gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nn"><img src="../Images/e8e2f1b1a1df10677ab5cb9e6c4ef0a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r-XmRRM1VpdIS81ufbtmCQ.png"/></div></div></figure><p id="c409" class="pw-post-body-paragraph kf kg je kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">3.重复步骤 2，直到只有一个集群</p><figure class="ls lt lu lv gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi no"><img src="../Images/642725a05cbb0a3c3f91b49a1d7fbd52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RrAR6lueQ1cqXi0aNddSvg.png"/></div></div></figure><h1 id="707a" class="lw lx je bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">系统树图</h1><p id="677b" class="pw-post-body-paragraph kf kg je kh b ki ng kk kl km nh ko kp kq np ks kt ku nq kw kx ky nr la lb lc im bi translated">我们可以使用树状图来可视化分组的历史，并计算出最佳的聚类数。</p><ol class=""><li id="86b4" class="ld le je kh b ki kj km kn kq lf ku lg ky lh lc nl lj lk ll bi translated">确定不与任何其他聚类相交的最大垂直距离</li><li id="87ce" class="ld le je kh b ki lm km ln kq lo ku lp ky lq lc nl lj lk ll bi translated">在两端画一条水平线</li><li id="1dfb" class="ld le je kh b ki lm km ln kq lo ku lp ky lq lc nl lj lk ll bi translated">聚类的最佳数量等于穿过水平线的垂直线的数量</li></ol><p id="bd33" class="pw-post-body-paragraph kf kg je kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">例如，在下面的情况中，集群数量的最佳选择将是<strong class="kh jf"> <em class="ns"> 4 </em> </strong>。</p><figure class="ls lt lu lv gt iv gh gi paragraph-image"><div class="ab gu cl nt"><img src="../Images/ec56162d4a5199c252463480ee6cfb1e.png" data-original-src="https://miro.medium.com/v2/format:webp/1*LBOReupihNEsI6Kot3Q6YQ.png"/></div></figure><h1 id="3df2" class="lw lx je bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">链接标准</h1><p id="3fb5" class="pw-post-body-paragraph kf kg je kh b ki ng kk kl km nh ko kp kq np ks kt ku nq kw kx ky nr la lb lc im bi translated">类似于梯度下降，您可以调整某些参数，以获得截然不同的结果。</p><figure class="ls lt lu lv gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nu"><img src="../Images/b7e090012a98aa711842aa40b3174459.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RgJZRDA5MR7SPlGSAVsCaw.png"/></div></div></figure><p id="db70" class="pw-post-body-paragraph kf kg je kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">链接标准指的是如何计算聚类之间的距离。</p><figure class="ls lt lu lv gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nv"><img src="../Images/986a94a8b6a7ce2fc07082c4dd8aa899.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9NIgdDL-L-3RAFwLQIdL6g.png"/></div></div></figure><h2 id="95b6" class="mu lx je bd ly mv mw dn mc mx my dp mg kq mz na mk ku nb nc mo ky nd ne ms nf bi translated">单键</h2><p id="c58c" class="pw-post-body-paragraph kf kg je kh b ki ng kk kl km nh ko kp kq np ks kt ku nq kw kx ky nr la lb lc im bi translated">两个聚类之间的距离是每个聚类中两点之间的最短距离</p><figure class="ls lt lu lv gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nw"><img src="../Images/affa5d8207412d8312682c4dd96510e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*es5FXhkbEGXzYJbljM3kwA.png"/></div></div></figure><h2 id="be60" class="mu lx je bd ly mv mw dn mc mx my dp mg kq mz na mk ku nb nc mo ky nd ne ms nf bi translated">完全连锁</h2><p id="5011" class="pw-post-body-paragraph kf kg je kh b ki ng kk kl km nh ko kp kq np ks kt ku nq kw kx ky nr la lb lc im bi translated">两个聚类之间的距离是每个聚类中两点之间的最长距离</p><figure class="ls lt lu lv gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nx"><img src="../Images/e39d1e2589b69d0f1d9c0436b098e1f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_MtnDQmsLh54vlRdo0BkcA.png"/></div></div></figure><h2 id="1f86" class="mu lx je bd ly mv mw dn mc mx my dp mg kq mz na mk ku nb nc mo ky nd ne ms nf bi translated">平均连锁</h2><p id="112d" class="pw-post-body-paragraph kf kg je kh b ki ng kk kl km nh ko kp kq np ks kt ku nq kw kx ky nr la lb lc im bi translated">聚类之间的距离是一个聚类中的每个点到另一个聚类中的每个点的平均距离</p><figure class="ls lt lu lv gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ny"><img src="../Images/6e5a20be7aa9b2c904d1ab2dbdcabad8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3xyaBTEqkF7EH8I_0tqfXw.png"/></div></div></figure><h2 id="f800" class="mu lx je bd ly mv mw dn mc mx my dp mg kq mz na mk ku nb nc mo ky nd ne ms nf bi translated"><strong class="ak">病房</strong>联动</h2><p id="230f" class="pw-post-body-paragraph kf kg je kh b ki ng kk kl km nh ko kp kq np ks kt ku nq kw kx ky nr la lb lc im bi translated">聚类之间的距离是所有聚类内的平方差之和</p><figure class="ls lt lu lv gt iv gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/ff5993ff947efd0042576347a079cf02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1028/format:webp/1*oAKli0U57Z20-GNpcqy6AA.png"/></div></figure><h1 id="6569" class="lw lx je bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">距离度量</h1><p id="c7e8" class="pw-post-body-paragraph kf kg je kh b ki ng kk kl km nh ko kp kq np ks kt ku nq kw kx ky nr la lb lc im bi translated">您用来计算数据点之间距离的方法将影响最终结果。</p><h2 id="f2f1" class="mu lx je bd ly mv mw dn mc mx my dp mg kq mz na mk ku nb nc mo ky nd ne ms nf bi translated">欧几里得距离</h2><p id="4448" class="pw-post-body-paragraph kf kg je kh b ki ng kk kl km nh ko kp kq np ks kt ku nq kw kx ky nr la lb lc im bi translated">两点之间的最短距离。例如，如果 x=(a，b)且 y=(c，d)，则 x 和 y 之间的欧几里德距离为√(a c)+(b d)</p><figure class="ls lt lu lv gt iv gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/807c2a314cfe5608874ab7e4c1a1a0dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/0*OgQ3Cqrjn5l0S87e.png"/></div></figure><h2 id="a12c" class="mu lx je bd ly mv mw dn mc mx my dp mg kq mz na mk ku nb nc mo ky nd ne ms nf bi translated">曼哈顿距离</h2><p id="a862" class="pw-post-body-paragraph kf kg je kh b ki ng kk kl km nh ko kp kq np ks kt ku nq kw kx ky nr la lb lc im bi translated">想象一下，你在一个大城市的市中心，你想从 A 点到 b 点。你不能穿过建筑物，而是必须沿着不同的街道行走。例如，如果 x=(a，b)且 y=(c，d)，则 x 和 y 之间的曼哈顿距离为| a c |+| b d |</p><figure class="ls lt lu lv gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ob"><img src="../Images/7e8f51cebfb60c3775bb1a999e4e1bb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*iUkjR43XPYl09awz.png"/></div></div></figure><h1 id="a926" class="lw lx je bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">python 中的示例</h1><p id="8c90" class="pw-post-body-paragraph kf kg je kh b ki ng kk kl km nh ko kp kq np ks kt ku nq kw kx ky nr la lb lc im bi translated">让我们看一个具体的例子，看看我们如何使用层次凝聚聚类来标记数据。</p><pre class="ls lt lu lv gt oc ke od oe aw of bi"><span id="aa6d" class="mu lx je ke b gy og oh l oi oj">import pandas as pd<br/>import numpy as np<br/>from matplotlib import pyplot as plt<br/>from sklearn.cluster import AgglomerativeClustering<br/>import scipy.cluster.hierarchy as sch</span></pre><p id="6b98" class="pw-post-body-paragraph kf kg je kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">在本教程中，我们使用 csv 文件，其中包含一个客户列表，包括他们的性别、年龄、年收入和支出分数。</p><figure class="ls lt lu lv gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ok"><img src="../Images/09dd4168c8ac8da636d466d417829c66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aWkUCqkqyGwZ17w_YtV5hw.png"/></div></div></figure><p id="df5f" class="pw-post-body-paragraph kf kg je kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">如果你想跟进，你可以从<em class="ns"> superdatascience </em>网站获得数据集。</p><div class="is it gp gr iu ol"><a href="https://www.superdatascience.com/machine-learning/" rel="noopener  ugc nofollow" target="_blank"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd jf gy z fp oq fr fs or fu fw jd bi translated">机器学习 A-Z:下载实践数据集-超级数据科学-大数据|分析职业生涯…</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">欢迎来到机器学习课程的数据仓库，作者是基里尔·叶列缅科和哈德琳·德·庞特维斯…</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">www.superdatascience.com</p></div></div><div class="ou l"><div class="ov l ow ox oy ou oz ja ol"/></div></div></a></div><p id="1b5a" class="pw-post-body-paragraph kf kg je kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">为了稍后在图表上显示我们的数据，我们只能取两个变量(年收入和支出分数)。</p><pre class="ls lt lu lv gt oc ke od oe aw of bi"><span id="8959" class="mu lx je ke b gy og oh l oi oj">dataset = pd.read_csv('./data.csv')<br/><br/>X = dataset.iloc[:, [3, 4]].values</span></pre><p id="d24c" class="pw-post-body-paragraph kf kg je kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">查看树状图，不与任何集群相交的最高垂直距离是中间的绿色。假设有 5 条垂直线穿过阈值，则最佳聚类数是 5。</p><pre class="ls lt lu lv gt oc ke od oe aw of bi"><span id="41e6" class="mu lx je ke b gy og oh l oi oj">dendrogram = sch.dendrogram(sch.linkage(X, method='ward'))</span></pre><figure class="ls lt lu lv gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pa"><img src="../Images/1ffdf76806fa8925f2fd23506e2c3997.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s2ygRFN_oqpv0qDMnbkxPA.png"/></div></div></figure><p id="362d" class="pw-post-body-paragraph kf kg je kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我们创建了一个实例<code class="fe kb kc kd ke b">AgglomerativeClustering</code>,使用欧几里得距离作为点之间距离的度量，并使用 ward 连接来计算聚类的邻近度。</p><pre class="ls lt lu lv gt oc ke od oe aw of bi"><span id="acb3" class="mu lx je ke b gy og oh l oi oj">model = AgglomerativeClustering(n_clusters=5, affinity='euclidean', linkage='ward')<br/>model.fit(X)<br/>labels = model.labels_</span></pre><p id="641f" class="pw-post-body-paragraph kf kg je kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">属性返回一个整数数组，其中的值对应于不同的类别。</p><figure class="ls lt lu lv gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pb"><img src="../Images/edcd2b5be2896c71e615cb7888547b80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1jbgPvYDlpkj29MaJu1-KQ.png"/></div></div></figure><p id="96a4" class="pw-post-body-paragraph kf kg je kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我们可以使用简写符号将属于某一类别的所有样本显示为特定的颜色。</p><pre class="ls lt lu lv gt oc ke od oe aw of bi"><span id="d865" class="mu lx je ke b gy og oh l oi oj">plt.scatter(X[labels==0, 0], X[labels==0, 1], s=50, marker='o', color='red')<br/>plt.scatter(X[labels==1, 0], X[labels==1, 1], s=50, marker='o', color='blue')<br/>plt.scatter(X[labels==2, 0], X[labels==2, 1], s=50, marker='o', color='green')<br/>plt.scatter(X[labels==3, 0], X[labels==3, 1], s=50, marker='o', color='purple')<br/>plt.scatter(X[labels==4, 0], X[labels==4, 1], s=50, marker='o', color='orange')<br/>plt.show()</span></pre><figure class="ls lt lu lv gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi pc"><img src="../Images/446365021d5477a81c2305ca1c49fc34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6sDHeO2yhNNs3fO50hDUNQ.png"/></div></div></figure></div></div>    
</body>
</html>