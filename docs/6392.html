<html>
<head>
<title>Parsing XML, Named Entity Recognition in One-Shot</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">解析 XML，一次性识别命名实体</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/parsing-xml-named-entity-recognition-in-one-shot-629a8b9846ee?source=collection_archive---------5-----------------------#2018-12-11">https://towardsdatascience.com/parsing-xml-named-entity-recognition-in-one-shot-629a8b9846ee?source=collection_archive---------5-----------------------#2018-12-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/300aae601ad24c261ac4401c841f3f08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QOL55V-gxGCGH1uGkVah_w.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Photo credit: Lynda.com</figcaption></figure><div class=""/><div class=""><h2 id="aa84" class="pw-subtitle-paragraph kc je jf bd b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt dk translated">条件随机场，序列预测，序列标记</h2></div><p id="8a98" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><a class="ae lq" href="https://www.w3schools.com/xml/xml_parser.asp" rel="noopener ugc nofollow" target="_blank">解析 XML </a>是一个旨在读取 XML 并为程序使用 XML 创造一种方式的过程。XML 解析器是一种软件，它读取 XML 文件，并将这些文件中的信息提供给应用程序。</p><p id="e443" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">在读取 XML 文件时，解析器会检查格式的语法，并报告任何违规情况。</p><p id="04db" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我们今天的主要目标不是解析 XML，而是命名实体识别(NER)，但是我们要使用的数据是以 XML 格式存储的。</p><p id="ab35" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">NER 的任务是确定文本中提到的实体的身份。例如，给定句子“<a class="ae lq" href="https://en.wikipedia.org/wiki/Entity_linking" rel="noopener ugc nofollow" target="_blank">巴黎是法国的首都</a>”，思路是确定“巴黎”指的是<a class="ae lq" href="https://en.wikipedia.org/wiki/Paris" rel="noopener ugc nofollow" target="_blank">巴黎</a>的城市，而不是<a class="ae lq" href="https://en.wikipedia.org/wiki/Paris_Hilton" rel="noopener ugc nofollow" target="_blank">巴黎希尔顿</a>。</p><p id="59bf" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">“巴黎是法国的首都”这句话暗示<strong class="kw jg">巴黎</strong>是一个国家的首都，暗示<strong class="kw jg">巴黎</strong>是一个城市，而不是一个人的名字。</p><p id="73ba" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">命名文档集合中发现的实体的任务极具挑战性。幸运的是，<a class="ae lq" href="https://github.com/dice-group/n3-collection" rel="noopener ugc nofollow" target="_blank">UPB<a class="ae lq" href="https://github.com/dice-group" rel="noopener ugc nofollow" target="_blank">数据科学小组从德国</a>提供了一组用于 NLP 交换格式</a>的命名实体识别的带注释的训练数据集，我们将使用其中一个名为 500newsgoldstandard.xml 的数据集，可以在这里<a class="ae lq" href="https://raw.githubusercontent.com/dice-group/n3-collection/master/500newsgoldstandard.xml" rel="noopener ugc nofollow" target="_blank">找到</a>。</p><h1 id="a562" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">数据</h1><p id="9b76" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">为了研究数据，我们使用<code class="fe mo mp mq mr b">prettify()</code>以分层格式的嵌套数据结构获取文档:</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="597f" class="na ls jf mr b gy nb nc l nd ne">with codecs.open("500newsgoldstandard.xml", "r", "utf-8") as file:<br/>    soup = BeautifulSoup(file, "html.parser")<br/>print(soup.prettify())</span></pre><p id="fa10" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">数据创建者侧重于识别三类主要的命名实体:人、地点和组织。从第一份文件中我们可以看到:</p><figure class="ms mt mu mv gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nf"><img src="../Images/83eb8538d36cc73db21b391c7ff13e1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9HYs0cOhqctVgzKpLr3CkA.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 1</figcaption></figure><p id="c0ea" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">该文件有一句话“美国专利局允许基因获得专利，只要有人通过从细胞中取出 DNA 来分离 DNA，美国公民自由联盟的律师桑德拉·帕克说”，其中“美国公民自由联盟”(一个组织)和“桑德拉·帕克”(一个人的名字)被标记为命名实体。因为它们在<code class="fe mo mp mq mr b">namedentityintext</code>标签之间。</p><h1 id="bd02" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">数据预处理</h1><p id="0a12" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">文本预处理包括遍历<code class="fe mo mp mq mr b">textwithnamedentities</code>下元素的每个子元素，否则我们将“N”标记为命名实体“C”的一部分。</p><p id="f3fa" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">以下代码返回文档列表，每个文档都包含单词和标签对。</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="600f" class="na ls jf mr b gy nb nc l nd ne">docs = []<br/>for elem in soup.find_all("document"):<br/>    texts = []<br/>    for child in elem.find("textwithnamedentities").children:<br/>        if type(child) == Tag:<br/>            if child.name == "namedentityintext":<br/>                label = 'N'<br/>            else:<br/>                label = 'C'<br/>            for w in child.text.split(" "):<br/>                if len(w) &gt; 0:<br/>                    texts.append((w, label))<br/>    docs.append(texts)</span></pre><p id="2d53" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">我们可以再次调查第一份文件。</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="d0b0" class="na ls jf mr b gy nb nc l nd ne">docs[0]</span></pre><figure class="ms mt mu mv gt is gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/d046bd491b4322455afe472363f262be.png" data-original-src="https://miro.medium.com/v2/resize:fit:776/format:webp/1*Yu1d0suGHct7-FuWHIR1zw.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 2</figcaption></figure><h1 id="53c8" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">位置标签</h1><p id="39d0" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">我们将对文档列表应用单词标记和词性标注。</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="6251" class="na ls jf mr b gy nb nc l nd ne">data = []<br/>for i, doc in enumerate(docs):<br/>    tokens = [t for t, label in doc]<br/>    tagged = pos_tag(tokens)<br/>    data.append([(w, pos, label) for (w, label), (word, pos) in zip(doc, tagged)])</span></pre><p id="ef63" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">这为我们提供了包含单个单词、POS 标签及其标签的元组列表。</p><pre class="ms mt mu mv gt mw mr mx my aw mz bi"><span id="2c5b" class="na ls jf mr b gy nb nc l nd ne">data[0]</span></pre><figure class="ms mt mu mv gt is gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/aea87f4c4fa58e6606aac4359c6a05e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:882/format:webp/1*MZ9NjbeFMmwF2nAGFtnc8A.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 3</figcaption></figure><h1 id="0e20" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">条件随机场</h1><p id="734a" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated">在命名实体识别领域，我们的输入数据是连续的，我们预测相互依赖以及依赖于其他观察变量的变量，也就是说，我们在对数据点进行预测时考虑周围的上下文，再想想“巴黎是法国的首都”与“巴黎希尔顿”。</p><p id="fdd8" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">所以我们会定义一些特征，比如词的身份、词的部分、下/标题/上标志、词的后缀、词的形状、词的词性标签；此外，使用来自邻近单词的一些信息，以及不在文档开头的单词的所有这些特征，不在文档结尾的单词的所有这些特征。</p><h1 id="ee55" class="lr ls jf bd lt lu lv lw lx ly lz ma mb kl mc km md ko me kp mf kr mg ks mh mi bi translated">条件随机场 Python 库，Python-Crfsuite</h1><p id="5a07" class="pw-post-body-paragraph ku kv jf kw b kx mj kg kz la mk kj lc ld ml lf lg lh mm lj lk ll mn ln lo lp ij bi translated"><a class="ae lq" href="https://github.com/scrapinghub/python-crfsuite" rel="noopener ugc nofollow" target="_blank"> Python-crfsuite </a>是一个绑定到<a class="ae lq" href="https://github.com/chokkan/crfsuite" rel="noopener ugc nofollow" target="_blank"> CRFsuite </a>的 Python，这是一个用于标记顺序数据的条件随机字段(CRF)的实现。该库已被广泛用于命名实体识别。</p><p id="a60a" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">以下代码大部分摘自<a class="ae lq" href="https://github.com/scrapinghub/python-crfsuite" rel="noopener ugc nofollow" target="_blank"> python-crfsuite </a>，用于上述特征提取:</p><figure class="ms mt mu mv gt is"><div class="bz fp l di"><div class="ni nj l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">features_crfsuite.py</figcaption></figure><h2 id="e4d8" class="na ls jf bd lt nk nl dn lx nm nn dp mb ld no np md lh nq nr mf ll ns nt mh nu bi translated">训练模型</h2><figure class="ms mt mu mv gt is"><div class="bz fp l di"><div class="ni nj l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">train_crfModel.py</figcaption></figure><h2 id="ffc6" class="na ls jf bd lt nk nl dn lx nm nn dp mb ld no np md lh nq nr mf ll ns nt mh nu bi translated">评估结果</h2><figure class="ms mt mu mv gt is"><div class="bz fp l di"><div class="ni nj l"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">evaluate_results.py</figcaption></figure><figure class="ms mt mu mv gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nv"><img src="../Images/a0eaa35e671c7fae84442010643895fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wcKxMSNl_rUUkrPQ2-4a7A.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Figure 4</figcaption></figure><p id="a213" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">对于第一次尝试来说还不算太差！</p><p id="67c7" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated"><a class="ae lq" href="https://github.com/susanli2016/NLP-with-Python/blob/master/NER%20500newsgoldstandard.ipynb" rel="noopener ugc nofollow" target="_blank"> Jupyter 笔记本</a>可以在<a class="ae lq" href="https://github.com/susanli2016/NLP-with-Python/blob/master/NER%20500newsgoldstandard.ipynb" rel="noopener ugc nofollow" target="_blank"> Github </a>上找到。享受这周剩下的时光。</p><p id="d4e0" class="pw-post-body-paragraph ku kv jf kw b kx ky kg kz la lb kj lc ld le lf lg lh li lj lk ll lm ln lo lp ij bi translated">参考资料:</p><div class="ip iq gp gr ir nw"><a href="http://blog.echen.me/2012/01/03/introduction-to-conditional-random-fields/" rel="noopener  ugc nofollow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd jg gy z fp ob fr fs oc fu fw je bi translated">条件随机场简介</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">假设你有一系列贾斯汀比伯生活中某一天的快照，你想给每张照片贴上…</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">blog.echen.me</p></div></div></div></a></div><div class="ip iq gp gr ir nw"><a href="http://www.albertauyeung.com/post/python-sequence-labelling-with-crf/" rel="noopener  ugc nofollow" target="_blank"><div class="nx ab fo"><div class="ny ab nz cl cj oa"><h2 class="bd jg gy z fp ob fr fs oc fu fw je bi translated">在 Python 中使用 CRF 执行序列标记</h2><div class="od l"><h3 class="bd b gy z fp ob fr fs oc fu fw dk translated">在自然语言处理中，从给定的文本中抽取特定类型的词或短语是一项常见的任务</h3></div><div class="oe l"><p class="bd b dl z fp ob fr fs oc fu fw dk translated">www.albertauyeung.com</p></div></div></div></a></div></div></div>    
</body>
</html>