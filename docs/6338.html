<html>
<head>
<title>A Short Guide to Using Docker for Your Data Science Environment</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">针对您的数据科学环境使用 Docker 的简短指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-short-guide-to-using-docker-for-your-data-science-environment-912617b3603e?source=collection_archive---------6-----------------------#2018-12-08">https://towardsdatascience.com/a-short-guide-to-using-docker-for-your-data-science-environment-912617b3603e?source=collection_archive---------6-----------------------#2018-12-08</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="fded" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated"><em class="ki">告别 OS 烦恼，向便携性问好！</em></h2></div><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/4a6d40ea583d77425c502d7ac04536d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dJvSgEK2hhstE1CpYwp4CA.png"/></div></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk">Source : Docker + Jupyter teams</figcaption></figure><h1 id="e83d" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">为什么</h1><p id="0b22" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在新系统上开始工作/开始一项新工作或只是简单地分享您的工作，最耗时的部分之一是由于硬件/软件/安全策略等方面的差异而导致的可用工具的变化(或缺少工具)。<a class="ae mn" href="https://www.docker.com/resources/what-container" rel="noopener ugc nofollow" target="_blank">容器化</a>近年来兴起，作为一种现成的解决方案，可以解决各种应用程序的平台差异，从单用户开发环境(使用 docker 试用<a class="ae mn" href="https://www.jetbrains.com/help/idea/docker.html" rel="noopener ugc nofollow" target="_blank"><em class="mo">JetBrains</em></a><em class="mo"/>工具)到高度分布式的生产环境(例如<a class="ae mn" href="https://cloud.google.com/containers" rel="noopener ugc nofollow" target="_blank"><em class="mo">Google Cloud</em></a><em class="mo">、</em><a class="ae mn" href="https://docs.docker.com/compose/bundles" rel="noopener ugc nofollow" target="_blank"><em class="mo">Docker</em></a><em class="mo">)。</em>在本文中，我们将介绍 Docker 作为我们的容器服务，以及开始为数据科学构建定制开发平台所需的步骤。</p><p id="0170" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">就个人而言，我认为使用 docker 的最大优势之一就是能够在他人的系统上进行构建。如果一个已经存在的环境满足您的所有需求，您可以简单地从克隆它开始，或者，您可以使用您的<a class="ae mn" href="https://docs.docker.com/engine/reference/builder" rel="noopener ugc nofollow" target="_blank"> <strong class="lt iu"> dockerfile </strong> </a>在它的基础上进行构建，使它对您的特定用例更加有用！</p><h1 id="aa9b" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated"><strong class="ak">如何</strong></h1><p id="8bf1" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">让我们讨论几个场景:</p><p id="d255" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated"><strong class="lt iu"> <em class="mo">方法 A:从您选择的 linux 发行版开始</em> </strong></p><p id="dfde" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">假设您决定最好从头开始，即从您喜欢的 linux 发行版开始，安装适合您需要的所有软件。通过这种方式，您可以完全控制正在安装的每个软件，并且可以根据需要为每个工具安装特定的版本。这也可能给你最小的图像尺寸，因为你可以跳过任何你不需要的工具。下面显示了这种方法的几个示例 docker 文件:</p><pre class="kk kl km kn gt mu mv mw mx aw my bi"><span id="8b93" class="mz la it mv b gy na nb l nc nd"># Using ubuntu 18.04 as base image</span><span id="de81" class="mz la it mv b gy ne nb l nc nd">FROM ubuntu:18.04<br/>RUN apt-get install python3-pip python3-dev &amp;&amp; \<br/>    ln -s /usr/bin/python3 /usr/local/bin/python &amp;&amp; \<br/>    pip3 install — upgrade pip</span></pre><p id="c7be" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">仅此而已。将它复制到一个空文件夹中的文件中，并使用<a class="ae mn" href="https://docs.docker.com/engine/reference/commandline/build" rel="noopener ugc nofollow" target="_blank"> docker build </a>构建一个映像，以访问 ubuntu 中的基本 python3。</p><p id="b287" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">另一种构建映像的方法是使用 dockerhub 的官方 python 库<a class="ae mn" href="https://hub.docker.com/r/_/python" rel="noopener ugc nofollow" target="_blank">。您可以使用<em class="mo"> docker pull </em>命令克隆一个映像:</a></p><pre class="kk kl km kn gt mu mv mw mx aw my bi"><span id="d49e" class="mz la it mv b gy na nb l nc nd">docker pull python</span></pre><p id="db88" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated"><strong class="lt iu"> <em class="mo">方法 B:使用已经安装了所有工具的可用映像</em> </strong></p><p id="8c5d" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">这就是我爱上使用 docker 进行日常工作的原因。Jupyter Docker Stacks 的工作人员已经创建了许多已经安装了不同工具的测试良好、功能齐全且随时可用的映像。从他们的文档中提取的依赖关系树如下所示:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/3f1bf1e6354b1d25f73b07456ea3faff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*759e7QZrtLRtN-Nf7NGnxQ.png"/></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk">Docker image tree by <a class="ae mn" href="https://jupyter-docker-stacks.readthedocs.io" rel="noopener ugc nofollow" target="_blank"><strong class="bd ng"><em class="ki">Jupyter Docker Stacks</em></strong></a> — Each child contains every tool in the parent image</figcaption></figure><p id="f5d6" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">使用这些图像或对它们稍加修改，对于大多数用例来说就足够了。要使用这些图像中的一个，只需使用“docker run”命令，如果图像不存在，它将被下载。</p><pre class="kk kl km kn gt mu mv mw mx aw my bi"><span id="3e45" class="mz la it mv b gy na nb l nc nd">docker run -p 8888:8888 jupyter/scipy-notebook</span></pre><p id="3c11" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated"><strong class="lt iu"> -p </strong>参数将您的系统端口 8888 镜像到 docker 镜像端口 8888，因此现在，您可以在本地浏览器中启动 jupyter 或 jupyterlab！如果您想以随机方式转发所有暴露的端口，请使用<strong class="lt iu"> -P </strong>来代替。这些映像来自 Anaconda 的 python 发行版，正如我前面提到的，您可以从任何映像开始，通过使用 docker 文件并在本地构建来添加额外的工具。</p><p id="c64b" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">对于我的使用，我已经将使用 Anaconda 的 Julia、Python27 和 Python36 环境添加到了<strong class="lt iu"><em class="mo">all-spark-notebook</em></strong>映像中。</p><p id="9cc9" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">这个修改后的映像包含以下可从 Jupyter 访问的内核:</p><ol class=""><li id="02ed" class="nh ni it lt b lu mp lx mq ma nj me nk mi nl mm nm nn no np bi translated">基本 python Jupyter 笔记本环境</li><li id="407c" class="nh ni it lt b lu nq lx nr ma ns me nt mi nu mm nm nn no np bi translated">Python 3.6</li><li id="aaf9" class="nh ni it lt b lu nq lx nr ma ns me nt mi nu mm nm nn no np bi translated">Python 2.7</li><li id="68a0" class="nh ni it lt b lu nq lx nr ma ns me nt mi nu mm nm nn no np bi translated">斯卡拉</li><li id="cd03" class="nh ni it lt b lu nq lx nr ma ns me nt mi nu mm nm nn no np bi translated">稀有</li><li id="0a47" class="nh ni it lt b lu nq lx nr ma ns me nt mi nu mm nm nn no np bi translated">朱莉娅</li><li id="79a2" class="nh ni it lt b lu nq lx nr ma ns me nt mi nu mm nm nn no np bi translated">火花</li><li id="ec2f" class="nh ni it lt b lu nq lx nr ma ns me nt mi nu mm nm nn no np bi translated">Mesos 堆栈</li></ol><p id="752a" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">我的图像储存库在 Github 的<a class="ae mn" href="https://github.com/nilesh-patil/datascience-environment" rel="noopener ugc nofollow" target="_blank"><strong class="lt iu"/></a><strong class="lt iu"/>上，你可以随意使用和修改。要使用此环境并为工作挂载本地目录，请使用以下命令运行它:</p><pre class="kk kl km kn gt mu mv mw mx aw my bi"><span id="d865" class="mz la it mv b gy na nb l nc nd">docker run -P -v "path_to_shared_local_directory":/home/jovyan/work/ -t cvbi/datascience-environment</span></pre><p id="d716" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">上面的命令做了 3 个重要的步骤。下载并运行容器 cvbi/data science-environment<br/>2。将所有暴露的容器端口转发到随机主机环境端口<br/> 3。挂载主机目录<em class="mo">“path _ to _ shared _ local _ directory”</em>以从位于<em class="mo"> /home/jovyan/work/ </em>的容器中访问</p><p id="d3b5" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">运行完上述命令后，复制 jupyter 令牌并使用以下命令查看端口映射:</p><pre class="kk kl km kn gt mu mv mw mx aw my bi"><span id="36be" class="mz la it mv b gy na nb l nc nd">docker ps</span></pre><p id="cc8f" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">打开您的浏览器访问上述端口，例如 localhost:32780，然后粘贴您的密钥来访问这个 Jupyter 环境。</p><p id="45ce" class="pw-post-body-paragraph lr ls it lt b lu mp ju lw lx mq jx lz ma mr mc md me ms mg mh mi mt mk ml mm im bi translated">注意:向映像添加软件意味着增加总的映像大小(<em class="mo">显然是</em>)，所以在另一个映像上构建肯定会增加第一次运行的总下载大小。</p></div></div>    
</body>
</html>