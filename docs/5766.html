<html>
<head>
<title>NLP | Sequence to Sequence Networks| Part 1| Processing text data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">NLP |序列到序列网络|第 1 部分|处理文本数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/nlp-sequence-to-sequence-networks-part-1-processing-text-data-d141a5643b72?source=collection_archive---------3-----------------------#2018-11-08">https://towardsdatascience.com/nlp-sequence-to-sequence-networks-part-1-processing-text-data-d141a5643b72?source=collection_archive---------3-----------------------#2018-11-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/7c690c25c32393c8c8ba860e1fe0d4eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RspNg2-o0dL8IoSgBCkqQQ.png"/></div></div></figure><p id="6aa3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通过理解 NLP，你可以获得许多好处，你可以制作自己的模型来回答问题并在聊天机器人中使用它，或者你可以制作一个翻译器来将文本从你的语言翻译成英语或相反的语言，或者你可以制作一个文本摘要器。</p><p id="574e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这个教程系列中，我们将学习如何制作一个 seq2seq 网络，并训练它将英语文本翻译成法语，或者您可以在另一个 seq2seq 用途中使用它。</p><p id="a0e4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在本系列的这一部分中，我们将学习如何处理文本数据以将其提供给 seq2seq 网络。</p><p id="e7d5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将学习两种处理文本的方法</p><ul class=""><li id="e8c3" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv lb lc ld le bi translated">字符级处理</li><li id="27ce" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated">单词级处理(使用嵌入)</li></ul></div><div class="ab cl lk ll hu lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="ij ik il im in"><p id="c389" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我用了一个英语→法语句子的数据集，你可以从<a class="ae lr" href="http://www.manythings.org/anki/fra-eng.zip" rel="noopener ugc nofollow" target="_blank">这里</a>得到我用的数据集。</p><p id="1cc1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于其他语言，您可以使用[<a class="ae lr" href="http://www.manythings.org/anki/" rel="noopener ugc nofollow" target="_blank">this</a>链接获得数据集</p></div><div class="ab cl lk ll hu lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="ij ik il im in"><h1 id="1e78" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">第一:字符级处理</h1><h2 id="3850" class="mq lt iq bd lu mr ms dn ly mt mu dp mc kj mv mw mg kn mx my mk kr mz na mo nb bi translated">概述:</h2><p id="a17f" class="pw-post-body-paragraph jy jz iq ka b kb nc kd ke kf nd kh ki kj ne kl km kn nf kp kq kr ng kt ku kv ij bi translated">我在下面的图片中解释了文本处理的步骤:</p><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nh"><img src="../Images/c73312246ddb9ca8893239198bf4a51f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3dJqwlv2TyKvMib0_Lpuww.jpeg"/></div></div></figure><p id="eac8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以，代表这个词的<strong class="ka ir">球:</strong></p><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/70cd89d930c67e4610c7bae86e32da2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*clOGgaE0nxsJAeJ2kM_hTQ.jpeg"/></div></div></figure><p id="9a6a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">，来代表句子<strong class="ka ir"> hello world！:</strong></p><figure class="ni nj nk nl gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/aadae2523ee2aa6cb48c7f9b9d6e9fb6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HRbEaatZ95qs-nlgvr_dXw.jpeg"/></div></div></figure></div><div class="ab cl lk ll hu lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="ij ik il im in"><p id="fe56" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我希望您对处理文本数据的步骤有了一些直觉。</p><p id="1e14" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们将使用 python 进行一些编码:</p><p id="fc56" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，让我们导入 numpy:</p><pre class="ni nj nk nl gt nn no np nq aw nr bi"><span id="63ee" class="mq lt iq no b gy ns nt l nu nv">import numpy as np</span></pre><p id="1eb9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后，加载文本文件:</p><figure class="ni nj nk nl gt jr"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="fbed" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">之后，拆分样本并获取必要的字典:</p><figure class="ni nj nk nl gt jr"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="f642" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">制作所需的字典，将字符转换为整数，反之亦然:</p><figure class="ni nj nk nl gt jr"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="9966" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">计算最长样本的长度和一些其他变量:</p><figure class="ni nj nk nl gt jr"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="ab68" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">输出:</p><pre class="ni nj nk nl gt nn no np nq aw nr bi"><span id="50f7" class="mq lt iq no b gy ns nt l nu nv">Number of E Samples  	: 160872<br/>Number of D Samples 	: 160872<br/>Number of D Chars  	: 115<br/>Number of E Chars 	: 92<br/>The Longest D Sample has 351 Chars<br/>The Longest E Sample has 286 Chars</span></pre><p id="5010" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">E →输入文本(稍后编码)<br/> D →输出文本(稍后解码)</p><figure class="ni nj nk nl gt jr"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="0148" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">接下来，我们将通过字母<br/> <strong class="ka ir"> ex </strong>对样本进行<strong class="ka ir">热编码:</strong></p><p id="1d74" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">hi—&gt;[[0，0，0，…，1，0，0，0]，[0，0，0，…，0，1，0，0]]<br/>其中我们将每个样本表示为一个包含(n)行和(j)列的零数组<br/> <strong class="ka ir"> n =最长样本中的字符数<br/> j =字典中的字符数</strong></p><p id="c995" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将制作三组数据:<br/> 1-编码器输入样本(英语句子)<br/> 2-解码器输入样本(法语句子)<br/> 3-目标(法语句子)</p><p id="d76d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">目标</strong>将是与<strong class="ka ir">解码器输入</strong>相同的数据，但它将领先一个字符<br/> <strong class="ka ir">例如:</strong> <br/>解码器输入= '\tHow are yo' <br/>目标= '你好吗'</p><figure class="ni nj nk nl gt jr"><div class="bz fp l di"><div class="nw nx l"/></div></figure><pre class="ni nj nk nl gt nn no np nq aw nr bi"><span id="2a88" class="mq lt iq no b gy ns nt l nu nv">[Output]:<br/>Shape of encoder_input_data : (160872, 286, 92) <br/>Shape of decoder_input_data : (160872, 351, 115) <br/>Shape of target_data        : (160872, 351, 115)</span></pre><p id="df4a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，seq2seq 模型可以使用这些数据了。</p><h1 id="ea38" class="ls lt iq bd lu lv ny lx ly lz nz mb mc md oa mf mg mh ob mj mk ml oc mn mo mp bi translated">ٍSecond:单词级处理(使用嵌入):</h1><h2 id="2427" class="mq lt iq bd lu mr ms dn ly mt mu dp mc kj mv mw mg kn mx my mk kr mz na mo nb bi translated">概述:</h2><p id="9a09" class="pw-post-body-paragraph jy jz iq ka b kb nc kd ke kf nd kh ki kj ne kl km kn nf kp kq kr ng kt ku kv ij bi translated">在这种方法中，我们执行与第一种方法相同的步骤，但是这里不是制作字符字典，而是制作我们想要处理的文本中使用的单词的字典，或者有时我们使用文本语言中最常见的 10，000 个单词。</p><p id="3e59" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了便于理解我们将要做的事情，我们将:</p><ol class=""><li id="2dff" class="kw kx iq ka b kb kc kf kg kj ky kn kz kr la kv od lc ld le bi translated">将文本转换为小写</li><li id="b472" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv od lc ld le bi translated">清除数字和标点符号中的数据。</li><li id="e935" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv od lc ld le bi translated">将“SOS”和“EOS”附加到目标数据:</li></ol><blockquote class="oe of og"><p id="0218" class="jy jz oh ka b kb kc kd ke kf kg kh ki oi kk kl km oj ko kp kq ok ks kt ku kv ij bi translated">SOS →感知开始</p><p id="af5d" class="jy jz oh ka b kb kc kd ke kf kg kh ki oi kk kl km oj ko kp kq ok ks kt ku kv ij bi translated">EOS →感觉结束</p></blockquote><p id="bc2b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">4.制作字典将单词转换成索引数字。</p><p id="2974" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">5.使用嵌入层将每个单词转换为固定长度的向量。</p><blockquote class="oe of og"><p id="01f0" class="jy jz oh ka b kb kc kd ke kf kg kh ki oi kk kl km oj ko kp kq ok ks kt ku kv ij bi translated">单词嵌入提供了单词及其相关含义的密集表示。</p></blockquote><p id="8c86" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">了解更多关于单词嵌入的信息:[ <a class="ae lr" href="https://machinelearningmastery.com/use-word-embedding-layers-deep-learning-keras/" rel="noopener ugc nofollow" target="_blank"> 1 </a>，[ <a class="ae lr" href="https://keras.io/layers/embeddings/" rel="noopener ugc nofollow" target="_blank"> 2 </a>，[ <a class="ae lr" href="https://www.youtube.com/watch?v=5PL0TmQhItY" rel="noopener ugc nofollow" target="_blank"> 3 </a>，[ <a class="ae lr" href="https://www.youtube.com/watch?v=Qu-cvY4HP4g" rel="noopener ugc nofollow" target="_blank"> 4 </a> ]</p><p id="6324" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">6.现在，seq2seq 网络可以使用这些数据了。</p></div><div class="ab cl lk ll hu lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="ij ik il im in"><p id="f60c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">加载文本数据:</p><figure class="ni nj nk nl gt jr"><div class="bz fp l di"><div class="nw nx l"/></div></figure><h2 id="5837" class="mq lt iq bd lu mr ms dn ly mt mu dp mc kj mv mw mg kn mx my mk kr mz na mo nb bi translated">数据清理:</h2><figure class="ni nj nk nl gt jr"><div class="bz fp l di"><div class="nw nx l"/></div></figure><h2 id="413a" class="mq lt iq bd lu mr ms dn ly mt mu dp mc kj mv mw mg kn mx my mk kr mz na mo nb bi translated">样品处理:</h2><figure class="ni nj nk nl gt jr"><div class="bz fp l di"><div class="nw nx l"/></div></figure><h2 id="0e49" class="mq lt iq bd lu mr ms dn ly mt mu dp mc kj mv mw mg kn mx my mk kr mz na mo nb bi translated">使用单词嵌入:</h2><p id="c2cc" class="pw-post-body-paragraph jy jz iq ka b kb nc kd ke kf nd kh ki kj ne kl km kn nf kp kq kr ng kt ku kv ij bi translated">我将展示我使用嵌入层的那一行，整个网络将在本系列教程的下一部分解释。</p><figure class="ni nj nk nl gt jr"><div class="bz fp l di"><div class="nw nx l"/></div></figure><pre class="ni nj nk nl gt nn no np nq aw nr bi"><span id="b176" class="mq lt iq no b gy ns nt l nu nv">num_words : is the number of words in the dictionary we used to convert words to numbers<br/>vec_len : The length of the vector that will represent the words</span></pre></div><div class="ab cl lk ll hu lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="ij ik il im in"><h1 id="6396" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">接下来是什么:</h1><p id="31b7" class="pw-post-body-paragraph jy jz iq ka b kb nc kd ke kf nd kh ki kj ne kl km kn nf kp kq kr ng kt ku kv ij bi translated">在下一部分[ <a class="ae lr" href="https://medium.com/@mamarih1/nlp-sequence-to-sequence-networks-part-2-seq2seq-model-encoderdecoder-model-6c22e29fd7e1" rel="noopener"> <strong class="ka ir"> part 2 </strong> </a> ]我们将制作模型并训练它，然后用它将英文文本翻译成法文。</p></div><div class="ab cl lk ll hu lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="ij ik il im in"><h2 id="6668" class="mq lt iq bd lu mr ms dn ly mt mu dp mc kj mv mw mg kn mx my mk kr mz na mo nb bi translated">参考资料:</h2><p id="58e8" class="pw-post-body-paragraph jy jz iq ka b kb nc kd ke kf nd kh ki kj ne kl km kn nf kp kq kr ng kt ku kv ij bi translated">这个系列的所有参考资料将在最后一部分的结尾。</p></div><div class="ab cl lk ll hu lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="ij ik il im in"><p id="de7c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">可以在 Twitter 上关注我</strong><a class="ae lr" href="https://twitter.com/ModMaamari" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir">@ ModMaamari</strong></a></p></div><div class="ab cl lk ll hu lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="ij ik il im in"><h1 id="db8e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp bi translated">NLP |序列到序列网络:</h1><p id="9410" class="pw-post-body-paragraph jy jz iq ka b kb nc kd ke kf nd kh ki kj ne kl km kn nf kp kq kr ng kt ku kv ij bi translated"><a class="ae lr" rel="noopener" target="_blank" href="/nlp-sequence-to-sequence-networks-part-1-processing-text-data-d141a5643b72"> 1- NLP |序列到序列网络|第 1 部分|处理文本数据</a></p><p id="780b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2- <a class="ae lr" href="https://medium.com/@mamarih1/nlp-sequence-to-sequence-networks-part-2-seq2seq-model-encoderdecoder-model-6c22e29fd7e1" rel="noopener"> NLP |序列到序列网络|第 2 部分|Seq2seq 模型(编码器解码器模型)</a></p></div><div class="ab cl lk ll hu lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="ij ik il im in"><h2 id="4c60" class="mq lt iq bd lu mr ms dn ly mt mu dp mc kj mv mw mg kn mx my mk kr mz na mo nb bi translated">您可能还喜欢:</h2><ul class=""><li id="f420" class="kw kx iq ka b kb nc kf nd kj ol kn om kr on kv lb lc ld le bi translated"><a class="ae lr" href="https://blog.goodaudience.com/ai-generates-taylor-swifts-song-lyrics-6fd92a03ef7e" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> AI 生成泰勒斯威夫特的歌词</strong> </a></li><li id="8e72" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated"><a class="ae lr" href="https://medium.com/@mamarih1/deep-neural-networks-for-regression-problems-81321897ca33" rel="noopener"> <strong class="ka ir">深度神经网络用于回归问题</strong> </a></li><li id="91e6" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated"><a class="ae lr" href="https://medium.com/@mamarih1/machine-learning-crash-course-with-tensorflow-apis-summary-524e0fa0a606" rel="noopener"> <strong class="ka ir">带 TensorFlow APIs 的机器学习速成班汇总</strong> </a></li><li id="5133" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated"><a class="ae lr" href="https://medium.com/@mamarih1/how-to-make-a-cnn-using-tensorflow-and-keras-dd0aaaed8ab4" rel="noopener"> <strong class="ka ir">如何使用 Tensorflow 和 Keras </strong> </a>制作 CNN</li><li id="086b" class="kw kx iq ka b kb lf kf lg kj lh kn li kr lj kv lb lc ld le bi translated"><a class="ae lr" href="https://medium.com/@mamarih1/how-to-choose-the-best-machine-learning-model-e1dbb46bdd4d" rel="noopener"> <strong class="ka ir">如何选择最好的机器学习模型？</strong>T11】</a></li></ul></div></div>    
</body>
</html>