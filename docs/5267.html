<html>
<head>
<title>The Final Act — Just Like a Naïve Bayes Pro!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">最后一幕——就像一个天真的贝叶斯专家！</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-final-act-just-like-a-na%C3%AFve-bayes-pro-5c440b511b8d?source=collection_archive---------8-----------------------#2018-10-07">https://towardsdatascience.com/the-final-act-just-like-a-na%C3%AFve-bayes-pro-5c440b511b8d?source=collection_archive---------8-----------------------#2018-10-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a47b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">对于 ML 初学者</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/bcbbb2854adad01d02fb57851ce3407a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8-k5aJf3tTfHklmqApprhQ.jpeg"/></div></div></figure><p id="0535" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">从零开始展开朴素贝叶斯！Take-3🎬</p><p id="7888" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">你几乎是在掩盖朴素贝叶斯文本分类算法的所有方面。</p><blockquote class="ln lo lp"><p id="4484" class="kr ks lq kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated"><em class="iq">以防你错过了之前的博文，你可以参考下面的链接</em></p><p id="1543" class="kr ks lq kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated"><a class="ae lu" rel="noopener" target="_blank" href="/unfolding-naïve-bayes-from-scratch-2e86dcae4b01"> <strong class="kt ir"> <em class="iq">从零开始展开朴素贝叶斯 Take-1🎬</em> </strong> </a> <em class="iq">！一个简单明了的朴素贝叶斯解释，以便在开始编码之前清楚地了解这个算法是如何工作的</em></p><p id="7bf9" class="kr ks lq kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated"><a class="ae lu" rel="noopener" target="_blank" href="/naïve-bayes-from-scratch-using-python-only-no-fancy-frameworks-a1904b37222d"> <strong class="kt ir"> <em class="iq">从零开始展开朴素贝叶斯！</em>take-2</strong><em class="iq">🎬</em> </a> <em class="iq">:在转向 python 的 ML 工具包之前，在基本 python 中从头实现朴素贝叶斯只是为了巩固核心理解</em></p></blockquote><h2 id="dd21" class="lv lw iq bd lx ly lz dn ma mb mc dp md la me mf mg le mh mi mj li mk ml mm mn bi translated">目标受众是谁？🗣 🗣 🗣</h2><p id="7fd8" class="pw-post-body-paragraph kr ks iq kt b ku mo jr kw kx mp ju kz la mq lc ld le mr lg lh li ms lk ll lm ij bi translated">就像我在以前的博客文章中提到的一样，这篇文章也是为 ML 初学者准备的——关注基本概念。</p><h2 id="59d8" class="lv lw iq bd lx ly lz dn ma mb mc dp md la me mf mg le mh mi mj li mk ml mm mn bi translated">本教程的成果—NB 的实践 Scikit-learn 实施</h2><p id="be16" class="pw-post-body-paragraph kr ks iq kt b ku mo jr kw kx mp ju kz la mq lc ld le mr lg lh li ms lk ll lm ij bi translated">使用 Python 的机器学习框架 Scikit-learn 实现 NB 的完整演练</p><h1 id="a647" class="mt lw iq bd lx mu mv mw ma mx my mz md jw na jx mg jz nb ka mj kc nc kd mm nd bi translated">定义路线图…..🚵</h1><p id="b7bb" class="pw-post-body-paragraph kr ks iq kt b ku mo jr kw kx mp ju kz la mq lc ld le mr lg lh li ms lk ll lm ij bi translated"><strong class="kt ir">里程碑# 1: </strong> <a class="ae lu" href="#e4a9" rel="noopener ugc nofollow"> <strong class="kt ir">预处理训练数据集</strong> </a></p><p id="eb02" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">里程碑# 2: </strong> <a class="ae lu" href="#6198" rel="noopener ugc nofollow"> <strong class="kt ir">在预处理的训练数据集上训练 NB 模型</strong> </a></p><p id="6b60" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">里程碑# 3: </strong> <a class="ae lu" href="#2959" rel="noopener ugc nofollow"> <strong class="kt ir">使用训练好的 NB 模型</strong> </a>进行测试</p><p id="68c9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">里程碑# 4: </strong> <a class="ae lu" href="#ad35" rel="noopener ugc nofollow"> <strong class="kt ir">培训&amp;使用 Scikit 测试-学习管道功能</strong> </a></p><blockquote class="ne"><p id="e4a9" class="nf ng iq bd nh ni nj nk nl nm nn lm dk translated">让我们从 Scikit-learn 实现开始吧！</p></blockquote><h1 id="c164" class="mt lw iq bd lx mu mv mw ma mx my mz md jw no jx mg jz np ka mj kc nq kd mm nd bi translated"><strong class="ak">预处理训练数据集</strong></h1><p id="de2b" class="pw-post-body-paragraph kr ks iq kt b ku mo jr kw kx mp ju kz la mq lc ld le mr lg lh li ms lk ll lm ij bi translated">一些进口货…</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="1374" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">预处理函数与<a class="ae lu" rel="noopener" target="_blank" href="/naïve-bayes-from-scratch-using-python-only-no-fancy-frameworks-a1904b37222d">从头开始展开朴素贝叶斯中定义的相同！Take-2🎬</a></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><h2 id="cdb0" class="lv lw iq bd lx ly lz dn ma mb mc dp md la me mf mg le mh mi mj li mk ml mm mn bi translated">正在加载 20 个新闻组数据集</h2><p id="e24b" class="pw-post-body-paragraph kr ks iq kt b ku mo jr kw kx mp ju kz la mq lc ld le mr lg lh li ms lk ll lm ij bi translated">这与之前在<a class="ae lu" rel="noopener" target="_blank" href="/naïve-bayes-from-scratch-using-python-only-no-fancy-frameworks-a1904b37222d">从头开始展开朴素贝叶斯中使用的数据集相同！Take-2🎬</a></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="e25e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这是原始形式的训练数据集的样子…..</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/c2aa4fd4812712c5a4f72e01164a0e5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1166/format:webp/1*PPPsiBPxPeQqvyKphqKrQg.png"/></div></figure><p id="ac09" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们从训练数据集的预处理开始，包括</p><ol class=""><li id="b9d4" class="nu nv iq kt b ku kv kx ky la nw le nx li ny lm nz oa ob oc bi translated">文本清理</li><li id="270c" class="nu nv iq kt b ku od kx oe la of le og li oh lm nz oa ob oc bi translated">创建我们的训练数据集的 BoW 表示(测试数据集也需要同样的表示)</li></ol><p id="bcfd" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">文字清理</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="b747" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">处理后的训练数据集如下所示</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/ab01e0b0ac49623377ed3942cb28df00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1104/format:webp/1*PRyCJsnVBSky0tVUMBoo9w.png"/></div></figure><p id="4b5f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">创建我们的训练数据集的 BoW 表示</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><blockquote class="ln lo lp"><p id="35f7" class="kr ks lq kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated"><strong class="kt ir"><em class="iq">count vectorizer 上的几行</em> </strong></p><p id="f90d" class="kr ks lq kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated"><em class="iq">计数矢量器的作用是什么？<br/>接收文本语料库，建立其术语文档矩阵(即 BoW ),并将其返回</em></p><p id="52f8" class="kr ks lq kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated"><em class="iq">每个单词被分配一个固定的唯一整数 id，该矩阵的每个单元的值代表单词计数——BoW</em></p><p id="6733" class="kr ks lq kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated"><em class="iq">例如，X_train_counts[ i，j ] ( i 指的是一个文档，在我们的例子中，每个文档指定一个训练示例，j 指的是单词 w 在其各自的文档 I 中的索引)将返回单词 j 的计数</em></p></blockquote><p id="1a18" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">下面是 X_train_counts 矩阵的样子:<br/> X_train_counts[0，12048]将检索整数 id = 12048、文档/示例 id 为 0 的 word 的字数</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/b83993752c90d618122f4276fe4085ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xcLurU6o1sT9KKSWydEeJg.png"/></div></div></figure><p id="0673" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">里程碑# 1 已实现</strong>👍</p></div><div class="ab cl ok ol hu om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="ij ik il im in"><h1 id="568e" class="mt lw iq bd lx mu or mw ma mx os mz md jw ot jx mg jz ou ka mj kc ov kd mm nd bi translated"><strong class="ak">在预处理的训练数据集上训练 NB 模型</strong></h1><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="8ae9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">简单地在实例化一个 NB 对象后，我们调用<em class="lq">拟合函数</em>来训练一个 NB 模型。我们将简单地传递训练示例作为第一个参数&amp;训练集标签作为第二个参数。</p><blockquote class="ln lo lp"><p id="76dc" class="kr ks lq kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated"><em class="iq">注意，X_train_counts(术语文档矩阵)作为训练示例而不是文本数据被传递</em></p></blockquote><p id="61d3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们只用 3 行代码就完成了培训！</p><p id="13fd" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">里程碑# 2 已实现</strong>👍 👍</p></div><div class="ab cl ok ol hu om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="ij ik il im in"><h1 id="1f66" class="mt lw iq bd lx mu or mw ma mx os mz md jw ot jx mg jz ou ka mj kc ov kd mm nd bi translated"><strong class="ak">使用经过训练的 NB 模型进行测试</strong></h1><p id="2b55" class="pw-post-body-paragraph kr ks iq kt b ku mo jr kw kx mp ju kz la mq lc ld le mr lg lh li ms lk ll lm ij bi translated">在我们开始测试之前，我们将首先需要以与训练数据集相同的方式对其进行预处理</p><p id="2148" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">测试设置文本清理</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="c193" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">创建测试数据集的 BoW 表示<br/> </strong>为训练数据集实例化的相同 count_vect 对象将用于测试数据集。但是请记住，我们不是在测试集上调用 fit_transform，因为我们只想将测试数据转换为术语-文档矩阵，而 fit_transform 首先学习词汇词典，然后返回术语-文档矩阵。我们应该只学习训练数据集中的词汇</p><pre class="kg kh ki kj gt ow ox oy oz aw pa bi"><span id="c86c" class="lv lw iq ox b gy pb pc l pd pe">fit_transform : learns the vocabulary dictionary and returns term-document matrix</span><span id="cc19" class="lv lw iq ox b gy pf pc l pd pe">transform : transforms documents to document-term matrix</span></pre><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="0572" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">现在我们可以在测试数据集的转换版本上进行测试</strong></p><p id="d82c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们将简单地调用为 NB 模型拟合/训练的 clf 对象上的预测函数</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pg"><img src="../Images/26f571155725d6defdc67dc88a4ebece.png" data-original-src="https://miro.medium.com/v2/resize:fit:814/format:webp/1*yrt0U7ykJQaqzLi6CN1lDg.png"/></div></div></figure><blockquote class="ln lo lp"><p id="12ac" class="kr ks lq kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated"><strong class="kt ir"> <em class="iq">里程碑# 3 实现</em> </strong> <em class="iq">👍 👍 👍</em></p></blockquote></div><div class="ab cl ok ol hu om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="ij ik il im in"><h1 id="08ad" class="mt lw iq bd lx mu or mw ma mx os mz md jw ot jx mg jz ou ka mj kc ov kd mm nd bi translated"><strong class="ak">培训&amp;使用 Scikit 测试-学习管道功能</strong></h1><p id="5c0e" class="pw-post-body-paragraph kr ks iq kt b ku mo jr kw kx mp ju kz la mq lc ld le mr lg lh li ms lk ll lm ij bi translated">管道创造奇迹！通过使用 sklearn 的管道功能，上述代码可以进一步减少到 3 行代码</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><blockquote class="ln lo lp"><p id="19e7" class="kr ks lq kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated">我们只需通过指定管道动作来构建一个管道对象，一旦该管道对象用于训练，它将按照指定的顺序自动执行管道步骤。</p><p id="8d96" class="kr ks lq kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated"><em class="iq">在我们的例子中，因为我们首先需要为 BoW 构建一个 CountVectorizer，然后拟合/训练一个 NB 模型，所以以完全相同的方式，我们将在管道中指定这些操作。</em></p><p id="9f7c" class="kr ks lq kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated"><em class="iq">请注意，现在当调用 fir 方法时，我们将传递原始文本数据，因为现在管道中的 count_vect 将自己将其转换为数字形式。因此，在这里传递文本数据很重要，否则会出现令人讨厌的错误。测试数据也是如此。不需要单独对其进行计数矢量化，但我们需要从清理的角度对测试数据进行预处理</em></p></blockquote><p id="084c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">最后一部分——测试</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><blockquote class="ne"><p id="661c" class="nf ng iq bd nh ni ph pi pj pk pl lm dk translated">所有的培训和测试只需 3 行代码！</p></blockquote><figure class="pn po pp pq pr kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pm"><img src="../Images/d632b226a55558d3dd5f0c7807bcb022.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cHz2cUq8zLjjSsB_e9vexw.jpeg"/></div></div></figure><h1 id="e34f" class="mt lw iq bd lx mu mv mw ma mx my mz md jw na jx mg jz nb ka mj kc nc kd mm nd bi translated">你做到了！</h1><blockquote class="ln lo lp"><p id="8bc9" class="kr ks lq kt b ku kv jr kw kx ky ju kz lr lb lc ld ls lf lg lh lt lj lk ll lm ij bi translated"><strong class="kt ir"> <em class="iq">里程碑# 4 实现</em> </strong> <em class="iq">👍 👍 👍 👍</em></p></blockquote></div><div class="ab cl ok ol hu om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="ij ik il im in"><p id="68c6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">你可以在 Jupyter 笔记本<a class="ae lu" href="https://github.com/aishajv/Unfolding-Naive-Bayes-from-Scratch/blob/master/%23%20Unfolding%20Na%C3%AFve%20Bayes%20from%20Scratch!%20Take-3%20%F0%9F%8E%AC.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir">这里</strong> </a>找到所有源代码</p><p id="8662" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果您有任何想法、意见或问题，欢迎在下面评论或联系📞与我一起上<a class="ae lu" href="https://www.linkedin.com/in/aisha-javed/" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir"> LinkedIn </strong> </a></p></div></div>    
</body>
</html>