<html>
<head>
<title>My nephew vs ML</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我的侄子vs曼梯·里</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/my-nephew-vs-ml-9e4519af499a?source=collection_archive---------1-----------------------#2017-04-02">https://towardsdatascience.com/my-nephew-vs-ml-9e4519af499a?source=collection_archive---------1-----------------------#2017-04-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="e25a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我4岁的侄子Yali现在非常喜欢口袋妖怪。他有多个口袋妖怪玩具和一些TCG(训练卡游戏)卡。</p><p id="44b8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">前几天，亚力发现了我藏起来的恶心的TCG牌，现在他的牌多得数不清了。</p><p id="d495" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">问题是雅丽太小了，还不知道如何玩真正的游戏，所以现在他发明了自己的游戏。游戏的目的是根据卡片的类型(口袋妖怪、能量和教练卡)对卡片进行分类。</p><p id="82e5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">他没有问我怎么知道卡是什么类型的，他拿了几张卡，问我是什么类型的。在我回答了几个问题后，他能够根据卡片的类型(有多个错误)来区分它们。</p><p id="c9fd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那一刻我意识到，我的侄子基本上是一个机器学习算法，我作为叔叔的任务是为他标记数据。</p><p id="7a2e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">作为一个极客大叔和机器学习爱好者，我开始编写一个将与Yali竞争的程序。</p><p id="c88c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是典型的口袋妖怪卡片的样子:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/7de497a64b8023cbd4757b1bcc7484ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:624/format:webp/0*RvXhDbjQIvodjgYb.jpg"/></div><figcaption class="kt ku gj gh gi kv kw bd b be z dk">source: pkmncards</figcaption></figure><p id="fb0a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于一个知道如何阅读的成年人来说，辨别卡片的类型是很容易的，因为它就写在卡片的顶部。但是亚力才4岁，他不知道怎么读书。简单的OCR会很快解决我的问题，但我不想做任何假设。所以我照原样拿着这张卡，用MLP算法把它扔给一个神经网络。</p><p id="fc1b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">获取数据非常简单。多亏了<a class="ae kx" href="https://pkmncards.com/" rel="noopener ugc nofollow" target="_blank"> pkmncards </a>，我可以下载多张卡片的图片，这些图片已经被分成了Yali的类别。</p><p id="81b1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">机器学习算法需要特征，而我的特征就是图像像素。使用RGB彩色图像，我将三种颜色转换成一个整数。</p><p id="304e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于图像大小不同，我不得不将它们标准化。在找到数据的最大宽度和高度后，我给小图片添加了零填充。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ky"><img src="../Images/8b10b5021547547f4c9052b105b9d4d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1388/format:webp/1*yk029gW9jpQcqkME0NRk-A.jpeg"/></div></figure><p id="034d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">真正交易前的快速质量保证周期。我随机抽取每种类型的两张卡片，然后进行预测。每一类只用了100张卡片，拟合速度惊人的快，预测也很糟糕。然后，我为每个类别抽取了500个样本(不包括能源类型，它只有130个样本)，并让拟合运行。</p><p id="0a82" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">内存不足异常。在云中运行拟合代码应该可行，但我想找到一种使用更少空间的方法。最大的图像尺寸是800x635，这太大了。调整图像大小解决了我的问题。</p><p id="76a5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于真正的测试，除了常规的卡片，我还添加了我在上面画画、剪成两半、画上形状、从我的手机(它的相机很差)上拍一张照片以及其他特殊效果的卡片。重要的是，我没有用这些卡片训练网络。</p><p id="4cb9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我试过一千多种型号(准确的说是1533种)。不同的图像尺寸、隐藏层数(最多3层)和层长度(最多100层)、图像颜色、读取类型(全图、上半部分、每隔一个像素等)。</p><p id="81b6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在对所有模型进行了几个小时的拟合后，最好的分数是25张卡中的2个错误(少数模型有这个分数，但每个模型在不同的卡上都失败了。所有这些都是图像的灰度版本)。</p><p id="c240" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1533个模型中有9个出现了2个错误。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="la lb di lc bf ld"><div class="gh gi kz"><img src="../Images/b000ccf98db8d43ce7fde1fc391a7d2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v-j8543BExBOlB4EKIvP-Q.jpeg"/></div></div></figure><p id="2347" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我将我的阈值设置为高于44%的一致，模型的组合将给我1个错误的分数。对于测试，我将使用50%的阈值。</p><p id="2e41" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让雅丽玩了一个月，我回来测试。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi le"><img src="../Images/f20348a97c5da2a42d7a4445cc2e28fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*Vmw4fqgvZVnFCI1GCFDVQg.jpeg"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lf"><img src="../Images/a2a5b4652d9b15c91e86c217301e188c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*y-w7HcLnb7OqT569azDQMQ.jpeg"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lg"><img src="../Images/cd0e9607fea9c75f37d4b1eb7f3d63ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1054/format:webp/1*8tvLq5dDRRPvomejwYEqLQ.jpeg"/></div></figure><p id="0ce0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">赢了！23个给机器，21个给人类。</p><p id="cc53" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如你所见，错误只发生在能量卡上。pkmncards只有130张能量卡，而不是其他类型的数千张。可供学习的样本更少。</p><p id="0f92" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">问雅丽他是怎么认出一些卡片的，他告诉我他在电视节目或书中看到过一些口袋妖怪。这就是他如何认出雷丘的耳朵或者知道蒸汽是水的原因。我的程序没有那种数据，我仅有的数据是卡片。</p><p id="4267" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我们的英雄在口袋妖怪挑战赛中击败雅丽并获得ML徽章时，他开始了他的下一次冒险。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lh"><img src="../Images/4483a746b0b1f4e8d7b73ff5ac238393.png" data-original-src="https://miro.medium.com/v2/resize:fit:518/format:webp/1*f1FFoAWrFyUGEMUr0_tU8Q.jpeg"/></div></figure></div></div>    
</body>
</html>