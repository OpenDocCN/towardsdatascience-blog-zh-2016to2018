<html>
<head>
<title>Sentiment Analysis with Python (Part 1)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Python 进行情感分析(第 1 部分)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/sentiment-analysis-with-python-part-1-5ce197074184?source=collection_archive---------0-----------------------#2018-07-31">https://towardsdatascience.com/sentiment-analysis-with-python-part-1-5ce197074184?source=collection_archive---------0-----------------------#2018-07-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3510" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">IMDb 电影评论分类</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/39ea1c787da8dfec04a30a4851edbbdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QNAbWft5y0_zjPzOszIlhQ.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/photos/2We0jzrMLYc?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Denise Jans</a> on <a class="ae kv" href="https://unsplash.com/search/photos/movie-theatre?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="a6ae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">情感分析是数据科学家需要执行的一项常见 NLP 任务。这是一个用 Python 创建准系统电影评论分类器的简单指南。本系列的后续部分将重点改进分类器。</p><p id="5d0e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">本系列中使用的所有代码以及补充材料都可以在这个<a class="ae kv" href="https://github.com/aaronkub/machine-learning-examples/tree/master/imdb-sentiment-analysis" rel="noopener ugc nofollow" target="_blank"> GitHub 资源库</a>中找到。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="e375" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">数据概述</h1><p id="b59d" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">在这项分析中，我们将使用来自 IMDb 的 50，000 条电影评论的数据集。这些数据由安德鲁·马斯汇编，可以在这里找到:<a class="ae kv" href="http://ai.stanford.edu/~amaas/data/sentiment/" rel="noopener ugc nofollow" target="_blank"> IMDb 评论</a>。</p><p id="d0d7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">数据被平均分割，25k 条评论用于训练，25k 条用于测试你的分类器。而且每套都有 12.5k 的正面和 12.5k 的负面评论。</p><p id="fd9f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">IMDb 让用户从 1 到 10 给电影打分。为了给这些评论贴上标签，数据管理员将≤ 4 星的评论标为负面，将≥ 7 星的评论标为正面。5 星或 6 星的评论被排除在外。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="983c" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">第一步:下载并合并电影评论</h1><p id="fb5a" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">如果你还没有，去<a class="ae kv" href="http://ai.stanford.edu/~amaas/data/sentiment/" rel="noopener ugc nofollow" target="_blank"> IMDb 评论</a>点击“大电影评论数据集 1.0 版”。一旦完成，在你的下载文件夹中就会有一个名为<code class="fe mw mx my mz b">aclImdb_v1.tar.gz</code>的文件。</p><p id="68d9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">快捷方式:</strong>如果您想直接进行数据分析和/或对终端不太熟悉，我在这里放了一个这个步骤创建的最终目录的 tar 文件:<a class="ae kv" href="https://github.com/aaronkub/machine-learning-examples/blob/master/imdb-sentiment-analysis/movie_data.tar.gz" rel="noopener ugc nofollow" target="_blank">合并的电影数据</a>。双击这个文件应该足以解压它(至少在 Mac 上)，否则终端中的<code class="fe mw mx my mz b">gunzip -c movie_data.tar.gz | tar xopf —</code>就会这么做。</p><h2 id="dedd" class="na ma iq bd mb nb nc dn mf nd ne dp mj lf nf ng ml lj nh ni mn ln nj nk mp nl bi translated">拆包和合并</h2><p id="9a8f" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">遵循这些步骤或者在这里运行 shell 脚本:<a class="ae kv" href="https://github.com/aaronkub/machine-learning-examples/blob/master/imdb-sentiment-analysis/preprocess_reviews.sh" rel="noopener ugc nofollow" target="_blank">预处理脚本</a></p><ol class=""><li id="02eb" class="nm nn iq ky b kz la lc ld lf no lj np ln nq lr nr ns nt nu bi translated">将 tar 文件移动到您希望存储这些数据的目录中。</li><li id="4e47" class="nm nn iq ky b kz nv lc nw lf nx lj ny ln nz lr nr ns nt nu bi translated">打开一个终端窗口，<code class="fe mw mx my mz b">cd</code>到你放<code class="fe mw mx my mz b">aclImdb_v1.tar.gz</code>的目录。</li><li id="0653" class="nm nn iq ky b kz nv lc nw lf nx lj ny ln nz lr nr ns nt nu bi translated"><code class="fe mw mx my mz b">gunzip -c aclImdb_v1.tar.gz | tar xopf -</code></li><li id="55e2" class="nm nn iq ky b kz nv lc nw lf nx lj ny ln nz lr nr ns nt nu bi translated"><code class="fe mw mx my mz b">cd aclImdb &amp;&amp; mkdir movie_data</code></li><li id="b452" class="nm nn iq ky b kz nv lc nw lf nx lj ny ln nz lr nr ns nt nu bi translated"><code class="fe mw mx my mz b">for split in train test; do for sentiment in pos neg; do for file in $split/$sentiment/*; do cat $file &gt;&gt; movie_data/full_${split}.txt; echo &gt;&gt; movie_data/full_${split}.txt; done; done; done;</code></li></ol></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="5c7a" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">步骤 2:读入 Python</h1><p id="a87f" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">对于本演练中我们想要做的大多数事情，我们只需要我们的评论在 Python <code class="fe mw mx my mz b">list</code>中。确保将<code class="fe mw mx my mz b">open</code>指向存放电影数据的目录。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oa ob l"/></div></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="112a" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">步骤 3:清理和预处理</h1><p id="9486" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">这些评论的原始文本相当混乱，所以在我们进行任何分析之前，我们需要清理一下。这里有一个例子:</p><pre class="kg kh ki kj gt oc mz od oe aw of bi"><span id="88fc" class="na ma iq mz b gy og oh l oi oj">"This isn't the comedic Robin Williams, nor is it the quirky/insane Robin Williams of recent thriller fame. This is a hybrid of the classic drama without over-dramatization, mixed with Robin's new love of the thriller. But this isn't a thriller, per se. This is more a mystery/suspense vehicle through which Williams attempts to locate a sick boy and his keeper.&lt;br /&gt;&lt;br /&gt;Also starring Sandra Oh and Rory Culkin, this Suspense Drama plays pretty much like a news report, until William's character gets close to achieving his goal.&lt;br /&gt;&lt;br /&gt;I must say that I was highly entertained, though this movie fails to teach, guide, inspect, or amuse. It felt more like I was watching a guy (Williams), as he was actually performing the actions, from a third person perspective. In other words, it felt real, and I was able to subscribe to the premise of the story.&lt;br /&gt;&lt;br /&gt;All in all, it's worth a watch, though it's definitely not Friday/Saturday night fare.&lt;br /&gt;&lt;br /&gt;It rates a 7.7/10 from...&lt;br /&gt;&lt;br /&gt;the Fiend :."</span></pre><p id="fddb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">注意:</strong>理解并能够使用正则表达式是执行任何自然语言处理任务的先决条件。如果你不熟悉它们，也许可以从这里开始:<a class="ae kv" href="https://medium.com/factory-mind/regex-tutorial-a-simple-cheatsheet-by-examples-649dc1c3f285" rel="noopener">正则表达式教程</a></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="ed26" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是同样的评论现在的样子:</p><pre class="kg kh ki kj gt oc mz od oe aw of bi"><span id="2f01" class="na ma iq mz b gy og oh l oi oj">"this isnt the comedic robin williams nor is it the quirky insane robin williams of recent thriller fame this is a hybrid of the classic drama without over dramatization mixed with robins new love of the thriller but this isnt a thriller per se this is more a mystery suspense vehicle through which williams attempts to locate a sick boy and his keeper also starring sandra oh and rory culkin this suspense drama plays pretty much like a news report until williams character gets close to achieving his goal i must say that i was highly entertained though this movie fails to teach guide inspect or amuse it felt more like i was watching a guy williams as he was actually performing the actions from a third person perspective in other words it felt real and i was able to subscribe to the premise of the story all in all its worth a watch though its definitely not friday saturday night fare it rates a   from the fiend"</span></pre><p id="c6d8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">注意:</strong>有许多不同的、更复杂的方法来清理文本数据，它们可能会产生比我在这里所做的更好的结果。我希望本教程的第 1 部分尽可能简单。此外，我通常认为，在花费时间进行可能不必要的转换之前，最好用最简单的可能解决方案获得基线预测。</p><h2 id="9031" class="na ma iq bd mb nb nc dn mf nd ne dp mj lf nf ng ml lj nh ni mn ln nj nk mp nl bi translated">…向量化…</h2><p id="43a4" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">为了让这些数据对我们的机器学习算法有意义，我们需要将每个评论转换成数字表示，我们称之为<em class="ok">矢量化</em>。</p><p id="36ae" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最简单的形式是创建一个非常大的矩阵，用一列来表示语料库中的每个独特的单词(在我们的例子中，语料库是所有 50k 篇评论)。然后我们将每个评论转换成包含 0 和 1 的一行，其中 1 表示与该列对应的<em class="ok">语料库</em>中的单词出现在那个<em class="ok">评论</em>中。也就是说，矩阵的每一行都非常稀疏(大部分是零)。这个过程也被称为<em class="ok">一次热编码</em>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oa ob l"/></div></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="3b5a" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">步骤 4:构建分类器</h1><p id="9d5e" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">既然我们已经将数据集转换成适合建模的格式，我们就可以开始构建分类器了。逻辑回归是我们使用的一个很好的基线模型，原因有几个:(1)它们易于解释，(2)线性模型往往在像这样的稀疏数据集上表现良好，以及(3)与其他算法相比，它们学习起来非常快。</p><p id="2eab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了简单起见，我只担心超参数<code class="fe mw mx my mz b">C</code>，它调整<em class="ok">正则化</em>。</p><p id="173e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">注意:</strong>我们用于训练和测试的目标/标签将是相同的，因为两个数据集的结构相同，其中第一个 12.5k 是正的，最后一个 12.5k 是负的。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="7ac5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">看起来给我们最高精度的 C 值是<code class="fe mw mx my mz b">0.05</code>。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h2 id="1761" class="na ma iq bd mb nb nc dn mf nd ne dp mj lf nf ng ml lj nh ni mn ln nj nk mp nl bi translated">列车最终模型</h2><p id="0894" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">现在我们已经找到了 C 的最佳值，我们应该使用整个训练集训练一个模型，并评估我们在 25k 测试评论上的准确性。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="9e45" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">作为一个理智的检查，让我们来看看正面和负面评论中最有区别的 5 个词。我们将通过分别查看最大和最小系数来做到这一点。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oa ob l"/></div></figure><p id="90a7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这就是了。一个非常简单的分类器，开箱后具有相当不错的准确性。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="0c6b" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">下次</h1><p id="46c2" class="pw-post-body-paragraph kw kx iq ky b kz mr jr lb lc ms ju le lf mt lh li lj mu ll lm ln mv lp lq lr ij bi translated">在本系列的下一部分中，我们将研究更复杂的方法来提高分类器的性能。</p><ul class=""><li id="8664" class="nm nn iq ky b kz la lc ld lf no lj np ln nq lr ol ns nt nu bi translated"><strong class="ky ir">文本处理</strong>:词干化/词条化，将每个单词的不同形式转化为一个。</li><li id="99be" class="nm nn iq ky b kz nv lc nw lf nx lj ny ln nz lr ol ns nt nu bi translated"><strong class="ky ir"> n-grams </strong>:除了单词标记(1-gram/unigram)，我们还可以包含单词对。</li><li id="f775" class="nm nn iq ky b kz nv lc nw lf nx lj ny ln nz lr ol ns nt nu bi translated"><strong class="ky ir">表示</strong>:代替简单的二进制向量，我们可以使用字数或<em class="ok"> TF-IDF </em>来转换这些计数。</li><li id="4a50" class="nm nn iq ky b kz nv lc nw lf nx lj ny ln nz lr ol ns nt nu bi translated"><strong class="ky ir">算法</strong>:除了逻辑回归，我们还会看看支持向量机的表现。</li></ul><p id="4353" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">点击这里查看:</strong></p><div class="om on gp gr oo op"><a rel="noopener follow" target="_blank" href="/sentiment-analysis-with-python-part-2-4f71e7bde59a"><div class="oq ab fo"><div class="or ab os cl cj ot"><h2 class="bd ir gy z fp ou fr fs ov fu fw ip bi translated">用 Python 进行情感分析(第 2 部分)</h2><div class="ow l"><h3 class="bd b gy z fp ou fr fs ov fu fw dk translated">改进电影评论情感分类器</h3></div><div class="ox l"><p class="bd b dl z fp ou fr fs ov fu fw dk translated">towardsdatascience.com</p></div></div><div class="oy l"><div class="oz l pa pb pc oy pd kp op"/></div></div></a></div></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="2ba9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢阅读！这是我在 Medium 上的第一篇帖子，所以请评论你的任何问题或建议。</p></div></div>    
</body>
</html>