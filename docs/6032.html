<html>
<head>
<title>Experimental Improvement by Extended Cluster Centroid based Majority Under-sampling Technique (E-CCMUT) over CCMUT</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于扩展聚类质心的多数欠采样技术(E-CCMUT)对 CCMUT 的实验改进</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/experimental-improvement-by-extended-cluster-centroid-based-majority-under-sampling-technique-63bcb4e53c25?source=collection_archive---------18-----------------------#2018-11-21">https://towardsdatascience.com/experimental-improvement-by-extended-cluster-centroid-based-majority-under-sampling-technique-63bcb4e53c25?source=collection_archive---------18-----------------------#2018-11-21</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/bae603df707a0036162ee5be38226108.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4aBNZGEihjgR9npipV9jBA.jpeg"/></div></div></figure><p id="6d9b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在我之前的文章《<a class="ae kz" rel="noopener" target="_blank" href="/extended-cluster-centroid-based-majority-under-sampling-technique-e-ccmut-bd3f13e5d0fe"> <em class="la">基于扩展聚类质心的多数欠采样技术(E-CCMUT) </em> </a>》中，我提出了一种新的欠采样算法——基于扩展聚类质心的多数欠采样技术(E-CCMUT)。在本文中，我将演示一个实验，在这个实验中，我将证明 E-CCMUT 比 CCMUT 具有更好的统计结果，并且与 E-CCMUT 的直觉相符。</p><p id="ca84" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">实验:</strong></p><p id="5300" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu"> <em class="la">从人口普查数据中预测一个人的收入水平是否大于 5 万美元</em> </strong>。这与我以前的文章“<a class="ae kz" rel="noopener" target="_blank" href="/under-sampling-a-performance-booster-on-imbalanced-data-a79ff1559fab"> <em class="la">欠采样:不平衡数据的性能助推器</em> </a>”中使用的实验相同，其中 CCMUT 被用作欠采样算法，以便通过实验证明欠采样可以提高模型性能。这里，将使用 E-CCMUT 而不是 CCMUT，并将使用在“<a class="ae kz" rel="noopener" target="_blank" href="/under-sampling-a-performance-booster-on-imbalanced-data-a79ff1559fab"> <em class="la">欠采样:不平衡数据的性能助推器</em> </a>”中导出的结果进行直接性能比较。</p><p id="be17" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">数据集:</strong></p><p id="b132" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><a class="ae kz" href="https://archive.ics.uci.edu/ml/datasets/Adult" rel="noopener ugc nofollow" target="_blank">来自 UCI(加州大学欧文分校)的成人数据集</a></p><p id="c881" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">数据预处理:</strong></p><p id="1450" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">标签编码、特征选择和一键编码按顺序完成，如“<a class="ae kz" rel="noopener" target="_blank" href="/under-sampling-a-performance-booster-on-imbalanced-data-a79ff1559fab"> <em class="la">欠采样:不平衡数据的性能助推器</em> </a>”</p><p id="0c52" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">数据不平衡消除:</strong></p><p id="6a7a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这是使用 E-CCMUT 完成的，其中多数类(标签 0)是 68%的欠采样。E-CCMUT 的 Python 实现如下所示:</p><pre class="lb lc ld le gt lf lg lh li aw lj bi"><span id="9089" class="lk ll it lg b gy lm ln l lo lp">import numpy as np<br/>from math import sqrt</span><span id="20e3" class="lk ll it lg b gy lq ln l lo lp">def <strong class="lg iu">ECCMUT</strong>(X,f):<br/>    cluster_centroid = np.sum(X,axis=0)/X.shape[0]<br/>    euclidean = [None]*X.shape[0]<br/>    for i in range(0,X.shape[0]):<br/>        euclidean[i] = sqrt(sum((cluster_centroid-X[i])**2))<br/>    # finding the most important instance with label 1<br/>    imp_instance = X[euclidean.index(min(euclidean))]<br/>    # removing the instances (under-sampling...)<br/>    for i in range(0,X.shape[0]):<br/>        euclidean[i] = sqrt(sum((imp_instance-X[i])**2))<br/>    indices=list(reversed(sorted(range(len(euclidean)), key=lambda<br/>                j: euclidean[j])))<br/>    X_f = np.delete(X, indices[:int(f/100*X.shape[0])], axis=0)<br/>    return X_f</span></pre><p id="d163" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这里，X 是多数样本矩阵，f 是欠采样的百分比，X_f 是 E-CCMUT 对 X 的欠采样形式，它由 ECCMUT()返回</p><p id="a94b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">洗牌和拆分:</strong></p><p id="8bc3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">产生的数据集以一致的方式进行混洗，并且 80–20 分割(80%训练集和 20%验证集)。</p><p id="83e3" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">学习算法:</strong></p><p id="a334" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">梯度推进分类器用作训练集上的学习算法，并使用网格搜索进行调整。</p><p id="48a5" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">网格搜索后得到 100 个估计量和最大深度为 4 的最优超参数。基于平均分数的模型的网格搜索调整的总结如图 1 所示。</p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/25b2d3b988b03f4c57ec2f5a203cb585.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*Aopm2dIevot3YVMdb4JY5g.png"/></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk"><strong class="bd lw">Fig 1. Grid-Search Summary on Mean-Score</strong></figcaption></figure><p id="8cfe" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">结果:</strong></p><p id="5087" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">使用度量、训练准确度、验证准确度、召回率、精确度、F1 分数、受试者操作者特征曲线下面积(图 2 所示的 AUROC)和混淆矩阵(图 3 所示)来分析模型性能。</p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/e58ed6508728363f02c80a311683faef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*EK2byTtRR4J0vrt_OsG3hA.png"/></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk"><strong class="bd lw">Fig 2. ROC Curve showing the Area Under the Curve</strong></figcaption></figure><figure class="lb lc ld le gt ju gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/55825625c46738ebd16af4d77d8ef181.png" data-original-src="https://miro.medium.com/v2/resize:fit:822/format:webp/1*e4SveXXJDGE0RQDoOYiFcw.png"/></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk"><strong class="bd lw">Fig 3. Normalized Confusion Matrix</strong></figcaption></figure><p id="2c6a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">表 1 中列出了训练准确度、验证准确度、召回率、精确度和 F1 分数。</p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi lz"><img src="../Images/36a58322607910b8a2859225c4530ecd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bzf38A63clAMebmKXGiZqg.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk"><strong class="bd lw">Table 1</strong></figcaption></figure><p id="aaf1" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated"><strong class="kd iu">该模型与使用相同方法但使用 CCMUT 开发的模型的比较</strong>:</p><div class="ma mb gp gr mc md"><a rel="noopener follow" target="_blank" href="/under-sampling-a-performance-booster-on-imbalanced-data-a79ff1559fab"><div class="me ab fo"><div class="mf ab mg cl cj mh"><h2 class="bd iu gy z fp mi fr fs mj fu fw is bi translated">欠采样:不平衡数据的性能助推器</h2><div class="mk l"><h3 class="bd b gy z fp mi fr fs mj fu fw dk translated">在某些情况下，用于开发机器学习/深度学习模型的数据集通常是…</h3></div><div class="ml l"><p class="bd b dl z fp mi fr fs mj fu fw dk translated">towardsdatascience.com</p></div></div><div class="mm l"><div class="mn l mo mp mq mm mr jz md"/></div></div></a></div><p id="658a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">根据上述文章，CCMUT 所取得的结果被考虑在内。模型性能比较基于以下指标:</p><ol class=""><li id="bf61" class="ms mt it kd b ke kf ki kj km mu kq mv ku mw ky mx my mz na bi translated">拟合度量:|训练准确性-验证准确性|</li><li id="236c" class="ms mt it kd b ke nb ki nc km nd kq ne ku nf ky mx my mz na bi translated">验证准确性</li><li id="09b2" class="ms mt it kd b ke nb ki nc km nd kq ne ku nf ky mx my mz na bi translated">精确</li><li id="fafb" class="ms mt it kd b ke nb ki nc km nd kq ne ku nf ky mx my mz na bi translated">回忆</li><li id="e16d" class="ms mt it kd b ke nb ki nc km nd kq ne ku nf ky mx my mz na bi translated">f1-分数</li><li id="cc27" class="ms mt it kd b ke nb ki nc km nd kq ne ku nf ky mx my mz na bi translated">奥罗克</li></ol><p id="4ad6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">对照表如表 2 所示:</p><figure class="lb lc ld le gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ng"><img src="../Images/1eece78068aaed8cfc2794cac75486ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f8Y-j61cA4d78g417qE8JQ.png"/></div></div><figcaption class="ls lt gj gh gi lu lv bd b be z dk"><strong class="bd lw">Table 2</strong></figcaption></figure><ol class=""><li id="be1c" class="ms mt it kd b ke kf ki kj km mu kq mv ku mw ky mx my mz na bi translated">在这里，E-CCMUT 在召回率、精确度、F1-Score 和 AUROC 方面的性能没有比 CCMUT 有所提高或下降。</li><li id="9fa4" class="ms mt it kd b ke nb ki nc km nd kq ne ku nf ky mx my mz na bi translated">在<strong class="kd iu">拟合</strong>方面，E-CCMUT 比 CCMUT 有了显著的提高，拟合度从 2.1 下降到 1.29。拟合度量越多，验证和训练精度的可比性就越小，因此要么过拟合，要么欠拟合，拟合度量越小，模型就越接近"<strong class="kd iu">完美拟合</strong>"</li><li id="39e0" class="ms mt it kd b ke nb ki nc km nd kq ne ku nf ky mx my mz na bi translated">与 CCMUT 相比，E-CCMUT 的验证准确性有非常轻微的下降(0.24%)，这可以忽略不计。</li></ol><p id="624c" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">此外，还进行了许多其他实验，并观察到 E-CCMUT 产生了比 CCMUT 更适合的<strong class="kd iu">模型，而验证准确性没有显著下降。</strong></p><p id="41a4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">因此，E-CCMUT 是对 CCMUT 模型的<strong class="kd iu">拟合</strong>性能指标的改进，并且证实了在构建算法时所采用的直觉。</p></div></div>    
</body>
</html>