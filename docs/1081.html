<html>
<head>
<title>Implementing Supervised Learning Algorithm by Sklearn — Linear Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 sk learn——线性回归实现监督学习算法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/implementing-supervised-learning-algorithm-by-sklearn-linear-regression-96ffbdb29961?source=collection_archive---------4-----------------------#2017-07-27">https://towardsdatascience.com/implementing-supervised-learning-algorithm-by-sklearn-linear-regression-96ffbdb29961?source=collection_archive---------4-----------------------#2017-07-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/bbe1228d9dd418bae93afc1b103e3b77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SsrUI-q_kWKPd-HKmcRNvg.png"/></div></div></figure><p id="b74c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这篇博客中，我们将看到如何使用 Python 中的 SkLearn 库实现监督学习算法—线性回归。SkLearn 或 scikit-learn 是最广泛使用的机器学习和数据分析工具之一。它完成所有的计算，让您专注于提高效率，而不是算法的计算部分。</p><p id="f3f5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">关于 scikit-learn 的更多细节，你可以从给定的链接中参考官方文档</p><div class="kw kx gp gr ky kz"><a href="http://scikit-learn.org/stable/" rel="noopener  ugc nofollow" target="_blank"><div class="la ab fo"><div class="lb ab lc cl cj ld"><h2 class="bd ir gy z fp le fr fs lf fu fw ip bi translated">sci kit-learn:Python 中的机器学习</h2><div class="lg l"><h3 class="bd b gy z fp le fr fs lf fu fw dk translated">编辑描述</h3></div><div class="lh l"><p class="bd b dl z fp le fr fs lf fu fw dk translated">scikit-learn.org</p></div></div><div class="li l"><div class="lj l lk ll lm li ln jw kz"/></div></div></a></div><h2 id="d301" class="lo lp iq bd lq lr ls dn lt lu lv dp lw kj lx ly lz kn ma mb mc kr md me mf mg bi translated">什么是监督学习算法？</h2><p id="fe34" class="pw-post-body-paragraph jy jz iq ka b kb mh kd ke kf mi kh ki kj mj kl km kn mk kp kq kr ml kt ku kv ij bi translated">机器学习大致包括两种方法，一种是有监督的，另一种是无监督的。在监督学习中，我们事先知道测试数据集的输出，而在无监督学习中，没有这样的数据集提供给我们。</p><p id="b6f9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">要深入了解这个主题，请参考给定的链接。</p><div class="kw kx gp gr ky kz"><a href="http://machinelearningmastery.com/supervised-and-unsupervised-machine-learning-algorithms/" rel="noopener  ugc nofollow" target="_blank"><div class="la ab fo"><div class="lb ab lc cl cj ld"><h2 class="bd ir gy z fp le fr fs lf fu fw ip bi translated">监督和非监督机器学习算法-机器学习掌握</h2><div class="lg l"><h3 class="bd b gy z fp le fr fs lf fu fw dk translated">什么是监督机器学习，它与无监督机器学习有什么关系？在这篇文章中，你将…</h3></div><div class="lh l"><p class="bd b dl z fp le fr fs lf fu fw dk translated">machinelearningmastery.com</p></div></div><div class="li l"><div class="mm l lk ll lm li ln jw kz"/></div></div></a></div><h2 id="7e25" class="lo lp iq bd lq lr ls dn lt lu lv dp lw kj lx ly lz kn ma mb mc kr md me mf mg bi translated">现在到了有趣的部分——编码</h2><p id="31c6" class="pw-post-body-paragraph jy jz iq ka b kb mh kd ke kf mi kh ki kj mj kl km kn mk kp kq kr ml kt ku kv ij bi translated">我们将用 Python 编码，确保你已经在你的系统上安装了它。我将指导您安装所需的外部库。</p><pre class="mn mo mp mq gt mr ms mt mu aw mv bi"><span id="e78f" class="lo lp iq ms b gy mw mx l my mz">import matplotlib.pyplot as plt</span><span id="9e51" class="lo lp iq ms b gy na mx l my mz">import numpy as np</span><span id="e5a4" class="lo lp iq ms b gy na mx l my mz">from sklearn import linear_model</span></pre><p id="f3a6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">让我快速地引导你到我们正在使用的库，如果你还没有它们，你可以使用 pip 安装它们。</p><ul class=""><li id="46a5" class="nb nc iq ka b kb kc kf kg kj nd kn ne kr nf kv ng nh ni nj bi translated"><a class="ae nk" href="https://matplotlib.org" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir">Matplotlib</strong></a><strong class="ka ir">:</strong>是一个用于绘制 2D 图形和图表的 python 库。我们将使用它来表示我们的模型。</li><li id="afa0" class="nb nc iq ka b kb nl kf nm kj nn kn no kr np kv ng nh ni nj bi translated"><a class="ae nk" href="http://www.numpy.org" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> Numpy </strong> </a> <strong class="ka ir"> </strong>:是 python 中用来进行科学计算的包。我们将使用它为我们的数据集制作数组和矩阵，并对它们进行基本计算。</li><li id="e37b" class="nb nc iq ka b kb nl kf nm kj nn kn no kr np kv ng nh ni nj bi translated"><strong class="ka ir">S</strong><a class="ae nk" href="http://scikit-learn.org/stable/modules/linear_model.html" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir">kle arn—Linear _ model</strong></a>:我们将使用 sklearn 的线性模型对给定的数据集进行线性回归。</li></ul><p id="e70d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">出于教学目的，我们将使用小型硬编码数据集，否则您可以使用任何数据集。有像<a class="ae nk" href="http://pandas.pydata.org" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir">熊猫</strong> </a> <strong class="ka ir"> </strong>这样的库允许从外部源加载数据集。</p><p id="828f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">比方说，现在我们想根据房子的大小来预测房子的价格。我们的测试数据集将是这样的。</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/5c77127e74d7f8595d7829121e62d3ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/format:webp/1*m4yL1GCs9cYrT9a0V8imTg.png"/></div><figcaption class="nr ns gj gh gi nt nu bd b be z dk">DataSet Table</figcaption></figure><p id="dcfc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们现在将使用 python 中的字典放置数据集(用于教程目的)，并将使用 matplot 库绘制它们。</p><pre class="mn mo mp mq gt mr ms mt mu aw mv bi"><span id="70af" class="lo lp iq ms b gy mw mx l my mz">import matplotlib.pyplot as plt</span><span id="f6fa" class="lo lp iq ms b gy na mx l my mz">import numpy as np</span><span id="d529" class="lo lp iq ms b gy na mx l my mz">from sklearn import datasets, linear_model</span><span id="e8a8" class="lo lp iq ms b gy na mx l my mz">house_price = [245, 312, 279, 308, 199, 219, 405, 324, 319, 255]</span><span id="0f5d" class="lo lp iq ms b gy na mx l my mz">size = [1400, 1600, 1700, 1875, 1100, 1550, 2350, 2450, 1425, 1700]</span><span id="5daa" class="lo lp iq ms b gy na mx l my mz">plt.scatter (size,house_price, color=’black’)</span><span id="297f" class="lo lp iq ms b gy na mx l my mz">plt.ylabel(‘house price’)</span><span id="f57d" class="lo lp iq ms b gy na mx l my mz">plt.xlabel(‘size of house’)</span><span id="510f" class="lo lp iq ms b gy na mx l my mz">plt.show()</span></pre><p id="25c0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">上面将给出以下输出。</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/fb40b12d32becec739a41e3dbdb7ea49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*nNfJ-id_7hOEp0YV3ZXbuw.png"/></div></figure><p id="f805" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，我们使用 scikit 的线性模型以如下方式训练我们的数据集。</p><pre class="mn mo mp mq gt mr ms mt mu aw mv bi"><span id="dfc0" class="lo lp iq ms b gy mw mx l my mz">import matplotlib.pyplot as plt</span><span id="56de" class="lo lp iq ms b gy na mx l my mz">import numpy as np</span><span id="3d45" class="lo lp iq ms b gy na mx l my mz">from sklearn import datasets, linear_model</span><span id="23a0" class="lo lp iq ms b gy na mx l my mz">house_price = [245, 312, 279, 308, 199, 219, 405, 324, 319, 255]</span><span id="1fef" class="lo lp iq ms b gy na mx l my mz">size = [1400, 1600, 1700, 1875, 1100, 1550, 2350, 2450, 1425, 1700]</span><span id="d937" class="lo lp iq ms b gy na mx l my mz">size2 = np.array(size).reshape((-1, 1))</span><span id="728b" class="lo lp iq ms b gy na mx l my mz">#fitting into the model</span><span id="e292" class="lo lp iq ms b gy na mx l my mz">regr = linear_model.LinearRegression()</span><span id="2ec1" class="lo lp iq ms b gy na mx l my mz">regr.fit(size2, house_price)</span><span id="b0e0" class="lo lp iq ms b gy na mx l my mz">print('Coefficients: \n', regr.coef_)</span><span id="590f" class="lo lp iq ms b gy na mx l my mz">print('intercept: \n', regr.intercept_)</span><span id="17ea" class="lo lp iq ms b gy na mx l my mz">#############################</span><span id="2fb1" class="lo lp iq ms b gy na mx l my mz">#formula obtained for the trained model</span><span id="2bd4" class="lo lp iq ms b gy na mx l my mz">def graph(formula, x_range):</span><span id="2daa" class="lo lp iq ms b gy na mx l my mz">   x = np.array(x_range)</span><span id="cf5f" class="lo lp iq ms b gy na mx l my mz">   y = eval(formula)</span><span id="d9f8" class="lo lp iq ms b gy na mx l my mz">   plt.plot(x, y)</span><span id="e966" class="lo lp iq ms b gy na mx l my mz">#plotting the prediction line </span><span id="5f57" class="lo lp iq ms b gy na mx l my mz">graph('regr.coef_*x + regr.intercept_', range(1000, 2700))</span><span id="ba92" class="lo lp iq ms b gy na mx l my mz">print regr.score(size2, house_price)</span><span id="3d7b" class="lo lp iq ms b gy na mx l my mz">#############################</span><span id="b0f6" class="lo lp iq ms b gy na mx l my mz">plt.scatter (size,house_price, color=’black’)</span><span id="a3a5" class="lo lp iq ms b gy na mx l my mz">plt.ylabel(‘house price’)</span><span id="23d1" class="lo lp iq ms b gy na mx l my mz">plt.xlabel(‘size of house’)</span><span id="bebf" class="lo lp iq ms b gy na mx l my mz">plt.show()</span></pre><p id="b723" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">编译完上面的代码后，你会看到带有预测行的数据模型。</p><pre class="mn mo mp mq gt mr ms mt mu aw mv bi"><span id="4f45" class="lo lp iq ms b gy mw mx l my mz">(‘Coefficients: \n’, array([ 0.10976774]))</span><span id="cb42" class="lo lp iq ms b gy na mx l my mz">(‘intercept: \n’, 98.248329621380833)</span></pre><p id="c291" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里，预测线的方程是“y = mx + c”的形式，上面计算了“m”和“c”的值。</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/7a6cbd6dab4baa458745d8442ebe10f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*bNtN8dlA_nzFTtZD8rppbg.png"/></div></figure><p id="bef3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">给定房子的大小，要预测任何新的价格，我们可以通过以下方式使用线性模型提供的预测函数。</p><pre class="mn mo mp mq gt mr ms mt mu aw mv bi"><span id="ff3e" class="lo lp iq ms b gy mw mx l my mz">print regr.predict([2000])</span></pre><blockquote class="nx ny nz"><p id="fd9e" class="jy jz oa ka b kb kc kd ke kf kg kh ki ob kk kl km oc ko kp kq od ks kt ku kv ij bi translated">预测产量为 317.78380528 千美元。</p></blockquote><p id="f462" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这就结束了线性压缩的教程。对于任何开始学习机器的人来说，我建议不要使用 scikit 库，先进行一次线性回归，只是为了更好地理解概念。尽量使用<a class="ae nk" href="https://www.analyticsvidhya.com/blog/2017/03/introduction-to-gradient-descent-algorithm-along-its-variants/" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir">梯度下降</strong> </a>等算法，使平方误差函数最小化。如果你不想用 python 编码，你可以使用 GNU-Octave 或 Matlab 等工具，它们非常适合原型和分析。此外，对矩阵和计算有很好的了解会对你有很大帮助。</p><p id="d94c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">快乐编码:)</p></div><div class="ab cl oe of hu og" role="separator"><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj ok"/><span class="oh bw bk oi oj"/></div><div class="ij ik il im in"><p id="172d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">感谢阅读这篇文章。如果你觉得这篇文章有帮助，一定要点击下面的❤来推荐它。这对我意义重大。</p><p id="2280" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="oa">如果你想了解更多关于编程的知识，你可以关注我，这样我写新帖的时候你会收到通知。</em></p><p id="5fbe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">还有，让我们在<a class="ae nk" href="https://twitter.com/mayank_trp408" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> Twitter </strong> </a>，<a class="ae nk" href="https://www.linkedin.com/in/mayank-tripathi-a49563126/" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> Linkedin </strong> </a>，<a class="ae nk" href="https://github.com/mayank408" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> Github </strong> </a>和<a class="ae nk" href="https://www.facebook.com/profile.php?id=100001106266064" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir">脸书</strong> </a>上成为朋友吧。</p></div></div>    
</body>
</html>