<html>
<head>
<title>Video streaming in the Jupyter Notebook</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Jupyter 笔记本中的视频流</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/video-streaming-in-the-jupyter-notebook-635bc5809e85?source=collection_archive---------6-----------------------#2018-11-19">https://towardsdatascience.com/video-streaming-in-the-jupyter-notebook-635bc5809e85?source=collection_archive---------6-----------------------#2018-11-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/bec51515a4e40a35869e90b1a45f9a3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:432/format:webp/1*Q7aXwVo1Xc2Eeb09EUHoMA.png"/></div></figure><p id="14d2" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><a class="ae ks" href="https://github.com/jupyter-widgets/ipywidgets" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir"> ipywidgets </strong> </a>在 Jupyter 生态系统中起着至关重要的作用；它带来了用户和数据之间的交互性。</p><p id="7a6c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">小部件是多事件的 Python 对象，通常在 Jupyter 记事本或 JupyterLab 中有一个可视化的表示:一个按钮、一个滑块、一个文本输入、一个复选框…</p><figure class="ku kv kw kx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi kt"><img src="../Images/1558dd4eee03310a1b34ab9eee63925b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*BzurNSfLytUzph531QiLFw.gif"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk">The user can get access and set the value of the slider writing Python code, and of course, interact with it using the mouse</figcaption></figure><p id="d7b7" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">表示小部件的 Python 对象在服务器端(后端)是活动的，在 Python 内核(负责执行 Jupyter 笔记本中的代码的部分)内部。Python 对象包含关于微件状态的所有信息。在<strong class="jw ir"> <em class="lg">滑块</em> </strong>小部件的情况下，Python 对象包含滑块的最小值、最大值和当前值。这个 Python 对象(在后端，服务器端)与小部件的 Javascript 模型(在前端，客户端)同步，后者包含关于小部件的相同信息。每次用户在笔记本中显示小部件时，它都会创建一个与 Javascript 模型保持同步的视图。在<strong class="jw ir"> <em class="lg">滑块</em> </strong>示例上，可以看到两个视图是同步的。</p><figure class="ku kv kw kx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi lh"><img src="../Images/2e3d870d2329412e0a82a6439b5c70ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Gz1J2iyddYiL_uJTmZjXg.png"/></div></div></figure></div><div class="ab cl li lj hu lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="ij ik il im in"><p id="64de" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">不仅仅是一个交互式小部件库，<a class="ae ks" href="https://github.com/jupyter-widgets/ipywidgets" rel="noopener ugc nofollow" target="_blank"><strong class="jw ir">ipywidgets</strong></a><strong class="jw ir"/>是一个强大的框架，基于它可以直接创建新的定制小部件。开发人员可以使用<a class="ae ks" href="https://github.com/jupyter-widgets/widget-cookiecutter/" rel="noopener ugc nofollow" target="_blank"><strong class="jw ir">widget-cookiecutter</strong></a><strong class="jw ir"/>项目，用代码结构和打包的最佳实践快速启动他们的 widget 库。</p><p id="9ef5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">已经创建了许多不同的小部件库。您可以使用<a class="ae ks" href="https://mybinder.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir"> mybinder </strong> </a>在线试用它们，无需安装任何东西！：</p><ul class=""><li id="c48c" class="lp lq iq jw b jx jy kb kc kf lr kj ls kn lt kr lu lv lw lx bi translated"><a class="ae ks" href="https://github.com/bloomberg/bqplot" rel="noopener ugc nofollow" target="_blank"><strong class="jw ir">bq plot</strong></a><strong class="jw ir">:</strong>二维交互数据(<a class="ae ks" href="https://mybinder.org/v2/gh/bloomberg/bqplot/stable?filepath=examples/Index.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir">绑定链接</strong> </a>)</li><li id="f11b" class="lp lq iq jw b jx ly kb lz kf ma kj mb kn mc kr lu lv lw lx bi translated"><a class="ae ks" href="https://github.com/jupyter-widgets/ipyleaflet" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir"> ipyleaflet: </strong> </a>互动地图(<a class="ae ks" href="https://mybinder.org/v2/gh/jupyter-widgets/ipyleaflet/stable?filepath=examples" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir">活页夹链接</strong> </a>)</li><li id="1261" class="lp lq iq jw b jx ly kb lz kf ma kj mb kn mc kr lu lv lw lx bi translated"><a class="ae ks" href="https://github.com/jupyter-widgets/pythreejs" rel="noopener ugc nofollow" target="_blank"><strong class="jw ir">python reejs:</strong></a>交互式三维场景(<a class="ae ks" href="https://mybinder.org/v2/gh/jupyter-widgets/pythreejs/master?filepath=examples" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir">活页夹链接</strong> </a>)</li><li id="e29c" class="lp lq iq jw b jx ly kb lz kf ma kj mb kn mc kr lu lv lw lx bi translated"><a class="ae ks" href="https://github.com/maartenbreddels/ipyvolume" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir"> ipyvolume: </strong> </a>三维交互式数据可视化和多体绘制(<a class="ae ks" href="https://beta.mybinder.org/v2/gh/maartenbreddels/ipyvolume/master?filepath=notebooks/simple.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir"> binder link </strong> </a>)</li><li id="9452" class="lp lq iq jw b jx ly kb lz kf ma kj mb kn mc kr lu lv lw lx bi translated"><a class="ae ks" href="https://github.com/arose/nglview" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir"> nglview: </strong> </a>三维交互式分子可视化(<a class="ae ks" href="http://mybinder.org/repo/hainm/nglview-notebooks" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir"> binder link </strong> </a>)</li><li id="862a" class="lp lq iq jw b jx ly kb lz kf ma kj mb kn mc kr lu lv lw lx bi translated"><a class="ae ks" href="https://github.com/pbugnion/gmaps" rel="noopener ugc nofollow" target="_blank"><strong class="jw ir">gmaps</strong></a><strong class="jw ir">:</strong>Google-maps 上的数据可视化</li><li id="4c91" class="lp lq iq jw b jx ly kb lz kf ma kj mb kn mc kr lu lv lw lx bi translated"><a class="ae ks" href="https://github.com/InsightSoftwareConsortium/itk-jupyter-widgets" rel="noopener ugc nofollow" target="_blank"><strong class="jw ir">itk-jupyter-widgets:</strong></a>交互式二维和三维数据可视化(<a class="ae ks" href="https://mybinder.org/v2/gh/InsightSoftwareConsortium/itk-jupyter-widgets/master?filepath=examples%2F3DImage.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir">活页夹链接</strong> </a>)</li><li id="d188" class="lp lq iq jw b jx ly kb lz kf ma kj mb kn mc kr lu lv lw lx bi">…</li></ul></div><div class="ab cl li lj hu lk" role="separator"><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln lo"/><span class="ll bw bk lm ln"/></div><div class="ij ik il im in"><p id="8448" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">自从<a class="ae ks" href="https://github.com/jupyter-widgets/ipywidgets" rel="noopener ugc nofollow" target="_blank"><strong class="jw ir">ipywidgets</strong></a>7.4 以来，我们有了两个新的小部件:音频<strong class="jw ir"><em class="lg"/></strong>和视频<strong class="jw ir"><em class="lg"/></strong>小部件，这使得在 Jupyter 笔记本和 Jupyterlab 中进行图像/音频处理变得很容易。</p><p id="9b5f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">像<strong class="jw ir"> <em class="lg">图片</em> </strong>小部件一样，新的<strong class="jw ir"> <em class="lg">音频</em> </strong>和<strong class="jw ir"> <em class="lg">视频</em> </strong>小部件在后端和前端之间同步二进制数据。您可以使用自己喜欢的库(OpenCV、sci kit-image……)轻松操作这些数据，并动态更新小部件值。</p><figure class="ku kv kw kx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi kt"><img src="../Images/2e745a360e39ac9e9753677cd0a61752.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*om0JCXZkYa9ukwFrNWFx_w.gif"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk">Edge detection using OpenCV on a <strong class="bd md">Video</strong> widget</figcaption></figure><p id="130b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这两个小部件是创建<a class="ae ks" href="https://github.com/maartenbreddels/ipywebrtc" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir"> ipywebrtc </strong> </a>库的很好的构件。<a class="ae ks" href="https://github.com/maartenbreddels/ipywebrtc" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir"> ipywebrtc </strong> </a>已由<a class="ae ks" href="https://www.maartenbreddels.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir">马腾</strong> </a>创作(马腾是牛逼库<a class="ae ks" href="https://github.com/maartenbreddels/vaex" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir"> vaex </strong> </a>和<a class="ae ks" href="https://github.com/maartenbreddels/ipyvolume" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir"> ipyvolume </strong> </a>的作者)。它使用<a class="ae ks" href="https://webrtc.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir"> WebRTC </strong> </a>浏览器 API 的强大功能来允许 Jupyter 笔记本内部的视频流。</p><p id="a273" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><a class="ae ks" href="https://github.com/maartenbreddels/ipywebrtc" rel="noopener ugc nofollow" target="_blank"><strong class="jw ir">ipywebrtc</strong></a><strong class="jw ir"/>的 API 非常简单:首先，用户会创建一个我们称之为<strong class="jw ir"> <em class="lg"> MediaStream </em> </strong>的小部件。一个<strong class="jw ir"> <em class="lg">媒体流</em> </strong>小部件可以是:</p><ul class=""><li id="8884" class="lp lq iq jw b jx jy kb kc kf lr kj ls kn lt kr lu lv lw lx bi translated">一个<strong class="jw ir"> <em class="lg"> WidgetStream </em> </strong>小部件，给定任何输入小部件</li><li id="e324" class="lp lq iq jw b jx ly kb lz kf ma kj mb kn mc kr lu lv lw lx bi translated">一个<strong class="jw ir"> <em class="lg"> VideoStream </em> </strong>小部件，给定一个<strong class="jw ir"> <em class="lg"> Video </em> </strong>小部件作为输入</li><li id="6913" class="lp lq iq jw b jx ly kb lz kf ma kj mb kn mc kr lu lv lw lx bi translated">一个<strong class="jw ir"> <em class="lg"> ImageStream </em> </strong>小部件，给定一个<strong class="jw ir"> <em class="lg"> Image </em> </strong>小部件作为输入</li><li id="8a21" class="lp lq iq jw b jx ly kb lz kf ma kj mb kn mc kr lu lv lw lx bi translated">一个<strong class="jw ir"> <em class="lg">音频流</em> </strong>小部件，给定一个<strong class="jw ir"> <em class="lg">音频</em> </strong>小部件作为输入</li><li id="7f31" class="lp lq iq jw b jx ly kb lz kf ma kj mb kn mc kr lu lv lw lx bi translated">一个<strong class="jw ir"> <em class="lg"> CameraStream </em> </strong>小部件，它根据用户的网络摄像头创建视频/音频流</li></ul><p id="ea84" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">使用<strong class="jw ir"> <em class="lg"> MediaStream </em> </strong>小部件，您可以:</p><ul class=""><li id="b7c7" class="lp lq iq jw b jx jy kb kc kf lr kj ls kn lt kr lu lv lw lx bi translated">使用<strong class="jw ir"> <em class="lg">录像机</em> </strong>小工具录制电影</li><li id="34a7" class="lp lq iq jw b jx ly kb lz kf ma kj mb kn mc kr lu lv lw lx bi translated">使用<strong class="jw ir"><em class="lg">image recorder</em></strong>小工具拍摄快照</li><li id="69a4" class="lp lq iq jw b jx ly kb lz kf ma kj mb kn mc kr lu lv lw lx bi translated">使用<strong class="jw ir"> <em class="lg">录音机</em> </strong>小工具录制音频</li><li id="70e4" class="lp lq iq jw b jx ly kb lz kf ma kj mb kn mc kr lu lv lw lx bi translated">使用简单的<strong class="jw ir"> <em class="lg">聊天</em> </strong>功能将其传输给同伴</li></ul><figure class="ku kv kw kx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi me"><img src="../Images/1f2b3004d7db29b96542c01e3530a4d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J2MX8CFmtTzoyiJPfZc3zA.png"/></div></div></figure><p id="4465" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">至于其他的 widget 库，现在只要点击<a class="ae ks" href="https://mybinder.org/v2/gh/maartenbreddels/ipywebrtc/master?filepath=docs/source" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir">这个链接</strong> </a> <strong class="jw ir">就可以现场试用了。</strong>你将能够尝试所有这些工作流程。</p><p id="ddff" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">比方说，你想使用连接到电脑的摄像头动态执行图像处理，并运行人脸识别、边缘检测或任何其他复杂的算法。使用<a class="ae ks" href="https://github.com/maartenbreddels/ipywebrtc" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir"> ipywebrtc </strong> </a>真的很容易实现。您需要做的就是创建一个<strong class="jw ir"> <em class="lg"> CameraStream </em> </strong>小部件的实例，创建一个<strong class="jw ir"><em class="lg">image recorder</em></strong>给定相机视频流作为输入，并实现处理图像的回调(例如使用 scikit-image)。</p><figure class="ku kv kw kx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi kt"><img src="../Images/ab651c357853eff77314f2777b6e2be4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*HTd5uPpq8hsVhxv0MeVfAg.gif"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk">Creation of an <strong class="bd md">ImageRecorder</strong> taking snapshots of the <strong class="bd md">CameraStream</strong>, and process images on the fly using scikit-image</figcaption></figure><p id="0ec8" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><a class="ae ks" href="https://github.com/maartenbreddels/ipywebrtc" rel="noopener ugc nofollow" target="_blank"><strong class="jw ir">ipywebrtc</strong></a><strong class="jw ir"/>的另一个很好的特性是能够从任何小部件创建<strong class="jw ir"> <em class="lg"> MediaStream </em> </strong>小部件。这意味着您可以轻松地从您喜欢的小部件库中记录图像和视频，以进行二维或三维数据可视化(此处为<a class="ae ks" href="https://github.com/maartenbreddels/ipyvolume" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir"> ipyvolume </strong> </a>)。</p><figure class="ku kv kw kx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi kt"><img src="../Images/cd50a24b22215e54e6530056661f1f81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*B3DlRN6Vp6jw4mbua2veng.gif"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk">Create a <strong class="bd md">WidgetStream</strong> with an ipyvolume widget as input and record a video using the <strong class="bd md">VideoRecorder</strong></figcaption></figure><p id="a209" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">一旦你使用了库的这些好特性，你就可以下载你创建的视频/图片了。或者，您可以使用<strong class="jw ir"> <em class="lg">聊天</em> </strong>功能直接分享。该功能将聊天室名称和您想要共享的流(默认为<strong class="jw ir"> <em class="lg"> CameraStream </em> </strong>)作为输入，并允许您将您的 Jupyter 笔记本变成会议室！</p><figure class="ku kv kw kx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi mf"><img src="../Images/708a281a10984de3a0407fd44b66166a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j53JosBGvmstgdb0btsKjA.jpeg"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk">Chatroom created live with <strong class="bd md">ipywebrtc </strong>during a presentation at <strong class="bd md">PyParis</strong></figcaption></figure><p id="e1c5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">你可以在 Github 上找到用来制作那些图片的例子:<a class="ae ks" href="https://github.com/QuantStack/quantstack-talks/tree/master/2018-11-14-PyParis-widgets/notebooks" rel="noopener ugc nofollow" target="_blank">https://Github . com/quant stack/quant stack-talks/tree/master/2018-11-14-py Paris-widgets/notebooks</a></p><h1 id="cb59" class="mg mh iq bd mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd bi translated">关于作者</h1><p id="0baf" class="pw-post-body-paragraph ju jv iq jw b jx ne jz ka kb nf kd ke kf ng kh ki kj nh kl km kn ni kp kq kr ij bi translated">我叫<a class="ae ks" href="https://twitter.com/martinRenou" rel="noopener ugc nofollow" target="_blank">马丁·雷诺</a>，我是<a class="ae ks" href="http://quantstack.net/" rel="noopener ugc nofollow" target="_blank"> QuantStack </a>的科学软件工程师。在加入<a class="ae ks" href="http://quantstack.net/" rel="noopener ugc nofollow" target="_blank"> QuantStack </a>之前，我就读于<a class="ae ks" href="https://www.isae-supaero.fr/en" rel="noopener ugc nofollow" target="_blank"> SUPAERO </a>。我还在巴黎的 Logilab 和剑桥的 Enthought 工作过。作为 QuantStack 的开源开发人员，我参与了各种项目，从 C++的<a class="ae ks" href="https://github.com/QuantStack/xsimd" rel="noopener ugc nofollow" target="_blank"> xsimd </a>和<a class="ae ks" href="https://github.com/QuantStack/xtensor" rel="noopener ugc nofollow" target="_blank"> xtensor </a>到 Python 和 Javascript 的<a class="ae ks" href="https://github.com/jupyter-widgets/ipyleaflet" rel="noopener ugc nofollow" target="_blank"> ipyleaflet </a>和<a class="ae ks" href="https://github.com/maartenbreddels/ipywebrtc" rel="noopener ugc nofollow" target="_blank"> ipywebrtc </a>。</p></div></div>    
</body>
</html>