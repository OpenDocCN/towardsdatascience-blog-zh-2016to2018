<html>
<head>
<title>A short &amp; practical HOW-TO guide to scrape data from a website using Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">一个简短实用的使用 Python 从网站上抓取数据的指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-short-practical-how-to-guide-to-scrape-data-from-a-website-using-python-888373227d4f?source=collection_archive---------0-----------------------#2018-05-30">https://towardsdatascience.com/a-short-practical-how-to-guide-to-scrape-data-from-a-website-using-python-888373227d4f?source=collection_archive---------0-----------------------#2018-05-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="32b4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">读者注意:Python 代码在最后被共享</em></p><p id="21fd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个星期我不得不为一个客户刮一个网站。我意识到我做得如此自然和迅速，分享它会很有用，这样你也可以掌握这门艺术。<em class="kl">【免责声明:本文展示了我的刮痧实践，如果你有更多相关实践请在评论中分享】</em></p><h1 id="6228" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">这个计划</h1><ol class=""><li id="1e05" class="lk ll iq jp b jq lm ju ln jy lo kc lp kg lq kk lr ls lt lu bi translated">确定你的目标:一个简单的 html 网站</li><li id="f917" class="lk ll iq jp b jq lv ju lw jy lx kc ly kg lz kk lr ls lt lu bi translated">用 Python 设计你的抓取方案</li><li id="6556" class="lk ll iq jp b jq lv ju lw jy lx kc ly kg lz kk lr ls lt lu bi translated">奔跑&amp;让魔法发挥作用</li></ol><figure class="mb mc md me gt mf gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/520f84c0c2c72ddb129cc5ea469ae6aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/1*_DG5lZ8YO5jDX1xn257VbQ.jpeg"/></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk">How much time do you need to scrape a website? A practitioner would take ~10 minutes to prepare the Python script for a simple html website</figcaption></figure><h1 id="5d59" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">第一部分:找到你的目标(一个网站)</h1><p id="9d67" class="pw-post-body-paragraph jn jo iq jp b jq lm js jt ju ln jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">在我的例子中，我需要从 SWIFT 代码(或法国 BIC 代码)中收集银行的名称。)http://bank-code.net/country/FRANCE-%28FR%29.html<a class="ae mp" href="http://bank-code.net/country/FRANCE-%28FR%29.html" rel="noopener ugc nofollow" target="_blank">网站</a>有 4000 多个 SWIFT 代码和相关银行名称的列表。问题是他们每页只显示 15 个结果。浏览所有页面并一次复制粘贴 15 个结果是不可行的。刮擦对于这项任务来说很方便。</p><p id="1293" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，使用 Chrome 的“inspect”选项来识别你需要获取的 html 部分。将鼠标移动到检查窗口(右侧)中的不同项目上，并跟踪代码突出显示的网站部分(左侧)。选择项目后，在检查窗口中，使用“复制/复制元素”并将 html 代码粘贴到 python 编码工具中。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi mq"><img src="../Images/35ca370d7e14605fc67814fff7c95b44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8tMn4O-cXmiqlZvrEF1rog.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk">On the right side is the Google Chrome’s “inspection window” you get when using right click / Inspect</figcaption></figure><p id="2dce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我的例子中，具有 15 个 SWIFT 代码的所需项目是一个“<em class="kl">表”</em></p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="mv mw l"/></div></figure><h1 id="8ead" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">第二部分:用 Python 设计你的抓取方案</h1><h2 id="f616" class="mx kn iq bd ko my mz dn ks na nb dp kw jy nc nd la kc ne nf le kg ng nh li ni bi translated">a)刮去第一页</h2><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="6c39" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就这样，3 行代码，Python 就收到了网页。现在您需要正确解析 html 并检索所需的项目。</p><p id="86a4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">记住所需的 html:</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="b34e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它是一个“<em class="kl">表</em>”元素，id 为“<em class="kl">表 ID </em>”。它有一个 id 属性这一事实很棒，因为这个网页上没有其他 html 元素可以有这个 id。这意味着，如果我在 html 中查找这个 id，除了所需的元素之外，我找不到其他任何东西。它节省时间。</p><p id="31aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们用 Python 正确地做这件事</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="2017" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以现在我们已经得到了想要的 html 元素。但是我们仍然需要获取 html 中的 SWIFT 代码，然后将其存储在 Python 中。我选择把它储存在熊猫体内。DataFrame 对象，但也可以仅使用列表列表。</p><p id="1dac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要做到这一点，回到 Chrome 检查窗口，分析 html 树的结构，并注意到你必须去的元素。在我的例子中，所需的数据在“tbody”元素中。每个银行及其 SWIFT 代码包含在一个“tr”元素中，每个“tr”元素有多个“td”元素。“td”元素包含了我正在寻找的数据。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mr ms di mt bf mu"><div class="gh gi nj"><img src="../Images/3e6ad5bc19b5a3934bc43e020b1ad112.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F7iAgCplcnWI5VOLahkQjw.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk">The html tree can be described as follows: table, tbody, tr, td</figcaption></figure><p id="35e1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我用下面的代码做了一行:</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="mv mw l"/></div></figure><h2 id="78bd" class="mx kn iq bd ko my mz dn ks na nb dp kw jy nc nd la kc ne nf le kg ng nh li ni bi translated">b)准备自动化</h2><p id="012c" class="pw-post-body-paragraph jn jo iq jp b jq lm js jt ju ln jw jx jy mm ka kb kc mn ke kf kg mo ki kj kk ij bi translated">现在我们已经抓取了第一个网页，我们需要思考如何抓取我们还没有看到的新网页。我的做法是复制人类行为:存储一页的结果，然后转到下一页。现在让我们专注于进入下一个网页。</p><p id="1970" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">页面底部有一个菜单，允许您进入 swift 代码表的特定页面。让我们检查一下检查器窗口中的“下一页”按钮。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/24ce187be0c831744208f4040d96bd6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:520/format:webp/1*F9VGEvMkK-d1WMJ2ni7pgA.png"/></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk">The “&gt;” symbol will lead us to the next page</figcaption></figure><p id="9a86" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这给出了以下 html 元素:</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="24dd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在用 Python 获取 url 很简单:</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="c485" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们就快到了。<br/>到目前为止，我们已经:<br/> -开发了一个页面的表格的抓取<br/> -识别了下一个页面的 url 链接</p><p id="33fc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们只需要做一个循环，然后运行代码。我推荐以下两个最佳实践:</p><p id="467e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1.当你登陆一个新的网页时打印出来:了解你的代码处于进程的哪个阶段(抓取代码可能要运行几个小时)</p><p id="d52a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.定期保存结果:避免在出错时丢失所有刮到的数据</p><p id="74a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">只要我不知道什么时候停止抓取，我就用惯用的“<em class="kl"> while True: </em>语法进行循环。我打印出每一步的计数器值。我还将每个步骤的结果保存在一个 csv 文件中。这实际上会浪费时间，例如，更好的方法是每 10 或 20 步存储一次数据。但是我选择了快速实现。</p><p id="e6ae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">代码是这样的:</p><figure class="mb mc md me gt mf"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="c99c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完整代码(只有 26 行)可以在这里找到:<a class="ae mp" href="https://github.com/FelixChop/MediumArticles/blob/master/Scraping_SWIFT_codes_Bank_names.py" rel="noopener ugc nofollow" target="_blank">https://github . com/Felix shop/mediu articles/blob/master/Scraping _ SWIFT _ codes _ Bank _ names . py</a></p><p id="b4cd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你喜欢这篇文章，考虑发送至少 50 个掌声:)</p></div></div>    
</body>
</html>