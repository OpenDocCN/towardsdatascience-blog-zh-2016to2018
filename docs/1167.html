<html>
<head>
<title>Regression Models with multiple target variables</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">多目标变量回归模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/regression-models-with-multiple-target-variables-8baa75aacd?source=collection_archive---------0-----------------------#2017-08-05">https://towardsdatascience.com/regression-models-with-multiple-target-variables-8baa75aacd?source=collection_archive---------0-----------------------#2017-08-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/4a661b7336092765cad2296cd75baee1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WobjcS1LauZTSIfp"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@anniespratt?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Annie Spratt</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="7c93" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在 Datacraft，我们最近有机会研究一个监督机器学习问题，其中目标变量是实数和多值的。对机器学习库的初步搜索显示，流行的开源 ML 库对此几乎没有支持。</p><p id="bdd7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里有一个主题的快速介绍，以及(在后面的文章中)对 JVM 生态系统中的一些库的探究。</p><h1 id="b62a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">多目标回归</h1><p id="77fd" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">机器学习分类器通常支持单个目标变量。在回归模型中，目标是实值，而在分类模型中，目标是二元或多值的。</p><p id="8906" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于分类模型，一个有多个目标变量的问题叫做<em class="me">多标签分类</em>。在回归模型领域，作为初学者，我发现术语有点混乱。</p><ul class=""><li id="04e4" class="mf mg iq kf b kg kh kk kl ko mh ks mi kw mj la mk ml mm mn bi translated"><em class="me">简单回归</em>模型是一种试图用单一解释变量/独立变量拟合线性回归模型的模型。</li><li id="ac4a" class="mf mg iq kf b kg mo kk mp ko mq ks mr kw ms la mk ml mm mn bi translated"><em class="me">多元回归</em>模型是一种试图根据两个或更多自变量的值来预测因变量的模型。例如:可以根据吸烟持续时间、开始吸烟的年龄、收入、性别等来预测每天的香烟消费量吗？</li><li id="79e6" class="mf mg iq kf b kg mo kk mp ko mq ks mr kw ms la mk ml mm mn bi translated"><em class="me">多目标回归</em>是有多个因变量时使用的术语。如果目标变量是分类的，那么它被称为多标签或多目标分类，如果目标变量是数值的，那么多目标(或多输出)回归是常用的名称。</li></ul><h1 id="4cf6" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">几种 MTR 回归模型方法的探讨</h1><p id="9d3f" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated"><a class="ae kc" href="http://cig.fi.upm.es/articles/2015/Borchani-2015-WDMKD.pdf" rel="noopener ugc nofollow" target="_blank">本文</a>对多目标回归的模型方法进行了很好的概述。</p><p id="ca2e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它将方法分为以下几类:</p><p id="a84c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">问题转化:</p><ul class=""><li id="b62b" class="mf mg iq kf b kg kh kk kl ko mh ks mi kw mj la mk ml mm mn bi translated">诸如单目标回归、回归变量链</li></ul><p id="f846" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">算法转换:</p><ul class=""><li id="38dc" class="mf mg iq kf b kg kh kk kl ko mh ks mi kw mj la mk ml mm mn bi translated">多输出支持向量回归</li><li id="69a3" class="mf mg iq kf b kg mo kk mp ko mq ks mr kw ms la mk ml mm mn bi translated">多输出回归树和规则方法</li></ul><h1 id="c215" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用聚类和决策树的多目标回归。</h1><p id="a8c8" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">在接下来的讨论中，我们将集中讨论一种方法，即用于 MTR 的决策树和决策树集合。</p><h1 id="39f8" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用树进行聚类，也称为预测聚类树(PCT)</h1><p id="0d10" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们需要首先看一下预测聚类树(PCT ),它是 MTR 决策树的基础。</p><p id="1fd7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae kc" href="http://arxiv.org/pdf/cs/0011032.pdf" rel="noopener ugc nofollow" target="_blank">聚类树的自顶向下归纳</a>是讨论使用决策树进行聚类的论文。在分类角色中，决策树的叶子是类或标签。</p><p id="d9bb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然而，从集群的角度来看</p><ul class=""><li id="bdaf" class="mf mg iq kf b kg kh kk kl ko mh ks mi kw mj la mk ml mm mn bi translated">每个叶节点对应于一个概念或一个集群，</li><li id="53e2" class="mf mg iq kf b kg mo kk mp ko mq ks mr kw ms la mk ml mm mn bi translated">树中的节点表示分类法或层次结构。</li></ul><p id="1702" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该文件指出:</p><p id="5f2e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mw b">A clustering tree is a decision tree where leaves don't contain classes and where each node &amp; leaf correspond to a cluster.</code></p><p id="7315" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">沿着树向下走(从根开始，然后向下到叶节点)可以被比作从大的集群(在顶部)移动到越来越小的集群，当我们接近叶节点时。</p><h1 id="1206" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">聚类之间距离的度量</h1><p id="c05c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">在监督分类中，距离度量是目标变量的类。</p><p id="7501" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在无监督或半监督学习中，聚类是基于距离度量(例如欧几里得距离)来完成的。如果小样本被标记，则节点中的所有(未标记的)样本被分配大多数标记样本的类别。聚类可用于预测许多或所有目标属性。</p><p id="95c6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于一个有 5 个目标变量的问题，叶节点将包含一个长度为 5 的向量，每个向量代表一个目标变量。</p><h1 id="f058" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">衡量 PCT 的质量</h1><p id="6937" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">对于回归，使用的默认度量是相对误差，即</p><ul class=""><li id="b72f" class="mf mg iq kf b kg kh kk kl ko mh ks mi kw mj la mk ml mm mn bi translated">预测的均方误差除以始终预测平均值的默认假设的均方误差。</li></ul><h1 id="9965" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">如何建造这棵树</h1><p id="5d8d" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">为了构建一棵树，我们首先决定:</p><ul class=""><li id="6644" class="mf mg iq kf b kg kh kk kl ko mh ks mi kw mj la mk ml mm mn bi translated">距离度量(比较两个实例之间的距离)</li><li id="1d3e" class="mf mg iq kf b kg mo kk mp ko mq ks mr kw ms la mk ml mm mn bi translated">一个原型函数(它计算一个聚类的质心，以便可以比较两个聚类)</li></ul><p id="5b00" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">给定树的每个节点对应于一个聚类，然后决策树算法适于在每个节点中选择将最大化其子节点中的结果聚类之间的距离的测试。</p><ul class=""><li id="5c5a" class="mf mg iq kf b kg kh kk kl ko mh ks mi kw mj la mk ml mm mn bi translated">给定聚类 C 和测试 T，最佳测试 T 是使子聚类 C1 和 C2 之间的距离最大化的测试。</li><li id="5d4b" class="mf mg iq kf b kg mo kk mp ko mq ks mr kw ms la mk ml mm mn bi translated">如果原型(类似于聚类质心)是平均值，最大化聚类间距离对应于最小聚类内距离。这意味着树构建彼此远离的簇，并且簇内几乎没有分散。</li><li id="92d6" class="mf mg iq kf b kg mo kk mp ko mq ks mr kw ms la mk ml mm mn bi translated">停止标准:当子树明显不同时，树的生长(或者更确切地说，节点分裂)停止。对于回归，使用 f 检验(测量两个群体之间的方差差异)。</li><li id="de48" class="mf mg iq kf b kg mo kk mp ko mq ks mr kw ms la mk ml mm mn bi translated">修剪:树从训练数据中生长，并且使用验证集来修剪树。</li></ul><p id="df86" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mw b">For each node of the tree the quality of the tree if it were pruned at that node Q′ is compared with the quality Q of the unpruned tree. If Q′ &gt; Q then the tree is pruned.</code></p><h1 id="16c9" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">用于 MTR 的决策树集成方法的比较</h1><p id="59c6" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">在上一节中，我们学习了如何构建一个决策树。然而，当使用树的森林时，性能会大大提高。</p><p id="1646" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae kc" href="https://pdfs.semanticscholar.org/ca94/c65320c6023bf00ef6db30e6815f3aa07aa4.pdf" rel="noopener ugc nofollow" target="_blank">本文</a>讨论了集成在多目标决策树中的应用。</p><h1 id="cb0c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">装袋:</h1><ul class=""><li id="13ba" class="mf mg iq kf b kg lz kk ma ko mx ks my kw mz la mk ml mm mn bi translated">从数据集中选取引导样本，并使用这些样本构建一个树。引导样本是通过对训练集进行替换采样而获得的。</li></ul><h1 id="9ac4" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">随机森林</h1><ul class=""><li id="417c" class="mf mg iq kf b kg lz kk ma ko mx ks my kw mz la mk ml mm mn bi translated">除了 bagging 之外，在决策树的每个节点上，使用随机特征子集来分割节点，而不是 Bagging 中的所有特征。</li></ul><p id="4539" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">论文的结果，简而言之</p><ul class=""><li id="0564" class="mf mg iq kf b kg kh kk kl ko mh ks mi kw mj la mk ml mm mn bi translated">(MODTs 的)集成比单个决策树表现更好。</li><li id="c07b" class="mf mg iq kf b kg mo kk mp ko mq ks mr kw ms la mk ml mm mn bi translated">(MODTs 的)随机森林集成比 Bagging 集成表现更好。</li></ul><h1 id="46d9" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">为什么要用多输出模型，而不是回归这样的单输出模型组合？</h1><ul class=""><li id="9fc4" class="mf mg iq kf b kg lz kk ma ko mx ks my kw mz la mk ml mm mn bi translated">使用单一输出的模型需要更长的训练时间，并且计算量很大</li><li id="1709" class="mf mg iq kf b kg mo kk mp ko mq ks mr kw ms la mk ml mm mn bi translated">它们针对单个目标而不是所有目标一起进行优化</li><li id="8fa4" class="mf mg iq kf b kg mo kk mp ko mq ks mr kw ms la mk ml mm mn bi translated">它们不使用目标变量(Y)之间的关系</li><li id="e789" class="mf mg iq kf b kg mo kk mp ko mq ks mr kw ms la mk ml mm mn bi translated">MTR 回归模型比一堆单一目标模型更简单</li><li id="8573" class="mf mg iq kf b kg mo kk mp ko mq ks mr kw ms la mk ml mm mn bi translated">MTR 树提供了人类可读的预测模型，这些模型易于解释。</li></ul><h1 id="2089" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">中期审查可用的工具</h1><p id="d79c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我发现<a class="ae kc" href="http://clus.sourceforge.net/" rel="noopener ugc nofollow" target="_blank"> Clus 工具包</a>很好地融合了高性能和健壮性</p><ul class=""><li id="a27e" class="mf mg iq kf b kg kh kk kl ko mh ks mi kw mj la mk ml mm mn bi translated">文档是优秀的</li><li id="92ad" class="mf mg iq kf b kg mo kk mp ko mq ks mr kw ms la mk ml mm mn bi translated">该工具包有多种用于多目标分类和回归的方法</li><li id="1ae6" class="mf mg iq kf b kg mo kk mp ko mq ks mr kw ms la mk ml mm mn bi translated">它还支持基于规则归纳和聚类。</li><li id="cc09" class="mf mg iq kf b kg mo kk mp ko mq ks mr kw ms la mk ml mm mn bi translated">我使用的集合模型(Bagging，RandomForest)易于阅读和解释。</li></ul><p id="8cbc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一些更新的方法(2012 年后)已经作为木兰工具包的扩展实现了，可以在这个<a class="ae kc" href="https://github.com/lefman/mulan-extended" rel="noopener ugc nofollow" target="_blank"> Github 链接</a>获得。虽然这些方法如随机线性目标组合比集合模型报告了更好的性能，但我发现该工具包不如 Clus 工具包成熟。</p><p id="4884" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里有一个<a class="ae kc" href="https://stats.stackexchange.com/questions/176515/resources-for-learning-about-multiple-target-techniques" rel="noopener ugc nofollow" target="_blank">关于相同主题的 StackExchange </a>的讨论。</p><p id="9cf8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在后面的文章中，我们将讨论如何使用 Clus 工具包来运行 MTR 模型。</p></div></div>    
</body>
</html>