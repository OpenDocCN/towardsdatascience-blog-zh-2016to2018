<html>
<head>
<title>Dream in Color</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">彩色梦</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/dream-in-color-faf1ea5190e9?source=collection_archive---------3-----------------------#2017-06-08">https://towardsdatascience.com/dream-in-color-faf1ea5190e9?source=collection_archive---------3-----------------------#2017-06-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="8b00" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一个机器学习解决方案来设计你的新娘派对</p><h1 id="21f2" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">介绍</h1><p id="30b8" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">婚礼行业正在蓬勃发展。2016年美国婚礼的平均费用估计在35329美元左右，高于2006年的27852美元(1，2)。同样，在科技领域，与婚礼相关的产品和解决方案也有越来越多的机会。这个项目旨在创建一个这样的解决方案。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/01b54235a2b17ca3dbfa0697088c3b01.png" data-original-src="https://miro.medium.com/v2/resize:fit:706/0*CX1709UbceBzbfmw."/></div></figure><p id="51ba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在传统的婚礼策划中，新娘会为所有的伴娘选择一件礼服。一种被称为“不匹配的伴娘”的新趋势背离了上述传统，并且越来越受欢迎。为了达到“不相配的伴娘”的效果，每个伴娘都有不同风格和/或颜色的礼服，它们都符合一个共同的主题。这种外观很难实现，在线工具也很少。在2016年对伴娘的一项调查中，一位受访者引述道:</p><blockquote class="lw lx ly"><p id="226e" class="jn jo lz jp b jq jr js jt ju jv jw jx ma jz ka kb mb kd ke kf mc kh ki kj kk ij bi translated">“我知道让每个人都穿不同的颜色是Pinterest的时尚，但这对伴娘来说是一种痛苦。”</p></blockquote><p id="139a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一场婚礼平均有5名伴娘，打造一套巧妙搭配的礼服需要大量的协调工作。大多数在线服装零售商在其网站上只提供12-14种颜色的选择。在这个项目中，我的目标是完成以下工作:</p><ul class=""><li id="2150" class="md me iq jp b jq jr ju jv jy mf kc mg kg mh kk mi mj mk ml bi translated">创建一个机器学习算法，可以将服装分为几个特定的颜色类别</li><li id="a260" class="md me iq jp b jq mm ju mn jy mo kc mp kg mq kk mi mj mk ml bi translated">将该模型应用于目前可在线购买的服装</li><li id="f974" class="md me iq jp b jq mm ju mn jy mo kc mp kg mq kk mi mj mk ml bi translated">让应用程序可供新娘和伴娘使用</li></ul><h1 id="7170" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">材料和方法</h1><p id="8e85" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">我把这个项目当作一个图像分类问题。我希望能够根据在线零售商提供的图片对服装进行分类。网上出售的每件衣服都有图片，而描述或颜色名称并不总是可用，也不总是在零售商之间保持一致。最终，一切都取决于服装的外观，而这最好通过图片来评估。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mr"><img src="../Images/bfd46c6f744e4a61efaa8f445b98e243.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*iK0CGsJ84mMlv3vf."/></div></div></figure><p id="f02e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">数据收集</strong></p><p id="b82a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通常需要成千上万的图像来训练一个成功的图像分类算法。我使用了两个批量图像下载应用程序，通过谷歌图像搜索、谷歌购物搜索以及一些在线服装零售网站从网络上收集图像。图像质量的范围很广，从零售/专业质量到手机图片。</p><p id="38eb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了训练算法对图像进行分类，需要对图像进行标记。我选择了64种可能的颜色标签，并与网络开发人员Robb Prescott合作，建立了一个在线标签系统(color.suprinfinity.com)。标签系统如下所示。单击第一个图像中显示的颜色组之一，会显示更多特定的颜色供标签选择。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mw"><img src="../Images/c9993d746e681906f108fc50ff7487f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*nPgDGqecsek0qsx-."/></div></div><figcaption class="mx my gj gh gi mz na bd b be z dk"><em class="nb">Above: Labeling page at color.suprinfinity.com</em></figcaption></figure><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi nc"><img src="../Images/9cfe164470ea58ab1182433ec1c57e23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*g3flzU2P1MWJcXaj."/></div></div><figcaption class="mx my gj gh gi mz na bd b be z dk"><em class="nb">Above: Specific color labeling groups at color.suprinfinity.com</em></figcaption></figure><p id="c561" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦图像被标记，数据就被收集到Postgres数据库中。其他标签(除了颜色)被收集用于项目中的潜在用途:</p><ul class=""><li id="a27d" class="md me iq jp b jq jr ju jv jy mf kc mg kg mh kk mi mj mk ml bi translated">“图像细节”标签帮助我从建模中排除了某些类型的图片</li><li id="94b9" class="md me iq jp b jq mm ju mn jy mo kc mp kg mq kk mi mj mk ml bi translated">长度和织物标签未在当前项目中使用，但可能用于未来的改进/功能。</li></ul><p id="b0d6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我收集了18，630张图片，存储在亚马逊网络服务(AWS)的S3存储桶中。为了给这个项目贴上足够多的标签，我通过<strong class="jp ir">亚马逊土耳其机器人</strong>外包了标签任务。MTurk是一个你可以付钱给个人来完成可追踪的在线任务的系统。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/90aee760a8f5d548ed29e8aa81cc5b0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:756/0*5yKGPSX04XFJbTTk."/></div></figure><p id="1504" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">虽然MTurk对于完成大量标签是有效的，但是标签工作的质量并不好。在使用MTurk之后，我花了几天时间重新标记(清理)数据集，直到它达到可以接受的建模形状。我使用了我们标签网站的“管理服装”页面，这允许我查看所有的服装及其标签，以及查看特定标签下的所有图像。下面的截图显示了前几件标有“teal5”颜色的裙子。我最终得到了超过<strong class="jp ir"> 10，000张</strong>的可用的带标签的图片来训练我的模型。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mw"><img src="../Images/8237bf1f039a53de8a0b536b8ffe3526.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xBZ1ebwMO2QAxa_C."/></div></div><figcaption class="mx my gj gh gi mz na bd b be z dk"><em class="nb">Above: Admin Dresses page showing ‘teal5’ label</em></figcaption></figure><p id="546c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">模型构建</strong></p><p id="d824" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了创建一个可行的产品来实现项目目标，我希望我的模型比典型的服装零售网站有更多的颜色类别。我在我所有的模型中使用了30到35种颜色。这些颜色类别由原始64种颜色标签的不同组合构成。</p><p id="6a0f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我尝试了一些建模算法，但选择专注于卷积神经网络(卷积网)，因为它们对图像分类很有效。为了增加计算能力，我通过谷歌云平台计算引擎设置了一个带有一个NVIDIA Tesla K80 GPU的Ubuntu虚拟机(8个vCPUs，52 GB内存)，并安装了带有Keras的tensorflow-gpu进行建模。</p><p id="3356" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">图像预处理和数据准备</strong></p><p id="a6de" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于每个类的图像数量相对较少，我使用Keras预处理工具(ImageDataGenerator)来扩充图像以进行建模。下面是这个Keras工具如何工作的一个例子。通过拉伸、翻转和应用其他修改，同一个图像可以多次使用，有效地增加了用于训练模型的样本大小。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi ne"><img src="../Images/b26383fbb1f1db2a6d4c0656d0eabd5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CNUP76TpsJCZJ_cp."/></div></div></figure><p id="c04a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">卷积网络架构</strong></p><p id="434d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我尝试了几个不同的参数，这个项目最有效的convonet架构如下所示。对于这个模型，我使用了校正的线性激活，50 %的丢弃，以及16的批量大小。这个相同的体系结构被应用于一些不同的分类安排，并且总体上比其他体系结构表现得更好。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/e5225384a4943bd9843b0ce18b752514.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/0*tTFIEzEr_T9YuLvJ."/></div></figure><h1 id="7814" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">结果</h1><p id="dc11" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">为了评估每个模型的性能，我首先查看了典型的性能指标:准确度、精确度、召回率和f1分数。准确性是衡量模型总体预测正确的服装数量。精确度和召回率是模型在每个颜色类别中表现如何的度量，f1是这两者的调和平均值。</p><p id="0d7d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些指标帮助我优化初始模型参数，调整颜色分类，并识别高性能和低性能模型，而无需过度耗时的评估。通过这个过程，我创建了一个有31个颜色类别的有效卷积网(Model_31)。</p><p id="fef7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> Model_31分数汇总:</strong></p><ul class=""><li id="cd38" class="md me iq jp b jq jr ju jv jy mf kc mg kg mh kk mi mj mk ml bi translated">整体模型精确度:81 %</li><li id="b969" class="md me iq jp b jq mm ju mn jy mo kc mp kg mq kk mi mj mk ml bi translated">平均精度:81 %</li><li id="5940" class="md me iq jp b jq mm ju mn jy mo kc mp kg mq kk mi mj mk ml bi translated">平均召回率:80 %</li><li id="c50f" class="md me iq jp b jq mm ju mn jy mo kc mp kg mq kk mi mj mk ml bi translated">平均F1: 81 %</li></ul><p id="d826" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了进一步评估Model_31，我观察了每个颜色组的表现。我检查了每个单独颜色组中被算法错误分类的图像。通过这个过程，我对模型错误标记的图像进行了两个关键观察，并相应地解决了每个问题:</p><p id="db95" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">该模型经常预测一个非常接近的颜色组。</strong></p><ul class=""><li id="9962" class="md me iq jp b jq jr ju jv jy mf kc mg kg mh kk mi mj mk ml bi translated">对于我的产品来说，这是一个可以接受的结果。例如，浅黄色的服装可以归类为黄色服装。它仍然属于同一个颜色系列，可能会被挑选浅黄色礼服的伴娘看到。然而，一件浅黄色的衣服被错误地归类为翠绿色是不可接受的，原因有几个。</li><li id="2020" class="md me iq jp b jq mm ju mn jy mo kc mp kg mq kk mi mj mk ml bi translated">由于上述原因，我创建了自己的<strong class="jp ir">【接近得分】</strong>指标来评估模型。我计算了1个和2个颜色组中的“接近整体模型准确度”和“接近回忆”分数。这包括将1或2个相近颜色组内的任何分类作为“相近阳性”而不是“真阳性”进行计数。</li></ul><p id="bc7a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">模型实际上正确地标记了一些图像(我错误地标记了它们)。</p><ul class=""><li id="e935" class="md me iq jp b jq jr ju jv jy mf kc mg kg mh kk mi mj mk ml bi translated">我发现颜色组中的一些图像在建模前被贴错了标签。例如，该模型将几件灰色连衣裙归类为米色。当我打开这些图片时，它们实际上是我贴错标签的米色连衣裙。</li><li id="6047" class="md me iq jp b jq mm ju mn jy mo kc mp kg mq kk mi mj mk ml bi translated">由于在评估Model_31时的这一发现，我回去在建立更多模型之前进一步清理了我的数据。</li></ul><p id="35d8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下图展示了这两种观察结果。它展示了来自<strong class="jp ir">珊瑚</strong>群的图像，这些图像被错误地标记为暗粉色或亮粉色。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi ng"><img src="../Images/f95975848ab8246d740ec5dfb4bf6e21.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ff73fLBAdXnQ6dPQ."/></div></div><figcaption class="mx my gj gh gi mz na bd b be z dk"><em class="nb">*Above images and classification were from final selected model (Model_35)</em></figcaption></figure><p id="fb19" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">型号选择</strong></p><p id="5b2f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在进一步清洗标签，又尝试了几个型号后，我用上面的流程选择了我的最终型号:<strong class="jp ir"> Model_35 </strong>。</p><p id="5a49" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> Model_35分数汇总:</strong></p><ul class=""><li id="db42" class="md me iq jp b jq jr ju jv jy mf kc mg kg mh kk mi mj mk ml bi translated">整体模型准确度:79 %</li><li id="a8d2" class="md me iq jp b jq mm ju mn jy mo kc mp kg mq kk mi mj mk ml bi translated">平均精度:80 %</li><li id="c574" class="md me iq jp b jq mm ju mn jy mo kc mp kg mq kk mi mj mk ml bi translated">平均召回率:79 %</li><li id="556a" class="md me iq jp b jq mm ju mn jy mo kc mp kg mq kk mi mj mk ml bi translated">平均F1: 78 %</li><li id="c02a" class="md me iq jp b jq mm ju mn jy mo kc mp kg mq kk mi mj mk ml bi translated">平均关闭(1)召回率:87%</li><li id="78cb" class="md me iq jp b jq mm ju mn jy mo kc mp kg mq kk mi mj mk ml bi translated">平均关闭(2)召回率:93%</li></ul><h1 id="c59c" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">应用</h1><p id="ed44" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated"><a class="ae nh" href="http://dreamincolor.suprinfinity.com/" rel="noopener ugc nofollow" target="_blank">http://dreamincolor.suprinfinity.com</a></p><p id="aaf8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了使用我的模型创建一个可行的产品，我需要收集当前可用服装的数据，以便分类并显示给用户。我从以下六家主要的网上伴娘礼服零售商那里搜集了数据:</p><ul class=""><li id="d8cf" class="md me iq jp b jq jr ju jv jy mf kc mg kg mh kk mi mj mk ml bi translated">诺德斯特龙</li><li id="8163" class="md me iq jp b jq mm ju mn jy mo kc mp kg mq kk mi mj mk ml bi translated">威丁顿路</li><li id="bb2d" class="md me iq jp b jq mm ju mn jy mo kc mp kg mq kk mi mj mk ml bi translated">卢卢斯</li><li id="1067" class="md me iq jp b jq mm ju mn jy mo kc mp kg mq kk mi mj mk ml bi translated">Asos</li><li id="7098" class="md me iq jp b jq mm ju mn jy mo kc mp kg mq kk mi mj mk ml bi translated">德西集团</li><li id="4f70" class="md me iq jp b jq mm ju mn jy mo kc mp kg mq kk mi mj mk ml bi translated">绳结</li></ul><p id="264d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我使用Xpath、scrapy spiders和其他策略从这些网站收集数据。对于每件衣服，我收集了以下信息:</p><ul class=""><li id="5063" class="md me iq jp b jq jr ju jv jy mf kc mg kg mh kk mi mj mk ml bi translated">服装图片链接</li><li id="e582" class="md me iq jp b jq mm ju mn jy mo kc mp kg mq kk mi mj mk ml bi translated">价格</li><li id="a772" class="md me iq jp b jq mm ju mn jy mo kc mp kg mq kk mi mj mk ml bi translated">链接到产品</li><li id="e1de" class="md me iq jp b jq mm ju mn jy mo kc mp kg mq kk mi mj mk ml bi translated">产品名称</li><li id="bb98" class="md me iq jp b jq mm ju mn jy mo kc mp kg mq kk mi mj mk ml bi translated">零售商名称</li></ul><p id="67f9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在清理和编译数据后，我使用我的模型从图像中预测颜色类别，并将所有内容提供给Robb，以便与网站集成。罗柏为dreamincolor.suprinfinity.com完成了所有的网页开发工作。我将生产图像存储在另一个AWS S3存储桶中用于生产访问，网站是通过Heroku和postgres数据库建立的。</p><p id="d243" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我总共收集了<strong class="jp ir">3670件衣服</strong>在网站上展示。</p><p id="0498" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该网站的访问者可以一次选择多达5种颜色类别进行查看。该网站显示所选颜色类别中的所有服装以及与每件服装相关的所有信息。当用户点击一件衣服时，它会直接把她带到零售商的购买页面。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi ni"><img src="../Images/c7096fd655731696206ffdb8e369fd85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*yD5E_gn4T1oXFnrv."/></div></div></figure><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi nj"><img src="../Images/2401230a2e5688c8e0348ac7e82fc6ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*C5mYyfYR_ofEDqOZ."/></div></div><figcaption class="mx my gj gh gi mz na bd b be z dk"><em class="nb">Above: Snapshot of Emerald Dresses displayed at dreamincolor.suprinfinity.com</em></figcaption></figure><h1 id="a91d" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">生产中的模型性能</h1><p id="dda5" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">下图显示了基于验证数据的颜色组的召回分数。下面的分数与web应用程序的实际模型性能之间存在一些有趣的差异。三个颜色类别特别展示了这些差异。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi nk"><img src="../Images/a04e50d93a9de1024deed5c5d2dc1df2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*FzATRw38oZkzbAzW."/></div></div><figcaption class="mx my gj gh gi mz na bd b be z dk"><em class="nb">Above: Image shows True and Close(2) recall scores across color groups. Website color names are shown and differ from class names during modeling.</em></figcaption></figure><p id="4b7a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">无装饰的</p><ul class=""><li id="c12e" class="md me iq jp b jq jr ju jv jy mf kc mg kg mh kk mi mj mk ml bi translated">这位模特在裸色服装上得分很低，可能是因为<strong class="jp ir">在标签</strong>上重叠了相近的颜色组。裸色、腮红、米色、金褐色和玫瑰色组都包含非常相似的服装颜色。这是一些最常见的伴娘礼服颜色，所以我想有单独的选择。更好的标注可以提高分数。这位模特在制作裸色服装时表现得非常出色。</li></ul><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi nl"><img src="../Images/1ab45f4ea3085d7ead2e7b27fe75058b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V2-cF-iMN1WuNTIfK_jtow.png"/></div></div><figcaption class="mx my gj gh gi mz na bd b be z dk">Nude dresses</figcaption></figure><p id="8c26" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">拿铁咖啡</p><ul class=""><li id="093e" class="md me iq jp b jq jr ju jv jy mf kc mg kg mh kk mi mj mk ml bi translated">这一颜色类别的分数也很低，但可能是出于不同的原因:<strong class="jp ir">阶级不平衡</strong>。拿铁咖啡(棕色)的图片最少。然而，巧克力色(深棕色)和金黄色也比其他颜色类别的图像少得多，但总体表现良好。<strong class="jp ir">缓解班级失衡可能会提高各颜色组的模型分数</strong>。再说一次，这位模特在生产过程中对拿铁礼服进行了有效的分类。</li></ul><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi nm"><img src="../Images/ded5b1d0cd9e98ef924e5d8849ded88b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-TIFQ04fCHc48OQTPj-7Ew.png"/></div></div></figure><p id="2846" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">银</p><ul class=""><li id="3ef4" class="md me iq jp b jq jr ju jv jy mf kc mg kg mh kk mi mj mk ml bi translated">这一类别的高分表明模特应该准确地对银色礼服进行分类。在生产中，该模型的表现不如预期。这也可能是由于类别中的错误标记以及一些潜在的背景和图像质量噪声。更多的训练图像和更好的标记可能会提高这种性能</li></ul><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi nn"><img src="../Images/0897a1a0e07deb627781b9a0e9c02897.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mO6utKpzAa0CGy8xunI4DA.png"/></div></div></figure><h1 id="abdc" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">额外功能</h1><p id="ba7e" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated"><strong class="jp ir">寻找相似的服装— </strong>从Model_35卷积网的最后一个密集层，我为每张产品图像提取了一个64维向量。这是通过构建一个具有相同架构的网络，从Model_35的层插入权重，并从每个图像的第一个密集层输出矢量(省略softmax输出层)来实现的。利用64维向量集，我创建了一个余弦相似矩阵。该矩阵基于卷积输出向量给出相似服装的“分数”。</p><p id="0943" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我的余弦相似矩阵的目标是为网站创建一个功能，允许用户查看与他们喜欢的衣服相似的衣服。我的希望是，在神经网络的回旋中，除了颜色之外的一些服装特征可能被捕获(例如，长度、织物质地、光泽)。我看了一些例子，这似乎是成功的。</p><p id="c6a7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面，我选择了一条香槟色的亮片长裙。《黑客帝国》中最相似的裙子都是长的，颜色非常相似，有些有某种光泽、纹理或亮片。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mw"><img src="../Images/e34b71207f8b26c48447baa8e243e6af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*PEARkMgWE5mgO5PA."/></div></div></figure><p id="a89b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在第二次测试中(见下图)，我选择了另一条亮片长裙。这条参考裙子(左上角的轮廓图)是海军蓝，但是模特把它误归类为黑色。有趣的是，余弦相似矩阵中所有最相似的裙子都被正确归类为海军蓝。他们也很长，有些有亮片或花边。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mw"><img src="../Images/af17ae248c82c5e51e92a232b704c9e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*0y1B4EbPAWZUPrJ1."/></div></div></figure><p id="1b8b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">余弦相似性矩阵对于寻找相似服装的有效性看起来相当成功。更大范围内的表现仍需评估。找出这一特征中的弱点，识别多少件衣服在风格/颜色相似性上有明显的差异，将是有用的。我想这将受到参考服装颜色类别中可用服装数量的严重影响。</p><p id="7219" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">其他类似产品——</strong>从发饰到个性珠宝，再到指甲油和相配的坡跟鞋，伴娘的套装不仅仅是她的礼服。同样，伴郎也需要搭配(想想领结、吊带、方巾、袜子)。考虑到这一点，我想看看我的convonet是否可以用在其他与婚礼相关的产品上。</p><p id="7ae4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我首先在蝴蝶结上测试了这个理论。领带和领结的零售图像通常集中在产品上，背景简单，没有太多其他干扰。Model_35在识别领结的小样本的颜色类别方面非常有效。下图显示了领结和模型预测颜色类别。有效性的进一步评估是有保证的，这看起来像一个非常有前途的网站的潜在功能！</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="ms mt di mu bf mv"><div class="gh gi mw"><img src="../Images/8ad497c92f0f59b5c5390951ce64f303.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*D_d1TDVIGxSk_IFP."/></div></div></figure><h1 id="023e" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">未来的工作和结论</h1><p id="75e8" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">提高模型性能的一些未来策略包括进一步清理图像标注、收集更多数据、解决类别不平衡，以及尝试背景扣除或通过RGB值标注。我还想尝试迁移学习和具有本地化能力的应用程序。该网站本身可以在许多方面进行改进，包括更好的UX设计，添加上述特殊功能，以及快速清理分类错误的服装。</p><p id="5bcb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用卷积神经网络对服装图像进行分类是实现我的目标的有效方法。数据收集、清理和贴标签是该项目的最重要和最耗时的部分。最终的网站比典型的在线零售商提供了更多的颜色选择，这是一个很好的起点，在许多方面都有改进的潜力。</p><h1 id="eb39" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">资源</h1><ol class=""><li id="450c" class="md me iq jp b jq lj ju lk jy no kc np kg nq kk nr mj mk ml bi translated">西弗玛姬。"全国平均婚礼费用达到35329美元."<em class="lz">结。https://www.theknot.com/content/average-wedding-cost-2016</em><a class="ae nh" href="https://www.theknot.com/content/average-wedding-cost-2016" rel="noopener ugc nofollow" target="_blank"/>。</li><li id="a3cf" class="md me iq jp b jq mm ju mn jy mo kc mp kg mq kk nr mj mk ml bi translated">“婚礼$eason。”<em class="lz"> CNN财经</em>。<a class="ae nh" href="http://money.cnn.com/2006/02/10/pf/weddings_costs/" rel="noopener ugc nofollow" target="_blank">http://money.cnn.com/2006/02/10/pf/weddings_costs/</a>。2006年2月10日。</li><li id="c941" class="md me iq jp b jq mm ju mn jy mo kc mp kg mq kk nr mj mk ml bi translated">安德烈·伯克。"技术利润和3000亿美元婚礼空间的支点."<em class="lz">赫芬顿邮报。</em><a class="ae nh" href="http://www.huffingtonpost.com/andre-bourque/technology-profit-and-piv_b_7193112.html" rel="noopener ugc nofollow" target="_blank">http://www . huffington post . com/Andre-bourque/technology-profit-and-PIV _ b _ 7193112 . html</a>。2016年05月01日。</li><li id="0569" class="md me iq jp b jq mm ju mn jy mo kc mp kg mq kk nr mj mk ml bi translated">凯特琳.肯尼。"如今当伴娘是什么感觉:调查结果."<em class="lz">终极伴娘。</em><a class="ae nh" href="http://ultimatebridesmaid.com/2016/05/04/what-its-like-to-be-a-bridesmaid-today-survey-results/" rel="noopener ugc nofollow" target="_blank">http://ultimate伴娘. com/2016/05/04/what-its-like-to-be-a-a-伴娘-今日调查-结果/ </a>。</li><li id="dfbe" class="md me iq jp b jq mm ju mn jy mo kc mp kg mq kk nr mj mk ml bi translated">“根据2016年Knot Real Weddings研究，美国婚礼的成本创下新高，夫妇们为每位客人花费更多，以创造一个难忘的体验。”<em class="lz"> xo组。</em> <a class="ae nh" href="http://www.prnewswire.com/news-releases/the-knot-the-1-wedding-site-releases-2014-real-weddings-study-statistics-300049675.html" rel="noopener ugc nofollow" target="_blank"> http://www .美通社/news-releases/the-knot-the-1-wedding-site-releases-2014-real-wedding-study-statistics-300049675 . html</a>。2017年2月2日。</li></ol></div></div>    
</body>
</html>