<html>
<head>
<title>A Simple Starter Guide to Build a Neural Network</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建神经网络的简单入门指南</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-simple-starter-guide-to-build-a-neural-network-3c2cf07b8d7c?source=collection_archive---------2-----------------------#2018-01-20">https://towardsdatascience.com/a-simple-starter-guide-to-build-a-neural-network-3c2cf07b8d7c?source=collection_archive---------2-----------------------#2018-01-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/27bdbc9c3c7e6c39113aee0cc5fdc333.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4JlKtA3q-brwyIX3"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@alinnnaaaa?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Alina Grubnyak</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="20f8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从今天开始，你将能够通过<a class="ae kc" href="http://pytorch.org/" rel="noopener ugc nofollow" target="_blank"> PyTorch </a>编程并构建一个香草<a class="ae kc" href="https://brilliant.org/wiki/feedforward-neural-networks/" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir">前馈神经网络</strong> </a> (FNN)。以下是 https://github.com/yhuag/neural-network-lab FNN 的 python jupyter 代码库:<a class="ae kc" href="https://github.com/yhuag/neural-network-lab" rel="noopener ugc nofollow" target="_blank"/></p><blockquote class="lb lc ld"><p id="3116" class="kd ke le kf b kg kh ki kj kk kl km kn lf kp kq kr lg kt ku kv lh kx ky kz la ij bi translated">本指南作为基本的实践工作，引导您从头开始构建神经网络。大部分的数学概念和科学决策都被遗漏了。你可以在这方面做更多的研究。</p></blockquote><h1 id="a7d1" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">入门指南</h1><ol class=""><li id="a8b3" class="mg mh iq kf b kg mi kk mj ko mk ks ml kw mm la mn mo mp mq bi translated">请确保您的计算机中安装了 Python 和 PyTorch:</li></ol><ul class=""><li id="b91c" class="mg mh iq kf b kg kh kk kl ko mr ks ms kw mt la mu mo mp mq bi translated">Python 3.6 ( <a class="ae kc" href="https://www.python.org/downloads/" rel="noopener ugc nofollow" target="_blank">安装</a>)</li><li id="cc31" class="mg mh iq kf b kg mv kk mw ko mx ks my kw mz la mu mo mp mq bi translated">PyTorch ( <a class="ae kc" href="http://pytorch.org/" rel="noopener ugc nofollow" target="_blank">安装</a></li></ul><p id="976a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">2.通过控制台上的命令检查 Python 安装的正确性:</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="16d7" class="nj lj iq nf b gy nk nl l nm nn">python -V</span></pre><p id="4891" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">输出应该是<strong class="kf ir"> Python 3.6.3 </strong>或更高版本</p><p id="be07" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">3.打开一个储存库(文件夹)并创建您的第一个神经网络文件:</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="7000" class="nj lj iq nf b gy nk nl l nm nn">mkdir fnn-tuto<br/>cd fnn-tuto<br/>touch fnn.py</span></pre><h1 id="0fd8" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">开始写代码</h1><p id="a502" class="pw-post-body-paragraph kd ke iq kf b kg mi ki kj kk mj km kn ko no kq kr ks np ku kv kw nq ky kz la ij bi translated">以下所有代码都应写入<strong class="kf ir"> fnn.py </strong>文件</p><h2 id="9cfa" class="nj lj iq bd lk nr ns dn lo nt nu dp ls ko nv nw lw ks nx ny ma kw nz oa me ob bi translated">进口 PyTorch</h2><figure class="na nb nc nd gt jr"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="42c1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">它会将 PyTorch 载入代码。太好了！良好的开端是成功的一半。</p><h2 id="1af4" class="nj lj iq bd lk nr ns dn lo nt nu dp ls ko nv nw lw ks nx ny ma kw nz oa me ob bi translated">初始化超参数</h2><p id="e40d" class="pw-post-body-paragraph kd ke iq kf b kg mi ki kj kk mj km kn ko no kq kr ks np ku kv kw nq ky kz la ij bi translated">超参数是预先设置的强有力的参数，不会随着神经网络的训练而更新。</p><figure class="na nb nc nd gt jr"><div class="bz fp l di"><div class="oc od l"/></div></figure><h2 id="8fff" class="nj lj iq bd lk nr ns dn lo nt nu dp ls ko nv nw lw ks nx ny ma kw nz oa me ob bi translated">下载 MNIST 数据集</h2><p id="e9c2" class="pw-post-body-paragraph kd ke iq kf b kg mi ki kj kk mj km kn ko no kq kr ks np ku kv kw nq ky kz la ij bi translated">MNIST 是一个巨大的数据库，有大量的手写数字(即 0 到 9)用于图像处理。</p><figure class="na nb nc nd gt jr"><div class="bz fp l di"><div class="oc od l"/></div></figure><h2 id="d074" class="nj lj iq bd lk nr ns dn lo nt nu dp ls ko nv nw lw ks nx ny ma kw nz oa me ob bi translated">加载数据集</h2><p id="df20" class="pw-post-body-paragraph kd ke iq kf b kg mi ki kj kk mj km kn ko no kq kr ks np ku kv kw nq ky kz la ij bi translated">下载 MNIST 数据集后，我们将它们加载到我们的代码中。</p><figure class="na nb nc nd gt jr"><div class="bz fp l di"><div class="oc od l"/></div></figure><p id="3fae" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> <em class="le">注:</em> </strong> <em class="le">我们对 train_dataset 的加载过程进行了洗牌，使学习过程独立于数据顺序，但 test_loader 的顺序仍然是为了考察我们是否能处理输入的未指定偏序。</em></p><h1 id="1e4d" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">建立前馈神经网络</h1><p id="9505" class="pw-post-body-paragraph kd ke iq kf b kg mi ki kj kk mj km kn ko no kq kr ks np ku kv kw nq ky kz la ij bi translated">现在我们已经准备好了数据集。我们将开始构建神经网络。概念图如下所示:</p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oe"><img src="../Images/50f718c093b4299c9bc75cf4e62b71dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*toBL6XleRkwABSwTAFaY_g.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">FNN image retrieved from <a class="ae kc" href="http://web.utk.edu/" rel="noopener ugc nofollow" target="_blank">http://web.utk.edu/</a></figcaption></figure><h2 id="a9fe" class="nj lj iq bd lk nr ns dn lo nt nu dp ls ko nv nw lw ks nx ny ma kw nz oa me ob bi translated">前馈神经网络模型结构</h2><p id="8185" class="pw-post-body-paragraph kd ke iq kf b kg mi ki kj kk mj km kn ko no kq kr ks np ku kv kw nq ky kz la ij bi translated">FNN 包括两个完全连接的层(即 fc1 和 fc2)以及其间的一个非线性 ReLU 层。通常我们称这种结构为<strong class="kf ir">1-隐藏层 FNN </strong>，不包括输出层(fc2)。</p><p id="cc9b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过运行正向传递，输入图像(x)可以通过神经网络，并生成输出(out ),展示它属于 10 个类别中的每一个的受欢迎程度。<em class="le">例如，一个猫的形象对狗类可以有 0.8 的喜欢度，对飞机类可以有 0.3 的喜欢度。</em></p><figure class="na nb nc nd gt jr"><div class="bz fp l di"><div class="oc od l"/></div></figure><h2 id="279c" class="nj lj iq bd lk nr ns dn lo nt nu dp ls ko nv nw lw ks nx ny ma kw nz oa me ob bi translated">实例化 FNN</h2><p id="5390" class="pw-post-body-paragraph kd ke iq kf b kg mi ki kj kk mj km kn ko no kq kr ks np ku kv kw nq ky kz la ij bi translated">我们现在根据我们的结构创建一个真正的 FNN。</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="e178" class="nj lj iq nf b gy nk nl l nm nn">net = Net(input_size, hidden_size, num_classes)</span></pre><h2 id="dfda" class="nj lj iq bd lk nr ns dn lo nt nu dp ls ko nv nw lw ks nx ny ma kw nz oa me ob bi translated">启用 GPU</h2><p id="295b" class="pw-post-body-paragraph kd ke iq kf b kg mi ki kj kk mj km kn ko no kq kr ks np ku kv kw nq ky kz la ij bi translated"><strong class="kf ir"> <em class="le">注意:</em> </strong> <em class="le">你可以启用该行运行 GPU 上的代码</em></p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="69c2" class="nj lj iq nf b gy nk nl l nm nn"># net.cuda()    # You can comment out this line to disable GPU</span></pre><h2 id="2738" class="nj lj iq bd lk nr ns dn lo nt nu dp ls ko nv nw lw ks nx ny ma kw nz oa me ob bi translated">选择损失函数和优化器</h2><p id="9d15" class="pw-post-body-paragraph kd ke iq kf b kg mi ki kj kk mj km kn ko no kq kr ks np ku kv kw nq ky kz la ij bi translated">损失函数(<strong class="kf ir">标准</strong>)决定了输出如何与一个类进行比较，从而决定了神经网络的表现好坏。并且<strong class="kf ir">优化器</strong>选择一种方式来更新权重，以便收敛到该神经网络中的最佳权重。</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="2970" class="nj lj iq nf b gy nk nl l nm nn">criterion = nn.CrossEntropyLoss()<br/>optimizer = torch.optim.Adam(net.parameters(), lr=learning_rate)</span></pre><h1 id="91e8" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">培训 FNN 模型</h1><p id="e216" class="pw-post-body-paragraph kd ke iq kf b kg mi ki kj kk mj km kn ko no kq kr ks np ku kv kw nq ky kz la ij bi translated">根据您的机器，此过程可能需要大约 3 到 5 分钟。详细的解释在下面的代码中作为注释(#)列出。</p><figure class="na nb nc nd gt jr"><div class="bz fp l di"><div class="oc od l"/></div></figure><h1 id="28eb" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf bi translated">测试 FNN 模型</h1><p id="cfbb" class="pw-post-body-paragraph kd ke iq kf b kg mi ki kj kk mj km kn ko no kq kr ks np ku kv kw nq ky kz la ij bi translated">类似于训练神经网络，我们还需要加载一批测试图像并收集输出。不同之处在于:</p><ol class=""><li id="e996" class="mg mh iq kf b kg kh kk kl ko mr ks ms kw mt la mn mo mp mq bi translated">无损失和重量计算</li><li id="dc9a" class="mg mh iq kf b kg mv kk mw ko mx ks my kw mz la mn mo mp mq bi translated">没有重量更新</li><li id="50d9" class="mg mh iq kf b kg mv kk mw ko mx ks my kw mz la mn mo mp mq bi translated">具有正确的预测计算</li></ol><figure class="na nb nc nd gt jr"><div class="bz fp l di"><div class="oc od l"/></div></figure><h2 id="36af" class="nj lj iq bd lk nr ns dn lo nt nu dp ls ko nv nw lw ks nx ny ma kw nz oa me ob bi translated">保存训练好的 FNN 模型以备将来使用</h2><p id="055f" class="pw-post-body-paragraph kd ke iq kf b kg mi ki kj kk mj km kn ko no kq kr ks np ku kv kw nq ky kz la ij bi translated">我们将训练好的模型保存为一个<a class="ae kc" href="https://wiki.python.org/moin/UsingPickle" rel="noopener ugc nofollow" target="_blank"> pickle </a>供以后加载和使用。</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="e364" class="nj lj iq nf b gy nk nl l nm nn">torch.save(net.state_dict(), ‘fnn_model.pkl’)</span></pre></div><div class="ab cl of og hu oh" role="separator"><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok"/></div><div class="ij ik il im in"><blockquote class="om"><p id="17dd" class="on oo iq bd op oq or os ot ou ov la dk translated">恭喜你。您已经完成了第一个前馈神经网络的构建！</p></blockquote><h1 id="8035" class="li lj iq bd lk ll lm ln lo lp lq lr ls lt ow lv lw lx ox lz ma mb oy md me mf bi translated">下一步是什么</h1><p id="922b" class="pw-post-body-paragraph kd ke iq kf b kg mi ki kj kk mj km kn ko no kq kr ks np ku kv kw nq ky kz la ij bi translated">保存并关闭文件。开始在控制台运行文件:</p><pre class="na nb nc nd gt ne nf ng nh aw ni bi"><span id="f178" class="nj lj iq nf b gy nk nl l nm nn">python fnn.py</span></pre><p id="eb83" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您将看到培训过程如下所示:</p><figure class="na nb nc nd gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oz"><img src="../Images/b3850568fbfef2b8ff86a85e92189e8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WQKAUrnU1Qi20gkCp2zuJQ.png"/></div></div></figure><blockquote class="om"><p id="71a2" class="on oo iq bd op oq pa pb pc pd pe la dk translated">感谢你的时间，希望你喜欢这个教程。所有代码都可以在这里找到<a class="ae kc" href="https://github.com/yhuag/neural-network-lab/blob/master/Feedforward%20Neural%20Network.ipynb" rel="noopener ugc nofollow" target="_blank"/>！</p></blockquote><p id="4877" class="pw-post-body-paragraph kd ke iq kf b kg pf ki kj kk pg km kn ko ph kq kr ks pi ku kv kw pj ky kz la ij bi translated"><strong class="kf ir">功劳:代码都是基于</strong> <a class="ae kc" href="https://github.com/yunjey" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> yunjey 的</strong> </a> <strong class="kf ir">伟大的</strong><a class="ae kc" href="https://github.com/yunjey/pytorch-tutorial/blob/master/tutorials/02-intermediate/generative_adversarial_network/main.py" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir">code base</strong></a><strong class="kf ir">编写的。❤ </strong></p><figure class="na nb nc nd gt jr"><div class="bz fp l di"><div class="pk od l"/></div></figure></div></div>    
</body>
</html>