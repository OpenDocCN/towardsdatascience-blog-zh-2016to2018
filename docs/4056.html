<html>
<head>
<title>Productive research with custom IPython extensions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用自定义 IPython 扩展进行富有成效的研究</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/productive-research-with-custom-ipython-extensions-fc7627756370?source=collection_archive---------9-----------------------#2018-07-13">https://towardsdatascience.com/productive-research-with-custom-ipython-extensions-fc7627756370?source=collection_archive---------9-----------------------#2018-07-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="963f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在过去的一年里，我对数据科学和机器学习越来越感兴趣。在这样做的时候，我注意到每次我想进行一些研究时，我都必须在 IPython 和 Jupyter notebook 中执行相同的重复任务，这使我脱离了心流。为了解决这个问题，我构建了一些定制的 IPython 扩展，极大地提高了我的工作效率。我想和你们分享这些扩展，我是如何构建它们的，以及我如何在日常研究中使用它们。扩展的示例代码可以在下面找到。此外，在这篇文章的第二部分中，我还谈到了我是如何将 BigQuery 支持直接构建到 IPython 中的。</p></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><p id="e5ba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">作为深入研究数据科学和机器学习的必然副作用，我一直在写大量的 Python，我真的很喜欢。Python 实际上是数据科学的<em class="kt">通用语</em>。这产生了一个<a class="ae kl" href="https://www.scipy.org/" rel="noopener ugc nofollow" target="_blank">令人难以置信的工具和技术生态系统</a>。我特别喜欢用<a class="ae kl" href="https://jupyter.org/" rel="noopener ugc nofollow" target="_blank"> Jupyter </a>笔记本在<a class="ae kl" href="https://ipython.org/" rel="noopener ugc nofollow" target="_blank"> IPython </a>、<em class="kt">尤其是</em>内部做研究分析。说到快速原型和探索，Jupyter 是一个梦想。它允许我以一种简单、直观的方式快速尝试想法。这也迫使我记录下我是如何找到一个问题的最终解决方案的，这在重新整理一些我很久没看的旧工作时非常有用。</p><p id="2761" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当我第一次启动 iPython/Jupyter 时，我几乎总是预先导入相同的模块:</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="kz la l"/></div></figure><p id="381d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您从事大量的数据科学工作，这应该是您非常熟悉的前奏。如果没有，这些是使用 python 进行研究和分析时使用的一些核心数据处理和可视化库。</p><p id="7110" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在将完全相同的样板文件输入 20 个笔记本后，我开始寻找将这些导入文件自动放入我的环境的方法。</p><p id="d32d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">输入<a class="ae kl" href="http://ipython.readthedocs.io/en/stable/config/extensions/" rel="noopener ugc nofollow" target="_blank">自定义 IPython 扩展</a>。扩展允许您连接到您的 IPython 环境，并根据您的需要修改它。这正是我要找的🙏🏻。我首先制作了自己的自定义扩展，将所有这些库导入到研究环境中，并配置了 matplotlib。</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="kz la l"/></div></figure><p id="0ac2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，如果你想知道<code class="fe lb lc ld le b">: InteractiveShell</code>业务是关于什么的，那是 Python 的<a class="ae kl" href="https://www.python.org/dev/peps/pep-0484/" rel="noopener ugc nofollow" target="_blank">类型提示</a>语法的一部分。我已经习惯了使用这种语法，因为当它与<a class="ae kl" href="https://github.com/Microsoft/vscode-python" rel="noopener ugc nofollow" target="_blank"> VSCode 的 Python 扩展</a>一起使用时，它提供了很好的开发人员工效学，这是我的首选 Python 开发环境。<code class="fe lb lc ld le b">load_ipython_extension</code>基本上是 ipython 扩展的<code class="fe lb lc ld le b">main()</code>函数；当一个扩展最初通过<code class="fe lb lc ld le b">%[re]load_ext</code>被加载时，它被调用，并用于引导扩展，以及“注册魔法”(稍后将详细介绍！).上面，我使用<a class="ae kl" href="http://ipython.readthedocs.io/en/stable/api/generated/IPython.core.interactiveshell.html#IPython.core.interactiveshell.InteractiveShell.enable_matplotlib" rel="noopener ugc nofollow" target="_blank"> enable_matplotlib() </a>以及<a class="ae kl" href="http://ipython.readthedocs.io/en/stable/api/generated/IPython.core.interactiveshell.html#IPython.core.interactiveshell.InteractiveShell.push" rel="noopener ugc nofollow" target="_blank"> push() </a>方法来代替必须手写这个前奏。</p><p id="087a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦我有了扩展的框架，我就写了一个简单的<code class="fe lb lc ld le b">setup.py</code>脚本，用来符号化扩展，这样我就可以从任何笔记本上加载它。在运行设置脚本之前，我添加了<code class="fe lb lc ld le b">install_requires</code>作为对我是否处于正确环境的健康检查。</p><figure class="ku kv kw kx gt ky"><div class="bz fp l di"><div class="kz la l"/></div></figure><p id="fb39" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这几乎是我开始工作所需要的全部。一旦我运行了<code class="fe lb lc ld le b">python setup.py develop</code>，我就可以在任何笔记本或 IPython shell 上使用我的扩展了！</p><figure class="ku kv kw kx gt ky gh gi paragraph-image"><div role="button" tabindex="0" class="lg lh di li bf lj"><div class="gh gi lf"><img src="../Images/064a9d69835cf70066be7d79e6417874.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OuyaOHA-KbzHNnNt7XqULg.png"/></div></div></figure><p id="57ff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kt">注意，我在那里使用了</em> <code class="fe lb lc ld le b"><em class="kt">reload_ext</em></code> <em class="kt">，这样，如果我重新运行该命令，它仍然会工作(因为</em> <code class="fe lb lc ld le b"><em class="kt">reload_ext</em></code> <em class="kt">是幂等的)</em>。</p><p id="70cb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我只需要这一行就可以加载我想使用的所有库。随着时间的推移，这种按键的节省真的对我很有帮助。此外，通常当我在命令行上打开 IPython 时，这是因为我有一个想快速尝试的想法。在加载时拥有我需要的所有库使我保持流畅，而不必记住(或复制/粘贴)样板文件。</p><p id="4589" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">继续阅读这篇博文的第 2 部分，看看如何使用✨cell magic✨直接从 IPython 查询<a class="ae kl" href="https://cloud.google.com/bigquery/" rel="noopener ugc nofollow" target="_blank"> BigQuery </a>。</p></div></div>    
</body>
</html>