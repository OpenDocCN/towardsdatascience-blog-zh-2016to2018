<html>
<head>
<title>Numerical Interpolation: Natural Cubic Spline</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数值插值:自然三次样条曲线</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/numerical-interpolation-natural-cubic-spline-52c1157b98ac?source=collection_archive---------2-----------------------#2018-12-02">https://towardsdatascience.com/numerical-interpolation-natural-cubic-spline-52c1157b98ac?source=collection_archive---------2-----------------------#2018-12-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="248d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">探索分段插值的强大功能</h2></div></div><div class="ab cl kf kg hu kh" role="separator"><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk kl"/><span class="ki bw bk kj kk"/></div><div class="ij ik il im in"><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/76b872528747bdb9bfb49937b5347872.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*d4EtBUaknKad3m44"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Photo by <a class="ae lc" href="https://unsplash.com/@mitchel3uo?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Mitchell Luo</a> on <a class="ae lc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="575a" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">当我第一次听说这个方法时，我被它迷住了，尤其是它的推导过程。这篇文章将向你展示我是如何破解它并使它变得更简单的。我们将使用<strong class="lf ir">自上而下的方法</strong>,确保你在阅读的时候能够更好地理解它。</p><h1 id="fd00" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">数值插值</h1><blockquote class="mr"><p id="b596" class="ms mt iq bd mu mv mw mx my mz na ly dk translated">简而言之，它要求:</p><p id="f122" class="ms mt iq bd mu mv mw mx my mz na ly dk translated">我们如何使用一个函数来拟合所有这些数据点呢？</p></blockquote><p id="7083" class="pw-post-body-paragraph ld le iq lf b lg nb jr li lj nc ju ll lm nd lo lp lq ne ls lt lu nf lw lx ly ij bi translated">我们所指的函数也叫做<em class="ng">插值函数</em>或<em class="ng">插值函数</em>。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/8778777708291e700c948848366253f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:686/format:webp/1*MiuJHT7vPwb8A_rqJlcDbw.png"/></div></figure><h2 id="9c09" class="ni ma iq bd mb nj nk dn mf nl nm dp mj lm nn no ml lq np nq mn lu nr ns mp nt bi translated">插值、近似和曲线拟合之间的区别</h2><p id="ab46" class="pw-post-body-paragraph ld le iq lf b lg nu jr li lj nv ju ll lm nw lo lp lq nx ls lt lu ny lw lx ly ij bi translated">插值通常与逼近和曲线拟合相混淆。它们之间差异的关键在于它们与数据的吻合程度以及使用的适当性。</p><p id="77d6" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><strong class="lf ir">插值与逼近</strong></p><p id="b7d6" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">在插值中，你精确地拟合<strong class="lf ir">所有的</strong>数据点，而近似，顾名思义，就是<strong class="lf ir">近似</strong>。</p><p id="4575" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">就适当性而言，内插法适用于平滑此类噪声数据，而不适用于数据点易受实验误差或其他重大误差源影响的情况。拥有大量数据点也会增加插值的负担。另一方面，近似主要适用于计算特殊函数的库例程的设计。这是由这些函数的性质决定的——精确的值被认为是不重要的，并且在某种程度上，当近似值起作用时是低效的。</p><p id="e5d3" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><strong class="lf ir">插值与曲线拟合</strong></p><p id="c1ee" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">在曲线拟合中，我们<strong class="lf ir">不会拟合所有的</strong>数据点。这就是为什么我们有残差的概念。在插值中，它强制函数<strong class="lf ir">拟合所有</strong>数据点。</p><p id="21d6" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">现在我们知道我们在谈论哪一类，让我们缩小到用于插值的函数族。</p><h1 id="9bd6" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">用于插值的函数族</h1><p id="da51" class="pw-post-body-paragraph ld le iq lf b lg nu jr li lj nv ju ll lm nw lo lp lq nx ls lt lu ny lw lx ly ij bi translated">(2)这里考虑的两个函数族:</p><ol class=""><li id="c1f0" class="nz oa iq lf b lg lh lj lk lm ob lq oc lu od ly oe of og oh bi translated">多项式内插法</li><li id="f22d" class="nz oa iq lf b lg oi lj oj lm ok lq ol lu om ly oe of og oh bi translated">分段插值</li></ol><p id="8418" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><strong class="lf ir">扰流板</strong>:自然三次样条正在进行分段插值。但是让我们稍后解释这两种方法来欣赏它们。</p><h2 id="2b05" class="ni ma iq bd mb nj nk dn mf nl nm dp mj lm nn no ml lq np nq mn lu nr ns mp nt bi translated"><strong class="ak"> 1。多项式插值</strong></h2><p id="b145" class="pw-post-body-paragraph ld le iq lf b lg nu jr li lj nv ju ll lm nw lo lp lq nx ls lt lu ny lw lx ly ij bi translated">多项式插值是最简单也是最常见的插值类型。它的一个特点是总是有一个最多 n-1 次的唯一多项式通过<em class="ng"> n </em>个数据点。</p><p id="cba3" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">有许多方法来计算或表示一个多项式，但它们归结为同一个数学函数。一些方法是单项基，拉格朗日基和牛顿基。正如你所注意到的，它们是以它们的基础命名的。</p><p id="df87" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><strong class="lf ir">弊端:</strong></p><ol class=""><li id="79cf" class="nz oa iq lf b lg lh lj lk lm ob lq oc lu od ly oe of og oh bi translated">高次多项式→适当选择基函数和插值点可以减轻与高次多项式相关的一些困难</li><li id="cdae" class="nz oa iq lf b lg oi lj oj lm ok lq ol lu om ly oe of og oh bi translated">过度拟合→将单个多项式拟合到大量数据点，这可能会在插值函数中产生不令人满意的振荡行为</li></ol><p id="4ac7" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">随着不同方法的诞生，分段插值解决了这些复杂问题。</p><h2 id="4fb3" class="ni ma iq bd mb nj nk dn mf nl nm dp mj lm nn no ml lq np nq mn lu nr ns mp nt bi translated">2.分段插值</h2><p id="a6ae" class="pw-post-body-paragraph ld le iq lf b lg nu jr li lj nv ju ll lm nw lo lp lq nx ls lt lu ny lw lx ly ij bi translated">分段插值通过用低次多项式拟合大量数据点来解决这些问题。由于我们只使用低次多项式，我们消除了过度的振荡和不收敛。</p><p id="9e06" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><strong class="lf ir">一般概念:</strong>给定一组数据点，在每个区间使用不同的多项式，这样我们在连续的点上插入几个插值。这就是为什么会有诸如结、断点或控制点之类的术语——这些是插值函数从一个多项式变为另一个多项式的横坐标。</p><p id="cc54" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><strong class="lf ir">主要关注:</strong>似乎牺牲了插值函数插值的光滑性，使得图形可能有“拐角”，这意味着导数在这些点处是不连续的。</p><p id="bd2c" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><strong class="lf ir">目标:</strong>考虑到所有这些概念和主要关注点，我们的目标是找到一个平滑的插值函数，并且在节点之间没有太大的变化。</p><p id="45c6" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><em class="ng">既然我们已经讨论了自然三次样条的归属，因此该方法也应该继承所有这些一般特征。我们现在讨论下面的方法。别担心，我们会理解我们将要讨论的每一部分。</em></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi on"><img src="../Images/d13a65dcfa6cfb28773fa8fcd98f44f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*1qrP5fLwQS0ivf2Cok-lzw.gif"/></div></figure><h1 id="6bf1" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated"><strong class="ak">方法:自然三次样条</strong></h1><p id="950e" class="pw-post-body-paragraph ld le iq lf b lg nu jr li lj nv ju ll lm nw lo lp lq nx ls lt lu ny lw lx ly ij bi translated"><strong class="lf ir">一、为什么叫自然三次样条？</strong></p><p id="c47e" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><strong class="lf ir">‘Spline’—</strong>这个只是指 k 次的分段多项式<em class="ng"> k 次</em>连续可微 k-1 次</p><p id="a55d" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">从那以后，</p><p id="ef2d" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><strong class="lf ir">‘自然三次样条’—</strong>是一个<strong class="lf ir">分段三次多项式</strong>，它是两次连续可微的。它比多项式“硬”得多，因为它在数据点之间不太容易振荡。</p><p id="cc1b" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">仍然没有任何意义吗？让我们将它形象化，并解释我们稍后将通过机械模型使用的零件的数学术语。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi oo"><img src="../Images/9459ccc604489f63ba1d71bf2084e399.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*f3ECe8cbMwxTSqk5dCH--Q.png"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">figure from: Numerical Methods in Engineering with Matlab, 2ed by Jan Kiusalaas</figcaption></figure><p id="1a8c" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">让我们想象一下，有一个弹性条钉在软木板上。现在介绍要点:</p><ol class=""><li id="1a87" class="nz oa iq lf b lg lh lj lk lm ob lq oc lu od ly oe of og oh bi translated"><strong class="lf ir">段:</strong>样条曲线的每一段都是三次多项式。</li><li id="991b" class="nz oa iq lf b lg oi lj oj lm ok lq ol lu om ly oe of og oh bi translated"><strong class="lf ir">在销钉处:</strong>斜率(一阶导数)和弯矩(二阶导数)是连续的</li><li id="0fd4" class="nz oa iq lf b lg oi lj oj lm ok lq ol lu om ly oe of og oh bi translated"><strong class="lf ir">在端点:</strong>没有弯矩。在数学语言中，这意味着样条在端点的二阶导数为零。由于这些端点条件在梁模型中自然出现，因此生成的曲线称为自然三次样条曲线。</li><li id="853b" class="nz oa iq lf b lg oi lj oj lm ok lq ol lu om ly oe of og oh bi translated"><strong class="lf ir">图钉:</strong>代表数据点或后面公式中使用的术语<strong class="lf ir">【结】</strong></li></ol><p id="fdb7" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">现在我们已经清楚了一般的概念，让我们把这些概念具体化。我们用推导来说明它是如何产生的。</p><p id="43ae" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><strong class="lf ir">二。推导</strong></p><p id="db2a" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><em class="ng">这个比较长，但是对于懂导数和积分的人来说是可以理解的。</em></p><p id="8e27" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><strong class="lf ir">答:大图</strong></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi op"><img src="../Images/661b8e07094795981e512db63e5a11fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*8UY4-9TG96eZBC26pCZwDw.png"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">figure from: Numerical Methods in Engineering with Matlab, 2ed by Jan Kiusalaas</figcaption></figure><p id="0835" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">其中有<em class="ng"> n 个节点(k 个)</em>是数据点(x，y)，f 是两个节点之间的插值。</p><p id="1b37" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">由于我将数学视为建模，我们从插图开始。这将作为具体告诉我们要解释什么，也是我们的地图，而我们做推导。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi oq"><img src="../Images/e36fd76d2c605b471ffbbe0227ca1978.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uHedsTW52c-0ZR5oW6Zy2A.png"/></div></div></figure><p id="9c9c" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><strong class="lf ir"> B .要求</strong></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi or"><img src="../Images/b7644a453655cbccfb9587ca7aa50478.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yaCCEVABSPGxtv8cf_qa3w.png"/></div></div></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi os"><img src="../Images/821ea6bab48e970121d803880a0080bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VN6U_o5fQZDf_UbSPEYZtQ.png"/></div></div></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/a8d1ae71489670efecdfb589fe64a825.png" data-original-src="https://miro.medium.com/v2/resize:fit:1268/format:webp/1*AeA7FhMpzBpcSoI7Mqb1Pw.png"/></div></figure><p id="4c6e" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><strong class="lf ir"> C .引出适当的</strong></p><p id="c8bf" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">正确的推导由两部分组成——每一部分得出一个方程——我们将使用它并在计算中发挥重要作用。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ou"><img src="../Images/f251bc480188cd5e9bf7c82b061c14be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hdHzM37X2esve2bSugwQGw.png"/></div></div></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/e063337b1ad77b4175b0903e995947c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:706/format:webp/1*r_tY2mtklSZHJ3y2A8GaUQ.png"/></div></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ow"><img src="../Images/c0bc2bc09e606653ee51ab96daec7a7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wyiwdutiX5kQ0LfjhfsMDw.png"/></div></div></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ox"><img src="../Images/2661b57fda11b11776f6f29565537003.png" data-original-src="https://miro.medium.com/v2/resize:fit:1282/format:webp/1*21Lsmfb8YBHpdB4UtESJXw.png"/></div></div></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/83182bd9c5e45c044a89f83ca2ef824e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*CkC4qhn_r3JtQxLyUBIveg.png"/></div></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi oz"><img src="../Images/b19cf5ecd30a857793dc6ded273c7740.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iLJwmvMtSTrxSQgeuygWrg.png"/></div></div></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi pa"><img src="../Images/a22001f74f20b3ff1277e2b51d020102.png" data-original-src="https://miro.medium.com/v2/resize:fit:948/format:webp/1*aQvQbdfU3Cg8OHCLg6QeGA.png"/></div></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi pb"><img src="../Images/58f3ba0bb9307d8faf098997a78497df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JfwkmHkOooJfJm_7cZhUlw.png"/></div></div></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi pc"><img src="../Images/fe730a95821abde5bf8db80f026c7037.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kGee51Bq0XmTUfTfQQMBHg.png"/></div></div></figure><p id="8e81" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">有了所需的公式后，我们展示如何使用它们。</p><p id="0657" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><strong class="lf ir">三。怎么用它做插值？</strong></p><p id="04cb" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">我们通过一个例子来说明它的用法，然后概括这个过程。</p><p id="92cc" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><strong class="lf ir">例#1: </strong>用自然三次样条确定 x = 1.5 处的 y。数据点如下:(2，1)，(1，0)，(5，0)，(3，0)，(4，1)</p><p id="0630" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><strong class="lf ir">解决方案:</strong></p><p id="28d6" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">我们首先明白它想要什么。它的主要要求是—使用自然三次样条函数为包含 x = 1.5 的线段找到一个插值函数，该插值函数将对给定的所有数据点进行插值，并知道其对应的 y 坐标。</p><p id="bf73" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">或者以更简单的方式:(1)插值函数(2) y 在 x=1.5 时</p><p id="831d" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">我们首先得到我们的公式:</p><p id="a05b" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><em class="ng">用于插值器</em></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/a7ad88f36a426cfed8b225a0e60208e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*OKjMGEryK0s8lrRI_x__3Q.png"/></div></figure><p id="a05e" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><em class="ng">为绳结</em></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/4517e1aa03731d71ebe3c5c9c6a69ade.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*owCM6Tt6gtXfhE8mbCAS0g.png"/></div></figure><p id="65d6" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">我们必须重新排列这些值来简化这个过程</p><p id="3d55" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi">:(1, 0), (2, 1), (3, 0), (4,1), (5,0)</p><p id="3d66" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">然后我们知道具体的结</p><p id="a81b" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">注意:k1=k5=0，所以我们只考虑 i=2，3，4</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi pe"><img src="../Images/a0b5a889f1760045ab3268dcc233ccfc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*s1ncwhrhxT3Z1Xga0AMOwg.png"/></div></figure><p id="5369" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">然后我们替换相应的值，这样:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi pf"><img src="../Images/51ae453dfc7a520f1a72ce0b359a89b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*Xy9TQZxe4QyJAevDWRhpKQ.png"/></div></figure><p id="6535" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">这又产生了一个线性方程组:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi pg"><img src="../Images/31cc7991d93f9b1b11917230050dda61.png" data-original-src="https://miro.medium.com/v2/resize:fit:520/format:webp/1*LfYqvO0spIl8cxzEjQr7tw.png"/></div></figure><p id="95bf" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">结可以通过求根技术消除、替换、高斯消除、LU 分解等来解决。</p><p id="99f2" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">我们在这里使用高斯消去法:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ph"><img src="../Images/331b3c3d641958d00bee517619d6686d.png" data-original-src="https://miro.medium.com/v2/resize:fit:742/format:webp/1*UJk-E5rsrRWmAmFzqJ3x7w.png"/></div></figure><p id="dd89" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><em class="ng">跳过我们的详细计算:</em></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi pi"><img src="../Images/11b56b9176e5c91be27477554345f032.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/format:webp/1*W-BGbzaKM8yWrJtPiQkXAQ.png"/></div></figure><p id="7252" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">然后我们知道焦点在 x = 1.5 时得到 y</p><p id="e0ad" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">我们发现 x 在哪个纽结中:1.5 在 x1 = 1 和 x2 = 2 之间</p><p id="1854" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">因此，我们使用第一个和第二个结，使得:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/043b2c0c1244c3864038109b1e792e22.png" data-original-src="https://miro.medium.com/v2/resize:fit:882/format:webp/1*4G84U162CsCqKYWVmS6jbw.png"/></div></figure><p id="0cd9" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">替代我们的价值观:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi pk"><img src="../Images/05c79a0d4a3651c47f15a74129b76be6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1014/format:webp/1*Pq03sE5xvzxvt4-0EOsOWQ.png"/></div></figure><p id="522f" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">因此，</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi pl"><img src="../Images/1aacb0441b9ecc92f80de08ced910efc.png" data-original-src="https://miro.medium.com/v2/resize:fit:410/format:webp/1*cAb1f4y61dKDeb0EoSyJDA.png"/></div></figure><p id="6e90" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">现在我们已经看到了它是如何工作的，我们推广这个过程，给出一个使用自然三次样条找到某个 x 处的 y 的问题的解决方案。</p><p id="26e1" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><strong class="lf ir">一般流程:</strong></p><p id="3d47" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><em class="ng">必须被视为一个建议而已。有很多方法可以做到这一点。</em></p><p id="8db0" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><strong class="lf ir">给定:</strong>数据点</p><p id="c385" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><strong class="lf ir">求:</strong>插值函数 fi，i+1(x)在某 x 处考虑 y。</p><p id="4dc5" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><strong class="lf ir">流程:</strong></p><p id="5660" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">* <strong class="lf ir">第一个主要步骤:配方和准备</strong></p><p id="cb80" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">我们将需要这些公式，所以最好在开始计算之前解决所有的公式:</p><ol class=""><li id="116c" class="nz oa iq lf b lg lh lj lk lm ob lq oc lu od ly oe of og oh bi translated">为了绳结</li></ol><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/4517e1aa03731d71ebe3c5c9c6a69ade.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*owCM6Tt6gtXfhE8mbCAS0g.png"/></div></figure><p id="0004" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">2.对于分段的插值函数</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi pd"><img src="../Images/a7ad88f36a426cfed8b225a0e60208e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*OKjMGEryK0s8lrRI_x__3Q.png"/></div></figure><p id="1dd7" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">3.确保横坐标(x 坐标)按升序排列，因为我们考虑的是每段的功能。</p><p id="db34" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><strong class="lf ir">*第二个主要步骤:使用上述公式 1 </strong>求解结(k)</p><ol class=""><li id="e23f" class="nz oa iq lf b lg lh lj lk lm ob lq oc lu od ly oe of og oh bi translated">I 的替代</li><li id="46ea" class="nz oa iq lf b lg oi lj oj lm ok lq ol lu om ly oe of og oh bi translated">替换整个值</li><li id="5b18" class="nz oa iq lf b lg oi lj oj lm ok lq ol lu om ly oe of og oh bi translated">形成线性方程组后，从 i=2，3，…，n-1 得到纽结</li></ol><p id="4e85" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated"><strong class="lf ir">*第三个主要步骤:求解 fi，i+1(x_c) </strong></p><ol class=""><li id="7982" class="nz oa iq lf b lg lh lj lk lm ob lq oc lu od ly oe of og oh bi translated">首先找出 x_c 属于哪个结</li><li id="d4fe" class="nz oa iq lf b lg oi lj oj lm ok lq ol lu om ly oe of og oh bi translated">得到 fi，i+1(x)</li><li id="6953" class="nz oa iq lf b lg oi lj oj lm ok lq ol lu om ly oe of og oh bi translated">得到 fi，i+1(x_c)</li></ol><h1 id="3a47" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">总的来说，</h1><p id="9fc0" class="pw-post-body-paragraph ld le iq lf b lg nu jr li lj nv ju ll lm nw lo lp lq nx ls lt lu ny lw lx ly ij bi translated">可以说自然三次样条是一种非常有趣的插值方法。我们知道插值是用一个函数来拟合所有给定的数据点，我们知道多项式插值在某些时候可以只使用一个多项式来完成这项工作。当我们只考虑低次多项式时特别有用，但对于高次多项式，过度拟合潜伏在深处，产生不需要的振荡，不能提供任何对数据的洞察。一个可取之处是分段插值，它使用不同的低次多项式，这对于大型数据集特别有用。可以看出，在分段实现中有更多的工作要做，但是考虑到大数据集的方法的复杂性超过了相当长的实现。</p><p id="1225" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">参考资料:</p><p id="9a9e" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">JM·索里亚诺爵士的 CS131 课堂讲稿</p><p id="8ebc" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">米（meter 的缩写））希斯。科学计算:介绍性调查。</p><p id="d720" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">K.阿特金森和韩。初等数值分析。</p><p id="0c0d" class="pw-post-body-paragraph ld le iq lf b lg lh jr li lj lk ju ll lm ln lo lp lq lr ls lt lu lv lw lx ly ij bi translated">J.基乌斯拉斯。用 Matlab 实现工程中的数值方法。</p></div></div>    
</body>
</html>