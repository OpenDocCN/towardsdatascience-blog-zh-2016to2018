<html>
<head>
<title>Neural Network Plays Flappy Bird</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">神经网络扮演Flappy Bird</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/neural-network-plays-flappy-bird-e585b1e49d97?source=collection_archive---------0-----------------------#2017-04-10">https://towardsdatascience.com/neural-network-plays-flappy-bird-e585b1e49d97?source=collection_archive---------0-----------------------#2017-04-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="715b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">目前，我是一名大学IT专业的学生。这学期，我上了一门非常有趣的课，我选择了自己的主题来学习，并设计了自己的项目。所以我决定学习和研究一些非常有趣和独特的东西。当我在探索各种主题时，我发现了一个关于神经网络的<a class="ae kl" href="https://www.youtube.com/watch?v=P7XHzqZjXQs" rel="noopener ugc nofollow" target="_blank">视频教程</a>，我对学习这个主题非常感兴趣。</p><p id="2b2f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">看完教程视频后，我想到了一个实现一个学习如何玩Flappy Bird游戏的神经网络程序的想法。最后，这是我的结果。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="kr ks l"/></div></figure><p id="263e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当程序第一次运行时，它什么也不做，因为它对游戏一无所知。然而，几个小时的训练，它学会了如何玩游戏。</p><p id="a195" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这篇文章中，我想给出一个关于神经网络的基本信息以及我是如何实现我的程序的。</p><h1 id="1f12" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">什么是神经网络？</h1><p id="e355" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">首先，我想说说什么是神经网络。在编程中，人工神经网络是受生物神经网络的结构和功能方面启发的用于机器学习的计算模型/算法。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/8534ef8ca437bdea1c7ad6faec635ef7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*BQ0SxdqC9Pl_3ZQtd3e45A.png"/></div><figcaption class="lz ma gj gh gi mb mc bd b be z dk">Neural Network</figcaption></figure><p id="929a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每个神经网络都有一个输入层、一个输出层和一个或多个隐藏层。每个圆圈代表一个神经元，一个神经元与下一层的每个神经元都有联系。</p><p id="186b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每个连接都有权重值，每个神经元都有偏差值。例如，下图显示了神经网络中发生的情况。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="gh gi md"><img src="../Images/8f17cdf1ac0a2b13d1dbffe6a9e04275.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zd2AuD53JxsJCBeyelb-2A.png"/></div></div></figure><p id="1c12" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当神经网络计算输出时，它会对权重和偏差进行大量计算。你可以很容易地预料到，如果我改变其中一个权重或偏差值，最终的输出也会改变。换句话说，训练神经网络意味着找到并调整权重和偏差值，以给出我们想要的最佳输出。</p><h2 id="2acc" class="mi ku iq bd kv mj mk dn kz ml mm dp ld jy mn mo lh kc mp mq ll kg mr ms lp mt bi translated">新立得</h2><p id="9ce0" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated"><a class="ae kl" href="https://synaptic.juancazala.com/#/" rel="noopener ugc nofollow" target="_blank"> Synaptic.js </a>是一个非常棒的用于node.js和浏览器的JavaScript神经网络库。如果您安装了node.js，您可以使用以下命令安装synaptic.js:</p><pre class="km kn ko kp gt mu mv mw mx aw my bi"><span id="2369" class="mi ku iq mv b gy mz na l nb nc">npm install synaptic --save</span></pre><p id="04d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我想提供一个使用Synaptic.js库解决问题的简单例子。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/e3dc3fe5d9441d3e7d5ff661cf6c3885.png" data-original-src="https://miro.medium.com/v2/resize:fit:548/format:webp/1*_yVOCbgWfxiLXG_JaOTivg.png"/></div></figure><p id="7acd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你看一下左边的表格，它有两个输入和一个输出。如果第一个输入大于第二个输入，则输出为1。否则输出为0。</p><p id="a5f4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">前五个记录将是我们的测试数据，我们将看到最后两个记录的输出是什么。</p><p id="7c5a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面的代码展示了我如何使用synaptic.js来解决这个问题。</p><pre class="km kn ko kp gt mu mv mw mx aw my bi"><span id="024e" class="mi ku iq mv b gy mz na l nb nc"><strong class="mv ir">var </strong>synaptic = require('synaptic');</span><span id="48e9" class="mi ku iq mv b gy ne na l nb nc"><strong class="mv ir">var </strong>myNetwork = <strong class="mv ir">new </strong>synaptic.Architect.Perceptron(2, 3, 1);<br/><strong class="mv ir">var </strong>learningRate = .2;<br/>//training<br/><strong class="mv ir">for </strong>(<strong class="mv ir">var </strong>i = 0; i &lt; 20000; i++)<br/>{<br/>    //test data 1<br/>    myNetwork.activate([2,1]);<br/>    myNetwork.propagate(learningRate, [1]);<br/><br/>    //test data 2<br/>    myNetwork.activate([1,5]);<br/>    myNetwork.propagate(learningRate, [0]);<br/><br/>    //test data 3<br/>    myNetwork.activate([4,2]);<br/>    myNetwork.propagate(learningRate, [1]);<br/><br/>    //test data 4<br/>    myNetwork.activate([5,2]);<br/>    myNetwork.propagate(learningRate, [1]);<br/><br/>    //test data 5<br/>    myNetwork.activate([3,5]);<br/>    myNetwork.propagate(learningRate, [0]);<br/><br/><br/>}<br/>console.log(myNetwork.activate([2,5])); //[ 0.0000728000640238746 ]<br/>console.log(myNetwork.activate([3,1])); //[ 0.9999465030073619 ]</span></pre><h2 id="b42d" class="mi ku iq bd kv mj mk dn kz ml mm dp ld jy mn mo lh kc mp mq ll kg mr ms lp mt bi translated">代码分解</h2><pre class="km kn ko kp gt mu mv mw mx aw my bi"><span id="afd8" class="mi ku iq mv b gy mz na l nb nc"><strong class="mv ir">var </strong>myNetwork = <strong class="mv ir">new </strong>synaptic.Architect.Perceptron(2, 3, 1);</span></pre><p id="0383" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上面的代码创建了一个具有2个输入神经元、3个隐藏神经元和1个输出神经元的神经网络。</p><pre class="km kn ko kp gt mu mv mw mx aw my bi"><span id="25db" class="mi ku iq mv b gy mz na l nb nc">myNetwork.activate([2,1]);</span></pre><p id="da35" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">activate()方法从给定的输入返回输出(在上面的代码中，2和1)。输出值在0到1个浮点值之间。</p><pre class="km kn ko kp gt mu mv mw mx aw my bi"><span id="7b83" class="mi ku iq mv b gy mz na l nb nc">myNetwork.propagate(learningRate, [1]);</span></pre><p id="42a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在调用activate函数之后，我们调用propagate()函数，用学习率和目标输出值来训练网络。这是通过<a class="ae kl" href="https://en.wikipedia.org/wiki/Backpropagation" rel="noopener ugc nofollow" target="_blank">反向传播</a>完成的。</p><h2 id="d36a" class="mi ku iq bd kv mj mk dn kz ml mm dp ld jy mn mo lh kc mp mq ll kg mr ms lp mt bi translated">带Flappy Bird的神经网络</h2><p id="2c47" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">当我实现flappy bird程序时，我得到了5个输入和1个输出。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="gh gi nf"><img src="../Images/01d4262bbe770cc814aa417afc385394.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aImcUmnlZg3xSxe16nJcLQ.png"/></div></div></figure><p id="78f7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些输入是:</p><ul class=""><li id="45e7" class="ng nh iq jp b jq jr ju jv jy ni kc nj kg nk kk nl nm nn no bi translated">鸟的位置</li><li id="0bcb" class="ng nh iq jp b jq np ju nq jy nr kc ns kg nt kk nl nm nn no bi translated">速度</li><li id="1aec" class="ng nh iq jp b jq np ju nq jy nr kc ns kg nt kk nl nm nn no bi translated">下一个管道之间的距离</li><li id="6c4e" class="ng nh iq jp b jq np ju nq jy nr kc ns kg nt kk nl nm nn no bi translated">上部管道高度</li><li id="3750" class="ng nh iq jp b jq np ju nq jy nr kc ns kg nt kk nl nm nn no bi translated">下部管道高度</li></ul><p id="8f52" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每次渲染游戏时，神经网络都会获得输入并激活它。如果输出大于0.55，鸟会跳起来。</p><p id="5214" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是，我不能使用propagate()方法，因为没有测试数据及其目标值。在这种情况下，我们可以使用遗传算法来训练我们的神经网络。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="me mf di mg bf mh"><div class="gh gi nu"><img src="../Images/5b79c0989dfd155a6a1c50f5f785fcb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kNh21pipcKH3n54QVRZG2g.png"/></div></div></figure><p id="7441" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">假设我一代有8只鸟，每只鸟有6个神经元。(在我的实际实现中，一代中有12只鸟，每只鸟有18个神经元)。</p><p id="13c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在一代(12场)之后，我挑选最好的4只鸟并应用交叉和变异。重复同样的过程，直到我们得到好的结果。</p><p id="bab5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于交叉函数，偏置值将被交叉运算。</p><pre class="km kn ko kp gt mu mv mw mx aw my bi"><span id="022e" class="mi ku iq mv b gy mz na l nb nc">Learn.crossOverDataKey(netA.neurons, netB.neurons, 'bias');</span></pre><p id="bc40" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">剪切神经元的随机位置，并将其交叉。</p><pre class="km kn ko kp gt mu mv mw mx aw my bi"><span id="2c82" class="mi ku iq mv b gy mz na l nb nc">Learn.crossOverDataKey = <strong class="mv ir">function </strong>(a, b, key) {<br/>    <strong class="mv ir">var </strong>cutLocation = Math.round(a.length * Math.random());<br/><br/>    <strong class="mv ir">var </strong>tmp;<br/>    <strong class="mv ir">for </strong>(<strong class="mv ir">var </strong>k = cutLocation; k &lt; a.length; k++) {<br/>        // Swap<br/>        tmp = a[k][key];<br/>        a[k][key] = b[k][key];<br/>        b[k][key] = tmp;<br/>    }<br/>}</span></pre><p id="cb3a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于变异函数，偏差和权重值都会发生变异。</p><pre class="km kn ko kp gt mu mv mw mx aw my bi"><span id="06c4" class="mi ku iq mv b gy mz na l nb nc">Learn.mutateDataKeys(net.neurons, 'bias', Learn.mutationProb);<br/><br/>Learn.mutateDataKeys(net.connections, 'weight', Learn.mutationProb);</span></pre><p id="f70f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">连接和神经元被随机选择并变异为随机值。在我的实现中，我有20%的突变率。</p><pre class="km kn ko kp gt mu mv mw mx aw my bi"><span id="9695" class="mi ku iq mv b gy mz na l nb nc">Learn.mutateDataKeys = <strong class="mv ir">function </strong>(a, key, mutationRate){<br/>    <strong class="mv ir">for </strong>(<strong class="mv ir">var </strong>k = 0; k &lt; a.length; k++) {<br/>        // Should mutate?<br/>        <strong class="mv ir">if </strong>(Math.random() &gt; mutationRate) {<br/>            <strong class="mv ir">continue</strong>;<br/>        }<br/><br/>        a[k][key] += a[k][key] * (Math.random() - 0.5) * 3 + (Math.random() - 0.5);<br/>    }<br/>}</span></pre><p id="4610" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以在这里看到我的完整代码<a class="ae kl" href="https://github.com/kwj280/falppyBird-NeuroEvol" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="64ae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，以下是我使用的资源的链接:</p><p id="d176" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">synaptic . js:【https://github.com/cazala/synaptic】<br/>flappy bird网页版:<a class="ae kl" href="https://github.com/nebez/floppybird" rel="noopener ugc nofollow" target="_blank">https://github.com/nebez/floppybird</a><br/>我引用的代码/算法:<a class="ae kl" href="https://github.com/ivanseidel/IAMDinosaur" rel="noopener ugc nofollow" target="_blank">https://github.com/ivanseidel/IAMDinosaur</a></p></div></div>    
</body>
</html>