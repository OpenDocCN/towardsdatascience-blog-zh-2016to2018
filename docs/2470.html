<html>
<head>
<title>Only Numpy: Implementing Google Brain’s +RNN — INTERSECTION RNN (Capacity and Trainability in Recurrent Neural Networks) with Interactive Code.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Only Numpy:用交互式代码实现谷歌大脑的+RNN-交集RNN(递归神经网络中的容量和可训练性)。</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/only-numpy-implementing-google-brains-rnn-intersection-rnn-capacity-and-trainability-in-7dd7902b65a5?source=collection_archive---------5-----------------------#2018-01-29">https://towardsdatascience.com/only-numpy-implementing-google-brains-rnn-intersection-rnn-capacity-and-trainability-in-7dd7902b65a5?source=collection_archive---------5-----------------------#2018-01-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/f31739f96b72c9f4f09184c16f0a77b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0x-CbYjzZ2PAMrnZvCIghQ.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">image from <a class="ae kc" href="https://pixabay.com/en/lens-obsolete-shutter-classic-3114729/" rel="noopener ugc nofollow" target="_blank">pixel bay</a></figcaption></figure><p id="0834" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以今天，让我们从这篇论文“<a class="ae kc" href="https://arxiv.org/abs/1611.09913" rel="noopener ugc nofollow" target="_blank"> <em class="lb">递归神经网络</em> </a>中的容量和可训练性”来完成实现新颖的RNN架构。因为我们已经在我的上一篇博文中实现了更新门RNN。<br/><a class="ae kc" href="https://becominghuman.ai/only-numpy-implementing-and-comparing-google-brains-update-gate-capacity-and-trainability-in-940f0ad80649" rel="noopener ugc nofollow" target="_blank"><em class="lb">Only Numpy:实现和比较Google Brain的Update Gate(递归神经网络中的容量和可训练性)RNN，Hinton博士的Initialize RNN，以及带有交互代码的Vanilla RNN。</em> </a>”</p><p id="66fc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们完成这项工作。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="e66f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">网络架构:数学形式</strong></p><figure class="lk ll lm ln gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lj"><img src="../Images/4441dcc323acfb6f30abb7077f2a1af5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FhHORzHlF6R1WJGd875CfA.png"/></div></div></figure><p id="ebf1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个网络非常不同，不仅有循环部分，还有深度输出(记为Y线19)。现在让我们来看看网络的图形表示。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="95e4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">网络架构</strong></p><figure class="lk ll lm ln gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lo"><img src="../Images/ca3df85766319d1a137814ad4de7cf7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WaV7-IR7iUNmsBKtIM9Ubg.png"/></div></div></figure><p id="0e17" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">蓝框→递归隐藏状态<br/>红框→新深度输出<br/>绿框→每个时间戳输入</p><p id="c029" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同样，非常直接，只是为了增加一些注释。</p><p id="1d08" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">σ() → Logistic Sigmoid激活函数<br/> S1() → ReLU()激活函数<br/> S2() → tanh()激活函数</p><figure class="lk ll lm ln gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lp"><img src="../Images/a4ecea869a28d022210f66714ed12ce8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FjRR5mBGU1XbnVrBYOLmQg.png"/></div></div></figure><figure class="lk ll lm ln gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lq"><img src="../Images/b1b26051272b865d9994e40781369935.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Px_xaItxrWcNNpjKNdYLOA.png"/></div></div></figure></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="8377" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">正向进给操作(针对每个时间戳)</strong></p><figure class="lk ll lm ln gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lr"><img src="../Images/25dac75cf7d73866db1a19ea0c21b176.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HrRWC7Yx4gSfsvapUY3DoA.jpeg"/></div></div></figure><p id="51dd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">绿色方框→时间戳1的输出成本<br/>粉色方框→时间戳2的输出成本<br/>紫色方框→时间戳3的输出成本</p><p id="3c50" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同样，没有什么特别的只是标准的RNN前馈。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="8809" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">关于YY3、HH3、GY3、GH3的反向传播(时间戳= 3) </strong></p><figure class="lk ll lm ln gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ls"><img src="../Images/e1e40dea7929ff4df931bb04f1be1ed7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BlPqRNlq--xAHNpIsrUq8g.jpeg"/></div></div></figure><p id="f00a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这里要注意一点，我不会对重量求导，而是对YY，HH，GY和GH求导。</p><p id="e5dc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为什么？请看看黑盒，我们正在对激活函数的输入进行反向传播。之后我们可以</p><p id="da8e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">乘以h2，如果我们要对Wrecyy、Wrechh、Wrecgy或Wrecgh执行反向传播，或者</p><p id="777b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果我们要对Wxyy、Wxhh、Wxgy或Wxgh执行反向传播，请乘以x3。</p><p id="9668" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是为时间戳3实现的反向传播代码。</p><figure class="lk ll lm ln gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lt"><img src="../Images/3c042dd53abb859e203ec00cbf275d2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KK11Ij-2SBNHyjzDHvtn4A.png"/></div></div></figure></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="d8e1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">关于YY2、HH2(时间戳= 2)的反向传播</strong></p><figure class="lk ll lm ln gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lu"><img src="../Images/7319a06dfcad69c398cee23baacf2411.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NKUF004BWAh9DXEds-_SsQ.png"/></div></div></figure><p id="04f8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">再次，对YY2求导，而不是对Wrecyy或Wxyy求导。另外，请注意红线下的项，该项为零，因为没有变量将YY2与时间戳3的成本联系起来。(这让我们的生活变得轻松了一些。)</p><p id="286c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是为时间戳2实现的反向传播的代码。</p><figure class="lk ll lm ln gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lv"><img src="../Images/1539366495ebd3992d76c06c82d84073.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zx4tSIomWGJiVvGul1DKGA.png"/></div></div></figure></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="343b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">关于YY1的反向传播，HH1(时间戳= 1) </strong></p><figure class="lk ll lm ln gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lr"><img src="../Images/09ed94872d902ef7771c5dc357208a71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uYx2-YpwcwljC2cBZDalJQ.jpeg"/></div></div></figure><p id="6063" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">请注意我把紫色星星放在哪里了，我忘记了那里的一些术语，它应该是(h2 — hh3) * (d_σ()) * (Wrecgh)而不仅仅是(h2 — hh3)。</strong></p><p id="4dba" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同样，对于红色下划线的变量是零，因为没有可以执行链式法则的变量。和前面的实现一样，我们对YY1和HH1求导。</p><p id="b3ad" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面是为时间戳1实现的反向传播代码。</p><figure class="lk ll lm ln gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lw"><img src="../Images/976559bc7e4bdbd734336a163608bc17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1VFywjW964IBbsjW3G1egQ.png"/></div></div></figure></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="69bd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">训练及结果</strong></p><figure class="lk ll lm ln gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lx"><img src="../Images/f48bc21b57b4e9b1524c5c2db5f4c08c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*efrSFRptXP27ZB_m5wilHg.png"/></div></div></figure><p id="3e59" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假的训练数据，左边看到的只是把每个时间戳中的数字相加。所以在x的第一行，我们可以看到它从0，0.5，0。所以尊重的基础真值是0，0.5和0.5。(y的第一行。)</p><p id="8be1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如右图所示，训练后，我们可以观察到输出值非常接近地面真实值。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="1ad2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">互动码</strong></p><figure class="lk ll lm ln gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ly"><img src="../Images/5680300a4cf2682452a31fa134dbb6e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DnM4CxGHgaxSYOFwU00E1w.png"/></div></div></figure><p id="c392" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">我转到Google Colab获取交互代码！所以你需要一个谷歌帐户来查看代码，你也不能在谷歌实验室运行只读脚本，所以在你的操场上做一个副本。最后，我永远不会请求允许访问你在Google Drive上的文件，仅供参考。编码快乐！</em></p><p id="706a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请点击此处<a class="ae kc" href="https://colab.research.google.com/drive/1Ew8AiSitT50M6JfyRycm_FaH73s94Bgu" rel="noopener ugc nofollow" target="_blank">访问互动代码。(谷歌Colab版)</a></p><p id="1ebf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请<a class="ae kc" href="https://repl.it/@Jae_DukDuk/Google-Brain-Intersection-RNN" rel="noopener ugc nofollow" target="_blank">点击此处访问交互代码</a>(复制版本)</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h2 id="cd25" class="lz ma iq bd mb mc md dn me mf mg dp mh ko mi mj mk ks ml mm mn kw mo mp mq mr bi translated">最后的话</h2><p id="660e" class="pw-post-body-paragraph kd ke iq kf b kg ms ki kj kk mt km kn ko mu kq kr ks mv ku kv kw mw ky kz la ij bi translated">谷歌大脑，总是有最有趣的网络架构选择。</p><p id="74f7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果发现任何错误，请发电子邮件到jae.duk.seo@gmail.com给我，如果你想看我所有写作的列表，请<a class="ae kc" href="https://jaedukseo.me/" rel="noopener ugc nofollow" target="_blank">在这里查看我的网站</a>。</p><p id="ccc9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">与此同时，请在我的twitter <a class="ae kc" href="https://twitter.com/JaeDukSeo" rel="noopener ugc nofollow" target="_blank">这里</a>关注我，并访问<a class="ae kc" href="https://jaedukseo.me/" rel="noopener ugc nofollow" target="_blank">我的网站</a>，或我的<a class="ae kc" href="https://www.youtube.com/c/JaeDukSeo" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>了解更多内容。如果你感兴趣，我也在这里做了解耦神经网络<a class="ae kc" href="https://becominghuman.ai/only-numpy-implementing-and-comparing-combination-of-google-brains-decoupled-neural-interfaces-6712e758c1af" rel="noopener ugc nofollow" target="_blank">的比较。</a></p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="291e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">参考</p><ol class=""><li id="0694" class="mx my iq kf b kg kh kk kl ko mz ks na kw nb la nc nd ne nf bi translated">Collins，j .，Sohl-Dickstein，j .，和Sussillo，D. (2016年)。递归神经网络的容量和可训练性。<em class="lb"> arXiv预印本arXiv:1611.09913 </em>。</li><li id="e995" class="mx my iq kf b kg ng kk nh ko ni ks nj kw nk la nc nd ne nf bi translated">Seo，J. D. (2018年1月24日)。Only Numpy:实现和比较Google Brain的更新门(容量和可训练性in…检索于2018年1月29日，来自<a class="ae kc" href="https://becominghuman.ai/only-numpy-implementing-and-comparing-google-brains-update-gate-capacity-and-trainability-in-940f0ad80649" rel="noopener ugc nofollow" target="_blank">https://becoming human . ai/only-Numpy-Implementing-and-comparison-Google-brains-Update-Gate-Capacity-and-training ability-in-940 f0ad 80649</a></li></ol></div></div>    
</body>
</html>