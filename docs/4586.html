<html>
<head>
<title>Build a simple Image Retrieval System with an Autoencoder</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用自动编码器构建一个简单的图像检索系统</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/build-a-simple-image-retrieval-system-with-an-autoencoder-673a262b7921?source=collection_archive---------6-----------------------#2018-08-24">https://towardsdatascience.com/build-a-simple-image-retrieval-system-with-an-autoencoder-673a262b7921?source=collection_archive---------6-----------------------#2018-08-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/308717d43e41110e4ea0dccc4728a593.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6XskIvW055oZWjRIBux1rg.png"/></div></div></figure><p id="134e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi kw translated">图像检索是近十年来非常活跃且发展迅速的研究领域。最著名的系统是谷歌图片搜索和 Pinterest 视觉大头针搜索。在本文中，我们将学习使用一种特殊类型的神经网络构建一个非常简单的图像检索系统，称为<strong class="ka ir">自动编码器</strong>。我们将以无人监管的方式进行，即不看图像标签。事实上，我们只能通过图像的视觉内容(纹理、形状等)来检索图像。这种类型的图像检索被称为<strong class="ka ir">基于内容的图像检索(CBIR) </strong>，与基于关键词或文本的图像检索相对。</p><p id="1bff" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于本文，我们将使用手写数字的图像、MNIST 数据集和 Keras 深度学习框架。</p><figure class="lg lh li lj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lf"><img src="../Images/397b4591b9e19aa840dad4383982a0c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1AEesv7IcxQWYtltIUzZzw.png"/></div></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk">The MNIST dataset</figcaption></figure></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h2 id="532c" class="lv lw iq bd lx ly lz dn ma mb mc dp md kj me mf mg kn mh mi mj kr mk ml mm mn bi translated">自动编码器</h2><p id="7eee" class="pw-post-body-paragraph jy jz iq ka b kb mo kd ke kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv ij bi translated">简而言之，自动编码器是旨在将其输入复制到其输出的神经网络。它们的工作原理是将输入压缩成一个<strong class="ka ir">潜在空间表示</strong>，然后从这个表示中重建输出。这种网络由两部分组成:</p><ol class=""><li id="ecfc" class="mt mu iq ka b kb kc kf kg kj mv kn mw kr mx kv my mz na nb bi translated"><strong class="ka ir">编码器:</strong>这是将输入压缩成潜在空间表示的网络部分。可以用编码函数<em class="nc"> h=f(x) </em>来表示。</li><li id="2ef1" class="mt mu iq ka b kb nd kf ne kj nf kn ng kr nh kv my mz na nb bi translated"><strong class="ka ir">解码器:</strong>该部分旨在从潜在空间表示中重建输入。可以用解码函数<em class="nc"> r=g(h) </em>来表示。</li></ol><figure class="lg lh li lj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/5b5250a49aca99a24d9d1db160a0da39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PVm-Y50e3HPOsD9my2sv4A.png"/></div></div></figure><blockquote class="nj nk nl"><p id="ae74" class="jy jz nc ka b kb kc kd ke kf kg kh ki nm kk kl km nn ko kp kq no ks kt ku kv ij bi translated">如果你想了解更多关于自动编码器的知识，我建议你阅读我之前的博客文章。</p></blockquote><p id="9c5e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这种潜在的表示或代码是我们感兴趣的，因为这是神经网络压缩每幅图像视觉内容的方式。这意味着所有相似的图像将以相似的方式编码(希望如此)。</p><p id="5e45" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">有几种类型的自动编码器，但由于我们正在处理图像，最有效的是使用<strong class="ka ir">卷积自动编码器</strong>，它使用卷积层来编码和解码图像。</p><figure class="lg lh li lj gt jr"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="e8ff" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，第一步是用我们的训练集来训练我们的自动编码器，让它学习将我们的图像编码成潜在空间表示的方法。</p><p id="876c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一旦完成训练，我们只需要网络的编码部分。</p><figure class="lg lh li lj gt jr"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="7d28" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个编码器现在可以用来编码我们的查询图像。</p><figure class="lg lh li lj gt jr gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/e863acf70c0447987b13d5b0001de93c.png" data-original-src="https://miro.medium.com/v2/resize:fit:626/format:webp/1*ZJXJ-C7gMfqR7Ae245P1Lg.png"/></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk">Our query image</figcaption></figure><p id="915b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">同样的编码必须在我们的搜索数据库中完成，我们希望在其中找到与查询图像相似的图像。然后，我们可以将查询代码与数据库代码进行比较，并尝试找到最接近的代码。为了进行这种比较，我们将使用最近邻技术。</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h2 id="b299" class="lv lw iq bd lx ly lz dn ma mb mc dp md kj me mf mg kn mh mi mj kr mk ml mm mn bi translated">最近邻居</h2><p id="fb2b" class="pw-post-body-paragraph jy jz iq ka b kb mo kd ke kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv ij bi translated">我们将通过执行最近邻算法来检索最近的代码。最近邻方法背后的原理是找到距离新点最近的预定义数量的样本。距离可以是任何度量单位，但最常见的选择是欧几里得距离。对于尺寸都为<em class="nc"> n、</em>的查询图像<em class="nc"> q </em>和样本<em class="nc"> s、</em>来说，该距离可以通过以下公式来计算。</p><figure class="lg lh li lj gt jr gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/548d408a3f8f4904fb294db243564a97.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*7p-2qBX9lJkzXTQxKy0Kgg.png"/></div></figure><p id="c6e5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这个例子中，我们将检索与查询图像最接近的 5 个图像。</p><figure class="lg lh li lj gt jr"><div class="bz fp l di"><div class="nq nr l"/></div></figure></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h2 id="ec66" class="lv lw iq bd lx ly lz dn ma mb mc dp md kj me mf mg kn mh mi mj kr mk ml mm mn bi translated">结果</h2><p id="1f9d" class="pw-post-body-paragraph jy jz iq ka b kb mo kd ke kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv ij bi translated">这些是我们取回的图像，看起来很棒！所有检索到的图像都与我们的查询图像非常相似，并且都对应于相同的数字。这表明，即使没有显示图像的相应标签，自动编码器也找到了以非常相似的方式编码相似图像的方法。</p><figure class="lg lh li lj gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nu"><img src="../Images/aaeb94188e978d4b9424a2ee953dbea8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x2Q_LF2Iorl4HLyed6MffQ.png"/></div></div><figcaption class="lk ll gj gh gi lm ln bd b be z dk">The 5 retrieved images</figcaption></figure></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h2 id="48a5" class="lv lw iq bd lx ly lz dn ma mb mc dp md kj me mf mg kn mh mi mj kr mk ml mm mn bi translated">摘要</h2><p id="def0" class="pw-post-body-paragraph jy jz iq ka b kb mo kd ke kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv ij bi translated">在本文中，我们学习了使用自动编码器和最近邻算法创建一个非常简单的图像检索系统。我们通过在一个大数据集上训练我们的 autoencoder 来进行，让它学习如何有效地编码每个图像的视觉内容。然后，我们将查询图像的代码与搜索数据集的代码进行比较，并检索最接近的 5 个代码。我们看到，我们的系统给出了相当好的结果，因为我们的 5 个检索图像的视觉内容接近我们的查询图像，而且它们都表示相同的数字，即使在这个过程中没有使用任何标签。</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h2 id="570f" class="lv lw iq bd lx ly lz dn ma mb mc dp md kj me mf mg kn mh mi mj kr mk ml mm mn bi translated">我希望这篇文章对新的深度学习实践者来说是清晰和有用的，并且它让你很好地了解了使用自动编码器进行图像检索是什么样子的！如果有不清楚的地方，请随时给我反馈或问我问题。</h2><div class="nv nw gp gr nx ny"><a href="https://github.com/nathanhubens/Unsupervised-Image-Retrieval" rel="noopener  ugc nofollow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd ir gy z fp od fr fs oe fu fw ip bi translated">nathan hubens/无监督图像检索</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">GitHub 是人们构建软件的地方。超过 2800 万人使用 GitHub 来发现、分享和贡献超过…</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">github.com</p></div></div><div class="oh l"><div class="oi l oj ok ol oh om jw ny"/></div></div></a></div></div></div>    
</body>
</html>