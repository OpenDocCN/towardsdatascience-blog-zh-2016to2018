<html>
<head>
<title>Part 1 of Riot API: Data Downpour</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Riot API的第1部分:数据暴雨</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-downpour-b1c4b41d7862?source=collection_archive---------4-----------------------#2017-04-17">https://towardsdatascience.com/data-downpour-b1c4b41d7862?source=collection_archive---------4-----------------------#2017-04-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="2a0f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我已经在大会上完成了一个月的DSI(数据科学沉浸式)课程，并在我的工具包中引入了一些模型(逻辑、线性、KNN和SVM)。但是我只是触及了表面，我仍然没有完全摆脱“黑匣子”的感觉。在这个行业中，有点怀疑是一种理想的特质，但是人们可能会迷失在每个模型的多个抽象层次中。但是现在让我们用一些数据来弄脏我们的手。</p><p id="fe6c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi kl translated">在本周的大会上，我们玩了一把web scrapping，这是在两周不间断的机器学习概念之后休息的好时机。我说的休息是指有更多的时间一次又一次地强化这些概念。</p><p id="aebc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是这周我花时间学习了我的第一个<a class="ae ku" href="https://developer.riotgames.com/" rel="noopener ugc nofollow" target="_blank"> API </a>。在阅读了文档并在论坛上发布后，我设法从原始的JSON请求中获得了一个可靠的数据框架。</p></div><div class="ab cl kv kw hu kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ij ik il im in"><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lc"><img src="../Images/23fe32044a689cbbdfac3e744542d671.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZWcBynyugbLpWcU3QWH7Tg.jpeg"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk"><a class="ae ku" href="https://science2knowledge.wordpress.com/data-science-scientists/" rel="noopener ugc nofollow" target="_blank">https://science2knowledge.wordpress.com/data-science-scientists/</a></figcaption></figure><p id="6724" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi kl translated"><span class="l km kn ko bm kp kq kr ks kt di"> W </span>英雄联盟是什么？什么是<a class="ae ku" href="https://www.youtube.com/watch?v=X5Eu7Sr0NAQ" rel="noopener ugc nofollow" target="_blank"> MOBA </a>？</p><p id="7fe6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">简而言之，你有两个5人的团队，每个团队都有不同角色的化身/角色。</p><p id="ccc9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">坦克:受到攻击并吸收伤害</p><p id="3510" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">实用程序</strong>:停止和中断事物。</p><p id="20a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">支援</strong>:通常是治疗师，但提供更多的效用。</p><p id="056f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">携带</strong>:造成全部伤害的角色。每个人都凑在一起，以确保这个人变得越来越强大。</p><p id="9354" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你从一个标准的3x3通道(顶部、中部和底部)开始</p><p id="c2ff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">谁先摧毁敌人的基地，谁就赢。每个专营权都有自己的风格，但总的来说，形式是相同的。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/9dfd53d97e59acfdde2a08902999396e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*afVVr9Fo5deUMRoD-XkhiA.jpeg"/></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk">Solo mid or feed!</figcaption></figure></div><div class="ab cl kv kw hu kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ij ik il im in"><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi lt"><img src="../Images/0280b1bc0f7921ac03b57c2ffb9b4471.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FjQI2lOlwhaKlnePrSy_tg.jpeg"/></div></div></figure><p id="ead3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">再次提醒</strong>我建议在你做任何事情之前阅读完整的文档和协议，但是这里有一些我在修补过程中发现的主要警告。</p><ol class=""><li id="83d4" class="lu lv iq jp b jq jr ju jv jy lw kc lx kg ly kk lz ma mb mc bi translated">鉴于你“<strong class="jp ir">制作了</strong>”并且“<strong class="jp ir">激活了</strong>”(通过Lol发射器)，你要做的第一件事就是找到你的API密匙并保证它的安全。如果发生了什么事情，你可以申请一个新的，但是不要在一个公开的Git项目或者一个表单帖子上透露你的密钥是常识。(显然这种情况经常发生)</li></ol><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi md"><img src="../Images/8268306322d5bf152c1b2d194f08f379.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*SLJlXU-Znia-QX0NiD_Fnw.jpeg"/></div></figure></div><div class="ab cl kv kw hu kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ij ik il im in"><p id="8051" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.记住你提出了多少个要求。明智地使用你的请求电话，因为有上限。</p><ul class=""><li id="3c10" class="lu lv iq jp b jq jr ju jv jy lw kc lx kg ly kk me ma mb mc bi translated">每秒100个电话</li><li id="c5bb" class="lu lv iq jp b jq mf ju mg jy mh kc mi kg mj kk me ma mb mc bi translated">每10秒钟1000个电话</li><li id="a179" class="lu lv iq jp b jq mf ju mg jy mh kc mi kg mj kk me ma mb mc bi translated">每10分钟(600秒)60，000次呼叫</li><li id="3d59" class="lu lv iq jp b jq mf ju mg jy mh kc mi kg mj kk me ma mb mc bi translated">每小时360，000次呼叫(3600秒)</li></ul><p id="d629" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">time.sleep(1)对于python用户来说是一个很好的解决方案。</p><p id="88ab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.缓存您的数据以减少请求调用。这是echos point 2，我在为页面的层和层内的表格数据进行清理时使用了这种技术。逐点工作，而不是从上到下，可以节省你很多时间。</p></div><div class="ab cl kv kw hu kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ij ik il im in"><p id="02c6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi kl translated">现在让我们深入研究这些数据。我目前使用的是Python 3.5.2，我的库相当标准。</p><ul class=""><li id="f859" class="lu lv iq jp b jq jr ju jv jy lw kc lx kg ly kk me ma mb mc bi translated">熊猫</li><li id="3a40" class="lu lv iq jp b jq mf ju mg jy mh kc mi kg mj kk me ma mb mc bi translated">Numpy</li><li id="f5c2" class="lu lv iq jp b jq mf ju mg jy mh kc mi kg mj kk me ma mb mc bi translated">pprint</li><li id="8cd8" class="lu lv iq jp b jq mf ju mg jy mh kc mi kg mj kk me ma mb mc bi translated">json</li><li id="dc9e" class="lu lv iq jp b jq mf ju mg jy mh kc mi kg mj kk me ma mb mc bi translated">ppring</li></ul><p id="11b1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我的第一个请求函数调用一个特定的播放器，并接受一个用户输入字符串。下面是我的基本代码的大概样子。我会关注玩家<a class="ae ku" href="http://lol.gamepedia.com/Doublelift" rel="noopener ugc nofollow" target="_blank"> Doublelift，</a>，只是因为他这个赛季打了很多比赛，大部分时间都在扮演“搬运”的角色。我就不描述了，只是把这个角色想象成主要的组织者(通常)就像足球中的四分之一后卫或者篮球中的大前锋。</p><pre class="ld le lf lg gt mk ml mm mn aw mo bi"><span id="9099" class="mp mq iq ml b gy mr ms l mt mu"><br/>#Global var</span><span id="e5c3" class="mp mq iq ml b gy mv ms l mt mu">summoner_id = "https://na.api.riotgames.com/api/lol/NA/v1.4/summoner/</span><span id="458b" class="mp mq iq ml b gy mv ms l mt mu">def request(name):<br/>    time.sleep(1)<br/>    print("Request Done")<br/>    URL = "{}by-name/{}?api_key={}".format(summoner_id,name,key)<br/>    response = requests.get(URL)<br/>    return response.json()</span><span id="4a5d" class="mp mq iq ml b gy mv ms l mt mu">#One of the top Lol players right now is called Doublelift<br/># Request yields his info</span><span id="034b" class="mp mq iq ml b gy mv ms l mt mu">{<br/>    "profileIconId": 1467,<br/>    "name": "Doublelift",<br/>    "summonerLevel": 30,<br/>    "accountId": 32971449,<br/>    "id": 20132258,<br/>    "revisionDate": 1492316460000<br/>}</span><span id="f434" class="mp mq iq ml b gy mv ms l mt mu">def main():<br/>    player_match_df_list = {}<br/>    name = input('Name: ')<br/>    raw = request(name)<br/>    player_id = (raw[name.lower()]['id'])<br/>    # Grabs 20132258 and puts it into match_list function <br/>    # which takes the match id and grabs a JSON list of that specific match.                         </span><span id="5939" class="mp mq iq ml b gy mv ms l mt mu">    m_list = match_list(player_id)<br/>    return m_list</span><span id="047e" class="mp mq iq ml b gy mv ms l mt mu">#This yields a list of last 10 games played (This varies between player and Season)</span></pre><p id="7d3c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，您可以使用“id”来访问更低级别的数据。</p><p id="c86a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">玩家Id </strong> → <strong class="jp ir">匹配者</strong> → <strong class="jp ir">匹配细节</strong></p><p id="44b0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此时，我将数据缓存到一个嵌套的字典中。现在我可以制造和打破，直到我的心满意足。在使用原始的JSON之后，我能够创建一个干净的数据框架来使用。</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi mw"><img src="../Images/a7a41b2e21ac6578a7e97762d7d32493.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xj4OQYehM4YMNI5Z4qPlTA.jpeg"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk">Raw JSON</figcaption></figure><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi mx"><img src="../Images/f3304e694986f014288405caf75bc752.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7tR1WSY4CbSnWtj4EC-ghQ.jpeg"/></div></div><figcaption class="lo lp gj gh gi lq lr bd b be z dk">Into a beautiful clean data frames</figcaption></figure><p id="c58a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们通过比较K/D/A(杀死/死亡/辅助)来看看我是如何处理官方比赛历史的</p><figure class="ld le lf lg gt lh gh gi paragraph-image"><div role="button" tabindex="0" class="li lj di lk bf ll"><div class="gh gi my"><img src="../Images/0200b15b27f5b1d359dfad783ce8b63b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ayxn_hnnuExH_w4-Bn3vRw.jpeg"/></div></div></figure><figure class="ld le lf lg gt lh gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/b518417cc878cfde99b97379d3bd48f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/format:webp/1*46KQhH8-qYq969kesSU1mQ.jpeg"/></div></figure><p id="b4ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不错，事情看起来很匹配。到目前为止，我的python脚本设法获取了多达10个匹配，并将每个数据帧存储到一个字典中。</p></div><div class="ab cl kv kw hu kx" role="separator"><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la lb"/><span class="ky bw bk kz la"/></div><div class="ij ik il im in"><p id="11d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi kl translated">现在，有了工作中的可用且可靠的数据集，我可以继续探索和建模数据了。这才是真正有趣的地方。因此，随着我们深入研究数据，预计下周会有一些seaborn graph。</p></div></div>    
</body>
</html>