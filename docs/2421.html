<html>
<head>
<title>Handwriting recognition using Tensorflow and Keras</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Tensorflow 和 Keras 的手写识别</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/handwriting-recognition-using-tensorflow-and-keras-819b36148fe5?source=collection_archive---------3-----------------------#2018-01-24">https://towardsdatascience.com/handwriting-recognition-using-tensorflow-and-keras-819b36148fe5?source=collection_archive---------3-----------------------#2018-01-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/26d723ca383637ae71033867d08fe873.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*mCjhzOF1Gsr7eURlIIozUg.gif"/></div></figure><p id="da58" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">由于个人书写风格的巨大差异，手写识别(也称为按书写者对每个手写文档进行分类)是一个具有挑战性的问题。解决这一问题的传统方法是提取语言相关特征，如不同字母的曲率、b/w 字母的间距等。然后用 SVM 这样的分类器来区分作家。在博客中，我想展示一种基于深度学习的方法来识别这些特征。我们将把小块手写图像传递给 CNN，并用 softmax 分类损失进行训练。</p><p id="cd9c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">为了证明这种技术的有效性，让我们用它来对英文手写文本进行分类。</p><p id="b380" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">你可以在我的<a class="ae ks" href="https://github.com/priya-dwivedi/Deep-Learning/blob/master/handwriting_recognition/English_Writer_Identification.ipynb" rel="noopener ugc nofollow" target="_blank"> Github repo </a>上找到完整的代码</p><p id="d3e6" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">获取我们的数据</strong></p><p id="cfc3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">IAM 手写数据库是最大的英文手写图像数据库。它有 1539 页由 600 多位作者撰写的扫描文本。出于本演示的目的，我们将选取拥有最多数据量的前 50 名作家。对于每个作家来说，数据库是他们写的单个句子的集合。请参见以下一个 writer 的示例:</p><figure class="ku kv kw kx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi kt"><img src="../Images/a790e7bc1564c840d97d4e83b6058c10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5cigjKhwPhs66tlN5fSsRQ.png"/></div></div></figure><figure class="ku kv kw kx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="ky kz di la bf lb"><div class="gh gi lc"><img src="../Images/8aa5dd7816ebe51add081a42f807b82c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1DgR4SFfDr7eGZwS0ppE9g.png"/></div></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Sample sentences</figcaption></figure><p id="9371" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">神经网络不需要对原始数据进行太多的预处理。因此，我们不会对这些图像进行任何修改，然而，我们不是将完整的图像传递给神经网络，而是传递小块的文本。</p><p id="ff25" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">生成补丁数据</strong></p><p id="a49c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们希望神经网络能够理解个人作家的写作风格，我们更希望这个神经网络是文本独立的(可以在任何语言上工作)。因此，我们不是传递单个的句子或单词，而是传递随机的文本块。这是通过从每个句子中随机裁剪 113×113 大小的补丁来完成的。下图是 8 个这样的补丁的拼贴画。</p><figure class="ku kv kw kx gt jr gh gi paragraph-image"><div class="gh gi lh"><img src="../Images/57a31fae08b4e145ca4d0c629853e066.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*5BoEd3eQwcO3zX5CPGao0w.jpeg"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">Collage of 8 patches</figcaption></figure><p id="ea42" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们可以编写一个生成器函数来移动每个句子，并从中生成随机的图像块。对于每个图像，我们将把补丁的数量限制为可以生成的总补丁的 30%。关于如何编写这个生成器函数的更多信息，请查看我的<a class="ae ks" href="https://github.com/priya-dwivedi/Deep-Learning/blob/master/handwriting_recognition/English_Writer_Identification.ipynb" rel="noopener ugc nofollow" target="_blank"> Github repo </a>。</p><p id="20a5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">模型和结果</strong></p><p id="fb71" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">为此，我们在 Keras 中使用 Tensorflow backend 构建了一个卷积神经网络(CNN)。我们将使用具有多个卷积和 maxpool 层、几个密集层和一个具有 softmax 激活的最终输出层的标准 CNN。在卷积层和致密层之间使用 RELU 激活，并使用 Adam 优化器优化模型。</p><p id="9000" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">模型的大小需要与数据的大小成比例。对于这个问题，三个卷积最大池层块和几个密集层就足够了。请参见下面的模型摘要:</p><figure class="ku kv kw kx gt jr gh gi paragraph-image"><div class="gh gi li"><img src="../Images/8d1b625d5dae3984a22a2d1c909faa29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/format:webp/1*g5Nof5Y_TLHOCm5kAssECQ.png"/></div><figcaption class="ld le gj gh gi lf lg bd b be z dk">CNN Model Summary</figcaption></figure><p id="5955" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">经过一点超参数调整后，我们在测试数据集上损失了<strong class="jw ir"> 94% </strong>,而该模型从未接触过该数据集。</p><p id="9590" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">见下面两个补丁，模型归类为同一作家。“t”的形状看起来非常相似，因此也可以直观地感觉到它们属于同一个作者。</p><figure class="ku kv kw kx gt jr gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/b7ff9d88473c17c75af70629856cf0cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:334/format:webp/1*c4U9dfqW9ZGfvSZyZbxMqA.png"/></div></figure><figure class="ku kv kw kx gt jr gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/88edbf8ec40dfbe82cf5c8b0e3612989.png" data-original-src="https://miro.medium.com/v2/resize:fit:388/format:webp/1*qq4ChRNr4qW9Dea0qNSzlw.png"/></div></figure><p id="a34b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">总结</strong></p><p id="9ddb" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">使用深度学习的手写识别是一种非常强大的技术，原因如下:</p><ul class=""><li id="9e03" class="ll lm iq jw b jx jy kb kc kf ln kj lo kn lp kr lq lr ls lt bi translated">它会自动识别深层的强大功能</li><li id="797d" class="ll lm iq jw b jx lu kb lv kf lw kj lx kn ly kr lq lr ls lt bi translated">我们提供随机补丁的方法使模型文本独立</li><li id="cf12" class="ll lm iq jw b jx lu kb lv kf lw kj lx kn ly kr lq lr ls lt bi translated">高预测精度使得在实际应用中使用它成为可能</li></ul><p id="cd02" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">参考</p><ol class=""><li id="1d70" class="ll lm iq jw b jx jy kb kc kf ln kj lo kn lp kr lz lr ls lt bi translated"><a class="ae ks" href="https://arxiv.org/pdf/1606.06472.pdf" rel="noopener ugc nofollow" target="_blank">深度作家为文字独立作家鉴定</a></li><li id="90ae" class="ll lm iq jw b jx lu kb lv kf lw kj lx kn ly kr lz lr ls lt bi translated"><a class="ae ks" href="http://www.fki.inf.unibe.ch/databases/iam-handwriting-database" rel="noopener ugc nofollow" target="_blank"> IAM 手写数据库</a></li></ol><p id="e7a5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">SpringML 是谷歌云平台的首要合作伙伴，专注于机器学习和大数据分析。我们已经在多家财富 500 强企业中实施了预测和分析解决方案。请联系了解更多:<a class="ae ks" href="mailto:info@springml.com" rel="noopener ugc nofollow" target="_blank">info@springml.com</a>，<a class="ae ks" href="http://www.springml.com/" rel="noopener ugc nofollow" target="_blank">www.springml.com</a></p></div></div>    
</body>
</html>