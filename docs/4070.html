<html>
<head>
<title>FIFA World Cup 2018 Predictions using ML techniques</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用最大似然技术预测 2018 年世界杯</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/fifa-world-cup-2018-predictions-using-ml-techniques-48354e22cd8?source=collection_archive---------4-----------------------#2018-07-15">https://towardsdatascience.com/fifa-world-cup-2018-predictions-using-ml-techniques-48354e22cd8?source=collection_archive---------4-----------------------#2018-07-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="08ca" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">嘿机器学习，谁会是下一届世界杯冠军？</h2></div><p id="2af2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我的预测？比利时将成为冠军。</p><p id="d0a0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但似乎我的很多朋友，包括我的线性回归模型和神经网络模型，都偏爱巴西。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/126bccd2b6ce6477255d1e4de11d0f7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/0*Bww_73yVSZGcCLbg.png"/></div></figure><p id="b2ed" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">暑假我正在自学机器学习模型，FIFA 世界杯现在就在我们脚下！所以我在想:为什么不做一个用 ML 模型预测世界杯结果的实践项目呢？</p><p id="569d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我为期三天的预测之旅开始了！</p><h1 id="0fb2" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated">第一天:玩数据集</h1><p id="66bf" class="pw-post-body-paragraph kf kg iq kh b ki mb jr kk kl mc ju kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">真正引发我开始这个项目的兴趣的数据集实际上是这个<a class="ae mg" href="https://www.kaggle.com/abecklas/fifa-world-cup" rel="noopener ugc nofollow" target="_blank"> Kaggle 的数据集</a>(嗯，如果你订阅了 Kaggle，它刚刚出现在我的电子邮件中)。该数据集包含自 1930 年以来 FIFA 世界杯的所有比赛、球员和冠军。我甚至受到启发，建立了一个模型，其中包含玩家在比赛中的属性，因为玩家对游戏的胜利做出了重大贡献，我们可以访问数据集中的这条信息。</p><p id="b543" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是最后，我个人觉得这个数据集太乱了，里面塞满了太多不必要的数据。然后我偶然发现了<a class="ae mg" href="https://www.kaggle.com/martj42/international-football-results-from-1872-to-2017/data" rel="noopener ugc nofollow" target="_blank">这个数据集</a>，里面有所有国际足球比赛的信息。在<a class="ae mg" href="https://blog.goodaudience.com/predicting-fifa-world-cup-2018-using-machine-learning-dc07ad8dd576" rel="noopener ugc nofollow" target="_blank">这篇中型文章</a>中提到了 ML 结果预测，尽管文章中的模型使用了逻辑回归。我个人更喜欢这个数据集，因为:</p><ul class=""><li id="d1de" class="mh mi iq kh b ki kj kl km ko mj ks mk kw ml la mm mn mo mp bi translated">它只有 1 张 csv 表(哈哈！)</li><li id="53bc" class="mh mi iq kh b ki mq kl mr ko ms ks mt kw mu la mm mn mo mp bi translated">当我们做预测时，我们不仅应该关注世界杯比赛，还应该关注其他国际比赛</li><li id="8ca7" class="mh mi iq kh b ki mq kl mr ko ms ks mt kw mu la mm mn mo mp bi translated">通过使用所有国际比赛的数据，我们应该有一个更大的训练数据量，这应该可以提高我们的预测性能</li></ul><p id="0929" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">基本上，数据集包含一场比赛的<em class="mv">年份</em>和<em class="mv">日期</em>、两队的<em class="mv">名称</em>、<em class="mv">两队的得分</em>、<em class="mv">比赛类型</em>、<em class="mv">城市</em>、<em class="mv">国家</em>和<em class="mv">中立</em>(无论比赛是否在任何一队自己的地点举行)。所以我会说这个数据集相对来说更干净，简洁，而且直截了当。</p><h1 id="b2f0" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated">设置属性和数据预处理</h1><p id="924f" class="pw-post-body-paragraph kf kg iq kh b ki mb jr kk kl mc ju kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">我从这一部分学到的一个重要教训是<em class="mv">数据总是又脏又乱</em>。我打了一个比方，将数据科学比作<em class="mv">烹饪</em>——首先，数据就像你的肉和蔬菜。<strong class="kh ir">挑选那些新鲜、干净、最适合你的。</strong></p><p id="950d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就像一个厨师并不真的需要使用很酷的技术来烟熏或液氮来烧烤他的食物，因为他的主要目标是用简单的方法为他的食客提供美味的食物。对于一个数据科学家来说，这是类似的——我们并不真的需要建立一个非常花哨、复杂的 ML 模型(除非复杂的任务需要)，但主要目的是能够从你挑选的数据中辨别事物。</p><p id="779c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">关键是<strong class="kh ir"> <em class="mv">你如何分辨事物</em> </strong> —在这种情况下，你选择的是哪个<strong class="kh ir"> <em class="mv">属性</em> </strong>。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi lb"><img src="../Images/7cf03f2a8820caccb14ee313d19a272c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/0*INMAuNnaPr5yYZV5.png"/></div></figure><p id="e3ec" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些是我总结出来的属性，非常简单易懂:</p><p id="4ee1" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在预测的时候，我们应该考虑球队在比赛举办年份的排名。如果没有数据，我的处理方式是放一个大数(我用的是 200，因为球队不到 200)作为排名。</p><ul class=""><li id="14e4" class="mh mi iq kh b ki kj kl km ko mj ks mk kw ml la mm mn mo mp bi translated"><strong class="kh ir">中奖数和抽奖数</strong></li></ul><p id="8b18" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在她所有的国际比赛中,<em class="mv">意味着一个队的胜利和平局。不需要丢失计数，因为它只是两者的补充。</em></p><ul class=""><li id="40b4" class="mh mi iq kh b ki kj kl km ko mj ks mk kw ml la mm mn mo mp bi translated"><strong class="kh ir">一队净胜球</strong></li></ul><p id="3597" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在她所有的国际比赛中,<em class="mv">净胜球意味着一个团队的</em>。如果 A 队和 B 队打了一场 5 比 0 的比赛，那么 A 队的净胜球是 5，B 队是-5。这不仅仅是衡量输赢，而是衡量团队能在多大程度上赢得比赛。</p><ul class=""><li id="842d" class="mh mi iq kh b ki kj kl km ko mj ks mk kw ml la mm mn mo mp bi translated"><strong class="kh ir">对对手的赢数和平局数</strong></li></ul><p id="463b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">基本上是比赛中两队的比赛历史。注意，我们应该注意比赛的日期，只考虑过去的比赛历史数据<em class="mv">。</em></p><p id="0470" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">看一支球队是否在自己的国家比赛。</p><p id="e99a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这也是我在<a class="ae mg" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> pandas </a>上练习的机会，这是一个非常方便的数据操作库。所以我写的第一个脚本是<a class="ae mg" href="https://github.com/gudgud96/FIFA-2018-Match-Predictor/blob/master/fifa-results-preprocess.py" rel="noopener ugc nofollow" target="_blank">FIFA-results-preprocess . py</a>，主要是从<em class="mv"> results.csv </em>中的原始数据生成我想要的属性。</p><p id="6c1d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有一点要分享的是——这个脚本运行了大约<em class="mv"> 18 分钟</em>！原因是对于每一行比赛数据，我们必须计算两个队的比赛历史。对于该计算，我们需要遍历特定行之前的<em class="mv">所有行，因为我们的数据是按时间顺序排列的。这显然需要 O(n)。</em></p><p id="c5b7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">预处理生成了<em class="mv"> results_processed.csv </em>，我手动删除了一些列以得到<em class="mv">results _ processed _ dev . CSV</em>。</p><h1 id="7229" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated">第二天:机器学习日</h1><p id="a7c3" class="pw-post-body-paragraph kf kg iq kh b ki mb jr kk kl mc ju kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">将大蒜和洋葱切碎，牛肉切片，你就可以开始做菜了。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/471993fa5e6e879d1dd0474c8a76d840.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/0*4KMIV5DvWyjih89n.jpg"/></div></figure><p id="e00a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以基本上这个预测任务可以被框定为一个<em class="mv">分类任务</em>。给定这些属性，我们将对主队是输(0 类)、赢(1 类)还是平(2 类)进行分类。</p><p id="d5c8" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我首先尝试使用我的脚本<a class="ae mg" href="https://github.com/gudgud96/FIFA-2018-Match-Predictor/blob/master/fifa-ml.py" rel="noopener ugc nofollow" target="_blank"> fifa-ml.py </a>将我的数据输入几种类型的分类器。令人震惊的是，所有分类器返回的训练和测试准确率都在大约<strong class="kh ir"> 55% </strong>左右，并且没有一个分类器优于另一个。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="gh gi mx"><img src="../Images/da720a1eba68fbc3ec3619d56e64f05b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1WbOYV1NppK7bE87.png"/></div></div></figure><p id="4447" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以，我宁愿在最后使用线性回归，因为它没有太大的区别。线性回归器可以被认为是一个一层神经网络，接受<em class="mv"> n </em>个特征并最终返回每个逻辑的概率。在这种情况下，它返回比赛中主队的赢、输和平局概率。你也可以使用逻辑回归，只是在我看来，在这个特定的任务中，两者做同样的事情。</p><p id="3c63" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">请注意，对于线性回归，所有 Y 示例都需要进行一次热编码。在 sklearn 中，我是通过使用一个<a class="ae mg" href="http://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelBinarizer.html" rel="noopener ugc nofollow" target="_blank"> LabelBinarizer </a>来完成的；在 Keras 中，我通过<a class="ae mg" href="https://keras.io/utils/#to_categorical" rel="noopener ugc nofollow" target="_blank">to _ categorial()</a>来实现。</p><p id="b3d3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我做到了！我在这里附上了对淘汰赛的预测:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="gh gi nc"><img src="../Images/4c714fd67fe22d163be5b8f71bebd7a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-7l3mYSCMuUExhbq.PNG"/></div></div></figure><p id="45ac" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以前 4 名球队是:巴西，西班牙，阿根廷，德国。</p><p id="65e3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">完整结果(包括小组赛结果和概率)，查看这里:<a class="ae mg" href="https://github.com/gudgud96/FIFA-2018-Match-Predictor/blob/master/results_predict_output_final.csv" rel="noopener ugc nofollow" target="_blank">results _ predict _ output _ final . CSV</a>。</p><h1 id="7b7f" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated">第三天:神经网络日</h1><p id="a294" class="pw-post-body-paragraph kf kg iq kh b ki mb jr kk kl mc ju kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">然后我就在想:既然经典的分类器都做不好，那么神经网络的表现会更好吗？于是我用 Keras 想出了一个神经网络脚本:<a class="ae mg" href="https://github.com/gudgud96/FIFA-2018-Match-Predictor/blob/master/fifa-ml-nn.py" rel="noopener ugc nofollow" target="_blank"> fifa-ml-nn.py </a>。</p><p id="69e5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">答案是否定的。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/22884edb0c905eb2bd33d60be589f553.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*EzX5hnIiIiZqqBzt.png"/></div></figure><p id="eac3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">即使对于具有许多隐藏单元的大型网络，其准确度似乎也只是缓慢地收敛到 55%左右(有时略高，NN 是我唯一达到 59%测试准确度的模型，这是目前最高的)。但我有 300、500 甚至 1024 个单元的密集层，但性能仅提升了不到 5%。不值得。</p><p id="4922" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">尽管如此，NN 的预测和 LR 的预测之间还是有细微的差别。让我在这里附上 NN 对淘汰赛阶段的预测:</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="gh gi ne"><img src="../Images/97ca93169eb041fc1bc216b07d98f5f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6I20xK5prwIXCDsu.PNG"/></div></div></figure><p id="90dd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以这次的前 4 名球队是:巴西、西班牙、德国、葡萄牙。</p><p id="f1cf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">完整结果(包括小组赛结果和概率)，查看这里:<a class="ae mg" href="https://github.com/gudgud96/FIFA-2018-Match-Predictor/blob/master/results_predict_output_nn_final.csv" rel="noopener ugc nofollow" target="_blank">results _ predict _ output _ nn _ final . CSV</a>。</p><h1 id="ac24" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated">结论和调查结果</h1><p id="d181" class="pw-post-body-paragraph kf kg iq kh b ki mb jr kk kl mc ju kn ko md kq kr ks me ku kv kw mf ky kz la ij bi translated">我想说，这是一个非常好的数据科学入门迷你项目，它经历了数据争论、提出分类属性和实现分类模型的整个过程。</p><p id="eb28" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我的结论是<strong class="kh ir"> <em class="mv">足球比赛保持不可预测</em> </strong>，当我读到这篇 LinkedIn 帖子时，我完全同意<a class="ae mg" href="https://www.linkedin.com/feed/update/urn:li:activity:6417784109510254592/" rel="noopener ugc nofollow" target="_blank">的观点。帖子甚至附上了</a><a class="ae mg" href="https://arxiv.org/pdf/1806.03208.pdf" rel="noopener ugc nofollow" target="_blank">这篇论文</a>使用随机森林并融入大量属性进行预测，但仍然无法做出准确的预测。</p><p id="6fab" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用 ML 并不能预测所有的事情。它有其局限性。</p><p id="14ca" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于我的模型，我只能说，像巴西、西班牙和德国这样的球队<em class="mv">更倾向于我设置的属性</em>，这主要是考虑到一支球队的获胜统计数据。但我们都知道，赢得历史并不能说明什么——毕竟，当我写这篇博客的时候，德国已经被强大的韩国以 2 比 0 淘汰了。</p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/bbb9c2ce46c80174d0472b6b97402ffd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1-27_bf3ndBuxJIC.jpg"/></div></figure><p id="54e7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">总而言之，预测在这里并不是最重要的。最重要的是学习处理数据的技巧，从中讲述故事，最后但同样重要的是… <strong class="kh ir">全力支持比利时！</strong></p><figure class="lc ld le lf gt lg gh gi paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="gh gi ng"><img src="../Images/4548e8fd6e18707fbb3174a50a91790c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sD_f0ecoo7B0Wwl0.jpg"/></div></div></figure></div><div class="ab cl nh ni hu nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="ij ik il im in"><p id="b381" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mv">原载于</em><a class="ae mg" href="https://gudgud96.github.io/projects/fifa-18.html" rel="noopener ugc nofollow" target="_blank"><em class="mv">gud gud 96 . github . io</em></a><em class="mv">。</em></p></div></div>    
</body>
</html>