<html>
<head>
<title>Going Dutch, Part 2: Improving a Machine Learning Model Using Geographical Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">各付各的，第 2 部分:使用地理数据改进机器学习模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/going-dutch-part-2-improving-a-machine-learning-model-using-geographical-data-a8492b67b885?source=collection_archive---------5-----------------------#2018-06-17">https://towardsdatascience.com/going-dutch-part-2-improving-a-machine-learning-model-using-geographical-data-a8492b67b885?source=collection_archive---------5-----------------------#2018-06-17</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/0eee8d8d61f36d1040ed949459aba2bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*poYdKqzHObmAug8rLUuLWQ.jpeg"/></div></div></figure><h1 id="ee82" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">一切开始的地方</h1><p id="e742" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated"><a class="ae lx" rel="noopener" target="_blank" href="/going-dutch-how-i-used-data-science-and-machine-learning-to-find-an-apartment-in-amsterdam-part-def30d6799e4">在我之前的帖子</a>中，我描述了使用<strong class="lb iu">数据科学</strong>和<strong class="lb iu">机器学习</strong>在<strong class="lb iu">阿姆斯特丹</strong>寻找<strong class="lb iu">公寓</strong>的过程。使用从互联网上获得的公寓租金数据，我能够探索和可视化这些数据。作为可视化部分的一部分，我可以创建下面的地图:</p><figure class="ly lz ma mb gt ju"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="3e18" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">最终，我能够使用这些数据来<strong class="lb iu">构建</strong>、<strong class="lb iu">训练</strong>和<strong class="lb iu">测试</strong>一个使用<strong class="lb iu">随机森林</strong>的<strong class="lb iu">预测模型</strong>。有可能达到<strong class="lb iu"> R2 </strong>得分<strong class="lb iu"> 0.70，</strong>这对于基线模型来说是一个很好的衡量标准。测试集的预测值与实际值的对比结果如下图所示:</p><figure class="ly lz ma mb gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi mj"><img src="../Images/fd8213a666c12d7148ef47387bfc7b90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m6f7RXtr8p4IS0h_yiP0YQ.png"/></div></div></figure><p id="8ec3" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">从这些数据中创建一个<strong class="lb iu">预测模型</strong>的想法是为了有一个好的参数，以便知道租赁列表是否有一个<strong class="lb iu">公平价格</strong>。这将允许我们找到一些便宜的或者扭曲的东西。这背后的<strong class="lb iu">推理</strong>是，如果我遇到任何一套公寓的<strong class="lb iu">租赁价格</strong>比我们的模型预测的<strong class="lb iu">低得多<strong class="lb iu">，这可能意味着一笔好交易。最终，这被证明是在阿姆斯特丹找房子的一种有效方式，因为我能够专注于特定的区域，发现一些好的交易，并在我来到这座城市的第一天找到一套公寓。</strong></strong></p><figure class="ly lz ma mb gt ju gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/4080b5ca8ff8de2a385b0c905b3d70ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:490/1*ArRe2lRSGRHDRr4OT3PBVQ.gif"/></div><figcaption class="ml mm gj gh gi mn mo bd b be z dk">After finding an apartment in AMS</figcaption></figure><p id="6560" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">现在回到我们的模型。作为一个基线模型，在预测质量方面有潜在的改进空间。下面的管道已经成为我最喜欢的处理数据问题的方法:</p><ol class=""><li id="4c25" class="mp mq it lb b lc me lg mf lk mr lo ms ls mt lw mu mv mw mx bi translated">从<strong class="lb iu">基线模型</strong>开始</li><li id="f02e" class="mp mq it lb b lc my lg mz lk na lo nb ls nc lw mu mv mw mx bi translated">检查<strong class="lb iu">结果</strong></li><li id="c20c" class="mp mq it lb b lc my lg mz lk na lo nb ls nc lw mu mv mw mx bi translated"><strong class="lb iu">改进</strong>模型</li><li id="83dc" class="mp mq it lb b lc my lg mz lk na lo nb ls nc lw mu mv mw mx bi translated"><strong class="lb iu">重复</strong>直到结果令人满意</li></ol><p id="263f" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">所以我们现在到了第三步。我们需要改进我们的模型。在上一篇文章中，我列出了我如此喜欢<strong class="lb iu">随机森林</strong>的原因，其中之一是你不需要花很多时间调优<strong class="lb iu">超参数</strong>(例如<strong class="lb iu">神经网络</strong>就是这种情况)。虽然这是一件好事，但另一方面，为了改进我们的模型，它给我们施加了一些限制。我们几乎只剩下工作和改进我们的数据，而不是试图通过调整参数来改进我们的预测模型。</p><p id="9e47" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">这就是<strong class="lb iu">数据科学</strong>的妙处之一。有时候这感觉像是一项调查工作:你需要寻找线索并把这些点联系起来。就好像真相就在那里。</p><figure class="ly lz ma mb gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ne"><img src="../Images/11c9859af65fedf6427c46b421e3e7b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SWBZvc1QHAIXxCcm9VwWgA.png"/></div></div><figcaption class="ml mm gj gh gi mn mo bd b be z dk">Look! An empty apartment in Amsterdam!</figcaption></figure><p id="fc67" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">所以现在我们知道，我们需要处理我们的数据，并使它变得更好。但是怎么做呢？</p><p id="ed82" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">在我们的原始数据集中，我们能够应用一些特征工程来创建一些与公寓位置相关的变量。我们为一些分类特征创建了虚拟变量，例如<strong class="lb iu">地址</strong>和<strong class="lb iu">地区</strong>。这样，我们最终为每个地址和地区类别创建了一个变量，它们的值可以是 0 或 1。但是我们在分析中忽略了一个方面。</p><h1 id="e749" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">北方的威尼斯</h1><figure class="ly lz ma mb gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nf"><img src="../Images/21f13b042ff7e3cf529a3ad525586542.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FefzSKGHURX-BjaHzSli1A.jpeg"/></div></div></figure><p id="17b9" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">阿姆斯特丹有一百多公里长的<a class="ae lx" href="https://en.wikipedia.org/wiki/Gracht" rel="noopener ugc nofollow" target="_blank"><em class="nd">grachten</em></a>(<a class="ae lx" href="https://en.wikipedia.org/wiki/Canal" rel="noopener ugc nofollow" target="_blank">canals</a>)，大约 90 个岛屿和 1500 座桥梁。沿着主要运河有 1550 座纪念性建筑。17 世纪的运河圈地区，包括 Prinsengracht、Keizersgracht、Herengracht 和 Jordaan，在 2010 年被联合国教科文组织列为世界遗产<a class="ae lx" href="https://en.wikipedia.org/wiki/World_Heritage_site" rel="noopener ugc nofollow" target="_blank">T21，为阿姆斯特丹赢得了“北方威尼斯</a><a class="ae lx" href="https://en.wikipedia.org/wiki/Venice_of_the_North" rel="noopener ugc nofollow" target="_blank"/>”的美誉。</p><figure class="ly lz ma mb gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ng"><img src="../Images/a418d9ad3cdc2df47a8f8ac9da80ca9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9NmEYY8wZCzooLLqmWPQXA.jpeg"/></div></div></figure><p id="a8f6" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">阿姆斯特丹的<strong class="lb iu">地址</strong>通常包含一些信息，可以让人们知道一个地方是否坐落在运河前面——所谓的“<em class="nd">运河房屋</em>”。位于<strong class="lb iu"> Leidsegracht </strong>的公寓最有可能看到运河的景色，而位于<strong class="lb iu"> Leidsestraat、</strong>的公寓就不一样了。<strong class="lb iu"> </strong>也有建筑物位于广场内的情况，例如<strong class="lb iu">广场上的一些建筑物</strong>。</p><p id="f6d1" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">不用说，运河房子有额外的吸引力，因为它们提供了美丽的景色。在脸书群体中，可以看到运河房屋在挂牌后几个小时内就被出租。</p><figure class="ly lz ma mb gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nh"><img src="../Images/7be91b054ec4967e25543817e9ea3992.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j2TlqBnTpDTWj23jwQn4pA.jpeg"/></div></div><figcaption class="ml mm gj gh gi mn mo bd b be z dk">Who wants to live in a Canal House?</figcaption></figure><p id="b920" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">我们将从公寓地址中提取这些信息，以创建另外三个变量:<em class="nd"> gracht </em>、<em class="nd"> straat </em>和<em class="nd"> plein </em>，可能的值为 0 和 1。<em class="nd"> </em>为这些变量创建单独的变量，而不是仅创建一个具有不同可能值(如 1、2、3)的变量的原因是，在这种情况下，我们会将其视为一个连续变量，诱使我们的模型考虑这一重要性尺度。我们将有希望发现运河房屋是否真的如此受欢迎。</p><h1 id="3bee" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">位置，位置，位置</h1><p id="620f" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">通过观察我们的模型的<strong class="lb iu">特征重要性</strong>排名中的前 15 个最重要的特征，我们能够注意到，除了<strong class="lb iu">纬度</strong>和<strong class="lb iu">经度</strong>之外，许多与<strong class="lb iu">地址</strong>和<strong class="lb iu">地区</strong>相关的虚拟变量对于我们的模型是有价值的，以便正确地进行预测。所以我们可以说，位置数据肯定大有可为。</p><p id="73f1" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">我们将详细阐述这一点。但问题是，怎么做？</p><figure class="ly lz ma mb gt ju gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/61893bd3a01d4fa43e4dad738d25a162.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*6nK8SpUSQXcQzOrVpk1EAg.jpeg"/></div><figcaption class="ml mm gj gh gi mn mo bd b be z dk">Restaurants, bars and cafes near Leidseplein, Amsterdam.</figcaption></figure><h1 id="322e" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">走向社交</h1><p id="455b" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">阿姆斯特丹除了拥有大约 80 万居民(对于西欧国家的首都来说，这个数字很小)之外，还遍布酒吧、咖啡馆和餐馆，拥有欧洲最好的公共交通系统之一。但是，重要的是要想清楚我们的目标主体:<strong class="lb iu">人</strong>。我们在这里的主要目的是<em class="nd">了解人们在寻找公寓时的行为</em>。我们需要将我们的目标分成不同的群体，这样我们就可以了解他们在住房和位置方面的需求。有人可能会说，靠近酒吧、咖啡馆和餐馆对某些人来说是有吸引力的。其他人可能愿意住在离公园和学校更近的地方，比如有小孩的夫妇。这两类人也可能对住在公共交通附近感兴趣，比如电车和公共汽车站。</p><figure class="ly lz ma mb gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/6aeb6f0c749902680d9377d263357f79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ie0A5arVRc5MqlEXyH_zgQ.jpeg"/></div></div><figcaption class="ml mm gj gh gi mn mo bd b be z dk">Amsterdam Centraal Station</figcaption></figure><p id="e3cf" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">这给了我们一些建立假设的提示。靠近这些类型的地方会影响公寓租金价格吗？</p><p id="3f0a" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">为了测试这个假设，我们需要将这些数据输入到我们的模型中。</p><p id="a850" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">Yelp 是一个社交平台，它宣传自己的宗旨是“<em class="nd">将人们与当地伟大的企业联系起来”</em>。它列出了诸如酒吧、餐馆、学校和许多其他类型的兴趣点——世界各地的<em class="nd">兴趣点</em>，允许用户对这些地方写评论。2018 年，在 Q1，Yelp 每月平均有 3000 万独立访客通过 Yelp 应用程序访问 Yelp，7000 万独立访客通过移动网络访问 Yelp。通过 Yelp 的<a class="ae lx" href="https://www.yelp.com/developers/documentation/v3" rel="noopener ugc nofollow" target="_blank">融合 API </a>可以很容易地提取 POI 信息，将纬度和经度作为参数。</p><p id="715e" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">Yelp 在其数据库中列出了一些地点类别(不幸的是，没有关于<em class="nd">咖啡店</em>的类别)。我们对以下内容感兴趣:</p><p id="b22c" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated"><strong class="lb iu">活跃的生活</strong>:公园、健身房、网球场、篮球场</p><p id="62e5" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated"><strong class="lb iu">酒吧</strong>:酒吧和酒馆</p><p id="cc46" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated"><strong class="lb iu">咖啡馆</strong>:不言自明</p><p id="1f8b" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated"><strong class="lb iu">教育</strong>:幼儿园、高中和大学</p><p id="c639" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated"><strong class="lb iu">酒店/旅游</strong>:酒店、汽车租赁店、旅游信息点</p><p id="544c" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated"><strong class="lb iu">交通</strong>:电车/公共汽车站和地铁站</p><p id="300a" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">对于这些类别中的每一个，Yelp 都列出了包含其纬度和经度的 POI。</p><p id="4cd6" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">我们的方法是:</p><ol class=""><li id="1fe9" class="mp mq it lb b lc me lg mf lk mr lo ms ls mt lw mu mv mw mx bi translated"><strong class="lb iu">查询</strong>Yelp Fusion API<strong class="lb iu">以获取阿姆斯特丹上述类别的兴趣点数据</strong></li><li id="d022" class="mp mq it lb b lc my lg mz lk na lo nb ls nc lw mu mv mw mx bi translated"><strong class="lb iu">计算</strong>每个<strong class="lb iu">公寓</strong>和每个<strong class="lb iu"> POI </strong>之间的米距离。</li><li id="7a52" class="mp mq it lb b lc my lg mz lk na lo nb ls nc lw mu mv mw mx bi translated"><strong class="lb iu">计算</strong>每个类别中有多少<strong class="lb iu">个 poi</strong>位于每个<strong class="lb iu">公寓</strong>的<strong class="lb iu"> 250 米半径</strong>内。这些数字将成为我们数据集中的变量。</li></ol><figure class="ly lz ma mb gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nj"><img src="../Images/e7edc753b3acf0ab0eca1d5c2739728b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*66H_XkIUrWB_-jH04rDvcw.png"/></div></div></figure><p id="9945" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">通过使用 Yelp 的 Fusion API，我们已经能够获取目标范围内每个类别的 50 个兴趣点的地理数据。</p><p id="90b4" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">在我们开始计算每个 POI 和每个公寓之间的距离之前，请记住:<strong class="lb iu">纬度</strong>和<strong class="lb iu">经度</strong>是<strong class="lb iu">角度</strong>的度量。</p><p id="61b3" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated"><strong class="lb iu">纬度</strong>是指<a class="ae lx" href="https://en.wikipedia.org/wiki/Equator" rel="noopener ugc nofollow" target="_blank">赤道</a>以北或以南的度数。<strong class="lb iu">经度</strong>被测量为本初子午线<a class="ae lx" href="https://en.wikipedia.org/wiki/Prime_meridian_(Greenwich)" rel="noopener ugc nofollow" target="_blank">线</a>以东或以西的度数。这两个角度的组合可用于精确定位地球表面的确切位置。</p><figure class="ly lz ma mb gt ju gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/4f5ca5bf109bc9166b7a2d82154c6e70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*Z-mWIMVFrrnkWZYDcmRkwg.png"/></div></figure><p id="b111" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">如上图所示，地球表面两点之间最快的路径是"<a class="ae lx" href="https://en.wikipedia.org/wiki/Great_circle" rel="noopener ugc nofollow" target="_blank">大圆路径</a>"，换句话说，这条路径包含了你可以在地球上画出的与两点相交的最长圆的一部分。并且，由于这是使用以角度表示的坐标的球体上的圆形路径，距离的所有属性将由三角公式给出。</p><figure class="ly lz ma mb gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nl"><img src="../Images/3342168c9d5c528340c23c265ce7a65e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nnK3W0OPUv1YPzttQzOc8w.png"/></div></div><figcaption class="ml mm gj gh gi mn mo bd b be z dk">Haversine Formula.</figcaption></figure><p id="cdeb" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">地球上两点之间的最短距离可以用<a class="ae lx" href="https://en.wikipedia.org/wiki/Haversine_formula" rel="noopener ugc nofollow" target="_blank">哈弗辛公式</a>计算出来。在 Python 中，它看起来像这样:</p><pre class="ly lz ma mb gt nm nn no np aw nq bi"><span id="5ca2" class="nr kc it nn b gy ns nt l nu nv">from math import sin, cos, sqrt, atan2, radians<br/><br/># approximate radius of earth in km<br/>R = 6373.0<br/><br/>lat1 = radians(52.2296756)<br/>lon1 = radians(21.0122287)<br/>lat2 = radians(52.406374)<br/>lon2 = radians(16.9251681)<br/><br/>dlon = lon2 - lon1<br/>dlat = lat2 - lat1<br/><br/>a = sin(dlat / 2)**2 + cos(lat1) * cos(lat2) * sin(dlon / 2)**2<br/>c = 2 * atan2(sqrt(a), sqrt(1 - a))<br/><br/>distance = R * c</span></pre><p id="7ce3" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">现在我们知道了如何计算两点之间的距离，对于每个公寓，我们将计算每个类别中有多少个 POI 位于 250 米半径范围内。</p><p id="e896" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">将这些数据连接到我们之前的数据集中后，让我们看一下它的样子——注意右侧的最后几列:</p><figure class="ly lz ma mb gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nw"><img src="../Images/e53b5c0020905929e1ca0fc3184a860e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SDxlzbFggW-PjTLZerkLcA.png"/></div></div></figure><h1 id="47f8" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">把所有的放在一起</h1><p id="3db5" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">让我们看看添加这些变量后的数据集。</p><p id="d166" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">我们将从获得描述性统计的一些度量开始:</p><figure class="ly lz ma mb gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nx"><img src="../Images/f2fbd1903ab188b25e238e615ca48e70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b-BXx95wyg46S5Pq9t3ZqA.png"/></div></div></figure><ul class=""><li id="21ba" class="mp mq it lb b lc me lg mf lk mr lo ms ls mt lw ny mv mw mx bi translated">公寓在 250 米半径范围内平均有 0.7828 个酒吧。对于那些喜欢去喝一杯啤酒而不需要走太多路的人来说，这是个好消息。</li><li id="54ed" class="mp mq it lb b lc my lg mz lk na lo nb ls nc lw ny mv mw mx bi translated"><strong class="lb iu">咖啡馆</strong>似乎也遍布整个城市，平均每个公寓步行距离内有 0.6703 个 POI。</li><li id="fca5" class="mp mq it lb b lc my lg mz lk na lo nb ls nc lw ny mv mw mx bi translated">公寓 250 米内<strong class="lb iu">交通</strong> POI 平均数量接近于零。</li></ul><p id="2003" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">我们现在将为这些变量生成一些<strong class="lb iu">箱线图</strong>，看看它们如何影响<strong class="lb iu"> normalized_price </strong>。</p><figure class="ly lz ma mb gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi nz"><img src="../Images/26e506782e98ed19176b868af1aa04b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R58HVfI0LMLZcGMdJRTzIA.png"/></div></div></figure><p id="cfb3" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">看起来这三个变量确实对<strong class="lb iu"> normalized_price </strong>有重大影响。</p><p id="a8a1" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">那么<strong class="lb iu"> gracht </strong>、<strong class="lb iu"> straat </strong>和<strong class="lb iu"> plein </strong>呢？</p><figure class="ly lz ma mb gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oa"><img src="../Images/b417f1a2dedd11213e63f9ba166af510.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YS0ChbOXtMwhhfY3uo0bdQ.png"/></div></div></figure><p id="d106" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">不出所料，运河别墅和广场公寓的价格都略高。对于位于普通街道的公寓，价格略低。</p><p id="5ee2" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">现在，我们将总结所有内容，并通过模型中引入的新变量和我们的目标变量<strong class="lb iu"> normalized_price </strong>之间的<strong class="lb iu"> Pearson Correlation </strong>矩阵生成热图。</p><figure class="ly lz ma mb gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi ob"><img src="../Images/5ff00b5a4b4fe84040e282a024a681d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v38zsuW3i_Vh4j2o44hgBg.png"/></div></div></figure><p id="51e6" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">不幸的是，我们的<strong class="lb iu">热图</strong>没有提供我们的新变量和<strong class="lb iu"> normalized_price </strong>之间显著相关性的任何迹象。但是，这并不意味着它们之间没有任何关系，只是意味着没有显著的线性关系。</p><h1 id="49a5" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">走向绿色，第 2 部分</h1><p id="d841" class="pw-post-body-paragraph kz la it lb b lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw im bi translated">既然我们丰富了我们的数据集，现在是时候用新数据训练我们的模型，看看它的表现如何。</p><figure class="ly lz ma mb gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi oc"><img src="../Images/9eacd8c4c772551316eb2b6f44e05d9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DMLw9TqISirh7CxH_Bifeg.png"/></div></div><figcaption class="ml mm gj gh gi mn mo bd b be z dk">How our new predictions perform. Predicted values in orange, actual values in blue.</figcaption></figure><p id="042d" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">考虑到我们的基准模型，我们能够将我们的<strong class="lb iu"> R2 得分</strong>从<strong class="lb iu"> 0.70 </strong>提高到<strong class="lb iu"> 0.75 — </strong>大约<strong class="lb iu"> 7.14% </strong>。</p><p id="78af" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">上面的图描绘了我们获得的新预测值与实际值的比较。特别是在预测接近最高和最低价格的值时，可能会看到一个小的改进。</p><p id="187b" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">就特性的重要性而言，发生了一些有趣的事情。我们引入的一些新变量变得非常重要，从而降低了其他变量的重要性。注意由<strong class="lb iu">地址生成的虚拟变量</strong>变量是如何失去重要性的。就<strong class="lb iu">区</strong>变量而言，它们甚至不再是前 15 个最重要变量的一部分。如果我们想把这些变量从模型中去掉，我们的结果可能不会有太大的不同。</p><p id="b112" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">有趣的是，250 米半径范围内的交通 POI 数量不如该距离内的咖啡馆数量重要。一种可能的猜测是，交通更加均匀地分散在整个城市——大多数公寓靠近电车、公共汽车或地铁站，而咖啡馆可能集中在更中心的地区。</p><p id="35a7" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">我们研究了大量可用的地理数据。也许让我们的模型变得更好的一个方法是获取诸如建筑建造日期、公寓条件和其他特征的信息。我们甚至可以利用地理数据，将变量建立在 POI 半径大于 250 米的范围内。也可以探索 Yelp 的其他类别，如商店、杂货店等，看看它们如何影响租赁价格。</p><h1 id="3d97" class="kb kc it bd kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">关键要点</h1><ul class=""><li id="91ed" class="mp mq it lb b lc ld lg lh lk od lo oe ls of lw ny mv mw mx bi translated">提高一个模型的预测能力不是一件小事，可能需要一点创造力来找到使我们的数据更丰富、更全面的方法</li><li id="3090" class="mp mq it lb b lc my lg mz lk na lo nb ls nc lw ny mv mw mx bi translated">有时一个小的模型改进需要相当多的工作</li><li id="3057" class="mp mq it lb b lc my lg mz lk na lo nb ls nc lw ny mv mw mx bi translated">在预测分析管道中，获取、理解、清理和丰富您的数据是一个关键步骤，但有时会被忽视；这也是最耗时的任务——在这种情况下，这也是最有趣的部分</li></ul><p id="0904" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">这是两部分系列的第二部分。点击这里查看《T2》第一部:</p><div class="og oh gp gr oi oj"><a rel="noopener follow" target="_blank" href="/going-dutch-how-i-used-data-science-and-machine-learning-to-find-an-apartment-in-amsterdam-part-def30d6799e4"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd iu gy z fp oo fr fs op fu fw is bi translated">各付各的:我如何使用数据科学和机器学习在阿姆斯特丹找到一间公寓——部分…</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">阿姆斯特丹的房地产市场正在经历一场令人难以置信的危机，房地产价格以两位数的速度飙升…</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">towardsdatascience.com</p></div></div><div class="os l"><div class="ot l ou ov ow os ox jz oj"/></div></div></a></div><p id="117a" class="pw-post-body-paragraph kz la it lb b lc me le lf lg mf li lj lk mg lm ln lo mh lq lr ls mi lu lv lw im bi translated">如果你喜欢这篇文章，你可能也会喜欢:</p><div class="og oh gp gr oi oj"><a href="https://mlopshowto.com/keeping-your-machine-learning-models-on-the-right-track-getting-started-with-mlflow-part-1-f8ca857b5971" rel="noopener  ugc nofollow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd iu gy z fp oo fr fs op fu fw is bi translated">保持机器学习模型在正确的轨道上:MLflow 入门，第 1 部分</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">了解为什么模型跟踪和 MLflow 对于成功的机器学习项目至关重要</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">mlopshowto.com</p></div></div><div class="os l"><div class="oy l ou ov ow os ox jz oj"/></div></div></a></div><div class="og oh gp gr oi oj"><a rel="noopener follow" target="_blank" href="/detecting-financial-fraud-using-machine-learning-three-ways-of-winning-the-war-against-imbalanced-a03f8815cce9"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd iu gy z fp oo fr fs op fu fw is bi translated">使用机器学习检测金融欺诈:赢得对不平衡数据的战争</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">机器学习和人工智能会在这场战斗中成为伟大的盟友吗？</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">towardsdatascience.com</p></div></div><div class="os l"><div class="oz l ou ov ow os ox jz oj"/></div></div></a></div></div></div>    
</body>
</html>