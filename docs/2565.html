<html>
<head>
<title>Predicting MS Admission</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">预测 MS 入院</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/predicting-ms-admission-afbad9c5c599?source=collection_archive---------3-----------------------#2018-02-07">https://towardsdatascience.com/predicting-ms-admission-afbad9c5c599?source=collection_archive---------3-----------------------#2018-02-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/dabd9c0481d1a0992e227902cdd12197.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f6SLb2T3N28aecjNIgACOQ.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Credits: Pexels</figcaption></figure><p id="0314" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">快到录取季节了，我有几个朋友正处于恐慌状态，等待他们申请的大学的电话。这让我想到——我们如何预测一个学生是否会被录取？选择的参数是什么？可以用数学表达吗？所有这些问题开始出现，所以我决定解决这个问题，并帮助我的朋友平静他的神经。<br/>(这是我写的第一个技术教程，所以请对我宽容些)。</p><p id="206e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">为了解决这个问题，我将带你通过我称之为<br/> <strong class="ke ir"> <em class="la">“数据科学管道”。给定任何问题陈述，遵循这条管道，这样你的方法就结构化了。</em></strong></p><ol class=""><li id="8715" class="lb lc iq ke b kf kg kj kk kn ld kr le kv lf kz lg lh li lj bi translated"><strong class="ke ir">定义问题- </strong></li></ol><p id="5ec1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">写下问题陈述，理解你试图解决的问题。在这种情况下，我们的目标是预测学生是否会被录取。这意味着，这是一个二元分类问题。</p><p id="9c79" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir"> 2。生成您自己的假设- </strong></p><p id="4bff" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">接下来，列出你认为会影响我们目标的所有事情，即。列出与我们的目标特性相关的所有可能的特性。<br/>在我们的案例中，我们被问到这个问题— <em class="la">影响学生录取的因素有哪些？<br/> </em>拿一张纸，写下自己的假设。我花了一些时间，想出了以下特点<br/> - GRE 成绩<br/> -托福成绩<br/> -目的陈述(SOP) <br/> -推荐信(LOR) <br/> -学习成绩(GPA) <br/> -课外活动(体育、奥数等..)<br/> -杰出成就<br/> -项目和研究<br/>确保你写下至少 10-20 个问题陈述。这有助于我们更深入地理解我们试图解决的问题，并促使我们超越现有的数据集进行思考。</p><p id="e2a1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir"> 3。获取数据集- </strong></p><p id="9618" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">下一步是获取数据。我们使用加州大学洛杉矶分校的假设数据进行研究生招生。你可以点击下载<a class="ae lk" href="https://stats.idre.ucla.edu/stat/data/binary.csv" rel="noopener ugc nofollow" target="_blank">数据集。现在你可以用给定的数据集来映射你的假设。查看可以添加或修改多少要素来提高数据集的质量。将每个特征识别为<br/> (a)连续变量或(b)分类变量</a></p><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div class="gh gi ll"><img src="../Images/f9e3559de24bdc24fbe6c86d638c8dbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/1*gY6c3WDcUsIJDAKI_Rj-9w.gif"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">(Source: Stack Exchange)</figcaption></figure><p id="0324" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir"> 4。数据清理- </strong></p><p id="86e6" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">大多数时候，数据集会有很多异常，比如缺失值、异常值等等。在进入下一步之前，一定要对数据进行预处理。<br/>-<strong class="ke ir">-<em class="la">缺失值处理:</em> </strong>您可以使用均值插补(对于连续变量)或模式插补(对于分类变量)</p><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div class="gh gi ll"><img src="../Images/6cf5cfcf30fb39f1eb717ae33541758c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*ZlLVuh-ikZ8so2fWL2m61w.png"/></div></figure><p id="45ac" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">- <strong class="ke ir"> <em class="la">异常值处理:</em> </strong>异常值<em class="la">异常值</em>是随机样本中与其他值存在异常距离的观察值。</p><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div class="gh gi lq"><img src="../Images/7cd73acc07670a73580c614ec8f35196.png" data-original-src="https://miro.medium.com/v2/resize:fit:638/format:webp/1*qF5JqaqfenZYB68pakIeUg.png"/></div></figure><p id="329f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">有四种方法来处理它——删除观察值、估算、创建箱和分别处理。<br/>-<strong class="ke ir">-<em class="la">特征工程:</em>-</strong>组合、添加、删除、分割、缩放特征以增加模型的精度</p><p id="b23b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir"> 5。探索性数据分析(EDA) - </strong></p><p id="7826" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在是我们动手的时候了。让我们探索数据并理解给定的特征。<br/>该数据集有一个名为<code class="fe lr ls lt lu b">admit</code>的二元响应(结果，相关)变量。有三个预测变量:<code class="fe lr ls lt lu b">gre</code>、<code class="fe lr ls lt lu b">gpa</code>和<code class="fe lr ls lt lu b">rank</code>。我们将变量<code class="fe lr ls lt lu b">gre</code>和<code class="fe lr ls lt lu b">gpa</code>视为连续变量。变量<code class="fe lr ls lt lu b">rank</code>取值 1 到 4。排名 1 的机构声望最高，排名 4 的机构声望最低。</p><figure class="lm ln lo lp gt jr"><div class="bz fp l di"><div class="lv lw l"/></div></figure><p id="9263" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">EDA 帮助我们清楚地了解我们的功能。它还帮助我们捕捉数据点的任何趋势或季节性。<br/>在我们的案例中，我们可以看到 GRE 分数和 GPA 越高，被录取的机会就越大。</p><p id="63c9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">6。<br/>预测建模-这是一个二元分类问题。输出只有两种可能，要么<em class="la">是(1) </em>要么<em class="la">否(0)。有很多分类算法，那么我们如何知道哪一个是最好的呢？我们没有。这是需要经验和专业知识的。不过，别担心，我们还有工作要做。我们可以将多种算法应用到我们的数据点上，然后评估模型。这样我们可以选择误差最小的最佳模型。首先，让我们导入所有必要的库</em></p><pre class="lm ln lo lp gt lx lu ly lz aw ma bi"><span id="76fe" class="mb mc iq lu b gy md me l mf mg">from matplotlib import pyplot<br/>from sklearn.model_selection import train_test_split<br/>from sklearn.metrics import classification_report<br/>from sklearn.metrics import confusion_matrix<br/>from sklearn.metrics import accuracy_score<br/>from sklearn.model_selection import KFold<br/>from sklearn.model_selection import cross_val_score<br/>from sklearn.linear_model import LogisticRegression<br/>from sklearn.tree import DecisionTreeClassifier<br/>from sklearn.neighbors import KNeighborsClassifier<br/>from sklearn.ensemble import RandomForestClassifier<br/>from sklearn.discriminant_analysis import LinearDiscriminantAnalysis<br/>from sklearn.naive_bayes import GaussianNB<br/>from sklearn.svm import SVC</span></pre><p id="173b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们将使用交叉验证作为评估指标，我们将把数据集分为训练和测试两部分。</p><pre class="lm ln lo lp gt lx lu ly lz aw ma bi"><span id="b823" class="mb mc iq lu b gy md me l mf mg"><strong class="lu ir">#Step 1: Convert Dataframe into matrix</strong><br/>dataArray = dataset.values</span><span id="bfcd" class="mb mc iq lu b gy mh me l mf mg"><strong class="lu ir">#Step 2: Splitting Input features &amp; Output Variabl</strong>es<br/>X = dataArray[:,1:4]<br/>y = dataArray[:,0:1]</span><span id="05d9" class="mb mc iq lu b gy mh me l mf mg"><strong class="lu ir">#Step 3: Splitting training &amp; testing</strong><br/>validation_size = 0.10<br/>seed = 9<br/>X_train, X_test, Y_train, Y_test = train_test_split(X,y,test_size=validation_size, random_state = seed)</span><span id="3fc3" class="mb mc iq lu b gy mh me l mf mg">print(X_train.shape)<br/>print(X_test.shape)<br/>print(Y_train.shape)<br/>print(Y_test.shape)</span></pre><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/0e7ae634c6b8c7107ca2fe7e9143c375.png" data-original-src="https://miro.medium.com/v2/resize:fit:496/format:webp/1*ZeEzxXtGj3WNy6Yy13T_4Q.png"/></div></figure><p id="166c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">接下来，我们将对我们的训练数据应用以下机器学习算法<br/> -逻辑回归(LR) <br/> -线性判别分析(LDA) <br/> - K 最近邻(KNN) <br/> -决策树(CART) <br/> -随机森林(RF) <br/> -高斯朴素贝叶斯(NB) <br/> -支持向量机(SVM) <br/>初始化最大数量的特征和数量的树。</p><pre class="lm ln lo lp gt lx lu ly lz aw ma bi"><span id="cdfc" class="mb mc iq lu b gy md me l mf mg">num_trees = 200<br/>max_features = 3<br/>models = []<br/>models.append(('LR', LogisticRegression()))<br/>models.append(('LDA', LinearDiscriminantAnalysis()))<br/>models.append(('KNN', KNeighborsClassifier()))<br/>models.append(('CART', DecisionTreeClassifier()))<br/>models.append(('RF', RandomForestClassifier(n_estimators=num_trees, max_features=max_features)))<br/>models.append(('NB', GaussianNB()))<br/>models.append(('SVM', SVC()))</span><span id="628d" class="mb mc iq lu b gy mh me l mf mg"><strong class="lu ir">#Fit Models and Evaulate</strong></span><span id="95d5" class="mb mc iq lu b gy mh me l mf mg">results = []<br/>names = []<br/>scoring = 'accuracy'</span><span id="b3cc" class="mb mc iq lu b gy mh me l mf mg"><strong class="lu ir">#Cross Validation</strong><br/>for name, model in models:<br/> kfold = KFold(n_splits = 10, random_state=7)<br/> cv_results = cross_val_score(model, X_train, Y_train, cv=kfold, scoring = scoring)<br/> results.append(cv_results)<br/> names.append(name)<br/> msg = "%s: %f (%f)" % (name,cv_results.mean(), cv_results.std())<br/> print(msg)</span></pre><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/7ecaf4c0bfadd4f2201b33708149926d.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/format:webp/1*M88HOH_MBJushhcnSnJing.png"/></div></figure><p id="482e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们在这里所做的是在我们的数据点上运行所有 7 种算法，并尝试对其进行评估。如你所见，LR 和 LDA 表现最好。我们也可以实现一个比较图</p><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div class="gh gi mk"><img src="../Images/f5674f0c5dbe572decccae642ab770ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:766/format:webp/1*-HfxfbORA6Y_UZgDAuy-FA.png"/></div></figure><p id="3d98" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在，我们已经将 ML 算法应用到我们的数据集上。接下来，我们必须使用最佳算法创建一个预测模型。<br/>为了简单起见，我打算选 LR。</p><pre class="lm ln lo lp gt lx lu ly lz aw ma bi"><span id="42bb" class="mb mc iq lu b gy md me l mf mg"><strong class="lu ir">#Step 1 - Create prediction model</strong><br/>model = LogisticRegression()</span><span id="f6cc" class="mb mc iq lu b gy mh me l mf mg"><strong class="lu ir">#Step 2 - Fit model</strong><br/>model.fit(X_train, Y_train)</span><span id="7700" class="mb mc iq lu b gy mh me l mf mg"><strong class="lu ir">#Step 3 - Predictions </strong><br/>predictions = model.predict(X_test)</span><span id="6bbe" class="mb mc iq lu b gy mh me l mf mg"><strong class="lu ir">#Step 4 - Check Accuracy</strong><br/>print("Model --- LogisticRegression")<br/>print("Accuracy: {} ".format(accuracy_score(Y_test,predictions) * 100))<br/>print(classification_report(Y_test, predictions))</span></pre><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/4a6346b79097497afaf6d7f9fcaf9e46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1010/format:webp/1*AxPw2UCa0OZSdVzN_7mhsQ.png"/></div></figure><p id="4576" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我喜欢制造情节。所以让我们再做一个；)</p><pre class="lm ln lo lp gt lx lu ly lz aw ma bi"><span id="27b6" class="mb mc iq lu b gy md me l mf mg"><strong class="lu ir">#plotting confusion matrix on heatmap</strong><br/>cm = confusion_matrix(Y_test, predictions)<br/>sns.heatmap(cm, annot=True, xticklabels=['reject','admit'], yticklabels=['reject','admit'])<br/>plt.figure(figsize=(3,3))<br/>plt.show()</span></pre><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/0757120c03f42e4fceff7c5534e7b58a.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/format:webp/1*FRp99DF3nj1YgbtAT0JLbw.png"/></div></figure><p id="21eb" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">恭喜你！您制作了我们自己的预测模型，准确率为 77.5 <br/>(对初学者来说一点也不差)<br/>您可以尝试通过安装不同的分类算法或进行一点点特征工程来提高这个分数。<br/>最好的方法是使用集成方法，但那是其他教程的内容。</p><p id="a205" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">但是等等… <br/>我们怎么知道这行得通呢？<br/>是的，完全正确吗？我们已经走了这么远，怎么能不让我们的模型做出一些预测呢！</p><pre class="lm ln lo lp gt lx lu ly lz aw ma bi"><span id="865f" class="mb mc iq lu b gy md me l mf mg"><strong class="lu ir">#Making predictions on some new data<br/>#Like a boss</strong><br/>new_data = [(720,4,1), (300,2,3) , (400,3,4) ]</span><span id="97ee" class="mb mc iq lu b gy mh me l mf mg"><strong class="lu ir">#Convert to numpy array</strong><br/>new_array = np.asarray(new_data)</span><span id="dc91" class="mb mc iq lu b gy mh me l mf mg"><strong class="lu ir">#Output Labels</strong><br/>labels=["reject","admit"]</span><span id="1650" class="mb mc iq lu b gy mh me l mf mg"><strong class="lu ir">#Let's make some kickass predictions</strong><br/>prediction=model.predict(new_array)</span><span id="c9a5" class="mb mc iq lu b gy mh me l mf mg">#G<strong class="lu ir">et number of test cases used</strong><br/>no_of_test_cases, cols = new_array.shape</span><span id="6b41" class="mb mc iq lu b gy mh me l mf mg">for i in range(no_of_test_cases):<br/> print("Status of Student with GRE scores = {}, GPA grade = {}, Rank = {} will be ----- {}".format(new_data[i][0],new_data[i][1],new_data[i][2], labels[int(prediction[i])]))</span></pre><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mn"><img src="../Images/8e73ff022b229bbb4348b834697e03bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z9q2cCPb1v0Dwfw6FmYh0w.png"/></div></div></figure><p id="8d55" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">仅此而已。我们自己的预测模型可以决定你朋友的未来(事实上不可以)<br/>但是我们的模型绝对可以预测他/她是否会被录取！</p></div><div class="ab cl mo mp hu mq" role="separator"><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt mu"/><span class="mr bw bk ms mt"/></div><div class="ij ik il im in"><p id="916c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">DSW 背后的动机</p><p id="1fb5" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我从一年前开始学习和研究数据科学。在此期间，我做了大量的问题陈述。但问题是，有时数据集非常有趣，但有时却不是。你必须关心你试图解决的问题，只有这样你才能做好工作。</p><p id="519f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">所以找一个你想解决的问题，用数据来解决它。</p><p id="98d4" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">你可以在 Github  上找到本教程的代码<strong class="ke ir"> </strong> <a class="ae lk" href="https://github.com/warmachine0609/Predicting_MS_admission" rel="noopener ugc nofollow" target="_blank"> <strong class="ke ir"/></a></p><p id="90bd" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我将每周写下一些很棒的教程，所以如果你是那种只能通过做来学习的人，请在这里关注我的<a class="ae lk" href="https://medium.com/data-science-weekly-dsw/" rel="noopener"> <strong class="ke ir">出版物。</strong> </a></p><p id="bb15" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">也可以在<a class="ae lk" href="https://www.linkedin.com/in/naman-doshi/" rel="noopener ugc nofollow" target="_blank"> <strong class="ke ir"> LinkedIn </strong> </a>上联系。</p><p id="752a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我希望你有一个富有成效的一周。</p><p id="2c15" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir"> <em class="la">在那之前，继续 hustling！</em>T25】</strong></p></div></div>    
</body>
</html>