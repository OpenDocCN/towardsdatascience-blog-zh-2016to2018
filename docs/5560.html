<html>
<head>
<title>MachineLearning — KNN using scikit-learn</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习— KNN 使用 scikit-learn</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/knn-using-scikit-learn-c6bed765be75?source=collection_archive---------1-----------------------#2018-10-26">https://towardsdatascience.com/knn-using-scikit-learn-c6bed765be75?source=collection_archive---------1-----------------------#2018-10-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="6c47" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">KNN(K-最近邻)是一种简单的监督分类算法，我们可以使用它来为新的数据点分配类别。它也可以用于回归，KNN 没有对数据分布做任何假设，因此它是非参数的。它保留所有训练数据，通过计算输入样本和每个训练实例之间的相似性来进行未来预测。</p><p id="70f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> KNN 可以概括如下:</strong></p><ol class=""><li id="59d3" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">计算每个训练示例的新数据点之间的距离。</li><li id="3750" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">为了计算距离，将使用欧几里德距离、汉明距离或曼哈顿距离等距离度量。</li><li id="640b" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">模型在数据库中挑选 K 个最接近新数据点的条目。</li><li id="95aa" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">然后，它进行多数表决，即这 K 个条目中最常见的类别/标签将是新数据点的类别。</li></ol><figure class="la lb lc ld gt le gh gi paragraph-image"><div class="gh gi kz"><img src="../Images/ffcbad863a74adf29accd9f0a22b0157.png" data-original-src="https://miro.medium.com/v2/resize:fit:1174/format:webp/1*hncgU7vWLBsRvc8WJhxlkQ.png"/></div><figcaption class="lh li gj gh gi lj lk bd b be z dk">With K=3, Class B will be assigned, with K=6 Class A will be assigned</figcaption></figure><p id="1b29" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">关于 KNN 的详细文件可以在<a class="ae ll" href="http://scikit-learn.org/stable/modules/neighbors.html" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="2564" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下示例显示了使用 scikit-learn 库在 iris 数据集上实现 KNN。Iris 数据集对每种不同的鸢尾花有 50 个样本(总共 150 个)。对于每个样本，我们有萼片长度、宽度、花瓣长度和宽度以及物种名称(类别/标签)。</p><div class="la lb lc ld gt ab cb"><figure class="lm le ln lo lp lq lr paragraph-image"><img src="../Images/96312c258a2a6e7d16ac0b65e110b585.png" data-original-src="https://miro.medium.com/v2/resize:fit:612/format:webp/1*gVUMIDt5Nz0WMArjgGN_Gg.png"/></figure><figure class="lm le ls lo lp lq lr paragraph-image"><img src="../Images/5a68e0fbd0cbba1b5272751645705196.png" data-original-src="https://miro.medium.com/v2/resize:fit:746/format:webp/1*1y1k7oDfQFGDShEtqJM9FQ.png"/><figcaption class="lh li gj gh gi lj lk bd b be z dk lt di lu lv">Iris flower: sepal length, sepal width, petal length and width</figcaption></figure></div><ul class=""><li id="9a29" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk lw kr ks kt bi translated"><strong class="jp ir"> 150 观察</strong></li><li id="8ddd" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk lw kr ks kt bi translated"><strong class="jp ir"> 4 特征</strong>(萼片长度、萼片宽度、花瓣长度、花瓣宽度)</li><li id="6a55" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk lw kr ks kt bi translated"><strong class="jp ir">响应</strong>变量是鸢尾物种</li><li id="d51f" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk lw kr ks kt bi translated"><strong class="jp ir">分类</strong>问题，因为响应是分类的。</li></ul><p id="f023" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的任务是建立一个 KNN 模型，根据萼片和花瓣的测量结果对新物种进行分类。Iris 数据集在 scikit-learn 中可用，我们可以利用它来构建我们的 KNN。</p><p id="26f5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完整的代码可以在<a class="ae ll" href="https://github.com/Msanjayds/Scikit-learn/blob/master/KNN%20on%20Iris%20Datset.ipynb" rel="noopener ugc nofollow" target="_blank"> Git Repo </a>中找到。</p><p id="1a34" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第一步:导入所需数据并检查特征。</strong></p><p id="1692" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从 scikit-learn datasets 模块导入 load_iris 函数，并创建一个 iris Bunch 对象(Bunch 是 scikitlearn 用于存储数据集及其属性的特殊对象类型)。</p><figure class="la lb lc ld gt le gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/82d785dcf79cdc724a2731342a792a01.png" data-original-src="https://miro.medium.com/v2/resize:fit:1304/format:webp/1*uvZCBA-AGXWL1HJZbGZJtg.png"/></div></figure><p id="6591" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每次观察代表一朵花，4 列代表 4 次测量。我们可以在“数据”属性下看到特征(测量值)，而在“特征名称”下看到标签。正如我们在下面看到的，标签/响应被编码为 0、1 和 2。因为对于 scikit-learn 模型，特征和静止应该是数字的(Numpy 数组),并且它们应该具有特定的形状。</p><figure class="la lb lc ld gt le gh gi paragraph-image"><div class="gh gi ly"><img src="../Images/8a2f073da0dc1fef26ae248e59e66cc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*yreHpzh1Ov1crEFlv1oOIg.png"/></div></figure><p id="bffa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第二步:拆分数据，训练模型。</strong></p><p id="d46d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对相同的数据进行训练和测试并不是一种最佳的方法，所以我们将数据分成两部分，训练集和测试集。我们使用‘train _ test _ split’函数来拆分数据。可选参数“测试大小”决定了分割百分比。“random_state”参数使数据在每次运行时以相同的方式分割。由于我们是在不同的数据集上进行训练和测试，因此得到的测试精度将更好地估计模型在看不见的数据上的表现。</p><figure class="la lb lc ld gt le gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/fc92a9b877d101390e9ac73a21524bc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*LVgWfHFJ6z88KVbhLigckw.png"/></div></figure><p id="a882" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Scikit-learn 被仔细地组织成模块，这样我们就可以很容易地导入相关的类。从“NeighborsClassifer”模块导入类“KNeighborsClassifer”并实例化估计器(“估计器”是 scikit-learn 对模型的术语)。我们称模型为估计器，因为它们的主要作用是估计未知量。</p><p id="009b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我们的示例中，我们创建了一个“KNeighborsClassifer”类的实例(“knn”)，换句话说，我们创建了一个名为“knn”的对象，它知道在我们提供数据后如何进行 KNN 分类。参数“n_neighbors”是调整参数/超级参数(k)。所有其他参数都设置为默认值。</p><p id="2d29" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">“拟合”方法用于根据训练数据(X_train，y_train)训练模型，而“预测”方法用于根据测试数据(X_test)进行测试。选择 K 的最佳值至关重要，因此我们使用 for 循环来拟合和测试不同 K 值(从 1 到 25)的模型，并在变量(分数)中记录 KNN 的测试精度。</p><figure class="la lb lc ld gt le gh gi paragraph-image"><div class="gh gi ma"><img src="../Images/979635ade26a75b837d0d29e74bbb379.png" data-original-src="https://miro.medium.com/v2/resize:fit:1096/format:webp/1*_PQvCnYZ16fl00uPmwP9Cw.png"/></div></figure><p id="6f82" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用 matplotlib 库绘制 K 值与相应测试精度之间的关系。正如我们所看到的，精确度有升有降，这在用精确度检查模型复杂性时非常典型。一般来说，随着 K 值的增加，精度似乎会提高，但又会下降。</p><p id="5c19" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一般来说，训练精度随着模型复杂性的增加而提高，对于 KNN，模型复杂性由 K 值决定。K 值越大，决策边界越平滑(模型越不复杂)。较小的 K 导致更复杂的模型(可能导致过度拟合)。测试准确性会对过于复杂(过度拟合)或不够复杂(拟合不足)的模型造成不利影响。当模型具有适当的复杂程度时，我们得到最大的测试精确度，在我们的例子中，我们可以看到，对于 3 到 19 的 K 值，我们的模型精确度是 96.6%。</p><figure class="la lb lc ld gt le gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/0a5620fba6a67f3cd8ef6846ebd5bc6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1178/format:webp/1*u_QMtzT1qfnuCaxX_wg7Pw.png"/></div></figure><p id="ed2e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于我们的最终模型，我们可以选择 K 的最佳值为 5(介于 3 和 19 之间)，并用所有可用的数据重新训练该模型。这将是我们最终的模型，可以做预测了。</p><figure class="la lb lc ld gt le gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/1c387d4c3d51ed2122c0920797205e2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1278/format:webp/1*VC6g7Ia1gIG1sxh87XhTIA.png"/></div></figure><p id="f25c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢您的阅读，如果您有任何建议/修改，请告诉我们。</p></div></div>    
</body>
</html>