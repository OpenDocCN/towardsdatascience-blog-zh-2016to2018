<html>
<head>
<title>Understanding K-means Clustering in Machine Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">理解机器学习中的 K-均值聚类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/understanding-k-means-clustering-in-machine-learning-6a6e67336aa1?source=collection_archive---------0-----------------------#2018-09-12">https://towardsdatascience.com/understanding-k-means-clustering-in-machine-learning-6a6e67336aa1?source=collection_archive---------0-----------------------#2018-09-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="0858" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">K-means 聚类是最简单和最流行的无监督机器学习算法之一。</p><p id="7193" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通常，无监督算法仅使用输入向量从数据集进行推断，而不参考已知或标记的结果。</p><p id="e226" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">AndreyBu 拥有超过 5 年的机器学习经验，目前正在向人们传授他的技能，他说“K-means 的目标很简单:将相似的数据点组合在一起，并发现潜在的模式。为了实现这个目标，K-means 在数据集中寻找固定数量(<em class="km"> k </em>)的聚类</p><p id="08b0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">聚类是指由于某些相似性而聚集在一起的数据点的集合。</p><p id="efd3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您将定义一个目标数<em class="km"> k </em>，它指的是您在数据集中需要的质心数。质心是代表群集中心的虚拟或真实位置。</p><p id="6cfc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过减少类内平方和，将每个数据点分配给每个类。</p><p id="6405" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">换句话说，K-means 算法识别<em class="km"> k </em>个质心，然后将每个数据点分配到最近的簇，同时保持质心尽可能小。</p><p id="873a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">K-means 中的<em class="km">表示</em>是指数据的平均值；也就是求质心。</p><h1 id="69bb" class="kn ko iq bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated"><strong class="ak">K 均值算法的工作原理</strong></h1><p id="e650" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">为了处理学习数据，数据挖掘中的 K-means 算法从第一组随机选择的质心开始，这些质心用作每个聚类的起始点，然后执行迭代(重复)计算以优化质心的位置</p><p id="64b9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当出现以下任一情况时，它会停止创建和优化集群:</p><ul class=""><li id="c1c9" class="lq lr iq jp b jq jr ju jv jy ls kc lt kg lu kk lv lw lx ly bi translated">质心已经稳定，因为聚类成功，所以它们的值没有变化。</li><li id="a4ee" class="lq lr iq jp b jq lz ju ma jy mb kc mc kg md kk lv lw lx ly bi translated">已达到定义的迭代次数。</li></ul><h1 id="3070" class="kn ko iq bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated"><strong class="ak"> K-means 算法例题</strong></h1><p id="8d6a" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">让我们看看 K-means 机器学习算法如何使用 Python 编程语言工作的步骤。</p><p id="be88" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将使用 Scikit-learn 库和一些随机数据来说明 K-means 聚类的简单解释。</p><p id="8dd6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">步骤 1:导入库</strong></p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="a897" class="mn ko iq mj b gy mo mp l mq mr">import pandas as pd</span><span id="d258" class="mn ko iq mj b gy ms mp l mq mr">import numpy as np</span><span id="ae2b" class="mn ko iq mj b gy ms mp l mq mr">import matplotlib.pyplot as plt</span><span id="2751" class="mn ko iq mj b gy ms mp l mq mr">from sklearn.cluster import KMeans</span><span id="70d9" class="mn ko iq mj b gy ms mp l mq mr">%matplotlib inline</span></pre><p id="3ec3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从上面的代码中可以看出，我们将在项目中导入以下库:</p><ul class=""><li id="9bec" class="lq lr iq jp b jq jr ju jv jy ls kc lt kg lu kk lv lw lx ly bi translated">熊猫用于阅读和书写电子表格</li><li id="7080" class="lq lr iq jp b jq lz ju ma jy mb kc mc kg md kk lv lw lx ly bi translated">用于执行有效计算的数字</li><li id="5157" class="lq lr iq jp b jq lz ju ma jy mb kc mc kg md kk lv lw lx ly bi translated">用于数据可视化的 Matplotlib</li></ul><p id="673e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第二步:生成随机数据</strong></p><p id="e6db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是在二维空间中生成一些随机数据的代码:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="5885" class="mn ko iq mj b gy mo mp l mq mr">X= -2 * np.random.rand(100,2)</span><span id="e660" class="mn ko iq mj b gy ms mp l mq mr">X1 = 1 + 2 * np.random.rand(50,2)</span><span id="d499" class="mn ko iq mj b gy ms mp l mq mr">X[50:100, :] = X1</span><span id="2912" class="mn ko iq mj b gy ms mp l mq mr">plt.scatter(X[ : , 0], X[ :, 1], s = 50, c = ‘b’)</span><span id="5b1b" class="mn ko iq mj b gy ms mp l mq mr">plt.show()</span></pre><p id="e442" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">总共产生了 100 个数据点，并分成两组，每组 50 个点。</p><p id="1f9e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下是数据在二维空间中的显示方式:</p><figure class="me mf mg mh gt mu gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/3fa3d2e84cc7966504b86e510fcc55ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:748/0*AYHo5J8MUmngdjxa"/></div></figure><p id="dcf6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第三步:使用 Scikit-Learn </strong></p><p id="e1cc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将使用<a class="ae kl" href="http://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank"> Scikit-learn 库</a>中的一些可用函数来处理随机生成的数据。</p><p id="effe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">代码如下:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="9217" class="mn ko iq mj b gy mo mp l mq mr">from sklearn.cluster import KMeans</span><span id="af12" class="mn ko iq mj b gy ms mp l mq mr">Kmean = KMeans(n_clusters=2)</span><span id="aa36" class="mn ko iq mj b gy ms mp l mq mr">Kmean.fit(X)</span></pre><p id="ca91" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这种情况下，我们任意给<em class="km"> k </em> (n_clusters)一个任意值 2。</p><p id="1fa8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是我们运行代码时得到的 K-means 参数的输出:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="fa44" class="mn ko iq mj b gy mo mp l mq mr">KMeans(algorithm=’auto’, copy_x=True, init=’k-means++’, max_iter=300<br/> n_clusters=2, n_init=10, n_jobs=1, precompute_distances=’auto’,<br/> random_state=None, tol=0.0001, verbose=0)</span></pre><p id="f4c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第四步:寻找质心</strong></p><p id="fec4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是查找聚类中心的代码:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="afec" class="mn ko iq mj b gy mo mp l mq mr">Kmean.cluster_centers_</span></pre><p id="af95" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下是质心值的结果:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="edb9" class="mn ko iq mj b gy mo mp l mq mr">array([[-0.94665068, -0.97138368],<br/> [ 2.01559419, 2.02597093]])</span></pre><p id="980d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们显示集群质心(使用绿色和红色)。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="8c48" class="mn ko iq mj b gy mo mp l mq mr">plt.scatter(X[ : , 0], X[ : , 1], s =50, c=’b’)</span><span id="1eff" class="mn ko iq mj b gy ms mp l mq mr">plt.scatter(-0.94665068, -0.97138368, s=200, c=’g’, marker=’s’)</span><span id="7141" class="mn ko iq mj b gy ms mp l mq mr">plt.scatter(2.01559419, 2.02597093, s=200, c=’r’, marker=’s’)</span><span id="38bf" class="mn ko iq mj b gy ms mp l mq mr">plt.show()</span></pre><p id="40f2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下是输出:</p><figure class="me mf mg mh gt mu gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/903a6fadc4286dd9f5439090c993d070.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/0*vf08X44o0XgHVXvv"/></div></figure><p id="dbcb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第五步:测试算法</strong></p><p id="9c71" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是获取 K 均值聚类示例数据集的 labels 属性的代码；也就是说，如何将数据点分类到两个集群中。</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="5108" class="mn ko iq mj b gy mo mp l mq mr">Kmean.labels_</span></pre><p id="b552" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是运行上述 K-means 算法代码的结果:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="9b16" class="mn ko iq mj b gy mo mp l mq mr">array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,<br/> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,<br/> 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,<br/> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,<br/> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])</span></pre><p id="a12f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如您在上面看到的，50 个数据点属于<strong class="jp ir"> 0 </strong>簇，而其余的属于<strong class="jp ir"> 1 </strong>簇。</p><p id="ab9c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如，让我们使用下面的代码来预测数据点的聚类:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="8a97" class="mn ko iq mj b gy mo mp l mq mr">sample_test=np.array([-3.0,-3.0])</span><span id="dbda" class="mn ko iq mj b gy ms mp l mq mr">second_test=sample_test.reshape(1, -1)</span><span id="f751" class="mn ko iq mj b gy ms mp l mq mr">Kmean.predict(second_test)</span></pre><p id="285a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">结果如下:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="bbb6" class="mn ko iq mj b gy mo mp l mq mr">array([0])</span></pre><p id="1be0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">显示测试数据点属于<strong class="jp ir"> 0 </strong>(绿色质心)簇。</p><h1 id="8fe9" class="kn ko iq bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated"><strong class="ak">包装</strong></h1><p id="82b3" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">以下是 Python 中完整的 K-means 聚类算法代码:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="1276" class="mn ko iq mj b gy mo mp l mq mr">import pandas as pd</span><span id="8a98" class="mn ko iq mj b gy ms mp l mq mr">import numpy as np</span><span id="a822" class="mn ko iq mj b gy ms mp l mq mr">import matplotlib.pyplot as plt</span><span id="63f3" class="mn ko iq mj b gy ms mp l mq mr">from sklearn.cluster import KMeans</span><span id="4a6f" class="mn ko iq mj b gy ms mp l mq mr">%matplotlib inline</span><span id="788d" class="mn ko iq mj b gy ms mp l mq mr">X= -2 * np.random.rand(100,2)</span><span id="ecfe" class="mn ko iq mj b gy ms mp l mq mr">X1 = 1 + 2 * np.random.rand(50,2)</span><span id="a7ec" class="mn ko iq mj b gy ms mp l mq mr">X[50:100, :] = X1</span><span id="51ee" class="mn ko iq mj b gy ms mp l mq mr">plt.scatter(X[ : , 0], X[ :, 1], s = 50, c = ‘b’)</span><span id="69aa" class="mn ko iq mj b gy ms mp l mq mr">plt.show()</span><span id="93f1" class="mn ko iq mj b gy ms mp l mq mr">from sklearn.cluster import KMeans</span><span id="2de2" class="mn ko iq mj b gy ms mp l mq mr">Kmean = KMeans(n_clusters=2)</span><span id="c87f" class="mn ko iq mj b gy ms mp l mq mr">Kmean.fit(X)</span><span id="764b" class="mn ko iq mj b gy ms mp l mq mr">Kmean.cluster_centers_</span><span id="1d8b" class="mn ko iq mj b gy ms mp l mq mr">plt.scatter(X[ : , 0], X[ : , 1], s =50, c=’b’)</span><span id="71d2" class="mn ko iq mj b gy ms mp l mq mr">plt.scatter(-0.94665068, -0.97138368, s=200, c=’g’, marker=’s’)</span><span id="0fee" class="mn ko iq mj b gy ms mp l mq mr">plt.scatter(2.01559419, 2.02597093, s=200, c=’r’, marker=’s’)</span><span id="2b47" class="mn ko iq mj b gy ms mp l mq mr">plt.show()</span><span id="d676" class="mn ko iq mj b gy ms mp l mq mr">Kmean.labels_</span><span id="a739" class="mn ko iq mj b gy ms mp l mq mr">sample_test=np.array([-3.0,-3.0])</span><span id="4826" class="mn ko iq mj b gy ms mp l mq mr">second_test=sample_test.reshape(1, -1)</span><span id="db14" class="mn ko iq mj b gy ms mp l mq mr">Kmean.predict(second_test)</span></pre><p id="6915" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">k-均值聚类是一种广泛使用的数据聚类分析技术。</p><p id="afc8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这很容易理解，尤其是如果你使用 K-means 聚类教程来加速你的学习。此外，它可以快速提供培训结果。</p><p id="e35e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是，它的性能通常不如其他复杂的聚类技术有竞争力，因为数据中的微小变化会导致很大的差异。</p><p id="f961" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，聚类被假设为球形且大小均匀，这可能会降低 K-means 聚类 Python 结果的准确性。</p><p id="1983" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在机器学习中使用 K-means 聚类有什么经验？</p><p id="59ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请在下面分享你的评论。</p></div></div>    
</body>
</html>