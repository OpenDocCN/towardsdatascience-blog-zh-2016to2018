<html>
<head>
<title>TensorFlow — A hands-on approach</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">张量流——实践方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/tensorflow-a-hands-on-approach-8614372f021f?source=collection_archive---------3-----------------------#2018-07-07">https://towardsdatascience.com/tensorflow-a-hands-on-approach-8614372f021f?source=collection_archive---------3-----------------------#2018-07-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/aae21dcfe01be18845d935ad092b7e25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ockRxLunwRDQI89eiiNlUA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">[Source: www.tensorflow.org]</figcaption></figure><p id="d1c5" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这是我将要撰写的系列文章的第一篇，介绍 TensorFlow 并深入研究它提供的无数数学和机器学习库。首先，在这篇文章中，我将描述 TensorFlow 框架背后的思想，它的构造方式，它的关键组件等。到本文结束时，您将能够用 TensorFlow 编写简单的数值求解器代码片段。</p><p id="f6c5" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">对于那些不知道的人来说，</p><blockquote class="la lb lc"><p id="1f67" class="kc kd ld ke b kf kg kh ki kj kk kl km le ko kp kq lf ks kt ku lg kw kx ky kz ij bi translated">TensorFlow 是一个用于构建机器学习模型的计算框架。它是由杰夫·迪恩领导的谷歌大脑的第二代系统。它于 2017 年初推出，通过引入从可扩展性到构建生产就绪模型的众多功能，颠覆了 ML 世界。<br/>【鸣谢:维基百科】</p></blockquote><figure class="li lj lk ll gt jr gh gi paragraph-image"><div class="gh gi lh"><img src="../Images/29a5bd9a09b3e2e7d6eaadf031deb4ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*9fLHHY6q6ZI085QPFxiM1Q.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">[Source: www.tensorflow.org]</figcaption></figure><h2 id="0fad" class="lm ln iq bd lo lp lq dn lr ls lt dp lu kn lv lw lx kr ly lz ma kv mb mc md me bi translated">框架</h2><figure class="li lj lk ll gt jr gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/c0820f4bca1b9f35d4af859a453a4331.png" data-original-src="https://miro.medium.com/v2/resize:fit:1208/format:webp/1*qPMBwmAFohycaACOuUKKXQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">TensorFlow toolkit hierarchy</figcaption></figure><p id="8b40" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">TensorFlow 提供了各种不同的工具包，允许您在自己喜欢的抽象级别上编写代码。例如，您可以在核心 TensorFlow (C++)中编写代码，并从 Python 代码中调用该方法。你也可以定义你的代码应该运行的架构(CPU，GPU 等等。).在上面的层次结构中，可以编写代码的最低层是 C++或 Python。这两个层次允许你编写数值程序来求解数学运算和方程。虽然这并不强烈推荐用于构建机器学习模型，但它提供了大量的数学库来减轻您的任务。您可以编写代码的下一个层次是使用 TF 特定的抽象方法，这些方法针对模型组件进行了高度优化。例如，使用 tf.layers 方法抽象，您可以处理神经网络的层。您可以使用 tf.metrics 方法构建模型并评估模型性能。使用最广泛的级别是 tf.estimator API，它允许您使用 easy 构建(训练和预测)生产就绪模型。estimator API 非常容易使用，并且经过了很好的优化。尽管它提供的灵活性较低，但它具有训练和测试您的模型所需的所有功能。让我们看看 estimator API 的一个应用程序，它只用三行代码就构建了一个分类器。</p><figure class="li lj lk ll gt jr"><div class="bz fp l di"><div class="mg mh l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Simple Classifier Using TensorFlow Estimator API</figcaption></figure><p id="9134" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在本文中，我将使用核心 TensorFlow (Python)来编写代码。但在此之前，让我先讨论一下 TensorFlow 中可用的数据类型。</p><h2 id="19e2" class="lm ln iq bd lo lp lq dn lr ls lt dp lu kn lv lw lx kr ly lz ma kv mb mc md me bi translated">数据类型</h2><p id="066b" class="pw-post-body-paragraph kc kd iq ke b kf mi kh ki kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz ij bi translated">这个框架中的基本数据类型是一个<strong class="ke ir">张量。</strong>张量是数据的 N 维数组。例如，你可以称一个标量(一个常量值，比如整数 2)为 0 维张量。向量是一维张量，矩阵是二维张量。下图详细描述了张量的每个维度。</p><figure class="li lj lk ll gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mn"><img src="../Images/73b5fb68885c997fd52bd6b2c9d187a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RiQ5LRM0CLfJToI3fk7VLA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Tensor Data Type</figcaption></figure><p id="40c1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">观察上图。变量<em class="ld"> x </em>是使用<em class="ld"> tf.constant </em>类声明的张量。</p><p id="91ee" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">常数:</strong>常数是一个值根本不能改变的张量。在第一个例子中，<em class="ld"> x </em>取常数值 3，因此形状为 None。你可以通过使用<em class="ld"> tf.stack </em>函数在现有张量上叠加张量来声明任何维度的张量，这可以从<strong class="ke ir"> nD 张量</strong>的例子中看出。</p><p id="5f8d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在我们已经看到了如何在 TensorFlow 中声明常数，让我们看看声明变量。</p><p id="6422" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">变量:</strong>变量是一个张量，它的值被初始化，然后通常随着程序的运行而改变。在 TensorFlow 中，变量由<em class="ld"> tf 操纵。变量</em>类。创建变量的最好方法是调用<em class="ld"> tf.get_variable </em>函数。该函数要求您指定变量的名称。其他副本将使用此名称来访问同一变量，并在检查指向和导出模型时命名此变量的值。<em class="ld"> tf.get_variable </em>还允许您重用之前创建的同名变量，从而轻松定义重用层的模型。</p><pre class="li lj lk ll gt mo mp mq mr aw ms bi"><span id="69c2" class="lm ln iq mp b gy mt mu l mv mw">my_variable = tf.get_variable("my_variable", [1, 2, 3])</span></pre><p id="df97" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><strong class="ke ir">初始化变量:</strong>由于使用了低级 API 核心张量流，变量需要明确初始化。如果像<em class="ld"> tf 这样的高层框架。正在使用估算器</em>或<em class="ld"> Keras </em>，变量将自动为您初始化。为了初始化变量，需要调用<em class="ld">TF . global _ variables _ initializer</em>。您可以使用以下代码行初始化会话中的所有变量。</p><pre class="li lj lk ll gt mo mp mq mr aw ms bi"><span id="b266" class="lm ln iq mp b gy mt mu l mv mw">session.run(tf.global_variables_initializer())</span></pre><p id="c504" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">但是什么是<em class="ld"> session.run </em>？？什么是会话？</p><h2 id="1fd0" class="lm ln iq bd lo lp lq dn lr ls lt dp lu kn lv lw lx kr ly lz ma kv mb mc md me bi translated">会话和图表</h2><p id="f23e" class="pw-post-body-paragraph kc kd iq ke b kf mi kh ki kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz ij bi translated">会话封装了 TensorFlow 运行时的状态，并运行 TensorFlow 操作。使用 TensorFlow 编写的每一行代码都由一个底层图形表示。下面我们用一个例子来理解这一点。</p><figure class="li lj lk ll gt jr"><div class="bz fp l di"><div class="mg mh l"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">TensorFlow sessions</figcaption></figure><p id="d94a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我创建了两个 1D 张量<em class="ld"> x </em>和<em class="ld">y。</em>我将它们相加并存储在一个名为<em class="ld"> z1 </em>的变量中。我将它们相乘并存储在变量<em class="ld"> z2 </em>中。我通过从<em class="ld"> z2 </em>中减去<em class="ld"> z1 </em>创建了另一个变量<em class="ld"> z3 </em>。当执行这个特定的代码片段时，TensorFlow <strong class="ke ir">不计算结果</strong>，而是创建一个表示上述代码的图形(如下所示)。</p><figure class="li lj lk ll gt jr gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/40ede78e5b91b1ef2d77dba9ca24a071.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/format:webp/1*B9L6Y6lz1NzFFjyC1YMeYA.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">TensorFlow Graph</figcaption></figure><p id="ed9b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">利用图形背后的想法是创建可移植的代码。是的，任何人都可以在任何类型的架构上导出和使用这个图。但是，TensorFlow 为什么不计算结果呢？因为，它遵循了懒惰的评估范式。所有创建的图形都绑定到一个会话，我们必须告诉 TensorFlow 使用<em class="ld"> session.run </em>计算结果。</p><pre class="li lj lk ll gt mo mp mq mr aw ms bi"><span id="125b" class="lm ln iq mp b gy mt mu l mv mw">session.run(z3)</span></pre><p id="7de9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">记住这一点，如果一个<em class="ld"> tf。图形</em>就像一个<em class="ld">。py </em>文件，一个<em class="ld"> tf。会话</em>类似于 python 可执行文件。</p><p id="7463" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在我们已经知道了会话、图形、数据类型以及如何创建变量的基础知识，让我们通过编写一些 TensorFlow 代码来尝试一下。</p><h1 id="7818" class="my ln iq bd lo mz na nb lr nc nd ne lu nf ng nh lx ni nj nk ma nl nm nn md no bi translated">张量流代码</h1><h2 id="1639" class="lm ln iq bd lo lp lq dn lr ls lt dp lu kn lv lw lx kr ly lz ma kv mb mc md me bi translated">加法和减法</h2><figure class="li lj lk ll gt jr"><div class="bz fp l di"><div class="mg mh l"/></div></figure><h2 id="df34" class="lm ln iq bd lo lp lq dn lr ls lt dp lu kn lv lw lx kr ly lz ma kv mb mc md me bi translated">乘法和除法</h2><figure class="li lj lk ll gt jr"><div class="bz fp l di"><div class="mg mh l"/></div></figure><h2 id="cff9" class="lm ln iq bd lo lp lq dn lr ls lt dp lu kn lv lw lx kr ly lz ma kv mb mc md me bi translated">重塑</h2><figure class="li lj lk ll gt jr"><div class="bz fp l di"><div class="mg mh l"/></div></figure><h2 id="9d94" class="lm ln iq bd lo lp lq dn lr ls lt dp lu kn lv lw lx kr ly lz ma kv mb mc md me bi translated">我已经用上面讨论的简单操作编写了一个二次方程解算器，同样的代码可以在我的 GitHub 库中找到。[ <a class="ae np" href="https://github.com/avinashingit/TensorflowProjects/blob/master/Programming/Halleys%20Equation%20Solver.ipynb" rel="noopener ugc nofollow" target="_blank">链接</a></h2><h1 id="3adf" class="my ln iq bd lo mz na nb lr nc nd ne lu nf ng nh lx ni nj nk ma nl nm nn md no bi translated">结论</h1><p id="f174" class="pw-post-body-paragraph kc kd iq ke b kf mi kh ki kj mj kl km kn mk kp kq kr ml kt ku kv mm kx ky kz ij bi translated">TensorFlow 主要用作后端框架，其模块通过 Keras API 调用。通常，TensorFlow 用于解决图像分类、对象识别、声音识别等复杂问题。在本文中，我们学习了张量流的结构和组成。在下一篇文章中，我们将深入研究机器学习，并使用 TensorFlow 构建我们的第一个线性回归模型。</p><p id="7ef7" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">深入了解 TensorFlow 的一些资源:</p><ol class=""><li id="9377" class="nq nr iq ke b kf kg kj kk kn ns kr nt kv nu kz nv nw nx ny bi translated"><a class="ae np" href="https://www.tensorflow.org" rel="noopener ugc nofollow" target="_blank"> TensorFlow </a>文档。</li><li id="ade4" class="nq nr iq ke b kf nz kj oa kn ob kr oc kv od kz nv nw nx ny bi translated">Coursera 上 TensorFlow MOOC 介绍。</li></ol><p id="3185" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">敬请关注我的后续文章。</p><p id="2e6c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">Github: <a class="ae np" href="https://github.com/avinashingit" rel="noopener ugc nofollow" target="_blank">链接</a> <br/> Linkedin: <a class="ae np" href="https://www.linkedin.com/in/avinashkadimisetty" rel="noopener ugc nofollow" target="_blank">链接</a></p><figure class="li lj lk ll gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oe"><img src="../Images/fadaf603c7797ffa84b4a80f02ea71b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j4OEOxP0XOtdncPU3rXbOw.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae np" href="https://unsplash.com/photos/eM6WUs4nKMY?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Alexandru-Bogdan Ghita</a> on <a class="ae np" href="https://unsplash.com/search/photos/intel?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure></div></div>    
</body>
</html>