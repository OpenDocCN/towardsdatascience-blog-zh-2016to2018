<html>
<head>
<title>Image Augmentation for Deep Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于深度学习的图像增强</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/image-augmentation-for-deep-learning-histogram-equalization-a71387f609b2?source=collection_archive---------2-----------------------#2017-07-10">https://towardsdatascience.com/image-augmentation-for-deep-learning-histogram-equalization-a71387f609b2?source=collection_archive---------2-----------------------#2017-07-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="0a9c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">深度网络需要大量的训练数据来实现良好的性能。为了使用非常少的训练数据建立强大的图像分类器，通常需要图像增强来提高深度网络的性能。<strong class="jp ir">图像增强</strong>通过不同的处理方式或多种处理方式的组合，如随机旋转、平移、剪切、翻转等，人工创建训练图像。</p><h1 id="3759" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">图像数据发生器</h1><p id="9dff" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">使用Keras中的<a class="ae lo" href="https://keras.io/preprocessing/image/" rel="noopener ugc nofollow" target="_blank"> ImageDataGenerator </a> API可以轻松创建一个增强图像生成器。<code class="fe lp lq lr ls b">ImageDataGenerator</code>通过实时数据增强生成批量图像数据。创建和配置<code class="fe lp lq lr ls b">ImageDataGenerator</code>以及用增强图像训练深度神经网络的最基本代码如下。</p><pre class="lt lu lv lw gt lx ls ly lz aw ma bi"><span id="95d7" class="mb km iq ls b gy mc md l me mf">datagen = ImageDataGenerator()<br/>datagen.fit(train)<br/>X_batch, y_batch = datagen.flow(X_train, y_train, batch_size=batch_size)<br/>model.fit_generator(datagen, samples_per_epoch=len(train), epochs=epochs)</span></pre><p id="ec67" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以用下面的代码来创建具有所需属性的增强图像。在我们的例子中，下面的数据生成器生成一批9个增强图像，旋转30度，水平移动0.5。</p><pre class="lt lu lv lw gt lx ls ly lz aw ma bi"><span id="456e" class="mb km iq ls b gy mc md l me mf">datagen = ImageDataGenerator(rotation_range=30, horizontal_flip=0.5)<br/>datagen.fit(img)</span><span id="4563" class="mb km iq ls b gy mg md l me mf">i=0<br/>for img_batch in datagen.flow(img, batch_size=9):<br/>    for img in img_batch:<br/>        plt.subplot(330 + 1 + i)<br/>        plt.imshow(img)<br/>        i=i+1    <br/>    if i &gt;= batch_size:<br/>        break</span></pre><div class="lt lu lv lw gt ab cb"><figure class="mh mi mj mk ml mm mn paragraph-image"><img src="../Images/0658e190baf6aa5f93563ee806fa0657.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/1*Kjx-CunaKZ267ljICtmSsA.jpeg"/></figure><figure class="mh mi mq mk ml mm mn paragraph-image"><img src="../Images/f842a947810684094d56a2cd5cf92f3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:732/format:webp/1*5RXJ2OlVJp4_sd1XzhK6pQ.png"/><figcaption class="mr ms gj gh gi mt mu bd b be z dk mv di mw mx">Original Image and Augmented Images</figcaption></figure></div><h1 id="0dbe" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">直方图均衡</h1><p id="56f2" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">除了Keras中的<code class="fe lp lq lr ls b">ImageDataGenerator</code>类提供的标准数据扩充技术，我们还可以使用自定义函数来生成扩充图像。例如，您可能想要使用对比度拉伸来调整图像的对比度。<strong class="jp ir">对比度拉伸</strong>是一种简单的图像处理技术，通过将图像的亮度值范围重新缩放(“拉伸”)到所需的值范围来增强对比度。</p><p id="da51" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">直方图均衡</strong>是另一种图像处理技术，使用图像强度直方图增加图像的整体对比度。均衡图像具有线性累积分布函数。这种方法不需要参数，但有时会产生看起来不自然的图像。</p><p id="2cd5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">另一种方法是<strong class="jp ir">自适应直方图均衡化</strong> (AHE)，它通过计算对应于图像不同部分的几个直方图来提高图像的局部对比度(不同于仅使用一个直方图来调整全局对比度的普通直方图均衡化)，并将它们用于局部对比度调整。然而，AHE倾向于过度放大图像中相对均匀区域的噪声。</p><p id="50b8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">对比度受限的自适应直方图均衡</strong> (CLAHE)是为了防止AHE导致的噪声过度放大而开发的。简言之，它通过在计算累积分布函数之前将直方图限幅在预定值来限制AHE的对比度增强。</p><p id="8213" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了在Keras中实现用于增强的定制预处理函数，我们首先定义我们的定制函数，并将其作为参数传递给<code class="fe lp lq lr ls b">ImageDataGenerator</code>。例如，我们可以使用下面的代码实现AHE。</p><pre class="lt lu lv lw gt lx ls ly lz aw ma bi"><span id="bc83" class="mb km iq ls b gy mc md l me mf">def AHE(img):<br/>    img_adapteq = exposure.equalize_adapthist(img, clip_limit=0.03)<br/>    return img_adapteq</span><span id="dfb1" class="mb km iq ls b gy mg md l me mf">datagen = ImageDataGenerator(rotation_range=30, horizontal_flip=0.5, preprocessing_function=AHE)</span></pre><div class="lt lu lv lw gt ab cb"><figure class="mh mi my mk ml mm mn paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><img src="../Images/b912c3a24526634c1843de75d2a2d8e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*WboGzP5KP12n0hdPRN0JsQ.png"/></div></figure><figure class="mh mi my mk ml mm mn paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><img src="../Images/6b6814bb494147db62ebe5e0a11e8a92.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*VuMIXCQMoO9v9Bsv42kF3Q.png"/></div></figure><figure class="mh mi my mk ml mm mn paragraph-image"><div role="button" tabindex="0" class="mz na di nb bf nc"><img src="../Images/a50ce5cf176ec06b19d5fa8e6771abec.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*U05jTwYmW8j_hibbRgwLPA.png"/></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk nd di ne mx">Augmented Images using Contrast Stretching (left), Histogram Equalization (middle) and Adaptive Histogram Equalization (right)</figcaption></figure></div><p id="eeb6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae lo" href="https://github.com/sukilau/Ziff-deep-learning/blob/master/2-CIFAR10-data-generator/CIFAR10-DataGenerator.ipynb" rel="noopener ugc nofollow" target="_blank">源代码</a></p><h2 id="8612" class="mb km iq bd kn nf ng dn kr nh ni dp kv jy nj nk kz kc nl nm ld kg nn no lh np bi translated">参考</h2><ul class=""><li id="6525" class="nq nr iq jp b jq lj ju lk jy ns kc nt kg nu kk nv nw nx ny bi translated"><a class="ae lo" href="http://machinelearningmastery.com/image-augmentation-deep-learning-keras/" rel="noopener ugc nofollow" target="_blank">使用Keras进行深度学习的图像增强</a></li><li id="6459" class="nq nr iq jp b jq nz ju oa jy ob kc oc kg od kk nv nw nx ny bi translated"><a class="ae lo" href="https://blog.keras.io/building-powerful-image-classification-models-using-very-little-data.html" rel="noopener ugc nofollow" target="_blank">使用非常少的数据构建强大的图像分类模型</a></li></ul></div></div>    
</body>
</html>