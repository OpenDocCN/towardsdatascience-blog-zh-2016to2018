<html>
<head>
<title>The JupyterLab Credential Store</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JupyterLab 凭据存储</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-jupyterlab-credential-store-9cc3a0b9356?source=collection_archive---------14-----------------------#2018-10-29">https://towardsdatascience.com/the-jupyterlab-credential-store-9cc3a0b9356?source=collection_archive---------14-----------------------#2018-10-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="c553" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个 JupyterLab 扩展使您的凭证安全，并提供方便的访问。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/940f8e3bdc1410132e65e3c11bed3f24.png" data-original-src="https://miro.medium.com/v2/resize:fit:746/format:webp/1*RZq5sbUQYP0MBDRfhFE4rw.png"/></div></figure><h2 id="561d" class="kt ku iq bd kv kw kx dn ky kz la dp lb jy lc ld le kc lf lg lh kg li lj lk ll bi translated">TL；博士:</h2><p id="5bbe" class="pw-post-body-paragraph jn jo iq jp b jq lm js jt ju ln jw jx jy lo ka kb kc lp ke kf kg lq ki kj kk ij bi translated"><strong class="jp ir"> JupyterLab 凭据库</strong>使用 AES 加密保护您的凭据安全。在这个 JupyterLab 前端扩展中添加、编辑和删除作为键-值对的凭证。使用他们的密钥访问凭据:</p><pre class="km kn ko kp gt lr ls lt lu aw lv bi"><span id="ecf1" class="kt ku iq ls b gy lw lx l ly lz">import kernel_connector as kc<br/>kc.get_credential(“my_secret”)</span></pre><p id="3da7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用以下命令安装<strong class="jp ir"> JupyterLab 凭证存储库</strong>:</p><pre class="km kn ko kp gt lr ls lt lu aw lv bi"><span id="6b85" class="kt ku iq ls b gy lw lx l ly lz">pip install pycrypto<br/>apt-get install nodejs -y<br/>apt-get install npm -y<br/>jupyter labextension install @lean-data-science/jupyterlab_credentialstore</span></pre><p id="31a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你喜欢容器化的配置，<strong class="jp ir"> JupyterLab 凭证存储库</strong>与<a class="ae ma" href="https://lean-data-science.com/#/configure-jupyterlab" rel="noopener ugc nofollow" target="_blank"> JupyterLab-Configurator </a>(此处呈现<a class="ae ma" rel="noopener" target="_blank" href="/how-to-setup-your-jupyterlab-project-environment-74909dade29b"/>)无缝集成，让你轻松创建自己的<strong class="jp ir"> JupyterLab 配置</strong>。</p><h2 id="0bf7" class="kt ku iq bd kv kw kx dn ky kz la dp lb jy lc ld le kc lf lg lh kg li lj lk ll bi translated">保管好你的证件</h2><p id="40fc" class="pw-post-body-paragraph jn jo iq jp b jq lm js jt ju ln jw jx jy lo ka kb kc lp ke kf kg lq ki kj kk ij bi translated">JupyterLab 是一个交互式开发环境，使您能够在选项卡式工作区中使用 Jupyter 笔记本。Jupyter 笔记本允许您轻松地与您的同事共享您的代码和模型。当您处理数据时，访问数据几乎总是需要某种形式的凭证，例如用户名和密码或 API 访问密钥。</p><p id="2f4e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你需要特别注意你的证件。如果您直接在笔记本中使用它们，您可能会意外地暴露它们，例如，当您将笔记本提交到您的 git-repository 时，或者当您共享笔记本时。</p><h2 id="fd4a" class="kt ku iq bd kv kw kx dn ky kz la dp lb jy lc ld le kc lf lg lh kg li lj lk ll bi translated">笔记本的力量:是福是祸</h2><p id="8198" class="pw-post-body-paragraph jn jo iq jp b jq lm js jt ju ln jw jx jy lo ka kb kc lp ke kf kg lq ki kj kk ij bi translated">以正确的方式处理凭证的问题不仅限于 Jupyter 笔记本。这在任何其他开发环境中都同样重要。但是笔记本有暴露凭证的特殊风险。不是技术上的。而是程序性的！</p><p id="76df" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">笔记本作为一种工具，可以快速、轻松地浏览数据，无需太多开销。笔记本电脑不需要明确的解决方案架构来规定代码、数据和凭证的存放位置。笔记本电脑很少采用多阶段部署的方式投入生产，这可确保凭据分别安全地存储在各个阶段的配置中。</p><p id="cd1e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是笔记本是一个灵活而强大的工具。它们在数据科学家的工具箱中有合法的位置。</p><h2 id="76be" class="kt ku iq bd kv kw kx dn ky kz la dp lb jy lc ld le kc lf lg lh kg li lj lk ll bi translated">环境变量</h2><p id="6c73" class="pw-post-body-paragraph jn jo iq jp b jq lm js jt ju ln jw jx jy lo ka kb kc lp ke kf kg lq ki kj kk ij bi translated">将凭证存储在环境变量中是一种常见的做法。环境变量驻留在系统进程中。Jupyter 内核就是一个很好的例子。这些进程源自操作系统(或启动它们的软件，如 Jupyter)。流程及其环境变量不是笔记本的一部分，因为笔记本不是流程，而是文件(JSON)。Jupyter 应用程序将笔记本文件与进程(内核)连接起来。</p><p id="7b48" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是使用环境变量似乎是一种有一些缺点的变通方法:</p><ol class=""><li id="d154" class="mb mc iq jp b jq jr ju jv jy md kc me kg mf kk mg mh mi mj bi translated">无论何时添加、编辑或删除环境变量，都必须重新启动笔记本服务器，以使更改生效。但是，如果您刚刚完成了一个长时间运行的计算，您不能存储它的结果，因为存储它需要一个 API 调用，您之前没有设置它的凭证，那该怎么办呢？请你把凭据放进笔记本里，只有这一次，答应吗？哎呀！</li><li id="e432" class="mb mc iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">API(例如 AWS)通常提供使用环境变量的便利功能。当环境变量设置好后，一切都正常了。但是你的同事在使用笔记本和复制你的结果时遇到了问题。不仅如此，API 调用也不起作用(这是可以的，因为你不希望别人使用你的账户)。而且，你的同伴不一定知道(详细地)为什么它不起作用，以及需要什么来使它起作用。当你不能轻松分享时，笔记本就失去了它的大部分用途。</li><li id="51ba" class="mb mc iq jp b jq mk ju ml jy mm kc mn kg mo kk mg mh mi mj bi translated">如果因为使用两个同类服务(例如 AWS)而需要同一个环境变量的两个不同值，该怎么办？每个服务都需要自己的凭据。您会手动设置和更改环境变量吗？在给定的情况下，记住变量的所需值将是一个严峻的挑战，不是吗？</li></ol><h2 id="3f3a" class="kt ku iq bd kv kw kx dn ky kz la dp lb jy lc ld le kc lf lg lh kg li lj lk ll bi translated">保持你的灵活性</h2><p id="4d3f" class="pw-post-body-paragraph jn jo iq jp b jq lm js jt ju ln jw jx jy lo ka kb kc lp ke kf kg lq ki kj kk ij bi translated"><strong class="jp ir"> JupyterLab 凭据库</strong>保留了 Jupyter 笔记本的灵活性，同时确保您的凭据安全。这个 JupyterLab 扩展向您的工作区添加了一个凭证浏览器，您可以通过侧边栏上的菜单项打开它。在凭据资源管理器中，您可以添加、编辑和删除凭据的键值对。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/5a16344faa4a0fda89d044af8a00a628.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*4Vzy1XIP0ucgNkYmHOJWng.png"/></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk">The credential explorer</figcaption></figure><p id="9841" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以在代码中轻松使用凭据。只需导入<code class="fe mu mv mw ls b">kernel_connector</code>并使用其密钥访问凭证。这就像使用环境变量一样简单。</p><pre class="km kn ko kp gt lr ls lt lu aw lv bi"><span id="ae69" class="kt ku iq ls b gy lw lx l ly lz">import kernel_connector as kc<br/>kc.get_credential(“my_secret”)</span></pre><p id="7be3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当您更改凭证时，不需要重新启动内核。当您添加或编辑凭证时，只需按下保存按钮，您就可以直接使用它。当您删除凭据时，对它的访问会立即被删除。</p><p id="d77f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果需要设置环境变量，可以在代码中完成，而不会有暴露凭据的风险。因为您直接在活动内核中设置环境，所以您可以立即使用它，而无需重启内核。这允许您动态地准备您的环境。它明确地向你的同伴显示，你在这里使用环境变量。但这并没有暴露他们！下图描述了这个用例。但是请注意，您不应该打印您的凭据。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="gh gi mx"><img src="../Images/83df8680674d95a03133b24f8a8eaab1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uhQxxSzmaUfQDIqi4YACfQ.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk">Example of using the credential store</figcaption></figure><h2 id="e18d" class="kt ku iq bd kv kw kx dn ky kz la dp lb jy lc ld le kc lf lg lh kg li lj lk ll bi translated">你的证书是安全的</h2><p id="bb15" class="pw-post-body-paragraph jn jo iq jp b jq lm js jt ju ln jw jx jy lo ka kb kc lp ke kf kg lq ki kj kk ij bi translated"><strong class="jp ir"> JupyterLab 凭据库</strong>使用您在首次使用时设置的密码。每个凭证都用您的密码散列加密。加密的凭证存储在启动 JupyterLab 的目录中的<code class="fe mu mv mw ls b">.credentialstore</code>文件中。如果您使用版本控制系统，请确保将它添加到您的<code class="fe mu mv mw ls b">.gitignore</code>文件中。</p><p id="c5aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">JupyterLab 凭证存储库要求您在解密凭证之前登录。因此，即使有人获得了你的<code class="fe mu mv mw ls b">.credentialstore</code>文件，那个人仍然需要破解 AES 加密的密码。</p><p id="c906" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2003 年 6 月，美国政府宣布 AES 可用于保护最高机密级别的信息。</p><h2 id="2af1" class="kt ku iq bd kv kw kx dn ky kz la dp lb jy lc ld le kc lf lg lh kg li lj lk ll bi translated">Jupyter 辅助安全</h2><p id="2a42" class="pw-post-body-paragraph jn jo iq jp b jq lm js jt ju ln jw jx jy lo ka kb kc lp ke kf kg lq ki kj kk ij bi translated"><strong class="jp ir"> JupyterLab 凭证存储库</strong>利用了 Jupyter 的一个核心特性:生成缺省情况下相互独立的进程(内核)的能力。当您登录到凭证存储时，它会将解密的凭证放入一个新的 Python 内核中。为了获得凭证，您需要访问这个内核。因为每次启动凭证存储时内核的标识符都会发生变化，这增加了一定程度的混淆。</p><p id="2b2c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个 JupyterLab 扩展的<code class="fe mu mv mw ls b">kernel_connector</code>模块从前端获取 kernel-id，并提供对保存凭证的内核的方便访问。</p><p id="56ae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当您停止凭证存储时(使用 stop 图标)，持有凭证的内核会立即停止。因此，您的凭证会立即被阻止访问。如果您现在试图访问它们，库将抛出一个异常。如果您再次登录，您可以立即再次访问，而无需重启内核。</p><h2 id="c651" class="kt ku iq bd kv kw kx dn ky kz la dp lb jy lc ld le kc lf lg lh kg li lj lk ll bi translated">易于安装</h2><p id="b753" class="pw-post-body-paragraph jn jo iq jp b jq lm js jt ju ln jw jx jy lo ka kb kc lp ke kf kg lq ki kj kk ij bi translated">您可以使用以下命令安装<strong class="jp ir"> JupyterLab 凭证存储库</strong>及其依赖项:</p><pre class="km kn ko kp gt lr ls lt lu aw lv bi"><span id="ed14" class="kt ku iq ls b gy lw lx l ly lz">apt-get install nodejs -y<br/>apt-get install npm -y<br/>jupyter labextension install @lean-data-science/jupyterlab_credentialstore</span></pre><p id="312c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您还可以使用<a class="ae ma" href="https://lean-data-science.com/#/configure-jupyterlab" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">JupyterLab-Configurator</strong></a>为您自动创建一个脚本控制的容器化 JupyterLab 环境。在配置器中，只需选中<strong class="jp ir">使用 JupyterLab 凭证存储</strong>选项。关于<strong class="jp ir">JupyterLab-Configurator</strong>的介绍见<a class="ae ma" rel="noopener" target="_blank" href="/how-to-setup-your-jupyterlab-project-environment-74909dade29b">这篇文章</a>。</p><p id="5b6c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">容器化的 JupyterLab 环境不仅方便使用，而且进一步增加了安全性。容器将保存凭证的内核与系统的其余部分分开。如果有人想访问这个内核，他需要首先进入容器的环境。</p><p id="4849" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下图描述了<strong class="jp ir"> JupyterLab 凭证存储库</strong>的架构。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/f8c4cc9a773b727a83c25c8065166343.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*7rqwREO3aIZ6T5jWbHFnNg.png"/></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk">The architecture of the JupyterLab Credential Store</figcaption></figure></div></div>    
</body>
</html>