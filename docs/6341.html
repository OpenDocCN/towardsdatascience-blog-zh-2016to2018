<html>
<head>
<title>Building a molecular charge classifier</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建分子电荷分类器</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/building-a-molecular-charge-classifier-50204deebd6d?source=collection_archive---------9-----------------------#2018-12-08">https://towardsdatascience.com/building-a-molecular-charge-classifier-50204deebd6d?source=collection_archive---------9-----------------------#2018-12-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6482" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">化学和人工智能的交集</h2></div><p id="1481" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">A.在过去的几年里，我看到了前所未有的增长。尽管像神经网络(NN)这样的机器学习架构由于 Geoffrey Hinton 这样的顶级研究人员的突破而闻名已久，但直到最近<em class="lb">神经网络才成为人工智能专家工具箱中的强大工具。这主要归功于 21 世纪的到来带来的三个变化:</em></p><ol class=""><li id="dc1d" class="lc ld iq kh b ki kj kl km ko le ks lf kw lg la lh li lj lk bi translated">增强的计算能力</li><li id="4418" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la lh li lj lk bi translated">增加可用数据</li><li id="bcd0" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la lh li lj lk bi translated">对自动化越来越感兴趣</li></ol><p id="eb77" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">目前在互联网、政府系统和个人电脑上流动的大多数数据都是未标记的。<strong class="kh ir">标记数据(即对应于另一个现有数据集的数据)更难获得。</strong>数据类型包括数字、图像、音频和文本。</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi lq"><img src="../Images/3d736731ccfadda51ba82abed37e1a10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4UqUCpS141KwtRz22dQ0mw.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk">Code, Math, and Molecules; the trinity of difficult things to use in A.I</figcaption></figure><blockquote class="mg"><p id="a0c2" class="mh mi iq bd mj mk ml mm mn mo mp la dk translated"><strong class="ak">要克服的巨大挑战是离散分子数据是多么脆弱。</strong></p></blockquote><p id="e4ab" class="pw-post-body-paragraph kf kg iq kh b ki mq jr kk kl mr ju kn ko ms kq kr ks mt ku kv kw mu ky kz la ij bi translated">考虑一下这个:</p><ul class=""><li id="4730" class="lc ld iq kh b ki kj kl km ko le ks lf kw lg la mv li lj lk bi translated">在数学方程式中，如果一个数字或运算被改变，则该方程式无效。</li><li id="bbec" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la mv li lj lk bi translated">在代码块中，如果任何变量、方法、函数等。被更改，代码将以不同的方式执行。</li><li id="7488" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la mv li lj lk bi translated">在一个分子中，如果一个键、原子或电子被改变，这个分子就完全不同了。</li></ul><p id="be9c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">神经网络有一个非常独特的过程，使它们不同于其他算法。输入的数据必然会在神经网络中被处理，也就是说，它会受到权重、偏差、激活函数以及一系列其他可调、可学习和特定参数的影响；</p><blockquote class="mg"><p id="b7f7" class="mh mi iq bd mj mk mw mx my mz na la dk translated">进入神经网络的数据将被改变。</p></blockquote><p id="a6a7" class="pw-post-body-paragraph kf kg iq kh b ki mq jr kk kl mr ju kn ko ms kq kr ks mt ku kv kw mu ky kz la ij bi translated"><strong class="kh ir">操纵脆弱的离散数据如履薄冰。</strong>目前，有 4 种主要的方法来表示一种分子，按照损失的顺序列出:</p><ol class=""><li id="c9a7" class="lc ld iq kh b ki kj kl km ko le ks lf kw lg la lh li lj lk bi translated">分子指纹</li><li id="1c59" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la lh li lj lk bi translated">字符串表示</li><li id="ad51" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la lh li lj lk bi translated">分子图</li><li id="2e44" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la lh li lj lk bi translated">模拟</li></ol><p id="6c9c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">每一种都有自己独特的过程，但我用来构建分子电荷分类器的是字符串表示和分子指纹。大多数化学信息数据和分子数据都是以 InChi 字符串的形式提供的，或者我更喜欢的格式，SMILES 字符串。大多数时候，微笑字符串看起来像一种化学胡言乱语:</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/383162eee9b9ef68836549c669c6aabe.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/1*X--WIg1VNCZrJ68yiK82UA.gif"/></div><figcaption class="mc md gj gh gi me mf bd b be z dk">Molecules with their respective SMILE strings</figcaption></figure><p id="60cc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些字符串是在语法的帮助下生成的。和英语一样，<strong class="kh ir">单个分子可以有不同的微笑串</strong>；就像一个词可以有很多定义，或者一个想法可以用不同的句子来表达。</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><a href="https://www.wildcardconsulting.dk/useful-information/smiles-enumeration-as-data-augmentation-for-molecular-neural-networks/"><div class="gh gi nc"><img src="../Images/a211abd01f659de7c9428877bfae812e.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/1*ZIug_8_7dAzcLcEd--PItA.png"/></div></a><figcaption class="mc md gj gh gi me mf bd b be z dk">The many faces of Toluene; all the strings represent the same molecule</figcaption></figure><p id="1e0d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">图表由 Esben Bjerrum 博士提供，他是用人工智能征服化学之旅的领先专家和研究人员。要了解更多关于 canonical SMILES 枚举的信息，请查看他的<a class="ae nd" href="https://www.wildcardconsulting.dk/useful-information/smiles-enumeration-as-data-augmentation-for-molecular-neural-networks/" rel="noopener ugc nofollow" target="_blank">博客帖子</a>。</p><p id="ce13" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了防止重复的微笑串，每个分子仅使用一个微笑串变体。值得注意的是，每个分子都有一个初级字符串表示，也称为规范微笑。有了 SMILES 格式的<strong class="kh ir">干净的标记分子数据集</strong>，我开始构建分子电荷分类器。</p></div><div class="ab cl ne nf hu ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ij ik il im in"><h1 id="176e" class="nl nm iq bd nn no np nq nr ns nt nu nv jw nw jx nx jz ny ka nz kc oa kd ob oc bi translated">项目收费</h1><p id="5409" class="pw-post-body-paragraph kf kg iq kh b ki od jr kk kl oe ju kn ko of kq kr ks og ku kv kw oh ky kz la ij bi translated">我用微笑字符串和神经网络用 python 和 Keras 库构建了一个分子电荷分类器。每个分子都有特定的电荷 0、1、-1 和-2(还有更多，但我的数据集中的所有分子都有 4 种可能的电荷)。</p><p id="4052" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该项目分为 4 个步骤:</p><ol class=""><li id="44fd" class="lc ld iq kh b ki kj kl km ko le ks lf kw lg la lh li lj lk bi translated">导入 SMILES 数据(带标签，即费用)</li><li id="47a3" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la lh li lj lk bi translated">将数据转换为 256 位二进制代码</li><li id="713c" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la lh li lj lk bi translated">构建深层神经网络</li><li id="f3d3" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la lh li lj lk bi translated">编译和拟合模型</li></ol><p id="33dd" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于这个项目，该模型用 250，000 个数据集的 1000 个微笑字符串进行训练。我将每个微笑字符串转换成 256 位二进制代码，这样我就可以用相同数量的输入神经元构建神经网络；256.该模型将每个前进层的神经元数量减半，从 256 → 128 → 64 → 34 → 16，最后到 4 个输出神经元，每个神经元对应数据集中的一个可能电荷(0，1，-1，-2)。</p><p id="e2f5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从训练集中抽取 10%的数据(100 个微笑字符串)用作验证数据。该模型使用 relu 作为其输入层激活函数，使用 sigmoid 作为隐藏层的激活函数，最后使用 softmax 函数以 0 到 1 之间的概率形式输出结果。因此，分类以概率小数的形式呈现，由神经网络根据其训练计算。</p><p id="8384" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该模型用 10 个新分子进行了测试，并成功预测了所有 10 个分子的电荷，其中一些产生了较高的可能性百分比(80%^)，而另一些产生了较低的可能性百分比(40%^)</p><p id="cfad" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Charged 项目的所有代码和数据集都可以在我的 Github 上找到，在这个<a class="ae nd" href="https://github.com/flawnson/NN_Charge_Classifier-master" rel="noopener ugc nofollow" target="_blank">库</a>里。</p></div><div class="ab cl ne nf hu ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ij ik il im in"><p id="f9f3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">化学数据面临的挑战是找到代表你正在研究的分子的方法。理想的表示考虑到了分子数据的脆弱性，同时仍然保持固有的特征和模式完整无缺。这种表示应该在准确性和计算效率之间取得适当的平衡。</p><h1 id="d5bf" class="nl nm iq bd nn no oi nq nr ns oj nu nv jw ok jx nx jz ol ka nz kc om kd ob oc bi translated">关键要点</h1><ol class=""><li id="9bfd" class="lc ld iq kh b ki od kl oe ko on ks oo kw op la lh li lj lk bi translated">像代码和数学一样，分子在被操纵时容易变得脆弱</li><li id="bacf" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la lh li lj lk bi translated">用计算术语表示分子有 4 种方法；指纹、字符串表示、分子图或模拟</li><li id="2f0c" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la lh li lj lk bi translated">SMILES 是一种流行的字符串表示；一个分子可以有许多串，但只有一个规范的微笑</li><li id="6bb2" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la lh li lj lk bi translated">将一个分子转换成二进制指纹，并将它们输入到神经网络中，这是在化学中利用人工智能的一种方法</li><li id="3cae" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la lh li lj lk bi translated">分子表示和化学信息学作为一个整体，是准确性和计算能力的平衡</li></ol><p id="4fbe" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">还在看这个？想要更多吗？不确定下一步该做什么？</strong></p><ul class=""><li id="7dc9" class="lc ld iq kh b ki kj kl km ko le ks lf kw lg la mv li lj lk bi translated">分享到<a class="ae nd" href="http://www.linkedin.com" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>、<a class="ae nd" href="http://www.facebook.com" rel="noopener ugc nofollow" target="_blank">脸书</a>，或者<a class="ae nd" href="http://www.twitter.com" rel="noopener ugc nofollow" target="_blank"> Twitter </a>！(顺便加我)</li><li id="f6ee" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la mv li lj lk bi translated">查看<a class="ae nd" href="http://www.flawnson.com" rel="noopener ugc nofollow" target="_blank">我的作品集</a>了解更多酷项目、内容和更新！</li><li id="eada" class="lc ld iq kh b ki ll kl lm ko ln ks lo kw lp la mv li lj lk bi translated">在任何平台上寻求问题、合作和想法！</li></ul><h1 id="ff41" class="nl nm iq bd nn no oi nq nr ns oj nu nv jw ok jx nx jz ol ka nz kc om kd ob oc bi translated">向前！</h1></div></div>    
</body>
</html>