<html>
<head>
<title>Moving from Python to Go</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从 Python 迁移到 Go</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/moving-to-go-from-python-9ebbd9a8aec4?source=collection_archive---------5-----------------------#2018-08-22">https://towardsdatascience.com/moving-to-go-from-python-9ebbd9a8aec4?source=collection_archive---------5-----------------------#2018-08-22</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="682f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">过去两年我一直在使用 Python，它在很多方面都是一种非常方便的语言。它可以用于 web 开发(使用 Flask 或 Django)、机器学习(使用 nltk 或 scikit-learn)、数据可视化(使用 seaborn 或 matplotlib)和深度学习(使用 TensorFlow、keras)。Python 是一种非常适合初学者的简洁的书面语言。然而，它也有局限性——例如速度不够快、GIL、动态类型和非内置并发支持。最近，我被要求拿起 Go 进行一个查询理解项目(我已经在我的<a class="ae ko" href="https://medium.com/@sanket107" rel="noopener">其他博客</a>中写了这个)。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi kp"><img src="../Images/161272e3585e5e4f3a6d178db3e9ebd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zXGly_BHR_FQN3ngX-U7sQ.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk">Moving from Python to Go</figcaption></figure><p id="ab7c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我对 Go 的第一印象是它有多罗嗦。铅字散落一地，没有课。已经掌握了一些 Python 语言，在 Go 中从头开始被证明是一个挑战。一些博客比较了 Python 和 Go，我将只关注语法部分。我听说过很多关于静态类型的东西，但我不知道我实际上是在做什么。事不宜迟，我们继续吧。</p><h1 id="487e" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">1.静态打字</h1><p id="02a5" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">令人惊讶的是 Python 对你隐藏了多少类型。你基本上是这样开始编写函数的:</p><pre class="kq kr ks kt gt mi mj mk ml aw mm bi"><span id="affc" class="mn lg it mj b gy mo mp l mq mr">def add_numbers(num1, num2):<br/>     return num1 + num2 </span></pre><p id="94c7" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">现在你会期望这个函数的用户会给你发送两个整数，你可以把它们相加。但是，如果他们发送字符串呢？或者字典？对于字符串，这段代码仍然有效，但是“1”、“2”将返回“12”而不是 3。这可能会导致更复杂的程序出现许多令人痛苦的错误，这些程序可能很难调试 esp。因为 Python 只会在运行时告诉你这些。<br/>在围棋中同样的程序是:</p><pre class="kq kr ks kt gt mi mj mk ml aw mm bi"><span id="b14d" class="mn lg it mj b gy mo mp l mq mr">func add_numbers(num1 int, num2 int)int{<br/>     return num1 + num2<br/>}</span></pre><p id="6d90" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们不能向该函数发送两个字符串或其他数据类型。如果 Go 需要两个整数，它将确保调用这个函数的每一行都发送两个整数。当 Go 的二进制文件被编译时，这些问题就可以被捕捉到，而不是等到生产中的运行时——因此节省了很多问题！欢迎来到静态打字的魔力！</p><h1 id="13df" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">2.结构和 JSON 解析</h1><p id="3754" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">对于任何数据科学项目来说，JSON 解析都是非常重要的。围棋没有课。它的传播方式是使用<a class="ae ko" href="https://gobyexample.com/structs" rel="noopener ugc nofollow" target="_blank">结构</a>以及接口和方法。对于像 Go 这样的静态类型语言来说，结构非常有用，因为结构预先明确了我们可以使用什么类型。让我们举一个例子:</p><pre class="kq kr ks kt gt mi mj mk ml aw mm bi"><span id="0d05" class="mn lg it mj b gy mo mp l mq mr">{ "John" : {"id": 12345, "department": "Human Resources"},<br/>  "Sarah": {"id": 3, "department": "Software Engineering"},<br/>  "Omar": {"id": 145, "department": "Marketing"}<br/>}</span></pre><p id="e7cf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要从上面的 JSON 中获取所有雇员的姓名，Python 中的代码将是:</p><pre class="kq kr ks kt gt mi mj mk ml aw mm bi"><span id="6dc4" class="mn lg it mj b gy mo mp l mq mr"># Code in Python<br/>import json</span><span id="d27a" class="mn lg it mj b gy ms mp l mq mr">def find_names():<br/>   with open("example.json", "r") as outfile:<br/>       data = json.load(outfile)<br/>       names = [name for name, details in data.items()]<br/>   return names</span></pre><p id="9345" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">围棋中同样的代码是:</p><pre class="kq kr ks kt gt mi mj mk ml aw mm bi"><span id="da4d" class="mn lg it mj b gy mo mp l mq mr">package main</span><span id="b11a" class="mn lg it mj b gy ms mp l mq mr">import (<br/>     "fmt"<br/>     "io/ioutil"<br/>     "json"<br/>)</span><span id="bb68" class="mn lg it mj b gy ms mp l mq mr">func find_names()[]string{<br/>   type EmployeeDetails struct{<br/>      Id string `json:"id"`<br/>      Department string `json:"department"`<br/>   }</span><span id="38d7" class="mn lg it mj b gy ms mp l mq mr">   var employee_data map[string]EmployeeDetails // Go's dictionary<br/>   data, _ := ioutil.ReadFile("example.json")<br/>   err := json.Unmarshal(data, &amp;employee_data) // Use of pointer<br/>   if err!=nil{<br/>      fmt.Println("error:", err) // Easy handling of errors<br/>   }</span><span id="2d3e" class="mn lg it mj b gy ms mp l mq mr">   var names []string<br/>   for name, _ := range employee_data{<br/>     names = append(names, name)<br/>   }<br/>   return names<br/>}</span></pre><h2 id="e486" class="mn lg it bd lh mt mu dn ll mv mw dp lp kb mx my lt kf mz na lx kj nb nc mb nd bi translated">Python 和 Go 在解析 JSON 方面的一些关键区别:</h2><ol class=""><li id="1c35" class="ne nf it js b jt md jx me kb ng kf nh kj ni kn nj nk nl nm bi translated">在 Go 中，您需要<strong class="js iu">知道您在 JSON 中解析的每个字段的数据类型</strong>。如果数据类型被混淆，Python 代码将保持不变，但是 Go 的代码将<a class="ae ko" href="https://medium.com/@nate510/dynamic-json-umarshalling-in-go-88095561d6a0" rel="noopener">随着<code class="fe nn no np mj b">interface{}</code>和类型断言等的使用</a>发生相当大的变化。Go 是一种强类型语言，在设计 API 时最好记住这一点。</li><li id="c932" class="ne nf it js b jt nq jx nr kb ns kf nt kj nu kn nj nk nl nm bi translated">Go 提供了开箱即用的<strong class="js iu">错误处理</strong>。如果 json 中的<code class="fe nn no np mj b">Unmarshal</code>函数有问题，就会创建上面的<code class="fe nn no np mj b">err</code>。在 Python 中，错误或异常处理更加谨慎，很容易被忽略。</li><li id="6aa8" class="ne nf it js b jt nq jx nr kb ns kf nt kj nu kn nj nk nl nm bi translated">围棋中没有列表理解。Python 在这方面很容易使用，但是在 Go 中，每个片段都需要显式分配数据类型，代码也更加冗长。</li><li id="89a6" class="ne nf it js b jt nq jx nr kb ns kf nt kj nu kn nj nk nl nm bi translated">在 Go 中，<strong class="js iu">指针</strong>允许用户明确控制是否要修改底层对象。在 Python 中，不清楚函数是就地修改传入的数据，还是使用数据的副本。在 Go 中，使用<code class="fe nn no np mj b">&amp;employee_data</code>可以清楚地表明我们想要修改底层变量。</li><li id="e1d4" class="ne nf it js b jt nq jx nr kb ns kf nt kj nu kn nj nk nl nm bi translated">在 Go 中，<strong class="js iu">未使用的变量</strong>和未使用的导入是不行的——不像 Python。它们需要被替换为<code class="fe nn no np mj b">_</code>(下划线)。我觉得这使得代码可读性更好。</li></ol><p id="f3b4" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对于混合数据类型，您需要接口。此外，如果您不想使用 structs 来自动让 JSON 的<code class="fe nn no np mj b">Unmarshal</code>遵循数据类型，您将需要几个类型断言，这两个我们将在接下来研究。</p><h1 id="e468" class="lf lg it bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">3.接口和类型断言</h1><p id="3c0c" class="pw-post-body-paragraph jq jr it js b jt md jv jw jx me jz ka kb mf kd ke kf mg kh ki kj mh kl km kn im bi translated">对于来自 Python 的我来说，接口是最棘手的部分。实际上，我更害怕指针，但是令人惊讶的是，到目前为止它们还可以，因为 Go 只是使用指针来给用户更多的变量控制。</p><p id="3935" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">虽然 Go 是一种强类型语言，但接口允许 Go 在数据类型上有一些模糊性。接口既可以是<code class="fe nn no np mj b">type</code>也可以是<code class="fe nn no np mj b">set of methods</code>。当你写一个以<code class="fe nn no np mj b">interface{}</code>作为参数的函数时，你可以给这个函数提供任何值——这很棘手，因为这并不意味着任何类型。<code class="fe nn no np mj b">interface{}</code>本身就是一个类型。阅读<a class="ae ko" href="https://stackoverflow.com/questions/23148812/whats-the-meaning-of-interface" rel="noopener ugc nofollow" target="_blank">该堆栈溢出讨论</a>以全面理解这一点。</p><pre class="kq kr ks kt gt mi mj mk ml aw mm bi"><span id="8197" class="mn lg it mj b gy mo mp l mq mr">func add_numbers(num1 interface{}, num2 interface{})interface{}{<br/>    // num1 and num2 are of interface{} type only (not any type)<br/>    // but any type can be converted to interface{} type<br/>    // This is really tricky, esp. coming from Python world</span><span id="b634" class="mn lg it mj b gy ms mp l mq mr">    // Need type assertion to ensure types are as expected<br/>    m := num1.(int)<br/>    n := num2.(int)<br/>    return m + n    // returns an integer<br/>}</span></pre><p id="97e8" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">上面是一个使用<code class="fe nn no np mj b">interface</code>作为类型的例子。<code class="fe nn no np mj b">Interface</code>也可以作为<code class="fe nn no np mj b">set of methods</code>为不同结构的变量提供方法。《以身作则》有一个<a class="ae ko" href="https://gobyexample.com/interfaces" rel="noopener ugc nofollow" target="_blank">很好的例子</a>。简而言之，<code class="fe nn no np mj b">interface</code>可以用来收集与某些结构相关联的方法，比如针对<code class="fe nn no np mj b">rect</code>或<code class="fe nn no np mj b">circle</code>结构的<code class="fe nn no np mj b">area()</code>或<code class="fe nn no np mj b">perim()</code>。这就像 Python 中的类方法。</p><p id="2d3c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这些是我发现的 Python 和 Go 之间的一些主要区别。写 Go 代码让我重新思考如何写 Python，尤其是。我如何设计函数来接受类型和处理错误。</p><p id="bf4f" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">为了更好地学习围棋，很多人向我推荐了这本书<a class="ae ko" href="https://www.amazon.com/Programming-Language-Addison-Wesley-Professional-Computing/dp/0134190440/?tag=omnilence-20" rel="noopener ugc nofollow" target="_blank">围棋编程语言书</a>:</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/398fdc7aa654f1d911acdf673069d2d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:366/format:webp/1*pTKiWfneaUTEcSdK2VQPCg.png"/></div><figcaption class="lb lc gj gh gi ld le bd b be z dk"><a class="ae ko" href="https://www.amazon.com/Programming-Language-Addison-Wesley-Professional-Computing/dp/0134190440/?tag=omnilence-20" rel="noopener ugc nofollow" target="_blank">Go Programming Language Book</a></figcaption></figure><p id="565e" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我可能会在未来的博客文章中涉及机器学习、自然语言处理和围棋数据可视化等主题。<br/> <strong class="js iu">更新</strong>2019 年 2 月:在一个新的视频课程中，我在 Go 中涵盖了机器学习、NLP、决策树、推荐系统等所有上述主题！[ <a class="ae ko" href="https://www.udemy.com/hands-on-fundamentals-of-data-science-with-go/" rel="noopener ugc nofollow" target="_blank"> Udemy Link </a>，<a class="ae ko" href="https://www.packtpub.com/big-data-and-business-intelligence/hands-fundamentals-data-science-go-video" rel="noopener ugc nofollow" target="_blank"> Packt Link </a> ]请随意查看 Github 上的<a class="ae ko" href="https://github.com/PacktPublishing/Hands-on-Fundamentals-of-Data-Science-with-Go" rel="noopener ugc nofollow" target="_blank">公共代码库，其中涵盖了 Golang 中的 tweet bot、文本分类、推荐引擎等主题。</a></p><p id="5942" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">附:看看我的新播客！我最近开始了一个名为“<a class="ae ko" href="https://podcasts.apple.com/us/podcast/the-data-life-podcast/id1453716761" rel="noopener ugc nofollow" target="_blank">数据生活播客</a>的新播客。如果你已经在工作中处理数据，或者想在机器学习、自然语言处理或信息检索方面做得更好，这就是适合你的播客。你可以在<a class="ae ko" href="https://itunes.apple.com/us/podcast/the-data-life-podcast/id1453716761?mt=2&amp;uo=4" rel="noopener ugc nofollow" target="_blank">苹果播客</a>、<a class="ae ko" href="https://open.spotify.com/show/6xWi36lOBHpHRabi9eO1Bj" rel="noopener ugc nofollow" target="_blank"> Spotify </a>或<a class="ae ko" href="https://anchor.fm/the-data-life-podcast" rel="noopener ugc nofollow" target="_blank"> Anchor.fm </a>上听，或者在我最喜欢的播客应用之一:<a class="ae ko" href="https://overcast.fm/itunes1453716761/the-data-life-podcast" rel="noopener ugc nofollow" target="_blank">阴天</a>上听。</p><figure class="kq kr ks kt gt ku gh gi paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gh gi nw"><img src="../Images/2139d0e310dae7ba1a97b4891df2c681.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YRClTc1-16ntOQI7YKvDzg.png"/></div></div><figcaption class="lb lc gj gh gi ld le bd b be z dk">My New Podcast: <a class="ae ko" href="https://podcasts.apple.com/us/podcast/the-data-life-podcast/id1453716761" rel="noopener ugc nofollow" target="_blank">The Data Life Podcast</a></figcaption></figure><p id="5808" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">祝你写 Go 代码一切顺利！</p></div></div>    
</body>
</html>