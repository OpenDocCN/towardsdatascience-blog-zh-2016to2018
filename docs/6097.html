<html>
<head>
<title>Cross Validation Explained: Evaluating estimator performance.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">交叉验证解释:评估估计性能。</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/cross-validation-explained-evaluating-estimator-performance-e51e5430ff85?source=collection_archive---------1-----------------------#2018-11-26">https://towardsdatascience.com/cross-validation-explained-evaluating-estimator-performance-e51e5430ff85?source=collection_archive---------1-----------------------#2018-11-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="693a" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用交叉验证改进你的 ML 模型。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/6a195ce0f70c2f628ee695fb378b3c9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9GJlpHt79hg62v8l1ltGlQ.png"/></div></div></figure><p id="e82f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">机器学习工程师或数据科学家的最终目标是开发一个模型，以便根据新数据进行预测或根据未知数据预测未来的一些事件。好的模型不是对已知数据或训练数据给出准确预测的模型，而是对新数据给出良好预测并避免过拟合和欠拟合的模型。</p><p id="b49e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">完成本教程后，您将了解:</p><ul class=""><li id="8626" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated">为什么要使用交叉验证是一个用来评估模型在新数据上的技巧的过程。</li><li id="c937" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">您可以使用一些常用策略来为数据集选择 k 值。</li><li id="0ac6" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">scikit-learn 中提供了交叉验证的常用变体，如分层和 LOOCV。</li><li id="b72f" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">k 折叠交叉验证在 Python 中的实际实现</li></ul><p id="7880" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了找到解决办法，我们应该首先了解这个问题。在我们开始理解交叉验证之前，让我们先理解过度拟合和欠拟合</p><h2 id="2258" class="mb mc iq bd md me mf dn mg mh mi dp mj la mk ml mm le mn mo mp li mq mr ms mt bi translated"><strong class="ak">了解欠拟合和过拟合:</strong></h2><p id="b38f" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mw lc ld le mx lg lh li my lk ll lm ij bi translated"><strong class="kt ir">过度拟合模型:</strong>当统计模型或机器学习算法捕捉到数据的噪声时，就会发生过度拟合。直觉上，当模型或算法与数据拟合得太好时，就会发生过度拟合。</p><p id="c792" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">过度拟合模型导致训练数据集具有良好的准确性，但对新数据集的结果较差。这种模型在现实世界中没有任何用处，因为它不能预测新病例的结果。</p><p id="3266" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">欠拟合模型:</strong>当统计模型或机器学习算法无法捕捉数据的潜在趋势时，就会发生欠拟合。直观地说，当模型或算法与数据拟合得不够好时，就会出现拟合不足。拟合不足通常是模型过于简单的结果。简单是指缺少的数据没有得到正确处理，没有异常值处理，移除了不相关的特征或对预测变量没有太大贡献的特征。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mz"><img src="../Images/761c5f68d67ac2fa5cd955725b9c8e54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dpUnwfXqnU5Kd-gfafgIgQ.png"/></div></div></figure><h2 id="607d" class="mb mc iq bd md me mf dn mg mh mi dp mj la mk ml mm le mn mo mp li mq mr ms mt bi translated"><strong class="ak">如何解决过拟合问题:</strong></h2><p id="80e8" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mw lc ld le mx lg lh li my lk ll lm ij bi translated"><strong class="kt ir"> <em class="na">答案是交叉验证</em> </strong></p><p id="760f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">过度拟合和一般机器学习的一个关键挑战是，在我们实际测试之前，我们无法知道我们的模型在新数据上的表现如何。</p><p id="6f96" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了解决这个问题，我们可以将初始数据集分成单独的<em class="na">训练</em>和<em class="na">测试</em>子集。</p><p id="cbe7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">有不同类型的交叉验证技术，但是总体概念是相同的，</p><p id="df34" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"/>将数据分成若干子集</p><p id="b6de" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"/>一次拿出一组，在剩余的一组上训练模型</p><p id="396f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"/>等待装置上的测试模型</p><p id="3c22" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> <em class="na">对数据集的每个子集重复上述过程</em> </strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/24e6ce5b7b637db3525d052ec4001d96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*qPMFLEbvc8QQf38Cf77wQg.png"/></div><figcaption class="nc nd gj gh gi ne nf bd b be z dk">the process of cross validation in general</figcaption></figure><h2 id="ea36" class="mb mc iq bd md me mf dn mg mh mi dp mj la mk ml mm le mn mo mp li mq mr ms mt bi translated"><strong class="ak">交叉验证的类型:</strong></h2><p id="15e0" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mw lc ld le mx lg lh li my lk ll lm ij bi translated"><strong class="kt ir">K 倍交叉验证</strong></p><p id="ba0d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">分层 K 折交叉验证</strong></p><p id="4a3b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">留一个交叉验证</strong></p><h2 id="9d89" class="mb mc iq bd md me mf dn mg mh mi dp mj la mk ml mm le mn mo mp li mq mr ms mt bi translated"><strong class="ak">让我们逐一了解每种类型</strong></h2><h2 id="daf2" class="mb mc iq bd md me mf dn mg mh mi dp mj la mk ml mm le mn mo mp li mq mr ms mt bi translated"><strong class="ak"> k 倍交叉验证:</strong></h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/717e2d1efd3f47a7cb449307b09eea1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rgba1BIOUys7wQcXcL4U5A.png"/></div></div></figure><p id="bcde" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">该过程有一个称为 k 的参数，它指的是给定数据样本要被分成的组的数量。因此，该程序通常被称为 k 倍交叉验证。当选择了 k 的特定值时，它可以用来代替模型引用中的 k，例如 k=10 成为 10 重交叉验证。</p><p id="cc4f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果 k=5，数据集将被分成 5 个相等的部分，下面的过程将运行 5 次，每次都使用不同的维持集。</p><p id="150f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">1.将该组作为维持或测试数据集</p><p id="5461" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">2.将剩余的组作为训练数据集</p><p id="406d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">3.在训练集上拟合模型，并在测试集上评估它</p><p id="c5c6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">4.保留评估分数并丢弃模型</p><p id="71bb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在上述过程的最后，使用模型评估分数的样本总结模型的技巧。</p><blockquote class="nh ni nj"><p id="9a54" class="kr ks na kt b ku kv jr kw kx ky ju kz nk lb lc ld nl lf lg lh nm lj lk ll lm ij bi translated"><strong class="kt ir">如何决定 k 的值？</strong></p><p id="e2d1" class="kr ks na kt b ku kv jr kw kx ky ju kz nk lb lc ld nl lf lg lh nm lj lk ll lm ij bi translated">选择 k 的值，使得数据样本的每个训练/测试组足够大，以在统计上代表更广泛的数据集。</p><p id="ac5a" class="kr ks na kt b ku kv jr kw kx ky ju kz nk lb lc ld nl lf lg lh nm lj lk ll lm ij bi translated">k=10 的值在应用机器学习领域是非常常见的，如果您很难为数据集选择一个值，建议您使用它。</p><p id="4584" class="kr ks na kt b ku kv jr kw kx ky ju kz nk lb lc ld nl lf lg lh nm lj lk ll lm ij bi translated">如果选择的 k 值没有平均分割数据样本，则一个组将包含剩余的示例。优选地，将数据样本分成 k 个具有相同样本数量的组，使得模型技能得分的样本全部相等。</p></blockquote><h2 id="a0f9" class="mb mc iq bd md me mf dn mg mh mi dp mj la mk ml mm le mn mo mp li mq mr ms mt bi translated"><strong class="ak">分层 k 折交叉验证:</strong></h2><p id="9f94" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mw lc ld le mx lg lh li my lk ll lm ij bi translated">与 K 倍交叉验证相同，只是略有不同</p><p id="964e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">将数据分割成多个折叠可以由标准来控制，例如确保每个折叠具有相同比例的具有给定分类值(例如类结果值)的观察值。这被称为分层交叉验证。</p><p id="7674" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在下图中，分层 k 倍验证是基于性别设置的，无论是男性还是女性</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/d7f19d44b6b9b713d356b6d655e51f12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D9OJZ-n0xh9d87i58WfMLQ.png"/></div></div><figcaption class="nc nd gj gh gi ne nf bd b be z dk">stratified k-fold cross validation</figcaption></figure><h2 id="5146" class="mb mc iq bd md me mf dn mg mh mi dp mj la mk ml mm le mn mo mp li mq mr ms mt bi translated"><strong class="ak">遗漏一个交叉验证(LOOCV): </strong></h2><p id="11d3" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mw lc ld le mx lg lh li my lk ll lm ij bi translated">这种方法在训练数据中留出 1 个数据点，即如果原始样本中有 n 个数据点，则 n-1 个样本用于训练模型，p 个点用作验证集。对原始样本可以这样分离的所有组合重复这一过程，然后对所有试验的误差进行平均，以给出总体有效性。</p><p id="65b2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">可能组合的数量等于原始样本中数据点的数量或 n。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/dbc2a809841102b8b164a1623925d679.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Oz6Hopj7ipJh0vtA2FE-FQ.png"/></div></div><figcaption class="nc nd gj gh gi ne nf bd b be z dk">representation of leave one out cross validation</figcaption></figure><p id="8911" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">交叉验证是评估模型有效性的一种非常有用的技术，尤其是在需要减轻过度拟合的情况下。</p><h2 id="023b" class="mb mc iq bd md me mf dn mg mh mi dp mj la mk ml mm le mn mo mp li mq mr ms mt bi translated"><strong class="ak">Python 中交叉验证的实现:</strong></h2><p id="c980" class="pw-post-body-paragraph kr ks iq kt b ku mu jr kw kx mv ju kz la mw lc ld le mx lg lh li my lk ll lm ij bi translated">在使用交叉验证时，我们不需要单独调用 fit 方法，cross_val_score 方法在对数据实施交叉验证时拟合数据本身。下面是使用 k-fold 交叉验证的示例。</p><pre class="kg kh ki kj gt np nq nr ns aw nt bi"><span id="9a14" class="mb mc iq nq b gy nu nv l nw nx"><em class="na">import pandas as pd<br/>import numpy as np<br/>from sklearn.metrics import accuracy_score, confusion_matrix<br/>from sklearn.ensemble import RandomForestClassifier<br/>from sklearn import svm<br/>from sklearn.model_selection import cross_val_score<br/>#read csv file</em></span><span id="b8fd" class="mb mc iq nq b gy ny nv l nw nx"><em class="na">data  =  pd.read_csv("D://RAhil//Kaggle//Data//Iris.csv")</em></span><span id="7c63" class="mb mc iq nq b gy ny nv l nw nx"><em class="na">#Create Dependent and Independent Datasets based on our Dependent #and Independent features</em></span><span id="47ef" class="mb mc iq nq b gy ny nv l nw nx"><em class="na">X  = data[['SepalLengthCm','SepalWidthCm','PetalLengthCm']]<br/>y= data['Species']</em></span><span id="4bf6" class="mb mc iq nq b gy ny nv l nw nx"><em class="na">model = svm.SVC()</em></span><span id="f9d8" class="mb mc iq nq b gy ny nv l nw nx"><em class="na">accuracy = cross_val_score(model, X, y, scoring='accuracy', cv = 10)<br/>print(accuracy)</em></span><span id="32ad" class="mb mc iq nq b gy ny nv l nw nx"><em class="na">#get the mean of each fold <br/>print("Accuracy of Model with Cross Validation is:",accuracy.mean() * 100)</em></span></pre><p id="14a4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">输出:</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/dbfbc1dde600be462984c26fa45654a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:954/format:webp/1*UeDMdU7IFzdoqnSfUy9cBA.png"/></div></figure><p id="e075" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">模型的精度是每个折叠精度的平均值。</p><p id="7448" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在本教程中，您发现了我们为什么需要使用交叉验证，对不同类型的交叉验证技术的温和介绍，以及用于评估机器学习模型技能的 k-fold 交叉验证过程的实际示例。</p><p id="e8c5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">具体来说，您学到了:</p><ul class=""><li id="beef" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated">交叉验证是一个用于避免过度拟合和评估模型对新数据的技能的过程。</li><li id="01f4" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">您可以使用一些常用策略来为数据集选择 k 值。</li><li id="d736" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">scikit-learn 中提供了交叉验证的常用变体，如分层和重复。</li></ul><p id="539f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果你喜欢这个博客，给它一些<strong class="kt ir"> <em class="na">掌声</em> </strong>和<strong class="kt ir"> <em class="na">与你的朋友分享</em> </strong>它，你可以在这里 找到更多有趣的文章<a class="ae oa" href="https://medium.com/search?q=Rahil%20Hussain%20Shaikh" rel="noopener"> <strong class="kt ir">，敬请关注更多有趣的机器学习技术和概念。</strong></a></p></div></div>    
</body>
</html>