<html>
<head>
<title>Bitcoin: What’s the Math?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">比特币:数学原理是什么？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/bitcoin-whats-the-math-ebbae3be37a3?source=collection_archive---------5-----------------------#2017-10-05">https://towardsdatascience.com/bitcoin-whats-the-math-ebbae3be37a3?source=collection_archive---------5-----------------------#2017-10-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/2d653c03e5e5c113c01586972fb4454c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RI3zQ160xDvpcT6d.jpg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Bitcoin- will it replace fiat currency? How does the math work? And where can I get one of those physical coins?</figcaption></figure><p id="fc7f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">大约 6 个月前，我偶然发现了比特币，这要感谢一位朋友，她自己开了一家使用区块链技术的公司。我以前听说过比特币——我的大致想法是“比特币是我哥哥在我高中时用来挖矿的虚拟货币。”像大多数人一样，除此之外我不知道太多。</p><p id="3008" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">真正引发我兴趣的是我意识到比特币和其他数字货币是密码学的一个伟大应用(因此得名“加密货币”)，这是一个我一直非常着迷的领域。对我来说，密码学是在现实世界中使用数学的完美方式。意识到这一点后，我决定研究比特币背后的数学原理。</p><p id="e0a3" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">尽管我读了无数的文章，包括最初的中本聪白皮书，我仍然努力寻找一个资源来回答这个基本问题:数学是什么？我能找到的最好的文章是讨论椭圆曲线加密和用于比特币的特定参数的文章。这并没有让我满意。</p><p id="847f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">按照朋友的建议，我拿到了一本安德里亚斯·安东诺普洛斯的《<a class="ae la" href="https://www.amazon.com/Mastering-Bitcoin-Programming-Open-Blockchain/dp/1491954388" rel="noopener ugc nofollow" target="_blank"> <em class="lb">《掌握比特币:编程开放区块链</em> </a>》。这本书对我来说真的把所有的东西都集合在一起了。我强烈推荐！</p><p id="93d3" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我希望这篇博文能从数学的角度帮助你理解比特币协议和比特币区块链。我首先假设你熟悉比特币，其次假设你有数学知识。对于那些不太熟悉的人，我会在下面留下解释数学主题的链接。</p><h2 id="5788" class="lc ld iq bd le lf lg dn lh li lj dp lk kn ll lm ln kr lo lp lq kv lr ls lt lu bi translated"><strong class="ak">区块链与挖掘</strong> : SHA256，Merkle Trees</h2><p id="2978" class="pw-post-body-paragraph kc kd iq ke b kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv lz kx ky kz ij bi translated">人们普遍认为采矿的目的是发行新的货币。实际上，挖掘就是对交易进行验证的过程。采矿允许对区块链的状态进行分散的全网络共识，这就是这项技术如此特殊的原因。发行新货币是诱因。</p><p id="b073" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">尽管货币发行是动机而不是目标，我们将从采矿和“创造”新 BTC(或 XBT)开始我们的讨论。从这里，我们将看看这种货币是如何“花费”的，以及其中涉及的数学。</p><p id="027a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">假设爱丽丝有一个挖掘节点，它实际上只是一个计算机程序。挖掘器的目标是构造一个新的块，并解决一个计算量很大的密码难题，使得这个新的块可以被网络接受，并被合并到区块链中。在解决这个密码难题后，爱丽丝的矿工将“获胜”并获得一笔支付(截至本文撰写时，目前为 12.5 BTC)，支付到她的比特币地址。Alice 还将收取新开采区块中所有交易的费用。</p><p id="8014" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">Alice 采矿的第一步是验证区块链的最新区块。让我们把这个最近的块称为 A。在验证了 A 中的事务后，Alice 的挖掘程序将为链中潜在的下一个块构造一个标题。我们称这个块为 b，新块的头有 6 个字段:版本、<em class="lb">前一块哈希</em>、<em class="lb"> Merkle 根</em>、时间戳、<em class="lb">目标</em>和<em class="lb">无</em>。这里有大量斜体的数学内容需要解开。</p><h2 id="157d" class="lc ld iq bd le lf lg dn lh li lj dp lk kn ll lm ln kr lo lp lq kv lr ls lt lu bi translated"><em class="ma">前一个块哈希:double-SHA256 </em></h2><p id="9703" class="pw-post-body-paragraph kc kd iq ke b kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv lz kx ky kz ij bi translated">如果 Alice 的 miner 想要查找区块链中的任何区块，有两种方法可以实现。第一种方法是参考块的高度。第二种方法是计算块 ID，其中块 ID = double-SHA256(块头)。块 ID 也是先前的块散列。例如，假设 A 的块 ID 是 A' = double-SHA256(blockIDA)。然后，对于扩展区块链的块 B，其字段“先前块散列”被设置为等于 A’。这将块链从块 A 扩展到块 B，块 B 是子块，而块 A 是父块。这也是爱丽丝的矿工如何使用其采矿权力来“投票”区块 A 作为链中最近的区块。</p><h2 id="1003" class="lc ld iq bd le lf lg dn lh li lj dp lk kn ll lm ln kr lo lp lq kv lr ls lt lu bi translated"><em class="ma"> Merkle root:一个概念本身，和 double-SHA256 </em></h2><p id="d95c" class="pw-post-body-paragraph kc kd iq ke b kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv lz kx ky kz ij bi translated">Merkle 根是 Merkle 树中的最终散列。简而言之，Merkle 树是一棵二叉树，其中每个父节点都是其子节点的散列。这是在比特币中通过递归计算 double-SHA256 对节点构建的，直到树中只有一个哈希，这就是 Merkle 根。以比特币为例，每个子代都包含交易信息，因此 Merkle 根在一个块中汇总所有交易。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/56cd65c4af0a372fe6ba7c725c327dca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/0*Ru71cC9nCJ9_f1nb.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">A simple figure of creating a Merkle Root. The hash function H is double-SHA256, with the transactions (T) as the inputs. Thanks Paint for helping me make this beautiful figure!</figcaption></figure><h2 id="2e45" class="lc ld iq bd le lf lg dn lh li lj dp lk kn ll lm ln kr lo lp lq kv lr ls lt lu bi translated"><em class="ma">目标和随机数</em></h2><p id="c098" class="pw-post-body-paragraph kc kd iq ke b kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv lz kx ky kz ij bi translated">目标是所有挖掘节点共享的 256 位数字。挖掘的目标是找到一个 nonce(一个从 0 开始的一次性使用数)，使得头和 nonce 的散列(SHA256)一起小于或等于目标。目标每 2016 块更新一次。</p><p id="5e33" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">继续我们的示例，Alice 的 miner 想要包括区块链中的新区块 B。目标是找到一个随机数，使得:</p><p id="c6e7" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">sha 256(B+nonce 的报头)&lt; = target。</p><p id="1fd5" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">找到这个 nonce 的计算量非常大，但是由于这个 hash 函数的性质，很容易验证。找到这个随机数就证明了一个矿工完成了要求的工作量，也就是“工作量证明”一旦发现 nonce，Alice 的 miner 就会将 B 的信息传播到整个比特币网络。一旦足够多的矿工验证了包括在 B 中的交易是真实的，那么 B 是链中的下一个块，并且爱丽丝将把她的 12.5 BTC 的支付加上交易费收集到她的钱包中。网络中的所有矿工，包括 Alice 的矿工，然后将构造新的块 C，其中先前的块散列字段引用 b 的 ID。</p><p id="8521" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">关于工作证明的一个注意事项:重要的是密码难题(即找到一个小于目标值的散列值)必须是计算开销很大的。如果不是，那么一个拥有相当于 51%网络计算能力的不诚实的人可以重写交易以支付到他们自己的钱包，然后将这个块包括在链中。(然而，随着这一开支的增长，它就成了问题，这是另一篇文章的主题。有新的协议试图解决这个问题！)</p><p id="0af9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在我们在爱丽丝的钱包里有 12.5 BTC。接下来我们将看看她是如何花费的，这里涉及到数学。</p><h2 id="55b9" class="lc ld iq bd le lf lg dn lh li lj dp lk kn ll lm ln kr lo lp lq kv lr ls lt lu bi translated">总结这一部分，数学是:</h2><ul class=""><li id="70ac" class="mg mh iq ke b kf lv kj lw kn mi kr mj kv mk kz ml mm mn mo bi translated">Double-SHA256(块头)创建块 A 的 ID，它将位于新块 B 的前一个块哈希字段中，其中 B 是 A 的子块。</li><li id="34ca" class="mg mh iq ke b kf mp kj mq kn mr kr ms kv mt kz ml mm mn mo bi translated">Merkle 树并递归地执行 double-SHA256 来创建汇总块中所有事务的 Merkle 根。</li><li id="e50e" class="mg mh iq ke b kf mp kj mq kn mr kr ms kv mt kz ml mm mn mo bi translated">块头和 nonce 的 SHA256，以执行验证块中所有事务所需的工作证明，并找到小于或等于目标的散列。一旦发现该随机数，该块将被包括在区块链中。</li></ul><h2 id="8d98" class="lc ld iq bd le lf lg dn lh li lj dp lk kn ll lm ln kr lo lp lq kv lr ls lt lu bi translated"><strong class="ak">交易和钱包</strong> : ECDSA，RIPEMD160，SHA256</h2><p id="d224" class="pw-post-body-paragraph kc kd iq ke b kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv lz kx ky kz ij bi translated">比特币使用公钥加密技术进行交易，特别是基于离散对数问题的椭圆曲线数字签名算法(ECDSA)。</p><h2 id="7626" class="lc ld iq bd le lf lg dn lh li lj dp lk kn ll lm ln kr lo lp lq kv lr ls lt lu bi translated"><em class="ma">钱包:像钥匙扣</em></h2><p id="9fa1" class="pw-post-body-paragraph kc kd iq ke b kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv lz kx ky kz ij bi translated">比特币钱包并不包含真正的比特币。相反，它包含指向公共分类账(区块链)上的交易输出的键。只有拥有相应私钥的人才能“消费”与接收者钱包地址相关的比特币。</p><h2 id="118f" class="lc ld iq bd le lf lg dn lh li lj dp lk kn ll lm ln kr lo lp lq kv lr ls lt lu bi translated"><em class="ma">交易:认证</em></h2><p id="0abc" class="pw-post-body-paragraph kc kd iq ke b kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv lz kx ky kz ij bi translated">让我们继续我们的例子。假设爱丽丝想给她的朋友鲍勃发送 1 BTC。Alice 将使用她的钱包构建一个交易，将这 1 个 BTC 发送到 Bob 的公共钱包地址。这个交易就是信息。Alice 将使用她的签名(r，s)对消息进行签名，以提供真实性，并且这将被传播到网络。任何对等体都可以通过使用 Alice 的公钥来验证她的身份，该公钥与她的钱包地址相关联。换句话说，该过程如下:</p><p id="cfa2" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">设 D =爱丽丝的私钥，E =爱丽丝的公钥，M =事务。<br/> 1。Alice 的 wallet 构造了 M，它向 Bob 的公共地址发送了 1 个 BTC。<br/> 2。爱丽丝用符号 M 表示出 M' = D(M)。<br/> 3。任何对等体都可以通过执行 E(M') = M 来验证 Alice 的真实性。</p><p id="bd9d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在鲍勃怎么花掉爱丽丝给的这 1 个比特币呢？当 Alice 构造 M 时，她实际上是在构造一条消息，该消息说“我将把 1 BTC 给拥有对应于这个公共地址(在本例中是 Bob 的地址)的私钥的任何人。”为了让 Bob 花掉这笔钱，他的钱包将构建一个新的交易，他将用他的签名(r’，s’)来签名，该签名是从只有他有权访问的私钥(根据椭圆曲线加密)中导出的，并且该过程继续。</p><p id="1e44" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">比特币所做的是使用 ECDSA 来授予发送者真实性，这种认证是“花费”比特币所需要的。比特币交易不需要加密，因为每笔交易都传播到网络，并指定接收者的公共地址，这是匿名的。</p><h2 id="9b88" class="lc ld iq bd le lf lg dn lh li lj dp lk kn ll lm ln kr lo lp lq kv lr ls lt lu bi translated"><em class="ma">创建比特币地址</em></h2><p id="1f60" class="pw-post-body-paragraph kc kd iq ke b kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv lz kx ky kz ij bi translated">按照椭圆曲线加密法，公钥是从私钥生成的，而比特币地址是从这个公钥创建的。</p><p id="ddc6" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">私钥 k 在[1，n-1]的范围内，其中 n 是椭圆曲线的阶。比特币协议中使用的特定椭圆曲线是 secp256k1，它指定了椭圆曲线的系数以及生成器 g。创建比特币地址的步骤如下:</p><p id="10b1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">1.私钥 k 是随机生成的。<br/> 2。公钥 K = k * G，其中 G 是生成器。<br/> 3。钱包地址 A = RIPEMD160(SHA256(K))。<br/> 4。地址 A 是 Base58Check 编码的，以产生' =前缀|| A ||校验和，这是最终的钱包地址(“||”表示串联)。</p><p id="f2ce" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">Base58Check 是 Base58 和校验和的组合，Base58 是一组字符{大写，小写，数字} \ {0，O，I，l}。特定校验和是 double-SHA256 输出的前 4 个字节(前缀+ A)，在这种情况下前缀为 0。最终的 Base58Check 编码地址 A' =前缀|| A ||校验和。</p><figure class="mc md me mf gt jr gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/5bc67473b25d23f959cc41cad740a0fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/format:webp/0*KdTMeKoRy9GptUJt.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">The elliptic curve with the parameters of secp256k1, over the real numbers. Yay math!</figcaption></figure><h2 id="be39" class="lc ld iq bd le lf lg dn lh li lj dp lk kn ll lm ln kr lo lp lq kv lr ls lt lu bi translated">总之，这部分的数学公式是:</h2><ul class=""><li id="587e" class="mg mh iq ke b kf lv kj lw kn mi kr mj kv mk kz ml mm mn mo bi translated">ECDSA 来“花”比特币，签名为(r，s)。</li><li id="b214" class="mg mh iq ke b kf mp kj mq kn mr kr ms kv mt kz ml mm mn mo bi translated">椭圆曲线加密从私钥 K 生成公钥 K。</li><li id="7665" class="mg mh iq ke b kf mp kj mq kn mr kr ms kv mt kz ml mm mn mo bi translated">RIPEMD160 和 SHA256 一起被称为 HASH160，并使用 Base58Check 编码从公钥 k 中产生一个比特币钱包地址。</li></ul><h2 id="33e7" class="lc ld iq bd le lf lg dn lh li lj dp lk kn ll lm ln kr lo lp lq kv lr ls lt lu bi translated"><strong class="ak">结论</strong></h2><p id="d46f" class="pw-post-body-paragraph kc kd iq ke b kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv lz kx ky kz ij bi translated">当我第一次开始钻研比特币的数学时，我只知道它在某些方面使用了椭圆曲线加密。我不知道如何使用 ECC 是在交易中，发行货币，还是什么？最后，我清楚地了解了数学是如何被用来让比特币和区块链成为如此强大的颠覆性技术的。</p><p id="f3d2" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">Math 用于验证交易(挖掘)、进行交易，以及创建向其发送交易的钱包地址。双 SHA256 用于识别区块并将交易汇总到 Merkle 根中，单 SHA256 用于证明采矿期间的工作。ECDSA 用于“签署”交易。RIPEMD160 和 SHA256 与 Base58Check 编码一起用于创建钱包地址。现在一切都说得通了！</p><h2 id="30bc" class="lc ld iq bd le lf lg dn lh li lj dp lk kn ll lm ln kr lo lp lq kv lr ls lt lu bi translated"><strong class="ak">资源</strong></h2><p id="c3c3" class="pw-post-body-paragraph kc kd iq ke b kf lv kh ki kj lw kl km kn lx kp kq kr ly kt ku kv lz kx ky kz ij bi translated">对于那些想了解更多细节的人，无论是第一次，还是只想回忆一下:</p><p id="1b28" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">维基百科和比特币维基:</p><p id="84e5" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">公钥密码学:【https://en.wikipedia.org/wiki/Public-key_cryptography<br/>椭圆曲线密码学:<a class="ae la" href="https://en.wikipedia.org/wiki/Elliptic-curve_cryptography" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Elliptic-curve_cryptography</a><br/>椭圆曲线数字签名算法:<a class="ae la" href="https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm" rel="noopener ugc nofollow" target="_blank">https://en . Wikipedia . org/wiki/Elliptic _ Curve _ Digital _ Signature _ Algorithm</a>(在我看来比 bitcoinwiki 页面好多了)<br/>secp 256k 1:<a class="ae la" href="https://en.bitcoin.it/wiki/Secp256k1" rel="noopener ugc nofollow" target="_blank">https://en.bitcoin.it/wiki/Secp256k1<br/></a>sha 256:<a class="ae la" href="https://en.wikipedia.org/wiki/SHA-2" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/SHA-2</a><br/>ripe md160:<a class="ae la" href="https://en.wikipedia.org/wiki/RIPEMD" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/RIPEMD</a><a class="ae la" href="https://en.wikipedia.org/wiki/RIPEMD" rel="noopener ugc nofollow" target="_blank"/></p><p id="33cd" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">书籍:</p><p id="b0e9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">威廉·斯塔林斯的《密码学与网络安全》:一本非常棒的密码学书籍。我把它推荐给任何有兴趣钻研数学的人。它甚至提供了数论的介绍，所以如果你是第一次学习这类东西，这是很棒的。<br/> <a class="ae la" href="https://www.amazon.com/Mastering-Bitcoin-Programming-Open-Blockchain/dp/1491954388" rel="noopener ugc nofollow" target="_blank">安德烈亚斯·安东诺普洛斯《掌握比特币》</a>:必读！</p></div><div class="ab cl mv mw hu mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="ij ik il im in"><p id="712c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><em class="lb">最初发表在我的个人网站上，</em><a class="ae la" href="http://serena.mcdonnell.ca" rel="noopener ugc nofollow" target="_blank"><em class="lb">Serena . MC donnell . ca .</em></a></p></div></div>    
</body>
</html>