<html>
<head>
<title>Warm Starting Bayesian Optimization</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">热启动贝叶斯优化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/warm-starting-bayesian-optimization-674312bfcd7?source=collection_archive---------16-----------------------#2018-10-15">https://towardsdatascience.com/warm-starting-bayesian-optimization-674312bfcd7?source=collection_archive---------16-----------------------#2018-10-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="f452" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每当在新数据集上训练机器学习模型时，都需要超参数调整。然而，它经常被放弃，因为它缺乏一个理论框架，我以前曾试图在这里解开:</p><div class="kl km gp gr kn ko"><a rel="noopener follow" target="_blank" href="/demystifying-hyper-parameter-tuning-acb83af0258f"><div class="kp ab fo"><div class="kq ab kr cl cj ks"><h2 class="bd ir gy z fp kt fr fs ku fu fw ip bi translated">揭开超参数调谐的神秘面纱</h2><div class="kv l"><h3 class="bd b gy z fp kt fr fs ku fu fw dk translated">它是什么，为什么是自然的</h3></div><div class="kw l"><p class="bd b dl z fp kt fr fs ku fu fw dk translated">towardsdatascience.com</p></div></div><div class="kx l"><div class="ky l kz la lb kx lc ld ko"/></div></div></a></div><p id="4690" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一种将智能和高效的超参数调整系统化的方法是<a class="ae le" rel="noopener" target="_blank" href="/the-intuitions-behind-bayesian-optimization-with-gaussian-processes-7e00fcc898a0">贝叶斯优化</a>,它构建了可调整问题的概率代理，以推荐最佳参数。它通过在每次迭代后更新代理来逐步建立对问题的理解。下图说明了由<a class="ae le" href="https://mindfoundry.ai/optaas" rel="noopener ugc nofollow" target="_blank"> OPTaaS </a>生成的代理模型的演变，以最小化<a class="ae le" href="https://www.sfu.ca/~ssurjano/beale.html" rel="noopener ugc nofollow" target="_blank"> Beale 函数</a>。</p><div class="lf lg lh li gt ab cb"><figure class="lj lk ll lm ln lo lp paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><img src="../Images/91a01934a93d3262e239dd691c5abdb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*VT0vO_QgmN21o7-eH1naXg.png"/></div></figure><figure class="lj lk lv lm ln lo lp paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><img src="../Images/30ef188a645cc27fbc4ec5585f72a920.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*Ga71ewUJfigGCGJ8iwFXsA.png"/></div></figure></div><figure class="lf lg lh li gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi lw"><img src="../Images/93f4720a6295f4a9e3ac525cdfa00dd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_HDiA9zAV9a51ajX6-p1zA.png"/></div></div><figcaption class="lx ly gj gh gi lz ma bd b be z dk">Evolution of the surrogate model generated for mimizing the Beale function</figcaption></figure><p id="afe0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如我们在第一个图(5 次迭代)中看到的，贝叶斯优化面临冷启动问题，因为先验最初是平坦的，需要在提供“有意义的”建议之前建立底层函数的表示。经过 35 次迭代，对 Beale 函数有了更好的理解；代孕妈妈看起来很像。在本文中，我们将看到热启动代理模型如何显著提高性能。</p><h2 id="0c1f" class="mb mc iq bd md me mf dn mg mh mi dp mj jy mk ml mm kc mn mo mp kg mq mr ms mt bi translated">为什么要暖启动？</h2><p id="ad45" class="pw-post-body-paragraph jn jo iq jp b jq mu js jt ju mv jw jx jy mw ka kb kc mx ke kf kg my ki kj kk ij bi translated">从前面的示例中，我们了解到，如果贝叶斯优化器有一些关于函数或其类型的整体形状的先验信息，那么在早期的推荐可能会更好，因为它不需要花费太多的时间来初始化代理。</p><p id="7387" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">此外，在超参数调整的背景下，机器学习模型的某些超参数配置可能是合法的，但在实践中没有意义。例如，具有少量树的随机森林将具有较低的准确性，因此可能不值得在这样的区域中探索超参数配置，而不管它正在被训练的基础数据集如何。</p><h2 id="6e89" class="mb mc iq bd md me mf dn mg mh mi dp mj jy mk ml mm kc mn mo mp kg mq mr ms mt bi translated">随机森林的热启动</h2><p id="e897" class="pw-post-body-paragraph jn jo iq jp b jq mu js jt ju mv jw jx jy mw ka kb kc mx ke kf kg my ki kj kk ij bi translated">我们将研究随机森林的热启动贝叶斯优化的性能改进。通过对许多数据集和具有不同超参数配置的随机森林进行搜索，我们能够了解随机森林的性能如何随每个超参数平均变化。</p><p id="b599" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">利用这些测试中的知识，我们可以指导优化器在模型历史上表现良好的区域进行搜索，避免尝试历史上较差的配置，例如使用少量的树。</p><h2 id="f5af" class="mb mc iq bd md me mf dn mg mh mi dp mj jy mk ml mm kc mn mo mp kg mq mr ms mt bi translated">结果</h2><p id="bcd3" class="pw-post-body-paragraph jn jo iq jp b jq mu js jt ju mv jw jx jy mw ka kb kc mx ke kf kg my ki kj kk ij bi translated">为了进行性能比较，我们将使用<a class="ae le" href="https://optaas.mindfoundry.ai" rel="noopener ugc nofollow" target="_blank"> OPTaaS </a>，这是一种通用贝叶斯优化器，我们将在全新的数据集上将它与热启动版本进行比较。我们对 30 个全新的数据集进行了测试，下面的图显示了在<a class="ae le" href="https://archive.ics.uci.edu/ml/machine-learning-databases/cmc/cmc.data" rel="noopener ugc nofollow" target="_blank"> CMC </a>数据集、<a class="ae le" href="https://archive.ics.uci.edu/ml/datasets/statlog+(german+credit+data)" rel="noopener ugc nofollow" target="_blank">德国信用</a>数据集和<a class="ae le" href="http://archive.ics.uci.edu/ml/datasets/connectionist+bench+(sonar,+mines+vs.+rocks)" rel="noopener ugc nofollow" target="_blank">声纳</a>数据集上的结果。</p><figure class="lf lg lh li gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi mz"><img src="../Images/2bff6a9c265c26ef1937136272da52f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SRHS2vCFxV7Nzh7_19jjXw.png"/></div></div><figcaption class="lx ly gj gh gi lz ma bd b be z dk">Warm (green) vs Cold (blue) started OPTaaS for training a RF on the <a class="ae le" href="https://archive.ics.uci.edu/ml/machine-learning-databases/cmc/cmc.data" rel="noopener ugc nofollow" target="_blank">CMC</a> data set</figcaption></figure><figure class="lf lg lh li gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi mz"><img src="../Images/a47d5edef2afe776eea0c50ef7baa011.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PeNqEeMX1uL9PUaZ-0AM9A.png"/></div></div><figcaption class="lx ly gj gh gi lz ma bd b be z dk">Warm (green) vs Cold (blue) started OPTaaS for training a RF on the <a class="ae le" href="https://archive.ics.uci.edu/ml/datasets/statlog+(german+credit+data)" rel="noopener ugc nofollow" target="_blank">German credit</a> data</figcaption></figure><figure class="lf lg lh li gt lk gh gi paragraph-image"><div role="button" tabindex="0" class="lq lr di ls bf lt"><div class="gh gi na"><img src="../Images/a0514176b59411e5e9a5e76cb2a98b05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jH1kn5p6O8ayZgduPm2GgA.png"/></div></div><figcaption class="lx ly gj gh gi lz ma bd b be z dk">Warm (green) vs Cold (blue) started OPTaaS for training a RF on the <a class="ae le" href="http://archive.ics.uci.edu/ml/datasets/connectionist+bench+(sonar,+mines+vs.+rocks)" rel="noopener ugc nofollow" target="_blank">Sonar</a> data</figcaption></figure><p id="ea62" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如我们所见，热启动<a class="ae le" href="https://optaas.mindfoundry.ai" rel="noopener ugc nofollow" target="_blank"> OPTaaS </a>有助于识别更好的超参数配置，比冷启动版本快得多。后者确实赶上了(令人放心),但是需要更多的迭代来建立对底层问题的理解。可以理解的是，需要采取预防措施来确保热启动配置不会过度适应训练数据集，以保证普遍的性能改进。</p><p id="4777" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">【<strong class="jp ir">更新</strong>:我开了一家科技公司。您可以在此了解更多<a class="ae le" href="https://medium.com/legislate/eliminate-the-work-in-paperwork-c053bfb0188c" rel="noopener"/></p><h2 id="7218" class="mb mc iq bd md me mf dn mg mh mi dp mj jy mk ml mm kc mn mo mp kg mq mr ms mt bi translated">扩展ˌ扩张</h2><p id="1f58" class="pw-post-body-paragraph jn jo iq jp b jq mu js jt ju mv jw jx jy mw ka kb kc mx ke kf kg my ki kj kk ij bi translated">热启动代理通过提供首先尝试的“合理”配置，在初始迭代中表现出竞争优势。然而，在初始迭代之后，有许多扩展可以帮助提高性能。我将在下一篇文章中详细介绍它们。</p><p id="70e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">同时，如果您有任何问题或者是否想尝试<a class="ae le" href="https://optaas.mindfoundry.ai" rel="noopener ugc nofollow" target="_blank">optas</a>，请不要犹豫<a class="ae le" href="http://Charles.brecque@mindfoundry.ai" rel="noopener ugc nofollow" target="_blank">联系</a>。</p></div></div>    
</body>
</html>