<html>
<head>
<title>Experimenting with twitter data using Tensorflow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Tensorflow 试验 twitter 数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/experimenting-with-twitter-data-using-tensorflow-ea88a8078fd?source=collection_archive---------7-----------------------#2018-10-02">https://towardsdatascience.com/experimenting-with-twitter-data-using-tensorflow-ea88a8078fd?source=collection_archive---------7-----------------------#2018-10-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/304b51e775a4131252e6a6c0ae3ee959.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t3x2jxF_ZWsRiibszGWZYQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Credits — author : Diogo Palhais; illustrator : Tatuna Gverdtsiteli</figcaption></figure><p id="a457" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi la translated">机器学习和人工智能最吸引人的地方在于，通过使用它们，它让我们有可能开始重新思考一切——你可以从完全不同的角度看待一切，我认为，有时这种“重新思考”的事实是新发明的关键。</p><p id="2a18" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">几天前我有过这样的时刻，这真的很有趣，我决定写下这个实验。</p><p id="1f2d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我大约在 7 年前创建了我的 twitter 账户，但我并没有经常使用它，几个月后，我将它与我的一个网站连接起来，并在上面安装了“自动转发”机器人。在这之后，很多事情都变了，我没有时间建立我的网站，我删除了这个机器人，因为我并不真正喜欢社交网络——我的 twitter 账户已经暂停了几年。</p><p id="843d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">几个月前，我决定开始使用 Twitter。我想和其他人分享我的出版物，我的公开回购(或者不仅仅是我的)——所以这就是我决定重新加入 Twitter 的原因，但是当然，根据我的账户过去的活动，我有兴趣完全不同的追随者。所以，老实说，这对我的动力影响很大。</p><p id="2f73" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我决定寻找这样的用户——我也会对他们感兴趣。</p><p id="b28c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">起初，当你在 Twitter 上开始活动时，你没有太多的帖子(当然我删除了:D 的旧帖子)和关注者——你关注的人不会关注你的可能性很大，你需要长时间添加真正有趣的帖子，以尽可能最好地展示自己。</p><p id="833e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们已经提到了“添加关注者”，所以在我开始写这个故事的主要部分之前，我想分享一下 Twitter 的规则和限制，因为在 Twitter 上对不道德行为的处罚是非常严重的。</p><p id="0d40" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">以下是一些重要的链接:</p><div class="lj lk gp gr ll lm"><a href="https://help.twitter.com/en/rules-and-policies/twitter-following-rules" rel="noopener  ugc nofollow" target="_blank"><div class="ln ab fo"><div class="lo ab lp cl cj lq"><h2 class="bd ir gy z fp lr fr fs ls fu fw ip bi translated">以下限制常见问题</h2><div class="lt l"><h3 class="bd b gy z fp lr fr fs ls fu fw dk translated">要了解更多关于以下内容，请阅读以下常见问题。我们不限制您可以拥有的关注者数量…</h3></div><div class="lu l"><p class="bd b dl z fp lr fr fs ls fu fw dk translated">help.twitter.com</p></div></div><div class="lv l"><div class="lw l lx ly lz lv ma jw lm"/></div></div></a></div><div class="lj lk gp gr ll lm"><a href="https://help.twitter.com/en/rules-and-policies/twitter-automation" rel="noopener  ugc nofollow" target="_blank"><div class="ln ab fo"><div class="lo ab lp cl cj lq"><h2 class="bd ir gy z fp lr fr fs ls fu fw ip bi translated">自动化规则</h2><div class="lt l"><h3 class="bd b gy z fp lr fr fs ls fu fw dk translated">此页面主要面向开发人员。对于 Twitter 用户:你最终要对所采取的行动负责…</h3></div><div class="lu l"><p class="bd b dl z fp lr fr fs ls fu fw dk translated">help.twitter.com</p></div></div><div class="lv l"><div class="mb l lx ly lz lv ma jw lm"/></div></div></a></div></div><div class="ab cl mc md hu me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ij ik il im in"><p id="b2e0" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi la translated"><span class="l lb lc ld bm le lf lg lh li di"> S </span> o，我们的目标是根据 Twitter 的用户数据(我们稍后会生成)建立分类模型，预测用户未来的行为——当我们向他/她发出追随请求时，这个用户是否会追随我们。所以，简而言之——这应该有助于我们找到未来会追随我们的人。</p><p id="63d2" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">起初，我需要 Python 包，因为直接与 Twitter api 通信不是一个好主意，而且需要更多的时间，所以正如我们所知，Python 是“包含电池”的，我很容易就找到了一个很好的包，它具有我在这个项目中需要的所有功能，更重要的是，它还有很好的文档。</p><p id="633a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">以下是链接:</p><div class="lj lk gp gr ll lm"><a href="https://python-twitter.readthedocs.io/en/latest/index.html" rel="noopener  ugc nofollow" target="_blank"><div class="ln ab fo"><div class="lo ab lp cl cj lq"><h2 class="bd ir gy z fp lr fr fs ls fu fw ip bi translated">欢迎阅读 python-twitter 的文档！- python-twitter 3.4.2 文档</h2><div class="lt l"><h3 class="bd b gy z fp lr fr fs ls fu fw dk translated">编辑描述</h3></div><div class="lu l"><p class="bd b dl z fp lr fr fs ls fu fw dk translated">python-twitter.readthedocs.io</p></div></div></div></a></div><p id="5f83" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">要使用这个包，首先我们需要使用 pip 安装它。</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="ed41" class="ms mt iq mo b gy mu mv l mw mx">$ pip install python-twitter</span></pre><p id="75c3" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在这之后，我们需要来自 Twitter 的 api 凭证，您可以很容易地从这里获得:</p><div class="lj lk gp gr ll lm"><a href="https://developer.twitter.com/" rel="noopener  ugc nofollow" target="_blank"><div class="ln ab fo"><div class="lo ab lp cl cj lq"><h2 class="bd ir gy z fp lr fr fs ls fu fw ip bi translated">Twitter 开发者平台</h2><div class="lt l"><h3 class="bd b gy z fp lr fr fs ls fu fw dk translated">Twitter 是世界上企业和个人联系的最佳场所。自从早期的 Twitter 人…</h3></div><div class="lu l"><p class="bd b dl z fp lr fr fs ls fu fw dk translated">developer.twitter.com</p></div></div></div></a></div><p id="aaa7" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果看起来有点混乱，您可以通过截图查看详细说明:</p><div class="lj lk gp gr ll lm"><a href="https://python-twitter.readthedocs.io/en/latest/getting_started.html" rel="noopener  ugc nofollow" target="_blank"><div class="ln ab fo"><div class="lo ab lp cl cj lq"><h2 class="bd ir gy z fp lr fr fs ls fu fw ip bi translated">入门- python-twitter 3.4.2 文档</h2><div class="lt l"><h3 class="bd b gy z fp lr fr fs ls fu fw dk translated">如果那个页面上的信息有任何问题，Twitter 会投诉，你可以修复。(确保…</h3></div><div class="lu l"><p class="bd b dl z fp lr fr fs ls fu fw dk translated">python-twitter.readthedocs.io</p></div></div></div></a></div><p id="021d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">好了，现在我们可以成功地连接 Twitter api 了:</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="my mz l"/></div></figure></div><div class="ab cl mc md hu me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ij ik il im in"><p id="6910" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi la translated">现在是开始数据挖掘的时候了。我们需要收集足够的数据来训练我们的模型，这里有两个选项来获得它:<em class="na">第一个</em>，这更难，我这样做是因为我没有任何选择——我们应该尝试关注有趣的人，并保存他们是否关注我们，以及<em class="na">第二个</em>选项——对于那些已经有足够多朋友和追随者的人来说——你可以使用这些数据来训练你的模型。</p><p id="b661" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在我的情况下，第二个选择行不通，我不得不选择更难的一个。因此，对于第一个场景，我需要在 Twitter 上找到受欢迎的人，他们大多发布关于编程/机器学习的帖子，因为他们的粉丝对我来说也非常好，所以我开始收集关于这类用户的数据。</p><p id="9695" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">首先，我选择“一个 Twitter 摇滚明星”用户，他总是发布关于编程或 ml 的帖子，然后获得他/她的追随者列表:</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="80b0" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在那之后，我试着得到关于他们每一个人的详细信息。我正在使用的软件包会为每个用户返回这样的数据:</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/8fe0a0b088d33d14157aadfda90d8e45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*jPAM9EaQCWv5Tx7k6OUlqg.png"/></div></figure><p id="369d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这里是非常有趣的信息，我可以用它来训练我的模型，但是我不想关注他们中的每一个人，我只想关注那些和我有相同兴趣并且有一些活动的人(见第 28 行)。</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="b66f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">尽管事实上，Twitter api 和我们的软件包都让我们有可能非常容易地关注用户:</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="165c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">尽管如此，你必须小心，这样你的行为才不会看起来像垃圾邮件或者违反 Twitter 规则。</p><p id="9368" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">所以，如你所见，我用简单的“如果条件”来过滤那些不活跃或者没有足够多朋友的人。因为我想保存最大限度过滤的数据。</p><p id="2601" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我决定在关系数据库中保存关于用户的信息，我使用 Sqlite 作为数据库，因为它对我们来说绝对足够了，我不想浪费时间在这种事情上。此外，在应用程序端，我只使用<a class="ae nc" href="https://docs.python.org/2/library/sqlite3.html" rel="noopener ugc nofollow" target="_blank"> sqlite3 </a>包来连接数据库，没有任何<code class="fe nd ne nf mo b">orm</code>，我希望它尽可能简单。</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="6bee" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">对于第二个场景，我们使用几乎相同的代码，但不是从其他用户的关注者那里获取数据，而是获取关于我们的关注者和关注者的数据，并将所有这些信息保存在我们的表中。</p><p id="129a" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">首先，我们获得关于我们的追随者和追随者的信息:</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="deb6" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">最后，我们将所有内容保存到表中，就像前面的例子一样。</p><p id="dbf9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">所以，我已经有了我需要的信息。</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ng"><img src="../Images/d4d3fdf92d284863bd86eae160af3f82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*niN1F_VGDNt2XqWTZHNJbQ.png"/></div></div></figure></div><div class="ab cl mc md hu me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ij ik il im in"><p id="7270" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi la translated">我想开始训练我的模型，为此，我需要为它选择特征。我们已经看到了 Twitter api 的结果。我决定只用其中的几个来训练我的模型:<code class="fe nd ne nf mo b">created_at</code>、<code class="fe nd ne nf mo b">favourites_count</code>、<code class="fe nd ne nf mo b">friends_count</code>、<code class="fe nd ne nf mo b">friends_count</code>、<code class="fe nd ne nf mo b">statuses_count.</code></p><p id="ebd7" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">虽然，我对培训过程并不满意，但我认为很容易猜到原因:仅根据这些数据很难猜测一个用户是否仍然活跃地使用 Twitter 帐户，也许他/她有很多帖子，但都是 1 年前发布的，所以我决定从功能列表中删除列<code class="fe nd ne nf mo b">created_at</code>和<code class="fe nd ne nf mo b">statuses_count</code>，代之以添加关于最后发布日期的信息。</p><p id="0e81" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">您可以通过以下方式获取相关信息:</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="e53c" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我决定将这个字符串转换成整数格式，并保存这个用户上一次发 tweet 之后已经过了多少天。我为它写了一个小函数:</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="3939" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我已经可以在主循环中使用这个函数了:</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="bbec" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">为您的模型收集数据并不是一件容易的工作，它需要最少几天，有时超过几周，所以在那些日子里，用户发生了很多变化，他们的数据已经保存在我们的数据库中，所以我编写了代码，使我的数据总是最新的(例如:朋友列表、关注者列表等)，我可以在开始创建我的模型之前运行这些代码。</p><p id="c610" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">最后，我的数据是这样的:</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nh"><img src="../Images/03596a0785f2d463b1033c35ef1d8757.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ciTjDFOStImZUhqu_mop0w.png"/></div></div></figure><p id="be27" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我不知道你使用哪个 ide 或编辑器，我几乎总是选择 Intellij 产品，在这种情况下我使用 Pycharm。我也使用相同的 ide 来连接 sqlitedb，它让我们可以很容易地将数据转换成 csv 格式。</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/ee6349475d37711e157790904c18fc84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N57QKaxHgn2vqfTCmlqUfw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">I check that I want header as a first row.</figcaption></figure></div><div class="ab cl mc md hu me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ij ik il im in"><h1 id="f635" class="nj mt iq bd nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of bi translated">训练、评估、预测</h1><p id="6661" class="pw-post-body-paragraph kc kd iq ke b kf og kh ki kj oh kl km kn oi kp kq kr oj kt ku kv ok kx ky kz ij bi la translated">现在是最有趣的部分。最后一步，我们可以使用<a class="ae nc" href="https://colab.research.google.com/" rel="noopener ugc nofollow" target="_blank"> Google Colab </a>，我认为这是最有用的 Google 产品之一。</p><p id="a022" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">首先，我正在导入必要的包。</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="8435" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">接下来，我们需要上传我们的 csv 文件，当你使用 Colab 时，这真的很容易，你只需要 2 行代码，然后是验证码。</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="e710" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">上传文件后，我们可以用 Panda 打开它，看看它是什么样子。</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ol"><img src="../Images/e48f8bc741fadd1801bbad90a45ac9de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CEN7aW0xI9ARqvaJe619Ug.png"/></div></div></figure><p id="f5e0" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">也许你已经知道，在 Twitter 上存在私人账户，这意味着，在他们允许之前，你不能看到用户的帖子。因此，在这种情况下，你看不到用户的最后一篇文章。在我看来，特性<code class="fe nd ne nf mo b">days_after_last_post</code>真的很重要，我决定不使用用户进行训练，他们不会给出关于这些数据的信息。我们可以像这样在 sql 中添加这个过滤器:</p><pre class="mj mk ml mm gt mn mo mp mq aw mr bi"><span id="2a10" class="ms mt iq mo b gy mu mv l mw mx">select ud.* from users_data ud where ud.days_after_last_post is not null;</span></pre><p id="7b3e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">或者你可以在这里过滤，在 Colab。</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="3a8e" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们还可以使用 panda 查看我们有多少关注者:</p><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi om"><img src="../Images/dd42550eaffcac67ea750a9252c6f73c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1DMkMUb9dfUrVa5asfeubA.png"/></div></div></figure><p id="26a5" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在，我们可以为我们的特征和标签创建变量:</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="9261" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">当我们已经有了我们的特性和目标时，为了方便起见，我们将使用 Scikit-learn 来拆分数据。Scikit-learn 有一个<code class="fe nd ne nf mo b">train_test_split</code>函数，用于将熊猫的数据帧分割成一个训练和测试集。</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="daf1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们给目标和特征作为参数给<code class="fe nd ne nf mo b">train_test_split</code>函数，它返回随机打乱的数据。我们有 30%的数据用于测试集，70%的数据用于训练集。</p><p id="a915" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在，我将为每个特性调用函数<code class="fe nd ne nf mo b">numeric_column</code>，因为幸运的是我所有的特性都是数值型的。接下来，我将为特性列创建列表，</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="4a0b" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在我们可以为特性列创建列表。</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="my mz l"/></div></figure><h2 id="a3a7" class="ms mt iq bd nk on oo dn no op oq dp ns kn or os nw kr ot ou oa kv ov ow oe ox bi translated">输入功能、测试和评估</h2><p id="5a7b" class="pw-post-body-paragraph kc kd iq ke b kf og kh ki kj oh kl km kn oi kp kq kr oj kt ku kv ok kx ky kz ij bi translated">我们需要输入函数，它必须返回一个元组，包含两个元素:特征和标签列表，我们将此输入函数用于我们的模型，因为当我们训练它时，我们必须将特征和标签传递给模型。</p><p id="600d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">但是，当然，我们并不一定要手写它，它已经有了一个名为‘pandas _ input _ fn’的函数，我们将使用它:</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="0372" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在是实例化模型的时候了</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="8fca" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们准备训练我们的模型:</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="3bcf" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们训练了它，现在，我们能够评估我们的模型。为了评估，我们将<code class="fe nd ne nf mo b">eval_fn</code>作为参数传递给<code class="fe nd ne nf mo b">evaluat</code>函数:</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="my mz l"/></div></figure><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oy"><img src="../Images/380aad8c353faa3ba2cdf111571a00fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nxykz5VGJoR-JywgPVWXAg.png"/></div></div></figure><p id="3a13" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">你可以在屏幕上看到，在我的例子中，准确率是 80%+，我认为，对于这种数据来说，这是正常的——我只有大约 1400 个用户的信息，只有 4 个功能。人们的决定有时并不依赖于这些特征，所以我们的准确性现在令我满意。现在我可以用这个模型对真实数据进行预测。</p><h2 id="a533" class="ms mt iq bd nk on oo dn no op oq dp ns kn or os nw kr ot ou oa kv ov ow oe ox bi translated">预言；预测；预告</h2><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="my mz l"/></div></figure><figure class="mj mk ml mm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi oz"><img src="../Images/151811b8fd63832aa2afee2720ae8e81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ng8vreueV8hwusX5OAYeOQ.png"/></div></div></figure><p id="53fd" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">最后，我们可以获得这些用户的列表，这些用户将根据我们的模型的预测回复我们的好友请求。</p><figure class="mj mk ml mm gt jr"><div class="bz fp l di"><div class="my mz l"/></div></figure><p id="3a5d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">当然，您可以更好地训练您的模型以获得更高的准确性，您可以使用不同的功能或更改任何您想要的功能，因为这个实验只是为了好玩，为了花更多时间使用 Tensorflow 和其他库。</p><p id="60b1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><em class="na">感谢您花时间阅读这个故事:</em></p></div></div>    
</body>
</html>