<html>
<head>
<title>Training road scene segmentation on Cityscapes with Supervisely, Tensorflow and UNet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于Supervisely、Tensorflow和UNet的城市道路场景分割训练</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/training-road-scene-segmentation-on-cityscapes-with-supervisely-tensorflow-and-unet-1232314781a8?source=collection_archive---------0-----------------------#2017-08-16">https://towardsdatascience.com/training-road-scene-segmentation-on-cityscapes-with-supervisely-tensorflow-and-unet-1232314781a8?source=collection_archive---------0-----------------------#2017-08-16</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="9250" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">自2012年Alex Krizhevsky发表他的开创性AlexNet以来，深度学习工具集已经走过了漫长的道路，从一堆CUDA C++文件到像Tensorflow和Caffe这样的易用框架，配备了像UNet或SSD这样的强大架构。</p><p id="3890" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">也有很多来自不同领域的免费数据集，如标志识别或图像字幕。</p><p id="8a9e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在每个人都可以建立和训练自己的模型。此时此地有这么多东西——还会出什么差错呢？</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/4e4ac1d65f38155e82611017ed942631.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*nNK0hShiRAdjtzu3bfd7Jg.png"/></div><figcaption class="kt ku gj gh gi kv kw bd b be z dk">Cooking data may be hard.</figcaption></figure><p id="0246" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不幸的是，有几件事你应该担心:</p><ol class=""><li id="2992" class="kx ky iq jp b jq jr ju jv jy kz kc la kg lb kk lc ld le lf bi translated">首先，你需要获得有趣的数据集。有时，这并不是一件容易的事情，因为一些链接断开了，一些数据集需要你发送请求并等待几天(或几周，或永远)。</li><li id="053b" class="kx ky iq jp b jq lg ju lh jy li kc lj kg lk kk lc ld le lf bi translated">你必须小心统计和分布。如果不太了解你的数据，很容易花很多时间训练你的模型却没有结果。</li><li id="3cd8" class="kx ky iq jp b jq lg ju lh jy li kc lj kg lk kk lc ld le lf bi translated">有时你想注释一些特定的东西，这些东西在公共数据集中还没有。例如，您可以在汽车牌照上标注实际的车牌号码或标记道路缺陷。</li><li id="98e5" class="kx ky iq jp b jq lg ju lh jy li kc lj kg lk kk lc ld le lf bi translated">(在深度学习中)数据越多越好。将几个数据集组合在一起使训练更容易总是一个好主意。当然，您应该首先做一些预处理:例如，在一个数据集中，您只有“车辆”，而在另一个数据集中，您有“汽车”、“自行车”和“公共汽车”。重新映射类标签是必须做的事情。</li><li id="b530" class="kx ky iq jp b jq lg ju lh jy li kc lj kg lk kk lc ld le lf bi translated">扩充也是一个让数据变大的好主意。是的，大多数框架都没有这个特性。</li></ol><p id="9ec3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在<a class="ae ll" href="https://deepsystems.ai" rel="noopener ugc nofollow" target="_blank"> Deep Systems </a>这里，我们每天都会遇到这种困难。准备数据并不是构建模型的乐趣所在，但却非常重要，因此我们创建了一个服务来帮助解决上述所有问题(甚至更多！).</p><p id="1bcf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我们想向您介绍<a class="ae ll" href="https://supervise.ly" rel="noopener ugc nofollow" target="_blank"> Supervise.ly </a>，并向您展示一个现实世界问题的例子:我们将在Tensorflow、Keras和名为UNet的有前途的架构的帮助下，在几个公开可用的数据集的组合上训练我们自己的道路分割模型。</p><blockquote class="lm ln lo"><p id="bfdf" class="jn jo lp jp b jq jr js jt ju jv jw jx lq jz ka kb lr kd ke kf ls kh ki kj kk ij bi translated"><strong class="jp ir">免责声明</strong>:你可以跳过监督数据准备部分，自己做，但是可能会花更多的时间。</p></blockquote><h1 id="02ee" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">准备城市景观</h1><p id="8fa2" class="pw-post-body-paragraph jn jo iq jp b jq mr js jt ju ms jw jx jy mt ka kb kc mu ke kf kg mv ki kj kk ij bi translated">Cityscapes是一个来自50个城市的街道场景数据集。它有5000个高质量的注释帧和30个类，如“人行道”或“摩托车”。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi mw"><img src="../Images/eed3747951418aa2d489c9f553c666e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JKmS08bllQ8SCajIPyiBBQ.png"/></div></div><figcaption class="kt ku gj gh gi kv kw bd b be z dk">Cityscapes annotation example</figcaption></figure><p id="efbb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">与类似数据集不同的是，Cityscapes以多边形和点的形式提供标注，而不仅仅是大位图。</p><h2 id="3e5b" class="nb lu iq bd lv nc nd dn lz ne nf dp md jy ng nh mh kc ni nj ml kg nk nl mp nm bi translated">步骤1:下载数据集</h2><p id="3560" class="pw-post-body-paragraph jn jo iq jp b jq mr js jt ju ms jw jx jy mt ka kb kc mu ke kf kg mv ki kj kk ij bi translated">你可以在这里获得数据集<a class="ae ll" href="https://www.cityscapes-dataset.com/downloads/" rel="noopener ugc nofollow" target="_blank">——你可能需要等一两天才能获得确认链接:数据集许可不允许分发。</a></p><p id="58cc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">登录后，下载以下档案:<code class="fe nn no np nq b">gtFine_trainvaltest.zip (241MB)</code>和<code class="fe nn no np nq b">leftImg8bit_trainvaltest.zip (11GB)</code>。</p><p id="6ae0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们只对Cityscapes数据集的像素级子集感兴趣，所以您不必下载其他档案。</p><p id="8466" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，将下载的归档文件解压缩到一个文件夹中，这样您将以下面的结构结束:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi nr"><img src="../Images/1153b2e8c74949976131939853567af2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1xlF0FKOr2Yr6sfGMxytbA.png"/></div></div></figure><p id="dbf5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe nn no np nq b">gtFine</code>和<code class="fe nn no np nq b">leftImg8bit</code>都包含类似<code class="fe nn no np nq b">train</code>和<code class="fe nn no np nq b">val</code>的文件夹，这些文件夹包含类似<code class="fe nn no np nq b">aachen</code>的文件夹-城市。</p><p id="fc01" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如你所见，Cityscapes是一个大数据集。如果您愿意，可以使用整个Cityscapes数据集来完成本教程，但我们建议只留下几个城市:至少对于第一次尝试来说是这样。所以，最后，你应该有这样的东西:</p><pre class="km kn ko kp gt ns nq nt nu aw nv bi"><span id="3bf5" class="nb lu iq nq b gy nw nx l ny nz">$ tree -d<br/>.<br/>├── gtFine<br/>│   ├── train<br/>│   │   ├── aachen<br/>│   │   ├── bochum<br/>│   │   └── bremen<br/>│   └── val<br/>│       └── frankfurt<br/>└── leftImg8bit<br/>    ├── train<br/>    │   ├── aachen<br/>    │   ├── bochum<br/>    │   └── bremen<br/>    └── val<br/>        └── frankfurt</span></pre><p id="946f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将整个目录打包到一个新的归档文件中，使用一种支持的超级导入格式:<code class="fe nn no np nq b">.zip</code>、<code class="fe nn no np nq b">.tar</code>或<code class="fe nn no np nq b">.tar.gz</code>。现在我们准备向前迈进。</p><h2 id="c9e2" class="nb lu iq bd lv nc nd dn lz ne nf dp md jy ng nh mh kc ni nj ml kg nk nl mp nm bi translated">第二步:注册Supervise.ly</h2><p id="ee13" class="pw-post-body-paragraph jn jo iq jp b jq mr js jt ju ms jw jx jy mt ka kb kc mu ke kf kg mv ki kj kk ij bi translated"><a class="ae ll" href="https://app.supervise.ly/signup" rel="noopener ugc nofollow" target="_blank">创建一个账户</a>——只需一分钟，完全免费。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi oa"><img src="../Images/ad5ed6c482b75f52c574696374f6cdd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tx8X3lu3Ee-ck5frV0yKdA.png"/></div></div><figcaption class="kt ku gj gh gi kv kw bd b be z dk">Signup page</figcaption></figure><h2 id="1420" class="nb lu iq bd lv nc nd dn lz ne nf dp md jy ng nh mh kc ni nj ml kg nk nl mp nm bi translated">步骤3:导入Cityscapes数据集</h2><p id="b73e" class="pw-post-body-paragraph jn jo iq jp b jq mr js jt ju ms jw jx jy mt ka kb kc mu ke kf kg mv ki kj kk ij bi translated">太好了！现在你没有超级数据集——是时候创建你的第一个数据集了。你可以上传自己的图片，但现在我们将使用城市景观。打开“导入”页面，选择“开源数据集格式”选项。我们支持几个最流行的公共数据集。选择“城市景观”。在右侧，您会看到一个您必须上传的归档示例—这是我们在第一步中创建的文件。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi oa"><img src="../Images/4ac3b826fa4c4bc1dacc6560abe82a59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D1AdNJ1sxqxfzgvbiB56HA.png"/></div></div></figure><p id="f060" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">输入项目名称(对于本教程，输入“cityscapes”)并移动到最后一步:在您的计算机上选择准备好的存档并开始上传。</p><p id="1fa3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以在“任务状态”页面监控进度。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi oa"><img src="../Images/e274d18e4517f24f57a99a9dc2fff3ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YkNlZTJ4nCAHZtsEDJ96Ag.png"/></div></div></figure><h2 id="760b" class="nb lu iq bd lv nc nd dn lz ne nf dp md jy ng nh mh kc ni nj ml kg nk nl mp nm bi translated">第四步:查看统计数据</h2><p id="a00c" class="pw-post-body-paragraph jn jo iq jp b jq mr js jt ju ms jw jx jy mt ka kb kc mu ke kf kg mv ki kj kk ij bi translated">当你看到任务的状态是“完成”时，这意味着一切正常，你可以开始用你的图像做一些很酷的事情了。</p><p id="48f8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我们来看看一些数字。打开你新创建的项目“cityscapes ”,进入“Statistics”页面。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi oa"><img src="../Images/307ab320fce28ce5bfbe93ab4404680f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qwlTZGiIGwDUgQYVws7OOg.png"/></div></div></figure><p id="3c74" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这里你将会得到一些关于班级分布，人物区域和更多的信息。你可以从这里的数据中获得一些见解。例如，人们可以看到，只有10%的图像至少有一辆公共汽车，或者电线杆多于汽车。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi ob"><img src="../Images/f1addaf64a4168a9397ec7d03f2c7093.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FygCogzThAsJTze8Yk3CeA.png"/></div></div></figure><h2 id="cb94" class="nb lu iq bd lv nc nd dn lz ne nf dp md jy ng nh mh kc ni nj ml kg nk nl mp nm bi translated">步骤5:导出数据</h2><p id="440d" class="pw-post-body-paragraph jn jo iq jp b jq mr js jt ju ms jw jx jy mt ka kb kc mu ke kf kg mv ki kj kk ij bi translated">我们不想改变数据集中的注释，所以我们可以直接跳到导出。</p><p id="ab9e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Supervise.ly最强大的功能之一是导出工具。它允许您使用简单的基于JSON的配置来建立转换管道。我们在那里支持许多有用的东西:</p><ul class=""><li id="02aa" class="kx ky iq jp b jq jr ju jv jy kz kc la kg lb kk oc ld le lf bi translated">图像裁剪和旋转</li><li id="ebb2" class="kx ky iq jp b jq lg ju lh jy li kc lj kg lk kk oc ld le lf bi translated">亮度和对比度校正</li><li id="0e30" class="kx ky iq jp b jq lg ju lh jy li kc lj kg lk kk oc ld le lf bi translated">过滤掉一些数字</li><li id="d69a" class="kx ky iq jp b jq lg ju lh jy li kc lj kg lk kk oc ld le lf bi translated">重新映射分类标签</li><li id="7e45" class="kx ky iq jp b jq lg ju lh jy li kc lj kg lk kk oc ld le lf bi translated">分割数据集以进行训练和验证</li></ul><p id="122d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">还有更多。</p><p id="c48a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以保存和传输这些配置，在不同的项目中使用它们，当然，不需要编码。</p><p id="b266" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了培训UNet，我们需要:</p><ul class=""><li id="d6d1" class="kx ky iq jp b jq jr ju jv jy kz kc la kg lb kk oc ld le lf bi translated">将类别数量从30个减少到几个(例如，四个:“bg”、“车辆”、“道路”和“中性”)</li><li id="2096" class="kx ky iq jp b jq lg ju lh jy li kc lj kg lk kk oc ld le lf bi translated">将图像调整为固定大小(例如，224x224)</li><li id="2644" class="kx ky iq jp b jq lg ju lh jy li kc lj kg lk kk oc ld le lf bi translated">过滤掉非常小的数字(例如，小于面积的0.15%)</li><li id="ac3e" class="kx ky iq jp b jq lg ju lh jy li kc lj kg lk kk oc ld le lf bi translated">根据数据集名称(基本上按城市)拆分数据以进行训练和验证</li><li id="3e08" class="kx ky iq jp b jq lg ju lh jy li kc lj kg lk kk oc ld le lf bi translated">用“中性”类填充背景</li><li id="d92e" class="kx ky iq jp b jq lg ju lh jy li kc lj kg lk kk oc ld le lf bi translated">生成地面实况位图</li></ul><p id="f027" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将使用Supervise.ly导出配置来完成上述所有工作。</p><p id="2c49" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">单击“导出”选项卡开始新的导出。在左侧，您可以使用JSON定义您的导出配置，或者通过按“添加层”按钮在UI中添加新的转换层。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi oa"><img src="../Images/31a399be1598be443fb4773725087695.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0Z44EiYnp2x3aQFBXuMSHg.png"/></div></div></figure><p id="a017" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每一个改变都会更新右边，你会看到一个代表导出转换的图表。</p><p id="893d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们为本教程做了一个预定义的配置。您可以通过克隆我们的存储库来获得它:</p><pre class="km kn ko kp gt ns nq nt nu aw nv bi"><span id="232b" class="nb lu iq nq b gy nw nx l ny nz">git clone <a class="ae ll" href="https://github.com/DeepSystems/supervisely-tutorials" rel="noopener ugc nofollow" target="_blank">https://github.com/DeepSystems/supervisely-tutorials</a></span></pre><p id="5d40" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后从<code class="fe nn no np nq b">unet_training/src/experiment_001/config.json</code>文件中复制配置并将内容粘贴到左侧面板的编辑器中。</p><p id="943d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你会看到类似上面截图的东西。让我解释一下这是怎么回事:</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi od"><img src="../Images/53370b1c9cf5d790b0dc7e7ac36265c6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g_M2Bsr5AvVR7plRbVMu3A.png"/></div></div></figure><p id="cabe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以在<a class="ae ll" href="https://docs.supervise.ly" rel="noopener ugc nofollow" target="_blank">文档</a>中阅读更多关于导出和图层的内容。</p><p id="881d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">点击“开始导出”，输入本次导出的名称，Supervise.ly将开始准备您的数据。您可以在“任务”页面上监控进度。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi oa"><img src="../Images/16c5987636372430c99514f3b21ef381.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uDYaU4jmUzV5VGysXfUs8A.png"/></div></div></figure><p id="3a86" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">导出完成后，您将看到“完成”状态。点击“三点”图标，然后点击“下载”。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi oa"><img src="../Images/62afa86d94f8183078b187571b197923.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lcY31Az7TZImRgziPwPv4w.png"/></div></div></figure><h1 id="b3fd" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">培训UNet</h1><p id="6f93" class="pw-post-body-paragraph jn jo iq jp b jq mr js jt ju ms jw jx jy mt ka kb kc mu ke kf kg mv ki kj kk ij bi translated">现在，您应该有一个包含理想图像的档案。让我们看一些图片。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi oe"><img src="../Images/e673030a7396f9d53e511bed5dd6436c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZzjTAEXICZMBbupGfu0fwg.png"/></div></div><figcaption class="kt ku gj gh gi kv kw bd b be z dk">Folder “check” contains debug output with original and ground-truth images</figcaption></figure><p id="97ac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">是时候训练我们的模特了。在Github库<code class="fe nn no np nq b">supervisely-tutorials</code>中，我们已经做好了一切准备。</p><p id="173c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">解压文件夹<code class="fe nn no np nq b">unet_training/data/cityscapes</code>中下载的档案。您将得到类似这样的结果:</p><pre class="km kn ko kp gt ns nq nt nu aw nv bi"><span id="50a3" class="nb lu iq nq b gy nw nx l ny nz">$ cd <!-- -->unet_training/data<br/>$ tree -d<br/>.<br/>└── cityscapes<br/>    └── city2<br/>        ├── aachen<br/>        │   └── train<br/>        │       ├── check<br/>        │       ├── gt<br/>        │       └── orig<br/>        └── frankfurt<br/>            └── val<br/>                ├── check<br/>                ├── gt<br/>                └── orig</span></pre><p id="9938" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要开始训练，你需要GPU Cuda，Tensorflow和libs。有可能解决所有的依赖并手动安装库或者(更好的主意！)只需构建并运行docker映像:</p><pre class="km kn ko kp gt ns nq nt nu aw nv bi"><span id="386b" class="nb lu iq nq b gy nw nx l ny nz">cd <!-- -->unet_training/docker<br/>./build.sh<br/>./run.sh</span></pre><p id="54a3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Docker将构建包含Tensorflow和GPU支持的图像。它还会在容器内安装文件夹<code class="fe nn no np nq b">src</code>和<code class="fe nn no np nq b">data/cityscapes</code>。现在将Jupyter笔记本中的链接复制到您最喜欢的浏览器中。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi of"><img src="../Images/425ae3826e57c4bc2335dd978302f465.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dMW4E7XOs743oK3TPUpCaw.png"/></div></div></figure><p id="01b6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在上面的例子中，链接是<code class="fe nn no np nq b"><a class="ae ll" href="http://localhost:8888/?token=48938f4268b9c230cd450fa614d33abbb0ed3f98c8c245fe" rel="noopener ugc nofollow" target="_blank">http://localhost:8888/?token=48938f4268b9c230cd450fa614d33abbb0ed3f98c8c245fe</a></code>。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi oa"><img src="../Images/9005e969d456413eeae3c8fa0f76320d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*swxvwUcvjWZo5M1d28tv1g.png"/></div></div></figure><p id="6202" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">导航到文件夹<code class="fe nn no np nq b">experiment_001</code>并打开<code class="fe nn no np nq b">unet_train.ipynb</code>。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi oa"><img src="../Images/e366ffa4008215f1eb42d5b334e6dac2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MAW5L2KlVs0zvrEo6McS3w.png"/></div></div></figure><p id="425a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">点击<code class="fe nn no np nq b">Cell → Run All</code>运行笔记本。如果一切顺利，您将在几个时期后看到一些结果。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi oa"><img src="../Images/c972e6e67e082afa523290709e6f9432.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xKVgHeSdcXS9rseZaTvCxg.png"/></div></div><figcaption class="kt ku gj gh gi kv kw bd b be z dk">The road is recognised (kinda). Do more epochs to get better results.</figcaption></figure><p id="5f2a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">经过一天的训练，你可以达到这样的效果(这里我们使用了更多的类):</p><div class="km kn ko kp gt ab cb"><figure class="og kq oh oi oj ok ol paragraph-image"><img src="../Images/1f2132c7d388a1b5fb67925d2d62f2a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*bJC7JOk-XpZpp_fb3tIh1w.png"/></figure><figure class="og kq oh oi oj ok ol paragraph-image"><img src="../Images/d46de06a5a046092ab01baa5ceb0acdb.png" data-original-src="https://miro.medium.com/v2/resize:fit:896/format:webp/1*pnOcE6YfDxK5LZDFoO0TpA.png"/></figure></div><h2 id="eca2" class="nb lu iq bd lv nc nd dn lz ne nf dp md jy ng nh mh kc ni nj ml kg nk nl mp nm bi translated">结论</h2><p id="acdf" class="pw-post-body-paragraph jn jo iq jp b jq mr js jt ju ms jw jx jy mt ka kb kc mu ke kf kg mv ki kj kk ij bi translated">我们已经完成了从下载数据集到探索数据、使用Tensorflow和Keras进行导出转换和训练模型的每一步。</p><p id="483e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你也可以尝试使用其他可用的道路场景数据集，像<a class="ae ll" href="https://www.mapillary.com/dataset/" rel="noopener ugc nofollow" target="_blank">的瞳孔数据集</a>——超级支持它。</p><p id="d432" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你有问题，我们很乐意帮助你。</p><p id="4530" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">前期教程:<a class="ae ll" href="https://medium.com/p/e84c74d4382c" rel="noopener">用Supervisely和Tensorflow进行车牌检测</a>。</p></div></div>    
</body>
</html>