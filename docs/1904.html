<html>
<head>
<title>Run or Walk (Part 4): Using Keras Neural Network Classifier in iOS with Core ML</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">跑还是走(第 4 部分):在 iOS 中使用 Keras 神经网络分类器与核心 ML</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/run-or-walk-part-4-using-keras-neural-network-classifier-in-ios-with-core-ml-a29723ab3235?source=collection_archive---------1-----------------------#2017-11-14">https://towardsdatascience.com/run-or-walk-part-4-using-keras-neural-network-classifier-in-ios-with-core-ml-a29723ab3235?source=collection_archive---------1-----------------------#2017-11-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/a4a45e9306a2028a936120a7cca6c71a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ue825OqMX4cxCxz3wPz9Zg.jpeg"/></div></div></figure><div class=""/><p id="989d" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kw">阅读前几部分:<br/> </em> <a class="ae kx" href="https://medium.com/towards-data-science/run-or-walk-detecting-user-activity-with-machine-learning-and-core-ml-part-1-9658c0dcdd90" rel="noopener"> <em class="kw"> -跑或走(第一部分):用机器学习和核心 ML 检测运动数据活动<br/> </em> </a> <a class="ae kx" href="https://medium.com/towards-data-science/run-or-walk-part-2-collecting-device-motion-data-the-right-way-58a277ff2087" rel="noopener"> <em class="kw"> -跑或走(第二部分):以正确的方式收集设备运动数据</em></a><em class="kw"><br/></em><a class="ae kx" rel="noopener" target="_blank" href="/run-or-walk-part-3-99-accuracy-neural-network-classifier-for-detecting-motion-activity-675e16af4a7d"><em class="kw">-跑或走(第三部分):&gt; 99%准确率的神经网络分类器用于检测运动活动</em> </a></p><p id="57ae" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">终于，我走到了这段旅程的最后一步。现在是时候利用我们在第三部分<a class="ae kx" rel="noopener" target="_blank" href="/run-or-walk-part-3-99-accuracy-neural-network-classifier-for-detecting-motion-activity-675e16af4a7d">中训练的模型在 iOS 应用中预测用户的运动活动了。</a></p><h1 id="cc65" class="ky kz jb bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">保存 Keras 模型</h1><p id="14ba" class="pw-post-body-paragraph jy jz jb ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">首先，我必须将训练好的模型序列化到 JSON 中，并保存它的权重。</p><p id="05e6" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Keras 提供了一个简单的 API 来实现这一点:</p><figure class="mb mc md me gt is"><div class="bz fp l di"><div class="mf mg l"/></div></figure><p id="6dd5" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">将模型的权重保存到磁盘上的*.h5 文件的简单方法相同:</p><figure class="mb mc md me gt is"><div class="bz fp l di"><div class="mf mg l"/></div></figure><h1 id="5a59" class="ky kz jb bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">将 Keras 模型转换为核心 ML</h1><p id="f856" class="pw-post-body-paragraph jy jz jb ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">现在是时候将我保存的模型转换成 Core ML 格式了。由于我有一个 Keras 模型神经网络，我可以使用苹果的<a class="ae kx" href="https://pypi.python.org/pypi/coremltools" rel="noopener ugc nofollow" target="_blank">核心 ML 工具</a> Python 包，它为我完成了转换模型的工作:</p><figure class="mb mc md me gt is"><div class="bz fp l di"><div class="mf mg l"/></div></figure><h1 id="96a1" class="ky kz jb bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">在 iOS 应用程序中使用转换后的核心 ML 模型</h1><p id="a579" class="pw-post-body-paragraph jy jz jb ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">将核心 ML 模型导入到我的 iOS 应用程序就像拖放到 Xcode 项目一样简单。我刚才用于设置模型元数据、输入和输出描述的值现在可以在 Xcode 中的核心 ML 模型窗口中看到。</p><figure class="mb mc md me gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mh"><img src="../Images/311fdff235dbecad9bdb05fe95505cde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0lFvumfeT30kdimT-7CmtQ.png"/></div></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk">Core ML model window in Xcode</figcaption></figure><p id="0051" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">由于 Xcode 已经为导入的<em class="kw"> accel_x_model </em> Core ML 模型自动生成了一个自定义 API，我已经准备好为模型提供传感器数据并读取其预测。</p><figure class="mb mc md me gt is"><div class="bz fp l di"><div class="mf mg l"/></div></figure><figure class="mb mc md me gt is"><div class="bz fp l di"><div class="mf mg l"/></div></figure><h1 id="9484" class="ky kz jb bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">终点线</h1><p id="075e" class="pw-post-body-paragraph jy jz jb ka b kb lw kd ke kf lx kh ki kj ly kl km kn lz kp kq kr ma kt ku kv ij bi translated">看到检测运动数据活动的想法如何演变成这样一个有趣的项目真的很酷，这不仅需要我学习关于机器学习及其在 iOS 中的 Core ML 应用的新知识，还需要我在为模型收集数据时有机会减肥。</p><figure class="mb mc md me gt is gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/81e4a33f2f9fff014ac5d7e7becc28eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*8kt9t1yNMGPyCLgN2-ueTA.gif"/></div><figcaption class="mi mj gj gh gi mk ml bd b be z dk">iOS app detects motion activity in real time</figcaption></figure><p id="8ac3" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">像苹果的 Core ML 这样一个在移动应用中应用机器学习的简单方法，会有什么新的可能性，这真是令人惊讶！</p><p id="39ab" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">关注我，了解我在机器学习和 iOS 方面的最新实验！</p></div></div>    
</body>
</html>