<html>
<head>
<title>Building a co-occurrence matrix with d3 to analyze overlapping topics in dissertations</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用d3构建共现矩阵分析学位论文中的重叠主题</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/building-a-co-occurrence-matrix-with-d3-to-analyze-overlapping-topics-in-dissertations-fb2ae9470dee?source=collection_archive---------4-----------------------#2018-01-09">https://towardsdatascience.com/building-a-co-occurrence-matrix-with-d3-to-analyze-overlapping-topics-in-dissertations-fb2ae9470dee?source=collection_archive---------4-----------------------#2018-01-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/8f2acc11200dcd4f98db8946051a149f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h3Uu78FiVsnI-GrgZ-3phQ.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Thanks <a class="ae kc" href="https://www.pexels.com/u/minan1398/" rel="noopener ugc nofollow" target="_blank">Min An</a>!</figcaption></figure><p id="e694" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我硕士学位研究的目标是<strong class="kf ir">在不同领域的研究人员之间激发新的合作机会</strong>。但在此之前，我需要后退一步，看看<strong class="kf ir">是否有任何合作已经发生</strong>。酷，但是如何开始做这件事呢？</p><p id="f9db" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当作者为他们的作品写摘要时，他们也会添加一些关键词。我的第一个猜测是，通过这些关键词，我可以开始看到来自不同知识领域的论文是如何相互作用的。</p><p id="d751" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">于是我把自己大学(2016)的所有学位论文都找来，构建了一个矩阵，把关键词重叠的作品可视化。</p><p id="bb0e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我有两项主要工作:<strong class="kf ir">获取数据</strong>和<strong class="kf ir">构建d3可视化</strong>。</p><h1 id="28b9" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">1️⃣——获取数据</h1><p id="4500" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">每次学生拿到学位，她都需要把最终论文发到这个网站:<a class="ae kc" href="http://repositorio.ufpe.br/" rel="noopener ugc nofollow" target="_blank">http://repositorio.ufpe.br/</a>。为了从这些论文中获取关键词，我必须:</p><ol class=""><li id="60cc" class="me mf iq kf b kg kh kk kl ko mg ks mh kw mi la mj mk ml mm bi translated">获取所有学位论文的列表</li><li id="f638" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la mj mk ml mm bi translated">下载pdf文件</li><li id="df5d" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la mj mk ml mm bi translated">提取文本并获得每篇论文的关键词</li></ol><h2 id="1cf7" class="ms lc iq bd ld mt mu dn lh mv mw dp ll ko mx my lp ks mz na lt kw nb nc lx nd bi translated">🎓1 —获取所有论文的列表</h2><p id="fb08" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">多亏了Scrapy，这部分比我想象的要容易得多。为了用框架从网站中提取数据，我们需要编写一个蜘蛛。</p><blockquote class="ne nf ng"><p id="e8e5" class="kd ke nh kf b kg kh ki kj kk kl km kn ni kp kq kr nj kt ku kv nk kx ky kz la ij bi translated">“蜘蛛是你定义的类，Scrapy用它从一个网站(或一组网站)抓取信息。”<a class="ae kc" href="https://doc.scrapy.org/en/latest/intro/tutorial.html#our-first-spider" rel="noopener ugc nofollow" target="_blank">来源</a></p></blockquote><p id="e033" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在Spider类中，我们定义了基本URL，Scrapy应该如何处理分页，还定义了将要提取的数据。</p><figure class="nl nm nn no gt jr"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="babb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我得到了这个元数据:</p><pre class="nl nm nn no gt nr ns nt nu aw nv bi"><span id="4289" class="ms lc iq ns b gy nw nx l ny nz">{            <br/>'author',<br/>'title',<br/>'date':            <br/>'abstract',            <br/>'research_field',            <br/>'url_to_pdf'     <br/>}</span></pre><h2 id="aecb" class="ms lc iq bd ld mt mu dn lh mv mw dp ll ko mx my lp ks mz na lt kw nb nc lx nd bi translated">📁2-下载pdf</h2><p id="9f72" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我构建了一个python脚本，使用<a class="ae kc" href="http://docs.python-requests.org/en/master/" rel="noopener ugc nofollow" target="_blank">请求</a>、<em class="nh">一个优雅而简单的Python HTTP库，为人类而建</em>。</p><pre class="nl nm nn no gt nr ns nt nu aw nv bi"><span id="29fa" class="ms lc iq ns b gy nw nx l ny nz">with open(new_file_name, 'wb') as pdf:<br/>    temp = requests.get("<a class="ae kc" href="http://repositorio.ufpe.br" rel="noopener ugc nofollow" target="_blank">http://repositorio.ufpe.br</a>" + link, stream=True)<br/>    for block in temp.iter_content(512):<br/>        if not block:<br/>            break</span><span id="b959" class="ms lc iq ns b gy oa nx l ny nz">pdf.write(block)</span></pre><h2 id="d20a" class="ms lc iq bd ld mt mu dn lh mv mw dp ll ko mx my lp ks mz na lt kw nb nc lx nd bi translated">🔡3 —提取文本并获得每篇论文的关键词</h2><p id="95c3" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">对于这个任务，我使用了<a class="ae kc" href="https://github.com/mstamy2/PyPDF2" rel="noopener ugc nofollow" target="_blank"> PyPDF2 </a>和<a class="ae kc" href="https://spacy.io/" rel="noopener ugc nofollow" target="_blank">空间</a>。通常作者把关键词放在摘要下面，所以我浏览PDF的页面，如果我找到像“关键词”和“<em class="nh"> palavras-chave </em>”(在葡萄牙语中是关键词的意思)这样的词，我会把内容保存在一个txt文件中。</p><p id="ac8b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我使用spaCy来标记文本，因为PDF提取并不完美。</p><p id="fa1c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这个过程之后，我得到了包含“关键词”的每一页的文本。为了只得到关键词本身，我遍历单词，得到所有跟在“关键词”后面的单词，因为它们通常是页面中的最后一项。然后，我最后将数据加载到dataframe中进行一些转换，并将其保存到csv文件中。</p><h2 id="5cda" class="ms lc iq bd ld mt mu dn lh mv mw dp ll ko mx my lp ks mz na lt kw nb nc lx nd bi translated">关键词对我想做的事情有好处吗？</h2><p id="9e91" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我注意到的一件事是，关键字可能非常普通。如果我的目标是检查不同研究领域的主题如何相互作用，我应该分析摘要，因为在那里有更多的机会找到相互作用的点。</p><p id="4c99" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们举一个真实的例子来说明一下。对于本论文:“<a class="ae kc" href="http://repositorio.ufpe.br/bitstream/handle/123456789/17872/Disserta%C3%A7%C3%A3o%20Emily%20%20Gai%C3%A3o%20e%20Albuquerque%20%28vers%C3%A3o%20definitiva%29.pdf?sequence=1&amp;isAllowed=y,Disserta%C3%A7%C3%A3o%20Emily%20%20Gai%C3%A3o%20e%20Albuquerque%20%28vers%C3%A3o%20definitiva%29" rel="noopener ugc nofollow" target="_blank">农民工大学生适应中的认知和非认知方面</a>”的关键词是:</p><ul class=""><li id="309f" class="me mf iq kf b kg kh kk kl ko mg ks mh kw mi la ob mk ml mm bi translated">学术经历</li><li id="0c90" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la ob mk ml mm bi translated">弹性</li><li id="a3fd" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la ob mk ml mm bi translated">执行职能</li><li id="ded2" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la ob mk ml mm bi translated">论证</li><li id="c10d" class="me mf iq kf b kg mn kk mo ko mp ks mq kw mr la ob mk ml mm bi translated">大学生</li></ul><p id="6c20" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但在阅读摘要时，我发现了这个:</p><blockquote class="ne nf ng"><p id="a7e8" class="kd ke nh kf b kg kh ki kj kk kl km kn ni kp kq kr nj kt ku kv nk kx ky kz la ij bi translated">“为了实现这些目标，进行了以下分析:描述性统计、T检验、方差分析(ANOVA)、相关探索性双变量分析、探索性因子分析和多元线性回归。”</p></blockquote><p id="96bc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这篇论文来自认知心理学的研究生项目，但它的主题来自统计学，也可能来自计算机科学，对吗？关键字不能显示这一点。因此，我的下一步将是利用摘要中的文本建立一个深度学习模型。</p><p id="db0e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是我们需要从某个地方开始，所以我做了一些简单的事情:从每个研究领域得到前10个关键词，我假设这些词可以用来描述这个领域。</p><blockquote class="oc"><p id="3002" class="od oe iq bd of og oh oi oj ok ol la dk translated">首先去做，然后做对，然后做得更好——艾迪·osmani‏</p></blockquote><p id="e089" class="pw-post-body-paragraph kd ke iq kf b kg om ki kj kk on km kn ko oo kq kr ks op ku kv kw oq ky kz la ij bi translated">好了，现在我们准备开始构建可视化。</p><h1 id="4498" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">2️⃣——构建可视化</h1><p id="3447" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们将使用<a class="or os ep" href="https://medium.com/u/c918c478bb49?source=post_page-----fb2ae9470dee--------------------------------" rel="noopener" target="_blank">迈克·博斯托克</a> <a class="ae kc" href="https://bost.ocks.org/mike/miserables/" rel="noopener ugc nofollow" target="_blank">悲惨世界共现矩阵</a>作为我们的“模板”。让我们首先创建一个矩形，并将其添加到背景中:</p><pre class="nl nm nn no gt nr ns nt nu aw nv bi"><span id="f954" class="ms lc iq ns b gy nw nx l ny nz">var margin = {<br/>        top: 285,<br/>        right: 0,<br/>        bottom: 10,<br/>        left: 285<br/>    },<br/>    width = 700,<br/>    height = 700;<br/>var svg = d3.select("graph").append("svg").attr("width", width).attr("height", height);</span><span id="2d14" class="ms lc iq ns b gy oa nx l ny nz">svg.append("rect")<br/>    .attr("class", "background")<br/>    .attr("width", width - margin.right)<br/>    .attr("height", height - margin.top)<br/>    .attr("transform", "translate(" + margin.right + "," + margin.top + ")");</span><span id="45f9" class="ms lc iq ns b gy oa nx l ny nz">svg.append("rect")<br/>    .attr("class", "background")<br/>    .attr("width", width)<br/>    .attr("height", height);</span></pre><p id="58ce" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在我们可以深入了解d3的魔力了。</p><h2 id="851e" class="ms lc iq bd ld mt mu dn lh mv mw dp ll ko mx my lp ks mz na lt kw nb nc lx nd bi translated">1-转换数据</h2><p id="a373" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">数据看起来像这样:</p><pre class="nl nm nn no gt nr ns nt nu aw nv bi"><span id="2292" class="ms lc iq ns b gy nw nx l ny nz">{<br/>    "nodes": [{<br/>            "group": "humanas",<br/>            "index": 0,<br/>            "name": "ADMINISTRAÇÃO"<br/>        },<br/>        {<br/>            "group": "humanas",<br/>            "index": 1,<br/>            "name": "ANTROPOLOGIA"<br/>        },<br/>        [...]<br/>    ],<br/>    "links": [{<br/>            "source": 0,<br/>            "target": 0,<br/>            "value": 0.0<br/>        }, {<br/>            "source": 0,<br/>            "target": 1,<br/>            "value": 2.0<br/>        }, <br/>        [...]<br/>    ]<br/>}</span></pre><p id="19d6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将逐行构建矩阵。首先，我们读取数据并为每一行创建一个数组。</p><pre class="nl nm nn no gt nr ns nt nu aw nv bi"><span id="465a" class="ms lc iq ns b gy nw nx l ny nz">d3.json("data/data.json", function(data) {<br/>    var matrix = [];<br/>    var nodes = data.nodes;<br/>    var total_items = nodes.length;</span><span id="37d6" class="ms lc iq ns b gy oa nx l ny nz">// Create rows for the matrix<br/>    nodes.forEach(function(node) {<br/>        node.count = 0;<br/>        node.group = groupToInt(node.group);</span><span id="8278" class="ms lc iq ns b gy oa nx l ny nz">matrix[node.index] = d3.range(total_items).map(item_index =&gt; {<br/>            return {<br/>                x: item_index,<br/>                y: node.index,<br/>                z: 0<br/>            };<br/>        });<br/>    });<br/>    // Fill matrix with data from links and count how many times each item appears<br/>    data.links.forEach(function(link) {<br/>        matrix[link.source][link.target].z += link.value;<br/>        matrix[link.target][link.source].z += link.value;<br/>        nodes[link.source].count += link.value;<br/>        nodes[link.target].count += link.value;<br/>    });</span><span id="f204" class="ms lc iq ns b gy oa nx l ny nz">});</span></pre><p id="cd85" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因为我们将逐行构建方块，所以我们需要浏览每一行，然后浏览每一列。</p><h2 id="84f8" class="ms lc iq bd ld mt mu dn lh mv mw dp ll ko mx my lp ks mz na lt kw nb nc lx nd bi translated">2-放置正方形并添加颜色</h2><p id="73d0" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">为了将每个方块放置在正确的位置，我们将使用d3.scaleBand()标尺。这个scale的作用是获得一个包含值的数组，然后为每个数组项分配一个坐标。每个项目的所有坐标加上带宽值加起来就是总宽度。</p><figure class="nl nm nn no gt jr gh gi paragraph-image"><div class="gh gi ot"><img src="../Images/fad26a3a097352c9a6a2a90f872ca314.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*bw5dpQvRxAjmNtF61kEdHA.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">How d3.scaleBand() words</figcaption></figure><p id="c0b7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个规模令人敬畏，因为我们不需要手工计算。</p><p id="2c11" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要给每个方块添加颜色，您可以使用d3.schemeCategory20标度。</p><p id="c1f0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是大量的新代码，让我们来看看:</p><pre class="nl nm nn no gt nr ns nt nu aw nv bi"><span id="22e9" class="ms lc iq ns b gy nw nx l ny nz">d3.json("data/data.json", function(data) {</span><span id="a4fc" class="ms lc iq ns b gy oa nx l ny nz">[...] //transform the data</span><span id="84c5" class="ms lc iq ns b gy oa nx l ny nz">var matrixScale = d3.scaleBand().range([0, width]).domain(d3.range(total_items));<br/>var opacityScale = d3.scaleLinear().domain([0, 10]).range([0.3, 1.0]).clamp(true);<br/>var colorScale = d3.scaleOrdinal(d3.schemeCategory20);</span><span id="3c47" class="ms lc iq ns b gy oa nx l ny nz">// Draw each row (translating the y coordinate) <br/>    var rows = svg.selectAll(".row")<br/>        .data(matrix)<br/>        .enter().append("g")<br/>        .attr("class", "row")<br/>        .attr("transform", (d, i) =&gt; {<br/>            return "translate(0," + matrixScale(i) + ")";<br/>        });</span><span id="7079" class="ms lc iq ns b gy oa nx l ny nz">var squares = rows.selectAll(".cell")<br/>        .data(d =&gt; d.filter(item =&gt; item.z &gt; 0))<br/>        .enter().append("rect")<br/>        .attr("class", "cell")<br/>        .attr("x", d =&gt; matrixScale(d.x))<br/>        .attr("width", matrixScale.bandwidth())<br/>        .attr("height", matrixScale.bandwidth())<br/>        .style("fill-opacity", d =&gt; opacityScale(d.z)).style("fill", d =&gt; {<br/>            return nodes[d.x].group == nodes[d.y].group ? colorScale(nodes[d.x].group) : "grey";<br/>        })<br/>        .on("mouseover", mouseover)<br/>        .on("mouseout", mouseout);<br/>});</span></pre><p id="1374" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们还创建了一个比例来设置每个方块的不透明度。在我们的例子中，不透明度值是有至少一个关键字匹配的论文的数量。一个关键词匹配意味着一个关键词同时出现在两篇论文中。</p><h2 id="12ba" class="ms lc iq bd ld mt mu dn lh mv mw dp ll ko mx my lp ks mz na lt kw nb nc lx nd bi translated">3-添加列</h2><p id="b92c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们对行做了同样的事情，但是现在我们旋转它们:</p><pre class="nl nm nn no gt nr ns nt nu aw nv bi"><span id="b1d5" class="ms lc iq ns b gy nw nx l ny nz">d3.json("data/data.json", function(data) {<br/>    <br/>   [...] //transform the data</span><span id="3b4f" class="ms lc iq ns b gy oa nx l ny nz">   [...] //place the squares and add color</span><span id="011d" class="ms lc iq ns b gy oa nx l ny nz">var columns = svg.selectAll(".column")<br/>        .data(matrix)<br/>        .enter().append("g")<br/>        .attr("class", "column")<br/>        .attr("transform", (d, i) =&gt; {<br/>            return "translate(" + matrixScale(i) + ")rotate(-90)";<br/>        });<br/>});</span></pre><h2 id="1aec" class="ms lc iq bd ld mt mu dn lh mv mw dp ll ko mx my lp ks mz na lt kw nb nc lx nd bi translated">4-添加文本标签</h2><p id="00fd" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">为了添加占位符，我们使用行和列选择来添加一个svg文本元素。</p><pre class="nl nm nn no gt nr ns nt nu aw nv bi"><span id="a516" class="ms lc iq ns b gy nw nx l ny nz">d3.json("data/data.json", function(data) {<br/>    <br/>    [...] //transform the data</span><span id="8604" class="ms lc iq ns b gy oa nx l ny nz">    [...] //place the squares and add color</span><span id="4037" class="ms lc iq ns b gy oa nx l ny nz">    [...] //add columns</span><span id="82f6" class="ms lc iq ns b gy oa nx l ny nz">rows.append("text")<br/>        .attr("class", "label")<br/>        .attr("x", -5)<br/>        .attr("y", matrixScale.bandwidth() / 2)<br/>        .attr("dy", ".32em")<br/>        .attr("text-anchor", "end")<br/>        .text((d, i) =&gt; capitalize_Words(nodes[i].name));<br/>  <br/>    columns.append("text")<br/>        .attr("class", "label")<br/>        .attr("y", 100)<br/>        .attr("y", matrixScale.bandwidth() / 2)<br/>        .attr("dy", ".32em")<br/>        .attr("text-anchor", "start")<br/>        .text((d, i) =&gt; capitalize_Words(nodes[i].name));<br/>});</span></pre><h2 id="d585" class="ms lc iq bd ld mt mu dn lh mv mw dp ll ko mx my lp ks mz na lt kw nb nc lx nd bi translated">5-添加排序功能</h2><p id="bd42" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">重新组织矩阵行有助于分析。在我们的例子中，我们可以按照字母顺序、每个项目(即研究领域)的连接数量以及每个知识领域的聚类来组织它们。使用d3.scaleBand()矩阵很容易做到这一点。</p><p id="cad8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">数组的每一项都对应一个程序id，所以如果我们以不同的方式对数组排序，我们会得到每个矩阵方块不同的坐标。</p><pre class="nl nm nn no gt nr ns nt nu aw nv bi"><span id="c655" class="ms lc iq ns b gy nw nx l ny nz">// Precompute the orders.<br/>var orders = {<br/>    name: d3.range(total_items).sort((a, b) =&gt; {<br/>        return d3.ascending(nodes[a].name, nodes[b].name);<br/>    }),<br/>    count: d3.range(total_items).sort((a, b) =&gt; {<br/>        return nodes[b].count - nodes[a].count;<br/>    }),<br/>    group: d3.range(total_items).sort((a, b) =&gt; {<br/>        return nodes[b].group - nodes[a].group;<br/>    })<br/>};</span></pre><p id="510e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我们向html select标记添加功能:</p><pre class="nl nm nn no gt nr ns nt nu aw nv bi"><span id="06dc" class="ms lc iq ns b gy nw nx l ny nz">d3.select("#order").on("change", function() {<br/>    changeOrder(this.value);<br/>});</span><span id="07ee" class="ms lc iq ns b gy oa nx l ny nz">function changeOrder(value) {<br/>        matrixScale.domain(orders[value]);<br/>        var t = svg.transition().duration(2000);<br/>      <br/>        t.selectAll(".row")<br/>            .delay((d, i) =&gt; matrixScale(i) * 4)<br/>            .attr("transform", function(d, i) {<br/>                return "translate(0," + matrixScale(i) + ")";<br/>            })<br/>            .selectAll(".cell")<br/>            .delay(d =&gt; matrixScale(d.x) * 4)<br/>            .attr("x", d =&gt; matrixScale(d.x));<br/>      <br/>        t.selectAll(".column")<br/>            .delay((d, i) =&gt; matrixScale(i) * 4)<br/>            .attr("transform", (d, i) =&gt; "translate(" + matrixScale(i) + ")rotate(-90)");<br/>    }</span></pre><p id="fec2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了增加一个好的效果，我们还添加了一个动画的转换。</p><figure class="nl nm nn no gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ou"><img src="../Images/f393665e71d24195c86b4f28367776f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*on1H1gOmktArurEGHbGrKA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">The final result</figcaption></figure><p id="11ed" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">就是这样！现在我们只是添加一些白线，并为每个方块添加一个工具提示。你可以在这里看到最终结果<a class="ae kc" href="http://bl.ocks.org/dmesquita/raw/5abae723e08fade117ae98faa7317d1d/" rel="noopener ugc nofollow" target="_blank">或者在这里</a>查看最终代码<a class="ae kc" href="https://gist.github.com/dmesquita/5abae723e08fade117ae98faa7317d1d" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="9970" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这只是一个开始，现在我需要做的是如何显示关键词和论文。当然，我会回到这里与你分享，哈哈</p><p id="7a09" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢阅读！😁</p><p id="283a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">你觉得这篇文章有帮助吗？我尽力每个月写一篇深入的文章，当我发表新的文章时，你可以收到电子邮件。</p></div></div>    
</body>
</html>