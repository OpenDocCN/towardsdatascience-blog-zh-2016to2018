<html>
<head>
<title>Creating animations with MCMC</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 MCMC 创建动画</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/creating-animations-with-mcmc-4458ab2b6cc3?source=collection_archive---------7-----------------------#2018-07-11">https://towardsdatascience.com/creating-animations-with-mcmc-4458ab2b6cc3?source=collection_archive---------7-----------------------#2018-07-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/2e8cdf506aa76c37397b7c9afb2f2bfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*rHAG_EIBHrVvPwECGRIxJQ.gif"/></div></div></figure><p id="ba94" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">马尔可夫链蒙特卡罗(MCMC)是贝叶斯统计中一种广泛流行的技术。它用于后验分布抽样，因为分析形式通常是不可跟踪的。然而，在本帖中，我们将使用它从静态图像/徽标中生成动画。顺便说一句，这可能是对 MCMC 和拒绝采样的介绍。这个想法是基于一个伟大的开源包<a class="ae kw" href="https://github.com/ColCarroll/imcmc" rel="noopener ugc nofollow" target="_blank"> imcmc </a>，它是建立在<a class="ae kw" href="https://github.com/pymc-devs/pymc3" rel="noopener ugc nofollow" target="_blank"> PyMC3 </a>之上的。</p><h1 id="1ca2" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">预赛</h1><p id="8cb0" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">虽然 MCMC 适用于任何维度，但我们将集中讨论 2D 分布。为什么？好吧，看看下面的图表。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ma"><img src="../Images/69baff8fc26984bb2a007286fbad0f68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yrkPVFxpQohfB96h.png"/></div></div></figure><p id="4b0b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们从一个 RGB 图像(最好是一个简单的标志)开始，将其转换为灰度，并根据强度为每个像素分配一个概率。在我们的例子中，像素越暗，概率越高。这导致了<strong class="ka ir">离散 2D 分布</strong>。</p><p id="5305" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一旦我们有了这个分布，我们就可以从中抽取样本(像素)。一般来说，我们寻找以下两个属性:</p><ol class=""><li id="db4b" class="mf mg iq ka b kb kc kf kg kj mh kn mi kr mj kv mk ml mm mn bi translated">样本确实来自目标分布</li><li id="940d" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv mk ml mm mn bi translated">样品的连续及其可视化在美学上是令人愉悦的</li></ol><p id="5da1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">虽然第二个属性总是在旁观者的眼中，但第一个属性可以通过使用适当的采样算法来实现。具体来说，让我们仔细看看 3 种非常适合当前问题的采样算法:拒绝、Gibbs 和 Metropolis-Hastings 采样。</p></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><h1 id="b43c" class="kx ky iq bd kz la na lc ld le nb lg lh li nc lk ll lm nd lo lp lq ne ls lt lu bi translated">拒绝抽样</h1><p id="98d6" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">第一种方法属于 IID ( <strong class="ka ir">独立</strong>同分布)抽样方法。这实质上意味着当前样本对下一个样本没有影响。该算法假设我们能够从所谓的建议分布中进行采样。可以使用许多不同的建议分布，但最常见的是均匀(有限支持)和正态(无限支持)分布。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nf"><img src="../Images/755d06481112ad2dfda5c092364138d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*a-GWtOVQqEZM-wM1.png"/></div></div></figure><p id="ae59" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了最大限度地降低拒绝样本的可能性，我们必须选择与我们的目标尽可能相似的建议分布。此外，我们希望比例常数 M 尽可能低。见下图(1D)方案。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ma"><img src="../Images/4437ec60fb5ff20e697e026a382b34fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Hnxbo27rCTr-3AJQ.png"/></div></div></figure><p id="eeea" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在我们的设置中，我们可以采用 2D 均匀分布作为建议。</p><figure class="mb mc md me gt jr"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="af6e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在较低的维度中，拒绝采样表现得非常好。然而，随着维数的增加，它遭受了臭名昭著的<strong class="ka ir">维数灾难</strong>。幸运的是，2D 没有被诅咒，因此拒绝采样是一个很好的选择。</p><h1 id="8577" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">吉布斯采样</h1><p id="b88c" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">吉布斯采样属于第二类采样器，它们通过构建马尔可夫链来生成样本。因此，这些样本<strong class="ka ir">不是独立的</strong>。事实上，在链达到稳定分布之前，它们甚至不是同分布的。因此，通常的做法是丢弃前 x 个样本，以确保链“忘记”初始化(老化)。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ni"><img src="../Images/9bf95a0bf67b7435f9112630e32cba44.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6QwmVaLCHiJQjbqs.png"/></div></div></figure><p id="a200" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">算法本身假设我们能够沿着目标的每个维度从条件分布中抽取样本。每当我们从这些单变量分布中取样时，我们都以剩余成分的最新值为条件。</p><figure class="mb mc md me gt jr"><div class="bz fp l di"><div class="ng nh l"/></div></figure><h1 id="d71c" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">大都会-黑斯廷斯抽样</h1><p id="57f2" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">与 Gibbs 类似，Metropolis-Hastings 采样也创建了马尔可夫链。但是，它更一般(Gibbs 是特例)，更灵活。</p><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nj"><img src="../Images/2e5c3a98bba4f9fb85e93b41379ce44b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*um5TYQq90FaueIbo.png"/></div></div></figure><p id="d0c2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">给定当前样本，建议分布为我们提供了一个新样本的建议。然后，我们通过检查它比当前样本的可能性大(小)多少来评估其合格性，并考虑建议分布对该样本的可能偏差。综合所有因素，我们计算接受新样本的概率，然后让随机性做出决定。</p><p id="153f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">不言而喻，建议分配的作用是至关重要的，并将影响性能和收敛性。一个更常见的选择是使用当前状态中心的法线。</p></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><h1 id="933a" class="kx ky iq bd kz la na lc ld le nb lg lh li nc lk ll lm nd lo lp lq ne ls lt lu bi translated">动画片</h1><p id="d10c" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">最后来看一些结果。对于每个徽标，运行 Rejection 和 Metropolis-Hastings(使用 PyMC3)并创建可视化(gif)。最重要的超参数:</p><ul class=""><li id="48de" class="mf mg iq ka b kb kc kf kg kj mh kn mi kr mj kv nk ml mm mn bi translated">老化样品:500 个</li><li id="32a8" class="mf mg iq ka b kb mo kf mp kj mq kn mr kr ms kv nk ml mm mn bi translated">样品:10000 个</li></ul><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ma"><img src="../Images/5384ea67f2b50ed7d4b4de6406a51cd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*p0jjq1FCYvujGyJi.png"/></div></div></figure><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/8d1207f5334106c8d07512435b3d5e53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*h8WiyW3NFY9v2yxIA7ftWQ.gif"/></div></div></figure><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/0e2c9fcac7b3de9e20c076a36b317290.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*zgqeB6oAWAyxuCBEXZrdZw.gif"/></div></div></figure><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/da3b17ac57e2180f06c5464941da96cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*koSLHBjM-0dNuEeNu6cHbw.gif"/></div></div></figure><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/340418fbbb1e2da607a6b37c0c842adb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Ti0aYXDZ23mIlX8AiTBAIw.gif"/></div></div></figure><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nm"><img src="../Images/0e43196c9b5d8564f66eaa83c9aed041.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*9lGqi_nMg-UeYh781gfZEQ.gif"/></div></div></figure><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/07f315e20c405763671eec2d66a07c51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*h8xmcXnN6IYOk1Z56kdwMw.gif"/></div></div></figure><figure class="mb mc md me gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nl"><img src="../Images/116a5473f010f08db9e81d774d8192f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*TBqc8bWj-hsD0C3d8am3tQ.gif"/></div></div></figure><p id="411a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于多模态分布，Metropolis-Hastings 可能会陷入某些区域。这是一个非常常见的问题，可以通过改变方案或增加/加长样品链来解决。自然，我们也可以冒险到野外使用一些其他的采样器。</p><p id="f76e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你想更深入地挖掘并查看源代码，请查看本<a class="ae kw" href="https://github.com/jankrepl/creating-animations-with-MCMC/blob/master/main.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir">笔记本</strong> </a>。</p></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><h1 id="2513" class="kx ky iq bd kz la na lc ld le nb lg lh li nc lk ll lm nd lo lp lq ne ls lt lu bi translated">参考</h1><p id="98f3" class="pw-post-body-paragraph jy jz iq ka b kb lv kd ke kf lw kh ki kj lx kl km kn ly kp kq kr lz kt ku kv ij bi translated">1.imcmc:<a class="ae kw" href="https://github.com/ColCarroll/imcmc](https://github.com/ColCarroll/imcmc))" rel="noopener ugc nofollow" target="_blank">https://github.com/ColCarroll/imcmc</a><br/>2。pymc 3:<a class="ae kw" href="https://github.com/pymc-devs/pymc3](https://github.com/pymc-devs/pymc3))" rel="noopener ugc nofollow" target="_blank">https://github.com/pymc-devs/pymc3</a>T11】3。凯文·p·墨菲。2012.机器学习:概率观点。麻省理工学院出版社。</p></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><p id="bd4d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="nn">原载于 2018 年 7 月 11 日</em><a class="ae kw" href="https://jankrepl.github.io/creating-animations-with-MCMC/" rel="noopener ugc nofollow" target="_blank"><em class="nn">jank repl . github . io</em></a><em class="nn">。</em></p></div></div>    
</body>
</html>