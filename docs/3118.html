<html>
<head>
<title>My Journey to Reinforcement Learning — Part 1.5: Simple Binary Image Transformation with Q-Learning</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我的强化学习之旅——第1.5部分:使用Q学习的简单二进制图像转换</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/my-journey-to-reinforcement-learning-part-1-5-57f334189655?source=collection_archive---------8-----------------------#2018-04-10">https://towardsdatascience.com/my-journey-to-reinforcement-learning-part-1-5-57f334189655?source=collection_archive---------8-----------------------#2018-04-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/b2b58c0225561c7639cd0c8137147eea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*pmo_8cVfnOza1eMQZEBuBQ.gif"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk">GIF from this <a class="ae jy" href="https://giphy.com/gifs/cheezburger-robot-nambot-1Mng0gXC5Tpcs/download" rel="noopener ugc nofollow" target="_blank">website</a></figcaption></figure><p id="1c39" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">所以今天，我想用Q-learning解决一个非常简单的问题，希望能让我的理解更加具体。</p><blockquote class="kx ky kz"><p id="d427" class="jz ka la kb b kc kd ke kf kg kh ki kj lb kl km kn lc kp kq kr ld kt ku kv kw ij bi translated"><em class="iq"> **警告**我还在学习RL，我学习东西的方式是通过给自己解释概念，而这篇帖子正是如此。注意，我还在学习这个话题，所以如果你是来学习RL的，我推荐你不要看我的帖子，而是来自UCLA博士生的这个帖子:</em> <a class="ae jy" href="https://medium.com/@m.alzantot/deep-reinforcement-learning-demystified-episode-0-2198c05a6124" rel="noopener"> <strong class="kb ir"> <em class="iq">深度强化学习去神秘化(第0集)</em> </strong> </a></p></blockquote></div><div class="ab cl le lf hu lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ij ik il im in"><p id="7918" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">实验设置</strong></p><div class="ll lm ln lo gt ab cb"><figure class="lp jr lq lr ls lt lu paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><img src="../Images/4e113c43aaa05490ac659a76ab1f0ed1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*jBjElE2pHR10XZ0cHhFQCw.png"/></div></figure><figure class="lp jr lq lr ls lt lu paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><img src="../Images/86e7a0fe00def1b2f8e12ad8af6ea9b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*uwx6rKVvE_y5yWeiUd_35w.png"/></div></figure></div><p id="a8ed" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">左侧图像</strong> →原始图像<br/>→右侧图像 →变换图像<br/>→T16】红色数字 →添加黑色块，共有4个</p><p id="6b9f" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">所以整个实验非常简单，我们想从左边的图像到右边的图像。我们只想在给定的图像中增加4个黑色块。</p></div><div class="ab cl le lf hu lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ij ik il im in"><p id="cb6d" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">Q-学习设置(状态，动作)</strong></p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/418d5b67a460ca4692e3366f9355276c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*vPPmAfMRzmFmKXWMxJnCiw.png"/></div></figure><p id="efc6" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">黑色数字/线条</strong> →将图像分成10个小状态</p><p id="00d1" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">首先，让我们制作状态，因为我们的原始图像的尺寸是10 * 100，让我们把图像分成小方块(10 * 10)，这样我们就有10个方块。</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi lz"><img src="../Images/976868c4767da4cfd8f51510070cb571.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BoPXaLJjbPJy4X9dqG1cUg.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk">Modified Image from <a class="ae jy" href="http://slideplayer.com/slide/8688800/" rel="noopener ugc nofollow" target="_blank">here</a></figcaption></figure><p id="f457" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">所以我们的Q-Learning表看起来会像上面这样。它是一个一维数组，数组的索引是状态，数组中的值是阈值。这意味着我们将有一个阈值过滤器，只让特定的像素强度通过，其他的将被过滤掉。</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi ma"><img src="../Images/b42c92a07f39baa988f0d915c7e51d3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BKc4CzXjLBY3tU4WJaVv1w.png"/></div></div></figure><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/2f92609a3e15aa79491bd5d68012e62b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1146/format:webp/1*tv69Kp5yyZzK10QtAmAscg.png"/></div></figure><p id="1384" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">上面我们可以看到手工制作的地面真值表，我们可以看到零号的索引对准了图像中有黑色块的地方。但是我们想学习这些阈值，而不是手工制作。因此，让我们首先初始化我们的Q表如下，所有的1。</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/e0eda5ed3c1b810d6eb156e813de933a.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*skGeCTenCHoA5Gcrg1x6qA.png"/></div></figure><p id="38af" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">最后，让我们定义奖励可以是什么，因为这让我们简单地对我们有阈值的图像和地面真实图像进行逐位XOR运算。</p></div><div class="ab cl le lf hu lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ij ik il im in"><p id="924f" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">Q-学习设置(奖励-异或不同值)</strong></p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div class="gh gi md"><img src="../Images/96027bbbcd3b98ef52cd339b8f21467e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1262/format:webp/1*7JluzfejwBxlF89XQywvbw.png"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk">Image from this <a class="ae jy" href="http://android.okhelp.cz/drawbitmap-clippath-union-difference-intersect-replace-xor-android-example/" rel="noopener ugc nofollow" target="_blank">website</a></figcaption></figure><p id="eeb1" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">红框</strong> →图像中的异或运算</p><p id="04d9" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">在两幅图像之间进行XOR运算，将会给出这两幅图像之间有多少差异。因此，如果两个图像相同，XOR差值将为0，因为没有差异。否则，如果图像完全不同，我们将获得XOR运算的正值，因为存在巨大的差异。</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi me"><img src="../Images/5d5ecf83b065a188ee0849d7711c5eb3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eZVdjwVBE708-p1WCBqA2g.png"/></div></div></figure><p id="fcfd" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir"> create_data </strong> →阈值运算后创建的图像<br/> <strong class="kb ir">奖励</strong>→create _ data与地面真值之间的异或运算</p><p id="7ef2" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">因为我们的目标是用正确的值填充Q表，所以我们应该减去1并除以最大像素强度，即100。如果阈值是正确的，则奖励1，如果阈值是错误的，则奖励0。</p></div><div class="ab cl le lf hu lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ij ik il im in"><p id="2d5c" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">电子贪婪探索</strong></p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi mf"><img src="../Images/7900e590c3a4f2051696c9d15ca76955.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vvEV4SW9koPyWhalMJ3aSg.png"/></div></div></figure><p id="0628" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">我们将创建一个名为epsilon的变量，根据这个值，我们将更改阈值或保持不变。此外，随着事件数量的增加，我们将采用较小的数量级，为了数值稳定性，我们将添加1e-8。</p></div><div class="ab cl le lf hu lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ij ik il im in"><p id="c46f" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">结果</strong></p><div class="ll lm ln lo gt ab cb"><figure class="lp jr lq lr ls lt lu paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><img src="../Images/4e113c43aaa05490ac659a76ab1f0ed1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*jBjElE2pHR10XZ0cHhFQCw.png"/></div></figure><figure class="lp jr lq lr ls lt lu paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><img src="../Images/968100e24772c1fabbbacced9b6a1d9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*qHj7T5pKUhYXd9wJ62pGlQ.png"/></div></figure></div><div class="ab cb"><figure class="lp jr lq lr ls lt lu paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><img src="../Images/e585e6db1918b6615cb68d26d5249969.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*ukdexn5x9PQSh3DmDbfslg.png"/></div></figure><figure class="lp jr lq lr ls lt lu paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><img src="../Images/968100e24772c1fabbbacced9b6a1d9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*qHj7T5pKUhYXd9wJ62pGlQ.png"/></div></figure></div><p id="bd06" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">左上</strong> →原始图像<br/> <strong class="kb ir">右上</strong> →地面真实图像<br/> <strong class="kb ir">左下</strong> →由学习的Q表值生成的图像<br/> <strong class="kb ir">右下</strong> →由手工制作的Q表值生成的图像</p><p id="0dcf" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">我们的Q表已经错过了一个块，这是第二个黑色块。但是让我们看看原始的Q表结果。</p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi mg"><img src="../Images/e5b8831cf9f86039b5380eabaeeeb085.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uwP-VD-wC_QPoHu7opoM0A.png"/></div></div></figure><p id="8cc8" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">红框</strong> →阈值1的值不正确</p></div><div class="ab cl le lf hu lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ij ik il im in"><p id="2648" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">交互代码</strong></p><figure class="ll lm ln lo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi mh"><img src="../Images/52246775f414cd1cb2bed573d5827a79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wEa9kTu-JtEgQIQR2QP_3Q.png"/></div></div></figure><p id="196c" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><em class="la">对于谷歌Colab，你需要一个谷歌帐户来查看代码，而且你不能在谷歌Colab中运行只读脚本，所以在你的操场上做一个副本。最后，我永远不会请求允许访问你在Google Drive上的文件，仅供参考。编码快乐！</em></p><p id="24c3" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">要获取这篇文章的代码，<a class="ae jy" href="https://colab.research.google.com/drive/1vK9rfNrhujBzK_cLaxiMZ1n_dVoao_q4" rel="noopener ugc nofollow" target="_blank">请点击这里。</a></p></div><div class="ab cl le lf hu lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ij ik il im in"><p id="6be8" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">最后的话</strong></p><p id="369b" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">滑铁卢大学的一位教授已经给出了使用RL来执行分割的示例“<a class="ae jy" href="https://bmcmedimaging.biomedcentral.com/articles/10.1186/1471-2342-8-8" rel="noopener ugc nofollow" target="_blank"> <em class="la">增强学习在经直肠超声图像分割中的应用</em> </a>”我也希望尽快实现该论文。</p><p id="e02f" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">如果发现任何错误(因为我仍在学习，会有很多)，请发电子邮件到jae.duk.seo@gmail.com给我，如果你希望看到我所有写作的列表，请在这里查看我的网站。</p><p id="d430" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">同时，在我的twitter上关注我<a class="ae jy" href="https://twitter.com/JaeDukSeo" rel="noopener ugc nofollow" target="_blank">这里</a>，访问<a class="ae jy" href="https://jaedukseo.me/" rel="noopener ugc nofollow" target="_blank">我的网站</a>，或者我的<a class="ae jy" href="https://www.youtube.com/c/JaeDukSeo" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>了解更多内容。如果你感兴趣的话，我还做了解耦神经网络<a class="ae jy" href="https://becominghuman.ai/only-numpy-implementing-and-comparing-combination-of-google-brains-decoupled-neural-interfaces-6712e758c1af" rel="noopener ugc nofollow" target="_blank">的比较。</a></p></div><div class="ab cl le lf hu lg" role="separator"><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj lk"/><span class="lh bw bk li lj"/></div><div class="ij ik il im in"><p id="4f7a" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">参考</strong></p><ol class=""><li id="1043" class="mi mj iq kb b kc kd kg kh kk mk ko ml ks mm kw mn mo mp mq bi translated">构建Java程序第7章— ppt下载。(2018).Slideplayer.com。检索于2018年4月10日，来自<a class="ae jy" href="http://slideplayer.com/slide/8688800/" rel="noopener ugc nofollow" target="_blank">http://slideplayer.com/slide/8688800/</a></li><li id="e648" class="mi mj iq kb b kc mr kg ms kk mt ko mu ks mv kw mn mo mp mq bi translated">drawBitmap，clipPath，UNION，DIFFERENCE，INTERSECT，REPLACE，XOR Android示例|面向开发者的软件和源代码。(2018).Android . ok help . cz . 2018年4月10日检索，来自<a class="ae jy" href="http://android.okhelp.cz/drawbitmap-clippath-union-difference-intersect-replace-xor-android-example/" rel="noopener ugc nofollow" target="_blank">http://Android . ok help . cz/draw bitmap-clip path-union-difference-intersect-replace-xor-Android-example/</a></li><li id="49b1" class="mi mj iq kb b kc mr kg ms kk mt ko mu ks mv kw mn mo mp mq bi translated">f .萨赫巴、h .提祖什和m .萨拉马(2008年)。强化学习在经直肠超声图像分割中的应用。BMC医学影像，8(1)。doi:10.1186/1471–2342–8–8</li></ol></div></div>    
</body>
</html>