<html>
<head>
<title>Data Visualization with Bokeh in Python, Part II: Interactions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Python中的散景进行数据可视化，第二部分:交互</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-visualization-with-bokeh-in-python-part-ii-interactions-a4cf994e2512?source=collection_archive---------0-----------------------#2018-03-20">https://towardsdatascience.com/data-visualization-with-bokeh-in-python-part-ii-interactions-a4cf994e2512?source=collection_archive---------0-----------------------#2018-03-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/c4d70603fbb862995bb676db9e04ddbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6ROhPANEBYJb8om0kVDVyQ.jpeg"/></div></div></figure><div class=""/><p id="9d4a" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka jc">超越静态图</strong></p><p id="823a" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在本系列的<a class="ae kw" rel="noopener" target="_blank" href="/data-visualization-with-bokeh-in-python-part-one-getting-started-a11655a467d4">第一部分</a>中，我们在<a class="ae kw" href="https://bokeh.pydata.org/en/latest/" rel="noopener ugc nofollow" target="_blank">散景</a>中创建了一个基本的直方图，这是一个强大的Python可视化库。最终结果显示了2013年从纽约市出发的航班的到达延迟分布，如下所示(带有漂亮的工具提示！):</p><figure class="ky kz la lb gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi kx"><img src="../Images/330576e68ba3c42696db27ec25a2d0e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rNBU4zoqIk_iEzMGufiRhg.png"/></div></div></figure><p id="190a" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这张图表完成了工作，但它并不是很吸引人！观众可以看到航班延误的分布几乎是正常的(有轻微的正偏差)，但他们没有理由花超过几秒钟的时间看这个数字。</p><p id="19d3" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们想创建更引人入胜的可视化，我们可以允许用户通过交互自己探索数据。例如，在这个直方图中，一个有价值的特性是能够选择特定的航空公司进行比较，或者可以选择改变条块的宽度，以便更详细地检查数据。幸运的是，这两个功能我们都可以使用散景添加到现有的绘图之上。直方图的最初发展可能看起来涉及到一个简单的绘图，但现在我们看到了使用像散景这样强大的库的好处！</p><p id="3fe3" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个系列的所有代码<a class="ae kw" href="https://github.com/WillKoehrsen/Bokeh-Python-Visualization/tree/master/interactive" rel="noopener ugc nofollow" target="_blank">都可以在GitHub </a>上获得。我鼓励任何人查看它的所有数据清理细节(数据科学中令人乏味但必要的部分),并对代码进行实验！(对于交互式散景图，我们仍然可以使用Jupyter笔记本来显示结果，或者我们可以编写Python脚本并运行散景服务器。对于开发，我通常在Jupyter笔记本上工作，因为它更容易快速迭代和改变情节，而不必重启服务器。然后我移动到一个服务器来显示最终结果。你可以在GitHub上看到独立的脚本和完整的笔记本。)</p><h1 id="0f9a" class="lc ld jb bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">积极互动</h1><p id="ed33" class="pw-post-body-paragraph jy jz jb ka b kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr me kt ku kv ij bi translated">在散景中有两类交互:被动和主动。第一部分介绍的被动交互也被称为检查器，因为它们允许用户更详细地检查图形，但不改变显示的信息。一个例子是当用户将鼠标悬停在数据点上时出现的工具提示:</p><figure class="ky kz la lb gt is gh gi paragraph-image"><div class="gh gi mf"><img src="../Images/d910c33a8be2d0511d1996635e339ef5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*3A33DOx2NL0h53SfsgPrzg.png"/></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk">Tooltip, a passive interactor</figcaption></figure><p id="2d70" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">第二类交互称为主动交互，因为它改变了图上显示的实际数据。这可以是从选择数据的子集(例如特定的航空公司)到改变多项式回归拟合的程度的任何事情。在Bokeh 中有多种类型的<a class="ae kw" href="https://bokeh.pydata.org/en/latest/docs/user_guide/interaction.html" rel="noopener ugc nofollow" target="_blank">主动交互，但这里我们将重点放在所谓的“小部件”上，这些部件可以点击，并让用户控制情节的某些方面。</a></p><figure class="ky kz la lb gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mk"><img src="../Images/2c3970252c54217998c3bd2de31776bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:424/format:webp/1*3DV5TiCbiSSmEck5BhOjnQ.png"/></div></div></figure><figure class="ky kz la lb gt is gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/b2ad7c570fa76244c3e2d80597ec8ace.png" data-original-src="https://miro.medium.com/v2/resize:fit:438/format:webp/1*1lcSC9fMxSd2nqul_twj2Q.png"/></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk">Example of Widgets (dropdown button and radio button group)</figcaption></figure><p id="361f" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当我查看图表时，我喜欢玩主动交互(<a class="ae kw" href="http://flowingdata.com/2018/01/23/the-demographics-of-others/" rel="noopener ugc nofollow" target="_blank">比如FlowingData </a>上的那些)，因为它们允许我自己探索数据。我发现自己从数据中发现结论(在设计师的指导下)比从完全静态的图表中发现结论更有洞察力。此外，给用户一些自由，允许他们带着稍微不同的解释离开，这可以产生关于数据集的有益讨论。</p><h1 id="f3a0" class="lc ld jb bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">互动大纲</h1><p id="d933" class="pw-post-body-paragraph jy jz jb ka b kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr me kt ku kv ij bi translated">一旦我们开始添加主动交互，我们需要超越单行代码，进入封装特定动作的功能。对于散景小部件交互，有三个主要功能需要实现:</p><ul class=""><li id="0fd1" class="mm mn jb ka b kb kc kf kg kj mo kn mp kr mq kv mr ms mt mu bi translated"><code class="fe mv mw mx my b">make_dataset()</code>格式化要显示的具体数据</li><li id="00cd" class="mm mn jb ka b kb mz kf na kj nb kn nc kr nd kv mr ms mt mu bi translated"><code class="fe mv mw mx my b">make_plot()</code>用指定的数据绘制图形</li><li id="d1a6" class="mm mn jb ka b kb mz kf na kj nb kn nc kr nd kv mr ms mt mu bi translated"><code class="fe mv mw mx my b">update() </code>根据用户选择更新情节</li></ul><h2 id="4191" class="ne ld jb bd le nf ng dn li nh ni dp lm kj nj nk lq kn nl nm lu kr nn no ly np bi translated">格式化数据</h2><p id="e83c" class="pw-post-body-paragraph jy jz jb ka b kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr me kt ku kv ij bi translated">在绘制图表之前，我们需要规划出将要显示的数据。对于我们的交互式直方图，我们将为用户提供三个可控参数:</p><ol class=""><li id="2c62" class="mm mn jb ka b kb kc kf kg kj mo kn mp kr mq kv nq ms mt mu bi translated">显示的航空公司(代码中称为承运人)</li><li id="ab90" class="mm mn jb ka b kb mz kf na kj nb kn nc kr nd kv nq ms mt mu bi translated">图上的延迟范围，例如:-60到+120分钟</li><li id="f5ea" class="mm mn jb ka b kb mz kf na kj nb kn nc kr nd kv nq ms mt mu bi translated">直方图框的宽度，默认为5分钟</li></ol><p id="256b" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于为绘图生成数据集的函数，我们需要允许指定这些参数中的每一个。为了通知我们将如何在我们的<code class="fe mv mw mx my b">make_dataset</code>函数中转换数据，让我们加载所有相关的数据并进行检查。</p><figure class="ky kz la lb gt is gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/ec89f7ea599799cc9cd5d103f683baef.png" data-original-src="https://miro.medium.com/v2/resize:fit:574/format:webp/1*oGphn8rw5GEmy9-tnHanuA.png"/></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk">Data for histogram</figcaption></figure><p id="c902" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这个数据集中，每一行都是一个单独的航班。<code class="fe mv mw mx my b">arr_delay</code>栏是以分钟为单位的航班到达延迟(负数表示航班提前)。在第一部分中，我们做了一些数据探索，知道有327，236个航班的最小延迟为-86分钟，最大延迟为+1272分钟。在<code class="fe mv mw mx my b">make_dataset</code>功能中，我们希望根据数据框中的<code class="fe mv mw mx my b">name</code>列选择航空公司，并通过<code class="fe mv mw mx my b">arr_delay</code>列限制航班。</p><p id="d404" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了生成直方图的数据，我们使用numpy函数<code class="fe mv mw mx my b">histogram</code>,它计算每个面元中数据点的数量。在我们的例子中，这是每个指定的延误间隔中的航班数量。对于第一部分，我们为所有航班制作了一个直方图，但现在我们将按每个承运人制作。由于每个承运人的航班数量差异很大，我们可以按比例而不是原始数量显示延误。也就是说，图上的高度对应于特定航空公司的所有航班在相应仓中有延迟的部分。为了从数量到比例，我们将数量除以航空公司的总数量。</p><p id="f94f" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下面是创建数据集的完整代码。该函数接收我们想要包含的载波列表、要绘制的最小和最大延迟以及以分钟为单位的指定bin宽度。</p><figure class="ky kz la lb gt is"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="d0f6" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">(我知道这是一个关于散景的帖子，但是没有格式化的数据是无法做出图形的，所以我附上了演示我的方法的代码！)</p><p id="3a00" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对所有载体运行该功能的结果如下:</p><figure class="ky kz la lb gt is gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/fc0dc0179899e0477a4c7519c795871f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1202/format:webp/1*yKvJztYW6m6k07FxaqdadQ.png"/></div></figure><p id="88cf" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">提醒一下，我们使用散景<code class="fe mv mw mx my b">quad</code>字形来制作直方图，所以我们需要提供字形的左、右和顶部(底部固定为0)。这些分别在<code class="fe mv mw mx my b">left</code>、<code class="fe mv mw mx my b">right</code>和<code class="fe mv mw mx my b">proportion</code>栏中。颜色列为每个载体提供了独特的颜色，而<code class="fe mv mw mx my b">f_</code>列为工具提示提供了格式化的文本。</p><p id="4c3b" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">下一个要实现的功能是<code class="fe mv mw mx my b">make_plot</code>。该函数应接受一个column data source<a class="ae kw" href="https://bokeh.pydata.org/en/latest/docs/reference/models/sources.html" rel="noopener ugc nofollow" target="_blank">(Bokeh中用于绘图的特定类型的对象)</a>，并返回绘图对象:</p><figure class="ky kz la lb gt is"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="4830" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果我们传入一个包含所有航空公司的源，该代码会给出以下图表:</p><figure class="ky kz la lb gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nv"><img src="../Images/5a4be576c062ca37d365be760c8f795d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-IcPPBWctsiOuh870pRbJg.png"/></div></div></figure><p id="014d" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个直方图非常混乱，因为在同一张图上有16家航空公司！如果我们想比较航空公司，由于信息重叠，这几乎是不可能的。幸运的是，我们可以添加一些小部件来使情节更加清晰，并实现快速比较。</p><h2 id="c84e" class="ne ld jb bd le nf ng dn li nh ni dp lm kj nj nk lq kn nl nm lu kr nn no ly np bi translated">创建小部件交互</h2><p id="005a" class="pw-post-body-paragraph jy jz jb ka b kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr me kt ku kv ij bi translated">一旦我们在散景中创建了一个基本图形，通过小部件添加交互就相对简单了。我们想要的第一个小部件是一个选择框，允许查看者选择要显示的航空公司。这个控件将是一个复选框，允许尽可能多的选择，在Bokeh中称为<code class="fe mv mw mx my b">CheckboxGroup.</code>来制作选择工具，我们导入<code class="fe mv mw mx my b">CheckboxGroup</code>类并创建一个带有两个参数的实例，<code class="fe mv mw mx my b">labels</code>:我们希望显示在每个框旁边的值和<code class="fe mv mw mx my b">active</code>:被选中的初始框。下面是为所有运营商创建一个<code class="fe mv mw mx my b">CheckboxGroup</code>的代码。</p><pre class="ky kz la lb gt nw my nx ny aw nz bi"><span id="681d" class="ne ld jb my b gy oa ob l oc od">from bokeh.models.widgets import CheckboxGroup</span><span id="6b75" class="ne ld jb my b gy oe ob l oc od"># Create the checkbox selection element, available carriers is a  <br/># list of all airlines in the data<br/>carrier_selection = CheckboxGroup(labels=available_carriers, <br/>                                  active = [0, 1])</span></pre><figure class="ky kz la lb gt is gh gi paragraph-image"><div class="gh gi of"><img src="../Images/196c3df655d97c18fd59013a563a7037.png" data-original-src="https://miro.medium.com/v2/resize:fit:442/format:webp/1*XpJfjyKacHR2VwdCIed-wA.png"/></div><figcaption class="mg mh gj gh gi mi mj bd b be z dk">CheckboxGroup widget</figcaption></figure><p id="3355" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">散景复选框中的标签必须是字符串，而有效值是整数。这意味着在图像中,“穿越航空公司”映射到活动值0，而“阿拉斯加航空公司”映射到活动值1。当我们想要将选中的复选框与航空公司匹配时，我们需要确保找到与选中的<em class="og">整数</em>有效值相关联的<em class="og">字符串</em>名称。我们可以使用小部件的<code class="fe mv mw mx my b">.labels</code>和<code class="fe mv mw mx my b">.active </code>属性来做到这一点:</p><pre class="ky kz la lb gt nw my nx ny aw nz bi"><span id="b931" class="ne ld jb my b gy oa ob l oc od"># Select the airlines names from the selection values<br/>[carrier_selection.labels[i] for i in carrier_selection.active]</span><span id="e5f8" class="ne ld jb my b gy oe ob l oc od"><strong class="my jc">['AirTran Airways Corporation', 'Alaska Airlines Inc.']</strong></span></pre><p id="a0e7" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在制作了选择小部件之后，我们现在需要将选中的航空公司复选框链接到图表上显示的信息。这是使用CheckboxGroup的<code class="fe mv mw mx my b">.on_change</code>方法和我们定义的<code class="fe mv mw mx my b">update</code>函数来完成的。更新函数总是采用三个参数:<code class="fe mv mw mx my b">attr, old, new</code>并根据选择控件更新绘图。我们改变图表上显示的数据的方法是改变我们传递给<code class="fe mv mw mx my b">make_plot</code>函数中的字形的数据源。这听起来可能有点抽象，所以这里有一个<code class="fe mv mw mx my b">update</code>函数的例子，它改变直方图以显示所选的航空公司:</p><pre class="ky kz la lb gt nw my nx ny aw nz bi"><span id="9305" class="ne ld jb my b gy oa ob l oc od"># Update function takes three default parameters<br/>def update(attr, old, new):<br/>    # Get the list of carriers for the graph<br/>    carriers_to_plot = [carrier_selection.labels[i] for i in <br/>                        carrier_selection.active]</span><span id="17b2" class="ne ld jb my b gy oe ob l oc od">    # Make a new dataset based on the selected carriers and the <br/>    # make_dataset function defined earlier<br/>    new_src = make_dataset(carriers_to_plot,<br/>                           range_start = -60,<br/>                           range_end = 120,<br/>                           bin_width = 5)</span><span id="85af" class="ne ld jb my b gy oe ob l oc od">    # Update the source used in the quad glpyhs<br/>    src.data.update(new_src.data)</span></pre><p id="86d9" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里，我们根据从CheckboxGroup中选择的航空公司检索要显示的航空公司列表。这个列表被传递给<code class="fe mv mw mx my b">make_dataset</code>函数，该函数返回一个新的列数据源。我们通过调用<code class="fe mv mw mx my b">src.data.update</code>并传递来自新源的数据来更新字形中使用的源的数据。最后，为了将<code class="fe mv mw mx my b">carrier_selection</code>小部件中的更改链接到<code class="fe mv mw mx my b">update</code>函数，我们必须使用<code class="fe mv mw mx my b">.on_change </code>方法(称为<a class="ae kw" href="https://bokeh.pydata.org/en/latest/docs/user_guide/interaction/widgets.html" rel="noopener ugc nofollow" target="_blank">事件处理程序</a>)。</p><pre class="ky kz la lb gt nw my nx ny aw nz bi"><span id="727d" class="ne ld jb my b gy oa ob l oc od"># Link a change in selected buttons to the update function<br/>carrier_selection.on_change('active', update)</span></pre><p id="3ef8" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">每当选择或取消选择一个不同的航线时，这个函数就调用update函数。最终结果是，直方图上只绘制了与所选航空公司相对应的图示符，如下所示:</p><figure class="ky kz la lb gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oh"><img src="../Images/ee214ef175cd50c62b7c49a275348bb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*z36QoTv4AnbJqHLmKkLTZQ.gif"/></div></div></figure><h2 id="354e" class="ne ld jb bd le nf ng dn li nh ni dp lm kj nj nk lq kn nl nm lu kr nn no ly np bi translated">更多控件</h2><p id="90d4" class="pw-post-body-paragraph jy jz jb ka b kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr me kt ku kv ij bi translated">现在我们知道了创建控件的基本工作流程，我们可以添加更多的元素。每次，我们创建一个小部件，编写一个更新函数来改变绘图上显示的数据，并用一个事件处理程序将更新函数链接到小部件。我们甚至可以对多个元素使用相同的更新函数，方法是重写该函数，从小部件中提取我们需要的值。为了练习，我们将添加两个额外的控件:一个滑块，用于选择直方图的框宽度；一个RangeSlider，用于设置要显示的最小和最大延迟。下面是制作这两个小部件和新的更新功能的代码:</p><figure class="ky kz la lb gt is"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="e62c" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">标准滑块和范围滑块如下所示:</p><figure class="ky kz la lb gt is gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/b06f6e39fcde0dd71fde230a24626153.png" data-original-src="https://miro.medium.com/v2/resize:fit:608/format:webp/1*QlrjWBxnHcBjHp24Xq2M3Q.png"/></div></figure><p id="6be8" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果需要，除了使用更新功能显示的数据之外，我们还可以更改绘图的其他方面。例如，要更改标题文本以匹配框的宽度，我们可以:</p><pre class="ky kz la lb gt nw my nx ny aw nz bi"><span id="4a84" class="ne ld jb my b gy oa ob l oc od"># Change plot title to match selection<br/>bin_width = binwidth_select.value<br/>p.title.text = 'Delays with %d Minute Bin Width' % bin_width</span></pre><p id="31b2" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在散景中还有许多其他类型的交互，但是现在，我们的三个控件允许用户在图表上尽情“玩”！</p><h1 id="e2a8" class="lc ld jb bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">把所有的放在一起</h1><p id="d531" class="pw-post-body-paragraph jy jz jb ka b kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr me kt ku kv ij bi translated">我们互动剧情的所有元素都已就位。我们有三个必要的函数:<code class="fe mv mw mx my b">make_dataset</code>、<code class="fe mv mw mx my b">make_plot</code>和<code class="fe mv mw mx my b">update</code>来根据控件和小部件本身改变情节。我们通过定义布局将所有这些元素连接到一个页面上。</p><pre class="ky kz la lb gt nw my nx ny aw nz bi"><span id="1387" class="ne ld jb my b gy oa ob l oc od">from bokeh.layouts import column, row, WidgetBox<br/>from bokeh.models import Panel<br/>from bokeh.models.widgets import Tabs</span><span id="88c8" class="ne ld jb my b gy oe ob l oc od"># Put controls in a single element<br/>controls = WidgetBox(carrier_selection, binwidth_select, range_select)<br/>    <br/># Create a row layout<br/>layout = row(controls, p)<br/>    <br/># Make a tab with the layout <br/>tab = Panel(child=layout, title = 'Delay Histogram')<br/>tabs = Tabs(tabs=[tab])</span></pre><p id="f820" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我将整个布局放在一个选项卡上，当我们制作一个完整的应用程序时，我们可以将每个图放在一个单独的选项卡上。所有这些工作的最终结果如下:</p><figure class="ky kz la lb gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oh"><img src="../Images/9f8afeccb2f1cf8f8cd4475b0adf82b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*5xN0M2CT1yAvpnzWM-bMhg.gif"/></div></div></figure><p id="1c85" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以在<a class="ae kw" href="https://github.com/WillKoehrsen/Bokeh-Python-Visualization/tree/master/interactive/exploration" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上随意查看代码和情节。</p><h1 id="cca2" class="lc ld jb bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">下一步措施和结论</h1><p id="d8e2" class="pw-post-body-paragraph jy jz jb ka b kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr me kt ku kv ij bi translated">本系列的下一部分将着眼于我们如何制作一个包含多个情节的完整应用程序。我们将能够在服务器上显示我们的工作，并在浏览器中访问它，创建一个完整的仪表板来探索数据集。</p><p id="9994" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们可以看到最后的互动剧情比原著有用多了！现在，我们可以比较航空公司之间的延迟，并改变箱的宽度/范围，以查看分布是如何受到影响的。增加交互性提高了绘图的价值，因为它增加了与数据的接触，并允许用户通过自己的探索得出结论。尽管设置初始情节很复杂，但我们看到了如何轻松地向现有图形添加元素和控制小部件。与matplotlib等快速简单的工具相比，使用Bokeh等较重的绘图库的好处是绘图和交互的可定制性。不同的可视化库有不同的优势和用例，但是当我们想要增加额外的交互维度时，散景是一个很好的选择。希望在这一点上，你有足够的信心开始开发自己的可视化，并请分享你创造的任何东西！</p><p id="b579" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我欢迎反馈和建设性的批评，可以通过Twitter <a class="ae kw" href="https://twitter.com/koehrsen_will" rel="noopener ugc nofollow" target="_blank"> @koehrsen_will </a>联系到我。</p></div></div>    
</body>
</html>