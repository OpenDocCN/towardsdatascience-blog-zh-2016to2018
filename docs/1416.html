<html>
<head>
<title>Why am I Chucking the Tensorflow Queue based Data Input Pipeline</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么我放弃了基于Tensorflow队列的数据输入管道</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/why-am-i-chucking-the-tensorflow-queue-based-data-input-pipeline-5b4427735a0d?source=collection_archive---------4-----------------------#2017-09-02">https://towardsdatascience.com/why-am-i-chucking-the-tensorflow-queue-based-data-input-pipeline-5b4427735a0d?source=collection_archive---------4-----------------------#2017-09-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/760cffb733b05e490cb07ffbab4aa47b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*V2xuraIrNvGDNUkV.gif"/></div></div></figure><p id="5b01" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Post假设对Tensorflow有一些基本的了解。主要是我在抱怨输入管道的问题😆</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="f6b1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我最近在使用基于Tensorflow数据输入管道的<a class="ae ld" href="https://www.tensorflow.org/programmers_guide/threading_and_queues" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir">旧</strong> </a>队列时遇到了困难。没什么大不了的，但从设计的角度来看，这似乎不太对。Tensorflow团队确实意识到了其旧设计的问题，并提出了一个问题(<a class="ae ld" href="https://github.com/tensorflow/tensorflow/issues/7951" rel="noopener ugc nofollow" target="_blank"> Issue #7951 </a>)以进行彻底的设计更改(事实上，问题描述中说的是“从头开始”)。当我开始学习/使用输入管道时，新的设计还没有出现(尽管这个问题已经提出来了)。).鉴于我已经在学习和实验方面投入了一些时间，我想继续使用旧的设计。</p><p id="b436" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我决定用在我的<a class="ae ld" href="https://bitbucket.org/hawk23/trafficsignsense/src" rel="noopener ugc nofollow" target="_blank"> TrafficSignSense </a>(嗯，现在报废了)项目中。我创建了一个抽象，因为基于队列的管道本身非常分散。我决定将它放在“创建-启动-清理”抽象中(供参考):</p><figure class="le lf lg lh gt jr"><div class="bz fp l di"><div class="li lj l"/></div></figure><p id="03a7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">回到这个问题，train程序看起来像这样:</p><figure class="le lf lg lh gt jr"><div class="bz fp l di"><div class="li lj l"/></div></figure><p id="9ec3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当我需要定期验证我的模型时，问题就出现了。</p><pre class="le lf lg lh gt lk ll lm ln aw lo bi"><span id="9e38" class="lp lq iq ll b gy lr ls l lt lu">eval_list = [train_optimizer, merged_summary, model_loss,              train_accuracy, valid_accuracy]        <br/>for i in range(NUM_EPOCHS):            <br/>    _, summary, loss, accuracy_t, accuracy_v = sess.run(eval_list)                       <br/>    train_writer.add_summary(summary)</span></pre><p id="5bb0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当我们试图评估<code class="fe lv lw lx ll b">valid_accuracy</code>时，毫不奇怪你得到的是错误的结果。它基本上是随机选择权重。请注意，我正在重新创建模型(<code class="fe lv lw lx ll b">model_v = model.CTrafficModel(batch_valid_input, NUM_CLASSES</code>)，这正是主要问题所在。我必须为验证数据重新创建模型，因为这是我使用输入管道输入数据的唯一方式。我“也许”可以用检查站来解决这个问题。但是，这似乎不对。我认为检查点是训练验证过程的输出，在推理时间或训练恢复的情况下使用。训练和验证是紧密耦合的，我不喜欢为了验证而每隔几个迭代就抛弃权重并重新加载的想法。我也不喜欢仅仅因为数据改变就重新创建模型的想法(假设模型保持不变)。</p><p id="80af" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">以上只是输入管道的旧设计的几个问题。归档的问题描述了许多其他相关的问题。我最终决定永远放弃它。</p><h2 id="03b7" class="lp lq iq bd ly lz ma dn mb mc md dp me kj mf mg mh kn mi mj mk kr ml mm mn mo bi translated">那么，接下来呢？</h2><p id="83dc" class="pw-post-body-paragraph jy jz iq ka b kb mp kd ke kf mq kh ki kj mr kl km kn ms kp kq kr mt kt ku kv ij bi translated">作为替代，Tensorflow拥有<code class="fe lv lw lx ll b">Dataset</code>和<code class="fe lv lw lx ll b">Iterator</code>API，可以轻松创建输入管道(他们是这么说的)。我还没看完。Tensorflow也有这些<code class="fe lv lw lx ll b">Estimator</code>和<code class="fe lv lw lx ll b">Experiment</code>高级抽象。我打算和<code class="fe lv lw lx ll b">Dataset-Iterator</code>一起使用。希望他们让手头的任务变得容易！！！</p></div></div>    
</body>
</html>