<html>
<head>
<title>Visualizing Gradient Descent</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">可视化梯度下降</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/gradient-descent-d3a58eb72404?source=collection_archive---------13-----------------------#2018-11-20">https://towardsdatascience.com/gradient-descent-d3a58eb72404?source=collection_archive---------13-----------------------#2018-11-20</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><p id="6090" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">梯度下降是一种非常强大的算法，是许多现代机器学习算法的基础。我们将涵盖对什么是梯度下降的直观理解，它如何连接到微积分，以及我们如何在数据科学中使用它。</p><p id="604c" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">目标</strong></p><ul class=""><li id="61a5" class="ko kp it js b jt ju jx jy kb kq kf kr kj ks kn kt ku kv kw bi translated">使用汽车数据集预测 MPG</li><li id="627e" class="ko kp it js b jt kx jx ky kb kz kf la kj lb kn kt ku kv kw bi translated">理解术语<strong class="js iu">残差</strong>的含义以及它如何定义我们的成本函数</li><li id="d51c" class="ko kp it js b jt kx jx ky kb kz kf la kj lb kn kt ku kv kw bi translated">对误差函数求微分以找到最小值</li></ul><p id="c136" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">要求</p><ul class=""><li id="ede4" class="ko kp it js b jt ju jx jy kb kq kf kr kj ks kn kt ku kv kw bi translated">以前有机器学习和微积分的经验</li></ul><h2 id="b77e" class="lc ld it bd le lf lg dn lh li lj dp lk kb ll lm ln kf lo lp lq kj lr ls lt lu bi translated"><strong class="ak">入门:下载数据</strong></h2><p id="fa19" class="pw-post-body-paragraph jq jr it js b jt lv jv jw jx lw jz ka kb lx kd ke kf ly kh ki kj lz kl km kn im bi translated">对于本教程，我们必须做的第一件事是下载我们在示例中使用的数据集。我发现了一个数据集，其中有汽车的 mpg，我将在教程中使用。<a class="ae ma" href="https://figshare.com/articles/Motor_Trend_Car_Road_Tests/3122005" rel="noopener ugc nofollow" target="_blank">这里是下载数据集的链接，请跟随</a>。否则，你可以只是跟着视觉。如果您想在本教程的任何一个步骤上得到帮助，请在这里与我预约时间！T11】</p><p id="3124" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">下载完成后，我们先来找一个与汽车 MPG 关联度高的变量。正如你在下图中看到的，汽车的<strong class="js iu">重量</strong>与汽车每加仑行驶的英里数有很高的(负)相关性。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mb"><img src="../Images/3ce50c557b0d7febfe4227a7e55987b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*l0wQif6olWRv2KXLZuPxJg.png"/></div></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk">Weight is in tons</figcaption></figure><p id="d2a0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">看着这幅图，你可以想象一条线，它能很好地表现数据。让我们在没有机器帮助的情况下做几次尝试来想出一条线。</p><p id="3c80" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">对我来说，它看起来像是有一个截距与<strong class="js iu"> y 轴</strong>大约 45 英里/加仑。同样，看起来它与 x 轴<strong class="js iu">在 5°左右相交。利用这一点，我可以用<a class="ae ma" href="http://www.webmath.com/equline1.html" rel="noopener ugc nofollow" target="_blank">这个工具画出一条线来表示这些数据。</a></strong></p><p id="4eeb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这又给了我一个方程式<strong class="js iu"> y = -34/5 * x + 45 || </strong>让我们画出这个图，看看它是什么样子:</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mr"><img src="../Images/14cf03910195ccbd877095c6481f8eff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*goQsNSH6KFZe39gVDCHTWg.png"/></div></div></figure><p id="b5cf" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">正如你所看到的，我们的线条很好地表现了数据，但它并不完美…因此，让我们尝试找出一种方法来衡量它与数据的吻合程度…</p><p id="9b23" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们将定义一个叫做残差的东西，它是从我们的直线到我们的点的距离。在这种情况下，我们可以想象，我们想要最小化从每个点到我们的线的距离，然后最后，我们想要选择总体上最接近所有点的线。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mb"><img src="../Images/544268b738ff726472682fe64677e2b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xkI3XgyZsal-IljqaR2jRA.png"/></div></div><figcaption class="mn mo gj gh gi mp mq bd b be z dk">Residuals in Red</figcaption></figure><p id="a68d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这里我们可以看到残差是每个点到预测线的距离。我们可以对所有残差的绝对值求和，然后用这个来看看我们的模型表现如何。在这条线的例子中，代表这条线与数据拟合程度的单一值是 115.75。让我们开始玩我们的线，以更好地了解如何尽量减少这种残留。</p><p id="8b57" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">首先，我们将保持斜率不变，并改变截距。我们可以想象这是如何改变情节的，图例告诉我们<strong class="js iu">剩余分数</strong>，这样我们就可以将其与我们的第一行进行比较！</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi ms"><img src="../Images/78821aaecff8d88ac76d3af3d1cecf49.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p0eT0xZUoULXYl24MIYZ7Q.png"/></div></div></figure><p id="58c1" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在此图中，您可以看到，只要改变截距，我们的剩余分数就会根据直线的拟合程度而增加或减少！我们可以仔细看看，实际上画出每条线的残差，开始了解最大值或最小值出现在哪里。事实上，我们将把每条线的残差称为<strong class="js iu">损失函数。</strong>想通了这一点，我所说的开始变得有意义了。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi mt"><img src="../Images/48caa8593a45c44bac0c6ee45c6b705c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4C0twb67ZcDnYWPBNy3AbA.png"/></div></div></figure><p id="fd01" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">您可以在这里看到，根据我们改变 y 轴截距的程度，我们会得到不同的残值。<strong class="js iu">而且损失函数有最小值。</strong>这意味着我们可以用数值方法找到函数的最小值，这个最小值就是最佳拟合线。</p><blockquote class="mu"><p id="bff8" class="mv mw it bd mx my mz na nb nc nd kn dk translated">最佳拟合线是最小化所有参数的残差的线</p></blockquote><p id="6bff" class="pw-post-body-paragraph jq jr it js b jt ne jv jw jx nf jz ka kb ng kd ke kf nh kh ki kj ni kl km kn im bi translated">让我们回到之前的等式。它的形式是<strong class="js iu"> y = m *x + b </strong>或者如果你在做线性回归，它会是下面的形式:</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/5b4532763719972a4021aa3376e08c8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:496/format:webp/1*BURa4EOm052aA3gI5VmOjQ.png"/></div></figure><p id="684b" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们一直在看，当β_ 1 系数改变时会发生什么。在另一个世界里，我们可以看到β_ 0 是如何改变残差的。在这种情况下，我们会查看改变斜率的残差，并将其最小化。</p><p id="1db0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">在一个不同的例子中，你可以假设我们可以从许多不同的变量预测 MPG。然后，可以对这些变量中的每一个进行调整，以最小化残差，从而为所有参数创建最准确的预测。不过，要做到这一点，我们需要非常清楚地定义一个<em class="nk">残差</em>函数，以便我们知道我们在测量什么。在我们的二维例子中，这看起来像下面这样(但是记住我们总是可以推广到一个更高维的空间)</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi nl"><img src="../Images/17a25b63df9eec0d4cbeee8234e42f22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ltga4CucHRCR8gSv54w-8g.png"/></div></div></figure><p id="c57a" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">既然我们已经清楚地定义了误差函数，我们可以对β_ 0 和β_ 1 进行微分。这将允许我们建立我们的最小化问题，然后利用微积分找到最小残差。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/609eba6b3322fe28ec433c7c2c693a1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1348/format:webp/1*TRaxYuVjn15RGlfC77bw3A.png"/></div></figure><p id="77d0" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">我们现在可以从任意的 B_0 和 B_1 开始，每次把它插入到我们的部分函数中，然后根据我们的部分函数选择一个新的猜测。</p><p id="0bb2" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">每次我们都会根据偏方程是正还是负来选择一个新的猜测。这个跳跃的大小被称为<strong class="js iu">学习率</strong>。</p><p id="fc27" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">这是优化许多机器学习技术的基础，并且表现非常好。为了实现，我会使用一个内置的库，但理解底层的数学总是一个加分。</p><p id="9b61" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">本教程只是触及了这个主题的表面，但是为了更深入一点，这里有一些我们没有真正谈论过的主题:</p><p id="673d" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated">凸性——在我们的线性回归问题中，只有一个最小值。我们的误差面是<a class="ae ma" href="http://en.wikipedia.org/wiki/Convex_function" rel="noopener ugc nofollow" target="_blank">凸</a>。不管我们从哪里开始，我们最终都会达到绝对最小值。一般来说，情况不必如此。梯度搜索可能会陷入局部极小值。有几种方法可以减轻这种情况(例如，<a class="ae ma" href="http://en.wikipedia.org/wiki/Stochastic_gradient_descent" rel="noopener ugc nofollow" target="_blank">随机梯度搜索</a>)。</p><p id="d1fb" class="pw-post-body-paragraph jq jr it js b jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn im bi translated"><strong class="js iu">收敛</strong> —我们没有讨论如何确定搜索何时找到解。这通常是通过寻找迭代间误差的微小变化来实现的(例如，梯度接近零的地方)。</p><figure class="mc md me mf gt mg gh gi paragraph-image"><div role="button" tabindex="0" class="mh mi di mj bf mk"><div class="gh gi nn"><img src="../Images/a4dfe4288063f7ff327e535cdba0dc53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*huvbsdKFNJp45SoOcgwmHw.png"/></div></div></figure></div></div>    
</body>
</html>