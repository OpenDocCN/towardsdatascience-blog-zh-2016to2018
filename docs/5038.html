<html>
<head>
<title>Where can I fly to from my home town?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我能从我的家乡飞到哪里？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/where-can-i-fly-to-from-my-home-town-72aaf5b3b223?source=collection_archive---------13-----------------------#2018-09-23">https://towardsdatascience.com/where-can-i-fly-to-from-my-home-town-72aaf5b3b223?source=collection_archive---------13-----------------------#2018-09-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="ba7d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">任何经常旅行的人都想知道航空公司从他们居住的地方提供什么路线。通常的方法是使用航班搜索服务，如<a class="ae kl" href="https://www.skyscanner.net/" rel="noopener ugc nofollow" target="_blank"> Skyscanner </a>、<a class="ae kl" href="https://www.google.com/flights" rel="noopener ugc nofollow" target="_blank"> Google Flights </a>或<a class="ae kl" href="http://momondo.com/" rel="noopener ugc nofollow" target="_blank"> Momondo </a>，并动态地发现答案(同时检查机票价格)，但作为数据科学家，我们可以用更系统的方式来做这件事。</p></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><p id="bfc8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当然，为此我们需要一个静态的、组织良好的路线数据库。幸运的是，<a class="ae kl" href="https://openflights.org/data.html" rel="noopener ugc nofollow" target="_blank"> OpenFlights </a>已经为我们收集了这些数据，这些数据来自:</p><ul class=""><li id="b4e1" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ky kz la lb bi translated">机场<strong class="jp ir"> </strong>(另外还有火车站和轮渡码头)。</li><li id="1151" class="kt ku iq jp b jq lc ju ld jy le kc lf kg lg kk ky kz la lb bi translated">航空公司。</li><li id="bb2f" class="kt ku iq jp b jq lc ju ld jy le kc lf kg lg kk ky kz la lb bi translated">实际飞行路线。</li></ul><p id="cb5a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以从他们的网站或者从 Kaggle 下载这些数据，在那里他们友好地将以上 3 个数据集分发给社区。这些是通过不同 id 匹配的 CSV(例如，路线从一个机场 id 到另一个机场 id)，因此我们首先要做的是合并所有信息<strong class="jp ir">。</strong> <a class="ae kl" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> <em class="lh">熊猫</em> </a>来救援了！</p><figure class="li lj lk ll gt lm"><div class="bz fp l di"><div class="ln lo l"/></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk">Reading and merging info</figcaption></figure><p id="3f0b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这看起来有点令人不知所措，但我们只是读取 3 个来源，过滤一些东西(例如，只有机场-没有车站-和直接路线-没有中途停留-)，防止丢失值，并连接 3 个表。<em class="lh"> df </em>中的最终结果是一个数据帧，包含:</p><ul class=""><li id="35d7" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ky kz la lb bi translated">出发地机场的位置、名称和城市。</li><li id="fba8" class="kt ku iq jp b jq lc ju ld jy le kc lf kg lg kk ky kz la lb bi translated">目的地机场的位置、名称和城市。</li><li id="e799" class="kt ku iq jp b jq lc ju ld jy le kc lf kg lg kk ky kz la lb bi translated">运营该航线的航空公司。</li></ul></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><p id="3389" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们已经有了所有的数据，是时候可视化并回答一些有趣的问题了。我一直对记录和极限很感兴趣，问这种"<em class="lh">最大/最高/最长……</em>"的问题？在这种情况下，我想到的一些问题是:</p><ul class=""><li id="b3e9" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ky kz la lb bi translated">出发/抵达路线最多的<strong class="jp ir">国家/城市有哪些</strong>？</li></ul><figure class="li lj lk ll gt lm gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi lt"><img src="../Images/3c58f1e1e825c8cb6583fa7af890fb05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PIztXRBxQ_TP4nMxbRfqUg.png"/></div></div></figure><figure class="li lj lk ll gt lm gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi lt"><img src="../Images/d5b2c1c8d3ece6fb87bcda3b1e38f593.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CQEwxzZVKehex39tBnUUKA.png"/></div></div></figure><p id="c168" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有两个明显胜出的国家:美国(亚特兰大、芝加哥、纽约、洛杉机、达拉斯……)和<strong class="jp ir">中国</strong> ( <strong class="jp ir">上海、北京、香港</strong>……)。然而，<strong class="jp ir">他们的许多路线都是国内的</strong>，所以<strong class="jp ir">如果我们只考虑城市，那么也有像伦敦、巴黎或莫斯科</strong>这样的欧洲枢纽站在第一位。以上是进来的路线:如果你考虑出去的路线，它几乎是相同的故事，因为大多数路线是对称的(如果有从 X 到 Y 的路线，也有从 Y 到 X 的相同路线)。</p><ul class=""><li id="4c66" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ky kz la lb bi translated">航线最多/飞往最多国家的<strong class="jp ir">航空公司有哪些</strong>？</li></ul><figure class="li lj lk ll gt lm gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi lt"><img src="../Images/73249ab88b8eac1c1582e888180aff4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NLvxKMRBQylZe1HaK0XJKQ.png"/></div></div></figure><figure class="li lj lk ll gt lm gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi lt"><img src="../Images/ce551ed97cc1c77b9f9a41400f768016.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y1NR3Osf46rmgiLUfDj-gw.png"/></div></div></figure><p id="ca22" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不出意外，<strong class="jp ir">美国</strong> ( <a class="ae kl" href="http://www.aa.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">美国</strong> </a>，<a class="ae kl" href="https://www.united.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">美联航</strong> </a>，<a class="ae kl" href="http://es.delta.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">达美</strong></a>……)和<strong class="jp ir">中国</strong> ( <a class="ae kl" href="http://www.flychinasouthern.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">南航</strong> </a>，<a class="ae kl" href="http://www.airchina.es/es/index.html" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">国航</strong> </a> <strong class="jp ir">，</strong> <a class="ae kl" href="http://global.ceair.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">东航</strong></a>……)航母占优，但而<a class="ae kl" href="http://www.easyjet.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">易捷</strong> </a> <strong class="jp ir">的航线比</strong> <a class="ae kl" href="http://www.lufthansa.com/es/es/homepage" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">汉莎</strong> </a> <strong class="jp ir">或</strong> <a class="ae kl" href="http://www.klm.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">荷航</strong> </a>多，这是我没想到的。同样，国内航班的效果非常显著:<strong class="jp ir">如果你有兴趣访问尽可能多的国家，你最好选择</strong> <a class="ae kl" href="http://www.airfrance.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">法航</strong> </a> <strong class="jp ir">或</strong> <a class="ae kl" href="http://www.turkishairlines.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">土耳其航空</strong> </a> <strong class="jp ir">而不是美国航空公司</strong>(更不用说中国航空公司，因为它们基本上是在中国周边飞行，所以不在此列)。另一个惊喜是，如果一些非洲航空公司名列前茅，你会说埃塞俄比亚航空公司比阿联酋航空公司更国际化吗？我打赌不会！</p><p id="a3ec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那么，作为两种观点的混合，你能猜出我们从哪些城市到达大多数国家吗？对，<strong class="jp ir">基本上就是上述航空公司的总部</strong>(法国航空的巴黎，英国航空的伦敦，德国汉莎航空的法兰克福等等)。从现在开始，我将使用这些:</p><figure class="li lj lk ll gt lm gh gi paragraph-image"><div role="button" tabindex="0" class="lu lv di lw bf lx"><div class="gh gi lt"><img src="../Images/0cd6b908769cd1820f7633ec1a741b0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_WMZuIkXLYjDPnhbFAGdHQ.png"/></div></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk">Cities with routes to most countries</figcaption></figure><p id="b14c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">关于获得上面的情节的一些提示:我使用了<a class="ae kl" href="http://holoviews.org/" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir"><em class="lh">holo views</em></strong></a>，这是一个非常强大的可视化库，它建立在 Python 中使用最广泛的两个可视化工具(即<a class="ae kl" href="http://bokeh.pydata.org/" rel="noopener ugc nofollow" target="_blank"> <em class="lh"> bokeh </em> </a>和<a class="ae kl" href="http://matplotlib.org/" rel="noopener ugc nofollow" target="_blank"> <em class="lh"> matplotlib </em> </a>)之上。<strong class="jp ir"> Holoviews 与<em class="lh"> pandas </em>巧妙集成，允许通过 3 个步骤抽象绘图来绘制数据帧的信息</strong>:</p><ol class=""><li id="b1ef" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ma kz la lb bi translated">选择<strong class="jp ir">类型的图</strong>(散点图、条形图、热图等)。).</li><li id="7c32" class="kt ku iq jp b jq lc ju ld jy le kc lf kg lg kk ma kz la lb bi translated">建立<strong class="jp ir">关键维度</strong>(用他们的行话来说就是<em class="lh"> kdims </em>)，也就是确定要绘制的信息部分的维度。</li><li id="ff4c" class="kt ku iq jp b jq lc ju ld jy le kc lf kg lg kk ma kz la lb bi translated">建立<strong class="jp ir">值尺寸</strong> ( <em class="lh"> vdims </em>)，即将要在图中显示的变量。</li></ol><p id="a220" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，为了从城市获得国家的条形图，我们可以:</p><figure class="li lj lk ll gt lm"><div class="bz fp l di"><div class="ln lo l"/></div></figure><p id="77c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我按城市分组，统计了他们飞往的不同国家，挑选了 30 个最国际化的国家，然后选择了一个 holoviews <a class="ae kl" href="http://holoviews.org/reference/elements/bokeh/Bars.html#bokeh-gallery-bars" rel="noopener ugc nofollow" target="_blank"> <em class="lh">条</em> </a> <em class="lh"> </em>图，其中航空公司作为关键维度(x 轴，每个条与谁相关)，目的地国家作为值维度(y 轴，条的高度)。然后，我使用了一些可用的选项，使情节看起来更好。</p><p id="a96e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">顺便说一下，<strong class="jp ir">上面的图片是静态的，但 holoviews 会生成交互式的图</strong>:例如，<strong class="jp ir">如果你将鼠标悬停在一个条上，就会出现一个图例:看看这个下载并运行</strong> <a class="ae kl" href="https://github.com/jorloplaz/travel_stories/blob/master/flights.ipynb" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">完整代码</strong> </a>！</p></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><p id="1348" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">太好了，我们离我们的目标越来越近了，给定一个城市，我们可以飞到哪里。如果我们能画出一张显示全球路线的图表，那就太酷了。<strong class="jp ir"> Holoviews 还提供了一个</strong> <a class="ae kl" href="http://holoviews.org/reference/elements/bokeh/Graph.html#bokeh-gallery-graph" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="lh">图形</em> </strong> </a> <strong class="jp ir">对象与交互支持</strong>，但是地球地图呢？一种选择是用国家多边形(例如，用我的<a class="ae kl" href="https://medium.com/@jorloplaz/youre-always-travelling-anywhere-you-haven-t-been-to-yet-96608c3b402c" rel="noopener">上一篇文章</a>的国家<em class="lh">地理数据框</em>)构建一个<a class="ae kl" href="http://holoviews.org/reference/elements/bokeh/Polygons.html#bokeh-gallery-polygons" rel="noopener ugc nofollow" target="_blank"> <em class="lh">多边形</em> </a> <em class="lh"> </em>对象，并用图形覆盖它，但是<strong class="jp ir">我们可以在全息视图上使用另一个库:</strong> <a class="ae kl" href="http://geo.holoviews.org/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="lh">地理视图</em> </strong> </a>。</p><p id="305a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以，这个想法很简单。给定一个城市，我们必须:</p><ol class=""><li id="005a" class="kt ku iq jp b jq jr ju jv jy kv kc kw kg kx kk ma kz la lb bi translated">从<em class="lh"> df </em>中选择从该城市出发的路线。</li><li id="e4cf" class="kt ku iq jp b jq lc ju ld jy le kc lf kg lg kk ma kz la lb bi translated"><strong class="jp ir">从这些航线中，选择所有涉及的机场</strong>(出发地和目的地)。</li><li id="240b" class="kt ku iq jp b jq lc ju ld jy le kc lf kg lg kk ma kz la lb bi translated"><strong class="jp ir">用这些机场的位置建立图节点</strong>。</li><li id="43b1" class="kt ku iq jp b jq lc ju ld jy le kc lf kg lg kk ma kz la lb bi translated"><strong class="jp ir">用所选路线连接的机场建立图边</strong>。</li><li id="518d" class="kt ku iq jp b jq lc ju ld jy le kc lf kg lg kk ma kz la lb bi translated"><strong class="jp ir">调整图形选项以获得更好的可视化效果</strong>。</li></ol><p id="20cd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于一些小细节，代码相当长，例如<strong class="jp ir">可能有一个以上的源机场</strong>(例如，巴黎有戴高乐机场和奥利机场)以及我希望交互显示的信息(<strong class="jp ir">可读且不太长的名称、运营每条航线的航空公司</strong>等)。) :</p><figure class="li lj lk ll gt lm"><div class="bz fp l di"><div class="ln lo l"/></div></figure><p id="679d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">马德里的结果看起来是这样的(这里也是静态的，但是如果你下载并运行<a class="ae kl" href="https://github.com/jorloplaz/travel_stories/blob/master/flights.ipynb" rel="noopener ugc nofollow" target="_blank">完整的代码</a>，你可以用蓝色和黄色突出显示<strong class="jp ir">每条路线，并且它的信息显示在交互式图例中</strong>):</p><figure class="li lj lk ll gt lm gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/838a7eedbdcebb77d74aa4d16f26165b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*Vf1-xjkCu7cJYvtxtX9HxA.png"/></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk">Routes from Madrid (straight line version)</figcaption></figure></div><div class="ab cl km kn hu ko" role="separator"><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr ks"/><span class="kp bw bk kq kr"/></div><div class="ij ik il im in"><p id="57d7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于最后的<em class="lh">绝技</em>，让我们利用<strong class="jp ir">直线并不是飞机</strong>实际遵循的路线这一事实。听说过<a class="ae kl" href="https://en.wikipedia.org/wiki/Geodesic" rel="noopener ugc nofollow" target="_blank"> <em class="lh">测地线</em> </a>吗？嗯，令人悲伤的事实是，<strong class="jp ir">给定两个城市，它们之间的最短路线不是直线，因为它们位于地球的球面上，而不是平面几何形状</strong>。例如，我今年夏天从北京飞往马德里，航线经过贝加尔湖和西伯利亚，所以它比上面显示的线更靠北。我们能改变路线来反映这一点吗？</p><p id="e762" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">是的，我们可以。<strong class="jp ir"> Python 也有专门为测地线、投影和制图设计的库，比如</strong><a class="ae kl" href="https://github.com/jswhit/pyproj" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir"><em class="lh">pyproj</em></strong></a><strong class="jp ir">和</strong><a class="ae kl" href="https://github.com/Toblerity/Shapely" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir"><em class="lh">shapely</em></strong></a>。我们没有给出图<em class="lh"> edgepaths=None </em>，而是使用可选参数<em class="lh">测地线</em>显式构建路径，并将其传递给函数<em class="lh"> routes_from </em>:</p><figure class="li lj lk ll gt lm"><div class="bz fp l di"><div class="ln lo l"/></div></figure><p id="f801" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以现在的<strong class="jp ir">结果更加真实</strong>:</p><figure class="li lj lk ll gt lm gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/8cef6adf0a3fe194eab95f875a68b36d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1358/format:webp/1*dFlsRpyPmP8ymlXJuJ_t5w.png"/></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk">Flights from Madrid (geodesic version)</figcaption></figure><p id="2eec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是仍然有一个警告。如果我们尝试用大多数路线生成之前看到的 30 个城市的图表，<strong class="jp ir">有些情况下会失败</strong>。以纽约为例:</p><figure class="li lj lk ll gt lm gh gi paragraph-image"><div class="gh gi md"><img src="../Images/80ab1e08218a952c65599cfcc88bfc42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1322/format:webp/1*tqQIurFNxz9IHGbOyQo9Xg.png"/></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk">Flights from New York (geodesic version, something wrong!)</figcaption></figure><p id="dc73" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">嘿嘿，到底是什么(字面上的地球，lol)出问题了？<strong class="jp ir">这是一个投影问题</strong>:路线计算正确，但是当<em class="lh"> geoviews </em>试图将其投影回一个平面(默认情况下使用<a class="ae kl" href="https://en.wikipedia.org/wiki/Mercator_projection" rel="noopener ugc nofollow" target="_blank"> <em class="lh">墨卡托投影</em> </a>)穿过太平洋的<strong class="jp ir">路线</strong>(从地图的右端到左端，反之亦然)<strong class="jp ir">错误地加入了一个不应该在那里的额外线段</strong>。如何解决这个问题？</p><p id="ddbd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这不是很优雅，但我想出了这个快速的方法:想法是当<strong class="jp ir">检测到一条路线穿过太平洋</strong>(即，从经度 180°切换到-180°或相反方向)<strong class="jp ir">时，它将<em class="lh">线串</em>分成具有两段的<em class="lh">多线串</em>，每侧一段</strong>。代码如下:</p><figure class="li lj lk ll gt lm"><div class="bz fp l di"><div class="ln lo l"/></div></figure><p id="d5e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，如果我们用<em class="lh">几何=边.应用(修复 _ 线)</em>而不是<em class="lh">几何=边</em>为<em class="lh">边路径</em>构建<em class="lh">地理数据框</em>，我们会得到:</p><figure class="li lj lk ll gt lm gh gi paragraph-image"><div class="gh gi me"><img src="../Images/3958fd916bc5a2760119bf1ed74f33f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1316/format:webp/1*GiLRCyE1hsGpK9WF8Zekmw.png"/></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk">Flights from New York (geodesic version, fixed)</figcaption></figure><p id="dbef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">太好了！并且<strong class="jp ir">当我们选择太平洋上空的特定航线时，两个航段都会高亮显示</strong>！你可以在我的<a class="ae kl" href="https://github.com/jorloplaz/travel_stories/blob/master/flights.ipynb" rel="noopener ugc nofollow" target="_blank"> Github 代码</a>中查看这一点，我在那里生成了我们在上一节中看到的 30 个最国际化城市的图表。为了完整起见，下面是这样做的代码:</p><figure class="li lj lk ll gt lm"><div class="bz fp l di"><div class="ln lo l"/></div></figure><p id="6d8e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我构建了一个<a class="ae kl" href="http://holoviews.org/reference/containers/bokeh/HoloMap.html" rel="noopener ugc nofollow" target="_blank">全息地图</a>来存储所有 30 个图形。绘制时，它会自动创建一个选择框，我们可以从中选择我们想要的城市。注意<em class="lh"> opts </em>指令:它类似于我们之前使用的<em class="lh"> options </em>函数，但是专用于 Jupyter 笔记本。我使用了很多选项来调整节点和边的大小、颜色和整体外观。此外，ESRI 图块源是我们在图片中看到的卫星背景，而*运算符用于叠加图。</p><p id="11f8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">希望你喜欢这个解释！我鼓励你下载<a class="ae kl" href="https://github.com/jorloplaz/travel_stories/blob/master/flights.ipynb" rel="noopener ugc nofollow" target="_blank">笔记本</a>和<a class="ae kl" href="https://github.com/jorloplaz/travel_stories/tree/master/data" rel="noopener ugc nofollow" target="_blank">数据</a>，用 Jupyter 运行笔记本，然后玩结果。欢迎建议！</p></div></div>    
</body>
</html>