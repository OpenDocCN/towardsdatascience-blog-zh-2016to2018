<html>
<head>
<title>Data Science Simplified Part 11: Logistic Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据科学简化版第11部分:逻辑回归</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-science-simplified-part-11-logistic-regression-5ae8d994bf0e?source=collection_archive---------4-----------------------#2017-10-02">https://towardsdatascience.com/data-science-simplified-part-11-logistic-regression-5ae8d994bf0e?source=collection_archive---------4-----------------------#2017-10-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="05a4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本系列的最后一篇博文中，我们讨论了分类器。讨论了分类器的类别以及如何对它们进行评估。我们还深入讨论了回归模型。在这篇文章中，我们将深入探讨回归模型如何用于分类任务。</p><p id="b1c8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="km"> Logistic回归</em> </strong>是一种广泛用于分类任务的回归模型。像往常一样，我们将通过例子来讨论。</p><p id="7b7c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">没有一家货币银行向我们提出问题。该银行希望建立一个模型，预测他们的哪些客户会拖欠贷款。提供的数据集如下:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi kn"><img src="../Images/41441ea1b24d163fdc078eecb875e303.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*UH9HpOgKF2F59X28."/></div></figure><p id="65d5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有助于我们构建模型的功能包括:</p><ul class=""><li id="85ba" class="kv kw iq jp b jq jr ju jv jy kx kc ky kg kz kk la lb lc ld bi translated">客户Id:唯一的客户标识</li><li id="7d96" class="kv kw iq jp b jq le ju lf jy lg kc lh kg li kk la lb lc ld bi translated">信用评分:介于0和800之间的数值，表示借款人信用历史的风险。</li><li id="bee6" class="kv kw iq jp b jq le ju lf jy lg kc lh kg li kk la lb lc ld bi translated">贷款金额:这是完全还清的贷款金额或违约金额。</li><li id="b447" class="kv kw iq jp b jq le ju lf jy lg kc lh kg li kk la lb lc ld bi translated">当前工作年限:一个分类变量，表示客户在当前工作中已经工作了多少年。</li><li id="d749" class="kv kw iq jp b jq le ju lf jy lg kc lh kg li kk la lb lc ld bi translated">信用记录年数:自客户信用记录第一次录入以来的年数</li><li id="87cb" class="kv kw iq jp b jq le ju lf jy lg kc lh kg li kk la lb lc ld bi translated">月债务:客户现有贷款的月付款额</li><li id="56cc" class="kv kw iq jp b jq le ju lf jy lg kc lh kg li kk la lb lc ld bi translated">信用问题的数量:客户记录中信用问题的数量。</li><li id="f09d" class="kv kw iq jp b jq le ju lf jy lg kc lh kg li kk la lb lc ld bi translated">IsDefault:这是目标。如果客户违约，那么它将1否则它0。</li></ul><p id="091e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是一个分类问题。</p><p id="7d61" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">逻辑回归是回归模型的化身。它将回归模型转换为分类器。让我们首先理解为什么普通回归模型不能作为分类器。</p><p id="c664" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">默认情况下，目标值为0或1。我们可以把它重新定义为一种概率。重新架构如下:</p><ul class=""><li id="7e8c" class="kv kw iq jp b jq jr ju jv jy kx kc ky kg kz kk la lb lc ld bi translated">如果违约概率&gt; = 0.5，则客户将违约，即IsDefault = 1</li><li id="b791" class="kv kw iq jp b jq le ju lf jy lg kc lh kg li kk la lb lc ld bi translated">如果违约概率&lt; 0.5 then the customer will not default i.e. IsDefault = 0</li></ul><p id="3b63" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Recall our discussion on Linear Regression Model. In the regression model, we had defined an dependent variable <strong class="jp ir"> y </strong>是自变量的函数。为了简单起见，让我们假设我们只有一个自变量<strong class="jp ir"> x </strong>。等式变成了。</p><blockquote class="lj"><p id="cf4b" class="lk ll iq bd lm ln lo lp lq lr ls kk dk translated">y = β0 + β1.x</p></blockquote><ul class=""><li id="62b1" class="kv kw iq jp b jq lt ju lu jy lv kc lw kg lx kk la lb lc ld bi translated">β0是截距。</li><li id="b828" class="kv kw iq jp b jq le ju lf jy lg kc lh kg li kk la lb lc ld bi translated">β1是x的系数。</li></ul><p id="1ab0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在贷款违约模型的例子中，Tim使用信用评分作为自变量。因变量(y)是客户违约概率的估计值，即<strong class="jp ir"> <em class="km"> P(违约)</em> </strong>。</p><p id="169d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该等式可以写成:</p><blockquote class="lj"><p id="d4c8" class="lk ll iq bd lm ln lo lp lq lr ls kk dk translated">p(违约)= β0 + β1 .信用评分</p></blockquote><p id="0c06" class="pw-post-body-paragraph jn jo iq jp b jq lt js jt ju lu jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">Tim在统计软件包上运行回归模型。统计软件包为β0和β1提供了以下系数:</p><ul class=""><li id="3534" class="kv kw iq jp b jq jr ju jv jy kx kc ky kg kz kk la lb lc ld bi">β0 = 0.73257</li><li id="bdb9" class="kv kw iq jp b jq le ju lf jy lg kc lh kg li kk la lb lc ld bi translated">β1 = -9.9238e-05</li></ul><p id="5faf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">估计违约概率的等式现在变成了:</p><blockquote class="lj"><p id="49ec" class="lk ll iq bd lm ln lo lp lq lr ls kk dk translated">p(默认值)= 0.73257 + -9.9238e-05。信用评分</p></blockquote><p id="a55e" class="pw-post-body-paragraph jn jo iq jp b jq lt js jt ju lu jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">如果某人有很高的信用评分，比如8000，那么他会不会违约？让我们引入一些值并检查一下。</p><blockquote class="lj"><p id="fc9f" class="lk ll iq bd lm ln lo lp lq lr ls kk dk translated">0.73257+-9.9238 e-05 x 8000 =-0.06134。</p></blockquote><p id="f8cb" class="pw-post-body-paragraph jn jo iq jp b jq lt js jt ju lu jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">如果我们用信用评分和回归线绘制p(违约),我们会得到以下曲线:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi kn"><img src="../Images/b35cd5ff034cc697945d5fd5bd7631c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Z4TrX4zha_n9S85w."/></div></figure><p id="e1f6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">传统回归模型面临挑战。数字-0.06334，一个负概率，没有意义。从图表中也可以明显看出。对于信用分高的，概率小于零。概率需要介于0和1之间。</p><p id="2db4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">怎么做才能把等式转换成概率总是在0和1之间？</p><p id="f3fd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就是T2乙状结肠T3的用武之地。</p><p id="efea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">sigmoid或<strong class="jp ir">T5】逻辑 </strong>函数是具有特征“S”形曲线或sigmoid曲线的数学函数。数学上，它定义如下:</p><blockquote class="lj"><p id="f74f" class="lk ll iq bd lm ln lo lp lq lr ls kk dk translated">sigmoid = ey/(1+ey)</p></blockquote><p id="2acf" class="pw-post-body-paragraph jn jo iq jp b jq lt js jt ju lu jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">乙状结肠的形状如下:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mb"><img src="../Images/2c73c41cdd0696f7c86c7474514aefe9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/0*KNeXv3XFTUtCylNe."/></div></div></figure><p id="92d4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它转换0和1之间的所有值。假设我们有一组从-5到10的数字。当使用sigmoid函数对这组数字进行变换时，所有值都在0和1之间。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi kn"><img src="../Images/cabf4eabfbf3c8f23d21cd5c7a6f9cad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*74NvQOk3_7Glxr05."/></div></figure><p id="4b04" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这变得有趣了。使用sigmoid，任何数字都可以转换成等价的概率分数。</p><p id="4fb6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">既然我们有了将目标转化为概率的方法，让我们看看它是如何工作的。使用sigmoid函数转换后的回归方程如下:</p><blockquote class="lj"><p id="7ac0" class="lk ll iq bd lm ln lo lp lq lr ls kk dk translated">y = β0 + β1 .信用评分</p><p id="992c" class="lk ll iq bd lm ln lo lp lq lr ls kk dk translated">p(默认值)= ey/(1 + ey)</p><p id="8dc4" class="lk ll iq bd lm ln lo lp lq lr ls kk dk translated">p(默认值)= sigmoid(y)</p></blockquote><p id="53b8" class="pw-post-body-paragraph jn jo iq jp b jq lt js jt ju lu jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">让我们来看看当信用评级较高(即8000)时，sigmoid模型的表现如何</p><blockquote class="lj"><p id="aa13" class="lk ll iq bd lm ln lo lp lq lr ls kk dk translated">y = 0.73257+-9.9238 e-05 x 8000 =-0.06134。</p><p id="7809" class="lk ll iq bd lm ln lo lp lq lr ls kk dk translated">p(默认值)= sigmoid(y)= sigmoid(-0.06134)= 0.4846</p><p id="57cc" class="lk ll iq bd lm ln lo lp lq lr ls kk dk translated">p(默认值)= 48.46% =&gt; IsDefault = 0</p></blockquote><p id="12d3" class="pw-post-body-paragraph jn jo iq jp b jq lt js jt ju lu jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">可以通过添加更多的变量来增强逻辑回归模型。我们需要做的就是把简单的线性回归模型提升为多元回归模型方程。这种模型的一个例子如下:</p><blockquote class="lj"><p id="86e5" class="lk ll iq bd lm ln lo lp lq lr ls kk dk translated">y2 = β0 + β1 .信用评分+ β2。贷款金额+ β3。信用问题数+ β4。月负债+ β5。自上次拖欠后的月数+ β6。信用卡数量</p><p id="2fea" class="lk ll iq bd lm ln lo lp lq lr ls kk dk translated">p(默认)= sigmoid(y2)</p></blockquote><p id="f0a1" class="pw-post-body-paragraph jn jo iq jp b jq lt js jt ju lu jw jx jy ly ka kb kc lz ke kf kg ma ki kj kk ij bi translated">让我们试着用这个模型来预测潜在的违约者。贷款数据集按80:20的比例分为训练集和测试集(80%训练，20%测试)。</p><p id="c649" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">回想一下，有许多度量来评估分类器。我们将使用AUC作为模型评估的指标。让我们看看新型号的性能如何。机器学习程序用于评估测试数据上的模型性能。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div class="gh gi kn"><img src="../Images/9c6c642318af268a6101442501b9f5d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_SBt6kSdOWx3p4o3."/></div></figure><p id="fab4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">新型号性能不太好。测试数据的AUC分数约为60%。</p><p id="d74c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们现在了解逻辑回归模型的工作原理。我们现在知道它是如何构建分类器的。分类器的AUC分数不好。我们需要寻找更好的模型。在本系列的下一篇文章中，我们将研究交叉验证。</p></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><p id="1cad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="km">原载于2017年10月2日</em><a class="ae kl" href="https://datascientia.blog/2017/10/02/data-science-simplified-part-11-logistic-regression/" rel="noopener ugc nofollow" target="_blank"><em class="km">datascientia . blog</em></a><em class="km">。</em></p></div></div>    
</body>
</html>