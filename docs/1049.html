<html>
<head>
<title>How fast can a Mercedes Benz car be tested and released? — A Kaggle Competition</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">奔驰汽车能多快测试发布？——一场纸牌游戏比赛</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-fast-can-a-mercedes-benz-car-be-tested-and-released-a-kaggle-competition-6a1d56ea17a7?source=collection_archive---------10-----------------------#2017-07-23">https://towardsdatascience.com/how-fast-can-a-mercedes-benz-car-be-tested-and-released-a-kaggle-competition-6a1d56ea17a7?source=collection_archive---------10-----------------------#2017-07-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="8623" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我在 10 个月前注册了 Kaggle，并不时更新不同的比赛。我会窥探并查看数据，查看评估指标，还会浏览一些讨论和内核。但我绝不会真的做任何事。这场比赛是我第一次参加 Kaggle。我和我的另一个朋友 Vinayaka Raj 合作。数据清理、特征工程和模型调整的大部分见解都是他的主意。在这篇文章中，我会分享我们使用的方法。</p><p id="da48" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">比赛的主要目的是决定一辆车能以多快的速度通过筛选过程，以减少在测试台上花费的时间，从而减少污染。由于奔驰汽车有各种各样的选项，测试每一个选项，看看它们是否按照标准工作是至关重要的。因此，随着越来越多的功能年复一年地被添加到汽车中，测试一辆这样的汽车所花费的时间增加了。因此，戴姆勒向 Kaggle 社区提供了许多具有众多“匿名”功能的此类汽车的数据集，以提出最佳算法来帮助他们解决这一问题。</p><h1 id="1b2b" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">评定标准</h1><p id="f76c" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">首先，让我们看看在这次比赛中提交的作品是如何被评估的。用于评估的度量是<a class="ae kl" href="https://en.wikipedia.org/wiki/Coefficient_of_determination" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">决定系数</strong> </a> <strong class="jp ir"> </strong>(也称为 R 的平方)。它是预测分数和实际分数(范围 0-1)之间相关性的平方。简而言之，该指标决定了模型在用样本数据训练后预测真实值数据的能力或接近程度。</p><h1 id="def1" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">数据探索</h1><p id="6cde" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">在这样做之前，我想让你知道我们在这次比赛中使用了 python 及其相关包(matplotlib、pandas、numpy、sklearn 等等)。</p><p id="f192" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们开始研究数据！让我们先看看吧！</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi lp"><img src="../Images/106deb85fb1711e8f2b68da8104b3bce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6COS__5Fa-LKmfAq3PpEgQ.jpeg"/></div></div><figcaption class="mb mc gj gh gi md me bd b be z dk">Snapshot of the csv file provided by Kaggle</figcaption></figure><p id="69ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每一行都有一个唯一的 ID、一组分类变量(X0-X8)和二进制/标识变量(X10-X378)以及输出“y”。</p><p id="6ea0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">经过分析，我们发现了一些列:</p><ol class=""><li id="812c" class="mf mg iq jp b jq jr ju jv jy mh kc mi kg mj kk mk ml mm mn bi translated">这表明<strong class="jp ir">非方差</strong>(整个列中的值相同)</li><li id="3761" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">高度倾斜的<strong class="jp ir"/>(大部分时间出现的少数值(&gt; 95%))</li><li id="6416" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">那是完全相同的<strong class="jp ir">副本</strong></li><li id="454d" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">那些与某些其他列<strong class="jp ir">线性相关</strong>(正相关或负相关)</li></ol><p id="29ea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们没有遇到任何缺少值的列。因此没有必要进行<a class="ae kl" href="https://en.wikipedia.org/wiki/Imputation_(statistics)" rel="noopener ugc nofollow" target="_blank">插补</a>。</p><h1 id="ae71" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">数据预处理</h1><p id="1d99" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">预处理背后的主要思想是应对我们在数据探索阶段遇到的问题。那我们做了什么？在问这个问题之前，让我们先问一下我们为什么要这样做</p><ol class=""><li id="429e" class="mf mg iq jp b jq jr ju jv jy mh kc mi kg mj kk mk ml mm mn bi translated">降低手头问题的维度。</li><li id="2cfd" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">降低过度拟合的可能性(模型倾向于学习所有冗余、重复或不必要的可用特征)。</li><li id="65f6" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">更少的特征意味着更简单的模型、更少的内存、更少的训练时间和更快的结果。</li></ol><p id="f92f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们回到问题<em class="mt">‘我们做了什么？’</em></p><ol class=""><li id="c453" class="mf mg iq jp b jq jr ju jv jy mh kc mi kg mj kk mk ml mm mn bi translated">我们删除了没有可变性的列，即始终只包含一个值的列。</li><li id="9eaa" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">我们还删除了值在整个列中出现超过 95%的列。</li><li id="13e8" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">我们扫描了数据集的重复出现，在每种情况下只保留一列。</li><li id="16c9" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">显示高相关性的列也被删除，以减少过度拟合。</li></ol><h1 id="19a9" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">特征工程</h1><p id="069d" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">特征是用于预测的有用信息。因此，更好的特性会带来更好的结果。</p><p id="cee0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">实际上，原始数据集中可用的特征(数字特征)可以立即用于预测。然而，你不会达到所需的精确度。如果我们可以创建更多的功能，并将它们转换成算法可以理解的东西，会怎么样？通过这样做，我们通过强调潜在的问题，使模型学习起来更简单。</p><h2 id="7a6c" class="mu kn iq bd ko mv mw dn ks mx my dp kw jy mz na la kc nb nc le kg nd ne li nf bi translated"><strong class="ak">冲击编码</strong></h2><p id="8dc9" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">由于数据包含分类变量，我们的第一项工作是将它们转换成算法可以理解的形式。我们进行了影响编码，其中每个分类变量都被该变量在该列中出现的“平均值”所替代。因此，具有更多“平均值”的变量将具有更高的数值。</p><p id="85f5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有许多方法可以将分类变量转换成数字变量。<a class="ae kl" href="https://www.analyticsvidhya.com/blog/2015/11/easy-methods-deal-categorical-variables-predictive-modeling/" rel="noopener ugc nofollow" target="_blank">本文</a>对此提供了更多的见解。</p><h2 id="8d3b" class="mu kn iq bd ko mv mw dn ks mx my dp kw jy mz na la kc nb nc le kg nd ne li nf bi translated"><strong class="ak">在分类变量中创建新特征</strong></h2><p id="e6a7" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">我们能够创建具有分类变量的新特征。以下是列车组的前五行:</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/3d9d58b9019063ef1a5d3556e218d3cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1110/format:webp/1*5lcRqxOsh2BBPWNu6qXV3g.jpeg"/></div><figcaption class="mb mc gj gh gi md me bd b be z dk">First five rows of the dataframe</figcaption></figure><p id="3f08" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">列 X0、X1 和 X2 有一些共同点。他们有一些有两个字母的变量(例如:az，ab，bc 等。)所以我们想到创建一个新的专栏，叫做 X0_club、X1_club 和 X2_club。在把那些以相同字母开头的列组合起来之后，这些列中的每一列都会有变量。例如:[aa，ab，ac，…，az]会被棒化为[a]，而[ba，bb，bc，…，bz]会被棒化为[b]等等。下图显示了包含新创建的列的数据帧:</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/6398fc75048885a572d288bed8bf6079.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/1*op5i_H97UX4q-QMBAm1Ykg.jpeg"/></div><figcaption class="mb mc gj gh gi md me bd b be z dk">Notice the three additional columns in the end</figcaption></figure><p id="55ba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">也可以为数值变量创建新特征。但是因为已经有很多列了，我们没有创建更多的(大错误)。</p><p id="48c6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="mt">注意:</em> </strong>需要记住的一个关键点是，在训练数据集<strong class="jp ir">上执行的步骤也必须在测试数据集上执行</strong>。因此，在进行数据预处理和特征工程时，要确保这些步骤是针对测试数据同时进行的。</p><h1 id="14e4" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">构建和训练模型</h1><p id="153e" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">由于我们的问题是一个涉及回归的问题，我们决定使用<a class="ae kl" href="https://www.analyticsvidhya.com/blog/2014/06/introduction-random-forest-simplified/" rel="noopener ugc nofollow" target="_blank">随机森林</a>，这是众多可用集成方法中的一种。还有许多其他算法可供选择。</p><p id="3b71" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们使用 sklearn 库中可用的<a class="ae kl" href="http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestRegressor.html" rel="noopener ugc nofollow" target="_blank"> RandomForestRegressor </a>函数来执行回归。该函数的不同参数(树的数量、树的深度、分割的最小样本和特征的数量)通过为循环运行<em class="mt">决定，并使用<a class="ae kl" href="https://www.openml.org/a/estimation-procedures/1" rel="noopener ugc nofollow" target="_blank">交叉验证</a>进行验证。</em></p><h2 id="5f85" class="mu kn iq bd ko mv mw dn ks mx my dp kw jy mz na la kc nb nc le kg nd ne li nf bi translated">另一种方法</h2><p id="6290" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">将输出变量与观察值的数量进行对比，我们看到它是高度倾斜的，也有一些异常值。我们决定使用<a class="ae kl" href="http://www.statisticshowto.com/box-cox-transformation/" rel="noopener ugc nofollow" target="_blank"> Box Cox 变换</a>对此进行变换。它将偏态分布转换为正态分布。为此，我们使用了<a class="ae kl" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.boxcox.html" rel="noopener ugc nofollow" target="_blank"> scipy </a>中的相应函数。然而，根据转换后的结果训练模型并没有提高验证的准确性</p><h1 id="42a7" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">我们能做什么？</h1><p id="164e" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">以下是一些我们本可以使用但没有使用的技术/方法:</p><ol class=""><li id="278b" class="mf mg iq jp b jq jr ju jv jy mh kc mi kg mj kk mk ml mm mn bi translated">使用现有数据中非常重要的变量创建新要素。一个变量的重要性可以通过观察在决定结果时最依赖哪个变量来发现。在这种情况下，交叉验证可以帮到你。</li><li id="69d5" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">我们想到在二进制变量之间执行基本的<strong class="jp ir">逻辑</strong>运算(AND、XOR 和 OR ),以增加特性的数量。但是由于我们有一个 8GB RAM 的系统，并且有大量的二进制变量(~300)，它挂起了几次:(。如果这一步对您有用，必须注意确保删除重复和相关的列。</li><li id="e41a" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">使用 AdaBoost 算法。虽然它有时对噪声和异常值敏感，但在大多数情况下，它优于其他集成方法。尽管如此，还是要小心，因为很有可能会吃得过多。</li><li id="2ab6" class="mf mg iq jp b jq mo ju mp jy mq kc mr kg ms kk mk ml mm mn bi translated">我们也可以在内聚力和回归中使用正则化的方法。sklearn 库中的<a class="ae kl" href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LassoCV.html" rel="noopener ugc nofollow" target="_blank">套索</a>函数可以帮你做到这一点。</li></ol><h1 id="97c3" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">结尾注释</h1><p id="b5bc" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">所以现在你想要密码了？嗯所有相关的代码都可以在<a class="ae kl" href="https://github.com/JeruLuke/Kaggle---Mercedes-Benz-Greener-Manufacturing" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir"/></a><strong class="jp ir"/>GitHub 的资源库中找到。</p><p id="cceb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你有更好的办法解决这个问题吗？或者你还有其他想分享的评论吗？请随意评论。顺便说一下，这是我在 Medium 上的第一篇帖子。</p><p id="f26d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我目前正在参加另一个 Kaggle 比赛——<a class="ae kl" href="https://www.kaggle.com/c/instacart-market-basket-analysis" rel="noopener ugc nofollow" target="_blank">insta cart 市场篮子分析</a>。一旦完成，我一定会写下我的经历。</p></div></div>    
</body>
</html>