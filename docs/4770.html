<html>
<head>
<title>Structuring ML projects so they can grow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">构建 ML 项目，使其能够成长</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/structuring-ml-projects-so-they-can-grow-b63e89c8be8f?source=collection_archive---------18-----------------------#2018-09-05">https://towardsdatascience.com/structuring-ml-projects-so-they-can-grow-b63e89c8be8f?source=collection_archive---------18-----------------------#2018-09-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="7c89" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我从事过许多大大小小的数据科学和机器学习项目。从只需要几个笔记本的项目到成长为数万行代码的项目。</p><p id="7e4a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">我发现，开始一个项目时，假设它会增长，这总是一件好事。</strong></p><p id="b1b4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">只需要在开始时付出少量额外的努力，就能够保持长期的生产力。</p><p id="d115" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用 git 管理代码是必须的。管理数据的方法也是必须的，但是什么是最好的方法还没有定论。</p><p id="c07a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这里，我将展示一个我最近开源的名为<a class="ae kl" href="http://github.com/rstojnic/lazydata" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> lazydata </strong> </a>的库，它是专门为不断增长的 ML 项目管理数据而构建的。</p><h1 id="fca4" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">传统的数据管理方式</h1><p id="79ca" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">如果您正在进行一个机器学习项目，您将不可避免地使用各种版本的数据集(原始的、以各种方式处理的、训练/开发分割的、增强的)，并将尝试不同的模型(基线、不同的参数、架构、算法)。</p><p id="b2ce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你还需要将这些内容从你的本地电脑转移到云端，并与你的队友和未来的自己分享。</p><p id="4646" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要管理这种激增的数据和模型文件，传统上有两种选择:手动文件管理和存储它得到的一切。</p><p id="0dbc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下表总结了不同的方法及其最大的风险。</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi lp"><img src="../Images/40e10025243fa0f7b567183acff3e82b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1NkpoiQRx0cm3f-1MOqJOg.png"/></div></div><figcaption class="mb mc gj gh gi md me bd b be z dk">Comparison of data management approaches</figcaption></figure><h1 id="d301" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">懒散的数据方式</h1><p id="c1ed" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">lazydata 的核心概念是，嗯，懒惰。假设随着项目的发展，你将会产生大量的文件，而你只需要其中的一小部分。</p><p id="8e10" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">能够回到你几个月前生产的那个模型总是好的。</p><p id="2d80" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是，这并不意味着每个想要查看您的项目的人都需要下载整个历史，他们很可能只想要一小部分。</p><h1 id="9502" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">启用 lazydata 只需几行代码</h1><p id="af97" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">那么如何使用 lazydata 呢？首先，安装它(这需要 Python 3.5+):</p><p id="dfa8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mg mh mi mj b">$ pip install lazydata</code></p><p id="69d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后转到您的项目根目录并键入:</p><p id="cfe8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mg mh mi mj b">$ lazydata init</code></p><p id="9201" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将创建一个新的文件<code class="fe mg mh mi mj b">lazydata.yml</code>，其中将包含您的跟踪数据文件的列表。</p><p id="6082" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，您可以在代码中使用 lazydata 来跟踪数据文件:</p><pre class="lq lr ls lt gt mk mj ml mm aw mn bi"><span id="d907" class="mo kn iq mj b gy mp mq l mr ms"><strong class="mj ir"># my_script.py</strong></span><span id="cdfb" class="mo kn iq mj b gy mt mq l mr ms"><strong class="mj ir">from lazydata import track</strong> <br/>import pandas as pd</span><span id="ded5" class="mo kn iq mj b gy mt mq l mr ms">df = pd.read_csv(<strong class="mj ir">track("data/my_big_table.csv")</strong>)</span><span id="da2d" class="mo kn iq mj b gy mt mq l mr ms">print("Data shape:" + df.shape)</span></pre><p id="baa8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当您第一次运行这个脚本时，lazydata 将开始跟踪您的文件。</p><p id="c0b6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">跟踪包括:</p><ul class=""><li id="c68c" class="mu mv iq jp b jq jr ju jv jy mw kc mx kg my kk mz na nb nc bi translated">在<code class="fe mg mh mi mj b">~/.lazydata</code>中创建文件的副本——这是您的本地缓存，保存您的文件版本，以便您可以在需要时返回并将其推送到云。</li><li id="ef60" class="mu mv iq jp b jq nd ju ne jy nf kc ng kg nh kk mz na nb nc bi translated">将数据文件的唯一引用(SHA256)添加到<code class="fe mg mh mi mj b">lazydata.yml</code>。您将这个 yml 文件添加到 git 中，以跟踪您在这个特定提交中拥有的数据文件。这使您能够在以后需要时进行取证，并像跟踪代码一样跟踪您的数据文件。</li></ul><p id="4817" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你完了！如果您更改了数据文件，将会记录一个新的版本，您可以像往常一样继续工作。</p><p id="fc27" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">若要与您的队友共享您的数据文件，或者只是备份数据文件，请将遥控器添加到您的项目并推送您的文件:</p><pre class="lq lr ls lt gt mk mj ml mm aw mn bi"><span id="a285" class="mo kn iq mj b gy mp mq l mr ms">$ lazydata add-remote s3://mybucket<br/>$ lazydata push</span></pre><p id="a61c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦你的队友下载了最新的代码，他们也会得到<code class="fe mg mh mi mj b">lazydata.yml</code>文件。然后，他们可以使用您设置的 S3 遥控器和 SHA256 唯一引用通过<code class="fe mg mh mi mj b">lazydata pull</code>提取文件。</p><p id="3e5c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">或者，他们可以简单地运行您的脚本来延迟下载丢失的文件:</p><pre class="lq lr ls lt gt mk mj ml mm aw mn bi"><span id="c28e" class="mo kn iq mj b gy mp mq l mr ms">$ python my_script.py<br/>## lazydata: Downloading tracked file my_big_table.csv ...<br/>## Data shape: (10000,100)</span></pre><p id="0021" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就是这样！现在，您可以将您的 S3 视为所有数据文件的永久存档，而不必担心您的合作者将不得不下载他们不需要的任何文件。</p><p id="abdf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在上面的例子中，我们将 lazydata 应用于数据输入，但是您也可以在数据输出上使用<code class="fe mg mh mi mj b">track()</code>，例如在您刚刚保存的模型权重文件上——它以完全相同的方式工作。</p><p id="737a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这种惰性语义使您能够两全其美:存储所有内容，同时随着项目的增长，保持对数据文件的管理和组织。</p><p id="fd21" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要了解更多关于库的信息，请访问 GitHub 页面:</p><div class="ni nj gp gr nk nl"><a href="https://github.com/rstojnic/lazydata" rel="noopener  ugc nofollow" target="_blank"><div class="nm ab fo"><div class="nn ab no cl cj np"><h2 class="bd ir gy z fp nq fr fs nr fu fw ip bi translated">rstojnic/lazydata</h2><div class="ns l"><h3 class="bd b gy z fp nq fr fs nr fu fw dk translated">lazy data:Python 项目的可伸缩数据依赖——rstojnic/lazy data</h3></div><div class="nt l"><p class="bd b dl z fp nq fr fs nr fu fw dk translated">github.com</p></div></div><div class="nu l"><div class="nv l nw nx ny nu nz lz nl"/></div></div></a></div></div></div>    
</body>
</html>