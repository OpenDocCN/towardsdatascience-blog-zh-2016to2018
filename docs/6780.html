<html>
<head>
<title>Mean Shift Clustering Algorithm Example In Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python 中的均值漂移聚类算法示例</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-algorithms-part-13-mean-shift-clustering-example-in-python-4d6452720b00?source=collection_archive---------12-----------------------#2018-12-31">https://towardsdatascience.com/machine-learning-algorithms-part-13-mean-shift-clustering-example-in-python-4d6452720b00?source=collection_archive---------12-----------------------#2018-12-31</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/659b60bea8d00bb5943d4d95b3a60cbd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*joDouhfP-vB2zd6W"/></div></div></figure><div class=""/><p id="5180" class="pw-post-body-paragraph kf kg je kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">均值漂移是一种分层聚类算法。与有监督的机器学习算法相比，聚类试图在没有首先对标记数据进行训练的情况下对数据进行分组。聚类被广泛应用于搜索引擎、学术排名和医学等领域。与 K-Means 相反，当使用 Mean Shift 时，您不需要事先知道类别(聚类)的数量。均值漂移的缺点是计算量很大——O(n)。</p><h1 id="856d" class="ld le je bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">它是如何工作的</h1><ol class=""><li id="20d4" class="mb mc je kh b ki md km me kq mf ku mg ky mh lc mi mj mk ml bi translated">定义一个窗口(内核的带宽)并将该窗口放置在一个数据点上</li></ol><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/2e088ef9c6a50ff43affcadee6ee5bf9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1144/format:webp/1*0l-sKe3isb_y7dCfyoFT1A.png"/></div></figure><p id="3723" class="pw-post-body-paragraph kf kg je kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">2.计算窗口中所有点的平均值</p><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/d3069af2c661e88f3d535c53a161ee35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1194/format:webp/1*lGVU-5EjIzMJJyMFqhac5Q.png"/></div></figure><p id="078a" class="pw-post-body-paragraph kf kg je kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">3.将窗口的中心移动到平均值的位置</p><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/cfb6223b96fe02d476d00cad0cbd4cac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/format:webp/1*xsatowugNSNOmmWbh2BwiQ.png"/></div></figure><p id="0fb7" class="pw-post-body-paragraph kf kg je kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">4.重复步骤 2 和 3，直到收敛</p><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/8e88a0a289fb2211a05fb783db6317f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1170/format:webp/1*m9o3-2sYoozPs3HdFiczog.png"/></div></figure><h1 id="9c86" class="ld le je bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">python 中的示例</h1><p id="1c8f" class="pw-post-body-paragraph kf kg je kh b ki md kk kl km me ko kp kq mu ks kt ku mv kw kx ky mw la lb lc im bi translated">让我们看看如何使用 python 中的均值漂移算法来标注数据。</p><pre class="mn mo mp mq gt mx ke my mz aw na bi"><span id="b3ea" class="nb le je ke b gy nc nd l ne nf">import numpy as np<br/>import pandas as pd<br/>from sklearn.cluster import MeanShift<br/>from sklearn.datasets.samples_generator import make_blobs<br/>from matplotlib import pyplot as plt<br/>from mpl_toolkits.mplot3d import Axes3D</span></pre><p id="2e6e" class="pw-post-body-paragraph kf kg je kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">我们使用<code class="fe kb kc kd ke b">make_blobs</code>方法生成自己的数据。</p><pre class="mn mo mp mq gt mx ke my mz aw na bi"><span id="f0a4" class="nb le je ke b gy nc nd l ne nf">clusters = [[1,1,1],[5,5,5],[3,10,10]]<br/>X, _ = make_blobs(n_samples = 150, centers = clusters, cluster_std = 0.60)</span></pre><p id="a48a" class="pw-post-body-paragraph kf kg je kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">在训练模型之后，我们存储聚类中心的坐标。</p><pre class="mn mo mp mq gt mx ke my mz aw na bi"><span id="340d" class="nb le je ke b gy nc nd l ne nf">ms = MeanShift()<br/>ms.fit(X)<br/>cluster_centers = ms.cluster_centers_</span></pre><p id="7f9d" class="pw-post-body-paragraph kf kg je kh b ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc im bi translated">最后，我们在 3D 图形中绘制数据点和质心。</p><pre class="mn mo mp mq gt mx ke my mz aw na bi"><span id="d80f" class="nb le je ke b gy nc nd l ne nf">fig = plt.figure()<br/>ax = fig.add_subplot(111, projection='3d')</span><span id="9dc8" class="nb le je ke b gy ng nd l ne nf">ax.scatter(X[:,0], X[:,1], X[:,2], marker='o')</span><span id="301a" class="nb le je ke b gy ng nd l ne nf">ax.scatter(cluster_centers[:,0], cluster_centers[:,1], cluster_centers[:,2], marker='x', color='red', s=300, linewidth=5, zorder=10)</span><span id="552c" class="nb le je ke b gy ng nd l ne nf">plt.show()</span></pre><figure class="mn mo mp mq gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nh"><img src="../Images/d6f969eca14c56f71cf44eb24ba652e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rfO12CPgxuI0kIlJGxz5zg.png"/></div></div></figure></div></div>    
</body>
</html>