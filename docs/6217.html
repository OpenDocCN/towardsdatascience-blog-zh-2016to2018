<html>
<head>
<title>Numerical Integration: Romberg Integration</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数值积分:龙贝格积分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/numerical-integration-romberg-integration-3f54002ab538?source=collection_archive---------3-----------------------#2018-12-02">https://towardsdatascience.com/numerical-integration-romberg-integration-3f54002ab538?source=collection_archive---------3-----------------------#2018-12-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="43fa" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用数值方法积分</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi kf"><img src="../Images/6cbf65aa5357bac726739562f3f960d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*gffO9JEbXr6Q8L_nus8LWA.png"/></div></figure><p id="8656" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">我欣赏这种整合的概念，主要是因为在我们在课堂上讨论的方法中，这是唯一一种考虑消除其错误的方法。虽然不是全部，但淘汰真的很有帮助。</p><p id="73a8" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">首先，让我们也用自顶向下的方法来处理这个问题。我们一般先讨论数值积分，然后再讨论龙贝格积分。</p><h1 id="16f5" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated">数值积分</h1><h2 id="98e2" class="mb lk iq bd ll mc md dn lp me mf dp lt kw mg mh lv la mi mj lx le mk ml lz mm bi translated">历史背景</h2><p id="7176" class="pw-post-body-paragraph kn ko iq kp b kq mn jr ks kt mo ju kv kw mp ky kz la mq lc ld le mr lg lh li ij bi translated">要得到名字背后的原因，这个是需要的部分。</p><p id="ab25" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">数值积分也被称为“数值积分”或“定积分的数值逼近”。它的名字来自古代计算曲线图形面积的方法，其中最著名的是“圆的平方”问题，这意味着找到一个与给定圆面积相同的正方形。</p><h2 id="cd5b" class="mb lk iq bd ll mc md dn lp me mf dp lt kw mg mh lv la mi mj lx le mk ml lz mm bi translated">主要动机</h2><p id="b315" class="pw-post-body-paragraph kn ko iq kp b kq mn jr ks kt mo ju kv kw mp ky kz la mq lc ld le mr lg lh li ij bi translated">顾名思义，数值积分就是对一个函数进行积分。然而，我们不是已经会积分了吗(还记得数学 50 系列)？对，但也要记住，我们用公式来积分，并不是所有必须积分的函数都可以用这些公式来积分。他们只是普通的特例。</p><p id="c373" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">通过公式不可积分的积分的例子有:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/f637dcbebd613aee20d41478d27d3986.png" data-original-src="https://miro.medium.com/v2/resize:fit:606/format:webp/1*AUp4wxC0vJoAsq8WaJDWzg.png"/></div></figure><p id="6af4" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">它们可能看起来很简单，不像拥挤积分那样疯狂，但是它们仍然超出了我们以前学过的特殊公式的范围。</p><h2 id="9a6c" class="mb lk iq bd ll mc md dn lp me mf dp lt kw mg mh lv la mi mj lx le mk ml lz mm bi translated">假设和答案的性质</h2><p id="874d" class="pw-post-body-paragraph kn ko iq kp b kq mn jr ks kt mo ju kv kw mp ky kz la mq lc ld le mr lg lh li ij bi translated">我们设定假设，所以我们不会一次又一次地讨论它们。还有，答案的本质，明确我们应该期待什么样的答案。</p><p id="0fea" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kp ir">假设:</strong></p><ol class=""><li id="1e95" class="mt mu iq kp b kq kr kt ku kw mv la mw le mx li my mz na nb bi translated">一般认为积分的区间是有限的</li><li id="defb" class="mt mu iq kp b kq nc kt nd kw ne la nf le ng li my mz na nb bi translated">在很大程度上假设被积函数‘f’是连续光滑的</li></ol><p id="65fe" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kp ir">答案性质:</strong>“我们寻求单一数字的答案”</p><p id="db4e" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">这意味着我们不是在寻找一个函数或者一个符号公式。这将数值求积与微分方程的解、不定积分的计算以及许多符号计算的软件包区分开来。</p><p id="3842" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">最后一件事之前，移动过渡到龙贝格。众所周知，积分是一个无穷和。我们在这里做的是用一个有限和来逼近一个无限和。</p><p id="88bd" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">现在我们过渡到龙贝格。</p><p id="7fc0" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">假设在跳到这里之前，已经掌握了复合梯形法则的知识。尽管我们在下面讨论另一个先决条件。</p><h1 id="8f2b" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated">先决条件:理查森推断</h1><h2 id="29c8" class="mb lk iq bd ll mc md dn lp me mf dp lt kw mg mh lv la mi mj lx le mk ml lz mm bi translated">主要思想</h2><p id="b2cd" class="pw-post-body-paragraph kn ko iq kp b kq mn jr ks kt mo ju kv kw mp ky kz la mq lc ld le mr lg lh li ij bi translated">Richardson 外推法主要是一种提高某些数值方法精度的简单方法。这个可以消除错误。虽然它只能消除以下形式的错误:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="ni nj di nk bf nl"><div class="gh gi nh"><img src="../Images/20d44597e3d46b3c497dc9a85b14348c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1398/format:webp/1*9jv59JcHLF6uLj-JxkD2uw.png"/></div></div></figure><h2 id="ba1a" class="mb lk iq bd ll mc md dn lp me mf dp lt kw mg mh lv la mi mj lx le mk ml lz mm bi translated">理查森外推一般形式的推导</h2><p id="656e" class="pw-post-body-paragraph kn ko iq kp b kq mn jr ks kt mo ju kv kw mp ky kz la mq lc ld le mr lg lh li ij bi translated">这一部分将说明如何通过理查森外推法消除误差。</p><p id="3cb6" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kp ir">假设:</strong></p><ol class=""><li id="d9e3" class="mt mu iq kp b kq kr kt ku kw mv la mw le mx li my mz na nb bi translated">我们有一个近似的方法来计算某个量 G</li><li id="7108" class="mt mu iq kp b kq nc kt nd kw ne la nf le ng li my mz na nb bi translated">结果取决于参数“h ”,因此 g(h)的近似值由下式给出:G = g(h) + E(h)</li></ol><p id="d111" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kp ir">正确推导:</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/98c887df71ecc64ed82712387760c9d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/format:webp/1*G46KlRMdVnwkFI-HSMyKrg.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/0f2d98e64bf9cb5893c0ec7f1e171463.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*OZ4juOP1vXkMrpp7vMCSpw.png"/></div></figure><h1 id="9d8e" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated">方法:龙贝格积分</h1><p id="fb61" class="pw-post-body-paragraph kn ko iq kp b kq mn jr ks kt mo ju kv kw mp ky kz la mq lc ld le mr lg lh li ij bi translated">既然我们已经建立了先决条件，让我们进入主要的事情。</p><p id="780b" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kp ir">龙贝格整合</strong></p><p id="c8ff" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">龙贝格积分法结合了复合梯形法则和理查森外推法。</p><p id="f58b" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">下面是集成过程的概述:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi no"><img src="../Images/d95d56b758945ee6568486067dc85eb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/format:webp/1*kX_ZlniWDtQ3Y0YUN2gkJw.png"/></div></figure><p id="a3d8" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">这正是我们正在做的</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi np"><img src="../Images/24e8b623b994c18492d2321c72f87d1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1286/format:webp/1*haJeX57EYzB68sCahttRsA.png"/></div></figure><p id="577d" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">这告诉我们，我们需要计算两个箭头从哪里来，来计算两个箭头指向哪里。积分的最精确估计总是数组的最后一个对角线项。这个过程一直持续到两个连续对角线项之间的差变得足够小。</p><p id="a930" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">以上概述可以总结为公式:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/53b373eaeaa4bee844f7cb93c0035829.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*pAYANBxJR4BPA5lww609GA.png"/></div></figure><ul class=""><li id="be0f" class="mt mu iq kp b kq kr kt ku kw mv la mw le mx li nr mz na nb bi translated">CTR 的意思是复合梯形法则</li></ul><h2 id="e8c6" class="mb lk iq bd ll mc md dn lp me mf dp lt kw mg mh lv la mi mj lx le mk ml lz mm bi translated">用 Romberg 积分求积分</h2><p id="3776" class="pw-post-body-paragraph kn ko iq kp b kq mn jr ks kt mo ju kv kw mp ky kz la mq lc ld le mr lg lh li ij bi translated">放下所有需要的工具后，我们展示如何使用它们。我们先给出一个例子，然后我们给出<em class="ns">建议的</em>一般过程</p><p id="9a21" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kp ir">举例:</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/9a1f4b117c4a3f384d7296a6d1f84133.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/1*DXHgnvv3bmMqwLsK0cjXzg.png"/></div></figure><p id="dd83" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">首先，我们得到所有的工具(公式):</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/6e11d0d20d1cd30a962ccc61684346f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*qeFhy5-BAQ5K5IzBlzvNAg.png"/></div></figure><p id="3f4e" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">然后我们得到了上面的矩阵 R，因为这是我们将要填写的</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/dbd1a13c97f41c382c5e0bb8a895b9eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/1*7tn2--z1jNHR1CbWkJ2dUw.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/2da94bdace6b0d2f82074dd122203b4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*ZdQA695qO4lxlZDYWWlDUg.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/2fbf81631eecb2f37a628ce57275364d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1326/format:webp/1*7SyHlx9_sCE5eAO5XKpiBg.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/ce402a8bd3c818f71f34b792ed17cf08.png" data-original-src="https://miro.medium.com/v2/resize:fit:1338/format:webp/1*XhBUXbvveg9LiYniBf-TZQ.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/aced8f88c149745eaff4bed480f4c536.png" data-original-src="https://miro.medium.com/v2/resize:fit:1328/format:webp/1*aun3aLJEHFCYYy-ZFixwJg.png"/></div></figure><h2 id="9cf5" class="mb lk iq bd ll mc md dn lp me mf dp lt kw mg mh lv la mi mj lx le mk ml lz mm bi translated"><strong class="ak">一般流程</strong></h2><p id="76b0" class="pw-post-body-paragraph kn ko iq kp b kq mn jr ks kt mo ju kv kw mp ky kz la mq lc ld le mr lg lh li ij bi translated">因此，我们实际上可以看到<em class="ns">建议的</em>解决方案模式。我们总结如下:</p><p id="f649" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kp ir">挑战:</strong>使用龙贝格积分计算积分</p><p id="2733" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kp ir">需要公式:</strong>复合梯形法则和龙贝格</p><p id="8813" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated"><strong class="kp ir">流程:</strong></p><p id="7e86" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">提示:拿着另一张包含矩阵 R 的纸</p><ol class=""><li id="72e8" class="mt mu iq kp b kq kr kt ku kw mv la mw le mx li my mz na nb bi translated">计算 h</li><li id="9376" class="mt mu iq kp b kq nc kt nd kw ne la nf le ng li my mz na nb bi translated">使用 CTR 计算前两行的第一列</li><li id="422a" class="mt mu iq kp b kq nc kt nd kw ne la nf le ng li my mz na nb bi translated">对于 i&gt;1，使用 Romberg 公式计算该行中的下一列</li><li id="44ae" class="mt mu iq kp b kq nc kt nd kw ne la nf le ng li my mz na nb bi translated">对每一行重复步骤 1-3，直到它收敛到所需的解决方案。</li></ol><h1 id="1dd0" class="lj lk iq bd ll lm ln lo lp lq lr ls lt jw lu jx lv jz lw ka lx kc ly kd lz ma bi translated">总的来说，</h1><p id="6ee9" class="pw-post-body-paragraph kn ko iq kp b kq mn jr ks kt mo ju kv kw mp ky kz la mq lc ld le mr lg lh li ij bi translated">数值积分只是积分的近似，对于不能用特殊公式计算的积分是有用的。其中一种方法是龙贝格积分。从课堂上教授的方法中可以看出，这是通过使用 Richardson 外推法消除误差的唯一方法(尽管不是所有误差都被消除),如推导中所示。</p><p id="0c2e" class="pw-post-body-paragraph kn ko iq kp b kq kr jr ks kt ku ju kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">尽管复合辛普森的 1/3 规则胜过复合梯形规则和 Rombeg，但 Romberg 仍然保持着高效的王牌，并且还采用了复合梯形规则的稳健性。</p></div></div>    
</body>
</html>