<html>
<head>
<title>Stock2Vec — From ML to P/E</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Stock2Vec —从 ML 到 P/E</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/stock2vec-from-ml-to-p-e-2e6ba407c24?source=collection_archive---------3-----------------------#2017-05-26">https://towardsdatascience.com/stock2vec-from-ml-to-p-e-2e6ba407c24?source=collection_archive---------3-----------------------#2017-05-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="e372" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">希望这篇文章是我通过应用 ML 来了解它的系列文章的第一篇。你可以在这里  <em class="kl">找到这篇博文的代码</em> <a class="ae km" href="https://github.com/jperl/stock2vec/blob/master/stock2vec.ipynb" rel="noopener ugc nofollow" target="_blank"> <em class="kl">。</em></a></p></div><div class="ab cl kn ko hu kp" role="separator"><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks kt"/><span class="kq bw bk kr ks"/></div><div class="ij ik il im in"><h2 id="3875" class="ku kv iq bd kw kx ky dn kz la lb dp lc jy ld le lf kc lg lh li kg lj lk ll lm bi translated"><a class="ae km" href="https://en.wikipedia.org/wiki/Word2vec" rel="noopener ugc nofollow" target="_blank"> Word2Vec </a>是一个简单却惊人强大的算法。</h2><p id="74f0" class="pw-post-body-paragraph jn jo iq jp b jq ln js jt ju lo jw jx jy lp ka kb kc lq ke kf kg lr ki kj kk ij bi translated">它构建了<a class="ae km" href="https://blog.acolyer.org/2016/04/21/the-amazing-power-of-word-vectors/" rel="noopener ugc nofollow" target="_blank">单词向量</a>来表示单词含义。它仅仅通过周围的单词来学习这些意思。然后，您可以使用这些单词向量作为输入，使机器学习算法<a class="ae km" href="https://ronan.collobert.com/pub/matos/2008_nlp_icml.pdf" rel="noopener ugc nofollow" target="_blank">执行得更好</a>并找到<a class="ae km" href="http://byterot.blogspot.co.uk/2015/06/five-crazy-abstractions-my-deep-learning-word2doc-model-just-did-NLP-gensim.html" rel="noopener ugc nofollow" target="_blank">有趣的抽象</a>。</p><p id="b9cd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们把 Word2Vec 应用到股市会怎么样？</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi ls"><img src="../Images/61f123dd8dd019fa81062cfb26703e8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*ZOlD7ucOG0XNyw-DK3wT-A.gif"/></div></div></figure><p id="4127" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">选择 Stock2Vec 窗口</strong></p><p id="b807" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在 Word2Vec 中，每个单词的窗口都是周围的单词。对于 Stock2Vec 我们应该如何挑选每只股票的周边股票？</p><p id="1f93" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">股票市场有大量的变量可供选择:价格、成交量、移动平均线等。在和我在金融行业工作的朋友 Yuhi 讨论后，我们选择了市盈率。市盈率代表了市场对公司成长的预期。</p><p id="52b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">希望它能学到点什么！</p><p id="8967" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">建筑股票 2Vec </strong></p><p id="692e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在阅读 Quantopian 的 Zipline 的 API 文档时，我偶然发现了 Quandl Wiki 数据集，其中有 3000 家公司长达 40 年的免费数据。我将<a class="ae km" href="https://www.quandl.com/databases/WIKIP/documentation" rel="noopener ugc nofollow" target="_blank">价格数据</a>和<a class="ae km" href="https://www.quandl.com/data/SF1-Core-US-Fundamentals-Data" rel="noopener ugc nofollow" target="_blank">基本面数据</a>结合起来，这些数据都是从沙拉达尔那里购买的。然后我用 postgres 合并数据。预处理代码是<a class="ae km" href="https://github.com/jperl/stock2vec/blob/master/Preprocess%20Stock%20Data.ipynb" rel="noopener ugc nofollow" target="_blank">这里是</a>。</p><p id="61c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我改编了<a class="ae km" href="https://github.com/udacity/deep-learning/blob/master/embeddings/Skip-Grams-Solution.ipynb" rel="noopener ugc nofollow" target="_blank">嵌入项目</a>，它是我上周刚<a class="ae km" href="https://drive.google.com/file/d/0Bx6l5GmEYzJJMmtUVktvd1ptZUk/edit" rel="noopener ugc nofollow" target="_blank">完成的<a class="ae km" href="https://www.udacity.com/course/deep-learning-nanodegree-foundation--nd101" rel="noopener ugc nofollow" target="_blank"> Udacity 深度学习课程</a>的一部分</a>:在<a class="ae km" href="https://www.floydhub.com" rel="noopener ugc nofollow" target="_blank"> FloydHub </a>上训练模型，并用<a class="ae km" href="https://www.tensorflow.org/get_started/embedding_viz" rel="noopener ugc nofollow" target="_blank"> TensorBoard </a>可视化结果。你可以在这里找到训练代码<a class="ae km" href="https://github.com/jperl/stock2vec/blob/master/stock2vec.ipynb" rel="noopener ugc nofollow" target="_blank"/>。</p><h2 id="9b22" class="ku kv iq bd kw kx ky dn kz la lb dp lc jy ld le lf kc lg lh li kg lj lk ll lm bi translated">从第一个输出可以清楚地看出，Stock2Vec 学会了将相似的行业组合在一起。</h2><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi me"><img src="../Images/77f79e15973e1e1f8faa3049f77a6b3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mzwZpmIH91aAjrXzA2nkOQ.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">Tickers grouped by their vector similarity after 12 epochs</figcaption></figure><p id="6cc4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Stock2Vec 将生物制药公司归为一类:Vivus、Vical、Sarepta、ArQule、BioCryst 和 Siga。医疗公司:麦克森和希尔罗姆。医疗保健:安泰和信诺。服装公司:Gap 和 Guess、VF Corp 和 Wolverine World Wide。零售商:Office Depot 和 Best Buy。银行:太阳银行和 CapitalSource。</p><p id="c444" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">酷！！</p><p id="4a3a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">经过 20 个时期的训练后，这些是用<a class="ae km" href="http://distill.pub/2016/misread-tsne/" rel="noopener ugc nofollow" target="_blank"> t-SNE </a>绘制的嵌入。</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/e31e0c9d2b852935c02a0112bec1ff11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*RKED-YRJExTr0Mvs3H54MA.png"/></div></figure><p id="3690" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们选择一只股票，PNC 银行，我们可以看到最近的邻居。</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi mk"><img src="../Images/7046effc5c54db9067490bf4c0f3636b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M-ZMPUeNScRdbLoKEITA5w.png"/></div></div><figcaption class="mf mg gj gh gi mh mi bd b be z dk">PNC Nearest Neighbors t-SNE</figcaption></figure><p id="9905" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它们都是银行:富国银行、第一金融公司、高盛、信安金融集团、U.S. Bancorp、JP Morgan、Northrim Bancorp、StanCorp Financial Group、Camden National。</p><p id="14d0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们再选一个，WTI——一个石油和天然气探索者。</p><figure class="lt lu lv lw gt lx gh gi paragraph-image"><div role="button" tabindex="0" class="ly lz di ma bf mb"><div class="gh gi ml"><img src="../Images/38db05336deb0f749867029ba37570aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7lOdtkmAPJR7RYGRlNa2fw.png"/></div></div></figure><p id="d43d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最近的邻居都是能源公司:切萨皮克能源公司、斯通能源公司、Gastar 勘探公司、登伯里资源公司、Bonanza Creek 能源公司。</p><h2 id="6ee6" class="ku kv iq bd kw kx ky dn kz la lb dp lc jy ld le lf kc lg lh li kg lj lk ll lm bi translated"><strong class="ak">接下来的步骤</strong></h2><p id="3e1e" class="pw-post-body-paragraph jn jo iq jp b jq ln js jt ju lo jw jx jy lp ka kb kc lq ke kf kg lr ki kj kk ij bi translated">我正在研究一种新的算法，而不是深入研究 Stock2Vec，因为我想学习各种各样的算法。但是还有很多需要改进和未来研究的地方。</p><p id="eb21" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">预处理可以调整，不经常出现在同一个窗口的股票可以被删除。训练数据可以具有更高的分辨率，每分钟或 15 分钟。窗口函数可以使用其他变量、移动平均、β等。</p><p id="0f0b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有没有发现什么有趣的关系？SNAP 减 FB = MSFT 吗？如果你对这方面的研究感兴趣，我很乐意分享矢量数据。</p><p id="1e20" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这个项目很有趣，我学到了很多关于单词嵌入、numpy、TensorFlow 和 TensorBoard 的知识。我对我的下一个项目感到非常兴奋！</p><p id="0e3f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你在评论中有任何问题或建议，请告诉我，或者随时给我发电子邮件。</p><p id="f819" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi">— —</p><p id="7a0e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢 Yuhi 和 Gal 帮助购买基本面数据:)。</p></div></div>    
</body>
</html>