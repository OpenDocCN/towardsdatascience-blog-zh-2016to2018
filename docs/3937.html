<html>
<head>
<title>Data Analysis: Which Country has the Best Health in the World?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据分析:世界上哪个国家的健康状况最好？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-analysis-which-country-has-the-best-health-in-the-world-f41826763014?source=collection_archive---------13-----------------------#2018-07-02">https://towardsdatascience.com/data-analysis-which-country-has-the-best-health-in-the-world-f41826763014?source=collection_archive---------13-----------------------#2018-07-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="0376" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">在哪些国家，你最不可能缓慢、过早、痛苦地死去？</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/b85b4eaba1786c8f876934e8c223ffad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*E-MhYyg0fVCEfTYU"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Photo by <a class="ae ky" href="https://unsplash.com/@unitednations?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">United Nations COVID-19 Response</a> on <a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="8ddf" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">确定各国健康的 11 个方面</h1><p id="56fb" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">在这篇文章中，我将演示一些基本的数据争论和 R 中的可视化方法，同时尝试回答一个相当严肃和复杂的问题。</p><p id="2a3e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">请记住，这些数据来自一个更加快乐和简单的前 COVID 时代。事实上，<a class="ae ky" href="http://www.qog.pol.gu.se" rel="noopener ugc nofollow" target="_blank">数据</a>是由哥德堡大学政府质量研究所汇编的。它就像一个来自世界卫生组织、联合国和许多其他独立社会科学研究人员的数据集的元存储库，这些数据集被分解成不同的主题。我们将关注公共卫生。</p><p id="a49c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">因此，让我们看看是否可以使用 QoG 数据集来回答以下问题:</p><blockquote class="ms"><p id="e499" class="mt mu it bd mv mw mx my mz na nb mm dk translated">哪个国家最适合过上相对长寿、健康和幸福的生活？</p></blockquote><p id="2f79" class="pw-post-body-paragraph lr ls it lt b lu nc ju lw lx nd jx lz ma ne mc md me nf mg mh mi ng mk ml mm im bi translated">我决定从 11 个维度对每个国家进行评级(基于 QoG 数据集中此类数据的可用性)。这 11 个维度是:</p><ol class=""><li id="8527" class="nh ni it lt b lu mn lx mo ma nj me nk mi nl mm nm nn no np bi translated"><strong class="lt iu">艾滋病流行率</strong>(在% <strong class="lt iu"> ) </strong></li><li id="8bda" class="nh ni it lt b lu nq lx nr ma ns me nt mi nu mm nm nn no np bi translated"><strong class="lt iu">空气中 PM 2.5 的程度</strong><strong class="lt iu"/>(100 为最佳空气，0 为最差空气)</li><li id="4ad4" class="nh ni it lt b lu nq lx nr ma ns me nt mi nu mm nm nn no np bi translated"><strong class="lt iu">总</strong> <strong class="lt iu">烟草使用</strong></li><li id="b65b" class="nh ni it lt b lu nq lx nr ma ns me nt mi nu mm nm nn no np bi translated"><strong class="lt iu">婴儿死亡率(</strong>每 1，000 名新生儿的死亡率)</li><li id="af86" class="nh ni it lt b lu nq lx nr ma ns me nt mi nu mm nm nn no np bi translated"><strong class="lt iu">卫生水平和公共用水清洁度</strong></li><li id="dd31" class="nh ni it lt b lu nq lx nr ma ns me nt mi nu mm nm nn no np bi translated"><strong class="lt iu"/><strong class="lt iu">公共服务的程度</strong> (10 表示非常不可靠，1 表示非常稳定)</li><li id="464c" class="nh ni it lt b lu nq lx nr ma ns me nt mi nu mm nm nn no np bi translated"><strong class="lt iu">酒精消费</strong>(2000 年以后)</li><li id="bdb0" class="nh ni it lt b lu nq lx nr ma ns me nt mi nu mm nm nn no np bi translated"><strong class="lt iu">主观幸福感</strong>(评分 1-4 非常幸福)</li><li id="5ceb" class="nh ni it lt b lu nq lx nr ma ns me nt mi nu mm nm nn no np bi translated"><strong class="lt iu">肺结核发病率</strong></li><li id="9f05" class="nh ni it lt b lu nq lx nr ma ns me nt mi nu mm nm nn no np bi translated"><strong class="lt iu">联合国人类发展指数得分</strong>(0-100 分最佳)</li><li id="c370" class="nh ni it lt b lu nq lx nr ma ns me nt mi nu mm nm nn no np bi translated"><strong class="lt iu"> 2017 年肥胖率</strong> *(添加到原始数据中进行额外测量)</li></ol><p id="4f24" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">请注意，对于某些衡量标准，低分是好的，而对于其他衡量标准，高分是好的。我们将在后面的排名部分处理这个问题。</p><h2 id="8395" class="nv la it bd lb nw nx dn lf ny nz dp lj ma oa ob ll me oc od ln mi oe of lp og bi translated">比较 39 个国家</h2><p id="56ae" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">首先，我们读入数据并选择 11 个变量。剔除缺失值后，我们得到了全球 39 个国家的样本。</p><pre class="kj kk kl km gt oh oi oj ok aw ol bi"><span id="5eb5" class="nv la it oi b gy om on l oo op">library(tidyverse)<br/>df_f <strong class="oi iu">&lt;-</strong> read.csv('qog.csv')<br/>df <strong class="oi iu">&lt;-</strong> df_f <strong class="oi iu">%&gt;%</strong><br/>  select(matches('cname'),matches('ccodealp'),matches('hiv'),matches('pm25'), matches('tobt'), matches('imort'),<br/>         matches('alc2000'), matches('ehwater'), matches('wvs_hap'), matches('ffp_ps'),<br/>         matches('wef_ct'), matches('hdi'))<strong class="oi iu">%&gt;%</strong><br/>  na.omit()<br/>rm(df_f)<br/>head(df)</span></pre><p id="831e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们数据的样本:</p><pre class="kj kk kl km gt oh oi oj ok aw ol bi"><span id="e197" class="nv la it oi b gy om on l oo op">##         cname ccodealp wef_chiv epi_pm25 who_tobt wef_imort who_alc2000<br/>## 7  Azerbaijan      AZE     0.20    94.30     23.5      30.8        2.14<br/>## 8   Argentina      ARG     0.40   100.00     25.3      12.7        7.93<br/>## 9   Australia      AUS     0.20   100.00     16.0       4.1        9.71<br/>## 14    Armenia      ARM     0.20    85.76     28.0      14.7        3.91<br/>## 21     Brazil      BRA     0.45   100.00     16.1      12.9        7.32<br/>## 36      Chile      CHL     0.40   100.00     38.9       7.8        7.16<br/>##    epi_ehwater  wvs_hap ffp_ps wef_ct undp_hdi<br/>## 7        77.47 3.052584    5.4   95.0    0.758<br/>## 8        92.52 3.199185    4.3   25.0    0.826<br/>## 9       100.00 3.277956    2.0    6.5    0.937<br/>## 14       83.21 3.091120    4.1   52.0    0.741<br/>## 21       84.66 3.264543    5.9   46.0    0.754<br/>## 36       94.25 3.084253    4.5   16.0    0.845</span></pre><h2 id="73c1" class="nv la it bd lb nw nx dn lf ny nz dp lj ma oa ob ll me oc od ln mi oe of lp og bi translated">使用 rvest 丢弃肥胖数据</h2><p id="df52" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">获取肥胖数据需要我们从<a class="ae ky" href="https://renewbariatrics.com/obesity-rank-by-countries/" rel="noopener ugc nofollow" target="_blank"> renewbariatrics </a>网站获取 HTML 表格。我们将使用超级易用的 Rvest 包来完成这项工作。</p><pre class="kj kk kl km gt oh oi oj ok aw ol bi"><span id="0ea3" class="nv la it oi b gy om on l oo op">library(rvest)</span><span id="1186" class="nv la it oi b gy oq on l oo op">url <strong class="oi iu">&lt;-</strong> 'https://renewbariatrics.com/obesity-rank-by-countries/'<br/>codes_url <strong class="oi iu">&lt;-</strong> read_html(url)<br/><em class="or">#Use the CSS selector to extract table data from the webiste</em><br/>html_data <strong class="oi iu">&lt;-</strong> html_nodes(codes_url,'td')<br/>table_text <strong class="oi iu">&lt;-</strong> html_text(html_data)<br/><br/><em class="or">#easiest way is to recreate the table as a matrix and read in by row</em><br/>mat_weight <strong class="oi iu">&lt;-</strong> matrix(table_text, nrow <strong class="oi iu">=</strong> 192, ncol<strong class="oi iu">=</strong>6, byrow<strong class="oi iu">=TRUE</strong>)<br/><br/>weight_df <strong class="oi iu">&lt;-</strong> data.frame(country <strong class="oi iu">=</strong> mat_weight[,2], perc_obese <strong class="oi iu">=</strong> mat_weight[,6])<br/><br/><em class="or">#Get rid of percent signs and convert to decimal</em><br/>weight_df<strong class="oi iu">$</strong>perc_obese <strong class="oi iu">&lt;-</strong> <strong class="oi iu">as.numeric</strong>(gsub('%', '', weight_df<strong class="oi iu">$</strong>perc_obese))<strong class="oi iu">/</strong>100<br/>head(weight_df)</span></pre><p id="2975" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">由此产生的六大肥胖率:</p><pre class="kj kk kl km gt oh oi oj ok aw ol bi"><span id="cec4" class="nv la it oi b gy om on l oo op">##        country perc_obese<br/>## 1 Cook Islands      0.508<br/>## 2        Palau      0.476<br/>## 3        Nauru      0.456<br/>## 4        Samoa      0.434<br/>## 5        Tonga      0.433<br/>## 6         Niue      0.432</span></pre><p id="e88c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">为了保持我们原来的国家，我们需要做一些乏味但必要的改变。这张粗糙的表格使用了稍微不同的国家名称。</p><pre class="kj kk kl km gt oh oi oj ok aw ol bi"><span id="8dcd" class="nv la it oi b gy om on l oo op">idex_num <strong class="oi iu">&lt;-</strong> which(df<strong class="oi iu">$</strong>cname <strong class="oi iu">==</strong> 'Malaysia (1966-)')<br/>df<strong class="oi iu">$</strong>cname <strong class="oi iu">&lt;-</strong> <strong class="oi iu">as.character</strong>(df<strong class="oi iu">$</strong>cname)<br/>df<strong class="oi iu">$</strong>cname[idex_num] <strong class="oi iu">&lt;-</strong> 'Malaysia'<br/><br/>idex_num <strong class="oi iu">&lt;-</strong> which(df<strong class="oi iu">$</strong>cname <strong class="oi iu">==</strong> 'Pakistan (1971-)')<br/>df<strong class="oi iu">$</strong>cname[idex_num] <strong class="oi iu">&lt;-</strong> 'Pakistan'<br/><br/>idex_num <strong class="oi iu">&lt;-</strong> which(df<strong class="oi iu">$</strong>cname <strong class="oi iu">==</strong> 'United States')<br/>df<strong class="oi iu">$</strong>cname[idex_num] <strong class="oi iu">&lt;-</strong> 'United States of America'<br/><br/>idex_num <strong class="oi iu">&lt;-</strong> which(df<strong class="oi iu">$</strong>cname <strong class="oi iu">==</strong> 'Russia')<br/>df<strong class="oi iu">$</strong>cname[idex_num] <strong class="oi iu">&lt;-</strong> 'Russian Federation'</span></pre><p id="84dd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在棘手的部分将是匹配的名称与我们现有的名称。因为我们已经确保更改名称以使它们相同，所以我们不应该丢失任何观察结果(我希望)。让我们尝试一个 inner_join(变异连接),只保留匹配的行</p><pre class="kj kk kl km gt oh oi oj ok aw ol bi"><span id="6478" class="nv la it oi b gy om on l oo op"><em class="or">#convert to character instead of factor</em><br/>weight_df<strong class="oi iu">$</strong>country <strong class="oi iu">&lt;-</strong> <strong class="oi iu">as.character</strong>(weight_df<strong class="oi iu">$</strong>country)<br/><br/><em class="or">#Nice tip: use semi_join to see what will be joined before you use inner_join</em><br/><em class="or">#I was able to see that Russia was missing </em><br/>df <strong class="oi iu">%&gt;%</strong><br/>  rename('country' <strong class="oi iu">=</strong> cname)<strong class="oi iu">%&gt;%</strong><br/>  semi_join(weight_df, by<strong class="oi iu">=</strong>'country')<strong class="oi iu">%&gt;%</strong><br/>  head()</span></pre><p id="c28c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">验证我们的结果:</p><pre class="kj kk kl km gt oh oi oj ok aw ol bi"><span id="acb6" class="nv la it oi b gy om on l oo op">##      country ccodealp wef_chiv epi_pm25 who_tobt wef_imort who_alc2000<br/>## 1 Azerbaijan      AZE     0.20    94.30     23.5      30.8        2.14<br/>## 2  Argentina      ARG     0.40   100.00     25.3      12.7        7.93<br/>## 3  Australia      AUS     0.20   100.00     16.0       4.1        9.71<br/>## 4    Armenia      ARM     0.20    85.76     28.0      14.7        3.91<br/>## 5     Brazil      BRA     0.45   100.00     16.1      12.9        7.32<br/>## 6      Chile      CHL     0.40   100.00     38.9       7.8        7.16<br/>##   epi_ehwater  wvs_hap ffp_ps wef_ct undp_hdi<br/>## 1       77.47 3.052584    5.4   95.0    0.758<br/>## 2       92.52 3.199185    4.3   25.0    0.826<br/>## 3      100.00 3.277956    2.0    6.5    0.937<br/>## 4       83.21 3.091120    4.1   52.0    0.741<br/>## 5       84.66 3.264543    5.9   46.0    0.754<br/>## 6       94.25 3.084253    4.5   16.0    0.845</span></pre><p id="ade0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">好了，一切看起来都很好:没有 NAs 或疯狂的价值观。我们现在可以使用这个新的肥胖维度重新进行分析。</p><pre class="kj kk kl km gt oh oi oj ok aw ol bi"><span id="e9c9" class="nv la it oi b gy om on l oo op"><em class="or">#looks good so add together</em><br/>df <strong class="oi iu">&lt;-</strong> df <strong class="oi iu">%&gt;%</strong><br/>  rename('country' <strong class="oi iu">=</strong> cname)<strong class="oi iu">%&gt;%</strong><br/>  inner_join(weight_df, by <strong class="oi iu">=</strong> 'country')</span></pre><p id="4e8e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我们最后去了哪 39 个国家？</p><pre class="kj kk kl km gt oh oi oj ok aw ol bi"><span id="f401" class="nv la it oi b gy om on l oo op"><em class="or">#Which 39 countries? </em><br/><strong class="oi iu">for</strong> (n <strong class="oi iu">in</strong> df<strong class="oi iu">$</strong>country){<br/>  cat(paste(n, " "))<br/>}</span><span id="201f" class="nv la it oi b gy oq on l oo op">## Azerbaijan  Argentina  Australia  Armenia  Brazil  Chile  China  Colombia  Ecuador  Georgia  Germany  Ghana  India  Kazakhstan  Jordan  Kyrgyzstan  Lebanon  Malaysia  Mexico  Morocco  Netherlands  New Zealand  Nigeria  Pakistan  Philippines  Poland  Romania  Russian Federation  Singapore  Slovenia  South Africa  Spain  Sweden  Thailand  Turkey  Ukraine  Egypt  United States of America  Uruguay</span></pre><p id="e84a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">最后，我们准备用这些修正的名字和新的肥胖变量重新运行我们的分析。</p><h2 id="d3f8" class="nv la it bd lb nw nx dn lf ny nz dp lj ma oa ob ll me oc od ln mi oe of lp og bi translated">维度间的相关性</h2><pre class="kj kk kl km gt oh oi oj ok aw ol bi"><span id="3749" class="nv la it oi b gy om on l oo op">library(corrplot)</span><span id="37d9" class="nv la it oi b gy oq on l oo op">df <strong class="oi iu">%&gt;%</strong><br/>  select_if(is.numeric)<strong class="oi iu">%&gt;%</strong><br/>  cor()<strong class="oi iu">%&gt;%</strong><br/>  corrplot(method<strong class="oi iu">=</strong>'number')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi os"><img src="../Images/7bc90ca39115565f5844a8c4aacd1c53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/0*LfL4_Q1FDXsVpOjK.png"/></div></figure><p id="f007" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这非常有趣，值得花些时间研究一下。</p><ol class=""><li id="2da6" class="nh ni it lt b lu mn lx mo ma nj me nk mi nl mm nm nn no np bi translated">毫不奇怪，结核病和艾滋病毒感染率高度相关。这表明在控制传染病方面存在系统性问题。</li><li id="55c2" class="nh ni it lt b lu nq lx nr ma ns me nt mi nu mm nm nn no np bi translated">糟糕的空气与低幸福感有关。这是有道理的，但它值得重申。你的幸福可能取决于你国家的空气有多干净。</li><li id="bf35" class="nh ni it lt b lu nq lx nr ma ns me nt mi nu mm nm nn no np bi translated">不足为奇的是，婴儿死亡率高与水卫生条件差有关。</li><li id="2fef" class="nh ni it lt b lu nq lx nr ma ns me nt mi nu mm nm nn no np bi translated">从本质上讲，人类发展指数与公共服务变量衡量的是同一事物。</li><li id="2923" class="nh ni it lt b lu nq lx nr ma ns me nt mi nu mm nm nn no np bi translated">较高的酒精消费量与较低的婴儿死亡率和较高的人类发育有关。有意思。也许这与更多发展带来的额外闲暇时间有关。较贫穷的国家没有闲坐在一起和朋友喝啤酒的奢侈。</li><li id="d301" class="nh ni it lt b lu nq lx nr ma ns me nt mi nu mm nm nn no np bi translated">肥胖与幸福负相关，但与人类发展水平正相关。婴儿死亡率和肥胖是相反的关系。关于富有和现代的一些东西正在使我们变胖。有没有注意到所有的老英国君主都很胖？我敢打赌，富人的饮食中有一些因素导致了他们更高的肥胖率(提示:可能是肉类/动物产品消费的增加)。在以后的文章中，我会查看 GDP 增长和身体质量指数变化的时间序列数据来验证这一点。</li></ol><p id="086e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">还有很多更有趣的关联！</p><h2 id="304f" class="nv la it bd lb nw nx dn lf ny nz dp lj ma oa ob ll me oc od ln mi oe of lp og bi translated">感知地图:使用主成分分析可视化国家之间的关系</h2><p id="7710" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">如果你不熟悉感知地图，我建议你看一本由克里斯·查普曼和埃利亚·费特写的非常好的书，名为《营销研究和分析》。“基本上，我们将在 10 个维度上运行主成分分析，减少到两个维度，然后在两个维度上可视化国家分组。</p><pre class="kj kk kl km gt oh oi oj ok aw ol bi"><span id="db2c" class="nv la it oi b gy om on l oo op"><em class="or">#Keep row names for ID. Very useful bit of code</em><br/>rownames(df) <strong class="oi iu">&lt;-</strong> df[,2]<br/><br/><em class="or">#Run PCA. Make sure to scale your data first. Otherwise the PCs will reflect the dimensions with huge units</em><br/>ct_pc <strong class="oi iu">&lt;-</strong> prcomp(df[,3<strong class="oi iu">:</strong>ncol(df)], scale. <strong class="oi iu">=</strong> <strong class="oi iu">TRUE</strong>)<br/>summary(ct_pc)</span><span id="e575" class="nv la it oi b gy oq on l oo op">## Importance of components:<br/>##                           PC1    PC2    PC3     PC4     PC5     PC6<br/>## Standard deviation     2.1693 1.3695 1.2621 1.00579 0.79305 0.74069<br/>## Proportion of Variance 0.4278 0.1705 0.1448 0.09196 0.05717 0.04987<br/>## Cumulative Proportion  0.4278 0.5983 0.7431 0.83508 0.89225 0.94213<br/>##                            PC7     PC8    PC9   PC10   PC11<br/>## Standard deviation     0.57025 0.41706 0.2482 0.1961 0.1934<br/>## Proportion of Variance 0.02956 0.01581 0.0056 0.0035 0.0034<br/>## Cumulative Proportion  0.97169 0.98750 0.9931 0.9966 1.0000</span></pre><p id="82b0" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">summary()函数在决定保留多少台电脑时非常有用。在这里我们可以看到，5 个变量覆盖了我们最初的 10 个变量中大约 90%的方差。我们将只保留解释 60%方差的前两个。</p><p id="dddd" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果你是一个视觉型的人，你可以使用 screeplot 找到下一台电脑捕捉到的边际差异似乎下降的“肘部”。</p><pre class="kj kk kl km gt oh oi oj ok aw ol bi"><span id="5024" class="nv la it oi b gy om on l oo op">plot(ct_pc, type<strong class="oi iu">=</strong>'l')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi os"><img src="../Images/40caf917176beb165981acd3d1d2c450.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/0*IWQk7uuGwnsA8ILi.png"/></div></figure><p id="b0ef" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果我要在预测模型中使用它，我可能会决定保留 4-5 个，但这里我们只保留前两个，以便于可视化。</p><h2 id="3d72" class="nv la it bd lb nw nx dn lf ny nz dp lj ma oa ob ll me oc od ln mi oe of lp og bi translated">用双标图可视化电脑</h2><p id="73a9" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">为了可视化结果，我们使用 biplot()函数。仅供参考，南非是“ZAF”</p><pre class="kj kk kl km gt oh oi oj ok aw ol bi"><span id="ea8b" class="nv la it oi b gy om on l oo op">biplot(ct_pc, cex<strong class="oi iu">=c</strong>(.7,1), expand<strong class="oi iu">=</strong>1.5,<br/>       sub<strong class="oi iu">=</strong>'Comparing countries on the 11 dimensions of Health')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi os"><img src="../Images/d5787b5a51696cd15c77d60cb9fa6da3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/0*TD-23ZgtqkZw2kif.png"/></div></figure><p id="59bc" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">这个双图包含了大量的信息，它的解释可能很复杂。我们来分解一下。</p><p id="a85f" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">首先注意 x/y 轴是 PC1 和 PC2，它们累计解释了原始变量中大约 60%的变化。因此，我们已经知道这个故事不仅仅是这两个电脑分数，还有大约 40%的故事没有被披露。</p><p id="f5fc" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">第二，红色箭头(向量)既有大小又有角度。这些箭头相对于 x/y 轴的角度显示了这些原始变量被 PCs“捕获”的程度。因此，PC2 很好地捕捉到了几乎垂直的线条(艾滋病毒和结核病比率)，而 PC1 似乎捕捉到了婴儿死亡率、公共服务、水卫生和人类发展指数。</p><p id="ea9e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">两个原始变量(红线)之间的角度代表相关的方向。所以婴儿死亡率和公共服务是非常正相关的，而艾滋病毒感染率和烟草使用是负相关的。这些解释应该与我们从上面的相关矩阵中得到的结果相符。最后，这个我不确定，但是箭头的长度代表了原始变量的标准差。所以如果你对长度求平方，你就代表了变量的方差。</p><h1 id="22ff" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">解释双绘图的陷阱</h1><p id="0e14" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">双翼飞机是微妙的生物。如果你不相信我，可以看看 StackOverflow 关于它们的一些讨论。现在，我们将只关注最实际的含义和陷阱。</p><p id="fcd6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">首先，国家在双标图上的位置是<strong class="lt iu">相对于</strong>的，因此改变变量的数量和/或添加/删除国家将影响它们之间的关系。</p><p id="d150" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">第二，记得我提到过 PC1 和 PC2 只占所有原始变量方差的 60%左右。这意味着在这 60%的方差中可能没有考虑到国家之间的其他关系。简而言之，这个故事不仅仅是你在这个双绘图中看到的。</p><p id="5de6" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">正如查普曼和费特解释的那样，</p><blockquote class="ot ou ov"><p id="279a" class="lr ls or lt b lu mn ju lw lx mo jx lz ow mp mc md ox mq mg mh oy mr mk ml mm im bi translated">“当我们查看 PC1 和 PC2 的分数时，我们看到的是‘最大程度的相似性’，这可能会隐藏其他 PC 中其他较小的差异。”</p></blockquote><p id="7c6a" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">在这个前提下，让我们快速回顾一下双标图告诉我们的内容。</p><ol class=""><li id="d0ca" class="nh ni it lt b lu mn lx mo ma nj me nk mi nl mm nm nn no np bi translated">南非(ZAF)在左领域遥遥领先，可能是由于婴儿死亡率和艾滋病病毒感染率。</li><li id="8d03" class="nh ni it lt b lu nq lx nr ma ns me nt mi nu mm nm nn no np bi translated">有趣的是，约旦和黎巴嫩聚集在一起，主要是因为他们的烟草使用水平。现在，中国和埃及似乎又聚集在一起了，因为它们的烟草使用水平高，而艾滋病/肺结核的发病率低。</li><li id="8952" class="nh ni it lt b lu nq lx nr ma ns me nt mi nu mm nm nn no np bi translated">印度和巴基斯坦有着相似的婴儿死亡率、肺结核(高数字是不好的)和不稳定的公共服务。他们出奇的亲密。考虑到他们在 1971 年之前本质上是同一个国家，这是有道理的。</li><li id="a2cd" class="nh ni it lt b lu nq lx nr ma ns me nt mi nu mm nm nn no np bi translated">尼日利亚和加纳这两个非洲国家似乎是高婴儿死亡率和结核病的负面组合，再加上艾滋病毒和糟糕的公共服务。</li></ol><p id="d412" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">国家的地理聚类表明，PCA 在计算不同国家的相似性和差异性方面非常有效。矛盾的是，任何一种统计学习程序都应该(大致)符合我们的预期，但是如果它 100%符合我们的预期，我们就不会学到任何东西。因此，理想情况下，我们的分析会与我们的直觉相符，但我们仍抱有希望，希望有一些未知因素会迫使我们重新评估我们的假设，甚至重新检查我们的数据，以确保它们是正确的。这就是数据驱动方法的美妙之处:它们可以为我们提供一个新的视角，让我们了解一个我们本以为已经了解的话题。</p><h2 id="8c78" class="nv la it bd lb nw nx dn lf ny nz dp lj ma oa ob ll me oc od ln mi oe of lp og bi translated">超越前两台电脑的视觉化</h2><p id="d75e" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">你可以使用 choices=c(3，4)以 PC3 和 4 为轴重新制作剧情。只是为了好玩，我们来试试。</p><p id="2157" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">因为多达 5 个电脑解释了 90%的差异，所以也值得检查一下这个图。请将此图视为显示 PC3 和 4 如何“吸收”PC1 和 2 未捕捉到的剩余方差。</p><pre class="kj kk kl km gt oh oi oj ok aw ol bi"><span id="5991" class="nv la it oi b gy om on l oo op">biplot(ct_pc, cex<strong class="oi iu">=c</strong>(.7,.8), expand<strong class="oi iu">=</strong>1.2, choices<strong class="oi iu">=c</strong>(3,4),<br/>       sub<strong class="oi iu">=</strong>'Comparing countries on the 11 dimensions of Health')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi os"><img src="../Images/920e4d9c9687295d12a38d0f0a697883.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/0*xmuQxzwCVMASI9KA.png"/></div></figure><p id="679d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">现在我们看到 PC3 代表不同的变量(幸福)，PC4 捕捉了 PM 2.5 和肥胖率的许多变化。有趣的是，根据这些指标，现在中东国家因其较高的肥胖率和较低的饮酒量而被归为一类。</p><h1 id="56f3" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">那么哪个国家的健康状况最好呢？</h1><p id="954c" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">正如我前面提到的，这是一个超级复杂的问题，但只是为了好玩，让我们看看我们能想出什么。以下是后面的想法。我们将根据每个变量的得分对国家进行排名，并计算哪些国家在所有 11 个维度上的总体排名最低(最好)。我们将把那个国家评为“最健康的国家”但我们将会遇到的一个问题是，有些维度在“好”方面得分很高，而其他维度在“好”方面得分很低。</p><pre class="kj kk kl km gt oh oi oj ok aw ol bi"><span id="81b4" class="nv la it oi b gy om on l oo op"><em class="or">#Separate columns into those where higher is better</em><br/>up_ranks <strong class="oi iu">&lt;-</strong> df[,colnames(df) <strong class="oi iu">%in%</strong> <strong class="oi iu">c</strong>("epi_pm25","epi_ehwater",<br/>                                              "undp_hdi", "wvs_hap")]<br/><br/><em class="or">#Separate where lower scores are better</em><br/>low_ranks <strong class="oi iu">&lt;-</strong> df[,colnames(df) <strong class="oi iu">%in%</strong> <strong class="oi iu">c</strong>("who_alc2000", "ffp_ps", "wef_ct",<br/>                        "wef_imort", "wef_chiv", "who_tobt", "perc_obese")]<br/><br/><em class="or">#Now we rank </em><br/>df_low_rank <strong class="oi iu">&lt;-</strong> apply(low_ranks, 2, rank)<br/><br/><em class="or">#Use opposite ranking method</em><br/>df_high_rank <strong class="oi iu">&lt;-</strong> apply(up_ranks, 2, <strong class="oi iu">function</strong>(x) rank(<strong class="oi iu">-</strong>x))<br/><br/><em class="or">#now assemble</em><br/>df_ranked <strong class="oi iu">&lt;-</strong> cbind(df_low_rank, df_high_rank)<br/><br/><em class="or">#Here's what we end up with. 1 means best and 39 means worst.</em><br/>head(df_ranked)</span></pre><p id="001c" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">结果:</p><pre class="kj kk kl km gt oh oi oj ok aw ol bi"><span id="bfad" class="nv la it oi b gy om on l oo op">##     wef_chiv who_tobt wef_imort who_alc2000 ffp_ps wef_ct perc_obese<br/>## AZE       18       19        34          10   25.0   29.0         22<br/>## ARG       27       22        21          27   14.5   16.0         28<br/>## AUS       18        7         7          35    6.5    5.0         33<br/>## ARM       18       29        24          14   13.0   21.0         12<br/>## BRA       30        8        22          25   29.0   19.0         14<br/>## CHL       27       38        13          23   16.5   10.5         31<br/>##     epi_pm25 epi_ehwater wvs_hap undp_hdi<br/>## AZE       24          31      28     21.5<br/>## ARG       11          13      18     12.0<br/>## AUS       11           2      13      1.0<br/>## ARM       27          24      25     25.5<br/>## BRA       11          21      14     23.0<br/>## CHL       11          12      26     11.0</span></pre><p id="3611" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">让我们尝试对这些数据进行一些可视化处理，以获得更好的感受。我不常可视化排名数据，所以我欢迎任何关于哪种方法最适合显示这些数据的反馈。</p><h2 id="ce23" class="nv la it bd lb nw nx dn lf ny nz dp lj ma oa ob ll me oc od ln mi oe of lp og bi translated">等级热图</h2><pre class="kj kk kl km gt oh oi oj ok aw ol bi"><span id="54b0" class="nv la it oi b gy om on l oo op">library(gplots)</span><span id="28a0" class="nv la it oi b gy oq on l oo op">heatmap.2(df_ranked,dendrogram <strong class="oi iu">=</strong> 'none', scale<strong class="oi iu">=</strong>'none', key<strong class="oi iu">=FALSE</strong>, cexRow<strong class="oi iu">=</strong>.6,<br/>          main<strong class="oi iu">=</strong>'Red = low rank (Good), White = (Bad)')</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi os"><img src="../Images/713292c01dc6e0016fe39d35df1f978f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/0*WRlN3jzAAhplyJ7W.png"/></div></figure><p id="a45d" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我在那里保留了跟踪，因为它向您显示了颜色相对于平均值的位置(列方向)。例如，对于 HIV 比率，您可以看到白色代表较高的分数，因此轨迹会在右侧弹出。暗红色向左移动轨迹。你可以看到约旦的艾滋病流行率排名最高。</p><p id="73c7" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">你还可以看到一大群欧洲国家在所有基本生活统计上都是暗红色的，但在烟草使用或酒精消费方面表现不佳——这是早期死亡率的两个强有力的预测指标。</p><p id="a496" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">美国是“肥胖”的白人，因为他们在 39 个国家中排名第一。</p><h2 id="298f" class="nv la it bd lb nw nx dn lf ny nz dp lj ma oa ob ll me oc od ln mi oe of lp og bi translated">让我们最终选出一个获胜者，并想象结果</h2><pre class="kj kk kl km gt oh oi oj ok aw ol bi"><span id="9b61" class="nv la it oi b gy om on l oo op"><em class="or">#convert to Df</em><br/>df_ranked <strong class="oi iu">&lt;-</strong> as.data.frame(df_ranked)<br/><br/><em class="or">#Find average ranks per country</em><br/>score_mat <strong class="oi iu">&lt;-</strong> as.matrix(apply(df_ranked, 1, mean))<br/><br/><em class="or">#then rank by lowest average rank</em><br/>final_ranks <strong class="oi iu">&lt;-</strong> apply(score_mat, 2, rank)<br/><br/><em class="or">#sort to get final list</em><br/>sort_ranks <strong class="oi iu">&lt;-</strong> apply(final_ranks, 2, sort)<br/>sort_ranks</span></pre><p id="bd26" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">从最好到最差的最终排名:</p><pre class="kj kk kl km gt oh oi oj ok aw ol bi"><span id="8b25" class="nv la it oi b gy om on l oo op">##     [,1]<br/>## SGP  1.0<br/>## SWE  2.0<br/>## NZL  3.0<br/>## AUS  4.0<br/>## NLD  5.0<br/>## MYS  6.0<br/>## DEU  7.0<br/>## USA  8.0<br/>## SVN  9.0<br/>## ESP 10.0<br/>## URY 11.0<br/>## ECU 12.0<br/>## ARG 13.0<br/>## POL 14.0<br/>## MEX 15.0<br/>## BRA 16.0<br/>## COL 17.0<br/>## CHL 18.0<br/>## TUR 19.0<br/>## JOR 20.0<br/>## ARM 21.0<br/>## KAZ 22.0<br/>## PHL 23.0<br/>## THA 24.0<br/>## GHA 25.5<br/>## LBN 25.5<br/>## KGZ 27.0<br/>## CHN 28.0<br/>## EGY 29.0<br/>## MAR 30.0<br/>## ROU 31.0<br/>## AZE 32.0<br/>## GEO 33.0<br/>## PAK 34.0<br/>## UKR 35.0<br/>## RUS 36.0<br/>## NGA 37.0<br/>## IND 38.0<br/>## ZAF 39.0</span></pre><h2 id="f877" class="nv la it bd lb nw nx dn lf ny nz dp lj ma oa ob ll me oc od ln mi oe of lp og bi translated">确定最健康的前 5 名</h2><p id="f4c8" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">现在你知道了，根据我们的标准，“健康”排名前五的国家(根据你的真实定义)依次是:</p><blockquote class="ms"><p id="5ab5" class="mt mu it bd mv mw mx my mz na nb mm dk translated">新加坡、瑞典、新西兰、澳大利亚和荷兰。</p></blockquote><p id="9b53" class="pw-post-body-paragraph lr ls it lt b lu nc ju lw lx nd jx lz ma ne mc md me nf mg mh mi ng mk ml mm im bi translated">如果将肥胖率考虑在内，美国从第五位跌至第八位。</p><p id="2cff" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">后 5 个国家依次是:</p><blockquote class="ms"><p id="562d" class="mt mu it bd mv mw mx my mz na nb mm dk translated">乌克兰、俄罗斯、尼日利亚、印度和南非。</p></blockquote><p id="f640" class="pw-post-body-paragraph lr ls it lt b lu nc ju lw lx nd jx lz ma ne mc md me nf mg mh mi ng mk ml mm im bi translated">哇，对不起我的南非朋友。如果要我猜为什么会有艾滋病毒/肺结核的发病率。也许近年来情况有所改善，因为这些数据是几年前的了。不过对巴基斯坦来说是个好消息，当肥胖数据被加入时，它现在在 39 个国家中排名第 34。俄罗斯取代了它的位置。</p><p id="d4bc" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我得说这些结果与预期相当吻合，尽管我没想到南非会如此糟糕。我认为，这里的一个关键要点是，人口非常贫困的国家(印度和南非)被这些不平等现象压得不成比例。这些国家的某些地方肯定比我们排名前十的国家更现代(或者更现代)。然而，总的来说，排名前 10 位的国家拥有公共服务/基础设施/医疗保健的基线水平，而排名后 10 位的国家却没有。</p><h1 id="9475" class="kz la it bd lb lc ld le lf lg lh li lj jz lk ka ll kc lm kd ln kf lo kg lp lq bi translated">可视化这些结果的最佳方式是什么？</h1><p id="bec3" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">我的第一个想法是使用类似平行坐标图的东西。但是有 39 个国家，情况会很糟糕。</p><pre class="kj kk kl km gt oh oi oj ok aw ol bi"><span id="86b4" class="nv la it oi b gy om on l oo op"><em class="or">#useful function when converting from matrix to dfs</em><br/>df_ranked <strong class="oi iu">&lt;-</strong> rownames_to_column(df_ranked)<br/><br/>df_ranked <strong class="oi iu">%&gt;%</strong><br/>  gather(<strong class="oi iu">-</strong>rowname, key<strong class="oi iu">=</strong>'vars', value<strong class="oi iu">=</strong>'scores')<strong class="oi iu">%&gt;%</strong><br/>  ggplot(aes(vars, scores, group<strong class="oi iu">=</strong>rowname, color<strong class="oi iu">=</strong>rowname))<strong class="oi iu">+</strong><br/>  geom_path(size<strong class="oi iu">=</strong>1, alpha<strong class="oi iu">=</strong>.3)<strong class="oi iu">+</strong><br/>  theme_minimal() <strong class="oi iu">+</strong> theme(axis.text.x <strong class="oi iu">=</strong> element_text(size <strong class="oi iu">=</strong> 13, <br/>    angle <strong class="oi iu">=</strong> 35), legend.key <strong class="oi iu">=</strong> element_rect(fill <strong class="oi iu">=</strong> <strong class="oi iu">NA</strong>)) <strong class="oi iu">+</strong>labs(title <strong class="oi iu">=</strong> "Parallel Coordinates of Rankings", <br/>    x <strong class="oi iu">=</strong> "Variables", y <strong class="oi iu">=</strong> "Ranks")</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi os"><img src="../Images/b00ce34b5f0b81e301a9626be5d0a926.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/0*6pf3n_Odmw3ogX4Q.png"/></div></figure><p id="4204" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">是的，正如我所怀疑的，这是 39 个国家的混乱。但是您仍然可以看到一些有用的关系(由变量之间连接线的深度表示)。例如，你可以看到在肥胖方面得分较高的国家往往也有较高的艾滋病毒/结核病发病率。水卫生条件差的国家似乎有更好的空气质量。这不是我想做的权衡，但仍然是一个有趣的观察。</p><p id="a836" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">我的另一个想法是根据变量类型和颜色进行分面，并寻找条形图最小的国家(表示排名低=好)。我觉得这样更好。</p><p id="158e" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">不要介意庞大的代码块。但基本上，为了做到这一点，你必须将数据重塑为“长”形式，这样你就可以按变量分面。如果你还没有掌握这种技术，那么花时间去做是非常值得的。使用 tidyverse 库中的 gather()函数。</p><pre class="kj kk kl km gt oh oi oj ok aw ol bi"><span id="06de" class="nv la it oi b gy om on l oo op">df_ranked <strong class="oi iu">%&gt;%</strong><br/>  gather(<strong class="oi iu">-</strong>rowname, key<strong class="oi iu">=</strong>'vars', value<strong class="oi iu">=</strong>'scores')<strong class="oi iu">%&gt;%</strong><br/>  ggplot(aes(reorder(rowname, scores), scores, fill<strong class="oi iu">=</strong>scores))<strong class="oi iu">+</strong><br/>  geom_col()<strong class="oi iu">+</strong><br/>  scale_fill_gradient(low <strong class="oi iu">=</strong> "#0000F7",high<strong class="oi iu">=</strong>"#FFDD00")<strong class="oi iu">+</strong><br/>  facet_wrap(<strong class="oi iu">~</strong> vars, ncol<strong class="oi iu">=</strong> 11)<strong class="oi iu">+</strong><br/>  coord_flip() <strong class="oi iu">+</strong> theme(plot.subtitle <strong class="oi iu">=</strong> element_text(colour <strong class="oi iu">=</strong> <strong class="oi iu">NA</strong>, <br/>    vjust <strong class="oi iu">=</strong> 1), plot.caption <strong class="oi iu">=</strong> element_text(vjust <strong class="oi iu">=</strong> 1), <br/>    axis.ticks <strong class="oi iu">=</strong> element_line(colour <strong class="oi iu">=</strong> <strong class="oi iu">NA</strong>), <br/>    panel.grid.major <strong class="oi iu">=</strong> element_line(colour <strong class="oi iu">=</strong> <strong class="oi iu">NA</strong>), <br/>    panel.grid.minor <strong class="oi iu">=</strong> element_line(colour <strong class="oi iu">=</strong> <strong class="oi iu">NA</strong>), <br/>    axis.title <strong class="oi iu">=</strong> element_text(family <strong class="oi iu">=</strong> "serif", <br/>        colour <strong class="oi iu">=</strong> <strong class="oi iu">NA</strong>), axis.text <strong class="oi iu">=</strong> element_text(colour <strong class="oi iu">=</strong> "gray4"), <br/>    axis.text.x <strong class="oi iu">=</strong> element_text(size <strong class="oi iu">=</strong> 8), <br/>    axis.text.y <strong class="oi iu">=</strong> element_text(size <strong class="oi iu">=</strong> 7), <br/>    plot.title <strong class="oi iu">=</strong> element_text(hjust <strong class="oi iu">=</strong> 0.5), <br/>    panel.background <strong class="oi iu">=</strong> element_rect(fill <strong class="oi iu">=</strong> <strong class="oi iu">NA</strong>), <br/>    legend.key <strong class="oi iu">=</strong> element_rect(fill <strong class="oi iu">=</strong> <strong class="oi iu">NA</strong>)) <strong class="oi iu">+</strong>labs(title <strong class="oi iu">=</strong> "Ranking for each Health Dimension",<br/>    x <strong class="oi iu">=</strong> "Country", y <strong class="oi iu">=</strong> "Ranks", fill <strong class="oi iu">=</strong> "Ranking") <strong class="oi iu">+</strong> theme(axis.title <strong class="oi iu">=</strong> element_text(size <strong class="oi iu">=</strong> 8), <br/>    axis.text <strong class="oi iu">=</strong> element_text(size <strong class="oi iu">=</strong> 5, colour <strong class="oi iu">=</strong> "gray14", <br/>        vjust <strong class="oi iu">=</strong> 0), plot.title <strong class="oi iu">=</strong> element_text(size <strong class="oi iu">=</strong> 8)) <strong class="oi iu">+</strong> theme(axis.title <strong class="oi iu">=</strong> element_text(size <strong class="oi iu">=</strong> 7), <br/>    axis.text <strong class="oi iu">=</strong> element_text(size <strong class="oi iu">=</strong> 1), plot.title <strong class="oi iu">=</strong> element_text(size <strong class="oi iu">=</strong> 13))</span></pre><figure class="kj kk kl km gt kn gh gi paragraph-image"><div class="gh gi os"><img src="../Images/da656c68185a2fd1dad2d94342862388.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/0*SFGHgtYaVlW41txz.png"/></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Small purple bars mean lower (better) rank. SGP (Singapore) is #1 and ZAF (South Africa) is #39</figcaption></figure><h2 id="d9d0" class="nv la it bd lb nw nx dn lf ny nz dp lj ma oa ob ll me oc od ln mi oe of lp og bi translated">结果摘要</h2><p id="6402" class="pw-post-body-paragraph lr ls it lt b lu lv ju lw lx ly jx lz ma mb mc md me mf mg mh mi mj mk ml mm im bi translated">所以我们开始吧。我们可以看到，南非在水资源、公共服务、人类发展、艾滋病和结核病方面表现不佳，这导致了它排名垫底。</p><p id="7848" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">与此同时，除了肺结核，新加坡几乎在所有领域都名列前茅。这些排名掩盖了一个事实，即从绝对数字来看，新加坡每 10 万人的病例数约为 50-60 例，而美国为 2.9 例。不是巨大的绝对差异，而是巨大的相对差异。</p><p id="5aba" class="pw-post-body-paragraph lr ls it lt b lu mn ju lw lx mo jx lz ma mp mc md me mq mg mh mi mr mk ml mm im bi translated">如果欧洲大多数国家的酒精和烟草消费水平低一些，它们显然会名列前茅。对于德国人，我要说的是，要怪就怪那些该死的 Hefeweizen 和柏林那些在地铁上抽烟的潮人。<em class="or">einoverstanden</em>？</p></div></div>    
</body>
</html>