<html>
<head>
<title>Core Machine Learning For iOS Developers</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">面向 iOS 开发者的核心机器学习</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/core-machine-learning-for-ios-developers-7f2a4b19ec08?source=collection_archive---------0-----------------------#2017-06-11">https://towardsdatascience.com/core-machine-learning-for-ios-developers-7f2a4b19ec08?source=collection_archive---------0-----------------------#2017-06-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/78c17d8ad72e78dfa8632fbdb6e641ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:552/format:webp/1*YRwYfEoVznB9vf-vLzH7Zg.png"/></div></figure><p id="4493" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在 WWDC 2017 上，苹果为开发者推出了一种简单的方法，用<strong class="jw ir"> </strong> <a class="ae ks" href="https://developer.apple.com/documentation/coreml" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir"> Core ML </strong> </a>为他们的 iOS 应用添加 AI 功能。这可以用于各种领域，如对象检测、情感分析、手写识别、音乐标记等。所有这些都可以集成到一个名为<strong class="jw ir"> Core ML Model </strong>的文件和几行代码中。😏</p><p id="f9f4" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">什么是核心 ML 模型⁉ </strong></p><p id="75d2" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">它是将训练好的模型转换成 Apple 格式的模型文件(。mlmodel)，它可以添加到您的项目中。</p><p id="1d9c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">什么是训练有素的模特‼︎⁉︎ </strong></p><p id="4dc5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">它是由机器的训练过程产生的产物。训练模型的过程包括向<em class="kt">学习算法</em>提供<em class="kt">训练数据</em>以供学习。</p><p id="26c5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">因此，由于核心 ML 模型是关键，我选择使用苹果公司提供的模型，而不是自己转换一个经过训练的模型。目前有 4 个选项可用:<em class="kt"> Places205-GoogLeNet，ResNet50，Inception v3，VGG16。</em></p></div><div class="ab cl ku kv hu kw" role="separator"><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz la"/><span class="kx bw bk ky kz"/></div><div class="ij ik il im in"><h1 id="db6c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">演示时间</h1><p id="3312" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">要运行演示应用程序或使用 CoreML，你需要获得<a class="ae ks" href="https://developer.apple.com/download/" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir"> Xcode9 </strong> </a>测试版(振作起来，这是真正的测试版😖).</p><blockquote class="me"><p id="1e94" class="mf mg iq bd mh mi mj mk ml mm mn kr dk translated">该应用程序将允许用户从照片库中选择一张照片，然后智能模型将推断出主要对象。</p></blockquote><p id="949c" class="pw-post-body-paragraph ju jv iq jw b jx mo jz ka kb mp kd ke kf mq kh ki kj mr kl km kn ms kp kq kr ij bi translated">打开 Xcode 并创建一个新的单个应用程序视图项目。转到你的 Main.storyboard 并为应用程序设置你想要的 UI。我选择了一个简单的 UI，一个按钮打开图库，一个图像视图显示选中的图像，一个文本视图显示预测结果。</p><figure class="mu mv mw mx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="gh gi mt"><img src="../Images/53723fb050e725a8f368203e68c5a52d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yKW8QMGFMRE7hQ6PD0Vkjg.png"/></div></div></figure><p id="7691" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">然后将按钮、图像视图和文本视图挂接到视图控制器。设置一个<em class="kt">UIImagePickerController a</em>after wards，<em class="kt"> </em>及其委托方法<em class="kt">diddfinishpickingmediwithinfo</em>并从信息字典<em class="kt">中检索图像。</em></p><figure class="mu mv mw mx gt jr"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="7967" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">此时，您的项目应该可以运行了。您可以选择一个图像并在图像视图中查看它。<em class="kt">提示:你可以在模拟器上打开 safari 并保存一些图像，在你的图库中创建一些变化。</em></p><h1 id="d835" class="lb lc iq bd ld le ne lg lh li nf lk ll lm ng lo lp lq nh ls lt lu ni lw lx ly bi translated">添加核心 ML</h1><p id="1863" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">现在到了激动人心的部分:让我们从<a class="ae ks" href="https://developer.apple.com/machine-learning/" rel="noopener ugc nofollow" target="_blank"> <strong class="jw ir">苹果</strong> </a>下载实际的模型文件。我选择了<a class="ae ks" href="https://docs-assets.developer.apple.com/coreml/models/Inceptionv3.mlmodel" rel="noopener ugc nofollow" target="_blank"><strong class="jw ir">Inceptionv3</strong></a><strong class="jw ir"/>型号<strong class="jw ir"> </strong>因为它功能强大并且文件大小合理。</p><figure class="mu mv mw mx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="gh gi nj"><img src="../Images/5a2209d2ffdd532845ed07e9484f3331.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7i2dWaMzC0r2htvss1T99Q.png"/></div></div></figure><p id="a498" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">一旦你得到了。mlmodel 文件，将其拖放到您的项目中。确保将其添加到您的<strong class="jw ir">应用目标</strong>(如果您有测试目标，不要将其添加到测试目标，因为这不会生成模型类)。然后从项目导航器中选择文件。</p><figure class="mu mv mw mx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="gh gi nk"><img src="../Images/b205549cf2c2c5b65ff73bbd98bb7ba0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IPVts7JNKFR9PEaoskcVoQ.png"/></div></div></figure><p id="2e12" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">你可以看到一些与模型相关的元数据。但最重要的是，您可以看到自动生成的<strong class="jw ir">模型类</strong>，它将在我们的代码中使用。我们还知道该模型将一个图像作为输入，将一个字典和字符串作为输出。</p><h1 id="2f30" class="lb lc iq bd ld le ne lg lh li nf lk ll lm ng lo lp lq nh ls lt lu ni lw lx ly bi translated">CoreML &amp; Vision</h1><p id="d64d" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">为了在我们的代码中使用智能，我们必须导入 CoreML 和 Vision。CoreML 被导入，所以我们可以在我们的视图控制器中使用自动生成的<strong class="jw ir">模型类</strong>。由于图像输入属于<em class="kt"> CVPixelBuffer </em>类型，<strong class="jw ir"> Vision </strong>将通过给它一个用作输入的<em class="kt"> CGImage </em>来使我们的生活变得更容易。</p><figure class="mu mv mw mx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="gh gi nl"><img src="../Images/242657586a383a93867692c6f27ed3d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rwAtODagQ6Y3LF_8qkThQA.png"/></div></div><figcaption class="nm nn gj gh gi no np bd b be z dk">Data types used to interact with the mlmodel</figcaption></figure><p id="1e24" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">值得注意的是，视觉与将图像作为输入的模型相关。例如，如果我们的模型采用字数统计，那么就应该使用 NLP (NSLinguisticTagger)来代替。</p><figure class="mu mv mw mx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="my mz di na bf nb"><div class="gh gi nq"><img src="../Images/de46b77acb7f5b43ba4a2fc044472743.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IaUqRcvXbK3FqWCLP4FMfw.png"/></div></div><figcaption class="nm nn gj gh gi no np bd b be z dk">Vision and NLP are build on top of Core ML</figcaption></figure><h1 id="4f35" class="lb lc iq bd ld le ne lg lh li nf lk ll lm ng lo lp lq nh ls lt lu ni lw lx ly bi translated">履行</h1><p id="a00f" class="pw-post-body-paragraph ju jv iq jw b jx lz jz ka kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr ij bi translated">现在回到我们的视图控制器。从导入 CoreML 和 Vision 开始。创建一个新函数，姑且称之为<em class="kt"> processImage()。</em>请注意，该实现特定于 Vision，如果您使用另一个将 String 或 Double 作为输入的模型，您就不必以这种方式使用它。</p><figure class="mu mv mw mx gt jr"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="30c0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">为了提交输入，我们首先使用我们的<em class="kt"> Inceptionv3 </em>模型初始化一个<em class="kt"> VNCoreMLModel </em>。然后创建一个<em class="kt"> VNCoreMLRequest。</em>最后<em class="kt"> </em>设置<em class="kt">一个 VNImageRequestHandler </em>并以请求为参数<em class="kt">调用 perform。</em></p><p id="03b5" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">为了检索输出，我们必须使用<em class="kt"> VNCoreMLRequest </em>闭包，它有一个包含<em class="kt">结果</em>属性[<em class="kt">VNClassificationObservation</em>]的<em class="kt">请求</em>对象。就是这样，这是输出。⭐️✨</p><p id="12cf" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在将<em class="kt"> processImage() </em>添加到<em class="kt">imagePickerViewController</em>的委托方法中，并更新文本视图。下面是 90 行代码下的视图控制器的完整代码:</p><figure class="mu mv mw mx gt jr"><div class="bz fp l di"><div class="nc nd l"/></div></figure><p id="d76f" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">让我们运行应用程序，看看预测结果是什么样的。😍</p><figure class="mu mv mw mx gt jr gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/51526d1794173da6150912809c702a26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*ayn8U_bRNY5O6S-U4b9wYA.png"/></div><figcaption class="nm nn gj gh gi no np bd b be z dk">iOS Simulator screenshot</figcaption></figure><p id="4489" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我期待你的反馈🤓</p><p id="4a42" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">🤖<a class="ae ks" href="https://github.com/ayoubkhayatti/GuessImageCoreML" rel="noopener ugc nofollow" target="_blank">在此下载完整项目</a>🤖</p></div></div>    
</body>
</html>