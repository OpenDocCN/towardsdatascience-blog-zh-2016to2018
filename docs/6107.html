<html>
<head>
<title>How To Teach A Computer To See With Convolutional Neural Networks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用卷积神经网络教计算机看东西</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-teach-a-computer-to-see-with-convolutional-neural-networks-96c120827cd1?source=collection_archive---------11-----------------------#2018-11-26">https://towardsdatascience.com/how-to-teach-a-computer-to-see-with-convolutional-neural-networks-96c120827cd1?source=collection_archive---------11-----------------------#2018-11-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="06b4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在过去的几年里，计算机视觉领域取得了巨大的进步。卷积神经网络极大地提高了图像识别模型的准确性，并在现实世界中有大量的应用。在本文中，我将介绍它们是如何工作的，一些真实世界的应用程序，以及如何用 Python 和 Keras 编写一个应用程序。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/936c8b8a54952df0d2da63782b41b6fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_xlTgqA041E6wnaAe17ewA.jpeg"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Photo by <a class="ae lc" href="https://unsplash.com/photos/UbJMy92p8wk?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Amanda Dalbjörn</a> on <a class="ae lc" href="https://unsplash.com/search/photos/eyes?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="bd7c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对我们大多数人来说，看是我们日常生活的一部分。我们用眼睛来寻找我们周围世界的道路。我们用它们来交流和理解。大概不用我说，视力超级重要。这是我们一天中如此重要的一部分。我是说，你能想象，看不见吗？</p><p id="d5b3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是如果我让你解释视觉是如何工作的呢？我们如何理解眼睛解读的东西？嗯，首先你看一些东西，然后…什么？大脑就像一台经过数百万年自然发展的超级复杂的计算机。<strong class="jp ir">我们已经非常擅长识别各种模式和物体。</strong></p><p id="80b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">许多技术都是基于自然机制。</strong>以相机为例。快门控制光量，类似于我们的瞳孔。相机和眼睛中的镜头聚焦并反转图像。相机和眼睛都有某种方式来感知光线，并将其转换为可以理解的信号。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ld"><img src="../Images/5420f58994a51f277cdc6c7e4d08acf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hat5Twe0JRJ5Ko-DOzlZCA.jpeg"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Photo by <a class="ae lc" href="https://unsplash.com/photos/xVg65Jh4CI4?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Alfonso Reyes</a> on <a class="ae lc" href="https://unsplash.com/search/photos/camera?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="6c66" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但显然，我们不只是用胳膊和腿移动摄像机。我们目前拥有的相机显然不能完全理解他们在拍什么。如果他们这样做了，那就有点可怕了。对照相机和电脑来说，一张照片只是一串排列的数字。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi le"><img src="../Images/f1e6605e74789f18626378fc84bdc080.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cLsTCWtUL1GYBUv8vnbOxw.jpeg"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Digit 8 from <a class="ae lc" href="http://yann.lecun.com/exdb/mnist/" rel="noopener ugc nofollow" target="_blank">MNIST</a> dataset represented as an array. <a class="ae lc" href="https://cdn-images-1.medium.com/max/1600/1*av47vApmzuM0AN21VaIcSA.png" rel="noopener">Source.</a></figcaption></figure><p id="32d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那么，我们究竟怎样才能创造出能够告诉我们狗是狗还是猫的程序呢？这是我们试图用<strong class="jp ir">计算机视觉</strong>解决的问题。</p><p id="f10a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就是神经网络如何帮助我们的！</p><h1 id="51be" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">神经网络如何工作</h1><p id="1881" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">人工神经网络(ANN)是基于人脑的松散程序。<strong class="jp ir">神经网络由许多相连的神经元组成。</strong>这些神经网络中的一些可以有数百万个节点和数十亿个连接！</p><p id="458b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">神经元基本上是一种接受输入并返回输出的功能。</strong></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/473c35e031cc032752953ce20420c102.png" data-original-src="https://miro.medium.com/v2/resize:fit:1204/0*vMljzpEnKda9TrMK"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Artificial neurons are modeled off biological neurons. <a class="ae lc" href="https://www.quora.com/What-is-the-differences-between-artificial-neural-network-computer-science-and-biological-neural-network" rel="noopener ugc nofollow" target="_blank">Source.</a></figcaption></figure><p id="7c01" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一个神经元本身做不了多少事。但是当你有大量的神经元连接在一起时，乐趣就开始了。不同层次/结构的神经网络让你做很多很酷的事情。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="ab gu cl mj"><img src="../Images/55b1348ca7cbc0b38904d3794bc30739.png" data-original-src="https://miro.medium.com/v2/format:webp/1*Pn42wNB6_HBKgpvxRzGBWw.png"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">You can get something like this!</figcaption></figure><p id="032f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">每个神经元通常与某种权重相关联。基本上，当一个连接比另一个更重要时。假设我们有一个网络想告诉你图片是不是一个<a class="ae lc" href="https://medium.com/@timanglade/how-hbos-silicon-valley-built-not-hotdog-with-mobile-tensorflow-keras-react-native-ef03260747f3" rel="noopener">热狗</a>。那么我们会希望包含热狗特征的神经元比普通狗的特征更重要。</p><p id="4818" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">神经网络的权重是通过对数据集进行训练来学习的。它将运行许多次，通过关于损失函数的反向传播来改变它的权重。神经网络基本上通过测试数据，做出预测，然后看到它有多错。然后它得到这个分数，让自己变得稍微准确一点。通过这个过程，神经网络可以学习提高其预测的准确性。</p><p id="501b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我不会在这篇文章中讨论反向传播或损失函数，但是有很多很棒的资源，比如<a class="ae lc" href="https://medium.com/datathings/neural-networks-and-backpropagation-explained-in-a-simple-way-f540a3611f5e" rel="noopener"> this </a>涵盖了这些主题！</p><p id="ca85" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">卷积神经网络(CNN)是一种特殊的神经网络。当应用于图像数据集时，它们表现得非常好。</strong></p><h1 id="a701" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">卷积神经网络</h1><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi mk"><img src="../Images/542c25e349f653a19dda6709868e7709.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-1Pad7loK_dFOUvS.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">A diagram of Convolutional Neural Networks. <a class="ae lc" href="https://www.mdpi.com/entropy/entropy-19-00242/article_deploy/html/images/entropy-19-00242-g001.png" rel="noopener ugc nofollow" target="_blank">Source.</a></figcaption></figure><p id="6ba3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如我之前提到的，计算机将图片视为一组数组中的数字。CNN 的不同层将函数应用于这些阵列，以从图像中提取各种特征，并降低图像的复杂性。</p><p id="5b5b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们来看看在热狗检测器上训练 CNN 的一些步骤。</p><p id="cdcb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我们用随机权重初始化 CNN。这基本上意味着网络完全是在猜测。一旦它做出预测，它将检查使用损失函数的错误程度，然后更新其权重，以便下次做出更好的预测。</p><p id="1827" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">CNN 包含称为卷积层和池层的层。你可以这样想象卷积层会发生什么。</strong></p><p id="032d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">假设你有一张照片和一个放大镜。把你的放大镜放在图片的左上角，寻找一个特定的特征。记下它是否在那里。慢慢地在图像中移动，重复这个过程。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="ab gu cl mj"><img src="../Images/2db85f806718724069de7d5fccdf1ce9.png" data-original-src="https://miro.medium.com/v2/0*1PSMTM8Brk0hsJuF."/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Visualizing feature extraction in a convolutional layer. <a class="ae lc" href="https://github.com/vdumoulin/conv_arithmetic" rel="noopener ugc nofollow" target="_blank">Source.</a></figcaption></figure><p id="98ab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">卷积层创建一堆特征图。</strong></p><p id="5fbf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于一个用来描述不同图像如动物或面孔的 CNN 来说。第一卷积层寻找的特征可以是对象的不同边缘。这就像是把图片中不同的边列了一个清单。这个列表然后被传递到另一个卷积层，它做类似的事情，除了它在图像中寻找更大的形状。这可能是动物的一条腿，也可能是脸上的一只眼睛。最终，这些特征被一个全连接的层所接受，该层对图像进行分类。</p><p id="53ab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">汇集层也用于卷积层。这需要另一个放大镜，但它不会寻找特征。而是取一个区域的最大值来降低图像的复杂度。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/771486c683c4bae04aeeee2f3fe826d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:624/0*l5tVXuDM8aak-qKh.gif"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Pooling in a CNN. <a class="ae lc" href="https://shafeentejani.github.io/assets/images/pooling.gif" rel="noopener ugc nofollow" target="_blank">Source.</a></figcaption></figure><p id="130e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这很有用，因为大多数图像都很大。它们有大量的像素，这使得处理器很难处理它们。共享让我们在保留大部分重要信息的同时缩小图像的尺寸。池化还用于防止过度拟合，即当模型变得过于擅长识别我们对其进行训练的数据，而对我们给出的其他示例不太适用时。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/5ff7f4d02763dd6eed330a65a1c12868.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/0*VZcx0bGmaljy1l_z.png"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">An example of overfitting on a linear dataset. <a class="ae lc" href="http://By Ghiles - Own work, CC BY-SA 4.0, https://commons.wikimedia.org/w/index.php?curid=47471056" rel="noopener ugc nofollow" target="_blank">Source.</a></figcaption></figure><p id="687e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如图所示，该图中的数据可以用一条直线来表示。蓝色的模型显然击中了所有的数据点，但如果我们试图让它预测其他东西，它将无法做到。就我们的 CNN 而言，这可能意味着它将对我们训练它的图像超级准确，但无法在其他图像上给我们正确的预测。</p><p id="f8dc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，我们把 CNN 的结构扁平化成一个超长的特写。我们基本上只是把所有的数据放在一起，这样我们就可以把它传递给一个完全连接的层来进行预测。</p><h2 id="886d" class="mn lg iq bd lh mo mp dn ll mq mr dp lp jy ms mt lt kc mu mv lx kg mw mx mb my bi translated">为什么神经网络更好？</h2><p id="41e9" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">假设我们没有使用神经网络。我们将如何处理这个问题？假设我们正在尝试编写一个识别猫的程序。我们可以通过寻找特定的形状来表现猫。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi mz"><img src="../Images/664b78f74c3e6e91fc11441fec1f897d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MuE0LFNMWx4PfqzLVQXibA.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Cat shapes from Computer Vision Expert Fei-Fei Li’s TED Talk.</figcaption></figure><p id="c147" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">看起来很简单，对吧？但是等一下。不是所有的猫都长这样。如果你有一只伸展开的猫呢？我们需要添加更多的形状。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi mz"><img src="../Images/182fd7d29164b0a37ee422359a2f35fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vzlQorusPcIS8fVB4X_Feg.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">More cat shapes from Computer Vision Expert Fei-Fei Li’s TED Talk.</figcaption></figure><p id="642e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">至此，应该很清楚告诉计算机寻找某些形状是行不通的。猫有各种形状和大小。这是假设我们只在找猫。如果我们想要一个可以对各种图片进行分类的程序呢？</p><p id="8660" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就是为什么使用神经网络要好得多。你可以让电脑设定自己的规则。<strong class="jp ir">通过使用高度先进的算法，神经网络可以以极高的准确度对图像进行分类。</strong>一些模型已经在这项任务中击败了人类！</p><h1 id="d0e7" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">我们应用计算机视觉的一些很酷的方式</h1><p id="1189" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">随着算法变得更高效，硬件变得更强大，我们可能能够用更接近科幻小说领域的神经网络来完成任务。但这并不意味着我们现在没有用这项技术做很多很酷的事情！</p><h2 id="7848" class="mn lg iq bd lh mo mp dn ll mq mr dp lp jy ms mt lt kc mu mv lx kg mw mx mb my bi translated">零售</h2><p id="a190" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">你可能在新闻里听说过。<a class="ae lc" href="https://www.amazon.com/b?ie=UTF8&amp;node=16008589011" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir">亚马逊 Go </strong> </a>，电商巨头的无收银员杂货店。你走进去，拿起一些东西，然后走出来。系统会自动向你收取费用。<strong class="jp ir">覆盖在天花板上的摄像头会记录下你拿起的物品。</strong>虽然该系统并不完善，而且可能容易受到入店行窃的影响。看到这个想法在未来几年内如何发展将会非常有趣。</p><h2 id="8ec4" class="mn lg iq bd lh mo mp dn ll mq mr dp lp jy ms mt lt kc mu mv lx kg mw mx mb my bi translated">自动驾驶汽车</h2><p id="d7a9" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">在我看来，自动驾驶汽车是目前正在开发的最酷的东西之一。<a class="ae lc" href="https://waymo.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> Waymo </strong> </a> <strong class="jp ir">，</strong>最初是谷歌的自动驾驶汽车项目，<strong class="jp ir">优步和特斯拉是一些公司目前正在开发可以自行导航道路的车辆。</strong></p><p id="3e84" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Waymo 的自动驾驶汽车车队已经行驶了超过 1000 万英里的道路！平均每年旅行约 12000 英里。总共有 800 多年的驾驶经验！</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi mk"><img src="../Images/c811724aa26ec6ce62d395c10ebba464.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*uLy0Wa6vvoVKL71-"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">One of Waymo’s self-driving cars. <a class="ae lc" href="https://waymo.com/ontheroad/" rel="noopener ugc nofollow" target="_blank">Source.</a></figcaption></figure><h2 id="13ec" class="mn lg iq bd lh mo mp dn ll mq mr dp lp jy ms mt lt kc mu mv lx kg mw mx mb my bi translated">卫生保健</h2><p id="9fd4" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">在医疗保健中，CNN 被用于识别许多不同种类的疾病。<strong class="jp ir">通过对癌症或其他医疗状况的某些数据集进行训练，神经网络可以以很高的准确率找出是否有问题！通过让神经网络提取特征并在数据中找到模式，它可以利用我们从未想到过的图片信息！</strong></p><p id="515f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">微软正在开发其<a class="ae lc" href="https://www.microsoft.com/en-us/research/project/medical-image-analysis/" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">InnerEye</strong></a><strong class="jp ir"/>项目，该项目帮助临床医生使用深度学习和 CNN 分析 3D 放射图像。这有助于医疗从业者提取定量测量值，并有效地计划手术。</p><h1 id="5c9b" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">用 Keras 创建卷积神经网络</h1><p id="f2eb" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">既然我们理解了 CNN 应该如何工作背后的一些直觉。我们可以用 Python 编写的高级 API<strong class="jp ir">Keras</strong>在<strong class="jp ir"> Python </strong>中创建一个。Keras 将帮助我们编写易于理解和超级可读的代码。</p><p id="a469" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以从安装<a class="ae lc" href="https://www.anaconda.com/download/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> Anaconda </strong> </a>开始，在命令界面运行<code class="fe na nb nc nd b">conda install keras</code>。然后你可以使用<strong class="jp ir"> Jupyter 笔记本</strong>开始用 Python 编程。如果你想在云端运行一切，你也可以使用谷歌的合作实验室。</p><p id="e422" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将使用属于 Keras 库的<strong class="jp ir"> MNIST 数据集</strong>。包含<em class="kl"> 6 万个训练样本和 1 万个手写数字测试样本。</em>我们开始吧！</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/725ef521a9539717cf3c1ad7029820a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/1*s4ep5fF5RuuIAcH2tq-7gA.png"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">The first few training examples in the MNIST dataset.</figcaption></figure><p id="7b3e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我们要从 Keras 库中导入我们需要的所有东西。这包括顺序模型，这意味着我们可以通过添加层来轻松构建模型。接下来我们将导入 Conv2D (Convolution2D)，MaxPooling2D，Flatten 和 Dense 层。前 3 个是不言自明的，密集层帮助我们建立完全连接的层。</p><p id="464c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将需要<strong class="jp ir"> Keras Utils </strong>来帮助我们<strong class="jp ir">编码数据</strong>以确保它与我们模型的其余部分兼容。这使得数字 9 不会被视为比 1 更好。最后，我们将导入用于训练模型的 MNIST 数据集。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="e855" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">导入数据集后，我们需要将它分成训练数据和测试数据。训练数据就是我们要教给神经网络的东西。测试数据是我们用来衡量准确性的。我们将<em class="kl">重塑</em>数据，以匹配<strong class="jp ir"> TensorFlow 后端所需的格式。接下来我们将<em class="kl">归一化</em>数据，以保持数值范围在 0 到 1 之间。并且<em class="kl">对</em>MNIST 标签进行分类编码。</strong></p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="294d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">太好了！现在我们可以开始构建我们的模型了。我们将从创建一个序列模型开始，这是一个<em class="kl">层的线性堆栈</em>。正如你在下面的代码中看到的，这使得我们向模型中添加更多的层变得非常容易。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="cced" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我们建立完模型后，我们将编译它。该模型使用<em class="kl"> Adam 优化器</em>，这是一种用于调整权重的梯度下降算法。我们的模型使用的损失函数是<em class="kl">分类交叉熵</em>，它告诉我们的模型我们离结果有多远。指标参数用于定义如何评估绩效。它类似于损失函数，但在实际训练过程中不会用到。</p><p id="a919" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将在训练台上调整或训练我们的模型。<em class="kl">批量大小</em>决定了我们在每次迭代中要考虑多少张图像。<em class="kl">历元的数量</em>决定了模型在整个集合中迭代的次数。在一定数量的时代之后，模型将基本上停止改进。</p><p id="7eba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">详细</em>值决定了模型是否会告诉我们模型的进度，而<em class="kl">验证数据</em>决定了模型如何在每个时期后评估其损失。</p><p id="cc0f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，我们将打印出我们的模型有多精确。最终结果应该在 98%到 99%之间</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="nf ng l"/></div></figure><p id="612d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可以在<a class="ae lc" href="https://github.com/uyxela/mnist-keras" rel="noopener ugc nofollow" target="_blank"> my GitHub </a>上找到完整的代码，或者你可以在<a class="ae lc" href="https://colab.research.google.com/drive/1oSE2zRroFcjZkBrrWv-p0tnWR7_yOYrH" rel="noopener ugc nofollow" target="_blank"> Google Colaboratory </a>上运行它。</p><h1 id="df47" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">关键要点</h1><ul class=""><li id="d104" class="nh ni iq jp b jq md ju me jy nj kc nk kg nl kk nm nn no np bi translated">神经网络松散地基于我们大脑解释信息的方式。</li><li id="adfa" class="nh ni iq jp b jq nq ju nr jy ns kc nt kg nu kk nm nn no np bi translated">卷积神经网络特别适合处理图像。</li><li id="2d1c" class="nh ni iq jp b jq nq ju nr jy ns kc nt kg nu kk nm nn no np bi translated">计算机视觉在现实世界中有很多应用。</li></ul></div><div class="ab cl nv nw hu nx" role="separator"><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa ob"/><span class="ny bw bk nz oa"/></div><div class="ij ik il im in"><p id="922a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢阅读！如果您喜欢，请:</p><ul class=""><li id="a477" class="nh ni iq jp b jq jr ju jv jy oc kc od kg oe kk nm nn no np bi translated">在 LinkedIn<a class="ae lc" href="https://www.linkedin.com/in/alexjy/" rel="noopener ugc nofollow" target="_blank">上添加我</a>并关注我的媒体，了解我的旅程</li><li id="8eeb" class="nh ni iq jp b jq nq ju nr jy ns kc nt kg nu kk nm nn no np bi translated">留下一些反馈或给我发电子邮件(alexjy@yahoo.com)</li><li id="b79b" class="nh ni iq jp b jq nq ju nr jy ns kc nt kg nu kk nm nn no np bi translated">与你的网络分享这篇文章</li></ul></div></div>    
</body>
</html>