<html>
<head>
<title>Exploratory Analysis of FIFA 18 dataset using R</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">利用 R 对 FIFA 18 数据集的探索性分析</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/exploratory-analysis-of-fifa-18-dataset-using-r-ba09aa4a2d3c?source=collection_archive---------2-----------------------#2018-05-24">https://towardsdatascience.com/exploratory-analysis-of-fifa-18-dataset-using-r-ba09aa4a2d3c?source=collection_archive---------2-----------------------#2018-05-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/dd99354be6df3c6d353127e1cdf80b62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*7scAAov-4_VEAEAO.jpg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">[Image [1] (Image courtesy: <a class="ae kc" href="https://www.easports.com/fifa" rel="noopener ugc nofollow" target="_blank">https://www.easports.com/fifa</a>)]</figcaption></figure><p id="2429" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">随着 2018 年 FIFA 世界杯的临近，我结合了我对足球和数据科学的热爱，使用 r 对 FIFA 18 数据集进行了一次简短的探索性分析。我使用了非身体球员属性，如<code class="fe lb lc ld le b">Name, Age, Nationality, Overall, Club, Value, Wage, Preferred.Positions.</code></p><p id="f2ea" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我使用了在<a class="ae kc" href="https://www.kaggle.com/thec03u5/fifa-18-demo-player-dataset" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>上可用的数据集，其中包含 17，000 多名 FIFA18 中的球员，每个人都有超过 70 个属性。是从网站<a class="ae kc" href="https://sofifa.com/" rel="noopener ugc nofollow" target="_blank"> SoFiFa </a>上刮下来的。</p><p id="570d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你对数据可视化感兴趣，你可以看看我的另一篇文章<a class="ae kc" rel="noopener" target="_blank" href="/exploratory-analysis-of-pokemons-using-r-8600229346fb">gg plot ' Em All | Pokemon on R</a>。如果你对大数据感兴趣，可以看看我的文章<a class="ae kc" rel="noopener" target="_blank" href="/getting-started-with-hive-ad8a93862f1a">开始使用 Hive </a>。</p></div><div class="ab cl lf lg hu lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="ij ik il im in"><p id="eea8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在开始分析之前，让我们导入库并读入数据集。</p><pre class="lm ln lo lp gt lq le lr ls aw lt bi"><span id="41e4" class="lu lv iq le b gy lw lx l ly lz">library(ggplot2)<br/>library(dplyr)<br/>library(gridExtra)</span><span id="b41c" class="lu lv iq le b gy ma lx l ly lz">df = read.csv(file = "CompleteDataset.csv", stringsAsFactors = FALSE)</span><span id="27f3" class="lu lv iq le b gy ma lx l ly lz">df = tbl_df(df)</span><span id="9799" class="lu lv iq le b gy ma lx l ly lz">df &lt;- select(df, ID, X, Name, Age, Nationality, Overall, Club, Value, Wage, Preferred.Positions)<br/><br/>head(df, 10)</span></pre><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mb"><img src="../Images/bde3feb615d0b21dfb682e89ff4d8680.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Anm6-YMwg0THqPTRz2sCAw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">First 10 rows of the dataset [Image [2]]</figcaption></figure><p id="7518" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">读取数据后，我做的第一件事是将<code class="fe lb lc ld le b">Value</code>和<code class="fe lb lc ld le b">Wage</code>列转换为实际的货币值。我编写了一个函数，将一个向量作为输入，并从列中删除“€”符号，然后乘以适当的数字，将其转换为千(K)和百万(M)。</p><pre class="lm ln lo lp gt lq le lr ls aw lt bi"><span id="14c7" class="lu lv iq le b gy lw lx l ly lz">toNumberCurrency &lt;- function(vector) {<br/>    vector &lt;- as.character(vector)<br/>    vector &lt;- gsub("(€|,)","", vector)<br/>    result &lt;- as.numeric(vector)<br/>   <br/>    k_positions &lt;- grep("K", vector)<br/>    result[k_positions] &lt;- as.numeric(gsub("K","",        vector[k_positions])) * 1000<br/>  <br/>    m_positions &lt;- grep("M", vector)<br/>    result[m_positions] &lt;- as.numeric(gsub("M","", <br/>    vector[m_positions])) * 1000000<br/>    <br/>    return(result)<br/>}</span><span id="2d02" class="lu lv iq le b gy ma lx l ly lz">df$Wage &lt;- toNumberCurrency(df$Wage)<!-- --> <br/>df$Value &lt;- toNumberCurrency(df$Value)</span></pre><p id="ec5f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后，我从<code class="fe lb lc ld le b">Preferred.Positions</code>列的空格分隔值中选取第一个位置值。数据集中的不同位置是:<code class="fe lb lc ld le b">CAM CB CDM CF CM GK LB LM LW LWB RB RM RW RWB ST</code>。</p><pre class="lm ln lo lp gt lq le lr ls aw lt bi"><span id="122d" class="lu lv iq le b gy lw lx l ly lz">df$Preferred.Positions &lt;- gsub(" ", "", substr(df$Preferred.Positions, 1, 3))</span></pre><p id="f16d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">基于上面的<code class="fe lb lc ld le b">Preferred.Positions</code>，我创建了另一个专栏，将这些<code class="fe lb lc ld le b">Preferred.Positions</code>分类为更一般的职位，即<code class="fe lb lc ld le b">GK DEF MID FWD</code>。清理后的数据集如下所示:</p><pre class="lm ln lo lp gt lq le lr ls aw lt bi"><span id="25a7" class="lu lv iq le b gy lw lx l ly lz">x &lt;- as.factor(df$Preferred.Positions)</span><span id="5bdb" class="lu lv iq le b gy ma lx l ly lz">levels(x) &lt;- list(GK  = c("GK"), <br/>                  DEF = c("LWB", "LB", "CB", "RB", "RWB"), <br/>                  MID = c("LW","LM","CDM","CM","CAM","RM","RW"), <br/>                  FWD = c("CF", "ST"))</span><span id="3a04" class="lu lv iq le b gy ma lx l ly lz">df &lt;- mutate(df, Position = x)</span><span id="3e7e" class="lu lv iq le b gy ma lx l ly lz">head(df)</span></pre><p id="6a19" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">选择<code class="fe lb lc ld le b">Preferred.Position</code>栏中的第一个职位，并创建一个表格，将这些职位分类为更一般的职位，即<code class="fe lb lc ld le b">GK DEF MID FWD</code>。</p><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mb"><img src="../Images/0f4392a0874bd09eaa2dcc77c1dde8c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DfGg3LiNg82HixF2qtAaNA.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Cleaned data set [Image [3]]</figcaption></figure><p id="15b0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，球员的年龄分布。我们看到有很多 25 岁左右的球员。</p><pre class="lm ln lo lp gt lq le lr ls aw lt bi"><span id="3a9a" class="lu lv iq le b gy lw lx l ly lz">g_age &lt;- ggplot(data = df, aes(Age))</span><span id="e6f3" class="lu lv iq le b gy ma lx l ly lz">g_age + <br/>geom_histogram(col="orange", aes(fill = ..count..)) + ggtitle("Distribution based on Age")</span></pre><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/290cf574036b56f4d4bdd31f403cc043.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HqAVGsvbS0uauLD1DVH81w.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Distribution of players based on their age [Image [4]]</figcaption></figure><p id="cace" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面的图表显示了运动员的年龄和他们的一般比赛位置之间的关系。</p><pre class="lm ln lo lp gt lq le lr ls aw lt bi"><span id="b21e" class="lu lv iq le b gy lw lx l ly lz">g_age + <br/>geom_density(col="orange", aes(fill = Position), alpha=0.5) + facet_grid(.~Position) + <br/>ggtitle("Distribution based on Age and Position")</span></pre><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/264460b182161e72275800e06e78aafb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i4w8c4S1gf26Z1FtT_d0SQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Distribution based on Age and Position [Image [5]]</figcaption></figure><p id="49ea" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">根据玩家的总体评分来分配玩家。我们看到大多数玩家的总体评分在 65 分左右。</p><pre class="lm ln lo lp gt lq le lr ls aw lt bi"><span id="f525" class="lu lv iq le b gy lw lx l ly lz">g_overall &lt;- ggplot(data = df, aes(Overall))</span><span id="5694" class="lu lv iq le b gy ma lx l ly lz">g_overall + <br/>geom_histogram(col="orange", aes(fill = ..count..)) + ggtitle("Distribution based on Overall Rating")</span></pre><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/2538af7b2ecb8626e618c78ac31bc616.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T-evvVGwPfKzbXLqQ50eIQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk"><code class="fe lb lc ld le b">Distribution based on overall rating [Image [6]]</code></figcaption></figure><p id="852f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">来自不同(前 10 名)国家的玩家数量。</p><pre class="lm ln lo lp gt lq le lr ls aw lt bi"><span id="0865" class="lu lv iq le b gy lw lx l ly lz">countries_count &lt;- count(df, Nationality)</span><span id="6952" class="lu lv iq le b gy ma lx l ly lz">top_10_countries &lt;- top_n(countries_count, 10, n)</span><span id="47e9" class="lu lv iq le b gy ma lx l ly lz">top_10_country_names &lt;- top_10_countries$Nationality<br/><br/>country &lt;- filter(df, Nationality == top_10_country_names)</span><span id="1864" class="lu lv iq le b gy ma lx l ly lz">ggplot(country, aes(x = Nationality)) + <br/>geom_bar(col = "orange", aes(fill = ..count..)) + ggtitle("Distribution based on Nationality of Players (Top 10 Countries)")</span></pre><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/92605a672f3b6e732fedf2ee5cf8a2ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oH9rn21u4SnaQXLoFdyetw.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Number of players from different countries [Image[7]]</figcaption></figure><p id="eccb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我使用 R 中的分位数函数来获得玩家<code class="fe lb lc ld le b">Value</code>和<code class="fe lb lc ld le b">Wage</code>的前 1 %的计数。许多球员的周薪为 10 万€。</p><pre class="lm ln lo lp gt lq le lr ls aw lt bi"><span id="6316" class="lu lv iq le b gy lw lx l ly lz">top_1_percent_wage   &lt;- quantile(df$Wage, probs=0.99)</span><span id="fc8e" class="lu lv iq le b gy ma lx l ly lz">filtered_wage &lt;- filter(df, Wage &gt; top_1_percent_wage)<br/><br/>g_value &lt;- ggplot(filtered_wage, aes(Wage))</span><span id="c3ad" class="lu lv iq le b gy ma lx l ly lz">g_value + <br/>geom_histogram(aes(fill=..count..)) + <br/>ggtitle("Distribution of top 1% value")</span></pre><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/d01770fb6213f0e3c39c86cb482c08bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*88_L31Qze8nlYp8Cp71SJg.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Top 1% wage [Image [8]]</figcaption></figure><p id="ee74" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">大量的球员价值 2500 万€，随着价格的上涨，人数急剧减少。</p><pre class="lm ln lo lp gt lq le lr ls aw lt bi"><span id="561e" class="lu lv iq le b gy lw lx l ly lz">top_1_percent_value   &lt;- quantile(df$Value, probs=0.99)</span><span id="1949" class="lu lv iq le b gy ma lx l ly lz">filtered_value &lt;- filter(df, Value &gt; top_1_percent_value)<br/><br/>g_wage &lt;- ggplot(filtered_value, aes(Value))</span><span id="abd1" class="lu lv iq le b gy ma lx l ly lz">g_wage + <br/>geom_histogram(aes(fill=..count..)) + <br/>ggtitle("Distribution of top 1% Value")</span></pre><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/853125dc12c605e2f1787b1e853dc280.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aydII4fQf506tkbZLTStVw.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Top 1% player valuation [Image [9]]</figcaption></figure><p id="d784" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了进一步分析<code class="fe lb lc ld le b">wage</code>和<code class="fe lb lc ld le b">value</code>，我创建了<code class="fe lb lc ld le b">wage_brackets</code>和<code class="fe lb lc ld le b">value_brackets</code>。</p><p id="a8e8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lb lc ld le b">wage_brackets</code>是:<code class="fe lb lc ld le b">0–100k 100k-200k 200k-300k 300k-400k 400k-500k 500k+</code>。<code class="fe lb lc ld le b">value_brackets</code>是:<code class="fe lb lc ld le b">0–10M 10–20M 20–30M 30–40M 40–50M 50–60M 60–70M 70–80M 80–90M 90–100M 100M+</code>。</p><pre class="lm ln lo lp gt lq le lr ls aw lt bi"><span id="e85e" class="lu lv iq le b gy lw lx l ly lz"># Create wage brackets</span><span id="bc02" class="lu lv iq le b gy ma lx l ly lz">wage_breaks &lt;- c(0, 100000, 200000, 300000, 400000, 500000, Inf)</span><span id="3c33" class="lu lv iq le b gy ma lx l ly lz">wage_labels &lt;- c("0-100k", "100k-200k", "200k-300k", "300k-400k", "400k-500k", "500k+")</span><span id="f96c" class="lu lv iq le b gy ma lx l ly lz">wage_brackets &lt;- cut(x=df$Wage, breaks=wage_breaks, <br/>labels=wage_labels, include.lowest = TRUE)</span><span id="d6af" class="lu lv iq le b gy ma lx l ly lz">df &lt;- mutate(df, wage_brackets)</span><span id="4e09" class="lu lv iq le b gy ma lx l ly lz"># Create value brackets<br/><br/>value_breaks &lt;- c(0, 10000000, 20000000, 30000000, 40000000, 50000000, 60000000, 70000000, 80000000, 90000000, 100000000, Inf)<br/>value_labels &lt;- c("0-10M", "10-20M", "20-30M", "30-40M", "40-50M","50-60M", "60-70M", "70-80M", "80-90M","90-100M","100M+")</span><span id="b839" class="lu lv iq le b gy ma lx l ly lz">value_brackets &lt;- cut(x=df$Value, breaks=value_breaks, </span><span id="0c12" class="lu lv iq le b gy ma lx l ly lz">labels=value_labels, include.lowest = TRUE)</span><span id="dd39" class="lu lv iq le b gy ma lx l ly lz">df &lt;-mutate(df, value_brackets)</span><span id="9967" class="lu lv iq le b gy ma lx l ly lz">head(df)</span></pre><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi md"><img src="../Images/53beb944528bec781d867028c0cfbea7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rw9BGg-ffSR8MS63Hj-lSQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Dataset [Image [10]]</figcaption></figure><p id="651d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">很多球员的工资在 0-10 万英镑之间，估值在 0-5000 万英镑之间。绘制这些值会使图形发生很大的倾斜，因为与其他值相比，它们的幅度很大，因此我没有在这里展示它们。</p><pre class="lm ln lo lp gt lq le lr ls aw lt bi"><span id="9d39" class="lu lv iq le b gy lw lx l ly lz">not0To100K &lt;- filter(df, wage_brackets != "0-100k") </span><span id="b60a" class="lu lv iq le b gy ma lx l ly lz">ggplot(not0To100K, aes(x = wage_brackets)) + <br/>geom_bar(aes(fill = ..count..)) + <br/>ggtitle("Distribution of top Wage between 100K-500K+")</span></pre><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/59aaf1f479aa8b63d0c3e10d9c2621b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TzzS9vHTDzuzRxk_iNKGCA.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Wage between 100k and 500k+ [Image [11]]</figcaption></figure><pre class="lm ln lo lp gt lq le lr ls aw lt bi"><span id="397d" class="lu lv iq le b gy lw lx l ly lz">moreThan50M &lt;- filter(df, Value&gt;50000000)</span><span id="6a5f" class="lu lv iq le b gy ma lx l ly lz">ggplot(moreThan50M, aes(x = value_brackets)) + <br/>geom_bar(aes(fill = ..count..)) + <br/>ggtitle("Distribution of value between 50M-100M+")</span></pre><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/4db56ec94973eec3173d4d315539590f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8qrLPtAI9saWAmob-VjOQg.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Player valuation between 50M-100M+ [Image [12]]</figcaption></figure><p id="467e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">不同工资等级的球员的年龄和总体情况。工资最高的是年龄在 30 岁左右的 85 岁以上的球员。克里斯蒂亚诺罗纳尔多是上面三个紫色点之一。<em class="me">在下面的评论区猜另外两个。:P </em></p><pre class="lm ln lo lp gt lq le lr ls aw lt bi"><span id="1eb8" class="lu lv iq le b gy lw lx l ly lz">g_age_overall &lt;- ggplot(df, aes(Age, Overall))</span><span id="eec0" class="lu lv iq le b gy ma lx l ly lz">g_age_overall + <br/>geom_point(aes(color=wage_brackets)) + geom_smooth(color="darkblue") + <br/>ggtitle("Distribution between Age and Overall of players based  on Wage bracket")</span></pre><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/afe73ee4f9d78aa9167c865a8ecda98c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_eyTgUj0ulLmTPV7fEAd9w.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Overall vs Age (Wage) [Image [13]]</figcaption></figure><p id="ff10" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">玩家的年龄与整体价值的关系图与上面的趋势非常相似。</p><pre class="lm ln lo lp gt lq le lr ls aw lt bi"><span id="8b5d" class="lu lv iq le b gy lw lx l ly lz">g_age_overall &lt;- ggplot(df, aes(Age, Overall))</span><span id="afe7" class="lu lv iq le b gy ma lx l ly lz">g_age_overall + geom_point(aes(color=value_brackets)) + geom_smooth(color="darkblue") + <br/>ggtitle("Distribution between Age and Overall of players based on Value bracket")</span></pre><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/495469b2ebcde1893c41e257f51ffc16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bINvc-6sywnW0vKYAge9bA.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Age vs Overall (Value) [Image [14]]</figcaption></figure><p id="a8f1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">根据运动员的一般比赛位置确定运动员人数。中场人数最多，其次是后卫，前锋，最后是守门员。</p><pre class="lm ln lo lp gt lq le lr ls aw lt bi"><span id="2ef1" class="lu lv iq le b gy lw lx l ly lz">ggplot(df, aes(Position)) + <br/>geom_bar(aes(fill = ..count..)) + <br/>ggtitle("Distribution based on General Playing Position")</span></pre><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/703a9897245f9f5eed679f26e8627d72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AmgThvZGz6j018YkfNc-kA.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Number of players per playing position [Image [15]]</figcaption></figure><p id="803d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">根据玩家偏好的游戏位置确定玩家数量。基于上面的图表，我们期望一些特定的中场位置有最高的数量，但是这里中后卫的数量是最高的，其次是前锋的数量。</p><pre class="lm ln lo lp gt lq le lr ls aw lt bi"><span id="cf22" class="lu lv iq le b gy lw lx l ly lz">ggplot(df, aes(Preferred.Positions)) + geom_bar(aes(fill=..count..)) + <br/>ggtitle("Distribution of players based on preferred position")</span></pre><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/6838b0fdc7b0ee27df2e637d75a1ff4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RnJnBtrC7xjDeiz3LVWJ0g.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Number of players per Preferred Position [Image [16]]</figcaption></figure><p id="477e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们看看球员的工资是多少，以及他们基于首选位置的估值。</p><pre class="lm ln lo lp gt lq le lr ls aw lt bi"><span id="9305" class="lu lv iq le b gy lw lx l ly lz">gf1 &lt;- filter(df, Value&lt;30000000)</span><span id="898a" class="lu lv iq le b gy ma lx l ly lz">g1 &lt;- ggplot(gf1, aes(Preferred.Positions)) + geom_bar(aes(fill=value_brackets)) + <br/>ggtitle("Position based on Value (0-50M)")</span><span id="0d69" class="lu lv iq le b gy ma lx l ly lz">gf2 &lt;- filter(df,Value&gt;30000000)</span><span id="2138" class="lu lv iq le b gy ma lx l ly lz">g2 &lt;- ggplot(gf2, aes(Preferred.Positions)) + geom_bar(aes(fill=value_brackets)) + <br/>ggtitle("Position based on Value (50M +)")</span><span id="c675" class="lu lv iq le b gy ma lx l ly lz">grid.arrange(g1, g2, ncol=1)</span></pre><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/0f00a07f796fbd7cecede2627a9219e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cCK9IF_7CcXEQv90ifdg5A.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Wage based on Preferred position [Image [17]]</figcaption></figure><pre class="lm ln lo lp gt lq le lr ls aw lt bi"><span id="d19e" class="lu lv iq le b gy lw lx l ly lz">gw1 &lt;- filter(df, Wage &gt; 100000, Wage&lt;300000)</span><span id="5450" class="lu lv iq le b gy ma lx l ly lz">g1 &lt;- ggplot(gw1, aes(Preferred.Positions)) + geom_bar(aes(fill=wage_brackets)) + <br/>ggtitle("Position based on Wage (0-100k)") </span><span id="43ef" class="lu lv iq le b gy ma lx l ly lz">gw2 &lt;- filter(df,Wage&gt;300000) </span><span id="ec8c" class="lu lv iq le b gy ma lx l ly lz">g2 &lt;- ggplot(gw2, aes(Preferred.Positions)) + geom_bar(aes(fill=wage_brackets)) + <br/>ggtitle("Position based on Wage (100k+)")<br/>grid.arrange(g1, g2, ncol=1)</span></pre><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/1fa5bbcf7b5f56ee20655c137984b676.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jR5wH0X9c799Koo0UzpQ1g.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Valuation based on preferred position [Image [18]]</figcaption></figure><p id="1c28" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最后，</p><p id="d48c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">十大最有价值俱乐部。俱乐部价值通过合计每个俱乐部的球员估价来计算。</p><pre class="lm ln lo lp gt lq le lr ls aw lt bi"><span id="1aad" class="lu lv iq le b gy lw lx l ly lz">group_clubs &lt;- group_by(df, Club)</span><span id="4e84" class="lu lv iq le b gy ma lx l ly lz">club_value &lt;- summarise(group_clubs, total_val = sum(Value))</span><span id="7969" class="lu lv iq le b gy ma lx l ly lz">top_10_valuable_clubs &lt;- top_n(club_value, 10, total_val)<br/><br/>top_10_valuable_clubs$Club &lt;-as.factor(top_10_valuable_clubs$Club)<br/><br/>ggplot(top_10_valuable_clubs, aes(x = Club, y = total_val)) + geom_bar(stat = "identity", aes(fill=total_val)) + coord_flip() + ggtitle("Top 10 valuable clubs")</span></pre><figure class="lm ln lo lp gt jr gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/a30a84871f97cb818c1c9e587b482efb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vl9ewMxUicL6uUtHei7JxQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Top-10 valuable clubs [Image [19]]</figcaption></figure></div><div class="ab cl lf lg hu lh" role="separator"><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk ll"/><span class="li bw bk lj lk"/></div><div class="ij ik il im in"><p id="5663" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">感谢您的阅读。你可以在 RPubs 和 GitHub 找到源代码(R-notebook)。你可以在<a class="ae kc" href="https://www.linkedin.com/in/akshajverma7/" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>和<a class="ae kc" href="https://twitter.com/theairbend3r" rel="noopener ugc nofollow" target="_blank"> Twitter </a>上找到我。</p><p id="ac08" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">点击查看我的其他博客<a class="ae kc" href="https://medium.com/@theairbend3r" rel="noopener">。</a></p><figure class="lm ln lo lp gt jr gh gi paragraph-image"><a href="https://www.buymeacoffee.com/theairbend3r"><div class="gh gi mf"><img src="../Images/041a0c7464198414e6ce355f9235099e.png" data-original-src="https://miro.medium.com/v2/resize:fit:868/format:webp/1*SGCT6C60o4t58wRqeU2viQ.png"/></div></a></figure></div></div>    
</body>
</html>