<html>
<head>
<title>Simple Beginning to Web Scraping</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">简单的网络抓取入门</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/simple-beginning-to-web-scraping-ef2f2287aff9?source=collection_archive---------10-----------------------#2018-04-09">https://towardsdatascience.com/simple-beginning-to-web-scraping-ef2f2287aff9?source=collection_archive---------10-----------------------#2018-04-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/5418320c7e938d740beca9e1226beeb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LJCRmhRMcPNTYLT7TAzEuA.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/photos/OLIcAFggdZE?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Jay Wennington</a> on <a class="ae kc" href="https://unsplash.com/search/photos/junk?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="a761" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当您需要数据仓库中不容易获得的数据时，或者当数据可以在线获得但不能通过API获得时，Web抓取几乎是您的首选技术，您可以使用API通过HTML请求提取信息。</p><p id="63db" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设我们的目标是找到流行的印度博客平台。记住这个用例，现在让我们看看如何为我们的分析找到信息。</p><h1 id="da5a" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">数据源:</h1><p id="d859" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">在谷歌上快速搜索关键词——<a class="ae kc" href="https://www.google.co.in/search?q=indian+bloggers&amp;oq=indian+bloggers&amp;aqs=chrome.0.69i59j69i60.1750j0j1&amp;sourceid=chrome&amp;ie=UTF-8" rel="noopener ugc nofollow" target="_blank">印度博客</a>，这个<a class="ae kc" href="https://indianbloggers.org/" rel="noopener ugc nofollow" target="_blank">网站</a>会出现在第一个结果中。这个网站列出了一些最受欢迎的印度博客和他们的博客链接。因此，这个网站成为我们的数据来源，我们将从那里收集信息，供我们进一步分析。</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi me"><img src="../Images/2a2230de321910c9da50abb2523e7a83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*TiFiNGTj-_RUpsDt.png"/></div></div></figure><h1 id="431f" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">工具箱:</h1><p id="6ca3" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">对于这个分析，我们将使用Python编程语言。以下是此分析所需的软件包列表。</p><ul class=""><li id="1dc5" class="mj mk iq kf b kg kh kk kl ko ml ks mm kw mn la mo mp mq mr bi translated">请求—对于HTML请求</li><li id="fec7" class="mj mk iq kf b kg ms kk mt ko mu ks mv kw mw la mo mp mq mr bi translated">bs4——著名的解析html内容和收集所需数据的工具</li><li id="5b41" class="mj mk iq kf b kg ms kk mt ko mu ks mv kw mw la mo mp mq mr bi translated">re —用于正则表达式和模式匹配</li><li id="90a0" class="mj mk iq kf b kg ms kk mt ko mu ks mv kw mw la mo mp mq mr bi translated">matplotlib —用于可视化</li></ul><p id="3908" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们加载所需的库:</p><pre class="mf mg mh mi gt mx my mz na aw nb bi"><span id="cb18" class="nc lc iq my b gy nd ne l nf ng">import requests<br/>from bs4 import BeautifulSoup, Comment<br/>import pandas as pd<br/>import re<br/>import matplotlib.pyplot as plt</span></pre><h1 id="9a80" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">HTTP请求</h1><p id="c4a5" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">web抓取的第一步只是发出一个HTTP请求，获取URL内容(记住这一步只是收集URL的内容，并不抓取所需的信息)。</p><pre class="mf mg mh mi gt mx my mz na aw nb bi"><span id="be37" class="nc lc iq my b gy nd ne l nf ng">url='https://indianbloggers.org/'<br/>content = requests.get(url).text</span></pre><p id="5b8a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于使用<code class="fe nh ni nj my b">get()</code>的请求，创建一个带有url内容的请求对象，而<code class="fe nh ni nj my b">.text</code>方法提取对象/ URL的内容。</p><h1 id="1fdf" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">初始化所需的数据对象:</h1><p id="fbc2" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">为了进一步进行分析，我们将需要一些数据对象，这里我们正在初始化那些将在后续步骤中使用的对象。</p><pre class="mf mg mh mi gt mx my mz na aw nb bi"><span id="83c1" class="nc lc iq my b gy nd ne l nf ng">#initalizing an empty dictionary that would be written as Pandas Dataframe and then CSV<br/>d = {'title':[],'links':[]}</span><span id="0733" class="nc lc iq my b gy nk ne l nf ng">#initializing blog hosting category<br/>cat = {'blogspot':0,'wordpress':0,'others':0}</span></pre><p id="da41" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如你所看到的，我们已经创建了两个字典——一个用于肌酸a熊猫数据框架，另一个用于我们想要收集信息的必需博客平台。所以基本上是Blogspot vs WordPress(我们还有其他的，可以包括从自定义域到medium.com的任何东西)</p><h1 id="2e1d" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">开始刮</h1><pre class="mf mg mh mi gt mx my mz na aw nb bi"><span id="109c" class="nc lc iq my b gy nd ne l nf ng">soup = BeautifulSoup(content, "html.parser")<br/></span><span id="a57e" class="nc lc iq my b gy nk ne l nf ng">for link in soup.find_all('a',):<br/>    if len(link.text.strip()) &gt; 1 and bool(re.match('^http',link['href'])) and not bool(re.search('indianbloggers|twitter|facebook',link['href'])):<br/>        d['title'].append(link.text)<br/>        d['links'].append(link['href'])<br/>        #finding the blog hosting type<br/>        if re.search('blogspot',link['href']):<br/>            cat['blogspot']+=1<br/>        elif re.search('wordpress',link['href']):<br/>            cat['wordpress']+=1<br/>        else:<br/>            cat['others']+=1<br/>        #d['len'].append(len(link.text.strip()))</span></pre><p id="753b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">从上面的代码中，您可以注意到已经使用BeautifulSoup函数启动了抓取，该函数使用了我们在HTTP请求后提取的内容。那只是刮的开始。正如我们在目标中定义的那样，我们在这里提取链接——尤其是域名，以分析哪个博客平台(由URL的域名定义)受欢迎。考虑到这一点，我们可以确定我们需要抓取锚链接(带有HTML标签‘a’的超链接)。在这个过程中，我们需要做一些数据清理步骤。例如，有一些标签什么都没有，这需要被绕过，我们也不需要获得网站中社交媒体个人资料URL的超链接。因此，我们设法用一些正则表达式和if条件来清理数据。因为我们提取多个URL，所以我们需要通过for循环迭代我们的数据提取，以提取域信息并统计各个类别——blogpost、WordPress等——还需要构建追加到我们在上一步中创建的字典中，该字典可以转换为Pandas数据框。</p><h1 id="1983" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">输出数据帧:</h1><p id="70e0" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">上一步结束时，我们已经获得了所有需要的信息。为了更进一步，我们将把字典对象‘d’转换成Pandas数据框，这在数据分析中更加灵活和有用。然后，可以将数据框保存在您的计算机上，以供将来参考或进一步分析。同时，让我们也打印一些关于数据帧和数据摘要的信息。</p><pre class="mf mg mh mi gt mx my mz na aw nb bi"><span id="48ae" class="nc lc iq my b gy nd ne l nf ng">blog_list = pd.DataFrame(d).set_index('title')<br/>print(blog_list.head())<br/>blog_list.to_csv('blog_list.csv', encoding='utf-8')<br/>print(str(len(blog_list.index))+' rows written')<br/>print(cat)<br/>&gt;&gt;&gt; <br/>                                            links<br/>title                                            <br/>Amit Agarwal               <a class="ae kc" href="http://www.labnol.org/" rel="noopener ugc nofollow" target="_blank">http://www.labnol.org/</a><br/>Jyotsna Kamat  <a class="ae kc" href="http://www.kamat.com/jyotsna/blog/" rel="noopener ugc nofollow" target="_blank">http://www.kamat.com/jyotsna/blog/</a><br/>Amit Varma             <a class="ae kc" href="http://www.indiauncut.com/" rel="noopener ugc nofollow" target="_blank">http://www.indiauncut.com/</a><br/>Sidin Vadukut              <a class="ae kc" href="http://www.whatay.com/" rel="noopener ugc nofollow" target="_blank">http://www.whatay.com/</a><br/>Hawkeye           <a class="ae kc" href="http://hawkeyeview.blogspot.in/" rel="noopener ugc nofollow" target="_blank">http://hawkeyeview.blogspot.in/</a><br/>363 rows written<br/>{'wordpress': 49, 'blogspot': 106, 'others': 208}</span></pre><p id="ae19" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如您在结果中看到的，对象“cat”为我们提供了可视化所需的数据。</p><h1 id="1d41" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">可视化流行领域:</h1><p id="e8d1" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">有了生成的字典“cat ”,现在让我们使用matplotlib来可视化数据(不太美观)。</p><pre class="mf mg mh mi gt mx my mz na aw nb bi"><span id="1b69" class="nc lc iq my b gy nd ne l nf ng">#plotting the blog hosting type <br/>plt.bar(range(len(cat)), cat.values(), align='center')<br/>plt.xticks(range(len(cat)), cat.keys())<br/>plt.show()</span></pre><p id="a2bb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">给出了这个图:</p><figure class="mf mg mh mi gt jr gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/a8f21b9a81b0e15bb5d9f1ca010d951a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*czqTrvr_HJnC9aRC.png"/></div></figure><p id="c1b5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然“其他”类别(包括自定义域名和任何其他博客平台)赢得了这场比赛，但WordPress和Blogspot之间——博客帖子成为了赢家——这也可能是第一批移动者主要在博客帖子平台上的原因，然后他们可能会变得受欢迎，并最终出现在这个网站上。</p><h1 id="e1ac" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">最终注释:</h1><p id="9d8c" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">尽管如此，这篇文章的目的只有一个，那就是找到流行的博客平台。这篇文章旨在帮助你开始掌握网络抓取的基础知识。如果你有兴趣了解更多关于网络抓取的知识，你可以查看一下这个Datacamp教程。这里使用的完整代码可以在<a class="ae kc" href="https://github.com/amrrs/Scraper-Projects/tree/master/Indian%20Blog%20List%20Extraction" rel="noopener ugc nofollow" target="_blank">我的Github </a>上获得。这个帖子最初出现在<a class="ae kc" href="https://datascienceplus.com/finding-the-popular-indian-blogging-platform-by-web-scraping-in-python/" rel="noopener ugc nofollow" target="_blank"> DS+ </a>上。</p></div></div>    
</body>
</html>