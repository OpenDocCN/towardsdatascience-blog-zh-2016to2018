<html>
<head>
<title>ResNets for CIFAR-10</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">CIFAR-10 的结果</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/resnets-for-cifar-10-e63e900524e0?source=collection_archive---------6-----------------------#2018-10-08">https://towardsdatascience.com/resnets-for-cifar-10-e63e900524e0?source=collection_archive---------6-----------------------#2018-10-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="47bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这篇文章可以在 PDF <a class="ae kl" href="http://www.pabloruizruiz10.com/resources/CNNs/ResNet-on-CIFAR10.pdf" rel="noopener ugc nofollow" target="_blank">这里</a>下载。</p><p id="2027" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是关于 CNN 架构的<a class="ae kl" href="https://medium.com/@pabloruizruiz/deep-convolutional-neural-networks-ccf96f830178" rel="noopener">系列教程的一部分</a>。</p><p id="edc6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">主要目的是当应用于 CIFAR-10 数据集时，深入了解 ResNets。</p><ul class=""><li id="2cdb" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated">对于 ResNets 应用于 ImageNet，这是一个更深入的教程，这里还有另一个教程<a class="ae kl" href="https://medium.com/@pabloruizruiz/understanding-and-visualizing-resnets-442284831be8" rel="noopener"/>。</li><li id="041d" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">还有 PyTorch 实现详细教程<a class="ae kl" href="http://www.pabloruizruiz10.com/resources/CNNs/ResNet-PyTorch.html" rel="noopener ugc nofollow" target="_blank">这里</a>。</li><li id="5aff" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">在这里还可以找到<a class="ae kl" href="https://github.com/PabloRR100/Convolutional-Neural-Networks/blob/master/2_ResNets/resnets_Paper.py" rel="noopener ugc nofollow" target="_blank">构建这些架构的代码。</a></li></ul><p id="84c5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">索引</strong></p><ul class=""><li id="e1bb" class="km kn iq jp b jq jr ju jv jy ko kc kp kg kq kk kr ks kt ku bi translated">介绍</li><li id="e9a0" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">结构</li><li id="613a" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">卷积 1</li><li id="0ffc" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">第一层</li><li id="3e1b" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">第二层</li><li id="562a" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">第三层</li><li id="a3f9" class="km kn iq jp b jq kv ju kw jy kx kc ky kg kz kk kr ks kt ku bi translated">摘要</li></ul></div><div class="ab cl la lb hu lc" role="separator"><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf lg"/><span class="ld bw bk le lf"/></div><div class="ij ik il im in"><h1 id="a653" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">介绍</h1><p id="24da" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">这项工作是<a class="ae kl" href="https://medium.com/@pabloruizruiz/understanding-and-visualizing-resnets-442284831be8" rel="noopener">之前教程</a>的延续，在之前的教程中，我们对原论文[1]之后的 ResNet 进行了去神秘化。但是，这种结构是为了在 ImageNet 数据集上运行良好而构建的。</p><p id="f479" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ImageNet 数据集由属于 1000 个不同类别的一组大小(224x224)的图像(作者使用了 128 万幅训练图像、5 万幅验证图像和 10 万幅测试图像)组成。但是，CIFAR10 由一组不同的映像(45k 训练映像、5k 验证映像和 10k 测试映像)组成，这些映像分布在 10 个不同的类别中。</p><p id="914b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为输入体积(图像)的大小完全不同，所以很容易认为相同的结构不适合在该数据集上训练。我们无法在没有维度不匹配的情况下对数据集执行相同的缩减。</p><p id="1ddf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将遵循作者提供给 ResNets 的解决方案，在 CIFAR10 上进行训练，这也像 ImageNet 数据集一样很难遵循。在论文[1]的第<strong class="jp ir"> <em class="mk">节 4.2 CIFAR-10 和分析</em> </strong>中，我们找到了下表:</p><figure class="mm mn mo mp gt mq gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/eb8eb2263e15775888528d6c57ab791c.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/format:webp/1*tsMTDv-IBNlF_r4YkDBDvA.png"/></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk">Figure 1. Schema for ResNet from the paper</figcaption></figure><p id="62d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们按照他们给出的字面解释来构造 ResNet。为简化起见，我们将使用 n=1，结果为 20。</p><h1 id="20a1" class="lh li iq bd lj lk mx lm ln lo my lq lr ls mz lu lv lw na ly lz ma nb mc md me bi translated">结构</h1><p id="0131" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">按照之前关于 ResNets 工作的相同方法，让我们先看看整体情况，稍后再一层一层地深入细节。</p><figure class="mm mn mo mp gt mq gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nc"><img src="../Images/784d1d04c12198116c71c9abc14f27f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*chbylvv0Lts1hKEuOJix6g.png"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk">Figure 2. Scheme for ResNet Structure on CIFAR10</figcaption></figure><h1 id="3db8" class="lh li iq bd lj lk mx lm ln lo my lq lr ls mz lu lv lw na ly lz ma nb mc md me bi translated">卷积 1</h1><p id="98a7" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">在进入公共层行为之前，ResNet 的第一步是一个带有批处理规范化操作的 3x3 卷积。步幅为 1，填充为 1，以使输出大小与输入大小相匹配。请注意，我们与 ResNet for ImageNet 的第一个重大区别是，我们在第一个块中没有包括最大池操作。</p><figure class="mm mn mo mp gt mq gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/c9ceeed0789d9edbe40375d89bf0c67f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1004/format:webp/1*U0_p6fWDI7duT3hxWRC4IA.png"/></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk">Figure 3. Conv1</figcaption></figure><p id="d586" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以通过图 2 来验证 Conv1 的输出音量确实是 32x32x16。</p><h1 id="99c9" class="lh li iq bd lj lk mx lm ln lo my lq lr ls mz lu lv lw na ly lz ma nb mc md me bi translated">第一层</h1><p id="af4f" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">作者用来构建 ResNet 的其余注释是:</p><p id="fc4d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">——用<strong class="jp ir"> <em class="mk">一叠 6 层 3x3 卷积</em> </strong>。的选择将决定我们的网的大小。</p><p id="d6a4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">特征图大小分别为{32，16，8}，每个特征图大小有 2 个卷积。此外，过滤器的数量分别为{16，32，64}。</p><p id="a84b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">--通过 ResNet 的<strong class="jp ir"> <em class="mk">下采样</em> </strong>的卷是将<strong class="jp ir"> <em class="mk">的步距增加到 2 </em> </strong>，进行每层的第一次卷积。因此，在密集层之前不会使用池化操作。</p><p id="7eb8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">-对于<strong class="jp ir"> <em class="mk">旁路连接</em> </strong>，不使用投影。在卷的形状有所不同的情况下，输入的<strong class="jp ir"> <em class="mk">会简单地用零</em> </strong>填充，所以<strong class="jp ir"> <em class="mk">输出的大小与添加</em> </strong>之前的卷的大小相匹配。</p><p id="f5ae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这将留下图 4 作为我们第一层的表示。在这种情况下，我们的旁路连接是一个常规的<strong class="jp ir"> <em class="mk">恒等短连接，因为体的维数在整个层操作中是恒定的。因为我们选择 n=1，所以在层 1 中应用了 2 个卷积。</em></strong></p><figure class="mm mn mo mp gt mq gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/d4443812b8187a5f8e83b2886ed80910.png" data-original-src="https://miro.medium.com/v2/resize:fit:1184/format:webp/1*Fyf_jOmNHuHaPAYGJPbDAg.png"/></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk">Figure 4. Layer 1</figcaption></figure><p id="7196" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们仍然可以从图 2 中看出，第 1 层的输出体积确实是 32x32x16。我们再深入一点！</p><h1 id="e2e6" class="lh li iq bd lj lk mx lm ln lo my lq lr ls mz lu lv lw na ly lz ma nb mc md me bi translated">第二层</h1><p id="dce6" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">我们现在来看看如何处理输入音量的下采样。请记住，我们遵循与 ImageNet 数据集相同的结构和符号<a class="ae kl" href="https://medium.com/@pabloruizruiz/understanding-and-visualizing-resnets-442284831be8" rel="noopener">。如果没有遵循任何步骤，请务必看一看，因为有更详细的解释。</a></p><p id="3fc2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于第 2 层和下一个第 3 层，其行为与第 1 层相同，只是第一个卷积使用的步幅为 2，因此输出音量的大小是输入音量的一半(填充为 1)。这意味着快捷连接也需要额外的步骤，以在求和之前调整体积的大小。</p><figure class="mm mn mo mp gt mq gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nj"><img src="../Images/4de46eb91e2821ca950bfc74aeacb4df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n4XdjIELzIDRFIatJSHK7Q.png"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk">Figure 5.Layer 2, Block 1, Convolution</figcaption></figure><p id="5bcd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">整个层 2 的最终外观如图 6 所示。我们可以看到步长为 2 的卷积是如何用于向下采样的跳过连接以及层的第一个卷积的。此外，我们可以根据文件中的表格检查，我们确实有一个 16x16x32 的体积。</p><figure class="mm mn mo mp gt mq gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nk"><img src="../Images/4368e9da304129ec5a42cd8c31458646.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y2dZgHC74DNb6IUhIHCtZg.png"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk">Figure 6. Layer 2</figcaption></figure><h1 id="2ac8" class="lh li iq bd lj lk mx lm ln lo my lq lr ls mz lu lv lw na ly lz ma nb mc md me bi translated">第三层</h1><p id="ab4f" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">第 3 层将应用与第 2 层完全相同的原理，导致图 7。</p><figure class="mm mn mo mp gt mq gh gi paragraph-image"><div role="button" tabindex="0" class="nd ne di nf bf ng"><div class="gh gi nl"><img src="../Images/80e6132b3b105e2394c190ab32140eca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IOnBo2FxPa6hkBa-1BaC9A.png"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk">Figure 7. Layer 3</figcaption></figure><p id="7692" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以根据文章中的表格来检查，我们确实有一个 8x8x64 的卷。</p><h1 id="35fd" class="lh li iq bd lj lk mx lm ln lo my lq lr ls mz lu lv lw na ly lz ma nb mc md me bi translated">摘要</h1><p id="b08c" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">遵循作者建立的解释规则的结果产生以下结构，改变图 1 中的<em class="mk"> n </em>的值:</p><figure class="mm mn mo mp gt mq gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/e9485ff28bc1ff3461f5ee40b64c9313.png" data-original-src="https://miro.medium.com/v2/resize:fit:1382/format:webp/1*AUCm7oB_keewESjQzBdlpA.png"/></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk">Table 1. ResNets architectures for CIFAR-10</figcaption></figure><p id="aa42" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请注意，直观地说，这些架构与在 ImageNet 的<a class="ae kl" href="https://medium.com/@pabloruizruiz/understanding-and-visualizing-resnets-442284831be8" rel="noopener">工作结束时展示的 ImageNet 架构并不匹配。</a></p><h1 id="66e1" class="lh li iq bd lj lk mx lm ln lo my lq lr ls mz lu lv lw na ly lz ma nb mc md me bi translated">文献学</h1><p id="e5b2" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">[1]何国光，张，任，孙军，“深度残差学习在图像识别中的应用”，<em class="mk"/>，2016。</p></div></div>    
</body>
</html>