<html>
<head>
<title>Get Started with Deep Learning using Keras</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Keras 开始深度学习</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/get-started-with-deep-learning-using-keras-a45ee421f3ef?source=collection_archive---------7-----------------------#2018-09-18">https://towardsdatascience.com/get-started-with-deep-learning-using-keras-a45ee421f3ef?source=collection_archive---------7-----------------------#2018-09-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="bd3b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">深度学习处于人工智能革命的最前沿，这是有充分理由的——自然语言处理、图像识别，甚至计算机围棋方面令人难以置信的进步，都要归功于深度神经网络的帮助。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/9779805358f8c021ce6c03e648b24bf1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*K1K4XK90c5RaBj4V"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Alexa in the Amazon Echo uses deep learning to understand human language. <a class="ae lb" href="https://unsplash.com/@andresurena?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Andres Urena</a> on <a class="ae lb" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="1439" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于大多数神经网络必须完成的任务的复杂性，大多数人会认为很难建立一个神经网络。是的，也许 5 年前那是完全正确的，你必须从头开始建立你的神经网络。但是今天，有了像<a class="ae lb" href="https://keras.io/" rel="noopener ugc nofollow" target="_blank"> Keras </a>这样的开源框架，开始变得非常简单。以下是方法。(<a class="ae lb" href="https://gist.github.com/labriedion/9e1480a22d2e259f460b56c84a01a186" rel="noopener ugc nofollow" target="_blank">这里是完整的脚本</a>如果你想跳过前面！)</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="1e74" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">问题:用人口统计学变量预测薪水</h1><p id="ff74" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">首先，我们先找一个玩具问题入手。下面是我找到的一个:<a class="ae lb" href="https://www.kaggle.com/johnolafenwa/us-census-data" rel="noopener ugc nofollow" target="_blank">1994 年美国人口普查数据库</a>的美国成年人收入数据。我们将尝试使用几个完全连接的神经元层来预测人口普查中给定人员的工资。</p><p id="3af3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">老实说，深度神经网络对于这项任务来说可能有点大材小用。传统的数据科学技术，如逻辑回归，非常适合这种情况，并且非常容易解释。尽管如此，这仍然是一个开始使用 Keras 的好方法。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mm"><img src="../Images/a7a0986354607c0468016edd585d60e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZVOxixntbsemuR58"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk"><a class="ae lb" href="https://unsplash.com/@markusspiske?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Markus Spiske</a> on <a class="ae lb" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h2 id="ab51" class="mn lk iq bd ll mo mp dn lp mq mr dp lt jy ms mt lx kc mu mv mb kg mw mx mf my bi translated">进口</h2><p id="08c1" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">为了遵循这段代码，首先安装<a class="ae lb" href="https://www.python.org/downloads/" rel="noopener ugc nofollow" target="_blank"> Python 3 </a>。完成后，打开您的操作系统终端，并键入以下内容:</p><p id="c2ea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe mz na nb nc b">pip install <strong class="jp ir">pandas</strong></code></p><p id="32d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后在熊猫之后安装以下包:<strong class="jp ir"> sklearn </strong>、<strong class="jp ir"> tensorflow </strong>，最后是<strong class="jp ir"> keras </strong>。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="53d1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我们将从我们的进口开始。该脚本需要:</p><ol class=""><li id="1a16" class="nd ne iq jp b jq jr ju jv jy nf kc ng kg nh kk ni nj nk nl bi translated"><strong class="jp ir">熊猫</strong>用于数据操作、</li><li id="7f07" class="nd ne iq jp b jq nm ju nn jy no kc np kg nq kk ni nj nk nl bi translated"><strong class="jp ir"> numpy </strong>对于一些快速操作，</li><li id="2b53" class="nd ne iq jp b jq nm ju nn jy no kc np kg nq kk ni nj nk nl bi translated"><strong class="jp ir"> sklearn </strong>对于数据缩放和性能测量，</li><li id="c676" class="nd ne iq jp b jq nm ju nn jy no kc np kg nq kk ni nj nk nl bi translated">最后，<strong class="jp ir"> keras </strong>，我们的深度学习框架。</li></ol><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nr ns l"/></div></figure></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h2 id="a4a6" class="mn lk iq bd ll mo mp dn lp mq mr dp lt jy ms mt lx kc mu mv mb kg mw mx mf my bi translated">加载数据集</h2><p id="7b68" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">我们的数据集包含各种变量，如员工的年龄、教育水平、受教育年限、婚姻状况、职称等。该数据集中包含的最后一个值是工资范围，低于或高于$50，000。我们将使用前面的变量来预测这个目标。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nr ns l"/></div></figure></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h2 id="d369" class="mn lk iq bd ll mo mp dn lp mq mr dp lt jy ms mt lx kc mu mv mb kg mw mx mf my bi translated">准备数据集</h2><p id="2377" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">下一步是为 Keras 准备数据集。我们需要做到以下几点:</p><ol class=""><li id="652f" class="nd ne iq jp b jq jr ju jv jy nf kc ng kg nh kk ni nj nk nl bi translated">平衡各阶级。不平衡的班级会干扰训练。</li><li id="7f41" class="nd ne iq jp b jq nm ju nn jy no kc np kg nq kk ni nj nk nl bi translated">将分类变量(例如职业)<strong class="jp ir">转换成一个热点编码变量</strong>。基本上是为每个标签创建一个值为 0 或 1 的新列。</li><li id="b9da" class="nd ne iq jp b jq nm ju nn jy no kc np kg nq kk ni nj nk nl bi translated"><strong class="jp ir">提取训练和测试数据集的 X </strong>(变量)<strong class="jp ir">和 y </strong>(目标)<strong class="jp ir">值</strong>。</li><li id="b910" class="nd ne iq jp b jq nm ju nn jy no kc np kg nq kk ni nj nk nl bi translated"><strong class="jp ir">标度</strong>变量。</li></ol><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nr ns l"/></div></figure></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h1 id="f4ca" class="lj lk iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">喀拉斯的模型</h1><p id="8736" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">现在是精彩的部分！构建 Keras 模型。在 Keras 中有两个接口来构建模型，顺序模型 API 和函数 API。今天，我们将使用顺序模型 API，因为它更容易理解和构建。</p><p id="8f86" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我们需要做的。</p><ol class=""><li id="b361" class="nd ne iq jp b jq jr ju jv jy nf kc ng kg nh kk ni nj nk nl bi translated">首先，我们将设置一个<strong class="jp ir">模型检查点</strong>对象，以允许我们在训练过程中保存最佳结果。</li><li id="87a1" class="nd ne iq jp b jq nm ju nn jy no kc np kg nq kk ni nj nk nl bi translated">然后，我们将创建一个<strong class="jp ir">序列</strong>模型对象，我们将向其添加不同的神经层。</li><li id="7b72" class="nd ne iq jp b jq nm ju nn jy no kc np kg nq kk ni nj nk nl bi translated">我们将需要选择适当的<strong class="jp ir">激活</strong>函数、<strong class="jp ir">优化器</strong>和<strong class="jp ir">损失</strong>函数来构建我们的<strong class="jp ir">二元分类模型</strong>(我们试图预测一个变量的值为 0 或 1)。</li><li id="46be" class="nd ne iq jp b jq nm ju nn jy no kc np kg nq kk ni nj nk nl bi translated">最后，我们将训练我们的网络。</li></ol><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nr ns l"/></div></figure></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><h2 id="b104" class="mn lk iq bd ll mo mp dn lp mq mr dp lt jy ms mt lx kc mu mv mb kg mw mx mf my bi translated">评估模型的性能</h2><p id="41b0" class="pw-post-body-paragraph jn jo iq jp b jq mh js jt ju mi jw jx jy mj ka kb kc mk ke kf kg ml ki kj kk ij bi translated">我们表现如何？让我们来衡量我们的模型的性能！我们将测量<a class="ae lb" href="https://en.wikipedia.org/wiki/Precision_and_recall" rel="noopener ugc nofollow" target="_blank">精度</a>，一个精确分类量的值。</p><ol class=""><li id="0894" class="nd ne iq jp b jq jr ju jv jy nf kc ng kg nh kk ni nj nk nl bi translated">我们将需要<strong class="jp ir">加载我们在模型训练期间保存的权重</strong>，并且<strong class="jp ir">用这些权重编译模型</strong>。</li><li id="bef4" class="nd ne iq jp b jq nm ju nn jy no kc np kg nq kk ni nj nk nl bi translated"><strong class="jp ir">使用模型预测测试数据集中的值</strong>。</li><li id="cb66" class="nd ne iq jp b jq nm ju nn jy no kc np kg nq kk ni nj nk nl bi translated"><strong class="jp ir">将</strong>预测的工资与测试数据集中的<strong class="jp ir">实际</strong>工资进行比较。</li></ol><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="79c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最终，该模型对于低于 50K 的工资获得了大约 87%的精度，对于高于 50K 的工资获得了大约 72%的精度。</p><p id="5349" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于一个没有任何特征工程的模型来说还不错…</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="1bce" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">GithubGist 上的<a class="ae lb" href="https://gist.github.com/labriedion/9e1480a22d2e259f460b56c84a01a186" rel="noopener ugc nofollow" target="_blank">提供了整个脚本。</a></p><p id="37e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我希望你喜欢我的教程！</p><p id="8c52" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">艾蒂安</p></div></div>    
</body>
</html>