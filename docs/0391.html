<html>
<head>
<title>Predicting Amazon product reviews’ ratings</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">预测亚马逊产品评论的评分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/predicting-sentiment-of-amazon-product-reviews-6370f466fa73?source=collection_archive---------1-----------------------#2017-04-26">https://towardsdatascience.com/predicting-sentiment-of-amazon-product-reviews-6370f466fa73?source=collection_archive---------1-----------------------#2017-04-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="efbc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">分类器算法</em></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/8ad0d645f33c4e0a4fb67e4d49c60d2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Ev2uIHY5iGqtHxVi."/></div></div></figure><p id="0457" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">介绍</p><p id="b4f4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在机器学习中，分类用于根据包含类别事先已知的观察值的训练数据集，将新观察值分类到特定的集合/类别中。最常见的例子是电子邮件的“垃圾邮件”或“非垃圾邮件”类别。在电子商务中，可以使用分类器算法来基于单词对评论的情感进行分类。语言中的特定单词根据它们的积极或消极情绪被预先分类。</p><p id="756f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">分类是监督学习的一个实例。训练集已正确识别观察值。分类器算法用于基于与训练数据集的相似性和/或距离从未分类的无监督数据中创建聚类/集合。</p><h1 id="b11c" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">分析背后的统计数据</h1><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/583131da24eea5554491b71e9a59890e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*iwr9Zh900INRZJazAMsTgg.png"/></div></figure><p id="7713" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在简单分类器模型中，正和负数据点的简单计数将定义总体正或负集合。这就有问题了。例如，在句子中的单词的情况下，“Great”和“Good”都是肯定词。但是“很棒”比“好”的影响更大。我们需要训练我们的模型来衡量确定的数据点。</p><p id="3168" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">分类器模型边界可以是将“阳性”和“阴性”结果分开的简单线，也可以是将多个组分开的更复杂的超平面。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/979d5d7fc11640ffe7eaa5934b6f249a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1248/format:webp/1*2eo9Y7S6FHYv4FEFWWZH3Q.png"/></div></figure><p id="c9e8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">可以使用模型的误差或准确度以及“假阳性”和“假阴性”来观察模型的有效性。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/5df21ded0987caad0ab2495d4d4fe818.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/format:webp/1*_sEFwIyK8CIXUCOJCJf6yw.png"/></div></figure><h1 id="71af" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">使用的工具</h1><ol class=""><li id="8416" class="ly lz iq jp b jq ma ju mb jy mc kc md kg me kk mf mg mh mi bi translated">计算机编程语言</li><li id="b8b9" class="ly lz iq jp b jq mj ju mk jy ml kc mm kg mn kk mf mg mh mi bi translated">GraphLab</li><li id="c200" class="ly lz iq jp b jq mj ju mk jy ml kc mm kg mn kk mf mg mh mi bi translated">s帧(类似于熊猫数据帧)</li></ol><h1 id="0c9e" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">数据加载</h1><p id="a2c9" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mo ka kb kc mp ke kf kg mq ki kj kk ij bi translated">我们准备对亚马逊产品评论进行分类，了解正面或负面评论。亚马逊有5星评级。我们将用它来比较我们的预测。</p><pre class="kn ko kp kq gt mr ms mt mu aw mv bi"><span id="8f3c" class="mw kz iq ms b gy mx my l mz na"><em class="kl">&gt; product_reviews=graphlab.SFrame(‘amazon_baby.gl/’)</em></span><span id="6e04" class="mw kz iq ms b gy nb my l mz na"><em class="kl">&gt; product_reviews.head()</em></span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/522f61ca8fed248d7c1d65c4a60fca6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/0*uK8KImB12zrMgxrN."/></div></figure><pre class="kn ko kp kq gt mr ms mt mu aw mv bi"><span id="12a1" class="mw kz iq ms b gy mx my l mz na"><em class="kl">&gt; product_reviews.show()</em></span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/808317892094571aea5bd2a4e4f64f63.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/0*ZNyIuaZc2IiIou2O."/></div></figure><p id="d060" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建一个单词字典，将使用我的模型进行分类。</p><pre class="kn ko kp kq gt mr ms mt mu aw mv bi"><span id="4e21" class="mw kz iq ms b gy mx my l mz na"><em class="kl">&gt; product_reviews[‘wordcount’] = graphlab.text_analytics.count_words(product_reviews[‘review’])</em></span></pre><p id="c872" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">选择一个特定的产品来预测评论的情绪。Vulli Shopie是一款适合婴儿长牙的长颈鹿玩具。过滤产品的所有评论。</p><pre class="kn ko kp kq gt mr ms mt mu aw mv bi"><span id="dad3" class="mw kz iq ms b gy mx my l mz na"><em class="kl">&gt; vs_reviews = product_reviews[product_reviews[‘name’]==’Vulli Sophie the Giraffe Teether’]</em></span><span id="fb6f" class="mw kz iq ms b gy nb my l mz na"><em class="kl">&gt; vs_reviews[‘rating’].show(view=’Categorical’)</em></span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/2391279a3a0b3308ca858616ce078ab6.png" data-original-src="https://miro.medium.com/v2/resize:fit:822/0*FxFely6O9CMWe3as."/></div></figure><h1 id="e752" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">使用分类器模型的数据分析</h1><p id="fb7b" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mo ka kb kc mp ke kf kg mq ki kj kk ij bi translated">过滤掉中间等级为3的。高于4的评级意味着它是正面评级。</p><pre class="kn ko kp kq gt mr ms mt mu aw mv bi"><span id="0047" class="mw kz iq ms b gy mx my l mz na"><em class="kl">&gt; product_reviews = product_reviews[product_reviews[‘rating’] !=3]</em></span><span id="b5cb" class="mw kz iq ms b gy nb my l mz na"><em class="kl">&gt; product_reviews[‘binrating’] = product_reviews[‘rating’] &gt;= 4</em></span></pre><p id="45d6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建培训和测试数据集。</p><pre class="kn ko kp kq gt mr ms mt mu aw mv bi"><span id="7bd3" class="mw kz iq ms b gy mx my l mz na"><em class="kl">&gt; train_data, test_data = product_reviews.random_split(0.8, seed=0)</em></span></pre><p id="3499" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">构建一个情感分类器来识别评论是正面的还是负面的情感。逻辑分类器模型将使用来自训练数据的单词(单词计数列)和评级(binrating)来开发预测目标(binrating)的模型。</p><pre class="kn ko kp kq gt mr ms mt mu aw mv bi"><span id="621c" class="mw kz iq ms b gy mx my l mz na"><em class="kl">&gt; sentiment_model = graphlab.logistic_classifier.create (train_data,</em></span><span id="4e55" class="mw kz iq ms b gy nb my l mz na"><em class="kl">                    target=’binrating’,</em></span><span id="5e1e" class="mw kz iq ms b gy nb my l mz na"><em class="kl">                    features=[‘wordcount’],</em></span><span id="a4b5" class="mw kz iq ms b gy nb my l mz na"><em class="kl">                    validation_set=test_data)</em></span></pre><p id="5749" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">评估测试数据的模型，并使用ROC(受试者工作特性)曲线显示。</p><pre class="kn ko kp kq gt mr ms mt mu aw mv bi"><span id="69dd" class="mw kz iq ms b gy mx my l mz na"><em class="kl">&gt; sentiment_model.evaluate(test_data, metric=’roc_curve’)</em></span></pre><h1 id="5281" class="ky kz iq bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">结果</h1><pre class="kn ko kp kq gt mr ms mt mu aw mv bi"><span id="edb3" class="mw kz iq ms b gy mx my l mz na"><em class="kl">&gt; sentiment_model.show(view=’Evaluation’)</em></span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/0efc5b776e54fe18785860d9fb6e6494.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/0*vbi3KJ8OhVA4-XKI."/></div></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/816fa487cbe0da2943d156bdb51d1e4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:802/0*o9GESNhp3_xs1IHt."/></div></figure><p id="55b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">91%的准确率就不错了。</p><p id="150f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用我们建立的模型，预测Vullie Sophie长颈鹿玩具的每个评论情绪。</p><pre class="kn ko kp kq gt mr ms mt mu aw mv bi"><span id="21a8" class="mw kz iq ms b gy mx my l mz na"><em class="kl">&gt; vs_reviews[‘predicted_sentiment_by_model’]=<br/>sentiment_model.predict(vs_reviews, output_type=’probability’)</em></span></pre><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi nh"><img src="../Images/a8d850dbf4e7e95c47c999f0f8886d4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*G3_cYIf4i09j9mMp."/></div></div></figure><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/678e8496e804033cd7b16ad9b37a9cf2.png" data-original-src="https://miro.medium.com/v2/resize:fit:446/0*PeK3ml_xdaJl9ZJm."/></div></figure><p id="7d88" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的模式运行得非常好。对于更高数量的情感(接近1)，我们可以观察到亚马逊产品星级为5。</p><p id="d870" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以根据模型预测的情绪来查看最积极和最消极的评论。</p><pre class="kn ko kp kq gt mr ms mt mu aw mv bi"><span id="9ffa" class="mw kz iq ms b gy mx my l mz na"><em class="kl">&gt; vs_reviews=vs_reviews.sort(‘predicted_sentiment_by_model’, ascending=False)</em></span><span id="eb62" class="mw kz iq ms b gy nb my l mz na"><em class="kl">&gt; vs_reviews[0][‘review’]</em></span></pre><p id="0abe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">苏菲，哦，苏菲，你的时候到了。我的孙女，维奥莱特5个月大，开始长牙了。小索菲给瓦奥莱特带来了多大的快乐。索菲是由非常柔韧的橡胶制成的，结实但不坚韧。对瓦奥莱特来说，把索菲扭成前所未闻的姿势，让她把索菲送进嘴里是相当容易的。小鼻子和小蹄子完全适合小嘴巴，流口水是有目的的。索菲身上的油漆是食品级的。苏菲1961年出生于法国。制造商想知道为什么没有婴儿用品，于是在圣索菲节用最好的不含邻苯二甲酸盐的橡胶制作了索菲，这个名字就这样诞生了。从那时起，数以百万计的苏菲出现在这个世界上。她很柔软，婴儿的小手很容易抓住。紫罗兰特别喜欢苏菲那凹凸不平的头和角。苏菲的脖子很长，很容易抓住和扭动。她有可爱的，相当大的斑点，吸引了紫罗兰的注意。索菲有快乐的小吱吱声，带来了紫高兴的尖叫。她能让苏菲吱吱叫，这带来了很多快乐。索菲光滑的皮肤抚慰着维奥莱特的小牙龈。索菲有7英寸高，是婴儿抱和爱的正确尺寸。众所周知，婴儿抓到的第一件东西是放进嘴里的——拥有一个能刺激所有感官并有助于解决出牙问题的玩具是多么美妙。苏菲很小，可以放进任何尺寸的口袋或包里。索菲是从几个月到一岁婴儿的最佳选择。听到发现索菲不可抗拒的婴儿发出的咯咯笑声是多么美妙啊。苏菲万岁！强烈推荐。pris rob 12–11–09 "</p><p id="5fd8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最负面的评论。</p><pre class="kn ko kp kq gt mr ms mt mu aw mv bi"><span id="b078" class="mw kz iq ms b gy mx my l mz na"><em class="kl">&gt; vs_reviews[-1][‘review’] # most negative</em></span></pre><p id="64f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="kl">“我的儿子(现在2.5岁)喜欢他的索菲，我每次去参加婴儿送礼会都会买一个。现在，我的女儿(6个月)就在今天差点被它呛到，我再也不会给她吃了。如果我不在听得见的范围内，那可能是致命的。她发出的奇怪声音引起了我的注意，当我走到她面前，发现她弯曲的前腿被塞进了她的喉咙，她的脸变成了紫色/蓝色时，我慌了。我把它拉出来，她在尖叫前吐了整个地毯。真不敢相信我对这个玩具的看法怎么就从必须要变成不能用了。请不要忽视任何关于窒息危险的评论，它们并没有过分夸张！”</em></p></div></div>    
</body>
</html>