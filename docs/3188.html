<html>
<head>
<title>Tensorflow Image: Augmentation on GPU</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">张量流图像:在 GPU 上增强</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/tensorflow-image-augmentation-on-gpu-bf0eaac4c967?source=collection_archive---------8-----------------------#2018-04-17">https://towardsdatascience.com/tensorflow-image-augmentation-on-gpu-bf0eaac4c967?source=collection_archive---------8-----------------------#2018-04-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="76bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">深度学习可以解决许多对人类来说似乎不可能的有趣问题，但这是有成本的，我们需要大量的数据和计算能力来训练深度神经网络。</p><p id="d6e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了解决数据问题，我们可以使用数据扩充。增强也可能需要大量的计算，因为我们可能需要增强数百万张图像，为了处理这一点，我们可以使用 tensorflow.image，它提供了一些基本的图像功能，所有的计算都在 GPU 上完成。</p><p id="d27e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我正在使用 tensorflow eager_execution，这样我们就可以在不运行会话的情况下看到增强的结果，如果你想了解更多关于 eager_execution 的信息，请阅读<a class="ae kl" rel="noopener" target="_blank" href="/eager-execution-tensorflow-8042128ca7be">此处</a>。</p><p id="0e21" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们来看看一些增强功能:</p><h1 id="633f" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">1.加载图像</h1><p id="68c0" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">张量流图像函数期望传递的图像是张量。让我们加载一幅图像并将其转换为张量:</p><p id="4cec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">img = matplotlib . py plot . im read('/img _ path ')<br/>TF _ img = TF . convert _ to _ tensor(img)</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div role="button" tabindex="0" class="lv lw di lx bf ly"><div class="gh gi lp"><img src="../Images/574dbdb335bf2d905eb0fc4da0b9c1d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EqjJ1tEsRoc4FNptI9teeA.jpeg"/></div></div><figcaption class="mb mc gj gh gi md me bd b be z dk">Image soure:<a class="ae kl" href="https://cdn-images-1.medium.com/max/1000/1*ULBhR9EVavi-HhpdbrjEzQ.jpeg" rel="noopener">https://cdn-images-1.medium.com/max/1000/1*ULBhR9EVavi-HhpdbrjEzQ.jpeg</a></figcaption></figure><h1 id="7181" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">2.应用增强功能</h1><p id="3f8e" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">在这里，我们将看到不同类型的增强，可以适用于图像。</p><h2 id="9488" class="mf kn iq bd ko mg mh dn ks mi mj dp kw jy mk ml la kc mm mn le kg mo mp li mq bi translated">a.翻转图像</h2><p id="702c" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">一个最基本的增强是将翻转应用于图像，这可以使数据翻倍(基于你如何应用)。</p><p id="9388" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">水平翻转:</strong></p><p id="925e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">brright _ img = TF . image . flip _ left _ right(TF _ img)</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/6209d3c3a02f3e0c82dc5de0ba3fb2af.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*UYDREwlBU0ua9-g5ccRWgQ.png"/></div><figcaption class="mb mc gj gh gi md me bd b be z dk">Horizontally Flipped Image</figcaption></figure><p id="d703" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">垂直翻转:</strong></p><p id="bddc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">brright _ img = TF . image . flip _ up _ down(TF _ img)</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/b7ac1400023dcc9192cc9d390dafd25e.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*NmIPTEmki86rAlDkqOPHiQ.png"/></div><figcaption class="mb mc gj gh gi md me bd b be z dk">Vertically flipped Image</figcaption></figure><p id="58bf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">随机翻转:</strong>您的图像有 1/2 的几率会水平或垂直翻转。</p><p id="15f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">brright _ img = TF . image . random _ flip _ left _ right(TF _ img)<br/>brright _ img = TF . image . random _ flip _ up _ down(TF _ img)</p><p id="d59f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">或者，您也可以使用 tf.reverse 进行同样的操作。tf.reverse 接受一个附加参数，即 axis，它定义了图像应该沿 x 轴或 y 轴翻转的位置。</p><p id="998f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">brright _ img = TF . reverse(TF _ img，axis =[0])#垂直翻转<br/>brright _ img = TF . reverse(TF _ img，axis =[1])#水平翻转</p><h2 id="da30" class="mf kn iq bd ko mg mh dn ks mi mj dp kw jy mk ml la kc mm mn le kg mo mp li mq bi translated">b.图像旋转</h2><p id="935c" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">Tensorflow 提供<em class="ms">tensor flow . image . rot 90()</em>函数，将图像逆时针旋转 90 度。</p><p id="7723" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">brright _ img = TF . image . rot 90(TF _ img，k = 1)</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/ab8dd8ef0d77d9522acf9eb494daea0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:376/format:webp/1*xtZM7snC-6Nkq4_iB1RnKg.png"/></div><figcaption class="mb mc gj gh gi md me bd b be z dk">Rotated Image</figcaption></figure><p id="b988" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">图像将逆时针旋转 90 度 k 次。</p><h2 id="57b9" class="mf kn iq bd ko mg mh dn ks mi mj dp kw jy mk ml la kc mm mn le kg mo mp li mq bi translated">c.聪明</h2><p id="a8f2" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">用下面的代码改变图像的亮度:</p><p id="88e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">brright _ img = TF . image . adjust _ brightness(TF _ img，delta= 0.2)</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/ccd5602fa491ebbdef156a42470fa043.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*TUGm2PJ3JPvvJlyDP0HLRQ.png"/></div><figcaption class="mb mc gj gh gi md me bd b be z dk">Brightened Image</figcaption></figure><p id="47eb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">其中δ是要加到每个像素上的值的量。δ值越大，图像越亮。如果 delta 为负，那么图像将变暗。如果你想应用随机亮度，你可以使用下面的函数:</p><p id="29d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">brght _ img = TF . image . random _ brightness(TF _ img，max_delta=0.5)</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/c27e2db33ef6774afb88bd648361b7fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*Gd4oCPDDL8b7Piu2wyX7Vw.png"/></div><figcaption class="mb mc gj gh gi md me bd b be z dk">Random brightness</figcaption></figure><p id="c95d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Delta 将介于-max_delta 和 max_delta 之间。</p><h2 id="95e7" class="mf kn iq bd ko mg mh dn ks mi mj dp kw jy mk ml la kc mm mn le kg mo mp li mq bi translated">d.其他方法</h2><p id="5862" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">除了上述方法之外，还有如下类似的方法可用于图像增强:</p><ul class=""><li id="a012" class="mu mv iq jp b jq jr ju jv jy mw kc mx kg my kk mz na nb nc bi translated"><code class="fe nd ne nf ng b"><a class="ae kl" href="https://www.tensorflow.org/api_docs/python/tf/image/adjust_contrast" rel="noopener ugc nofollow" target="_blank">tf.image.adjust_contrast</a></code></li><li id="07d7" class="mu mv iq jp b jq nh ju ni jy nj kc nk kg nl kk mz na nb nc bi translated"><code class="fe nd ne nf ng b"><a class="ae kl" href="https://www.tensorflow.org/api_docs/python/tf/image/random_contrast" rel="noopener ugc nofollow" target="_blank">tf.image.random_contrast</a></code></li><li id="c1f7" class="mu mv iq jp b jq nh ju ni jy nj kc nk kg nl kk mz na nb nc bi translated"><code class="fe nd ne nf ng b"><a class="ae kl" href="https://www.tensorflow.org/api_docs/python/tf/image/adjust_hue" rel="noopener ugc nofollow" target="_blank">tf.image.adjust_hue</a></code></li><li id="af16" class="mu mv iq jp b jq nh ju ni jy nj kc nk kg nl kk mz na nb nc bi translated"><code class="fe nd ne nf ng b"><a class="ae kl" href="https://www.tensorflow.org/api_docs/python/tf/image/random_hue" rel="noopener ugc nofollow" target="_blank">tf.image.random_hue</a></code></li><li id="a734" class="mu mv iq jp b jq nh ju ni jy nj kc nk kg nl kk mz na nb nc bi translated"><code class="fe nd ne nf ng b"><a class="ae kl" href="https://www.tensorflow.org/api_docs/python/tf/image/adjust_gamma" rel="noopener ugc nofollow" target="_blank">tf.image.adjust_gamma</a></code></li><li id="2169" class="mu mv iq jp b jq nh ju ni jy nj kc nk kg nl kk mz na nb nc bi translated"><code class="fe nd ne nf ng b"><a class="ae kl" href="https://www.tensorflow.org/api_docs/python/tf/image/adjust_saturation" rel="noopener ugc nofollow" target="_blank">tf.image.adjust_saturation</a></code></li><li id="9f74" class="mu mv iq jp b jq nh ju ni jy nj kc nk kg nl kk mz na nb nc bi translated"><code class="fe nd ne nf ng b"><a class="ae kl" href="https://www.tensorflow.org/api_docs/python/tf/image/random_saturation" rel="noopener ugc nofollow" target="_blank">tf.image.random_saturation</a></code></li></ul><h1 id="3ec8" class="km kn iq bd ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj bi translated">3.其他图像处理任务</h1><p id="0f3a" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">除了图像增强，tf.image 还提供了一些其他有用的图像处理功能。</p><h2 id="6163" class="mf kn iq bd ko mg mh dn ks mi mj dp kw jy mk ml la kc mm mn le kg mo mp li mq bi translated">农作物</h2><p id="a575" class="pw-post-body-paragraph jn jo iq jp b jq lk js jt ju ll jw jx jy lm ka kb kc ln ke kf kg lo ki kj kk ij bi translated">Tensorflow 提供了以下用于裁剪图像的功能。</p><p id="c467" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">br right _ img = TF . image . central _ crop(TF _ img，0.5)</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/7a4e744a4d4b4ef57317ff3db90842dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*S9Tqm3kZMwKvcDQXK6JGAw.png"/></div></figure><p id="2d0b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">central_crop 使图像沿每个维度远离中心，并移除外部部分。</p><p id="e3ac" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">brght _ img = TF . image . crop _ to _ bounding _ box(TF _ img，offset_height = 100，offset_width = 100，target_height = 400，target_width = 800)</p><figure class="lq lr ls lt gt lu gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/1a713380b29296e4c486c2ea13f53a5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:762/format:webp/1*NrHC4JKUnsmwoYZTKIJiCg.png"/></div></figure><p id="1b41" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过提供偏移和图像尺寸值，crop_to_bounding_box 可以帮助您裁剪图像的特定区域。</p></div><div class="ab cl no np hu nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ij ik il im in"><p id="5c4f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如你所见，Tensorflow 提供了一些基本类型的图像函数，可以帮助你增加图像数据。你可以在这里探索更多关于 he tensorflow.image class <a class="ae kl" href="https://www.tensorflow.org/api_guides/python/image" rel="noopener ugc nofollow" target="_blank">。</a></p></div></div>    
</body>
</html>