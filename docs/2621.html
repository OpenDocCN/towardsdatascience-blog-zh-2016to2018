<html>
<head>
<title>Only Numpy Medical: Denosing Lung CT Scans using Neural Networks with Interactive Code — Part 1, Vanilla Auto Encoder Model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Only Numpy Medical:使用交互式代码的神经网络对肺部 CT 扫描去噪—第 1 部分，普通自动编码器模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/only-numpy-medical-denosing-lung-ct-scans-using-auto-encoders-with-interactive-code-part-1-a6c3f9400246?source=collection_archive---------5-----------------------#2018-02-13">https://towardsdatascience.com/only-numpy-medical-denosing-lung-ct-scans-using-auto-encoders-with-interactive-code-part-1-a6c3f9400246?source=collection_archive---------5-----------------------#2018-02-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/842f40faf01e089b2e4a34585391cd27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tp-AqpBNBBz6DWSrylaPgg.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Image <a class="ae kc" href="https://pixabay.com/en/mri-magnetic-x-ray-skull-head-782457/" rel="noopener ugc nofollow" target="_blank">from Pixel Bay</a></figcaption></figure><p id="d736" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我的激情在于人工智能，我希望我的遗产是在医疗保健领域，使用人工智能。因此，为了实现我的梦想，也为了实践实现神经网络的 OOP 方法，我将开始一系列肺部 CT 扫描的第一部分。我将用 Adam Optimizer 实现普通的自动编码器来开始这个系列。</p><p id="d0d4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> <em class="lb">注:所有的 DICOM 图像均来自</em> </strong> <a class="ae kc" href="http://www.cancerimagingarchive.net/" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> <em class="lb">癌症影像存档网</em> </strong> </a> <strong class="kf ir"> <em class="lb">，如果您打算使用这些数据，请查阅他们的数据使用年龄政策。具体来说，我将使用来自</em> </strong> <a class="ae kc" href="http://dx.doi.org/10.7937/K9/TCIA.2015.ORBJKMUX" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> <em class="lb">仿真模型 FDA </em> </strong> </a> <strong class="kf ir"> <em class="lb">数据集的 DICOM 图像。</em> </strong></p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="3f4d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">训练数据和生成的噪声数据</strong></p><div class="lj lk ll lm gt ab cb"><figure class="ln jr lo lp lq lr ls paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/afc1857f5f323e25f381d0d2e6e4d952.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*cT6zK8_0VycuZqVxBtJd_A.png"/></div></figure><figure class="ln jr lo lp lq lr ls paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/7b1b647ed911cbbf9707f19bce8fa623.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*98IHJiXcw6DmWliddscCQA.png"/></div></figure></div><div class="ab cb"><figure class="ln jr lo lp lq lr ls paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/1f81c3dddf7ce4ab23e180bafb714e8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*8uQqQ0mtNcQ4GtSqkmY90A.png"/></div></figure><figure class="ln jr lo lp lq lr ls paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/7fb8c5f0b36964f472564867851f4c15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1002/format:webp/1*-F5XfNrGmzl9GMyMkvVNTQ.png"/></div></figure></div><p id="db32" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个想法很简单，我们有原始的 DICOM 图像，如左图所示，我们将添加一些随机噪声，使图像看起来像右图。</p><figure class="lj lk ll lm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lt"><img src="../Images/a0a37811718f1cb0a1e660346d7d6b53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eANVTR_GUaTu1Xmr01P6lQ.png"/></div></div></figure><p id="c8d5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以通过添加随机高斯分布噪声并乘以某个常数值来实现这一点。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="ba14" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">网络架构(图形形式)</strong></p><figure class="lj lk ll lm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lu"><img src="../Images/79e83b7740c96e2fcda43a77a7b7d62e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mDP1agZTaPJOCrEGnWrkcQ.png"/></div></div></figure><p id="8292" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">黑盒</strong> →输入 512*512 尺寸的 DICOM 图像</p><p id="009e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">蓝/绿方块</strong> →编码器部分，3 卷积运算，在最后一层我们对图像进行矢量化(展平)</p><p id="4ae6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">红/黄色方块</strong> →解码器部分，输入编码矢量，并对其进行整形，以执行 3 层卷积运算。</p><p id="5ce0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如上所述，组成自动编码器的组件非常简单明了。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="185d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">网络架构(面向对象形式)</strong></p><figure class="lj lk ll lm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lv"><img src="../Images/d0c085694c2e05aed2229e05b3ef174b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OdIa25Eo4Z1CNtxyZvp6Zg.png"/></div></div></figure><p id="21ea" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如上所述，每个模型都有三种不同的功能。<br/> <strong class="kf ir"> a .初始化</strong> →初始化模型中的所有权重</p><p id="b460" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> b .前馈</strong> →根据型号是编码器还是解码器，要么以图像为输入，要么以编码矢量为输入，执行标准前馈操作。</p><p id="f688" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> c .反向传播</strong> →这是模型的关键功能，我们在这里计算每一层的错误率，并调整模型的权重，以学习最佳权重。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="0c2b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">前馈操作(编码器/解码器)</strong></p><figure class="lj lk ll lm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lw"><img src="../Images/7deb6d9a72417918e91ecaf5c204cf76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DtDmMdv8ZbYIZPAf7D1SZg.png"/></div></div></figure><p id="0c70" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">红框</strong> →编码器卷积运算部分<br/> <strong class="kf ir">蓝框</strong> →编码器全连接层运算部分</p><figure class="lj lk ll lm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lx"><img src="../Images/39a96401fa931ba853e010a0681f7c6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UgvZ0FJ4D-ekN4VCWnP_lQ.png"/></div></div></figure><p id="073a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">蓝框</strong> →解码器全连接层运算<br/> <strong class="kf ir">红框</strong> →解码器卷积运算</p><p id="8ae6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我想指出两件事。<br/> 1。从编码器到解码器的操作顺序是相反的。(或者换句话说，镜像。)<br/> 2。为了执行降维，我们将在编码器中使用均值池。为了对图像进行上采样，我们只需在解码器中重复矩阵中的每个元素。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="55a6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">反向传播(编码器/解码器)</strong></p><figure class="lj lk ll lm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ly"><img src="../Images/5718c021788dced9b902a39d2c90a235.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HCwxrRHD3fCXmOnOfzyM9Q.png"/></div></div></figure><p id="06cd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">红框→ </strong>编码器的 Adam 优化器更新<br/> <strong class="kf ir">蓝框</strong> →执行编码器的反向传播</p><figure class="lj lk ll lm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lz"><img src="../Images/3860422f95a692e1d2679b8749516b3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DDbeGmUVukAr2UsqD_xvMw.png"/></div></div></figure><p id="6b61" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">蓝框</strong> →为解码器执行反向传播<br/> <strong class="kf ir">紫框</strong> →将梯度传递给编码器，在更新权重<br/> <strong class="kf ir">红框</strong> → Adam 优化器为解码器更新之前计算梯度。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="3de0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">朴素成本函数</strong></p><figure class="lj lk ll lm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ma"><img src="../Images/70470d9c2423172a3907de9e449c1a10.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7LpBTkR4B8KTJaqi1r723A.png"/></div></div></figure><p id="dc77" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于这个普通的自动编码器，我将使用简单的成本函数，这是 L2 平方成本函数，但分母是 1/4，而不是 1/2。我意识到，我们可以在这里使用许多其他成本函数，例如 SSIM，或者我们甚至可以使用 VGG 16 作为成本函数，如论文“<a class="ae kc" href="https://arxiv.org/abs/1801.03924" rel="noopener ugc nofollow" target="_blank">深度特征作为感知度量的不合理有效性</a>”中所示。但是现在让我们继续关注 L2。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="c542" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">训练和结果——普通随机梯度下降</strong></p><figure class="lj lk ll lm gt jr gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/4e1f832bcf20c81720494819b715de40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/1*0i5raSJtuBOrreH5n91l1Q.gif"/></div></figure><p id="334d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">实际上，我对结果感到惊讶。我原以为解码后的图像会是一片漆黑或者全是灰度图像，然而令我惊讶的是，在解码后的图像中间几乎看不到黑点。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="0794" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">培训和结果— Adam Optimizer(高学习率)</strong></p><figure class="lj lk ll lm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mc"><img src="../Images/5d512bf0c9ed0717c65665dbd4466d79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*Mb3qoojr7ww45jdhNiwiqg.gif"/></div></div></figure><p id="5be3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">编码器的学习率→ 0.0005 <br/>解码器的学习率→ 0.001</p><p id="ce9a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如上所述，当学习率被设置为高值时，解码图像看起来就像一个带有黑色随机噪声的白色圆圈。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="9854" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">训练和结果— ReLU 激活功能(高学习率)</strong></p><div class="lj lk ll lm gt ab cb"><figure class="ln jr lo lp lq lr ls paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/7e21cf7af75db6c7ac3f84a5265617cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*Xk47ckB9eE984bdyfWDGPQ.gif"/></div></figure><figure class="ln jr lo lp lq lr ls paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/5f0e3175bf1316e21efadb8b77376be0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*3FNG3FstcFtDe6UOuimyOg.gif"/></div></figure></div><p id="6d0b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">编码器学习率→ 0.000006 <br/>解码器学习率→ 0.0000006</p><p id="aba5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">左边的 GIF 是第一个 50 纪元，右边的 GIF 是最后的 50 纪元，所以总共 100 纪元。我们可以再次看到在解码图像的中心形成“白圈”的相同趋势。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="a1ba" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">训练和结果— ReLu 激活功能(低学习率)</strong></p><div class="lj lk ll lm gt ab cb"><figure class="ln jr lo lp lq lr ls paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/622c682addec70cdafa1c183fbc02666.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*guhTKQvhNY01dVJPSPloyA.gif"/></div></figure><figure class="ln jr lo lp lq lr ls paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/b050c64a0d264146b28a843fc96d87b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*XtVqWRSaXPYNEiN1LAv9Eg.gif"/></div></figure></div><p id="7521" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">编码器的学习率→ 0.0000001 <br/>解码器的学习率→ 0.0000001</p><p id="6c1c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">左边的 GIF 是第一个 50 纪元，右边的 GIF 是最后的 50 纪元，所以总共 100 纪元。在低学习率下，我们可以看到图像的肺部部分(左图)，但是随着学习的进行，白色圆圈再次出现。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="05db" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">训练和结果——双曲正切/反正切激活函数(高 LR) </strong></p><div class="lj lk ll lm gt ab cb"><figure class="ln jr lo lp lq lr ls paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/1720d242c329c899c17b5497d3b5ddd9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*xtNbiz3qKiZ5iHHd_bZYzQ.gif"/></div></figure><figure class="ln jr lo lp lq lr ls paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/c9ae688eea2c4acfd0e04d65ac0985cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*vhdRR0B5gIfwfT7O9wEy4g.gif"/></div></figure></div><p id="3bec" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">编码器的学习率→ 0.000006 <br/>解码器的学习率→ 0.0000006</p><p id="e1cf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">左边的 GIF 是第一个 50 纪元，右边的 GIF 是最后的 50 纪元，所以总共 100 纪元。与具有高学习率的 ReLU 激活模型非常相似，但同样以白色圆圈结束。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="2356" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">训练和结果——双曲正切/反正切激活功能(低 LR) </strong></p><div class="lj lk ll lm gt ab cb"><figure class="ln jr lo lp lq lr ls paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/e7b964f669c405b409ec8ae178ef84a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*EFt7Zn7eSokvO9g3gE0dJg.gif"/></div></figure><figure class="ln jr lo lp lq lr ls paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/de3add069a22309600f4a0f153cd8ebc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*eq4SSBxXrjU-qe_8F_nj1g.gif"/></div></figure></div><p id="24c0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">编码器学习率→ 0.0000007 <br/>解码器学习率→ 0.0000001</p><p id="761e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">左边的 GIF 是第一个 50 纪元，右边的 GIF 是最后的 50 纪元，所以总共 100 纪元。因此，将学习率调整到较低是一个简单的解决方案，但是我们还不能说图像已经被成功去噪。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="19f8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">一段时间内的成本</strong></p><div class="lj lk ll lm gt ab cb"><figure class="ln jr md lp lq lr ls paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/c9842d314fc14671b964bbd8cf9b8e7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*0gja1-O3KbvEOSghNRs3Gg.png"/></div></figure><figure class="ln jr me lp lq lr ls paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><img src="../Images/1d3d2e5f2f80d60d5a09783193869808.png" data-original-src="https://miro.medium.com/v2/resize:fit:1022/format:webp/1*66T4DvxS-MReRAx9r3VrGA.png"/></div></figure></div><p id="fff7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">无论我选择使用 ReLU、Tanh 还是 Arctan 激活函数，成本似乎都随着时间的推移而降低，但是如果你看一下 Y 轴，它不在 0 附近，也不在产生可接受的去噪图像的范围内。</p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="129b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">交互代码</strong></p><figure class="lj lk ll lm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mf"><img src="../Images/b1c149916a17ec3d954e2b40be3ec93d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zC2ehWOloGBCkGSomdh2yA.png"/></div></div></figure><p id="dabf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">为了交互代码，我搬到了 Google Colab！所以你需要一个谷歌帐户来查看代码，你也不能在谷歌实验室运行只读脚本，所以在你的操场上做一个副本。最后，我永远不会请求允许访问你在 Google Drive 上的文件，仅供参考。编码快乐！</em></p><p id="e2b5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在运行这段代码有点复杂，因为我使用了自己的数据集。不过，不要担心，我已经将我使用的所有 DICOMs 上传到我的公共 Gitlab，要访问它<a class="ae kc" href="https://gitlab.com/jae.duk.seo/Only_Numpy/tree/master/a_CT_Lung_Auto_Encode_Series" rel="noopener ugc nofollow" target="_blank">请点击此链接</a>。要访问<a class="ae kc" href="https://gitlab.com/jae.duk.seo/Only_Numpy/tree/master" rel="noopener ugc nofollow" target="_blank">存储库的主页，请点击此处</a>。现在请按照一步一步的教程。</p><figure class="lj lk ll lm gt jr gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/889a5c29926b897152ba4aac8e73df30.png" data-original-src="https://miro.medium.com/v2/resize:fit:382/format:webp/1*tqYOHcwldu7n2TmBP_998A.png"/></div></figure><ol class=""><li id="3a22" class="mh mi iq kf b kg kh kk kl ko mj ks mk kw ml la mm mn mo mp bi translated">从上面的链接下载“lung_data_small.zip”文件。</li></ol><figure class="lj lk ll lm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mq"><img src="../Images/c9d3d7ee8962c155d42b79f2953f37c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z3LXwa2Db5DKOzeZejRbgQ.png"/></div></div></figure><p id="1e8e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">2.将 Google Colab 中的代码复制到您自己的游戏中。运行代码时，会弹出一个小按钮，如上所示。(绿色方框)。单击选择文件并选择最近下载的“lung_data_small.zip”文件。</p><figure class="lj lk ll lm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mr"><img src="../Images/b91cf6e06109367635b09031dc8ab69c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*87yceBPGAOyXf8mONBPJpA.png"/></div></div></figure><p id="e7a6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">3.该计划将完成上传数据到谷歌 Colab，它将继续运行。</p><p id="cd55" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以记住上面的简短教程，<a class="ae kc" href="https://colab.research.google.com/drive/1mnyokgWz78hb3wjsq5GlySTNRABAjI_k" rel="noopener ugc nofollow" target="_blank">请点击这里访问交互代码。</a></p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="395a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">遗言</strong></p><p id="dca6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我很抱歉对我自己的模特这么说。但我对这款香草款没抱太大期望。然而，我相信自动编码器是迷人的算法，我认为自动编码器有巨大的潜力。</p><p id="510b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果发现任何错误，请发电子邮件到 jae.duk.seo@gmail.com 找我。</p><p id="ccc9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同时，在我的 twitter 上关注我<a class="ae kc" href="https://twitter.com/JaeDukSeo" rel="noopener ugc nofollow" target="_blank">这里</a>，访问<a class="ae kc" href="https://jaedukseo.me/" rel="noopener ugc nofollow" target="_blank">我的网站</a>，或者我的<a class="ae kc" href="https://www.youtube.com/c/JaeDukSeo" rel="noopener ugc nofollow" target="_blank"> Youtube 频道</a>了解更多内容。如果你感兴趣的话，我还做了解耦神经网络<a class="ae kc" href="https://becominghuman.ai/only-numpy-implementing-and-comparing-combination-of-google-brains-decoupled-neural-interfaces-6712e758c1af" rel="noopener ugc nofollow" target="_blank">的比较。</a></p></div><div class="ab cl lc ld hu le" role="separator"><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh li"/><span class="lf bw bk lg lh"/></div><div class="ij ik il im in"><p id="e06a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">参考</strong></p><ol class=""><li id="ef1b" class="mh mi iq kf b kg kh kk kl ko mj ks mk kw ml la mm mn mo mp bi translated">越来越多的癌症医学图像档案。(未注明)。检索于 2018 年 2 月 12 日，来自<a class="ae kc" href="http://www.cancerimagingarchive.net/" rel="noopener ugc nofollow" target="_blank">http://www.cancerimagingarchive.net/</a></li><li id="30e4" class="mh mi iq kf b kg ms kk mt ko mu ks mv kw mw la mm mn mo mp bi translated">Gavrielides，Marios A，Kinnard，Lisa M，Myers，Kyle J，Peregoy，，Pritchard，William F，曾，荣平，… Petrick，Nicholas。(2015).数据来自 Phantom_FDA。癌症影像档案。<a class="ae kc" href="http://doi.org/10.7937/K9/TCIA.2015.ORBJKMUX" rel="noopener ugc nofollow" target="_blank">http://doi.org/10.7937/K9/TCIA.2015.ORBJKMUX</a></li><li id="62e7" class="mh mi iq kf b kg ms kk mt ko mu ks mv kw mw la mm mn mo mp bi translated">癌症影像档案维基。(未注明)。检索于 2018 年 2 月 12 日，来自<a class="ae kc" href="https://wiki.cancerimagingarchive.net/display/Public/Phantom" rel="noopener ugc nofollow" target="_blank">https://wiki . cancerimagingarchive . net/display/Public/Phantom</a>FDA # 9d 6953 e 17646457293 a 77021 aa4 CDB 37</li><li id="5d22" class="mh mi iq kf b kg ms kk mt ko mu ks mv kw mw la mm mn mo mp bi translated">Python 中的 DICOM:用 PyDICOM 和 VTK 将医学图像数据导入 NumPy。(2014 年 10 月 25 日)。检索于 2018 年 2 月 12 日，来自<a class="ae kc" href="https://pyscience.wordpress.com/2014/09/08/dicom-in-python-importing-medical-image-data-into-numpy-with-pydicom-and-vtk/" rel="noopener ugc nofollow" target="_blank">https://py science . WordPress . com/2014/09/08/DICOM-in-python-importing-medical-image-data-into-numpy-with-pydicom-and-VTK/</a></li><li id="1d35" class="mh mi iq kf b kg ms kk mt ko mu ks mv kw mw la mm mn mo mp bi translated">1.(2017 年 08 月 04 日)。自动编码器——比特和字节的深度学习——走向数据科学。检索于 2018 年 2 月 12 日，来自<a class="ae kc" rel="noopener" target="_blank" href="/autoencoders-bits-and-bytes-of-deep-learning-eaba376f23ad">https://towardsdatascience . com/auto encoders-bits-and-bytes-of-deep-learning-eaba 376 f 23 ad</a></li><li id="0f9e" class="mh mi iq kf b kg ms kk mt ko mu ks mv kw mw la mm mn mo mp bi translated">如何使用 Python 并排绘制两个图？(未注明)。检索于 2018 年 2 月 12 日，来自<a class="ae kc" href="https://stackoverflow.com/questions/42818361/how-to-make-two-plots-side-by-side-using-python" rel="noopener ugc nofollow" target="_blank">https://stack overflow . com/questions/42818361/how-to-make-two-plots-side-by-side-using-python</a></li><li id="a9c3" class="mh mi iq kf b kg ms kk mt ko mu ks mv kw mw la mm mn mo mp bi translated">numpy.repeat 的反义词是什么？(未注明)。检索于 2018 年 2 月 12 日，来自<a class="ae kc" href="https://stackoverflow.com/questions/40617710/what-is-the-opposite-of-numpy-repeat" rel="noopener ugc nofollow" target="_blank">https://stack overflow . com/questions/40617710/what-the-opposite-of-numpy-repeat</a></li><li id="4b61" class="mh mi iq kf b kg ms kk mt ko mu ks mv kw mw la mm mn mo mp bi translated">J.(2017 年 2 月 27 日)。JaeDukSeo/Python _ Basic _ Image _ Processing。检索于 2018 年 2 月 12 日，发自 https://github.com/JaeDukSeo/Python_Basic_Image_Processing<a class="ae kc" href="https://github.com/JaeDukSeo/Python_Basic_Image_Processing" rel="noopener ugc nofollow" target="_blank"/></li><li id="4511" class="mh mi iq kf b kg ms kk mt ko mu ks mv kw mw la mm mn mo mp bi translated">Ruder，S. (2018 年 2 月 10 日)。梯度下降优化算法综述。检索于 2018 年 2 月 12 日，发自 http://ruder.io/optimizing-gradient-descent/index.html#adam<a class="ae kc" href="http://ruder.io/optimizing-gradient-descent/index.html#adam" rel="noopener ugc nofollow" target="_blank"/></li><li id="9dc0" class="mh mi iq kf b kg ms kk mt ko mu ks mv kw mw la mm mn mo mp bi translated">1.(2017 年 7 月 26 日)。自动编码器在面向数据科学的深度神经网络中至关重要。2018 年 2 月 12 日检索，来自<a class="ae kc" rel="noopener" target="_blank" href="/autoencoders-are-essential-in-deep-neural-nets-f0365b2d1d7c">https://towardsdatascience . com/auto encoders-is-essential-in-deep-neural-nets-f 0365 b 2 D1 d 7 c</a></li><li id="43b9" class="mh mi iq kf b kg ms kk mt ko mu ks mv kw mw la mm mn mo mp bi translated">张，r .，伊索拉，p .，埃夫罗斯，A. A .，谢赫曼，e .，，王，O. (2018)。深度特征作为感知度量的不合理有效性。<em class="lb"> arXiv 预印本 arXiv:1801.03924 </em>。</li></ol></div></div>    
</body>
</html>