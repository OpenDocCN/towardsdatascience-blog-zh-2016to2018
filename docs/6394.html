<html>
<head>
<title>GANs Demystified — What the hell do they learn?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">去神秘化的甘——他们到底学到了什么？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/gans-demystified-what-the-hell-do-they-learn-142575c878db?source=collection_archive---------7-----------------------#2018-12-11">https://towardsdatascience.com/gans-demystified-what-the-hell-do-they-learn-142575c878db?source=collection_archive---------7-----------------------#2018-12-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8c81" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">可视化生成性对抗网络</h2></div><p id="0563" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本文是研究论文“<a class="ae lb" href="https://arxiv.org/abs/1811.10597" rel="noopener ugc nofollow" target="_blank"> <em class="lc">甘剖析:可视化和理解生成性对抗网络</em> </a>”的总结。本文对 GANs 的内部表示提供了极好的见解，并对以下问题给出了严密的回答。</p><p id="f2a0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">甘一家到底在学什么？我特别指的是发电机。我们都见过 GANs 产生的惊人结果，在某些情况下几乎与人类的工作无法区分。但是它们是如何表示学到的知识的仍然是一个谜。他们只是简单地学习像素模式并合成他们所看到的吗？还是他们真的从训练数据中捕捉到了复杂的关系？</p><p id="2a42" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本文试图解释 gan 的表示，并举例说明可视化和调试它们的技术。它使用两个阶段来实现。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ld"><img src="../Images/c8e2e56709316fe6f9f19c134787491b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L8eAj0VcEsnC8lzvuQ2wuQ.png"/></div></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk">Overview of the work. Watch the <a class="ae lb" href="https://www.youtube.com/embed/yVCgUYe4JTM?rel=0&amp;autoplay=1" rel="noopener ugc nofollow" target="_blank">demo video here</a></figcaption></figure><h2 id="569b" class="lt lu iq bd lv lw lx dn ly lz ma dp mb ko mc md me ks mf mg mh kw mi mj mk ml bi translated">解剖</h2><p id="60e7" class="pw-post-body-paragraph kf kg iq kh b ki mm jr kk kl mn ju kn ko mo kq kr ks mp ku kv kw mq ky kz la ij bi translated">剖析的目的是识别生成器中层的输出所代表的对象类。G 中的一个特殊单位代表树吗？</p><p id="954c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一些术语:</p><p id="e6bf" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">单元:</strong>发电机的各通道特性图 G<br/>T7】r:一层发电机的输出</p><p id="ad79" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">基于 Bau 等人(2017)，过滤器的特征图给出了对象类分割的良好近似。对于我们感兴趣的每个对象类，我们首先计算生成的图像中该类的分割掩码。我们使用下面的公式对单元 u 的特征图进行上采样和阈值处理。然后，我们取这个阈值化的、上采样的特征图和该类的分段掩码之间的 IOU。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi mr"><img src="../Images/c3d1d2bb8e245aae40195fd67fd9c143.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xyqVrpnVILpJsEkPUh8ySA.png"/></div></div></figure><p id="0df7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> ∧ </strong>表示交集，<strong class="kh ir"> ∨ </strong>表示并集。<strong class="kh ir"> s_c(x) </strong>表示图像 x <strong class="kh ir">中特定类别 c 的分割掩模。</strong>上面也提到了计算特定单元和类的阈值的公式。简而言之，上面的公式给出了一个度量<strong class="kh ir">一个单位 u 多少代表 c 类</strong>。你可以在论文中读到更多关于阈值公式背后的直觉。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi ms"><img src="../Images/6dae474e625d314cf47b8c9a5bf2d66e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nb4prHL0UA5Tj8c-vc3d9Q.png"/></div></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk">1</figcaption></figure><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi mt"><img src="../Images/b4f86d2cabf2daab7ddaa8ea4bb48ab9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Wu0PUKgy1eH0A49j7y2wA.png"/></div></div></figure><p id="b27a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，通过对每个类 c 获得的值的这些分数进行排序，对单元所代表的概念(对象类)进行排序</p><p id="240d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">TLDR；</strong>解剖允许你发现与一个对象类最匹配的单元。但这并不一定意味着他们要对产生它们负责。</p><h2 id="1760" class="lt lu iq bd lv lw lx dn ly lz ma dp mb ko mc md me ks mf mg mh kw mi mj mk ml bi translated">干涉；干预</h2><p id="85ef" class="pw-post-body-paragraph kf kg iq kh b ki mm jr kk kl mn ju kn ko mo kq kr ks mp ku kv kw mq ky kz la ij bi translated">干预旨在发现一组单元是否导致对象类别 c。这是通过打开和关闭单元并观察对生成的图像 g 的影响来完成的。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi mu"><img src="../Images/4ec8af52c2addcb6a1033c60457ead0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GoPYiEG-Qvo7eJfNKzTHYg.png"/></div></div></figure><p id="79fb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir"> r: </strong>张量输出(激活图)来自生成图像 G 中某一特定层的<strong class="kh ir"> G <br/> U: </strong>单位集<strong class="kh ir"> <br/> P: </strong>像素</p><p id="81cb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">消融</strong>是指通过将 U 中的单元设置为 0 来关闭它们。另一方面，<strong class="kh ir">插入</strong>强制 U 中的单位等于<strong class="kh ir"> k </strong>，每类常数 a。通过取引起 c 的单元的特征图的平均值来计算 c 类的 k。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/bcff0825d7c415a3322d6c3e621e99f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*KtjiBPNk0Hl1MNU8i0XFog.png"/></div></figure><p id="78b4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">上面的公式给出了多少单位 U 负责生成 c 类的度量。该度量被命名为平均因果效应<strong class="kh ir"> (ACE) </strong>。这里，<strong class="kh ir"> s_c(x) </strong>表示像素 p 处的图像 x 中的 c 类分割图。因此，基本上，插入和切除对 G 中 c 类分割图的因果影响之间的差异。</p><p id="3232" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">但是我们怎么知道如何选择最优的单位 U 呢？很难进行彻底的搜索来选择最佳组合。这是通过使用一个巧妙的目标函数，并将这项工作外包给梯度下降来完成的。</p><p id="0ccc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将<strong class="kh ir"> U </strong>设为整个单元集，但是用参数向量α对它们进行加权。<strong class="kh ir">随机梯度下降</strong>然后被用于最大化目标函数(ACE)和最小化最优集合中的单元数量(通过使用阿尔法的 L2 正则化项)。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi mw"><img src="../Images/c51c184cd8b124bdb6e5884541cc3d27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kcF9fPrV13rsG9oLz7hsWg.png"/></div></div></figure><figure class="le lf lg lh gt li gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/ceee36be448f37a0500e7c0b1bec1618.png" data-original-src="https://miro.medium.com/v2/resize:fit:738/format:webp/1*Tv2qCahIMxtyWWVLxZweIg.png"/></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk">L2 regularisation term is added to minimize number of units in the optimal set</figcaption></figure><p id="f726" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下图显示了消融导致树木的单元如何成功地从生成的图像中移除树木。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi my"><img src="../Images/80fec24d25bcfa40a9caa6fc1ef9f625.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f55VVVOwAbHBzQCbn9AXYQ.png"/></div></div><figcaption class="lp lq gj gh gi lr ls bd b be z dk">Ablating units to remove trees</figcaption></figure><h2 id="efe2" class="lt lu iq bd lv lw lx dn ly lz ma dp mb ko mc md me ks mf mg mh kw mi mj mk ml bi translated">简单地说，结果</h2><p id="be72" class="pw-post-body-paragraph kf kg iq kh b ki mm jr kk kl mn ju kn ko mo kq kr ks mp ku kv kw mq ky kz la ij bi translated"><strong class="kh ir">层间差异:</strong>根据结果，第一层与井对象类别不匹配。这具有直观的意义，因为早期的图层通常表示原始特征。中间层有许多匹配语义对象和对象部分的单元。结束层匹配局部像素模式，如材料、边缘和颜色。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi mz"><img src="../Images/e6d18d640a99321ff826906824c742d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*usx2O74QPzWCDaVa-iL12Q.png"/></div></div></figure><p id="3869" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">GAN 架构之间的差异:</strong>本文还通过检查单元讨论了不同架构在内部表示方面的比较。</p><p id="4cfb" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">经由插入的上下文关系:</strong>该论文还描述了通过强制单元将特征插入到生成的图像的特定位置。一个有趣的观察是，像门这样的物体只能被插入到视觉上有意义的特定位置(如窗户附近的建筑、砖块)。这表明 GANS 实际上捕捉了物体之间的关系，而不仅仅是像素模式。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi na"><img src="../Images/341a8dd170eab1ffe3c68c18e96c8bc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xIar2gL00jwqkeVCme1Utg.png"/></div></div></figure><p id="3648" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">上图说明了对象类的生成是如何高度依赖于本地上下文的。插入的实际效果因发生的地点而异。</p><h2 id="0166" class="lt lu iq bd lv lw lx dn ly lz ma dp mb ko mc md me ks mf mg mh kw mi mj mk ml bi translated">诊断 GANs</h2><p id="a135" class="pw-post-body-paragraph kf kg iq kh b ki mm jr kk kl mn ju kn ko mo kq kr ks mp ku kv kw mq ky kz la ij bi translated">通过使用干预技术，我们可以研究生成的图像中错误/不期望的部分和伪影的原因。通过手动注释和去除引起的单元，GAN 的结果可以得到相当大的改善。下图说明了消融伪影产生单元如何产生可见结果。</p><figure class="le lf lg lh gt li gh gi paragraph-image"><div role="button" tabindex="0" class="lj lk di ll bf lm"><div class="gh gi nb"><img src="../Images/13bb2adb6f20570f2a5ef311105cacef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8RXOqwPvuQTSF5EIW_eGRQ.png"/></div></div></figure><p id="cbb2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用这个框架，您可以手工定制和影响 GAN 的结果。增强或减少某些对象类的存在(在一定程度上)是相对简单的。</p><h2 id="3295" class="lt lu iq bd lv lw lx dn ly lz ma dp mb ko mc md me ks mf mg mh kw mi mj mk ml bi translated">最后的想法</h2><p id="d984" class="pw-post-body-paragraph kf kg iq kh b ki mm jr kk kl mn ju kn ko mo kq kr ks mp ku kv kw mq ky kz la ij bi translated">这篇论文很好地试图揭开 GANs 的神秘面纱，这是一个迄今为止相对未被探索的话题。他们的框架使研究人员和实践者能够更好地调试、改进和理解他们的模型。</p><p id="26c9" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所讨论的调试方法大多基于人工监督。然而，我相信本文中介绍的推理和技术可以潜在地用于开发更自动化的技术来改进 GANs(本文讨论了一种自动识别工件单元的技术)。</p><p id="f5e5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kh ir">演职员表:</strong>取自论文的想法、公式和图像。</p><h1 id="b448" class="nc lu iq bd lv nd ne nf ly ng nh ni mb jw nj jx me jz nk ka mh kc nl kd mk nm bi translated">参考</h1><p id="3c21" class="pw-post-body-paragraph kf kg iq kh b ki mm jr kk kl mn ju kn ko mo kq kr ks mp ku kv kw mq ky kz la ij bi translated">【甘剖析:可视化与理解生成性对抗网络</p><p id="aa30" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae lb" href="https://gandissect.csail.mit.edu/" rel="noopener ugc nofollow" target="_blank">项目官网</a>(附 Github 代码、演示视频、幻灯片等)</p><p id="032c" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><a class="ae lb" href="http://gandissect.res.ibm.com/ganpaint.html" rel="noopener ugc nofollow" target="_blank">交互式甘绘制工具</a></p></div></div>    
</body>
</html>