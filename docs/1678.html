<html>
<head>
<title>Creating an IOS app with Core ML from scratch!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">从头开始用 Core ML 创建一个 IOS 应用程序！</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/creating-an-ios-app-with-core-ml-from-scratch-b9e13e8af9cb?source=collection_archive---------1-----------------------#2017-10-03">https://towardsdatascience.com/creating-an-ios-app-with-core-ml-from-scratch-b9e13e8af9cb?source=collection_archive---------1-----------------------#2017-10-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><blockquote class="jn jo jp"><p id="e71b" class="jq jr js jt b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko ij bi translated">这个世界<strong class="jt ir">需要选择和决断</strong><em class="iq">——Re 创作者动漫。</em></p></blockquote><p id="32f2" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">在机器学习中，一切都始于模型，即进行预测或识别的系统。教计算机学习涉及一种机器学习算法，该算法具有要学习的训练数据。训练产生的输出通常被称为机器学习模型。有不同类型的机器学习模型解决相同的问题(例如物体识别)，但使用不同的算法。<a class="ae ks" href="https://en.wikipedia.org/wiki/Artificial_neural_network" rel="noopener ugc nofollow" target="_blank">神经网络</a>、<a class="ae ks" href="https://en.wikipedia.org/wiki/Ensemble_learning" rel="noopener ugc nofollow" target="_blank">树集成</a>、<a class="ae ks" href="https://en.wikipedia.org/wiki/Support_vector_machine" rel="noopener ugc nofollow" target="_blank">支持向量机</a>就是这些机器学习算法中的一些。</p><h1 id="49f0" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">机器学习就像一个迭代过程</h1><p id="7651" class="pw-post-body-paragraph jq jr iq jt b ju lr jw jx jy ls ka kb kp lt ke kf kq lu ki kj kr lv km kn ko ij bi translated">首先，我们用公共模型进行实验，但是为了带来独特的市场价值和优势，我们希望我们的模型胜过其他模型。我们正在寻找的叫做<strong class="jt ir"> ML 反馈回路</strong>。Google 对 ML 特性的处理遵循以下模式:</p><ul class=""><li id="2bc0" class="lw lx iq jt b ju jv jy jz kp ly kq lz kr ma ko mb mc md me bi translated">获取初始化数据(一次)</li><li id="5be7" class="lw lx iq jt b ju mf jy mg kp mh kq mi kr mj ko mb mc md me bi">— — — — —</li><li id="0bd9" class="lw lx iq jt b ju mf jy mg kp mh kq mi kr mj ko mb mc md me bi translated">标签数据</li><li id="9094" class="lw lx iq jt b ju mf jy mg kp mh kq mi kr mj ko mb mc md me bi translated">火车模型</li><li id="8dc8" class="lw lx iq jt b ju mf jy mg kp mh kq mi kr mj ko mb mc md me bi translated">试验模型</li><li id="4a7c" class="lw lx iq jt b ju mf jy mg kp mh kq mi kr mj ko mb mc md me bi translated">在生产中运行模型</li><li id="1acb" class="lw lx iq jt b ju mf jy mg kp mh kq mi kr mj ko mb mc md me bi translated">获取新数据(并重复)</li></ul><p id="4c0b" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">现在，对于一个移动应用程序，这个过程看起来像:</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mk"><img src="../Images/c574153b8e214ae5ff3a9e3d4281e8c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mku-ERns_oU0OvpYNlnq1g.png"/></div></div></figure><p id="111c" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">在上图中，移动应用程序似乎使用了 ML 创建的模型，但它是如何工作的呢？是的，这就是核心 ML 发挥作用的地方。</p><h1 id="e633" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">CoreML 怎么用？</h1><p id="ae63" class="pw-post-body-paragraph jq jr iq jt b ju lr jw jx jy ls ka kb kp lt ke kf kq lu ki kj kr lv km kn ko ij bi translated">核心 ML 是苹果公司的新机器学习框架。它为苹果设备带来了机器学习模型，并使开发人员能够轻松利用 ML。我们可以使用苹果或 c 准备的十几个模型<a class="ae ks" href="https://medium.com/towards-data-science/introduction-to-core-ml-conversion-tool-d1466bf10018" rel="noopener">转换来自流行的 ML 框架的开源模型</a>，如<a class="ae ks" href="https://keras.io/" rel="noopener ugc nofollow" target="_blank"> Keras </a>、<a class="ae ks" href="http://caffe.berkeleyvision.org/" rel="noopener ugc nofollow" target="_blank"> Caffe </a>或<a class="ae ks" href="http://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank"> scikit-learn </a>。</p><p id="3bfd" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">使用 CoreML 创建 IOS 应用程序的工作流程如下:</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi mw"><img src="../Images/c1a91966d1d3393a5af624d2fdd58dde.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2ZnWDYFDhoM3QStBoghWeA.png"/></div></div></figure><p id="ba4a" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">1-你需要使用一些 ML 框架创建一个数据模型，比如 Caffe，turi，Keras 等等。</p><p id="c11c" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">2-为了安装名为 Core ML Tools 的 Python 框架，它将数据模型转换为 Core ML 格式。转换的结果是一个扩展名为<strong class="jt ir"> <em class="js"> mlmodel </em> </strong>的文件。</p><p id="5de0" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">3-就是这样，你用核心 ML 工具创建的模型，在你的移动应用程序中使用它。</p><h1 id="3762" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">软件要求</h1><p id="9d5c" class="pw-post-body-paragraph jq jr iq jt b ju lr jw jx jy ls ka kb kp lt ke kf kq lu ki kj kr lv km kn ko ij bi translated">为了训练模型，我们需要一个 ML 框架。最流行的是谷歌开发的<a class="ae ks" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"> Tensorflow </a>。它拥有来自社区、教程和大量开发者关注的最好支持。然而，当你更深入一点时，你可能会在 G <a class="ae ks" href="https://github.com/tensorflow/tensorflow/issues" rel="noopener ugc nofollow" target="_blank"> ithub issue page </a>或处理一些数学问题或未记录代码的堆栈溢出中结束。与 web 应用程序或移动开发相比，ML 仍然是一个小婴儿，作为开发人员，你需要依赖它。安排一些额外的时间迷失在神秘的 ML 中。从像<a class="ae ks" href="https://keras.io/" rel="noopener ugc nofollow" target="_blank"> Keras </a>这样的高级库开始也更容易。你可以在文章末尾查看一些培训教程的链接。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/f1f40685dd149ebe5fba2f7cca63cef5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*_CogA9qAZGjsLFFUpRy4OA.png"/></div><figcaption class="my mz gj gh gi na nb bd b be z dk">Tensorflow and Keras are the most common ML libraries</figcaption></figure><h1 id="723f" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">五金器具</h1><p id="3663" class="pw-post-body-paragraph jq jr iq jt b ju lr jw jx jy ls ka kb kp lt ke kf kq lu ki kj kr lv km kn ko ij bi translated">很多人说我们需要一个 GPU 来训练一个模型。对于需要高精度或一些网络架构调整的项目来说，这是事实。如果我们需要 10 个类别的图像分类器，那么我们可以利用迁移学习，在标准 CPU 上在 10 分钟内微调我们的模型。然而，对于真正的生产应用程序，我们通常需要 GPU 的性能。我们已经尝试了几家云提供商，亚马逊 AWS g 2.2x 大型实例是一个不错的选择</p><h1 id="6e04" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">开始吧！！</h1><p id="8597" class="pw-post-body-paragraph jq jr iq jt b ju lr jw jx jy ls ka kb kp lt ke kf kq lu ki kj kr lv km kn ko ij bi translated">至此，您已经知道了使用机器学习创建 IOS 应用程序所需的必备工具，让我们开始吧！</p><h2 id="f502" class="nc ku iq bd kv nd ne dn kz nf ng dp ld kp nh ni lh kq nj nk ll kr nl nm lp nn bi translated">管道设置:</h2><p id="53a0" class="pw-post-body-paragraph jq jr iq jt b ju lr jw jx jy ls ka kb kp lt ke kf kq lu ki kj kr lv km kn ko ij bi translated">要使用核心 ML 工具，第一步是在 Mac 上安装 Python。首先，<a class="ae ks" href="https://www.continuum.io/downloads" rel="noopener ugc nofollow" target="_blank">下载 Anaconda </a>(选择 Python 2.7 版本)。Anaconda 是一种在 Mac 上运行 Python 的超级简单的方法，不会引起任何问题。一旦安装了 Anaconda，就进入终端并键入以下内容:</p><pre class="ml mm mn mo gt no np nq nr aw ns bi"><span id="3557" class="nc ku iq np b gy nt nu l nv nw">conda install python=2.7.13</span><span id="cb55" class="nc ku iq np b gy nx nu l nv nw">conda update python</span></pre><p id="b950" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">下一步是创建一个虚拟环境。在虚拟环境中，你可以用不同版本的 Python 或者其中的包来编写程序。要创建新的虚拟环境，请键入以下代码行。</p><pre class="ml mm mn mo gt no np nq nr aw ns bi"><span id="300b" class="nc ku iq np b gy nt nu l nv nw">conda create --name handwriting</span></pre><p id="9125" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">当终端提示您时，</p><pre class="ml mm mn mo gt no np nq nr aw ns bi"><span id="3625" class="nc ku iq np b gy nt nu l nv nw">proceed ([y]/n)?</span></pre><p id="0629" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">键入“y”表示是。恭喜你。现在，您有了一个名为手写的虚拟环境！</p><p id="8096" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">要激活该环境，请使用:<code class="fe ny nz oa np b">source activate handwriting</code></p><p id="0313" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">最后，键入以下命令来安装核心 ML 工具和 Kera 的依赖项:</p><pre class="ml mm mn mo gt no np nq nr aw ns bi"><span id="6240" class="nc ku iq np b gy nt nu l nv nw">conda install pandas matplotlib jupyter notebook scipy opencv</span><span id="276b" class="nc ku iq np b gy nx nu l nv nw">pip install -U scikit-learn==0.15<br/>pip install -U coremltools<br/>pip install tensorflow==1.1<br/>pip install keras==2.0.6<br/>pip install h5py</span></pre><h2 id="416a" class="nc ku iq bd kv nd ne dn kz nf ng dp ld kp nh ni lh kq nj nk ll kr nl nm lp nn bi translated">设计和培训网络</h2><p id="afdd" class="pw-post-body-paragraph jq jr iq jt b ju lr jw jx jy ls ka kb kp lt ke kf kq lu ki kj kr lv km kn ko ij bi translated">在这篇文章中，正如你注意到的，我将使用 Kera，就像我们例子中的 ML 框架一样。</p><p id="c85d" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">好了，你应该创建一个名为<code class="fe ny nz oa np b">train.py</code>的 python 文件。在<code class="fe ny nz oa np b">train.py</code>内插入以下代码:</p><ul class=""><li id="f190" class="lw lx iq jt b ju jv jy jz kp ly kq lz kr ma ko mb mc md me bi translated">首先让我们导入一些必要的库，并确保 TensorFlow 中的 keras 后端:</li></ul><pre class="ml mm mn mo gt no np nq nr aw ns bi"><span id="0728" class="nc ku iq np b gy nt nu l nv nw"><strong class="np ir">import</strong> <!-- -->numpy as np</span><span id="b564" class="nc ku iq np b gy nx nu l nv nw"><strong class="np ir">import</strong> <!-- -->keras</span><span id="e92a" class="nc ku iq np b gy nx nu l nv nw"><strong class="np ir">from</strong> <!-- -->keras.datasets <strong class="np ir">import</strong> <!-- -->mnist</span><span id="42e4" class="nc ku iq np b gy nx nu l nv nw"><strong class="np ir">from</strong> <!-- -->keras.models <strong class="np ir">import</strong> <!-- -->Sequential</span><span id="82c8" class="nc ku iq np b gy nx nu l nv nw"><strong class="np ir">from</strong> <!-- -->keras.layers <strong class="np ir">import</strong> <!-- -->Dense, Dropout, Flatten</span><span id="241b" class="nc ku iq np b gy nx nu l nv nw"><strong class="np ir">from</strong> <!-- -->keras.layers.convolutional <strong class="np ir">import</strong> <!-- -->Conv2D, MaxPooling2D</span><span id="a937" class="nc ku iq np b gy nx nu l nv nw"><strong class="np ir">from</strong> <!-- -->keras.utils <strong class="np ir">import</strong> <!-- -->np_utils</span><span id="f398" class="nc ku iq np b gy nx nu l nv nw"># (Making sure) Set backend as tensorflow</span><span id="957c" class="nc ku iq np b gy nx nu l nv nw"><strong class="np ir">from</strong> <!-- -->keras <strong class="np ir">import</strong> <!-- -->backend as K</span><span id="0d1c" class="nc ku iq np b gy nx nu l nv nw">K.set_image_dim_ordering('tf')</span></pre><ul class=""><li id="9390" class="lw lx iq jt b ju jv jy jz kp ly kq lz kr ma ko mb mc md me bi translated">现在让我们为训练和测试准备数据集。</li></ul><pre class="ml mm mn mo gt no np nq nr aw ns bi"><span id="e647" class="nc ku iq np b gy nt nu l nv nw"># Define some variables</span><span id="ead7" class="nc ku iq np b gy nx nu l nv nw">num_rows <strong class="np ir">=</strong> <!-- -->28</span><span id="05df" class="nc ku iq np b gy nx nu l nv nw">num_cols <strong class="np ir">=</strong> <!-- -->28</span><span id="6b3b" class="nc ku iq np b gy nx nu l nv nw">num_channels <strong class="np ir">=</strong> <!-- -->1</span><span id="a594" class="nc ku iq np b gy nx nu l nv nw">num_classes <strong class="np ir">=</strong> <!-- -->10</span><span id="26d0" class="nc ku iq np b gy nx nu l nv nw"># Import data</span><span id="baff" class="nc ku iq np b gy nx nu l nv nw">(X_train, y_train), (X_test, y_test) <strong class="np ir">=</strong> <!-- -->mnist.load_data()</span><span id="553b" class="nc ku iq np b gy nx nu l nv nw">X_train <strong class="np ir">=</strong> <!-- -->X_train.reshape(X_train.shape[0], num_rows, num_cols, num_channels).astype(np.float32) <strong class="np ir">/</strong> <!-- -->255</span><span id="006f" class="nc ku iq np b gy nx nu l nv nw">X_test <strong class="np ir">=</strong> <!-- -->X_test.reshape(X_test.shape[0], num_rows, num_cols, num_channels).astype(np.float32) <strong class="np ir">/</strong> <!-- -->255</span><span id="8c15" class="nc ku iq np b gy nx nu l nv nw">y_train <strong class="np ir">=</strong> <!-- -->np_utils.to_categorical(y_train)</span><span id="8aad" class="nc ku iq np b gy nx nu l nv nw">y_test <strong class="np ir">=</strong> <!-- -->np_utils.to_categorical(y_test)</span></pre><ul class=""><li id="5124" class="lw lx iq jt b ju jv jy jz kp ly kq lz kr ma ko mb mc md me bi translated">设计培训模型。</li></ul><pre class="ml mm mn mo gt no np nq nr aw ns bi"><span id="f0a4" class="nc ku iq np b gy nt nu l nv nw"># Model</span><span id="1e0e" class="nc ku iq np b gy nx nu l nv nw">model <strong class="np ir">=</strong> <!-- -->Sequential()</span><span id="1838" class="nc ku iq np b gy nx nu l nv nw">model.add(Conv2D(32, (5, 5), input_shape<strong class="np ir">=</strong>(28, 28, 1), activation<strong class="np ir">=</strong>'relu'))</span><span id="27a4" class="nc ku iq np b gy nx nu l nv nw">model.add(MaxPooling2D(pool_size<strong class="np ir">=</strong>(2, 2)))</span><span id="c9a4" class="nc ku iq np b gy nx nu l nv nw">model.add(Dropout(0.5))</span><span id="d819" class="nc ku iq np b gy nx nu l nv nw">model.add(Conv2D(64, (3, 3), activation<strong class="np ir">=</strong>'relu'))</span><span id="7320" class="nc ku iq np b gy nx nu l nv nw">model.add(MaxPooling2D(pool_size<strong class="np ir">=</strong>(2, 2)))</span><span id="7f18" class="nc ku iq np b gy nx nu l nv nw">model.add(Dropout(0.2))</span><span id="0eeb" class="nc ku iq np b gy nx nu l nv nw">model.add(Conv2D(128, (1, 1), activation<strong class="np ir">=</strong>'relu'))</span><span id="3df3" class="nc ku iq np b gy nx nu l nv nw">model.add(MaxPooling2D(pool_size<strong class="np ir">=</strong>(2, 2)))</span><span id="b5b3" class="nc ku iq np b gy nx nu l nv nw">model.add(Dropout(0.2))</span><span id="77f2" class="nc ku iq np b gy nx nu l nv nw">model.add(Flatten())</span><span id="24d7" class="nc ku iq np b gy nx nu l nv nw">model.add(Dense(128, activation<strong class="np ir">=</strong>'relu'))</span><span id="c800" class="nc ku iq np b gy nx nu l nv nw">model.add(Dense(num_classes, activation<strong class="np ir">=</strong>'softmax'))</span><span id="b67c" class="nc ku iq np b gy nx nu l nv nw">model.compile(loss<strong class="np ir">=</strong>'categorical_crossentropy', optimizer<strong class="np ir">=</strong>'adam', metrics<strong class="np ir">=</strong>['accuracy'])</span></pre><ul class=""><li id="98e1" class="lw lx iq jt b ju jv jy jz kp ly kq lz kr ma ko mb mc md me bi translated">训练模型。</li></ul><pre class="ml mm mn mo gt no np nq nr aw ns bi"><span id="a4b8" class="nc ku iq np b gy nt nu l nv nw"># Training</span><span id="ed88" class="nc ku iq np b gy nx nu l nv nw">model.fit(X_train, y_train, validation_data<strong class="np ir">=</strong>(X_test, y_test), epochs<strong class="np ir">=</strong>10, batch_size<strong class="np ir">=</strong>200, verbose<strong class="np ir">=</strong>2)</span></pre><ul class=""><li id="1f89" class="lw lx iq jt b ju jv jy jz kp ly kq lz kr ma ko mb mc md me bi translated">通过移除缺失层为推理准备模型。</li></ul><pre class="ml mm mn mo gt no np nq nr aw ns bi"><span id="1131" class="nc ku iq np b gy nt nu l nv nw"># Prepare model for inference</span><span id="fb02" class="nc ku iq np b gy nx nu l nv nw"><strong class="np ir">for</strong> <!-- -->k <strong class="np ir">in</strong> <!-- -->model.layers:</span><span id="2da4" class="nc ku iq np b gy nx nu l nv nw"><strong class="np ir">if</strong> <!-- -->type(k) <strong class="np ir">is</strong> <!-- -->keras.layers.Dropout:</span><span id="cc67" class="nc ku iq np b gy nx nu l nv nw">model.layers.remove(k)</span></pre><ul class=""><li id="c299" class="lw lx iq jt b ju jv jy jz kp ly kq lz kr ma ko mb mc md me bi translated">最后保存模型。</li></ul><pre class="ml mm mn mo gt no np nq nr aw ns bi"><span id="97dd" class="nc ku iq np b gy nt nu l nv nw">model.save('<!-- -->handWritten<!-- -->.h5')</span></pre><p id="c59e" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">然后，转到您之前打开的终端，键入以下内容:</p><pre class="ml mm mn mo gt no np nq nr aw ns bi"><span id="8ff0" class="nc ku iq np b gy nt nu l nv nw">python train.py</span></pre><p id="563c" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">它将创建一个名为<strong class="jt ir"> <em class="js">手写的数据模型。</em></strong></p><h2 id="62dc" class="nc ku iq bd kv nd ne dn kz nf ng dp ld kp nh ni lh kq nj nk ll kr nl nm lp nn bi translated">Keras 到 CoreML</h2><p id="de98" class="pw-post-body-paragraph jq jr iq jt b ju lr jw jx jy ls ka kb kp lt ke kf kq lu ki kj kr lv km kn ko ij bi translated">要将您的模型从 Keras 转换到 CoreML，我们需要做一些额外的步骤。我们的深度学习模型期望 28×28 归一化灰度图像，并给出类别预测的概率作为输出。此外，让我们添加更多的信息到我们的模型，如许可证，作者等。让我们创建一个名为<code class="fe ny nz oa np b">convert.py</code>的文件，并插入以下代码:</p><pre class="ml mm mn mo gt no np nq nr aw ns bi"><span id="a3c0" class="nc ku iq np b gy nt nu l nv nw">import coremltools</span><span id="f13a" class="nc ku iq np b gy nx nu l nv nw">output_labels = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9']</span><span id="3061" class="nc ku iq np b gy nx nu l nv nw">scale = 1/255.</span><span id="81d8" class="nc ku iq np b gy nx nu l nv nw">coreml_model = coremltools.converters.keras.convert('./handWritten.h5',</span><span id="0cd3" class="nc ku iq np b gy nx nu l nv nw">input_names='image',</span><span id="994e" class="nc ku iq np b gy nx nu l nv nw">image_input_names='image',</span><span id="3e01" class="nc ku iq np b gy nx nu l nv nw">output_names='output',</span><span id="2f0e" class="nc ku iq np b gy nx nu l nv nw">class_labels= output_labels,</span><span id="90cc" class="nc ku iq np b gy nx nu l nv nw">image_scale=scale)</span><span id="a4d6" class="nc ku iq np b gy nx nu l nv nw">coreml_model.author = 'Gerardo Lopez Falcon'</span><span id="8e3c" class="nc ku iq np b gy nx nu l nv nw">coreml_model.license = 'MIT'</span><span id="5b59" class="nc ku iq np b gy nx nu l nv nw">coreml_model.short_description = 'Model to classify hand written digit'</span><span id="c8a3" class="nc ku iq np b gy nx nu l nv nw">coreml_model.input_description['image'] = 'Grayscale image of hand written digit'</span><span id="c9fe" class="nc ku iq np b gy nx nu l nv nw">coreml_model.output_description['output'] = 'Predicted digit'</span><span id="1305" class="nc ku iq np b gy nx nu l nv nw"><br/>coreml_model.save('handWritten.mlmodel')</span></pre><p id="44ed" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">回到终端，键入以下内容:<code class="fe ny nz oa np b">python convert.py</code>。它为我们创建了一个名为 handled . ml model 的文件(现在，我们可以在 IOS 应用程序中使用这个文件)。</p><h2 id="a7a4" class="nc ku iq bd kv nd ne dn kz nf ng dp ld kp nh ni lh kq nj nk ll kr nl nm lp nn bi translated">将模型集成到 Xcode 中</h2><p id="e258" class="pw-post-body-paragraph jq jr iq jt b ju lr jw jx jy ls ka kb kp lt ke kf kq lu ki kj kr lv km kn ko ij bi translated">现在我们到了最后一步，将刚刚转换的模型集成到 Xcode 项目中。打开<a class="ae ks" href="https://github.com/gelopfalcon/handWritting" rel="noopener ugc nofollow" target="_blank"> starter 项目</a>，根据您目前所学，我要求您将核心 ML 模型集成到应用程序中。</p><p id="5084" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">第一步是将<code class="fe ny nz oa np b">handWritten.mlmodel </code>拖放到我们的 Xcode 项目中。确保选中了目标成员资格框。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi ob"><img src="../Images/83b0149f26342b3a96d01c8dc011f66a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SEPsZ1-pqXhn5dKhDLd9Fw.png"/></div></div></figure><p id="1710" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">现在，转到下面实例化 IBOutlet 的 ViewController，并从手写类型创建一个对象:</p><pre class="ml mm mn mo gt no np nq nr aw ns bi"><span id="f4f3" class="nc ku iq np b gy nt nu l nv nw">let model = handWritten()</span></pre><p id="4dfc" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">之后，进入<code class="fe ny nz oa np b">let pixelBuffer = .....</code>插件下方的 tappedDetect 功能:</p><pre class="ml mm mn mo gt no np nq nr aw ns bi"><span id="df10" class="nc ku iq np b gy nt nu l nv nw">let output = try? model.prediction(image: pixelBuffer!)</span></pre><p id="4a25" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">我们刚刚定义了常数预测等于模型预测的数据。</p><p id="ed9d" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">仅此而已！构建并运行应用程序。这些是应用程序在 iPhone 7 上测试的结果。</p><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi oc"><img src="../Images/1d6c6c327a08126dcc07a2b7bc8ce879.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zXXqMm2ZYv6TrPsxFsV6-g.png"/></div></div></figure><figure class="ml mm mn mo gt mp gh gi paragraph-image"><div role="button" tabindex="0" class="mq mr di ms bf mt"><div class="gh gi od"><img src="../Images/d165a696ebeef0ab8ecfaa31cce756b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xfAkMaDCQegdGoBaQuUYGQ.png"/></div></div></figure><h1 id="6fd9" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">结论</h1><p id="1432" class="pw-post-body-paragraph jq jr iq jt b ju lr jw jx jy ls ka kb kp lt ke kf kq lu ki kj kr lv km kn ko ij bi translated">既然您已经知道了如何转换数据模型，那么您可能想知道在哪里可以找到数据模型。一个简单的谷歌搜索会给你大量的结果。您可以找到几乎任何类别的数据模型，例如不同类型的汽车、植物、动物，甚至还有一个模型可以告诉您最像哪个名人。这里有几个地方可以让你开始！</p><ul class=""><li id="a894" class="lw lx iq jt b ju jv jy jz kp ly kq lz kr ma ko mb mc md me bi translated"><a class="ae ks" href="https://github.com/BVLC/caffe/wiki/Model-Zoo" rel="noopener ugc nofollow" target="_blank">咖啡馆模型动物园</a></li><li id="a2b6" class="lw lx iq jt b ju mf jy mg kp mh kq mi kr mj ko mb mc md me bi translated"><a class="ae ks" href="https://archive.ics.uci.edu/ml/datasets.html" rel="noopener ugc nofollow" target="_blank"> UCI 机器学习知识库</a></li><li id="c225" class="lw lx iq jt b ju mf jy mg kp mh kq mi kr mj ko mb mc md me bi translated"><a class="ae ks" href="http://deeplearning.net/datasets/" rel="noopener ugc nofollow" target="_blank">深度学习数据集</a></li></ul><p id="f2e8" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">如果您找不到支持您需求的模型，您可能想知道是否可以创建自己的数据模型。这是可以做到的，但很难做到。如果你觉得自己已经准备好迎接挑战，我建议你从 Scikit-Learn 或 TensorFlow 的主页开始。</p><p id="180f" class="pw-post-body-paragraph jq jr iq jt b ju jv jw jx jy jz ka kb kp kd ke kf kq kh ki kj kr kl km kn ko ij bi translated">谢谢分享，如果你能把这篇文章分享给其他人，我会很感激的。我希望你的掌声:D</p></div></div>    
</body>
</html>