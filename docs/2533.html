<html>
<head>
<title>Setting Up Twitter for Text mining in R.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在 r 中为文本挖掘设置 Twitter。</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/setting-up-twitter-for-text-mining-in-r-bcfc5ba910f4?source=collection_archive---------4-----------------------#2018-02-05">https://towardsdatascience.com/setting-up-twitter-for-text-mining-in-r-bcfc5ba910f4?source=collection_archive---------4-----------------------#2018-02-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/ac7f80a37d4b9502c21d1295e1c06ee7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*y1SxH-0q0NpSZDIyPLwSpg.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo Credit : <a class="ae kc" href="https://pixabay.com/en/twitter-line-power-line-sit-2713571/" rel="noopener ugc nofollow" target="_blank">Pixabay</a></figcaption></figure><h2 id="beca" class="kd ke iq bd kf kg kh dn ki kj kk dp kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">介绍</h2><p id="d529" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj km lk ll lm kq ln lo lp ku lq lr ls lt ij bi translated">多年来，社交媒体已经成为数据挖掘的热点。每天都有话题趋势、活动进行和人们讨论不同的全球、大陆或国家问题。这是利用数据的一个主要目标。</p><p id="66d9" class="pw-post-body-paragraph kz la iq lb b lc lu le lf lg lv li lj km lw ll lm kq lx lo lp ku ly lr ls lt ij bi translated">在这篇文章中，我们把 Twitter 作为全球观点和情感的中心。我们开始从每天发布的数百万条推文中挖掘文本，以便能够理解正在发生的事情，甚至超越我们自己的时间线。</p><h2 id="401d" class="kd ke iq bd kf kg kh dn ki kj kk dp kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">Twitter API 设置</h2><p id="211e" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj km lk ll lm kq ln lo lp ku lq lr ls lt ij bi translated">要使用 twitter API，我们需要有一个 twitter 帐户。<br/>通过<a class="ae kc" href="https://twitter.com" rel="noopener ugc nofollow" target="_blank">https://twitter.com</a>注册，前往<a class="ae kc" href="https://apps.twitter.com/" rel="noopener ugc nofollow" target="_blank">https://apps.twitter.com/</a>访问 twitter 开发者选项。</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lz"><img src="../Images/7836b6cd11cef1475984039e6b4cf01a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UcvlcwBTh3Ubes8lpqf8tQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Click create New App</figcaption></figure><p id="e3eb" class="pw-post-body-paragraph kz la iq lb b lc lu le lf lg lv li lj km lw ll lm kq lx lo lp ku ly lr ls lt ij bi translated">创建新的应用程序</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lz"><img src="../Images/a60f8e86555b8e087c6156e2de7dfc8e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k932jZDx08KhBdzSKMipFg.png"/></div></div></figure><p id="2686" class="pw-post-body-paragraph kz la iq lb b lc lu le lf lg lv li lj km lw ll lm kq lx lo lp ku ly lr ls lt ij bi translated"><strong class="lb ir">应用程序名称:</strong>给你的应用程序一个唯一的名称。如果被占用，将通知您进行更改。<br/> <strong class="lb ir">应用程序站点:</strong>如果你的应用程序还没有站点，这可以是一个到你的 Github 存储库的链接，应用程序代码就在那里。(像我一样)<br/> <strong class="lb ir">回调 URL: </strong>这是一个链接，成功或失败的消息从一个程序中继到另一个程序。它告诉程序在这两种情况下下一步去哪里。您可以将您的应用程序定向到任何可用的端口，我的端口是 1410。</p><h2 id="a153" class="kd ke iq bd kf kg kh dn ki kj kk dp kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">应用凭据</h2><p id="b7e8" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj km lk ll lm kq ln lo lp ku lq lr ls lt ij bi translated">这些对于帮助用户登录应用程序非常重要。<br/>此设置中使用了四种主要凭证。<br/> <strong class="lb ir">消费者密钥:</strong>该密钥向应用程序标识客户端。<br/> <strong class="lb ir">消费者密码:</strong>这是用于服务器验证的客户端密码。<br/> <strong class="lb ir">访问令牌:</strong>这是用来定义用户权限的用户标识。<br/> <strong class="lb ir">访问密码:</strong>这是用访问令牌作为密码发送的。&lt;/李&gt; <br/>他们就是这样获得的。</p><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi me"><img src="../Images/449194fbed819c1b027dbafab78fde4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rHaEis4CDOpGzmmgfRc-Og.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">App credentials</figcaption></figure><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mf"><img src="../Images/6565690c74d4f5e59ab677416f6674b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XxhAH8uq-g-f5tOW2r4Wlw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Generating Tokens</figcaption></figure><figure class="ma mb mc md gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mg"><img src="../Images/d6340195de727b99669c7fa90f44fe4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ez9X57oj2Igt0oxb1Qjf7g.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">App Tokens</figcaption></figure><p id="4528" class="pw-post-body-paragraph kz la iq lb b lc lu le lf lg lv li lj km lw ll lm kq lx lo lp ku ly lr ls lt ij bi translated">注意:这些证书应该是保密的，这就是为什么我在我的证书上画了阴影。瞧吧！我们设置了一个 API</p><h2 id="d2a5" class="kd ke iq bd kf kg kh dn ki kj kk dp kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">r 工作室成立</h2><p id="26eb" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj km lk ll lm kq ln lo lp ku lq lr ls lt ij bi translated">R 使用了<strong class="lb ir"> twitteR </strong>库，这是一个基于 R 的 twitteR 客户端，处理与 Twitter API 的通信。让我们花点时间感谢杰夫·金特里把这个图书馆建起来。</p><p id="9135" class="pw-post-body-paragraph kz la iq lb b lc lu le lf lg lv li lj km lw ll lm kq lx lo lp ku ly lr ls lt ij bi translated">现在继续使用下面的代码安装这个库。</p><pre class="ma mb mc md gt mh mi mj mk aw ml bi"><span id="8419" class="kd ke iq mi b gy mm mn l mo mp">#from CRAN<br/>install.packages(“twitteR”)</span><span id="5c7f" class="kd ke iq mi b gy mq mn l mo mp">#alternatively from the Github<br/>library(devtools)<br/>install_github(“geoffjentry/twitteR”)</span></pre><p id="a7a3" class="pw-post-body-paragraph kz la iq lb b lc lu le lf lg lv li lj km lw ll lm kq lx lo lp ku ly lr ls lt ij bi translated">上述两种方法的区别在于，第一种方法从 CRAN 站点下载包，并接受包名参数，而第二种方法从 GitHub 库安装包，并接受库名参数。点击阅读更多关于软件包和安装的信息<a class="ae kc" href="https://www.datacamp.com/community/tutorials/r-packages-guide" rel="noopener ugc nofollow" target="_blank">。</a></p><h2 id="55fb" class="kd ke iq bd kf kg kh dn ki kj kk dp kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">证明</h2><p id="4c33" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj km lk ll lm kq ln lo lp ku lq lr ls lt ij bi translated">Twitter 使用开放认证(OAuth)来授权访问信息。开放式身份验证是一种基于令牌的身份验证方法。我们来参考一下我们的四个凭据。</p><p id="ceed" class="pw-post-body-paragraph kz la iq lb b lc lu le lf lg lv li lj km lw ll lm kq lx lo lp ku ly lr ls lt ij bi translated"><strong class="lb ir">第一步</strong></p><pre class="ma mb mc md gt mh mi mj mk aw ml bi"><span id="0093" class="kd ke iq mi b gy mm mn l mo mp">#load library<br/>library(twitteR)</span><span id="410b" class="kd ke iq mi b gy mq mn l mo mp">#load credentials<br/>consumer_key &lt;- “****************”<br/>consumer_secret&lt;- “*******************”<br/>access_token &lt;- “*******************”<br/>access_secret &lt;- “************************”<br/></span></pre><p id="9e92" class="pw-post-body-paragraph kz la iq lb b lc lu le lf lg lv li lj km lw ll lm kq lx lo lp ku ly lr ls lt ij bi translated"><strong class="lb ir">第二步</strong></p><p id="d9bb" class="pw-post-body-paragraph kz la iq lb b lc lu le lf lg lv li lj km lw ll lm kq lx lo lp ku ly lr ls lt ij bi translated">我们使用<strong class="lb ir"> setup_twitter_oauth </strong>函数来设置我们的认证。<strong class="lb ir"> setup_twitter_oauth() </strong>函数接收我们从上面设置的 API 生成的四个 twitter 凭证。</p><pre class="ma mb mc md gt mh mi mj mk aw ml bi"><span id="08dd" class="kd ke iq mi b gy mm mn l mo mp"><br/>#set up to authenticate<br/>setup_twitter_oauth(consumer_key ,consumer_secret,access_token ,access_secret)</span></pre><figure class="ma mb mc md gt jr gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/f1e0f95771b52b6ef84a0261eb6f601c.png" data-original-src="https://miro.medium.com/v2/resize:fit:742/format:webp/1*q7-TeToUNiHVtUFSim9_BQ.png"/></div></figure><p id="c991" class="pw-post-body-paragraph kz la iq lb b lc lu le lf lg lv li lj km lw ll lm kq lx lo lp ku ly lr ls lt ij bi translated">请按键盘上的 Y 键授权直接认证。</p><h2 id="670b" class="kd ke iq bd kf kg kh dn ki kj kk dp kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">查询 Twitter</h2><p id="a412" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj km lk ll lm kq ln lo lp ku lq lr ls lt ij bi translated">质疑就是简单地问一个问题。为了能够访问我们需要的数据，我们必须向 twitter 发送有意义的查询。有了 Twitter，我们可以获得从趋势、活动到账户的大量信息。我们有一系列的问题要问。<br/>让我们在这个标签#rstats 上运行查询</p><pre class="ma mb mc md gt mh mi mj mk aw ml bi"><span id="64fc" class="kd ke iq mi b gy mm mn l mo mp">#fetch tweets associated with that hashtag , 12 tweets-n in <br/>#(en)glish-lang since the indicated date yy/mm/dd</span><span id="c379" class="kd ke iq mi b gy mq mn l mo mp">tweets &lt;- twitteR::searchTwitter(“#rstats”,n =12,lang =”en”,since = ‘2018–01–01’)</span><span id="848d" class="kd ke iq mi b gy mq mn l mo mp">#strip retweets<br/>strip_retweets(tweets)</span></pre><p id="b1a9" class="pw-post-body-paragraph kz la iq lb b lc lu le lf lg lv li lj km lw ll lm kq lx lo lp ku ly lr ls lt ij bi translated">这段代码以列表的形式返回推文。<strong class="lb ir"> strip_retweets() </strong>函数删除返回的 tweets 中的任何 retweets。</p><p id="2547" class="pw-post-body-paragraph kz la iq lb b lc lu le lf lg lv li lj km lw ll lm kq lx lo lp ku ly lr ls lt ij bi translated">为了进一步分析这些推文，我们将考虑将返回的推文转换为数据帧，并在本地存储它们。</p><pre class="ma mb mc md gt mh mi mj mk aw ml bi"><span id="f140" class="kd ke iq mi b gy mm mn l mo mp">#convert to data frame using the twListtoDF function<br/>df &lt;- twListToDF(tweets)\#extract the data frame save it locally<br/>saveRDS(df, file=”tweets.rds”)<br/>df1 &lt;- readRDS(“mytweets.rds”)</span></pre><h2 id="ab68" class="kd ke iq bd kf kg kh dn ki kj kk dp kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">清理推文</h2><p id="d4ef" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj km lk ll lm kq ln lo lp ku lq lr ls lt ij bi translated">通过查询，我们已经设法将结果存储到计算机上的数据框中。现在让我们检查这些数据，找出谁的转发量最高，并直接从我们的脚本中给他们一个大喊。<br/>我们将使用<strong class="lb ir"> dplyr </strong>库遍历该数据帧。</p><pre class="ma mb mc md gt mh mi mj mk aw ml bi"><span id="9f83" class="kd ke iq mi b gy mm mn l mo mp"><br/>library(dplyr)</span><span id="da80" class="kd ke iq mi b gy mq mn l mo mp">#clean up any duplicate tweets from the data frame using #dplyr::distinct</span><span id="e34f" class="kd ke iq mi b gy mq mn l mo mp">dplyr::distinct(df1)</span></pre><p id="95a5" class="pw-post-body-paragraph kz la iq lb b lc lu le lf lg lv li lj km lw ll lm kq lx lo lp ku ly lr ls lt ij bi translated">让我们利用 dplyr 动词来选择转发次数最多的 tweet 的 tweet、昵称、id 和转发次数，并将结果存储在一个名为 winner 的数据帧中。</p><pre class="ma mb mc md gt mh mi mj mk aw ml bi"><span id="ca75" class="kd ke iq mi b gy mm mn l mo mp">winner &lt;-df1 %&gt;% select(text,retweetCount,screenName,id )%&gt;% filter(retweetCount == max(retweetCount))<br/>View(winner)</span></pre><p id="664d" class="pw-post-body-paragraph kz la iq lb b lc lu le lf lg lv li lj km lw ll lm kq lx lo lp ku ly lr ls lt ij bi translated">通过此<a class="ae kc" href="https://www.rstudio.com/wp-content/uploads/2015/02/data-wrangling-cheatsheet.pdf" rel="noopener ugc nofollow" target="_blank">备忘单</a>查看更多关于<strong class="lb ir"> dplyr </strong>的信息。</p><h2 id="3175" class="kd ke iq bd kf kg kh dn ki kj kk dp kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">发送直接信息</h2><p id="ef3a" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj km lk ll lm kq ln lo lp ku lq lr ls lt ij bi translated">为了通知我们的转发竞赛获胜者，我们将通过从获胜者数据帧中选取他们的句柄，从该脚本中向他们发送一条直接消息。<br/><strong class="lb ir">DM send()</strong>函数接收保存为屏幕名称的消息和用户名。</p><pre class="ma mb mc md gt mh mi mj mk aw ml bi"><span id="59ea" class="kd ke iq mi b gy mm mn l mo mp">us &lt;- userFactory$new(screenName= winner$screenName)<br/>dmSend(“Thank you for participating in #rstats,Your tweet had the highest retweets” , us$screenName)</span></pre><h2 id="c9d9" class="kd ke iq bd kf kg kh dn ki kj kk dp kl km kn ko kp kq kr ks kt ku kv kw kx ky bi translated">结论</h2><p id="ca6f" class="pw-post-body-paragraph kz la iq lb b lc ld le lf lg lh li lj km lk ll lm kq ln lo lp ku lq lr ls lt ij bi translated">我们刚刚从 twitter 中创建了第一个挖掘数据集，并使用它来找出我们的转发比赛获胜者。嗯，这只是我们能做的一个小例子，然而，有一个专栏包含来自挖掘的推文的文本，可以使用这个<a class="ae kc" href="https://medium.com/@lornamariak" rel="noopener">博客</a>上以前文章的技术来分析这些文本。</p><p id="83ca" class="pw-post-body-paragraph kz la iq lb b lc lu le lf lg lv li lj km lw ll lm kq lx lo lp ku ly lr ls lt ij bi translated">这种挖掘的数据有更多的可能性，如情感分析和词频可视化。<br/>我建议你通过这个 GitHub <a class="ae kc" href="https://github.com/lornamariak/TextMinningR" rel="noopener ugc nofollow" target="_blank">库</a>查看一个 twitter 文本挖掘的实例。<br/>关于本文的任何进一步的问题和评论，请通过 twitter 问我<a class="ae kc" href="http://twitter.com/lornamariak" rel="noopener ugc nofollow" target="_blank"> @lornamariak </a>。<br/>微博挖掘快乐！</p></div></div>    
</body>
</html>