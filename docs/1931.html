<html>
<head>
<title>Is Santa Claus Real?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">圣诞老人是真的吗？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/is-santa-claus-real-9b7b9839776c?source=collection_archive---------1-----------------------#2017-11-18">https://towardsdatascience.com/is-santa-claus-real-9b7b9839776c?source=collection_archive---------1-----------------------#2017-11-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="47f6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我的团队非常重视圣诞节和我们收到的礼物。所以，我们想追踪圣诞老人，知道他什么时候给我们送礼物。我们决定在烟囱里放一个摄像头，找到他。最近我们看到了这个<a class="ae kl" href="https://medium.com/towards-data-science/how-to-train-your-own-object-detector-with-tensorflows-object-detector-api-bec72ecfe1d9" rel="noopener">帖子</a>关于如何为你自己的数据集训练 Tensorflow 的对象检测 API，这说服我们把我们的手放在这个很酷的东西上，并试图找到圣诞老人。</p><p id="1df3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">代码可在这个<a class="ae kl" href="https://github.com/turnerlabs/character-finder" rel="noopener ugc nofollow" target="_blank"> github repo </a>获得。从这段代码生成的模型可以扩展到寻找其他角色，无论是动画还是现实生活中的角色。</p><p id="fdda" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是圣诞老人发现者的行动。🎅🏻</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi km"><img src="../Images/883a98e1ef18877196a821e4b13aa211.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*o3IVZQ9NVPrvmxZuV5T0Zw.gif"/></div></figure><h1 id="46cd" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">收集数据</strong></h1><p id="ec9f" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">和任何机器学习模型一样，最重要的方面是数据。因为我们想找到不同类型的圣诞老人、动画、泥塑、装扮成圣诞老人的人，所以我们的训练数据必须多样化。为了收集数据，我们编写了一个流处理器，它使用 VLC 从任何在线来源传输视频并从中捕获帧。流处理器捕获视频中的帧，而不必等待视频加载，即，如果当前播放的视频在 2 秒标记处，则流处理器将从 4 或 5 秒标记处捕获帧。作为奖励，你可以用 ASCII 码观看视频，这是最酷的观看视频的方式🤓。使用流处理器的指令可在<a class="ae kl" href="https://github.com/turnerlabs/stream-processor" rel="noopener ugc nofollow" target="_blank">这里</a>获得。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi km"><img src="../Images/ae1906679dc5f46a141b1586374a4273.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*UdwNuCWm-6yyYEXjrJc1bw.gif"/></div><figcaption class="lx ly gj gh gi lz ma bd b be z dk">Video of Santa Claus surfing in ASCII</figcaption></figure><p id="a2da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里是我们收集的不同类型的圣诞老人图像的一个小集合。所有这些图片都是从 YouTube 上收集的。如你所见，这里有不同种类的动画和真人圣诞老人的图像。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mb"><img src="../Images/02e311bb32551d3301af004492e48e5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hlWKucoLFh2ga4Qv."/></div></div><figcaption class="lx ly gj gh gi lz ma bd b be z dk">Different type of Santas</figcaption></figure><h1 id="c2a7" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">标注数据</strong></h1><p id="2440" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">下一步是标记数据，即围绕圣诞老人的脸画一个边框。标记图像的一个常见选择是使用 labelimg 工具，但是我们使用了一个从这篇<a class="ae kl" href="https://medium.com/alex-attia-blog/the-simpsons-characters-recognition-and-detection-part-2-c44f9d5abf37" rel="noopener">文章</a>引用的自定义脚本。</p><p id="6c65" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要给图像加标签，先点击人物脸部的左上角，然后点击其脸部的右下角。如果图像中没有字符，双击同一点删除图像。该脚本的代码可从<a class="ae kl" href="https://github.com/turnerlabs/character-finder/blob/master/detect_labels.py" rel="noopener ugc nofollow" target="_blank">这里</a>获得。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi km"><img src="../Images/731759235d64749a73ec9958c9f97172.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*H-GwD-j1_6NNutYotyOYZA.gif"/></div></figure><h1 id="bff2" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">创建张量流记录文件</strong></h1><p id="47df" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">将边界框信息存储在 csv 文件中后，下一步是将 csv 文件和图像转换为 TF 记录文件，这是 tensorflow 的对象检测 API 使用的文件格式。将 csv 文件转换成 TF 记录的脚本可以在<a class="ae kl" href="https://github.com/turnerlabs/character-finder/blob/master/object_detection/create_characters_tf_record.py" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="9833" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">还需要一个 protobuf 文本文件，用于将标签名转换为数字 id。对于我们来说，它只是一个类。</p><pre class="kn ko kp kq gt mg mh mi mj aw mk bi"><span id="6e3b" class="ml kv iq mh b gy mm mn l mo mp">item {<br/>id: 1<br/>Name: santa<br/>}</span></pre><h1 id="8d61" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">创建配置文件</strong></h1><p id="232f" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">为了训练，我们使用 faster_rcnn_inception_resnet 配置文件作为基础。我们将配置文件中的类的数量参数更改为 1，因为我们只有一个类——“Santa”，并将输入路径参数更改为指向我们在上一步中创建的 TFrecord。我们使用了 faster _ rcnn _ inception _ resnet 的预训练检查点。我们使用这个模型是因为模型精度比模型训练速度更重要。还有其他模型提供不同的训练速度和准确性，可以在这里找到<a class="ae kl" href="https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/detection_model_zoo.md" rel="noopener ugc nofollow" target="_blank"/>。</p><h1 id="3d24" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated"><strong class="ak">训练</strong></h1><p id="dfde" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">训练代码在我们的本地机器上运行，以检查一切是否正常，一旦正常，它就被部署到谷歌云平台的<a class="ae kl" href="https://cloud.google.com/ml-engine/" rel="noopener ugc nofollow" target="_blank"> ML 引擎</a>。该模型被训练了超过 100，000 步。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi mq"><img src="../Images/5b3e5a69413a7d193854ec8b31c1f9fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/1*L2ruze83yokJv4hC5CJ2XA.gif"/></div><figcaption class="lx ly gj gh gi lz ma bd b be z dk">Animation</figcaption></figure><p id="bb64" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该模型在动画和现实生活中表现都很好。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi km"><img src="../Images/14285512075f45de1ea36a8910c69b8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/1*-s-LawFjEEX2jnKrnwsoUw.gif"/></div><figcaption class="lx ly gj gh gi lz ma bd b be z dk">Real Life</figcaption></figure><h1 id="5754" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">导出模型</h1><p id="8562" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">训练完成后，模型被导出，用于在不同的图像上进行测试。为了导出模型，我们选择了从训练作业中获得的最新检查点，并将其导出到冻结的推理图中。将检查点转换为冻结推理图的脚本可以在<a class="ae kl" href="https://github.com/turnerlabs/character-finder/blob/master/object_detection/export_inference_graph.py" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="4ea4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们还为我们的模型构建了一个网页，它从 google 搜索中提取图像，并试图在返回的图像中找到圣诞老人。该网页上的结果被过滤以显示置信度超过 60%的边界框。这是网页的快照。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mr"><img src="../Images/a2472a5b0000209fa483708b8847c0f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*IgMSKQ49oxSCyzut."/></div></div><figcaption class="lx ly gj gh gi lz ma bd b be z dk">We Found Santa Claus!!</figcaption></figure><h1 id="954a" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">后续步骤</h1><p id="7e5e" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">当训练作业运行时，我们注意到 TotalLoss 很快下降到 1 以下，这意味着模型在寻找圣诞老人方面做得很好。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi ms"><img src="../Images/101c72327f632de4c5c3d706425eb29c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9EAYTFHk_244jphasJMY3Q.png"/></div></div><figcaption class="lx ly gj gh gi lz ma bd b be z dk">TotalLoss</figcaption></figure><p id="eb3b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们知道我们的模型不会完美。虽然模型在相当准确地找到圣诞老人方面做得很好，但我们也有假阳性。在这种情况下，假阳性是没有圣诞老人的图像，但模型预测有。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mt"><img src="../Images/4afa7791071e8a01e03e0b54cf4f761b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gZR5AufMy7GS1n7olVCK0A.png"/></div></div><figcaption class="lx ly gj gh gi lz ma bd b be z dk">False Positive</figcaption></figure><p id="2443" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在使预测更加准确和减少假阳性的数量方面，还有很大的改进空间。</p><p id="f58b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来的步骤是了解更多关于配置文件中不同参数的信息，并更好地了解它们如何影响模型的定型及其预测。</p><h1 id="cd52" class="ku kv iq bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">结论</h1><p id="c8f8" class="pw-post-body-paragraph jn jo iq jp b jq ls js jt ju lt jw jx jy lu ka kb kc lv ke kf kg lw ki kj kk ij bi translated">我们希望您现在可以为自己的数据集训练对象检测器。在这一点上，我要感谢希瓦吉·什罗夫和 T2·乔希·库尔茨，他们在项目建设中发挥了同等的作用。</p><p id="392c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢你的阅读，希望你喜欢这篇文章。如果您有任何问题或建议，请随时通过 LinkedIn 联系我们，地址是<a class="ae kl" href="https://www.linkedin.com/in/varunvohra94/" rel="noopener ugc nofollow" target="_blank"> Varun Vohra </a>和<a class="ae kl" href="https://www.linkedin.com/in/shivangishroff/" rel="noopener ugc nofollow" target="_blank"> Shivangi Shroff </a>。我们非常乐意收到任何反馈。</p></div></div>    
</body>
</html>