<html>
<head>
<title>Linear Regression: Moneyball — Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">线性回归:钱球—第 1 部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/linear-regression-moneyball-part-1-b93b3b9f5b53?source=collection_archive---------4-----------------------#2018-04-15">https://towardsdatascience.com/linear-regression-moneyball-part-1-b93b3b9f5b53?source=collection_archive---------4-----------------------#2018-04-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c1de" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">大众体育故事的统计案例研究</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/6a1d8bceb4bc315f8374737bb6331c3e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SDxWaARcDX3hK6ki."/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">“The macro view of an old baseball on a wood surface” by <a class="ae kv" href="https://unsplash.com/@jtkyber1?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Joey Kyber</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="efbd" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">概观</h1><p id="219b" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">因 2011 年的电影<a class="ae kv" href="http://www.imdb.com/title/tt1210166/" rel="noopener ugc nofollow" target="_blank"> Moneyball </a>而走红的最引人注目的体育分析故事之一，2002 年的<a class="ae kv" href="https://en.wikipedia.org/wiki/Oakland_Athletics" rel="noopener ugc nofollow" target="_blank">奥克兰运动家队</a>创造了历史，在 2002 年 8 月 13 日至 9 月期间<a class="ae kv" href="https://www.si.com/mlb/2017/09/08/longest-winning-streaks-2002-oakland" rel="noopener ugc nofollow" target="_blank">连续赢了 20 场比赛</a>。</p><p id="9f34" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">奥克兰运动家队(通常被称为运动家队)在那个赛季的成功很大程度上归功于他们的总经理比利·比恩和前助理总经理保罗·德波斯塔。</p><p id="a4fd" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">DePodesta 毕业于哈佛大学经济学，于 1999 年加入美国棒球协会，并很快开始整合棒球统计数据分析，以评估和购买球员。(<a class="ae kv" href="https://en.wikipedia.org/wiki/Sabermetrics" rel="noopener ugc nofollow" target="_blank"> Sabermetrics </a>)</p><p id="e37e" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这种方法在 2002 年历史性的赛季后受到关注，当时比利·比恩购买了被严重低估的球员，以取代赛季开始前离开的关键球员。由于奥克兰运动家队严重的预算限制，比利求助于 DePodesta 正在研究的方法，以购买被低估的球员来满足加州球队的工资。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/41ca44d731a99dcb478d8006f699d3cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TRmi_wdi9FbkbvhXVvU8dA.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Brad Pitt as Billy Beane and Jonah Hill as Paul DePodesta’s counterpart in the movie Moneyball. <a class="ae kv" href="https://info.umkc.edu/unews/moneyball/" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><p id="9c84" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">本文试图重现 Paul DePodesta 的部分分析，以展示最简单的监督学习技术(也称为线性回归)的威力。</p><h2 id="818e" class="mq kx iq bd ky mr ms dn lc mt mu dp lg lx mv mw li mb mx my lk mf mz na lm nb bi translated">放弃</h2><p id="eede" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">这一分析与麻省理工学院 edX<a class="ae kv" href="https://www.edx.org/course/analytics-edge-mitx-15-071x-3" rel="noopener ugc nofollow" target="_blank">Analytics Edge</a>课程中的案例研究非常相似。然而，我为本文选择的编程语言是 Python，而不是前面提到的课程中使用的 R。</p><h2 id="dab8" class="mq kx iq bd ky mr ms dn lc mt mu dp lg lx mv mw li mb mx my lk mf mz na lm nb bi translated">线性回归</h2><p id="c6c2" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">线性回归是机器学习中的一种监督学习算法，它起源于统计学原理。它主要用于模拟一个解释变量(通常为<em class="nc"> y </em>，<em class="nc"> </em>)与一个或多个自变量(用<em class="nc"> X. </em>表示)之间的关系，当只有一个自变量用于预测<em class="nc"> y，</em>时，称为简单线性回归或线性回归，而当有多个自变量时，称为多元线性回归。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/3049cf2c8a27aa9ca9a0ccb01283c75e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/format:webp/1*vrKSNwJ7WAQk0Wd4FPp8gg.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Linear Regression equation. <a class="ae kv" href="https://stats.stackexchange.com/questions/86830/transformation-to-normality-of-the-dependent-variable-in-multiple-regression" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><p id="4c64" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">称为回归系数的β项指的是<em class="nc"> x </em>变量和<em class="nc">T21】因变量<em class="nc"> y. </em>之间的关系，让我们用一个例子来说明这一点。</em></p><p id="8b8c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">方程式:</p><p id="f8a5" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir"><em class="nc"/>房价= 50000+1.35×(房屋面积平方)+ ε </strong></p><p id="a6fb" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">上面的等式是一个回归函数的例子，该函数用于在给定房屋面积(平方英尺)的情况下确定房屋价格。</p><p id="6b00" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">1.35 是β的值，表示房子<em class="nc">、</em>每增加 1 平方英尺，房子<em class="nc">的价格就会增加 1.35 美元。</em>如果β的值为-1.35，那么房屋面积每增加 1 平方英尺<em class="nc">，</em>就会有 1.35 美元的单位 d <strong class="lq ir">房价<em class="nc">下降。</em></strong></p><p id="817c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">误差项ε用于表示残差或<em class="nc"> Y 的实际值和预测值之间的差异。</em>它告诉我们我们的预测值与实际值有多远。</p><p id="5f59" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">残差公式:</p><p id="81f2" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir">ε=<em class="nc">y</em>—<em class="nc">ŷ</em>t23】</strong></p><p id="891d" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">其中<em class="nc"> y </em>表示实际值，而<em class="nc"> ŷ </em>表示我们的模型预测的 y 值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/7a0f55c79e6ee83a6fefae5cc6057a70.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*qC52gtSjMfSwyh9x5mP7RA.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Plot of Simple Linear Regression with one independent variable. <a class="ae kv" href="https://en.wikipedia.org/wiki/Linear_regression" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><p id="dab3" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我不会详细讨论β值是如何计算的，模型是如何优化的。相反，让我们直接进入模型构建框架。</p><h2 id="3456" class="mq kx iq bd ky mr ms dn lc mt mu dp lg lx mv mw li mb mx my lk mf mz na lm nb bi translated">资料组</h2><p id="94fd" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">我使用的数据集是从 baseball-reference.com 收集的来自 Kaggle 的 Moneyball 数据集。</p></div><div class="ab cl nf ng hu nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ij ik il im in"><h1 id="afae" class="kw kx iq bd ky kz nm lb lc ld nn lf lg jw no jx li jz np ka lk kc nq kd lm ln bi translated">探索数据</h1><p id="5bbc" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">使用 pandas 库将数据读入 python。</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="0270" class="mq kx iq ns b gy nw nx l ny nz">df = pd.read_csv("baseball.csv")<br/>df.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oa"><img src="../Images/d0938dac1b80429c1d35361db33febdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-trJ9Dz6TaqCP5UAoqagAg.png"/></div></div></figure><p id="f981" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们需要在这里定义一些术语:</p><ul class=""><li id="35be" class="ob oc iq lq b lr mk lu ml lx od mb oe mf of mj og oh oi oj bi translated">RA 代表允许运行。</li><li id="e3cf" class="ob oc iq lq b lr ok lu ol lx om mb on mf oo mj og oh oi oj bi translated">RS 代表得分得分。</li><li id="8e36" class="ob oc iq lq b lr ok lu ol lx om mb on mf oo mj og oh oi oj bi translated">OBP 代表基数百分比。</li><li id="f0d5" class="ob oc iq lq b lr ok lu ol lx om mb on mf oo mj og oh oi oj bi translated">SLG 代表段塞百分比。</li><li id="a0dd" class="ob oc iq lq b lr ok lu ol lx om mb on mf oo mj og oh oi oj bi translated">巴是击球手。</li><li id="cb56" class="ob oc iq lq b lr ok lu ol lx om mb on mf oo mj og oh oi oj bi translated">OOBP 是对手的 OBP。</li><li id="6fff" class="ob oc iq lq b lr ok lu ol lx om mb on mf oo mj og oh oi oj bi translated">OSLG 是对手的 SLG。</li><li id="c757" class="ob oc iq lq b lr ok lu ol lx om mb on mf oo mj og oh oi oj bi translated">w 代表该赛季的获胜次数。</li></ul><p id="9d28" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">增加一个新变量 RD，作为 RS 和 RA 之间的差值。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi op"><img src="../Images/773b4028f653c84ce845c327d77f5c4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5ZkBuU2WjH4_CU96b5msdA.png"/></div></div></figure><p id="c460" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">此外，我们将只保留年&lt; 2002 in order to replicate the data prior to the 2002 season.</p><p id="9309" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">We will use plots in order to find insights regarding the distributions of the numerical variables.</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oq"><img src="../Images/047d847e6ab378079c610855e98bf6d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1190/format:webp/1*u2llIZt7_Qe24-pTyBax4A.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Histograms of numerical features</figcaption></figure><p id="7e8a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">Observe that all four features(variables) are approximately <a class="ae kv" href="https://en.wikipedia.org/wiki/Normal_distribution" rel="noopener ugc nofollow" target="_blank">正态分布</a>的记录。得分得分和允许得分的图表似乎都稍微向左倾斜。运行评分图的<a class="ae kv" href="https://en.wikipedia.org/wiki/Heavy-tailed_distribution" rel="noopener ugc nofollow" target="_blank">尾部</a>似乎比允许运行图的尾部厚。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="or os l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Statistical analysis clip from Moneyball.(2011) <a class="ae kv" href="https://www.youtube.com/watch?v=KWPhV6PUr9o&amp;t=85s" rel="noopener ugc nofollow" target="_blank">Source</a></figcaption></figure><p id="df0c" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">根据 DePodesta 在片段中的角色，为了进入 2002 年的季后赛，运动家队需要至少 99 场胜利。让我们试着想象这种洞察力。</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="b158" class="mq kx iq ns b gy nw nx l ny nz"># Plotting scatterplot</span><span id="8f23" class="mq kx iq ns b gy ot nx l ny nz">plt.figure(figsize=(10,8))<br/>plt.scatter(x=moneyball0.W,y = moneyball0.RS,c="red")<br/>plt.scatter(x=moneyball1.W,y = moneyball1.RS,c="blue")<br/>plt.xlabel("Wins")<br/>plt.ylabel("Runs Scored")<br/>plt.axvline(x = 99)</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ou"><img src="../Images/0b88ac6e98fb1f1dfb473047221053ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1252/format:webp/1*Zl2sb_ZSwAlI1k7-gPDY6w.png"/></div></figure><p id="ccd6" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">从上面的图中我们看到，DePodesta 估计的 99 胜是有道理的，因为似乎只有 3 个观察值(红色)没有以≥ 99 胜进入季后赛。</p><p id="6dce" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">DePodesta 还计算出，为了进入季后赛，湖人队至少需要 814 分，并且只允许 645 分。这意味着得分得分和允许得分之间的差距大约需要 169(RD)。让我们来看看研发和成功之间的关系。</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="8388" class="mq kx iq ns b gy nw nx l ny nz">x = np.array(moneyball.RD)<br/>y = np.array(moneyball.W)</span><span id="68fa" class="mq kx iq ns b gy ot nx l ny nz"># Deriving slope,intercept values</span><span id="8604" class="mq kx iq ns b gy ot nx l ny nz">slope, intercept = np.polyfit(x, y, 1)<br/>abline_values = [slope * i + intercept for i in x]</span><span id="0180" class="mq kx iq ns b gy ot nx l ny nz">#Plotting the figure</span><span id="19f2" class="mq kx iq ns b gy ot nx l ny nz">plt.figure(figsize=(10,8))<br/>plt.scatter(x, y)<br/>plt.plot(x, abline_values, 'b')<br/>plt.title("Slope = %s" % (slope))<br/>plt.xlabel("Run Difference")<br/>plt.ylabel("Wins")<br/>plt.show()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/48b8f02bef2a01c0a291bfdb3fda71fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1230/format:webp/1*1kd5JaY8JGLCZXSnqMTu5Q.png"/></div></figure><p id="5632" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">我们可以清楚地看到，两个变量之间的关系是线性的。</p><pre class="kg kh ki kj gt nr ns nt nu aw nv bi"><span id="a59c" class="mq kx iq ns b gy nw nx l ny nz">print(np.corrcoef(x,y))</span><span id="410d" class="mq kx iq ns b gy ot nx l ny nz">output:</span><span id="cac0" class="mq kx iq ns b gy ot nx l ny nz">[[ 1.          0.93851498]<br/> [ 0.93851498  1.        ]]</span></pre><p id="1838" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">此外，研发和获胜次数之间有很强的<a class="ae kv" href="https://en.wikipedia.org/wiki/Correlation_and_dependence" rel="noopener ugc nofollow" target="_blank">相关性</a>0.9385。</p><p id="bf06" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">因此，我们的探索性数据分析证实了 DePodesta 的估计到目前为止是正确的。在研究的下一部分，我们将建立回归模型来进一步验证 DePodesta 的分析。</p><p id="9d13" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">请继续关注第二部分。</p></div><div class="ab cl nf ng hu nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ij ik il im in"><h1 id="95e0" class="kw kx iq bd ky kz nm lb lc ld nn lf lg jw no jx li jz np ka lk kc nq kd lm ln bi translated">来源</h1><ol class=""><li id="a9ad" class="ob oc iq lq b lr ls lu lv lx ow mb ox mf oy mj oz oh oi oj bi translated">【https://www.edx.org/course/analytics-edge-mitx-15-071x-3 T4】</li><li id="df7f" class="ob oc iq lq b lr ok lu ol lx om mb on mf oo mj oz oh oi oj bi translated"><a class="ae kv" href="http://www.imdb.com/title/tt1210166/" rel="noopener ugc nofollow" target="_blank">http://www.imdb.com/title/tt1210166/</a></li><li id="9318" class="ob oc iq lq b lr ok lu ol lx om mb on mf oo mj oz oh oi oj bi translated"><a class="ae kv" href="https://en.wikipedia.org/wiki/Linear_regression" rel="noopener ugc nofollow" target="_blank">https://en.wikipedia.org/wiki/Linear_regression</a></li><li id="2414" class="ob oc iq lq b lr ok lu ol lx om mb on mf oo mj oz oh oi oj bi translated"><a class="ae kv" href="http://www.numpy.org/" rel="noopener ugc nofollow" target="_blank">http://www.numpy.org/</a></li><li id="e0bf" class="ob oc iq lq b lr ok lu ol lx om mb on mf oo mj oz oh oi oj bi translated"><a class="ae kv" href="https://matplotlib.org/" rel="noopener ugc nofollow" target="_blank">https://matplotlib.org/</a></li></ol></div></div>    
</body>
</html>