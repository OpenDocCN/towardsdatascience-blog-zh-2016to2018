<html>
<head>
<title>Image Classification Challenge, using Transfer Learning and Deep Learning Studio</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">图像分类挑战，使用迁移学习和深度学习工作室</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/image-classification-challenge-using-transfer-learning-and-deep-learning-studio-2e89c3189fcf?source=collection_archive---------6-----------------------#2018-08-03">https://towardsdatascience.com/image-classification-challenge-using-transfer-learning-and-deep-learning-studio-2e89c3189fcf?source=collection_archive---------6-----------------------#2018-08-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/51645871819d403ec1ff47fe6278989b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SFcggzk_4qrAl2a1yORA0g.jpeg"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Photo by <a class="ae jd" href="https://unsplash.com/photos/IPFSwl-4IfA?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Taylor Swayze</a> on <a class="ae jd" href="https://unsplash.com/search/photos/soda-bottle?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a>.</figcaption></figure><div class=""/><p id="29be" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">图像分类的任务是识别图像上的对象或模式，并基于给定的类别/种类池来分配类别以对图像进行分类。有许多不同的子领域，如识别单个图像上的多个对象，甚至定位图像中的对象。</p><p id="b35e" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇文章中，我想与你分享我参加第一次图像分类挑战赛以及使用深度学习工作室(DLS)平台的经历。DLS 在一个高抽象层次上提供了一个图形界面，以建立和训练基于后端的深度神经网络，如 keras / tensorflow / theano 等，免费用于桌面或云应用程序。</p><p id="6451" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">如果你从未听过或用过 DLS，去看看</em> <a class="ae jd" rel="noopener" target="_blank" href="/deep-learning-made-easy-with-deep-learning-studio-an-introduction-18606a67f198"> <em class="lb">这篇文章</em> </a> <em class="lb">由</em> <a class="lc ld ep" href="https://medium.com/u/499b9c4ef53c?source=post_page-----2e89c3189fcf--------------------------------" rel="noopener" target="_blank"> <em class="lb"> Rajat </em> </a> <em class="lb">或在</em><a class="ae jd" href="https://deepcognition.ai/" rel="noopener ugc nofollow" target="_blank"><em class="lb">deep cognition . ai</em></a><em class="lb">试用一下。</em></p><h1 id="4b42" class="le lf jg bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">挑战</h1><p id="362e" class="pw-post-body-paragraph kd ke jg kf b kg mc ki kj kk md km kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">这项挑战被命名为<em class="lb">汽水瓶识别挑战</em>，由 DeepCognition.ai 直接主办，作为他们的第一场比赛，目标是在图像上识别不同种类的汽水瓶。<br/>与其他竞赛类似，例如<a class="ae jd" href="https://www.kaggle.com/" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>上的竞赛，您会收到一个或多或少准备好的带有标签的图像数据集，以及一套关于如何评估结果的规则和信息，还有一个提交结果的流程。在这种情况下，由于需要使用深度学习工作室服务，数据集和提交过程是根据 DLS 的工作方式定制的，这使得获得 startet 和提交第一个模型变得非常容易。</p><p id="2d87" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在下面的帖子中，我试图描述我采取的步骤，我获得的经验和我犯的错误，我的最终模型得分为 93.75%，在比赛中获得了第 10 名。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="3489" class="le lf jg bd lg lh mo lj lk ll mp ln lo lp mq lr ls lt mr lv lw lx ms lz ma mb bi translated">数据集</h1><p id="3a33" class="pw-post-body-paragraph kd ke jg kf b kg mc ki kj kk md km kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">提供的数据集由 6615 张图像组成，或多或少均匀地分成 8 类不同的汽水瓶。</p><figure class="mu mv mw mx gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mt"><img src="../Images/81a3ce5a9e4272dd7a661948824b8eca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lkU63mATgAwlBJ1ELO46kg.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Soda Bottle Dataset preview from <a class="ae jd" href="https://deepcognition.ai/competitions/soda-bottle-label-detection/" rel="noopener ugc nofollow" target="_blank">DeepCognition.ai</a></figcaption></figure><p id="c39c" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如你所看到的，图像已经基本上以类似的白色背景为中心，所以我决定我真的不需要任何更大的图像预处理步骤。人们应该注意到，并不是所有的图片都像这个数据集预览中显示的那样完美。通过手动滚动一些图像，您会注意到有许多不同角度的瓶子，以及瓶子躺着或被物体部分遮盖的图像。</p><figure class="mu mv mw mx gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi my"><img src="../Images/b7822a2657bd1062aea5ad638ca74843.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ONMKU-FRUQGRl_3wQUMBBA.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Differently positioned bottles</figcaption></figure><p id="f1c1" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">原始图像大小为 640*480 像素，这不一定是一个巨大的图像处理，但肯定比大多数网络工作。因此，调整图像大小似乎是一个合理的决定，以查看哪些大小会产生最好的结果。</p><h1 id="d129" class="le lf jg bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">天真的第一种方法</h1><p id="fcae" class="pw-post-body-paragraph kd ke jg kf b kg mc ki kj kk md km kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">我的第一个方法是简单地训练一个模型，用 DLS AutoML 特性生成，它将根据你的输入/输出设置为你生成一个完整的模型。</p><figure class="mu mv mw mx gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mz"><img src="../Images/b819aca8563adbcd98471c3673dd498d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*1wfSjfBX6gjm1LIDMggKFw.gif"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">AutoML model for the Soda Bottle Challenge</figcaption></figure><p id="c981" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如你所看到的，生成的模型非常庞大，对于一个 6k 图像和 8 个类别的图像分类问题来说，可能是完全多余的，但我仍然继续尝试训练它。很快我就注意到，将图像保持在 640*480 像素的原始大小会立即填满我笔记本的 16GB RAM，并使训练过程崩溃。即使将尺寸缩小到原始图像的 1/4，这个 AutoML 模型对我的笔记本来说似乎还是太大了。</p><p id="6265" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当然，DeepCognition 的云应用程序可以让你用相对较少的钱使用不同类型的 GPU，但我假设在这些条件下训练模型，将需要至少 4 个 GPU，这超出了我对这个项目的预算。</p><p id="eb78" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">看起来简单的“魔棒”方法并没有让我走得更远，所以我考虑了其他可能的、资源更友好的解决方案。</p><h1 id="28ea" class="le lf jg bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">迁移学习</h1><p id="a8f6" class="pw-post-body-paragraph kd ke jg kf b kg mc ki kj kk md km kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">迁移学习描述了一个相对宽泛的概念，即使用通过解决一组问题获得的知识来解决你当前问题的过程。</p><p id="51ad" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们的例子中，我们将使用一个已经成功训练的模型来识别图像上的某些对象，以识别不同的汽水瓶。乍一看，这可能没有意义。一个训练有素的模型如何区分猫和狗，能够告诉我们这个图像是包含露水还是胡椒博士瓶？</p><p id="a619" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了了解这可能是如何工作的，让我们非常简短地离题到图像分类模型是如何工作的。</p><h1 id="73d2" class="le lf jg bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">特征抽出</h1><p id="5301" class="pw-post-body-paragraph kd ke jg kf b kg mc ki kj kk md km kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">几乎所有的图像分类模型都使用堆叠卷积层从图像中提取特征。这些特征在它们的第一层包含非常一般的信息，如边界或基本形状。使用预先训练的模型，我们可以利用模型的较低层的这些特征，因为它们将适用于几乎所有类型的图像数据。然后，我们只需要重新训练模型的最后几层，就可以学会识别我们的汽水瓶。</p><p id="fc76" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">你可能想在这里</em>  <em class="lb">阅读关于卷积神经网络</em> <a class="ae jd" rel="noopener" target="_blank" href="/convolutional-neural-networks-for-all-part-i-cdd282ee7947"> <em class="lb">的更深入的解释。</em></a></p><p id="f100" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在讨论不同的模型选择之前，我们先来看看如何使用 DLS 实现预训练模型。</p><figure class="mu mv mw mx gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi na"><img src="../Images/5d076384aace4d73394cb950289f12a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r2rnrEVcv4lcEfAOf9PLGQ.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">VGG16 as a pre-trained model</figcaption></figure><p id="4b37" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">上面你可以看到一个非常基本的使用 DLS 图形编辑器的预训练 VGG16 模型的实现。有几件事需要考虑:</p><h2 id="5c5f" class="nb lf jg bd lg nc nd dn lk ne nf dp lo ko ng nh ls ks ni nj lw kw nk nl ma nm bi translated">输入尺寸</h2><p id="ea5a" class="pw-post-body-paragraph kd ke jg kf b kg mc ki kj kk md km kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">我们的图像的输入尺寸显示在模型的第一个节点上(3，224，224)，这意味着我们已经将图像的尺寸调整为 224*224 像素，这是 VGG16 模型的原始图像尺寸。</p><p id="2631" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这可以在 DLS 的数据选项卡中轻松完成。</p><figure class="mu mv mw mx gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nn"><img src="../Images/6283271f841dc97c0e0c1899def3a012.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3LaN6lE0VWFJdX51I2vbNQ.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Resizing the input images</figcaption></figure><h2 id="18fc" class="nb lf jg bd lg nc nd dn lk ne nf dp lo ko ng nh ls ks ni nj lw kw nk nl ma nm bi translated">预训练模型</h2><p id="b820" class="pw-post-body-paragraph kd ke jg kf b kg mc ki kj kk md km kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">我们模型中的一个节点称为 VGG16，它实际上代表了压缩在单个节点中的整个 VGG16 模型架构。从<em class="lb">预训练模型</em>选项卡，DLS 提供了几个模型供选择。节点本身有一些关于如何加载预训练权重以及模型的哪个部分应该是可训练的选项。</p><figure class="mu mv mw mx gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi na"><img src="../Images/189eae36b3e656a8f4a835ec410967bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yB4ZBaqIzOHI1_3HVK7HfQ.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">VGG16 settings</figcaption></figure><p id="f47b" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正如你在右手边看到的，我们不包括 VGG16 模型的顶层，因为这些是一旦我们建立自己来分类 8 个汽水瓶类，而不是 1000 个类别的<em class="lb"> imagenet </em>数据集，原始的 VGG16 模型被训练。</p><p id="9d5c" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另一个重要参数是<em class="lb">可训练值</em>，它是我们希望在反向传播过程中包含的 VGG16 模型的百分比。由于前几层提取了相当一般化的特征，我们不想重新训练它们，而是保持它们原来的样子。实际上，在我的方法中，只重新训练 VGG16 模型的最后一个卷积块就足够了，它大约是模型的 25%。</p><p id="ba89" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">通过这种设置，与 AutoML 模型相比，该模型需要的资源少得多，甚至可以在我配有 CPU 和 16GB RAM 的笔记本电脑上进行训练。然而，我只达到了大约 1 个样本/秒的处理速度，这将导致训练时间大约为。只有一个纪元的 76 分钟。这似乎是不可接受的，因为我想测试几种不同的方法，看看哪种模型表现最好。此外，整个比赛持续时间只有大约 3 周。</p><p id="23b7" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">切换到云版本并使用 Telsa K80 以大约 1 美元/小时的速度运行，导致培训时间大约为。VGG16 型号每周期 74 秒，我尝试的一些其他型号甚至更快。</p><h1 id="8e3a" class="le lf jg bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">VGG16 / VGG19 / ResNet50</h1><p id="ddd4" class="pw-post-body-paragraph kd ke jg kf b kg mc ki kj kk md km kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">为了比较不同种类的预训练模型，我做了一个 10 个时期的小测试，每个时期都有与 VGG16 模型相同的设置。</p><h2 id="e99d" class="nb lf jg bd lg nc nd dn lk ne nf dp lo ko ng nh ls ks ni nj lw kw nk nl ma nm bi translated">VGG16</h2><figure class="mu mv mw mx gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi no"><img src="../Images/27143938e66be13a1c06b4ce852d1558.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XUTFcVYmhtUgNMoAIeDwog.jpeg"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">VGG16 training process</figcaption></figure><p id="3e1e" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">VGG16 模型在前 2 个时期后在验证集上仅实现了约 14%的准确度，并且似乎在最后 8 个时期都不被认可。在 8 类分类问题上 14%的准确率仅略高于随机猜测概率，后者约为 12.5%。这个结果对于迁移学习的前景来说并不是很鼓舞人心，但是让我们看看其他模型的得分如何。</p><h2 id="a884" class="nb lf jg bd lg nc nd dn lk ne nf dp lo ko ng nh ls ks ni nj lw kw nk nl ma nm bi translated">VGG19</h2><figure class="mu mv mw mx gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi np"><img src="../Images/84dc79dd6c53a516026a1b03cb68b047.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IKVGvlSuyHBIYrQ93yJ4Gg.jpeg"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">VGG19 training prcoess</figcaption></figure><p id="fe4e" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">VGG19 模型的架构与他的前任 VGG16 相似，但更深入，已经表现得更好，几乎达到 30%的精度。然而，训练曲线并没有给出通过进一步训练来提高准确度的希望。</p><h2 id="cebe" class="nb lf jg bd lg nc nd dn lk ne nf dp lo ko ng nh ls ks ni nj lw kw nk nl ma nm bi translated">ResNet50</h2><figure class="mu mv mw mx gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nq"><img src="../Images/92e3581484cae1df92aca1634514af2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8Di9eeuW71IqoSXb5fhxFA.jpeg"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">ResNet50 training process</figcaption></figure><p id="0ff7" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">差别真大！这是我所希望的结果。如你所见，该模型在 3 个时期后几乎达到了 80%的准确率，并在整个训练过程中不断提高。除了在三款测试车型中表现最佳之外，它还拥有最快的训练速度。</p><h1 id="eaad" class="le lf jg bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">估价</h1><p id="df2b" class="pw-post-body-paragraph kd ke jg kf b kg mc ki kj kk md km kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">有几种方法可以评估模型的性能。首先，对您的数据进行适当的训练/测试分割对于创建一个对未来数据表现良好的模型是必不可少的。DLS 自动对您的数据执行训练/验证/测试分割，同时让您选择不同的分割比率。</p><figure class="mu mv mw mx gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nr"><img src="../Images/afc1c0fc46fc03dd1830ab477ef727b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v7JUJYFsolGYwCiCzVAMeA.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">DLS Dataset settup</figcaption></figure><p id="ed8b" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在训练过程中，然后在每个时期之后使用验证集来计算验证损失和准确度，这与训练损失/准确度一起显示在训练图中。</p><p id="8c52" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在训练过程的最后，您可以对数据的测试分割进行推理。在我们的例子中，这意味着我们将使用我们训练过的模型来预测测试集的图像上显示的是哪一类汽水瓶。</p><figure class="mu mv mw mx gt is gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/35245ac4ab43ab0aa602431ae2184a27.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*blGdOEPRcQaS-eozN8wxMg.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">DLS Dataset Inference</figcaption></figure><p id="30fc" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">用我们训练过的模型在我们的测试分割上运行预测，可以让我们知道我们的模型能够多好地识别它以前没有见过的图像上的汽水瓶类别。</p><p id="f992" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当然，这很大程度上取决于数据集内部的方差。在我们的案例中，提供的所有图像都是以非常相似的方式拍摄的，只有角度或旋转上的微小差异。因此，推理的表现和预期的一样好，这并不一定意味着它能够识别不同的图像。许多参赛者在提交他们的第一个模型进行评估后可能会注意到一个事实。</p><h1 id="792b" class="le lf jg bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">提交流程</h1><p id="7fcb" class="pw-post-body-paragraph kd ke jg kf b kg mc ki kj kk md km kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">在我们的私人数据集上创建了一个准确率约为 80%的模型后，我觉得自己已经准备好第一次提交参赛作品了。</p><p id="c8ae" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本次比赛的提交过程相当简单。DLS 提供了一个以 zip 文件形式下载您的训练模型的功能，该文件包含您的. h5 模型文件以及一个配置文件和一个 test.py 脚本，可用于在测试映像上运行您的模型。这个压缩文件只需上传到比赛网站。</p><p id="96e1" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">提交我的第一个模型，最终得分约为 40%。</p><p id="030d" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">相当令人失望，当我们预期分数约为 80%时。那么这种差异从何而来呢？</p><p id="3c76" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">按照竞赛规则的规定，对参赛作品的评估是在个人的私有数据集上进行的，参赛者无法访问这些数据集。我们训练过的模型从未见过这些图像，因此 40%的准确率意味着该模型没有足够的泛化能力来识别它没有见过的图像上的汽水瓶。</p><h1 id="e625" class="le lf jg bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">数据扩充</h1><p id="5e5b" class="pw-post-body-paragraph kd ke jg kf b kg mc ki kj kk md km kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">提高模型性能的一种方法是数据扩充。数据扩充描述了仅使用来自我们的训练数据的信息来增加训练数据量的过程。对于我们的图像数据集，这意味着我们根据现有的图像创建更多具有不同特征的图像。例如，我们可以左右移动图像、旋转图像、上下翻转图像或执行剪切变换。</p><p id="3841" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">如果你有兴趣阅读更多关于数据增强的内容，请查看</em> <a class="lc ld ep" href="https://medium.com/u/7d8ea5e73263?source=post_page-----2e89c3189fcf--------------------------------" rel="noopener" target="_blank"> <em class="lb">瑞安·奥尔雷德</em> </a> <em class="lb">的</em> <a class="ae jd" rel="noopener" target="_blank" href="/image-augmentation-for-deep-learning-using-keras-and-histogram-equalization-9329f6ae5085"> <em class="lb">帖子</em> </a> <em class="lb">。</em></p><p id="66dc" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用这些“新”图像，我们基本上在更大的数据集上训练我们的模型，并由此增加其鲁棒性，因为它不仅从原始图像中学习。因此，我们应该看到对私有评估数据集的预测也有所改善。</p><figure class="mu mv mw mx gt is gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/2b5c9d3f2a09dea6841ee8b6911826d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*fSTBaRUgbepXZRmEbKR2fg.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Data Augmentation in DLS</figcaption></figure><p id="1216" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在 DLS，数据扩充可以像调整大小选项一样直接在输入图像的<em class="lb">数据</em>选项卡下使用。</p><p id="abe0" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用如上所示的数据增强图像训练我们的 ResNet50 模型，得到了非常相似的训练曲线，在 10 个时期后峰值约为 90%。</p><figure class="mu mv mw mx gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nu"><img src="../Images/424438ce29ae7a5333bc8c15668fc737.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8Z2r-sLRPGjLMJtJmSMOkA.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">ResNet50 training process with data augmentation</figcaption></figure><p id="a569" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">将这个模型提交给比赛给了我 57%的分数，这表明数据增强有助于提高模型的整体稳健性，正如我们预期的那样。</p><p id="2bca" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">与我们在训练期间达到的 91%相比，57%看起来不是很好，但是不要忘记我们只训练了 10 个时期的模型。我认为有改进的余地。</p><h1 id="a95c" class="le lf jg bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">超参数</h1><p id="7764" class="pw-post-body-paragraph kd ke jg kf b kg mc ki kj kk md km kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">机器学习中的超参数，描述我们的模型中在学习过程开始之前设置的那些参数。最常见的是你谈论的参数，如批量大小、时期数、优化器和损失函数。</p><p id="413d" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">阅读更多关于超参数的文章</em> <a class="ae jd" rel="noopener" target="_blank" href="/artificial-intelligence-hyperparameters-48fa29daa516"> <em class="lb">本文</em> </a> <em class="lb">作者</em> <a class="lc ld ep" href="https://medium.com/u/e7f791e64e83?source=post_page-----2e89c3189fcf--------------------------------" rel="noopener" target="_blank"> <em class="lb">丹尼尔·夏皮罗博士</em> </a> <em class="lb">。</em></p><p id="984a" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这些也是 DLS 在<em class="lb">超参数</em>选项卡下为您提供的超参数。</p><figure class="mu mv mw mx gt is gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/3ba3894aa262d57ba0d37791f611da9c.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*WGU6Zgrs71EOf_fs628xlQ.png"/></div></figure><p id="d422" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">据我所知，DLS 默认提供这些设置，基于 keras 中实现的默认值。因为这些是你最常用的设置，我继续使用 DLS 的默认设置。我只是调整了批量大小，以提高训练速度。</p><p id="93a5" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">作为一个优化器，我们使用了 Adadelta，它有一个自适应的学习率，所以我们甚至不用费心去寻找正确的学习率。这对于快速获得好的结果是很棒的，但是也会导致一个小问题，我将在后面讨论。</p><p id="c8c9" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">如果你想深入了解不同的优化器，我建议你阅读本文</em><a class="ae jd" href="https://medium.com/@maksutov.rn/deep-study-of-a-not-very-deep-neural-network-part-3a-optimizers-overview-ed1631127fb7" rel="noopener"><em class="lb"/></a><em class="lb"/><a class="lc ld ep" href="https://medium.com/u/9483c7e0e6ed?source=post_page-----2e89c3189fcf--------------------------------" rel="noopener" target="_blank"><em class="lb">Rinat Maksutov</em></a><em class="lb">。</em></p><h1 id="dcd2" class="le lf jg bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">决赛成绩</h1><p id="5609" class="pw-post-body-paragraph kd ke jg kf b kg mc ki kj kk md km kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">为了提高分数，我尝试了很多不同的方法。最后，帕维尔·奥斯特亚科夫和阿列克谢·哈尔拉莫夫在他们的谈话中表达了一个想法，这个想法让我最终得出了大约 93%的准确率。</p><p id="1c87" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">他们参加了一场图像分类挑战，这有点类似于汽水瓶识别挑战，但数据集要大得多。他们在训练中的方法是只在原始图像上开始训练，没有任何数据增强。然后，在训练收敛后，他们停下来，保存模型，并继续进行少量增强训练。他们多次重复这些步骤，一直训练到损失收敛，每次都增加数据增加量。</p><p id="e764" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">起初，在 DLS 建立这种行为是相当容易的，因为在开始训练过程时，有一个选项来加载上次跑步的重量。</p><figure class="mu mv mw mx gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nw"><img src="../Images/83f43231544543bb00e72d6e68c2405f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qzcySHJPRX-kuWvqmI83WA.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">DLS loading weights of previous runs</figcaption></figure><p id="f375" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我试图模仿上面提到的程序时，我的最终得分高达 80%,但在我看来，这主要是因为该模型的整体训练时间较长。</p><h1 id="e492" class="le lf jg bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">学习率</h1><p id="7cbe" class="pw-post-body-paragraph kd ke jg kf b kg mc ki kj kk md km kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">如前所述，我选择了具有自适应学习率的 Adadelta 优化器。它以较高的学习率开始，并在训练过程中逐渐降低。</p><p id="2291" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">由于我们已经多次开始和停止训练过程来调整数据扩充，所以学习率的调整并不真正有效，因为我在 DLS 找不到任何选项来保存或加载先前运行的学习率。</p><p id="78f7" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这就是为什么我决定尝试 Adam 优化器，它也有一个学习率衰减的参数，但从一个固定的学习率开始。因此，我在第一次运行时以 0.01 的标准学习率开始，然后在每次新的训练开始后手动调整学习率。</p><p id="8045" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">用这种新方法，我最终达到了 93.75%的最终分数，请注意，这是提交期的最后一天。</p><p id="0a28" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">由于选择正确的学习速率是超参数调优中最棘手也是最重要的部分之一，我将推荐阅读</em> <a class="ae jd" rel="noopener" target="_blank" href="/estimating-optimal-learning-rate-for-a-deep-neural-network-ce32f2556ce0"> <em class="lb">文章</em> </a> <em class="lb">作者</em><a class="lc ld ep" href="https://medium.com/u/d002f056f8c?source=post_page-----2e89c3189fcf--------------------------------" rel="noopener" target="_blank"><em class="lb">Pavel Surmenok</em></a><em class="lb">。</em></p><h1 id="a297" class="le lf jg bd lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb bi translated">结论</h1><p id="4c5a" class="pw-post-body-paragraph kd ke jg kf b kg mc ki kj kk md km kn ko me kq kr ks mf ku kv kw mg ky kz la ij bi translated">总的来说，由于这是我第一次参加比赛，我对自己的成绩非常满意。DeepCognitions 竞赛极大地激励了人们去尝试不同的架构和方法，并在这样做的同时学到了很多东西，所有这些都不需要编写一行代码。</p><p id="e181" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">比赛的前两个位置实际上达到了完美的 100 分，所以对我来说肯定有改进的空间。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><p id="5516" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我希望你喜欢阅读我关于如何应对这一挑战的想法，甚至可能带走一些想法。请随时留下任何提示或建议，告诉我你会如何解决这个问题，以及我可以如何改进。</p><p id="c1c3" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我总是很高兴认识新朋友并分享想法，所以如果你喜欢这篇文章，可以考虑在 LinkedIn 上加我。</p></div></div>    
</body>
</html>