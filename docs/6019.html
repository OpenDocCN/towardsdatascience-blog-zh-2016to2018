<html>
<head>
<title>Learning FastText</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">学习快速文本</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/fasttext-ea9009dba0e8?source=collection_archive---------5-----------------------#2018-11-21">https://towardsdatascience.com/fasttext-ea9009dba0e8?source=collection_archive---------5-----------------------#2018-11-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="caa9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">一点个人背景</strong></p><p id="cb7f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我在学习机器学习上重新开始的自我折磨的尝试。几个月前，我从在线纳米学位工厂 udacity 获得了一名机器学习工程师<code class="fe kl km kn ko b">Nanodegree</code>。纳米可能意味着它是无限小和微不足道的。</p><p id="729d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不确定。</p><p id="1bd0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">金钱方面，大约是 1000 美元；就努力而言，我在 6 个月内投入了大量的工作。我有时让我的 CPU 超时工作，满负荷运行；看到我自己的学习项目结出了果实，我感到非常满意:识别狗的品种，对肺炎进行分类，让一架虚拟四轴飞行器悬停在起飞点上方约 10 个像素处(这都是荣耀)。我现在认为自己是机器学习领域的“文盲”。像<code class="fe kl km kn ko b">CNN</code>这样的术语将不再仅仅代表“假”新闻作品；我可以让一个非 ML 的人听起来很聪明，比如说<code class="fe kl km kn ko b">RNNs</code>、<code class="fe kl km kn ko b">LSTM</code>、<code class="fe kl km kn ko b">GANs</code>、<code class="fe kl km kn ko b">reinforcement learning</code>等等。但除此之外，我的纳米学位对我没有任何影响。</p><p id="ad80" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">尽管如此，在人工智能时代，不学习不是一个选项。所以我决定振作起来，继续前进，在机器学习理论、技术、突破和新前沿的洪流中跌跌撞撞。</p><p id="1851" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为学习而学习。</p><p id="addf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我通过谷歌搜索“有趣的机器学习项目”来“发现”f<a class="ae kp" href="https://github.com/facebookresearch/fastText" rel="noopener ugc nofollow" target="_blank">as text</a>。找到文章<a class="ae kp" href="https://medium.mybridge.co/30-amazing-machine-learning-projects-for-the-past-year-v-2018-b853b8621ac7" rel="noopener ugc nofollow" target="_blank">过去一年 30 个惊人的机器学习项目(v.2018) </a>。fastText 是数字 1。它拥有 16，185 颗 Github 星(这是数以万计的开发者的信任票),并且仍在上升。眼花缭乱。</p><p id="bdb9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以我必须学习。</p><p id="1db2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kp" href="https://fasttext.cc/" rel="noopener ugc nofollow" target="_blank"><em class="kq">fast text</em></a><em class="kq">是一个高效学习单词表示和句子分类的库。</em></p><p id="3ea3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">词向量</strong></p><p id="df67" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">单词表示和句子分类是自然语言处理领域的基础。NLP 之于人工智能，就是语言之于人类文明。这是一个允许你的 Siri、Alexa、谷歌助手(Google assistant)和一群语音助手对你拼写错误、用词不当、不完整、可能令人尴尬的问题做出回应的领域，并给出聪明和信息丰富的答案(希望如此)。这就是为什么当你阅读一些关于烹饪、健身和其他一切的文章时，谷歌或脸书会用“智能”广告跟随你。</p><p id="e18a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">简单的单词表示将文本集视为一个不加选择的单词包，也称为<code class="fe kl km kn ko b">BoW</code>。<code class="fe kl km kn ko b">BoW</code>只关心 2 件事:a)已知单词列表；b)词频统计。它不关心句子中的单词、文本中的句子之间的句法(<em class="kq">结构</em>)和语义(<em class="kq">意义</em>)关系。对于某些目的，这种处理已经足够好了，例如，垃圾邮件检测。对其他人来说，<code class="fe kl km kn ko b">BoW</code>功亏一篑。相反，单词向量成为单词表示的最新形式。</p><blockquote class="kr ks kt"><p id="42ff" class="jn jo kq jp b jq jr js jt ju jv jw jx ku jz ka kb kv kd ke kf kw kh ki kj kk ij bi translated"><a class="ae kp" href="https://medium.com/@jayeshbahire/introduction-to-word-vectors-ea1d4e4b84bf" rel="noopener">单词向量将单词表示为多维连续浮点数，其中语义相似的单词被映射到几何空间中的邻近点。更简单地说，<strong class="jp ir"> <em class="iq">一个单词向量是一行实数值</em> </strong>(与虚数值相反)，其中<strong class="jp ir"> <em class="iq">每个点捕获单词含义的一个维度</em></strong><strong class="jp ir"><em class="iq">其中语义相似的单词具有相似的向量</em> </strong> <em class="iq">。</em> </a></p></blockquote><p id="8a74" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是一大堆数学术语，代表了无限维度的数学宇宙。</p><p id="a86d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当单词被矢量化时，它们可以被增加或减少。</p><blockquote class="kr ks kt"><p id="aa91" class="jn jo kq jp b jq jr js jt ju jv jw jx ku jz ka kb kv kd ke kf kw kh ki kj kk ij bi translated">妻子+丈夫+孩子=家庭(希望如此)</p></blockquote><p id="22a6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不确定以下数学公式是否正确:</p><blockquote class="kr ks kt"><p id="c720" class="jn jo kq jp b jq jr js jt ju jv jw jx ku jz ka kb kv kd ke kf kw kh ki kj kk ij bi translated">妈妈*妈妈=奶奶？</p></blockquote><p id="80fe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">反正在一个词向量里，<code class="fe kl km kn ko b">`smart`</code>和<code class="fe kl km kn ko b">intelligent</code>是相邻而坐的两个词，<code class="fe kl km kn ko b">cats</code>和<code class="fe kl km kn ko b">dogs</code>占据同一个动物球，<code class="fe kl km kn ko b">go</code>、<code class="fe kl km kn ko b">went</code>、<code class="fe kl km kn ko b">gone</code>平行于<code class="fe kl km kn ko b">eat</code>、<code class="fe kl km kn ko b">ate</code>和<code class="fe kl km kn ko b">eaten</code></p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi kx"><img src="../Images/a7de2878e1ccfd1feb20964eea999374.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZNdGa-lpYoZhvSFIcRaewg.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk">Word vector (From <a class="ae kp" href="https://medium.com/@jayeshbahire/introduction-to-word-vectors-ea1d4e4b84bf" rel="noopener">Introduction to Word Vectors</a>)</figcaption></figure><p id="3e68" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有两种主要的架构/模型用于将大量文献训练成单词向量:<a class="ae kp" href="https://blog.acolyer.org/2016/04/21/the-amazing-power-of-word-vectors/" rel="noopener ugc nofollow" target="_blank">一种<em class="kq">连续单词袋</em>模型(cbow)和<em class="kq">连续跳格</em>模型。</a>有许多文章和博客文章提供了关于技术实现和解释的细节，例如<a class="ae kp" href="https://blog.acolyer.org/2016/04/21/the-amazing-power-of-word-vectors/" rel="noopener ugc nofollow" target="_blank">单词向量的惊人力量</a>、<a class="ae kp" href="http://mccormickml.com/2016/04/19/word2vec-tutorial-the-skip-gram-model/" rel="noopener ugc nofollow" target="_blank"> Word2Vec 教程—Skip-Gram</a>、<a class="ae kp" href="http://mccormickml.com/assets/word2vec/Alex_Minnaar_Word2Vec_Tutorial_Part_II_The_Continuous_Bag-of-Words_Model.pdf" rel="noopener ugc nofollow" target="_blank"> Word2Vec 教程第二部分:连续单词袋模型</a>。</p><p id="1d42" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在一个过于简化和幼稚的版本中，给出一些例句:<code class="fe kl km kn ko b">the farmer takes the wife, the wife takes the kids, the kids take the cats</code>(摘自一首小孩儿的歌)。<code class="fe kl km kn ko b">skip-gram</code>使用一个随机单词作为输入，并输出单词列表中每隔一个单词成为所选单词的“邻近单词”的概率；相比之下，<code class="fe kl km kn ko b">cbow</code>模型使用一系列单词(上下文)作为输入，并输出每隔一个单词作为目标单词的概率。</p><p id="da8a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以把<code class="fe kl km kn ko b">take</code>这个词放进<code class="fe kl km kn ko b">skip-gram</code>机，它会粗制滥造出<code class="fe kl km kn ko b">farmer</code>、<code class="fe kl km kn ko b">wife</code>、<code class="fe kl km kn ko b">kids</code>、<code class="fe kl km kn ko b">cats</code>和<code class="fe kl km kn ko b">the</code>的概率；对于<code class="fe kl km kn ko b">cbow</code>，你需要喂它<code class="fe kl km kn ko b">the</code>、<code class="fe kl km kn ko b">farmer</code>、<code class="fe kl km kn ko b">wife</code>，它会尝试猜单词<code class="fe kl km kn ko b">take</code>。</p><p id="4af9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">FastText 支持连续<code class="fe kl km kn ko b">CBOW</code>和<code class="fe kl km kn ko b">skip-gram</code>两种模式。</p><p id="ab3b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">文本分类</strong></p><p id="aef9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">文本分类是基本的，因为它是不言自明的。文本分类的应用范围从垃圾邮件过滤、情感分析、内容标记/分类。它也是搜索和排名等复杂系统的核心。分类和归类是人类和机器处理数量和复杂性不断增加的文本的第一步。在数字信息的浩瀚宇宙中，这让你能够找到你感兴趣的主题，跟随你想要占据的回音室，等等。</p><p id="bf1b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">传统上，文本分类使用纯数学/统计方法。开发了各种特征提取技术，例如<code class="fe kl km kn ko b">Principal Component Analysis (PDA).</code></p><p id="7be2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那么统计方法就会变得不充分、太慢、太少。因此出现了机器学习，它可以更好地理解互联网上数百万兆字节的信息。机器学习中的文本分类，根据数据模型遵循的学习原理，可以分为三类:<a class="ae kp" href="http://www.ijikm.org/Volume13/IJIKMv13p117-135Thangaraj3803.pdf" rel="noopener ugc nofollow" target="_blank">监督文本分类、非监督文本分类、半监督文本分类(Korde &amp; Mahender，2012)。</a></p><p id="fddf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">FastText 使用简单有效的基线进行句子分类(将句子表示为单词包(BoW)并训练线性分类器)。它使用<code class="fe kl km kn ko b">negative sampling</code>、<code class="fe kl km kn ko b">hierarchical softmax</code>和<code class="fe kl km kn ko b">N-gram</code>特征来降低计算成本和提高效率。</p><p id="7fea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不得不说，所有的术语都让我晕头转向。</p><p id="6d7a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">实施</strong></p><p id="570f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下是我跟随各地给出的例子学习和试用 fastText(例如<a class="ae kp" href="https://github.com/facebookresearch/fastText" rel="noopener ugc nofollow" target="_blank">这里</a>)。</p><p id="574f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">训练文集是加西亚·马尔克斯的《T4》一书</p><p id="e44b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">训练单词向量</strong></p><p id="651a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用<code class="fe kl km kn ko b">skipgram</code></p><p id="de11" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe kl km kn ko b"><strong class="jp ir">.</strong>/fasttext skipgram -input file.txt -output model</code></p><p id="f440" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用<code class="fe kl km kn ko b">cbow</code></p><p id="c8c3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe kl km kn ko b">./fasttext cbow -input file.txt -output model</code></p><p id="4089" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用<code class="fe kl km kn ko b">skipgram</code>或<code class="fe kl km kn ko b">cbow</code>，将生成一个<code class="fe kl km kn ko b">.vec</code>和<code class="fe kl km kn ko b">.bin</code>文件。<code class="fe kl km kn ko b">.vec</code>文件包含了向量这个词，每行一个词，那是给我们人类的检查，<code class="fe kl km kn ko b">.bin</code>是给机器消耗的。</p><p id="21f5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以提前查看向量输出的内容:</p><p id="1b0d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe kl km kn ko b">head -n 4 model.vec</code></p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi ln"><img src="../Images/df396e32f6b3032878a107ed6a0ed03c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7K60OLEhFzgl--my1T8Xlg.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk">Sample output of fastText vector</figcaption></figure><p id="0c6e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有许多参数可以调整以微调字向量，最重要的是维度(<code class="fe kl km kn ko b">dim)</code>和子字的大小范围(<code class="fe kl km kn ko b">minn</code>，<code class="fe kl km kn ko b">maxn</code>)。</p><p id="5ac2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe kl km kn ko b">./fasttext skipgram -input file.txt -output model -minn 3 -maxn 5 -dim 100</code></p><p id="b302" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">阅读一个单词向量就像阅读二进制 0 和 1 一样有趣和有启发性。所以我可以直接输出我关心的花言巧语，这是一种解脱。</p><p id="e7df" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe kl km kn ko b">echo “imagination miracles magic desperation” | ./fasttext print-word-vectors model.bin</code></p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi lo"><img src="../Images/75f1a81e3611f462f3c12a6ede84cb09.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nq8-FzOufAHVWIAaj29olQ.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk">Word vector of a few choice words</figcaption></figure><p id="7271" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">还是不太好玩。所有这些数字只会让我头晕。</p><p id="6756" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">FastText 允许您查询最近的邻居，这允许我们查看单词向量是否正确地捕捉了单词之间的语义关系。</p><p id="370f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为此，我们运行<code class="fe kl km kn ko b">nn</code>命令。</p><p id="bbe5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe kl km kn ko b">./fasttext nn model.bin</code></p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/339aa9d0e04b7270c418ad9d282f9d29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1352/format:webp/1*kuRFIk0Rtjogj2UizWWrig.png"/></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk">Nearest Neighbors for the word “imagination”</figcaption></figure><p id="6ac0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我的训练词汇库可能太小，我不确定为什么<code class="fe kl km kn ko b">extermination</code>排在<code class="fe kl km kn ko b">imagination</code>的最近邻。无论如何也想象不到。那么我不经常理解机器的内部工作。</p><p id="1094" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">文本分类</strong></p><p id="182f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于文本分类，我使用了公开可用的<code class="fe kl km kn ko b">Yahoo Answers</code>数据(<a class="ae kp" href="https://github.com/niderhoff" rel="noopener ugc nofollow" target="_blank">nider hoff</a>/<a class="ae kp" href="https://github.com/niderhoff/nlp-datasets" rel="noopener ugc nofollow" target="_blank">NLP-datasets</a>有一个完整的公共领域数据集列表，其中包含用于自然语言处理的文本数据)。</p><p id="47c3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在将我的数据插入 fastText 的训练机器之前，我做了一些轻微的处理，所以格式符合要求(文本文件的每一行都包含一个标签列表，后面跟着相应的文档。所有标签都以<code class="fe kl km kn ko b">__label__</code>前缀开头)。</p><p id="ab28" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在是训练时间。</p><p id="5c59" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe kl km kn ko b">./fasttext supervised -input data/yahoo_answers_csv/train_modified.csv -output model_yahoo_answers</code></p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi lq"><img src="../Images/1de45a78ae52c0cdccdb506388075236.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7HDIClQE7CMeOLoCEOFgxQ.png"/></div></div></figure><p id="b3f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">预测时间:</p><p id="f9ec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe kl km kn ko b">./fasttext predict model_yahoo_answers.bin -</code></p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div role="button" tabindex="0" class="ld le di lf bf lg"><div class="gh gi lr"><img src="../Images/497bc1c1885150dbac62ac66021bf6a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JITpyIUVDMDXlTcd3ieZMg.png"/></div></div><figcaption class="lj lk gj gh gi ll lm bd b be z dk">fastText Predictions After Training</figcaption></figure><p id="8dd7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以 fastText 将第一个问题归类为<code class="fe kl km kn ko b">1. Society &amp; Culture</code>，第二个问题归类为<code class="fe kl km kn ko b">Education &amp; Reference</code>，第三个问题归类为<code class="fe kl km kn ko b">7. Business and Finance</code></p><p id="dd77" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我看来没错。</p><p id="6980" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用测试数据集，我们可以通过检查精度和召回值来衡量训练模型的质量。</p><p id="1fe9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe kl km kn ko b">./fasttext test model_yahoo_answers.bin data/yahoo_answers_csv/test_modified.csv</code></p><figure class="ky kz la lb gt lc gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/f7b4b789f535cba3d1dc1cd1766ae238.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*OJBWqulll67uCIcFVTjemA.png"/></div></figure><p id="bbda" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，在只有 60，000 个问题的测试数据集下，只需几秒钟的训练，fastText 的精度和召回率为 0.652。</p><p id="5060" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">终于……</strong></p><p id="f6e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">fastText 确实又快又棒，但是，学习和写它几乎花了我一辈子的时间(不得不吃饭、睡觉、网飞等等)。又多了一个不要让我迟钝的生物大脑手动做任何事情的理由。</p></div></div>    
</body>
</html>