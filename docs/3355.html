<html>
<head>
<title>Song Popularity Predictor</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">歌曲流行度预测器</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/song-popularity-predictor-1ef69735e380?source=collection_archive---------6-----------------------#2018-05-05">https://towardsdatascience.com/song-popularity-predictor-1ef69735e380?source=collection_archive---------6-----------------------#2018-05-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/7506ebf07735af5f8e4e0463155810f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x5c-_EFqJkC2NOBeYnGv1A.png"/></div></div></figure><p id="5bef" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Mohamed Nasreldin、Stephen Ma、Eric Dailey、Phuc Dang的项目</p><p id="7f07" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">简介</strong></p><p id="7d4c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kx" href="https://www.youtube.com/watch?v=M0be5674X9Y&amp;feature=youtu.be&amp;t=12m45s" rel="noopener ugc nofollow" target="_blank"> DJ Khaled大胆宣称总能知道一首歌什么时候会流行。我们决定通过问三个关键问题来进一步调查:热门歌曲是否有某些特征，对一首歌的成功影响最大的因素是什么，以及老歌甚至可以预测新歌的受欢迎程度吗？预测一首歌会有多流行不是一件容易的事。为了回答这些问题，我们利用了哥伦比亚提供的</a><a class="ae kx" href="https://labrosa.ee.columbia.edu/millionsong/" rel="noopener ugc nofollow" target="_blank">百万首歌曲数据集</a>，Spotify的API，以及机器学习预测模型。我们提出了一个模型，可以预测一首歌有多大可能成为热门歌曲，通过将其列入Billboard的前100名来定义，准确率超过68%。</p><p id="09d4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">背景</strong></p><p id="3b56" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kx" href="https://www.billboard.com/articles/business/8257558/us-music-industry-2017-highest-revenue-in-decade-fueled-paid-subscriptions" rel="noopener ugc nofollow" target="_blank">2017年，仅在美国，音乐产业就创造了87.2亿美元的收入。</a>由于流媒体服务(Spotify、Apple Music等)的增长，这个行业继续繁荣发展。流行歌曲获得了大部分收入。<a class="ae kx" href="https://www.forbes.com/sites/zackomalleygreenburg/2017/12/06/the-worlds-highest-paid-musicians-of-2017/#7ea9fe51530e" rel="noopener ugc nofollow" target="_blank">2016年前10名艺人总共创造了3.625亿美元的收入。关于是什么让一首歌流行的问题在</a>之前已经被研究过，并取得了不同程度的成功。每首歌曲都有关键特征，包括歌词、时长、艺术家信息、温度、节拍、音量、和弦等。先前的研究认为歌词可以预测一首歌的受欢迎程度，但收效甚微。</p><p id="5d6e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">数据采集&amp;预处理</strong></p><p id="489f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">获取数据</strong></p><p id="d88c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">选择的数据集是哥伦比亚大学提供的<a class="ae kx" href="https://labrosa.ee.columbia.edu/millionsong/" rel="noopener ugc nofollow" target="_blank">百万首歌曲数据集</a>，从Echo Nest中拉出。我们选择这个数据集是因为它有大量的特征和大小。这个数据集的主要问题是提供的格式。为每首歌曲提供了单独的h5文件。提供了一个脚本来将数据集转换为mat文件，以便在matlab中使用。我们修改了脚本，以便它可以生成一个csv，我们可以用它来训练我们的模型。数据集也太大了。所有100万首歌曲的容量约为280 GB。谢天谢地，有一个随机选择的子集，只有10，000首歌曲。</p><p id="93b8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">数据集中的每首歌曲都包含41个特征，通过音频分析、艺术家信息和歌曲相关特征进行分类。</p><p id="6829" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">音频分析功能:速度，持续时间，模式，响度，关键，拍号，部分开始</p><p id="b8fb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">艺术家相关特征:艺术家熟悉度、艺术家受欢迎程度、艺术家姓名、艺术家位置</p><p id="3473" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">歌曲相关特征:版本，标题，年份，歌曲热度</p><p id="c001" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">刮广告牌歌曲</strong></p><p id="cc7e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">百万首歌曲数据集中的原始数据带有歌曲热度特征。然而，大约有4500首歌曲没有这个功能，这几乎是我们使用的子集的一半。因此，我们想找到一种新的方法来分类一首歌是否流行。我们决定使用BillBoard Top 100来确定受欢迎程度。如果一首歌至少出现在100强排行榜上一次，那么它将被列为热门歌曲。</p><p id="51da" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们使用BeautifulSoup编写python脚本来抓取billboard.com，得到1958年到2012年出现在排行榜上的所有歌曲。我们停在了2012年，因为数据集中最近的歌曲都是在2012年发布的。在获得billboard上的歌曲列表后，我们回到我们的10，000首歌曲数据集，并相应地对它们进行分类。在我们的数据集中的10，000首歌曲中，有1192首被归类为热门歌曲。</p><p id="3af1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">清洗数据集</strong></p><p id="566f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">由于旧的不推荐使用的数据，数据集中的许多字段不可用。许多数据字段丢失，并且没有echonest API来填充数据，因为API被Spotify修改了。因此，许多领域不得不放弃。有些要素只缺少合理的数量，我们决定用平均值来填充缺少的值。一个例子是艺术家熟悉度字段，它只有10个缺失值。</p><p id="784e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">艺术家ID和模式这两个要素被修改，以更好地反映它们在数据集中的属性。数据中的每个艺术家都由一个字符串唯一标识，所以我们决定对他们进行标签编码。调式是歌曲在制作过程中使用大调还是小调。虽然这个值很简单，0表示次要，1表示主要，但是还有一个名为mode_confidence的值，它描述了所选模式准确的概率。有了这两个值，我们组合了从-1(小调)到1(大调)的特性。值-1表示100%确信该键是次要的，1表示100%确信该键是主要的。小调的置信度范围在-1和0之间，大调的置信度范围在0和1之间。这大大增加了这个值的重要性，我们将在下一节看到。</p><p id="e4e6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">该过程可以总结如下:</p><ol class=""><li id="d8b9" class="ky kz iq ka b kb kc kf kg kj la kn lb kr lc kv ld le lf lg bi translated">从labrosa Columbia下载数据子集</li><li id="2b4c" class="ky kz iq ka b kb lh kf li kj lj kn lk kr ll kv ld le lf lg bi translated">将数据格式从h5转换为数据帧</li><li id="0bda" class="ky kz iq ka b kb lh kf li kj lj kn lk kr ll kv ld le lf lg bi translated">刮掉出现在排行榜前100名歌曲</li><li id="98e3" class="ky kz iq ka b kb lh kf li kj lj kn lk kr ll kv ld le lf lg bi translated">数据中的分类歌曲</li><li id="c182" class="ky kz iq ka b kb lh kf li kj lj kn lk kr ll kv ld le lf lg bi translated">清理数据集</li></ol><figure class="ln lo lp lq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lm"><img src="../Images/80de4c632f567db20056dfc576e65270.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*r95SLYVBpZaDw5Fn."/></div></div></figure><p id="9c65" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">数据探索</strong></p><p id="4995" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在收集数据并对其进行清理以供使用后，我们通过研究特征的重要性、数据集中的趋势以及确定这些特征的最佳值，继续进行数据探索。</p><p id="5dae" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">特征重要性</strong></p><figure class="ln lo lp lq gt jr gh gi paragraph-image"><div class="gh gi lr"><img src="../Images/36c4621f783874aafe0ce99c76ecf877.png" data-original-src="https://miro.medium.com/v2/resize:fit:784/0*Ol-1Y8Kc0A7F2TIt."/></div></figure><p id="640c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这里，我们可以看到最终数据集中每个要素的f1值。我们在这里可以看到一个有趣的趋势，即歌曲的实际音乐方面与艺术家信息合理地纠缠在一起。诸如速度、模式和响度之类的技术特征与诸如熟悉度、热度和辨识度之类的艺术家信息一样重要。</p><p id="e1bb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">艺人熟悉度</strong></p><p id="c0f4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">艺人熟悉度与歌曲热度</p><figure class="ln lo lp lq gt jr gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/be5d75481cf0069e28a825d83ff3312f.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/0*zUDc-53ayA-usri8."/></div></figure><p id="3017" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如我们所料，艺术家的熟悉程度与热度值相关。Y轴是根据歌曲热度Y，其中0是最低分，1是最高分。熟悉度在x轴上，范围也是从0到1，根据Echo Nest的算法描述艺术家的“熟悉”程度。当这个值接近1时，歌曲的热度也接近1(谁能想到呢？).</p><p id="3a1e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">艺人位置</strong></p><p id="8f7f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">艺人经度vs歌曲热度</p><figure class="ln lo lp lq gt jr gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/ee73908f03e19cb25534f5ab1ade7fba.png" data-original-src="https://miro.medium.com/v2/resize:fit:778/0*lUjaIBIpIRAaQ8Lx."/></div></figure><p id="0afd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们也可以在上面的图表中看到一些有趣的趋势。虽然通常在也产生点击的区域中有更多的活动，但是我们可以看到点击集中在这些特定的区域。大多数活动来自世界的西部，在北美，我们也可以看到东海岸和西海岸之间的分界线。因此，我们可以期待模型使用这一点来预测一首歌是否是热门歌曲。</p><p id="efd5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">速度和持续时间</strong></p><figure class="ln lo lp lq gt jr gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/3ae50ae7e643867fee7c12b722602447.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/0*Tn-3jxIQ4c1jBT0l."/></div></figure><figure class="ln lo lp lq gt jr gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/8d329626c0133f882c608b01ceecee02.png" data-original-src="https://miro.medium.com/v2/resize:fit:1008/0*Z4V4ejedzWJRi7jQ."/></div></figure><p id="d829" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们对热门歌曲的分布感兴趣，所以我们隔离了热度值为1的所有歌曲，并绘制了这些歌曲的不同特征的分布。我们可以看到，热门歌曲通常使用的节奏有一个范围，在这个范围内有两个峰值，分别为100 bpm和135 bpm。热门歌曲的时长平均在200秒左右，一般在3到4分钟之间。</p><figure class="ln lo lp lq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lu"><img src="../Images/221604ab1a070f3ddb682b763927e682.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yYUrQZMWBjVwo77iObPgwQ.png"/></div></div><figcaption class="lv lw gj gh gi lx ly bd b be z dk">Optimal values for key selected features</figcaption></figure><p id="bfcb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于登上Billboard前100名的歌曲，我们研究了之前使用f1评分检测到的一些顶级特征的平均值和标准偏差，结果相当合理。节奏约为122 bpm，标准偏差为33 bpm，艺术家熟悉度为61%，标准偏差为16%，大多数歌曲都是大调，但标准偏差相当大，响度约为-10 dB，艺术家热度约为0.43。艺术家信息显示，这些艺术家中的大多数都是“昙花一现”，因为他们缺乏热情和熟悉度。</p><p id="3479" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">模式选择&amp;调谐</strong></p><p id="7d3c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们在不同的模型上训练我们的数据来预测一首歌是否是热门歌曲。在调整之前，Xgboost在0.63曲线下面积(AUC)分数处似乎是具有最高准确度的。下表显示了我们尝试的一些模型的结果。</p><figure class="ln lo lp lq gt jr gh gi paragraph-image"><div class="gh gi lz"><img src="../Images/cb4eadc6a39668f1eb417c4a1b47c886.png" data-original-src="https://miro.medium.com/v2/resize:fit:1012/0*5Tbtu7nDpub0DgTY."/></div><figcaption class="lv lw gj gh gi lx ly bd b be z dk">Models considered and their AUC scores</figcaption></figure><p id="4249" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在XGBoost上进行网格搜索以进一步提高AUC分数。每个参数都进行了调整，一些值同时被过度调整。例如，n估计值和学习率被一起调整，因为较高的n估计值需要较低的学习率来产生最佳结果。调整后AUC值从0.632增加到0.68。随机预测将产生0.5的AUC分数。</p><p id="e75b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">结果</strong></p><p id="84a3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这个项目展示了预测音乐热度的可能性，确定了流行音乐的趋势，并使用Spotify的API开发了特征提取工具。XGBoost在训练模型上提供了最佳预测，AUC得分为0.68。</p><p id="08bb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们决定用我们的模型预测一些新歌。下面的演示展示了<a class="ae kx" href="https://github.com/manasreldin/Song-Popularity-Predictor/blob/master/Demo101.ipynb" rel="noopener ugc nofollow" target="_blank">我们的脚本</a>的运行。</p><figure class="ln lo lp lq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ma"><img src="../Images/a313bdb1d9d11b561e692d32b215f2d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*N3cd9gv_qu89dN3rC046ng.gif"/></div></div></figure><p id="5836" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">自从Spotify收购EchoNest以来，许多不同的功能都发生了变化，包括通过ID查找歌曲信息的简单方法。因此，这个演示使用了一种非常迂回的方式来获取歌曲信息。首先，使用API上的搜索端点运行搜索，以获取Spotify ID。使用Spotify ID音频功能和深入的音频分析，可以抓取歌曲。然后进行一些功能工程，以便将Spotify数据转换回可用于我们模型的格式。我们开发的用于将Spotify API数据映射到我们的训练数据的脚本可以在这里查看<a class="ae kx" href="https://github.com/manasreldin/Song-Popularity-Predictor/blob/master/demo.py" rel="noopener ugc nofollow" target="_blank"/>。</p><p id="929a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">以下是我们的模型预测的其他一些歌曲的结果，以及与Spotify hotness结果进行比较的结果:</p><figure class="ln lo lp lq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mb"><img src="../Images/d22fc2a317c115b541263ce30c0d8c28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-euP5X1BQaP97R_e4FNbug.png"/></div></div></figure><p id="96f8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">结论</strong></p><p id="ea82" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这项工作中，我们不确定是否有可能比随机预测更好地预测一首歌是否会流行。在对来自Spotify的新歌测试我们的模型后，我们观察到正确预测一首坏歌比预测一首热门歌曲简单得多。预测非热门歌曲可能更容易，因为我们的数据是倾斜的，只有1200首热门歌曲。接下来，我们将探讨艺术家所在地或发行日期等其他特征如何影响歌曲的受欢迎程度。此外，我们可以考虑使用完整的数据集，看看是否可以改进我们的模型。另一种选择是使用Spotify API来收集我们自己的数据。</p><p id="493e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">虽然DJ Khaled没有配备强大的数据科学和机器学习工具，但他是正确的，热门歌曲中确实存在某些趋势。</p><p id="a442" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kw">完整源代码可以在这里查看</em><a class="ae kx" href="https://github.com/manasreldin/Song-Popularity-Predictor" rel="noopener ugc nofollow" target="_blank"><em class="kw"/></a></p></div></div>    
</body>
</html>