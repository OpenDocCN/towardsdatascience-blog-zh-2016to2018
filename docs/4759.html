<html>
<head>
<title>Installing OpenCV 3.4.3 on Raspberry Pi 3 Model B+</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在树莓 Pi 3 模型 B+上安装 OpenCV 3.4.3</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/installing-opencv-3-4-3-on-raspberry-pi-3-model-b-e9af08a9f1d9?source=collection_archive---------7-----------------------#2018-09-05">https://towardsdatascience.com/installing-opencv-3-4-3-on-raspberry-pi-3-model-b-e9af08a9f1d9?source=collection_archive---------7-----------------------#2018-09-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="4b8d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我之前写了一个分步指南，展示如何让 OpenCV 3.4.1 在一个 Raspberry Pi 3 B 上运行。从那时起，我已经完成了一些安装，所以这里有一个新的、简化的过程来获得 OpenCV 3.4.1(最新版本！)在您的 Raspberry Pi 3 B plus 上运行。</p><p id="3a66" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为什么是 3.4.1？它提供了一个改进的 DNN 模块和许多<a class="ae kl" href="https://github.com/opencv/opencv/releases" rel="noopener ugc nofollow" target="_blank">其他改进</a>和错误修复。总的来说，自从 OpenCV 3.4.0 以来，已经集成了大约 250 个补丁，关闭了 200 多个问题。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/4350df739f4216d2fffc176cec288c68.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5jnFJIw4rVT3s8po.jpg"/></div></div></figure><p id="6bb1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">警告:编译 OpenCV 是一项 CPU 密集型任务——所有 4 个内核都将因 1 个内核而达到极限..两个小时。为了避免过热，确保你的树莓派有<a class="ae kl" href="https://amzn.to/2PJP0Ft" rel="noopener ugc nofollow" target="_blank">散热器</a>和<a class="ae kl" href="https://amzn.to/2PIiIKV" rel="noopener ugc nofollow" target="_blank">风扇</a>(或者在旁边放一个强大的外部风扇)。不，它不会因过热而死亡，但它会抑制其 CPU 性能，潜在地将构建时间从 2 小时增加到 6 小时，您可能不希望这样。</p><p id="f7ea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是新的流程:</p><p id="1290" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第一步:确保你的操作系统是最新的。(&lt;5 分钟)</p><p id="ee6b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当前 OS 版本为<a class="ae kl" href="https://www.raspberrypi.org/downloads/raspbian/" rel="noopener ugc nofollow" target="_blank">Raspbian Stretch</a>(2018 年 4 月)。您可以从 SD 进行全新安装(遵循此处<a class="ae kl" href="https://www.raspberrypi.org/documentation/installation/installing-images/README.md" rel="noopener ugc nofollow" target="_blank">列出的说明</a>)，或者升级您现有的版本。</p><p id="3a3c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要升级，请在您最喜欢的编辑器中打开(以 sudo 身份)文件<em class="ky"> /etc/apt/sources.list </em>和<em class="ky">/etc/apt/sources . list . d/raspi . list</em>，并将当前发行版名称(如“jessie”)的所有出现处更改为“stretch”。然后，打开终端并运行更新:</p><pre class="kn ko kp kq gt kz la lb lc aw ld bi"><span id="d57b" class="le lf iq la b gy lg lh l li lj">sudo apt-get update <br/>sudo apt-get -y dist-upgrade</span></pre><p id="ccbe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您已经在运行 Stretch，只需在继续之前更新所有软件包:</p><pre class="kn ko kp kq gt kz la lb lc aw ld bi"><span id="04b1" class="le lf iq la b gy lg lh l li lj">sudo apt-get update <br/>sudo apt-get upgrade</span></pre><p id="422a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第二步:配置 SSH 和实用程序</strong>(&lt;2 分钟)</p><p id="5ab8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">确保 SSH 已启用<a class="ae kl" href="https://www.raspberrypi.org/documentation/remote-access/ssh/" rel="noopener ugc nofollow" target="_blank"/>。也更改默认密码！</p><p id="9335" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我在 Linux 上最喜欢的一些实用程序是<em class="ky"> screen </em>(如果您的终端会话丢失，保持进程运行)和<em class="ky"> htop </em>(性能监控)——这些可能已经预装了:</p><pre class="kn ko kp kq gt kz la lb lc aw ld bi"><span id="2fc6" class="le lf iq la b gy lg lh l li lj">sudo apt-get install screen <br/>sudo apt-get install htop</span></pre><p id="d879" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第三步:放弃 Wolfram 和 Libreoffice，释放 1GB+(2 分钟)</strong></p><p id="5350" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您的计算机视觉系统不太可能需要这两个软件包，因此:</p><pre class="kn ko kp kq gt kz la lb lc aw ld bi"><span id="4707" class="le lf iq la b gy lg lh l li lj">sudo apt-get purge wolfram-engine <br/>sudo apt-get purge libreoffice* <br/>sudo apt-get clean <br/>sudo apt-get autoremove</span></pre><p id="6991" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第四步:安装依赖关系</strong>(&lt;10 分钟)</p><pre class="kn ko kp kq gt kz la lb lc aw ld bi"><span id="a8e9" class="le lf iq la b gy lg lh l li lj">sudo apt-get install build-essential cmake pkg-config </span><span id="bc8f" class="le lf iq la b gy lk lh l li lj">sudo apt-get install libjpeg-dev libtiff5-dev libjasper-dev libpng12-dev </span><span id="a1c0" class="le lf iq la b gy lk lh l li lj">sudo apt-get install libavcodec-dev libavformat-dev libswscale-dev libv4l-dev </span><span id="05fa" class="le lf iq la b gy lk lh l li lj">sudo apt-get install libxvidcore-dev libx264-dev </span><span id="83ac" class="le lf iq la b gy lk lh l li lj">sudo apt-get install libgtk2.0-dev libgtk-3-dev </span><span id="2a35" class="le lf iq la b gy lk lh l li lj">sudo apt-get install libatlas-base-dev gfortran</span></pre><p id="2033" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第五步:安装 Python 3</strong>(&lt;2 分钟)</p><p id="0e10" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了在 Open CV 中启用 Python <a class="ae kl" href="https://docs.opencv.org/3.2.0/da/d49/tutorial_py_bindings_basics.html" rel="noopener ugc nofollow" target="_blank">绑定</a>，我们需要这样做:</p><blockquote class="ll lm ln"><p id="d2a7" class="jn jo ky jp b jq jr js jt ju jv jw jx lo jz ka kb lp kd ke kf lq kh ki kj kk ij bi translated"><em class="iq">在 OpenCV 中，所有算法都是用 C++实现的。但是这些算法可以在不同的语言中使用，如 Python、Java 等。这是由绑定生成器实现的。这些生成器在 C++和 Python 之间架起了一座桥梁，使用户能够从 Python 中调用 C++函数。要全面了解后台发生的事情，需要对 Python/C API 有很好的了解。关于将 C++函数扩展到 Python 的一个简单例子可以在官方 Python 文档中找到[1]。因此，通过手动编写包装函数将 OpenCV 中的所有函数扩展到 Python 是一项耗时的任务。所以 OpenCV 以一种更智能的方式来做这件事。OpenCV 使用位于 modules/python/src2 </em>中的一些 Python 脚本从 C++头文件自动生成这些包装函数</p></blockquote><pre class="kn ko kp kq gt kz la lb lc aw ld bi"><span id="2134" class="le lf iq la b gy lg lh l li lj">sudo apt-get install python3-dev</span></pre><p id="e2f8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第六步:安装 pip 3</strong>(&lt;2 分钟)</p><pre class="kn ko kp kq gt kz la lb lc aw ld bi"><span id="d372" class="le lf iq la b gy lg lh l li lj">sudo apt-get install python3-pip</span></pre><p id="f1b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第七步:获取最新的(3.4.3) OpenCV 源代码</strong> ( &lt; 5min)</p><p id="6f17" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我使用的是 OpenCV 的 3.4.3 版本。你可以查看官方网站(或 Github)的<a class="ae kl" href="https://opencv.org/releases.html" rel="noopener ugc nofollow" target="_blank">版本</a>部分，看看当前的版本是什么。如果您想要的版本不同，请相应地更新下面的命令和路径。</p><p id="55e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下载并解压 OpenCV 3.4.3 及其实验模块(存储在<a class="ae kl" href="https://github.com/opencv/opencv_contrib" rel="noopener ugc nofollow" target="_blank"> opencv_contrib </a>库):</p><pre class="kn ko kp kq gt kz la lb lc aw ld bi"><span id="825d" class="le lf iq la b gy lg lh l li lj">wget -O opencv.zip <a class="ae kl" href="https://github.com/opencv/opencv/archive/3.4.3.zip" rel="noopener ugc nofollow" target="_blank">https://github.com/opencv/opencv/archive/3.4.3.zip</a> wget -O opencv_contrib.zip </span><span id="fbcf" class="le lf iq la b gy lk lh l li lj"><a class="ae kl" href="https://github.com/opencv/opencv_contrib/archive/3.4.3.zip" rel="noopener ugc nofollow" target="_blank">https://github.com/opencv/opencv_contrib/archive/3.4.3.zip</a> unzip opencv.zip unzip opencv_contrib.zip</span></pre><p id="6eff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">步骤 8:安装 Numpy，Scipy</strong>(&lt;3 分钟)</p><pre class="kn ko kp kq gt kz la lb lc aw ld bi"><span id="b195" class="le lf iq la b gy lg lh l li lj">sudo pip3 install numpy scipy</span></pre><p id="7f91" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第九步:编译 OpenCV</strong>(&lt;10 分钟)</p><p id="eb68" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意:这一步需要很长时间。在我的设备上花了将近 2 个小时。此外，如果没有适当的冷却，您的覆盆子酱会过热。</p><p id="6d99" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">同样，我使用的是 OpenCV 的 3.4.3 版本。如果不是，请相应地更新您的路径:</p><pre class="kn ko kp kq gt kz la lb lc aw ld bi"><span id="0c37" class="le lf iq la b gy lg lh l li lj">cd ~/opencv-3.4.3/ <br/>mkdir build <br/>cd build </span><span id="7d4c" class="le lf iq la b gy lk lh l li lj">cmake -D CMAKE_BUILD_TYPE=RELEASE \ <br/>    -D CMAKE_INSTALL_PREFIX=/usr/local \ <br/>    -D INSTALL_PYTHON_EXAMPLES=ON \ <br/>    -D OPENCV_EXTRA_MODULES_PATH=~/opencv_contrib-3.4.3/modules \ <br/>    -D BUILD_EXAMPLES=ON ..</span></pre><p id="f155" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请确保 cmake 完成时没有错误。</p><p id="80af" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">第十步:构建 OpenCV</strong>(90-120 分钟)</p><p id="79d4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果您使用全部四个 CPU 核心，这将运行得更快:</p><pre class="kn ko kp kq gt kz la lb lc aw ld bi"><span id="84c3" class="le lf iq la b gy lg lh l li lj">make -j4</span></pre><p id="5d4a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦 OpenCV 构建成功，继续安装:</p><pre class="kn ko kp kq gt kz la lb lc aw ld bi"><span id="560e" class="le lf iq la b gy lg lh l li lj">sudo make install <br/>sudo ldconfig <br/>sudo apt-get update</span></pre><p id="f0ef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">…然后重新启动系统，您就可以开始了！</p><pre class="kn ko kp kq gt kz la lb lc aw ld bi"><span id="c02f" class="le lf iq la b gy lg lh l li lj">sudo reboot</span></pre><p id="f333" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">步骤 11:测试你的 OpenCV 安装</strong>(&lt;1 分钟)</p><pre class="kn ko kp kq gt kz la lb lc aw ld bi"><span id="19b2" class="le lf iq la b gy lg lh l li lj">$ python3 Python 3.5.3 (default, September 5 2018, 14:11:04) <br/>[GCC 6.3.0 20170124] on linux <br/>Type "help", "copyright", "credits" or "license" for more information. <br/>&gt;&gt;&gt; import cv2 <br/>&gt;&gt;&gt; cv2.__version__ <br/>'3.4.3' <br/>&gt;&gt;&gt;</span></pre><p id="c5f4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">欢迎评论和建议！</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi lr"><img src="../Images/f1ee94416072e367eccb6fb1d396807a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*rBN0sjvxev3meGrN.JPG"/></div></div></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="8cee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ky">原载于 2018 年 9 月 5 日</em><a class="ae kl" href="https://www.alatortsev.com/2018/09/05/installing-opencv-3-4-3-on-raspberry-pi-3-b/" rel="noopener ugc nofollow" target="_blank"><em class="ky">www.alatortsev.com</em></a><em class="ky">。</em></p></div></div>    
</body>
</html>