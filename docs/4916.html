<html>
<head>
<title>Simple Method of Creating Animated Graphs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">创建动画图形的简单方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/simple-method-of-creating-animated-graphs-127c11f58cc5?source=collection_archive---------6-----------------------#2018-09-15">https://towardsdatascience.com/simple-method-of-creating-animated-graphs-127c11f58cc5?source=collection_archive---------6-----------------------#2018-09-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="753d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated"><strong class="ak">数据科学工具包</strong></h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/9f28d24e53a2516c26d52cda273ee366.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*RnK3Jt2EWZ015HLY9QpfRw.gif"/></div></div></figure><h1 id="f858" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">介绍</h1><p id="6d88" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi mf translated"><span class="l mg mh mi bm mj mk ml mm mn di">答</span>在我最近的一篇<a class="ae mo" rel="noopener" target="_blank" href="/https-medium-com-piotr-skalski92-deep-dive-into-deep-networks-math-17660bc376ba">文章</a>发表后，许多人向我询问如何用 Python 制作动画图表的技巧。事实上，经常会出现静态图表已经不够用的情况，为了说明我们正在处理的问题，我们需要更强大的工具。当然，有许多库允许我们制作动画，有时甚至是交互式图形，比如 Bokeh、Pygal 或我个人最喜欢的 Plotly。然而，这一次我们将采用传统的方法——我将向您展示如何仅使用“简单的”Matplotlib 和一些命令行技巧来创建令人印象深刻的图表。在文章中，我将只放置代码中最重要的部分。但是在我的<a class="ae mo" href="https://github.com/SkalskiP/ILearnDeepLearning.py" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上，你可以找到用来创建可视化展示的完整笔记本。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/00da678b0e09165e0041ae92ab4d815d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1152/1*KteGDjA9gflRcRcEThpy4w.gif"/></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk">Figure 1. Gradient descent visualization coming from my previous <a class="ae mo" rel="noopener" target="_blank" href="/https-medium-com-piotr-skalski92-deep-dive-into-deep-networks-math-17660bc376ba">article</a></figcaption></figure><h1 id="ac6d" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">Matplotlib 动画 API</h1><p id="528b" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi mf translated">寻找我可以在这篇文章中使用的有趣的例子，我决定说明洛伦兹吸引子。其优雅的形式和独特的属性使其成为创造引人注目的视觉效果的绝佳材料。洛伦兹吸引子以对几乎相同的初始条件产生完全不同的结果而闻名。让我们尝试使用 Matplotlib 库中的专用动画 API 来可视化这个属性。我们将在三维空间中创建三个独立的轨迹，并呈现它们在不同时间点的行为。首先，当然，我们必须导入所有必要的依赖项。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="8aa5" class="pw-post-body-paragraph lj lk iq ll b lm mw jr lo lp mx ju lr ls my lu lv lw mz ly lz ma na mc md me ij bi translated">将帮助我们执行动画的类是<code class="fe nb nc nd ne b">FuncAnimation</code> ( <a class="ae mo" href="https://matplotlib.org/api/_as_gen/matplotlib.animation.FuncAnimation.html#matplotlib.animation.FuncAnimation" rel="noopener ugc nofollow" target="_blank">链接</a>)。然而，为了使用它，我们首先必须准备一个基本的空图表和一个函数，该函数将在每次迭代中执行，以更新当前帧中呈现的数据。在我的例子中，创建和样式化图表的过程被提取到一个单独的辅助函数中— <code class="fe nb nc nd ne b">create_blank_chart_with_styling</code>，您可以在完整的笔记本中查看它的细节。在其他事情中，它负责选择背景颜色，调用轴或缩放它们。创建图表后，我们还定义(目前为空)数据序列，用符号表示相应的轨迹。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="d24e" class="pw-post-body-paragraph lj lk iq ll b lm mw jr lo lp mx ju lr ls my lu lv lw mz ly lz ma na mc md me ij bi translated">我们动画的核心是图表更新功能，它将当前渲染帧的索引作为参数，并确保在图表上显示一组适当的数据。在版本中，我在每一帧中使用 Matplotlib，获取一个我们在构造函数中提供的干净的图形，并将当前选择的数据添加到其中。这意味着在每一帧中，我必须添加我想要显示的所有元素。顺便说一句，值得注意的是，该库还包含另一种模式，即在上一次迭代中获得的图中添加更多元素。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mu mv l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/7fd62a1fa2646f03db1bc768d5d372ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/1*9LSkj7qorRehxmfWe63FGw.gif"/></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk">Figure 2. Lorenz Attractor created using the Matplotlib animation API</figcaption></figure><p id="3b3a" class="pw-post-body-paragraph lj lk iq ll b lm mw jr lo lp mx ju lr ls my lu lv lw mz ly lz ma na mc md me ij bi translated">最后，我们创建一个<code class="fe nb nc nd ne b">FuncAnimation</code>类的实例，给出参数:初始图形、更新函数、帧数以及它们应该改变的时间间隔。我们现在可以选择输出文件格式和我们的动画质量。我们工作的结果可以在图 2 中看到。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mu mv l"/></div></figure><h1 id="8b9f" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">让我们阅读神经网络思想</h1><p id="3bba" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi mf translated"><span class="l mg mh mi bm mj mk ml mm mn di"> M </span> atplotlib 动画 API 很棒，但我经常选择将单独的帧渲染为 png 图像，然后使用<a class="ae mo" href="https://www.imagemagick.org/script/index.php" rel="noopener ugc nofollow" target="_blank"> ImageMagick </a>将它们组合成一个移动的 gif 这是一个在 Linux、Mac 以及 Windows 上可用的非常有用的工具。我这样做是因为创建一个更新图表的函数并不总是那么明显和方便——例如，当我们想要可视化我们的神经网络的学习过程时，使用<a class="ae mo" href="https://keras.io/" rel="noopener ugc nofollow" target="_blank"> Keras </a>进行训练。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/829d2c24b8356b6cf9c2755ce9bc482a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vy_hxEZ4P3IYgqqvOIaD0Q.png"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk">Figure 3. Fages obtained in successive epochs of neural network learning process.</figcaption></figure><p id="5986" class="pw-post-body-paragraph lj lk iq ll b lm mw jr lo lp mx ju lr ls my lu lv lw mz ly lz ma na mc md me ij bi translated">由于使用了<code class="fe nb nc nd ne b">keras.callbacks.LambdaCallback</code> ( <a class="ae mo" href="https://keras.io/callbacks/#lambdacallback" rel="noopener ugc nofollow" target="_blank"> link </a>)，我们可以在每次迭代后访问我们的模型，收集所有必要的数据并进行可视化。我们所要做的就是将我们的渲染方法作为<code class="fe nb nc nd ne b">.fit()</code>方法的一个参数来传递。我为完成这项任务而创建的函数如下所示。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="3764" class="pw-post-body-paragraph lj lk iq ll b lm mw jr lo lp mx ju lr ls my lu lv lw mz ly lz ma na mc md me ij bi translated">假设我们已经定义了模型的架构(参见如何做)，我们现在可以开始训练了。让我们不要忘记添加我们的回调。我们可以这样做。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="3d42" class="pw-post-body-paragraph lj lk iq ll b lm mw jr lo lp mx ju lr ls my lu lv lw mz ly lz ma na mc md me ij bi translated">结果，在每个时期，我们未来动画的一个单独的帧被创建。获得的所有图像在图 3 中并排显示。现在我们唯一要做的就是将它们相互结合，创造出流畅的动画。幸运的是，使用 ImageMagic，我们只需要一个命令。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mu mv l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/9b62a4e1218524732233686a91655889.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*p6cuDGrZVScJDanig90Sog.gif"/></div></div><figcaption class="mq mr gj gh gi ms mt bd b be z dk">Figure 4. Visualization showing the boundaries of classification during the neural network learning process.</figcaption></figure><h1 id="dd9f" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">结论</h1><p id="1d12" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi mf translated">我希望我的提示和例子对你有所帮助，你会在工作中、在大学里或者在下一篇关于媒体的文章中用到它们。你需要的只是一点创造力和一些空闲时间。如果你喜欢这篇文章，分享出来，在<a class="ae mo" href="https://twitter.com/PiotrSkalski92" rel="noopener ugc nofollow" target="_blank"> Twitter </a>和<a class="ae mo" href="https://medium.com/@piotr.skalski92" rel="noopener"> Medium </a>上关注我，在<a class="ae mo" href="https://github.com/SkalskiP" rel="noopener ugc nofollow" target="_blank"> GitHub </a>和<a class="ae mo" href="https://www.kaggle.com/skalskip" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>上查看我正在做的其他项目。保持好奇！</p></div><div class="ab cl nh ni hu nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="ij ik il im in"><div class="kg kh ki kj gt ab cb"><figure class="no kk np nq nr ns nt paragraph-image"><a href="https://github.com/SkalskiP"><img src="../Images/1b80f8b538789fdbeec0bad521027727.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*THfv7r3HcS8UstUXqhwaXQ.png"/></a></figure><figure class="no kk np nq nr ns nt paragraph-image"><a href="https://medium.com/@piotr.skalski92"><img src="../Images/c5d4d5508df3e952143ebe77fc0893a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*awX2NtjytjzzEzUyc-QTGw.png"/></a></figure><figure class="no kk np nq nr ns nt paragraph-image"><a href="https://twitter.com/PiotrSkalski92"><img src="../Images/e021aa02e6fbeb6a9fccacc61f0a651d.png" data-original-src="https://miro.medium.com/v2/resize:fit:668/format:webp/1*uNH7XaccGzx6-Tl02fzB1g.png"/></a></figure></div></div></div>    
</body>
</html>