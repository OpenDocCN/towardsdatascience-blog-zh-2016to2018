<html>
<head>
<title>How to spot Data Leakage thanks to Heat Maps (on your laptop!)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何借助热图发现数据泄漏(在您的笔记本电脑上！)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-spot-data-leakage-thanks-to-heat-maps-81a25f5331eb?source=collection_archive---------15-----------------------#2018-10-29">https://towardsdatascience.com/how-to-spot-data-leakage-thanks-to-heat-maps-81a25f5331eb?source=collection_archive---------15-----------------------#2018-10-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9a16" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何确保你的模型真正学到你认为它学到的东西的指南！</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/44f3e02a018a4cb678db040a95ecb56d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*uetW9EYcW-rbSilsbrqjiA.gif"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Last Convolution Layer Heat Map for two training samples. (Be patient, this animated GIF could take some time to load…)</figcaption></figure><p id="9de1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">生成以下图片所需的数据集和源代码可在<a class="ae lr" href="https://github.com/nalepae/bart-vs-homer" rel="noopener ugc nofollow" target="_blank">GitHub 资源库中找到。</a>本文所有内容都可以在配有 1 Go 内存 GPU 的笔记本电脑上重现。</p><p id="e600" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在本文中，您将了解到:</p><ul class=""><li id="0533" class="ls lt iq kx b ky kz lb lc le lu li lv lm lw lq lx ly lz ma bi translated">如何在图像分类任务中发现<strong class="kx ir">数据泄露</strong>，以及</li><li id="e9f9" class="ls lt iq kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated">如何修复(对于这个给定的图像分类任务)。</li></ul><h2 id="f1f3" class="mg mh iq bd mi mj mk dn ml mm mn dp mo le mp mq mr li ms mt mu lm mv mw mx my bi translated">问题是</h2><p id="c9c0" class="pw-post-body-paragraph kv kw iq kx b ky mz jr la lb na ju ld le nb lg lh li nc lk ll lm nd lo lp lq ij bi translated">想象一下，玛姬·辛普森委托给你一项任务:她想让你做一个算法来区分巴特和荷马。</p><p id="4e79" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因为她爱她的丈夫和儿子，她给了你 66 张代表他们的照片<strong class="kx ir">在家庭住宅前</strong>。(上一句的粗体部分很重要。)</p><p id="14dd" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">以下是该数据集的摘录。</p><div class="kg kh ki kj gt ab cb"><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/5b4a64d46f7846055f53c86e7e7a9232.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*zQK83qdbwuF7SUrGP3rl5Q.png"/></div></figure><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/edf87449a7d7b17c012fa62b83eea70b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*YcCSdQks7CpLU0K1cNvdiQ.png"/></div></figure></div><div class="ab cb"><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/0218ddc98eab1d6f93d88e0fd44c99e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*qdqdzy2liCbxdYwephTSTg.png"/></div></figure><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/8a2e31f8c83c8832b079eba6bd7d4de1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*53w4Ul2X-5NkiJHOnzMsNA.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk nk di nl nm">Pictures Marge gave you</figcaption></figure></div><p id="75b6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">作为一名实验过的数据科学家，你选择使用你最喜欢的预先训练好的图像识别深度神经网络:比如说<a class="ae lr" href="https://arxiv.org/pdf/1409.1556v6.pdf" rel="noopener ugc nofollow" target="_blank"> VGG16 </a>。<br/>(2014 年获得<a class="ae lr" href="http://www.image-net.org/challenges/LSVRC/" rel="noopener ugc nofollow" target="_blank">大型视觉识别挑战赛</a>。)</p><p id="aacd" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">但是，因为感兴趣的部分(Bart 或 Homer)表示图像中的一个小区域，所以您选择用单个<strong class="kx ir">卷积</strong>层和一个<strong class="kx ir">全局平均池</strong>层替换结束的<strong class="kx ir">完全连接的</strong>层，如下图所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nn"><img src="../Images/08e41228b6149e9090d925eba20c92b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jVR9-FMHk0x8aBQD-58P-g.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Model used for Bart vs. Homer classification (based on VGG16). The only trainable layer is in red.</figcaption></figure><p id="552c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于那些想知道的人来说，<strong class="kx ir">全球平均池</strong>是一种复杂的说法……“平均”。我们稍后会更详细地解释它。</p><p id="214f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如上所述，对于我们的识别任务，您将只训练最后一个卷积层。</p><p id="5154" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">将给定数据集拆分为训练集和验证集后，您训练了最后一个卷积层。</p><p id="8885" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">学习曲线是好的:低训练和验证损失意味着你有好的表现，没有过度拟合。您甚至在训练和验证集上获得了 100%的准确率。</p><p id="b532" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">恭喜你！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/886d47285acc962bc5bec913f69073a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ifF9sSryi5LQXkHzIULT7w.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Learning curves</figcaption></figure></div><div class="ab cl np nq hu nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ij ik il im in"><p id="b6c0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在是时候在生产中使用您的模型了！</p><p id="f593" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然而，在生产中，巴特和荷马可能在世界的任何地方，包括在<strong class="kx ir">斯普林菲尔德核电站</strong>前，如下所示:</p><div class="kg kh ki kj gt ab cb"><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/a14cd954f3203e32ed65554de51c381f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*BsvlRj0SkhdMknjJw-RdhA.png"/></div></figure><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/d9fa5e7a5cd65bebb2b64b7c8f000ab7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*S-qGfHw79beoNEquytw9LA.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk nk di nl nm">Ground truth: Bart — Predicted label: Bart ==&gt; <strong class="bd nw">OK!</strong></figcaption></figure></div><div class="ab cb"><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/5656fe0d2a5158db97e1082c47a1c5d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*NkVjJ9xwgNkYW2SeiZLFmw.png"/></div></figure><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/ff5684a6833034eb86277f5db46e2bc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*WWpjnxL9rVfJQeqTUtJShg.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk nk di nl nm">Ground truth: Homer — Predicted label: Homer ==&gt; <strong class="bd nw">OK!</strong></figcaption></figure></div><p id="4f4a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于之前的这 4 张图片，您的模型 100%地预测了好标签(上面的图片预测为 Bart，下面的图片预测为 Homer)。</p><p id="7467" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">干得好，玛吉会高兴的！</p></div><div class="ab cl np nq hu nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ij ik il im in"><p id="a682" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">但是现在让我们在一个稍微不同的数据集上训练您的模型:</p><ul class=""><li id="a21d" class="ls lt iq kx b ky kz lb lc le lu li lv lm lw lq lx ly lz ma bi translated">因为荷马花费大量时间在工作上，所以玛吉给你的所有照片都代表了荷马在核电站前的样子。</li><li id="f1f8" class="ls lt iq kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated">因为巴特是个孩子，一直在玩，所以玛吉给你的所有照片都代表巴特在家庭住宅前。</li></ul><p id="8e30" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面是这个新数据集的摘录。</p><div class="kg kh ki kj gt ab cb"><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/5b4a64d46f7846055f53c86e7e7a9232.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*zQK83qdbwuF7SUrGP3rl5Q.png"/></div></figure><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/edf87449a7d7b17c012fa62b83eea70b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*YcCSdQks7CpLU0K1cNvdiQ.png"/></div></figure></div><div class="ab cb"><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/43b62dd5fa5ce6ba50977496dea0ead9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*5g-tkbwl9_xE3febj8yo0Q.png"/></div></figure><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/f83023e5e3ba797522ac4b271d10b09c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*-CbQtrXVZi_SIbW_d_qzNg.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk nk di nl nm">The new dataset. Notice that in this dataset, Bart is <strong class="bd nw">always</strong> in front of the house, and Homer is <strong class="bd nw">always</strong> in front of the power plant<strong class="bd nw">.</strong></figcaption></figure></div><p id="3295" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">像第一次一样，在将给定的数据集分成训练集和验证集之后，您训练了模型的最后一个卷积层。</p><p id="9fe2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">学习曲线<strong class="kx ir"> <em class="nx">超级</em> </strong>好:你只用一个历元就达到了 100%的准确率！</p><p id="180b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="nx">提示:这好得令人难以置信。</em></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/316002863d00d63d1a824efae8d6b10a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xhgyDkvF85hvW4WnfNyvNQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Learning curves</figcaption></figure><p id="e6c7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">与之前的训练集一样，现在是时候在生产中使用您的模型了！</p><p id="1bdc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们看看你的模型有多好，巴特在核电站前面，荷马在家庭住宅前面。</p><p id="579b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">请注意，在训练集中，Bart 在房子前面，Homer 在植物前面。在“生产”中，我们测试了相反的情况:巴特在工厂前面，荷马在房子前面。</p><div class="kg kh ki kj gt ab cb"><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/a14cd954f3203e32ed65554de51c381f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*BsvlRj0SkhdMknjJw-RdhA.png"/></div></figure><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/d9fa5e7a5cd65bebb2b64b7c8f000ab7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*S-qGfHw79beoNEquytw9LA.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk nk di nl nm">Ground truth: Bart — Predicted label: Homer ==&gt; <strong class="bd nw">NOT OK at ALL!</strong></figcaption></figure></div><div class="ab cb"><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/2d44391d75b0d3b6f84431164c8b9c80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*y5HMsfV_qjLUORnsH2AayA.png"/></div></figure><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/76d0942ed216515544c050106a0c5b2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*V3q7VLVhS-uEuUSVqog8Dg.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk nk di nl nm">Ground truth: Homer — Predicted label: Bart ==&gt; <strong class="bd nw">NOT OK at ALL!</strong></figcaption></figure></div><p id="8190" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">哎哟…你的模型总是预测错误的标签。所以我们总结一下:</p><ul class=""><li id="68a5" class="ls lt iq kx b ky kz lb lc le lu li lv lm lw lq lx ly lz ma bi translated">训练集上的损失和准确性-&gt;好。</li><li id="ec34" class="ls lt iq kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated">验证集上的损失和准确性-&gt;好。</li><li id="3f18" class="ls lt iq kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated">生产中的模型预测-&gt;坏。</li></ul><p id="bd8d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">发生了什么事？</p><p id="5909" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="nx">回答:</em>你的模型被<strong class="kx ir">数据泄露</strong>感染。<br/>为了学习，模型使用了一些本不该使用的功能。</p></div><div class="ab cl np nq hu nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ij ik il im in"><h2 id="95d1" class="mg mh iq bd mi mj mk dn ml mm mn dp mo le mp mq mr li ms mt mu lm mv mw mx my bi translated">如何发现数据泄露</h2><p id="8803" class="pw-post-body-paragraph kv kw iq kx b ky mz jr la lb na ju ld le nb lg lh li nc lk ll lm nd lo lp lq ij bi translated">首先让我们来看看你的模型的最后一部分<strong class="kx ir"> : </strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/755dc60663a3dccf35211fb07f1cb6f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*gnQ-_CndlbI3uA2hNb-oFA.png"/></div></figure><p id="eeee" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">想法是在原始图片上叠加最后一个<strong class="kx ir">卷积层</strong>的输出。该层输出是 2 个 22×40 的矩阵。第一个矩阵表示用于 Bart 预测的激活，第二个矩阵表示用于 Homer 预测的激活。</p><p id="5938" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当然，因为这些矩阵的形状都是 22x40，所以在将它们叠加到原来的 360x640 之前，您必须将它们放大。</p><p id="22e3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们用验证集的 4 张图片来做这件事:<br/>在左栏，你有“Bart”最后一个卷积层的输出，在右栏是“Homer”的输出。</p><p id="6979" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="nx">色码:蓝色为低输出(接近 0)，红色为高输出。</em></p><div class="kg kh ki kj gt ab cb"><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/c2890aee54b16082de73fe08d5651f05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*exB-yIu4h0Q1rBcxBVXraw.png"/></div></figure><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/9f2ef6ba96f849c07247e93e8382b847.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*WziSjEm6-cB9EMvboGzavQ.png"/></div></figure></div><div class="ab cb"><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/b2f118fea7826826d8a5a2ec60cc8ba9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*fmsfNhRqghR76mjl2vwl_g.png"/></div></figure><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/4f9fb5ab3c50ee3ff0c65616d0a5e802.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*tKvTqo7PHXfKBdeR1VcTfw.png"/></div></figure></div><div class="ab cb"><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/bb6ea07aa25b4ae1b927bab42a4999ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*5TfgMWsPRQkw8M0AXaklHw.png"/></div></figure><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/a4ab82d3f7c0fd7290e955ffef8cafa0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*pySqF92HsJUiMPN87LiE2A.png"/></div></figure></div><div class="ab cb"><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/800e0585d76cd948be2dee6f2a4a6864.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*oZrKiZjENiIBLkfQ9p9u_A.png"/></div></figure><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/f94568e596262dbb640f53dbd34622c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*aA9NH5WHUCkNU_Tzlu8hUg.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk nk di nl nm">Extract of validation set with heat maps corresponding to the last convolution layer output</figcaption></figure></div><p id="46f4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">看起来你的模型根本没有使用 Bart 和 Homer 来完成分类任务，而是使用了背景来学习！</p><p id="c1dd" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为了确定这个假设，让我们显示没有巴特和荷马的图片<strong class="kx ir">的最后一个卷积层的输出！</strong></p><div class="kg kh ki kj gt ab cb"><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/9ea7b1c66d6aad2b657940a160b764b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*tbXf4dz0uZ50K-QXrN8mSA.png"/></div></figure><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/b36f53973326997e98f08c2713cd62b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*vgUP1wz8dsnV-NNMXofeTA.png"/></div></figure></div><div class="ab cb"><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/12fa85c5e142dedac28ad9605d8dd838.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*lB5Q-U2HCQX5p_D4_OO5Hg.png"/></div></figure><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/11a6aab2a0f324a6aae3f9e551c0295d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*QyVwC1LjzVcmbmM4LBIfjA.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk nk di nl nm">Last convolution layer for background only</figcaption></figure></div><p id="0130" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">看来我们的假设是对的。添加/删除 Bart &amp; Homer 对分类模型没有太大影响…</p></div><div class="ab cl np nq hu nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ij ik il im in"><p id="d4be" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们回到我们的第一个模型上几秒钟，这个模型是用 Bart &amp; Homer <strong class="kx ir"> only </strong>在房子前面的图片训练的，让我们显示一些验证示例的最后卷积层的输出:</p><div class="kg kh ki kj gt ab cb"><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/6e8051dff065b34a18abfa77f88de2a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*praAceILW7lnGLEGTC-ADg.png"/></div></figure><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/33e5f8ba74b9f483952964e5ff63d710.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*3E1A0mTaW5sZ8KnnDKYrEQ.png"/></div></figure></div><div class="ab cb"><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/2b59c188e1bd9ec20c83a9fbeea59336.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*ejA4rGPbjqHpzFROn4xEdA.png"/></div></figure><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/e145a96f819a32ca8112beb78afce540.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*N4E9g3CqM8sTwcTLPOyhQg.png"/></div></figure></div><div class="ab cb"><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/0ad4cfc6c4d3a39ca5cae7c85b58df99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*FGY1dcvNPYW547U6jWO7Bg.png"/></div></figure><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/8f27df447c48ac7e0bb04392972b21ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*epCzd4Og4_1LnXYr7yGLvQ.png"/></div></figure></div><div class="ab cb"><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/030fad32d6aa7e6c04d748892c583c55.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*JTAK3dsmdR-Ny3h7TmnATw.png"/></div></figure><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/501516fb57756de6ae1c6bbc659cbdc9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*uFJ61DRG32S4Omku9VmE8w.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk nk di nl nm">Extract of validation set with heat maps corresponding to last convolution layer output, for the model trained with Bart only in front of the house and with Homer only in front of the power plant</figcaption></figure></div><p id="bd57" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这种情况下，我们现在能够<strong class="kx ir">理解</strong>为什么这个模型预测了好标签:因为它实际上使用了 Bart &amp; Homer 来预测产量！</p></div><div class="ab cl np nq hu nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ij ik il im in"><h2 id="c28c" class="mg mh iq bd mi mj mk dn ml mm mn dp mo le mp mq mr li ms mt mu lm mv mw mx my bi translated">解决方案</h2><p id="6d49" class="pw-post-body-paragraph kv kw iq kx b ky mz jr la lb na ju ld le nb lg lh li nc lk ll lm nd lo lp lq ij bi translated">如何修复 Bart 总是在房子前面，Homer 总是在植物前面的训练集的<strong class="kx ir">数据泄露</strong>问题？我们有几个选择:</p><ul class=""><li id="f013" class="ls lt iq kx b ky kz lb lc le lu li lv lm lw lq lx ly lz ma bi translated">最常见的一种是通过使用边界框来修改模型。但是…那很无聊:你必须一个接一个地注释每个训练样本。</li><li id="5e74" class="ls lt iq kx b ky mb lb mc le md li me lm mf lq lx ly lz ma bi translated">一个更简单的解决方案是将我们的 2 类分类问题(Bart &amp; Homer)转化为 3 类分类问题(Bart、Homer <strong class="kx ir">和</strong>背景)。<br/>第一个类将包含巴特的图片(在房子前面)，第二个类将包含荷马的图片(在发电厂前面)，第三个类将只包含 2 张图片:一张房子的图片和一张发电厂的图片(上面没有任何人)。</li></ul><p id="075a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">还有……就这些了！</p><p id="5ffb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面是这个 3 级训练模型的学习曲线。这些曲线看起来“更正常”。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi no"><img src="../Images/be709ea7ef847c0f2f4a1feaf053a473.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u9hTTv2z1LnXCV3l0WtN7g.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Learning curves for the 3-classes trained model</figcaption></figure><p id="a9e4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面是一些验证示例的最后一个卷积层的输出:</p><div class="kg kh ki kj gt ab cb"><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/6ed7fc359e3513b2eae15ab8e0091798.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*ahL05f4EpXir-fwDasp0lA.png"/></div></figure><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/bfaa31456cd61e00c97f6e6beff1412a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*_nsDKOJlnvaJuJldGD66yg.png"/></div></figure></div><div class="ab cb"><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/96a139989afbd172e4c4d76782278b23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*RKvitwyAeP3vRm7lnKf0eQ.png"/></div></figure><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/504f55e47256ccf3667b1b0d03b44210.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*zlfcDldVmbgxBKlSLejwTA.png"/></div></figure></div><div class="ab cb"><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/b67b3c1650c90c04d1537d0e221f60bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*rknjQNjXDPhcIVJQAu1uRA.png"/></div></figure><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/54a5ad9517439059136398a0aae8ef91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*VbyhYuWYfjkZGp4DncMhJQ.png"/></div></figure></div><div class="ab cb"><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/791fc93739e45a1001485b8198f92690.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*AFjLRZXpQbsFAlr9AZ6ZiQ.png"/></div></figure><figure class="ne kk nf ng nh ni nj paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><img src="../Images/b7e811db26ef789fd19bebb5173204e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*KxNyIrpYPiNnv6c4zpyyRA.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk nk di nl nm">Extract of validation set with heat maps corresponding to the last convolution layer output, for the 3-classes trained model</figcaption></figure></div><p id="af3b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">您的模型现在在生产中也运行良好。</p></div><div class="ab cl np nq hu nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ij ik il im in"><p id="c222" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> <em class="nx">现在你知道了:</em> </strong>如何在一个图像分类任务上发现<strong class="kx ir">数据泄漏</strong>，以及如何为我们的 Bart vs. Homer 分类任务修复它。</p><p id="c0fb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">生成上述图像所需的数据集和源代码可在<a class="ae lr" href="https://github.com/nalepae/bart-vs-homer" rel="noopener ugc nofollow" target="_blank">GitHub 资源库中找到。</a></p></div></div>    
</body>
</html>