<html>
<head>
<title>Learn RCNNs with this Toy Dataset</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用这个玩具数据集学习RCNNs</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/learn-rcnns-with-this-toy-dataset-be19dce380ec?source=collection_archive---------6-----------------------#2018-03-18">https://towardsdatascience.com/learn-rcnns-with-this-toy-dataset-be19dce380ec?source=collection_archive---------6-----------------------#2018-03-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="cb1a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里有一个数据集，旨在帮助展示递归卷积神经网络(RCNN)何时会优于非递归卷积神经网络(CNN)。</p><h1 id="aa5e" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">一点入门知识</h1><p id="3f2e" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated"><strong class="jp ir">递归模型</strong>是专门设计用于使用一系列数据进行预测的模型(例如，使用过去3天的一系列数据点的股票市场预测器)。</p><p id="e2c5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">卷积模型</strong>是专为处理图像数据而设计的模型。</p><p id="6a10" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，<strong class="jp ir">递归卷积模型</strong>是一种专门设计用于使用一系列图像(通常也称为视频)进行预测的模型。</p><h1 id="5e88" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">数据集</h1><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/0927954a5f6d7cb43c433a8ad291bc20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*nReP4CS9mxbbS3-4Uz7M8g.gif"/></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk">The aptly named `Sliding Square` toy dataset</figcaption></figure><p id="4b1c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae ma" href="https://www.kaggle.com/zackakil/sliding-square-rcnn-toy-dataset" rel="noopener ugc nofollow" target="_blank">从Kaggle </a>这里下载，也可以在<a class="ae ma" href="https://github.com/ZackAkil/understanding-recurrent-convolutional-neural-networks" rel="noopener ugc nofollow" target="_blank"> my Github </a>上找到。</p><h1 id="d762" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">任务</h1><p id="e102" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">预测方块的下一个位置！</p><h1 id="0a82" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">输入</h1><p id="97a5" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">作为一个<strong class="jp ir"> CNN </strong>你只能得到一个单一的帧作为输入:</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/b45f3854949685c964c968af0f18056d.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*0vOat3LuyV6p-7G9fYe3Dg.png"/></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk">Input to CNN (single image)</figcaption></figure><p id="4043" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">作为一个<strong class="jp ir"> RCNN </strong>你得到<strong class="jp ir">多个</strong>帧作为输入:</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/fd0aeeb1d42bfc1a51f0fe0fb603a340.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*iTul8SrZtfKCwTNs9TFSbw.png"/></div></figure><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/0323c75ecb19fddf427d86a6c5175a61.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*ToWMmhE5GNCLcPWFDGIRyQ.png"/></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk">Input to RCNN (multiple sequencial images)</figcaption></figure><h1 id="99bf" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">直觉</h1><p id="051d" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated"><strong class="jp ir">为什么CNN会在这个数据集上表现不佳？</strong></p><p id="9768" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">看看上面CNN的输入(单帧)。你能自信地预测滑动方块的下一个位置是什么吗？我假设你的回答是“不”。这是因为它是完全模糊的，也就是说，它可能向左或向右移动，没有办法根据一张图片就知道。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi mc"><img src="../Images/2d455f22f800b4a6da3e70f5210d96b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gokNpHR-3OXVZnj2viwtXA.png"/></div></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk">Ambiguity in trying to predict the next position based on a single frame.</figcaption></figure><p id="9150" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">为什么RCNN应该在这个数据集上表现良好？</strong></p><p id="fb0d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">尝试使用上面的RCNN输入(两帧)预测下一个位置。现在很容易了吧？正方形移动的方向现在不再模糊。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/b0903c5917943437533443333668295e.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*e_DjveMps5EN0Yg1N3R0gg.png"/></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk">Showing how using multiple frames disambiguates the next position.</figcaption></figure><h1 id="770c" class="kl km iq bd kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li bi translated">CNN与RCNN的性能测试</h1><p id="3c2a" class="pw-post-body-paragraph jn jo iq jp b jq lj js jt ju lk jw jx jy ll ka kb kc lm ke kf kg ln ki kj kk ij bi translated">查看<a class="ae ma" href="https://github.com/ZackAkil/understanding-recurrent-convolutional-neural-networks/blob/master/Testing%20CNN%20vs%20RCNN%20using%20synthetic%20data.ipynb" rel="noopener ugc nofollow" target="_blank">这本笔记本</a>，看看在这个数据集上构建和训练简单CNN和RCNN (Keras模型)的代码。</p><p id="2df2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了评估性能，我们使用来自数据集的随机帧样本，并让每个模型尝试预测正方形的下一个位置。</p><p id="c23c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是每个模型预测误差的频率表。例如，你可以看到，对于7次测试，CNN得到了完全正确的正方形位置(零误差)。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi mi"><img src="../Images/a71b92612120559d92af83aad938d3af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6ooAKb39_9MfGp4vuxw8rg.png"/></div></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk">frequency chart of prediction errors for a sample of test data</figcaption></figure><p id="70d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">CNN错误分数是怎么回事？</p><p id="4a18" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可能会注意到CNN犯了很多+/- 4的错误。当我们考察其中一个预测时，一切都揭晓了:</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/aa2e0a407fb3ba668562752f84064775.png" data-original-src="https://miro.medium.com/v2/resize:fit:836/format:webp/1*uBo2KxQSHJzXWsIlvatNBQ.png"/></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk">CNN prediction (always predicts it to be the same position as the input)</figcaption></figure><p id="ac53" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">CNN似乎总是预测这个正方形与它在输入图像中的位置相同。你可能觉得这很奇怪，因为方块的下一个位置只能是左边或者右边。为什么它会预测它会在一个它根本不会在的地方！？一个字… <strong class="jp ir">一致性！</strong>一般来说，对于机器学习模型来说，最好总是有点错误，而不是有时非常错误。在大多数学习算法中，这种偏好是通过平方误差来实现的，如下所示:</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi mk"><img src="../Images/f2ddaa58f4deafb512dcd00e2e8cab5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NI8Mp2Pk2nwff7mr5Xe0Dw.png"/></div></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk">How consistent errors are encouraged by squaring the original error. See how both models have the same Sum(Error) but Model B has a significantly higher Sum(Error x Error)</figcaption></figure><p id="52a6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">CNN已经学会猜测与输入相同的位置，因为这样它总是离正确答案最多+/-5。如果它总是猜测方块向右移动:一半的时间它是完全正确的，但另一半的预测会相差10 %!(这不太一致)</p><p id="c7f4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">自然RCNN是在其元素</strong></p><p id="b4f9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从误差图中可以看出，RCNN的误差远不及CNN。这是因为它在计算正方形移动的方向上没有问题。</p><figure class="lp lq lr ls gt lt gh gi paragraph-image"><div class="gh gi ml"><img src="../Images/1184f750da7322ef80adeadb38b9f4b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/format:webp/1*b94uUWiHS8TANctWOl8plg.png"/></div><figcaption class="lw lx gj gh gi ly lz bd b be z dk">RCNN not having any trouble in predicting the next position of the square.</figcaption></figure><p id="0a7f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">希望这给了你更多关于何时使用RCNNs而不是标准CNN的直觉。</p><p id="ded3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所有用于生成玩具数据集的代码以及测试模型的代码都可以在我的Github上找到:</p><div class="mm mn gp gr mo mp"><a href="https://github.com/ZackAkil/understanding-recurrent-convolutional-neural-networks" rel="noopener  ugc nofollow" target="_blank"><div class="mq ab fo"><div class="mr ab ms cl cj mt"><h2 class="bd ir gy z fp mu fr fs mv fu fw ip bi translated">ZackAkil/理解递归卷积神经网络</h2><div class="mw l"><h3 class="bd b gy z fp mu fr fs mv fu fw dk translated">理解-递归卷积神经网络-使用合成生成的视频数据来学习如何/何时…</h3></div><div class="mx l"><p class="bd b dl z fp mu fr fs mv fu fw dk translated">github.com</p></div></div><div class="my l"><div class="mz l na nb nc my nd lu mp"/></div></div></a></div></div></div>    
</body>
</html>