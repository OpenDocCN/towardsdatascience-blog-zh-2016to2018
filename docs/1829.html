<html>
<head>
<title>Binary Logistic Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">二元逻辑回归</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/implementing-binary-logistic-regression-in-r-7d802a9d98fe?source=collection_archive---------0-----------------------#2017-10-31">https://towardsdatascience.com/implementing-binary-logistic-regression-in-r-7d802a9d98fe?source=collection_archive---------0-----------------------#2017-10-31</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2619" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">R中的概述和实现</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/dbe9563c6ca85c127b937ef29840d074.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1ygYdt9Rmcx2Kcln7IIzng.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Customer satisfaction for a product — Satisfied vs Dissatisfied (Source: pixabay.com)</figcaption></figure><p id="1179" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你有没有遇到过这样的情况，你想预测一个二元的结果，比如:</p><ul class=""><li id="a6c4" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated">一个人对一个产品是否满意？</li><li id="d0f1" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">一个考生是否会被研究生院录取？</li><li id="a5a7" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">两位总统候选人中谁会赢得选举？</li><li id="54bc" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated">飞机是否会在预定时间到达目的地？</li></ul><p id="91c0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">一个非常简单的机器学习算法将会拯救你，那就是<strong class="kx ir">逻辑回归。</strong></p><p id="05a3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">逻辑回归是一种分类算法，当我们想要基于一组独立变量预测分类变量(是/否，通过/失败)时使用。</p><p id="cb41" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在逻辑回归模型中，因变量的比值对数被建模为自变量的线性组合。</p><p id="7755" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们使用<strong class="kx ir"> R. </strong>中的一个实际例子来更清楚地了解<strong class="kx ir">二元逻辑回归</strong></p><p id="4696" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="mf">考虑这样一种情况，您希望根据血糖浓度、血压、年龄等特征将一个人归类为糖尿病或非糖尿病患者。</em></p><p id="0690" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">数据描述</strong></p><p id="7200" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于我们的分析，我们将使用来自<strong class="kx ir"> R </strong>中的<strong class="kx ir"> mlbench </strong>包的<strong class="kx ir">皮马印第安人糖尿病</strong>数据库</p><pre class="kg kh ki kj gt mg mh mi mj aw mk bi"><span id="7c0a" class="ml mm iq mh b gy mn mo l mp mq"><strong class="mh ir">install.packages('mlbench')<br/>install.packages('MASS')<br/>install.packages('pROC')</strong></span><span id="ef9a" class="ml mm iq mh b gy mr mo l mp mq"><strong class="mh ir">library(mlbench)<br/>library(MASS)<br/>library(pROC)</strong></span><span id="08b7" class="ml mm iq mh b gy mr mo l mp mq"><strong class="mh ir">data(PimaIndiansDiabetes2)<br/>head(PimaIndiansDiabetes2)</strong></span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ms"><img src="../Images/7799223506f319319110e966317a1e0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4kF6Umth34Hct-dgcM5SxA.png"/></div></div></figure><p id="1f03" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">糖尿病</strong>是该数据集中的二元因变量，分类为pos/neg。我们有以下八个独立变量</p><ul class=""><li id="84d2" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq lw lx ly lz bi translated"><strong class="kx ir">怀孕</strong>:怀孕次数</li><li id="8638" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated"><strong class="kx ir">葡萄糖</strong>:血浆葡萄糖浓度(葡萄糖耐量试验)</li><li id="c056" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated"><strong class="kx ir">压力</strong>:舒张压(毫米汞柱)</li><li id="e322" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated"><strong class="kx ir">三头肌</strong>:皮褶厚度(mm)</li><li id="bad2" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated"><strong class="kx ir">胰岛素</strong> : 2小时血清胰岛素(μU/ml)</li><li id="4619" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated"><strong class="kx ir">体重</strong>:体重指数(体重公斤/(身高米) )</li><li id="465b" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated"><strong class="kx ir">谱系</strong>:糖尿病谱系功能</li><li id="5835" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq lw lx ly lz bi translated"><strong class="kx ir">年龄</strong>:年龄(岁)</li></ul><p id="6163" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在让我们分析该数据集的<strong class="kx ir">描述性统计数据</strong>:</p><pre class="kg kh ki kj gt mg mh mi mj aw mk bi"><span id="c07b" class="ml mm iq mh b gy mn mo l mp mq"><strong class="mh ir">summary(PimaIndiansDiabetes2)</strong></span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mt"><img src="../Images/d49ff87f2c538a7932758db8ee176029.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Iu2QHjzxNjvxYLiszYlZBA.png"/></div></div></figure><p id="4380" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">从汇总统计数据中可以明显看出，数据集中存在某些缺失值，它们被突出显示为NA。</p><p id="4a02" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">作为一种保守的措施，我们可以删除这样的观察。</p><pre class="kg kh ki kj gt mg mh mi mj aw mk bi"><span id="dd5f" class="ml mm iq mh b gy mn mo l mp mq"><strong class="mh ir">newdata &lt;- na.omit(PimaIndiansDiabetes2)<br/>summary(newdata)</strong></span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/be6b14b05f5cd115432c59b30d8e2d3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qFrvgse1-2tmqn5CqAC7tA.png"/></div></div></figure><p id="2345" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们来分析一下各个自变量的分布情况:</p><pre class="kg kh ki kj gt mg mh mi mj aw mk bi"><span id="db11" class="ml mm iq mh b gy mn mo l mp mq"><strong class="mh ir">par(mfrow = c(4,2))</strong></span><span id="ddff" class="ml mm iq mh b gy mr mo l mp mq"><strong class="mh ir">for( i in 1:8){<br/>  hist(newdata[,i], main = colnames(newdata)[i],xlab =     colnames(newdata)[i], col = 'yellow')<br/>}</strong></span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/3a40df685e996143168ad3c6c7c95a53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/format:webp/1*mG3ukCp1VZ94gYr4Z1wiYQ.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Histogram of independent variables</figcaption></figure><p id="2096" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">从上面的直方图来看，很明显变量——怀孕和年龄是高度倾斜的，我们可以分桶分析它们。</p><p id="3fe2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于<em class="mf">年龄</em>，我们可以创建以下四个时段:20–30岁、31–40岁、41–50岁和50岁以上</p><pre class="kg kh ki kj gt mg mh mi mj aw mk bi"><span id="56bb" class="ml mm iq mh b gy mn mo l mp mq"><strong class="mh ir">newdata$age_bucket &lt;- as.factor(ifelse(newdata$age&lt;=30,"20-30",ifelse(newdata$age&lt;=40,"31-40",ifelse(newdata$age&lt;=50,"41-50","50+"))))</strong></span></pre><p id="f12f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于怀孕的人，我们可以创建以下三个桶:0-5，6-10和10+</p><pre class="kg kh ki kj gt mg mh mi mj aw mk bi"><span id="c5f1" class="ml mm iq mh b gy mn mo l mp mq"><strong class="mh ir">newdata$preg_bucket &lt;- as.factor(ifelse(newdata$pregnant&lt;=5,"0–5",ifelse(newdata$pregnant&lt;=10,"6–10","10+")))</strong></span></pre><p id="6254" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于<strong class="kx ir">连续的自变量</strong>，我们可以通过分析它相对于因变量的分布来得到更清晰的分布。</p><pre class="kg kh ki kj gt mg mh mi mj aw mk bi"><span id="b9c4" class="ml mm iq mh b gy mn mo l mp mq"><strong class="mh ir">par(mfrow = c(3,2))</strong></span><span id="8a99" class="ml mm iq mh b gy mr mo l mp mq"><strong class="mh ir">boxplot(glucose~diabetes, ylab="Glucose", xlab= "Diabetes", col="light blue",data = newdata)</strong></span><span id="5eec" class="ml mm iq mh b gy mr mo l mp mq"><strong class="mh ir">boxplot(pressure~diabetes, ylab="Pressure", xlab= "Diabetes", col="light blue",data = newdata)</strong></span><span id="6483" class="ml mm iq mh b gy mr mo l mp mq"><strong class="mh ir">boxplot(triceps~diabetes, ylab="triceps", xlab= "Diabetes", col="light blue",data = newdata)</strong></span><span id="8534" class="ml mm iq mh b gy mr mo l mp mq"><strong class="mh ir">boxplot(insulin~diabetes, ylab="Insulin", xlab= "Diabetes", col="light blue",data = newdata)</strong></span><span id="c4e8" class="ml mm iq mh b gy mr mo l mp mq"><strong class="mh ir">boxplot(mass~diabetes, ylab="Mass", xlab= "Diabetes", col="light blue",data = newdata)</strong></span><span id="ec96" class="ml mm iq mh b gy mr mo l mp mq"><strong class="mh ir">boxplot(pedigree~diabetes, ylab="Pedigree", xlab= "Diabetes", col="light blue",data = newdata)</strong></span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/a402faad6fcbba36171b6bd961a22cb0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1306/format:webp/1*bMysqrq9XZB6L-HGiTWqnQ.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Box Plot for Continuous Independent Variables</figcaption></figure><p id="ea87" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">从上面的图中，我们可以推断糖尿病患者的葡萄糖含量中位数更高。对于其余的变量，可以得出类似的推论。</p><p id="1a41" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于<strong class="kx ir">分类自变量</strong>，我们可以分析每个分类因变量的频率</p><pre class="kg kh ki kj gt mg mh mi mj aw mk bi"><span id="88f3" class="ml mm iq mh b gy mn mo l mp mq"><strong class="mh ir">xtabs(~diabetes + age_bucket, data = newdata)<br/>xtabs(~diabetes + preg_bucket, data = newdata)</strong></span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/545743ec341d15cd693b42518944f90f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1108/format:webp/1*8CQr8-nJ7-MdDE5GEeNYyA.png"/></div></figure><p id="3fb8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们现在将创建一个相关建模变量的新数据框。</p><pre class="kg kh ki kj gt mg mh mi mj aw mk bi"><span id="a614" class="ml mm iq mh b gy mn mo l mp mq"><strong class="mh ir">newdata2 &lt;- newdata[,c("diabetes","glucose","pressure","triceps","insulin","mass","pedigree","age_bucket","preg_bucket")]</strong></span></pre><p id="17d0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">实施逻辑回归以预测数据集“<em class="mf">新数据2 </em>”中的二元结果——糖尿病。</p><pre class="kg kh ki kj gt mg mh mi mj aw mk bi"><span id="26bc" class="ml mm iq mh b gy mn mo l mp mq"><strong class="mh ir">logit_1 &lt;- glm(diabetes~., family = binomial,data = newdata2)</strong></span></pre><p id="b5fb" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">模型总结分析</strong></p><pre class="kg kh ki kj gt mg mh mi mj aw mk bi"><span id="4a84" class="ml mm iq mh b gy mn mo l mp mq"><strong class="mh ir">summary(logit_1)</strong></span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi gj"><img src="../Images/b5a5e927da27ff2fa3a8d175a161dcbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v2nQS-S2AHqvMgGOAPNB7g.png"/></div></div></figure><p id="2df9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">汇总统计数据通过提供以下信息帮助我们更好地理解模型:</p><ol class=""><li id="4376" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq mx lx ly lz bi translated">偏差残差的分布</li><li id="a077" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq mx lx ly lz bi translated">截距和斜率估计值以及标准误差、z值和p值</li><li id="5a16" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq mx lx ly lz bi translated">AIC值</li><li id="00db" class="lr ls iq kx b ky ma lb mb le mc li md lm me lq mx lx ly lz bi translated">剩余偏差和零偏差</li></ol><p id="1560" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">结果解读</strong></p><p id="3000" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于<strong class="kx ir"> <em class="mf">连续变量</em> </strong>，解释如下:</p><p id="91a5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">葡萄糖<strong class="kx ir"/>每增加一个单位<em class="mf"/>，糖尿病【阳性】(相对于糖尿病【阴性】)<em class="mf">的对数几率增加</em>0.039。<br/>同样，<strong class="kx ir">压力</strong>每增加一个单位<em class="mf">，患糖尿病【阳性】(相对于患糖尿病【阴性】)<em class="mf">的对数几率</em>减少0.0045。</em></p><p id="7085" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于<strong class="kx ir"> <em class="mf">分类变量</em> </strong>，每个类别的表现都以基本类别为基础进行评估。变量“age_bucket”的基本类别是20–30，变量“preg_bucket”的基本类别是0–5。这些变量的解释如下:</p><p id="6fa2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">处于31-40岁的<strong class="kx ir">年龄段</strong>相对于20-30岁年龄段，患糖尿病“阳性”(相对于患糖尿病“阴性”)的对数几率变化0.854。</p><p id="789e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">处于6-10的<strong class="kx ir">怀孕区间</strong>相对于0-5的怀孕区间，患糖尿病“阳性”(相对于患糖尿病“阴性”)的对数概率变化了-0.24。</p><p id="181c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">变量选择</strong></p><p id="fc97" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于给定的一组独立变量，模型“logit_1”可能不是最佳模型。</p><p id="b496" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">变量选择有多种方法。在本文中，我们将只探索“stepAIC”函数。</p><p id="6045" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">R中的“stepAIC”函数执行逐步模型选择，目标是最小化AIC值。</p><pre class="kg kh ki kj gt mg mh mi mj aw mk bi"><span id="17f6" class="ml mm iq mh b gy mn mo l mp mq"><strong class="mh ir">logit_2 &lt;- stepAIC(logit_1)</strong></span></pre><p id="4345" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">为新创建的具有最小AIC的模型分析模型摘要</strong></p><pre class="kg kh ki kj gt mg mh mi mj aw mk bi"><span id="11c8" class="ml mm iq mh b gy mn mo l mp mq"><strong class="mh ir">summary(logit_2)</strong></span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi my"><img src="../Images/4d79c848f470a678d3ab869b6e26dcc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rDeR0zbSRuwVADJnzO5BBA.png"/></div></div></figure><p id="dc56" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">实现“stepAIC”函数后，我们现在剩下四个独立变量—葡萄糖、质量、谱系和age_bucket。在所有可能的模型中，这个模型(logit_2)具有最小的AIC值。</p><p id="a886" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">此外，入围变量非常重要。</p><p id="02dd" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">结果分析</strong></p><p id="0ec2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">为了分析将“糖尿病”的值作为“pos”的预测概率，我们可以使用如下的汇总函数</p><pre class="kg kh ki kj gt mg mh mi mj aw mk bi"><span id="1102" class="ml mm iq mh b gy mn mo l mp mq"><strong class="mh ir">summary(logit_2$fitted.values)</strong></span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/57e08941017df8a9b65a520d1bc591c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*ITGOkX0YU3OE2cxRAjBC1w.png"/></div></figure><p id="9846" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们还可以分析“pos”糖尿病的预测概率的分布。</p><pre class="kg kh ki kj gt mg mh mi mj aw mk bi"><span id="a116" class="ml mm iq mh b gy mn mo l mp mq"><strong class="mh ir">hist(logit_2$fitted.values,main = " Histogram ",xlab = "Probability of 'pos' diabetes", col = 'light green')</strong></span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi na"><img src="../Images/dee9754dd9c0168b96673880e1ab91e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*AykzTSwaLTrarmdTPOvlgw.png"/></div></div></figure><p id="dbb0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，如果拟合值超过0.5，我们将预测分类为“正”，否则为“负”。</p><pre class="kg kh ki kj gt mg mh mi mj aw mk bi"><span id="c473" class="ml mm iq mh b gy mn mo l mp mq"><strong class="mh ir">newdata2$Predict &lt;- ifelse(logit_2$fitted.values &gt;0.5,"pos","neg")</strong></span></pre><p id="26b9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir">模型性能评估</strong></p><p id="2c6b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们现在可以使用以下参数评估模型的性能:</p><ol class=""><li id="c1c7" class="lr ls iq kx b ky kz lb lc le lt li lu lm lv lq mx lx ly lz bi translated"><strong class="kx ir"> AIC </strong></li></ol><p id="1500" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">AIC代表Akaike信息标准。<strong class="kx ir"> </strong>它是<strong class="kx ir"> </strong>类似于调整后的R，是惩罚模型自变量数量的拟合度。我们总是喜欢最小AIC值的模型。</p><p id="93d2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们可以比较原始模型logit_1和由阶梯函数导出的模型logit_2的AIC。</p><pre class="kg kh ki kj gt mg mh mi mj aw mk bi"><span id="ceb1" class="ml mm iq mh b gy mn mo l mp mq"><strong class="mh ir">logit_1$aic<br/>logit_2$aic</strong></span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/32014dedb0ae15f692f0c4db18a1e6d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:362/format:webp/1*6nEqDFp1bmJQkGdfqshZMA.png"/></div></figure><p id="168e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">正如所料，由阶梯函数导出的模型对应于较低的AIC值。</p><p id="c62c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> 2。混乱矩阵</strong></p><p id="12e1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">它是观察值与预测值的表格表示。它有助于量化模型的效率(或准确性)。</p><p id="de78" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在让我们比较“糖尿病”的观察值和预测值:</p><pre class="kg kh ki kj gt mg mh mi mj aw mk bi"><span id="7be9" class="ml mm iq mh b gy mn mo l mp mq"><strong class="mh ir">mytable &lt;- table(newdata2$diabetes,newdata2$Predict)<br/>rownames(mytable) &lt;- c("Obs. neg","Obs. pos")<br/>colnames(mytable) &lt;- c("Pred. neg","Pred. pos")<br/>mytable</strong></span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/57794a1a990d6bb2c93a12c877699b7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:730/format:webp/1*xsHcvz6FuTmkSrnQ7NB3Zw.png"/></div></div></figure><pre class="kg kh ki kj gt mg mh mi mj aw mk bi"><span id="69ad" class="ml mm iq mh b gy mn mo l mp mq"><strong class="mh ir">efficiency &lt;- sum(diag(mytable))/sum(mytable)<br/>efficiency</strong></span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/9f5c7829d2ea55cdb20c1c912ed30b74.png" data-original-src="https://miro.medium.com/v2/resize:fit:344/format:webp/1*RRtXRC_ehdwRP6m-zrwxmA.png"/></div></figure><p id="bfcc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">从混淆矩阵来看，我们的模型的准确率为81.4%。</p><p id="d4e7" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><strong class="kx ir"> 3。ROC曲线</strong></p><p id="3cbf" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">ROC代表接收机工作特性。它通过评估敏感性和特异性来解释模型的性能。</p><pre class="kg kh ki kj gt mg mh mi mj aw mk bi"><span id="5dc8" class="ml mm iq mh b gy mn mo l mp mq"><strong class="mh ir">roc(diabetes~logit_2$fitted.values, data = newdata2, plot = TRUE, main = "ROC CURVE", col= "blue")</strong></span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/3e23221eb2d9eb3cad1941b437dd207e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*XGny9zSKZcDWFO6IJ_Mj6A.png"/></div></figure><p id="a070" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">ROC曲线下的面积是准确性的指标。曲线下的面积越大，模型的预测能力越强。</p><p id="50ad" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">完美预测模型的AUC等于1。</p><pre class="kg kh ki kj gt mg mh mi mj aw mk bi"><span id="5a52" class="ml mm iq mh b gy mn mo l mp mq"><strong class="mh ir">auc(diabetes~logit_2$fitted.values, data = newdata2)</strong></span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/d0da62dfc04e529bba39502c49655381.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*54a_mUaWSw4FJC4Mxd9tDQ.png"/></div></figure><p id="c8c9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">模型'<strong class="kx ir"> logit_2 </strong>的曲线下面积为0.863。</p><p id="8532" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在下一篇文章中，我们将学习另一种广泛使用的逻辑回归技术— <a class="ae ng" href="https://medium.com/@akanksha18.009/implementing-and-interpreting-ordinal-logistic-regression-1ee699274cf5" rel="noopener"> <strong class="kx ir">有序逻辑回归</strong> </a></p><p id="28c0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">谢谢！</p></div></div>    
</body>
</html>