<html>
<head>
<title>Bitcoin price prediction using LSTM</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 LSTM 预测比特币价格</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/bitcoin-price-prediction-using-lstm-9eb0938c22bd?source=collection_archive---------2-----------------------#2018-02-01">https://towardsdatascience.com/bitcoin-price-prediction-using-lstm-9eb0938c22bd?source=collection_archive---------2-----------------------#2018-02-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/3ff3bfb7e54e6386d4f69c417980bb54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w6x2nsJPD1HlHcCqdBZVxQ.png"/></div></div></figure><div class=""/><p id="5043" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2017 年 11 月围绕比特币的激烈讨论吸引了我的注意力，我决定深入了解这到底是什么。我阅读了一堆论文，几本书和许多关于这个话题的观点，以便对它在当前市场中的价值有一个像样的了解。</p><p id="21de" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可能听说过比特币，但如果你想完全承认它的存在，我推荐阅读<a class="ae kw" href="https://www.amazon.com/Internet-Money-Andreas-M-Antonopoulos-ebook/dp/B01L9WM0H8" rel="noopener ugc nofollow" target="_blank">安德烈亚斯的书——《货币的互联网</a>。</p><p id="230d" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当然，最吸引绝大多数人的是这种资产的价格波动。比特币价格在短时间内大幅上涨/下跌是一个有趣的现象，根本无法预测。然而，我认为在这个价格上看到任何强大的机器学习模型的效果都会很好。</p><p id="cfad" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以我选择了一个<a class="ae kw" rel="noopener" target="_blank" href="/learn-how-recurrent-neural-networks-work-84e975feaaf7">递归神经网络</a>和一组比特币价格来预测这种金色加密货币的未来。</p><p id="c216" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">从 01/02/2009 到今天，我每天都使用<a class="ae kw" href="https://blockchain.info/charts/market-price" rel="noopener ugc nofollow" target="_blank">比特币的收盘价</a>以及<a class="ae kw" href="https://www.kaggle.com/microtang/predicting-btc-price-using-rnn/notebook" rel="noopener ugc nofollow" target="_blank">这个奇妙的 Kaggle 内核</a>的一点帮助。</p><h2 id="805f" class="kx ky jb bd kz la lb dn lc ld le dp lf kj lg lh li kn lj lk ll kr lm ln lo lp bi translated">#1.开始实施</h2><p id="185a" class="pw-post-body-paragraph jy jz jb ka b kb lq kd ke kf lr kh ki kj ls kl km kn lt kp kq kr lu kt ku kv ij bi translated">让我们首先定义我们的库:</p><figure class="lv lw lx ly gt is"><div class="bz fp l di"><div class="lz ma l"/></div></figure><figure class="lv lw lx ly gt is"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="8d64" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们将使用<code class="fe mb mc md me b">keras</code>来训练模型。</p><blockquote class="mf mg mh"><p id="4b07" class="jy jz mi ka b kb kc kd ke kf kg kh ki mj kk kl km mk ko kp kq ml ks kt ku kv ij bi translated">Keras 是一个高级神经网络 API，用 Python 编写，能够在<a class="ae kw" href="https://github.com/tensorflow/tensorflow" rel="noopener ugc nofollow" target="_blank"> TensorFlow </a>、<a class="ae kw" href="https://github.com/Microsoft/cntk" rel="noopener ugc nofollow" target="_blank"> CNTK </a>或<a class="ae kw" href="https://github.com/Theano/Theano" rel="noopener ugc nofollow" target="_blank"> Theano </a>之上运行。</p></blockquote><p id="3c88" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们还声明了<code class="fe mb mc md me b">numpy</code>(矩阵操作)<code class="fe mb mc md me b">panda</code>(定义数据结构)<code class="fe mb mc md me b">matplotlib</code>(可视化)和<code class="fe mb mc md me b">sklearn</code>(标准化我们的数据)</p><h2 id="97bd" class="kx ky jb bd kz la lb dn lc ld le dp lf kj lg lh li kn lj lk ll kr lm ln lo lp bi translated">#2.准备数据</h2><p id="e3b6" class="pw-post-body-paragraph jy jz jb ka b kb lq kd ke kf lr kh ki kj ls kl km kn lt kp kq kr lu kt ku kv ij bi translated">我们的下一步将是准备数据。这包括从第三方来源获取、清理并分成培训和测试。</p><p id="da9a" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kw" href="https://blockchain.info/charts/market-price" rel="noopener ugc nofollow" target="_blank">这里的</a>是访问一个<em class="mi">的绝佳链接。带价格的 csv </em>文件。</p><ul class=""><li id="a10f" class="mm mn jb ka b kb kc kf kg kj mo kn mp kr mq kv mr ms mt mu bi translated">加载数据并删除未使用的字段(在本例中为“日期”)</li></ul><figure class="lv lw lx ly gt is"><div class="bz fp l di"><div class="lz ma l"/></div></figure><figure class="lv lw lx ly gt is"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="4db5" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们使用<code class="fe mb mc md me b">pandas</code>来读取<em class="mi">。csv </em>文件并删除无用的列。</p><ul class=""><li id="b83d" class="mm mn jb ka b kb kc kf kg kj mo kn mp kr mq kv mr ms mt mu bi translated">分为培训和测试</li></ul><figure class="lv lw lx ly gt is"><div class="bz fp l di"><div class="lz ma l"/></div></figure><figure class="lv lw lx ly gt is"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="0ff8" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里所做的决定只是为了本教程的目的。在真实的项目中，<strong class="ka jc">你应该总是将你的数据分成训练、验证、测试</strong>(通常是 80%、20%、20%)。我们已经将培训设置为 30 天，这意味着我们将在最后一个月测试我们的模型。</p><ul class=""><li id="7b28" class="mm mn jb ka b kb kc kf kg kj mo kn mp kr mq kv mr ms mt mu bi translated">正常化并准备培训</li></ul><figure class="lv lw lx ly gt is"><div class="bz fp l di"><div class="lz ma l"/></div></figure><figure class="lv lw lx ly gt is"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="4bcf" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们使用<code class="fe mb mc md me b">fit_transform</code>来确定数据的中心，使其具有 0 个平均值和 1 个标准误差。我推荐阅读<a class="ae kw" href="https://datascience.stackexchange.com/questions/12321/difference-between-fit-and-fit-transform-in-scikit-learn-models" rel="noopener ugc nofollow" target="_blank">这篇 Stackoverflow 回答</a>来澄清。然后，我们将数据分为<code class="fe mb mc md me b">x_train</code>和<code class="fe mb mc md me b">y_train</code>。本质上，这是因为我们使用了递归神经网络。我们的模型将从<code class="fe mb mc md me b">x_train</code>获取第 0 个元素，并尝试从<code class="fe mb mc md me b">y_train</code>(即<code class="fe mb mc md me b">x_train</code>的第一个元素)预测第 0 个元素。这样我们就创建了一个序列——这正是 rnn 训练所需要的。如果你需要更多关于这些奇妙网络如何工作的信息，你可能会发现我的一篇文章很有用。</p><p id="7d3b" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后，我们重塑<code class="fe mb mc md me b">x_train</code>数据，以匹配使用<code class="fe mb mc md me b">keras</code>进行训练的需求(见下文)。</p><h2 id="0072" class="kx ky jb bd kz la lb dn lc ld le dp lf kj lg lh li kn lj lk ll kr lm ln lo lp bi translated">#3.火车模型</h2><p id="c857" class="pw-post-body-paragraph jy jz jb ka b kb lq kd ke kf lr kh ki kj ls kl km kn lt kp kq kr lu kt ku kv ij bi translated">现在我们需要使用上述数据来训练我们的模型。有了<code class="fe mb mc md me b">keras</code>，这个过程就变得极其容易理解。你不需要知道任何运算背后的数学原理就能产生像样的结果。不过，如果你有兴趣钻研方程和算法，你可以在这里 (LSTM 网)找到更多信息<a class="ae kw" href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/" rel="noopener ugc nofollow" target="_blank">，在这里</a> (GRU 网)找到<a class="ae kw" rel="noopener" target="_blank" href="/understanding-gru-networks-2ef37df6c9be">。</a></p><p id="a203" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们正在构建如下模型:</p><figure class="lv lw lx ly gt is"><div class="bz fp l di"><div class="lz ma l"/></div></figure><figure class="lv lw lx ly gt is"><div class="bz fp l di"><div class="lz ma l"/></div></figure><ul class=""><li id="a818" class="mm mn jb ka b kb kc kf kg kj mo kn mp kr mq kv mr ms mt mu bi translated">第 1 行:用于 LSTM 单元的单位数(输出态的维数)。</li><li id="e4d3" class="mm mn jb ka b kb mv kf mw kj mx kn my kr mz kv mr ms mt mu bi translated">第 2 行:用于 LSTM 电池的<a class="ae kw" rel="noopener" target="_blank" href="/activation-functions-neural-networks-1cbd9f8d91d6">激活功能</a>(在我们的例子中为<a class="ae kw" href="https://en.wikipedia.org/wiki/Sigmoid_function" rel="noopener ugc nofollow" target="_blank">s 形</a>)。</li><li id="bd00" class="mm mn jb ka b kb mv kf mw kj mx kn my kr mz kv mr ms mt mu bi translated">第 3 行:用于最小化损失函数的优化器(在我们的例子中是<a class="ae kw" href="https://machinelearningmastery.com/adam-optimization-algorithm-for-deep-learning/" rel="noopener ugc nofollow" target="_blank">亚当</a>)。</li><li id="82d6" class="mm mn jb ka b kb mv kf mw kj mx kn my kr mz kv mr ms mt mu bi translated">第 4 行:在调整网络的权重和偏差时我们需要最小化的损失函数(在我们的例子中是<a class="ae kw" href="https://en.wikipedia.org/wiki/Mean_squared_error" rel="noopener ugc nofollow" target="_blank">均方误差</a>)。</li><li id="18ad" class="mm mn jb ka b kb mv kf mw kj mx kn my kr mz kv mr ms mt mu bi translated">第 5 行:神经网络通常是分批训练的，这意味着在每次迭代中，我们从训练集中挑选 5 个例子，并使用它们进行训练。</li><li id="40cc" class="mm mn jb ka b kb mv kf mw kj mx kn my kr mz kv mr ms mt mu bi translated">第 6 行:历元的数量决定了我们需要进行多少次迭代。</li></ul><p id="30fb" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在解释了每个超参数的含义后，我们开始训练模型:</p><ul class=""><li id="905b" class="mm mn jb ka b kb kc kf kg kj mo kn mp kr mq kv mr ms mt mu bi translated">第 9 行:定义堆叠所有层(输入、隐藏和输出)的<a class="ae kw" href="https://keras.io/getting-started/sequential-model-guide/" rel="noopener ugc nofollow" target="_blank">顺序模型</a></li><li id="f26b" class="mm mn jb ka b kb mv kf mw kj mx kn my kr mz kv mr ms mt mu bi translated">第 12 行:将 LSTM 单元添加到我们的模型中。这里很好地解释了它在 Keras 中是如何工作的。</li><li id="3a42" class="mm mn jb ka b kb mv kf mw kj mx kn my kr mz kv mr ms mt mu bi translated">第 15 行:添加输出层——是一个简单的<a class="ae kw" href="https://keras.io/layers/core/" rel="noopener ugc nofollow" target="_blank">密集</a>,具有默认的线性激活函数和维度 1。</li><li id="04fe" class="mm mn jb ka b kb mv kf mw kj mx kn my kr mz kv mr ms mt mu bi translated">第 18 行:这是实际训练前的最后一步。我们需要设置上面指定的优化器和损失函数。</li><li id="8ddb" class="mm mn jb ka b kb mv kf mw kj mx kn my kr mz kv mr ms mt mu bi translated">第 21 行:使用输入<code class="fe mb mc md me b">x_train</code>和标签<code class="fe mb mc md me b">y_train</code>训练模型。</li></ul><h2 id="3e82" class="kx ky jb bd kz la lb dn lc ld le dp lf kj lg lh li kn lj lk ll kr lm ln lo lp bi translated">#4.预测价格</h2><p id="25bf" class="pw-post-body-paragraph jy jz jb ka b kb lq kd ke kf lr kh ki kj ls kl km kn lt kp kq kr lu kt ku kv ij bi translated">我们终于到了期待已久的预测价格的时刻。我们有 2 个步骤:预测价格，并绘制价格图，与真实结果进行比较。</p><ul class=""><li id="ac5a" class="mm mn jb ka b kb kc kf kg kj mo kn mp kr mq kv mr ms mt mu bi translated">预测下个月的价格</li></ul><p id="99fb" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如你已经看到的，Keras 让一切变得如此简单。这里的情况是一样的:</p><figure class="lv lw lx ly gt is"><div class="bz fp l di"><div class="lz ma l"/></div></figure><figure class="lv lw lx ly gt is"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="980a" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">第 1–6 行:我们做的和训练集完全一样。使用<code class="fe mb mc md me b">min_max_transform</code>来缩放数据，然后为预测重塑数据。</p><p id="d726" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">第 7 行:预测。</p><p id="67bb" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">第 8 行:重新调整预测数据以匹配其真实值(美元价格)</p><ul class=""><li id="5506" class="mm mn jb ka b kb kc kf kg kj mo kn mp kr mq kv mr ms mt mu bi translated">可视化结果</li></ul><p id="9db4" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后，我们将使用下面的代码片段绘制测试价格和预测价格:</p><figure class="lv lw lx ly gt is"><div class="bz fp l di"><div class="lz ma l"/></div></figure><figure class="lv lw lx ly gt is"><div class="bz fp l di"><div class="lz ma l"/></div></figure><p id="5030" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">结果碰巧真的很有趣。当然，预测的准确性并不出色，但仍然很酷:</p><figure class="lv lw lx ly gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi na"><img src="../Images/aa9e61c105c1ab8a61af5862ea61278b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Svk12bpwhIE1cUQZ8ABr7Q.png"/></div></div></figure><blockquote class="nb"><p id="22d6" class="nc nd jb bd ne nf ng nh ni nj nk kv dk translated">更多 AI 内容，<a class="ae kw" href="https://www.linkedin.com/in/simeonkostadinov/" rel="noopener ugc nofollow" target="_blank">在 LinkedIn 关注我</a>。</p></blockquote><h2 id="71d8" class="kx ky jb bd kz la nl dn lc ld nm dp lf kj nn lh li kn no lk ll kr np ln lo lp bi translated">感谢您的阅读。如果你喜欢这篇文章，给它一些掌声👏。希望你有一个伟大的一天！</h2></div></div>    
</body>
</html>