<html>
<head>
<title>Data Science Simplified Part 10: An Introduction to Classification Models</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">数据科学简化版第10部分:分类模型介绍</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-science-simplified-part-10-an-introduction-to-classification-models-82490f6c171f?source=collection_archive---------1-----------------------#2017-09-18">https://towardsdatascience.com/data-science-simplified-part-10-an-introduction-to-classification-models-82490f6c171f?source=collection_archive---------1-----------------------#2017-09-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="d53d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">韦伯斯特对分类的定义如下:</p><blockquote class="kl"><p id="a0eb" class="km kn iq bd ko kp kq kr ks kt ku kk dk translated">根据已建立的标准在组或类别中的系统安排。</p></blockquote><p id="0cee" class="pw-post-body-paragraph jn jo iq jp b jq kv js jt ju kw jw jx jy kx ka kb kc ky ke kf kg kz ki kj kk ij bi translated">周围的世界充满了量词。分类器有助于防止垃圾邮件。分类器有助于识别可能流失的客户。分类器有助于预测是否会下雨。这种监督学习方法在商业应用中无处不在。我们认为这是理所当然的。</p><p id="6afe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这篇博文中，我将讨论分类模型的关键概念。</p><h1 id="7314" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">分类类别</h1><p id="2518" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">回归模型估计数值变量，也称为因变量。对于回归模型，目标总是一个数字。分类模型有一个定性目标。这些目标也称为类别。</p><p id="e8a5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在大量的分类问题中，目标被设计成二元的。二进制意味着目标将只取一个<strong class="jp ir"> <em class="md"> 0或</em>1</strong>值。这些类型的分类器被称为二元分类器。让我们举个例子来理解这一点。</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi me"><img src="../Images/7ac048a2616e7be18a7b2abd1cba3bae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QUP2zFOd-pzmM3cW."/></div></div></figure><p id="8985" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">回归模型估计数值变量，也称为因变量。对于回归模型，目标总是一个数字。分类模型有一个定性目标。这些目标也称为类别。</p><p id="85b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在大量的分类问题中，目标被设计成二元的。二进制意味着目标将只接受0或1值。这些类型的分类器被称为<strong class="jp ir">二元分类器。</strong>让我们举个例子来理解这一点。一家银行的贷款审批部门希望使用机器学习来识别潜在的贷款违约者。在这种情况下，机器学习模型将是一个分类模型。根据模型从输入的数据中获得的信息，它会将贷款申请人分为两类:</p><ul class=""><li id="48b6" class="mq mr iq jp b jq jr ju jv jy ms kc mt kg mu kk mv mw mx my bi translated">第一桶:潜在违约者。</li><li id="af1f" class="mq mr iq jp b jq mz ju na jy nb kc nc kg nd kk mv mw mx my bi translated">第二桶:潜在的非违约者。</li></ul><p id="2525" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这种情况下，目标将是一个类似于“<strong class="jp ir"> <em class="md"> will_default_flag”的属性。</em> </strong>“这个目标将适用于每一个贷款申请人。它的值为0或1。如果模型预测为1，则意味着申请人很可能违约。如果模型预测它为0，这意味着申请人可能不会违约。一些分类器还可以将输入分类到许多桶中。这些分类器被称为<strong class="jp ir">多类分类器。</strong></p><h1 id="393d" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">线性和非线性分类器</h1><p id="8249" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">假设我们想要建立一个分类器，对潜在的贷款违约者进行分类。收入和信用评级的特征决定了潜在的违约者。</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi me"><img src="../Images/bc6bd427be6f13cedcaa5101eab147b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-Rq3d0fGxTZJY44D."/></div></div></figure><p id="e1b8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上图描述了这个场景。为了简单起见，让我们说特征空间是收入和信用评级的交集。绿点表示未违约，粉点表示违约。分类器基于数据的输入特征(收入和信用评级)进行学习。分类器创建一条线。这条线将特征空间分成两部分。分类器创建一个模型，以下列方式对数据进行分类:</p><ul class=""><li id="626a" class="mq mr iq jp b jq jr ju jv jy ms kc mt kg mu kk mv mw mx my bi translated">任何落在线左侧的人都是潜在的违约者。</li><li id="b5bf" class="mq mr iq jp b jq mz ju na jy nb kc nc kg nd kk mv mw mx my bi translated">任何落在线左侧的人都是潜在的非违约者。</li></ul><p id="af53" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">分类器可以用一条线分割特征空间。这种分类器称为线性分类器。</p><p id="6a0f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个例子中，只有两个特征。如果有三个特征，分类器将适合将平面分成两部分的平面。如果有三个以上的特征，分类器创建一个超平面。</p><p id="67e7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是一个过于简单的场景。一条线或一个平面可以将数据点分成两个桶。如果数据点以下列方式分布会怎样:</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi me"><img src="../Images/de248c971ec6a97c1bfcb57ff3f64b16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*uC5nJLfVTDcBb4JB."/></div></div></figure><p id="4277" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这里，线性分类器无法施展它的魔法。分类器需要绘制一条曲线来区分违约者和非违约者。这种分类器被称为非线性分类器。</p><p id="d031" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有很多算法可以用来创建分类模型。像逻辑回归这样的算法是很好的线性分类器。其他如神经网络是良好的非线性分类器。</p><p id="f60a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">分类器的直觉如下:</p><blockquote class="kl"><p id="0dcb" class="km kn iq bd ko kp kq kr ks kt ku kk dk translated"><em class="ne">用函数(线性或非线性)划分特征空间。对其进行划分，使特征空间的一部分包含来自一个类的数据。特征空间的另一部分具有来自其他类别</em>的数据</p></blockquote><p id="4a5a" class="pw-post-body-paragraph jn jo iq jp b jq kv js jt ju kw jw jx jy kx ka kb kc ky ke kf kg kz ki kj kk ij bi translated">我们对分类器如何工作有一种直觉。我们如何衡量一个分类器做得好不好？这里出现了<strong class="jp ir">的概念<em class="md">混乱矩阵。</em> </strong></p><p id="9e4f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们举个例子来理解这个概念。我们建立了一个贷款违约分类器。这个分类器接受输入数据，对其进行训练，然后是它学习的内容。</p><ul class=""><li id="f96c" class="mq mr iq jp b jq jr ju jv jy ms kc mt kg mu kk mv mw mx my bi translated">分类器将35名申请人归类为违约者。</li><li id="03b1" class="mq mr iq jp b jq mz ju na jy nb kc nc kg nd kk mv mw mx my bi translated">分类器将65名申请人归类为非违约者。</li></ul><p id="7a88" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">基于分类器执行的方式，又导出了四个度量:</p><ol class=""><li id="09f0" class="mq mr iq jp b jq jr ju jv jy ms kc mt kg mu kk nf mw mx my bi translated">在那些被归类为违约者 的<strong class="jp ir"> <em class="md">中，只有12人是实际违约者。这个度量被称为<strong class="jp ir">真阳性(TP)。</strong></em></strong></li><li id="2d2c" class="mq mr iq jp b jq mz ju na jy nb kc nc kg nd kk nf mw mx my bi translated">在被归类为违约者 的<strong class="jp ir"> <em class="md">中，有23人实际上没有违约。这个指标被称为<strong class="jp ir">假阳性(FP)。</strong></em></strong></li><li id="26e5" class="mq mr iq jp b jq mz ju na jy nb kc nc kg nd kk nf mw mx my bi translated">在那些被归类为非违约者 的<strong class="jp ir"> <em class="md">中，只有57人是真正的非违约者。这个度量被称为<strong class="jp ir">真负值(TN)。</strong></em></strong></li><li id="5f65" class="mq mr iq jp b jq mz ju na jy nb kc nc kg nd kk nf mw mx my bi translated">在被归类为非违约者的<strong class="jp ir"><em class="md"/></strong>中，有8人是实际违约者。这个指标被称为<strong class="jp ir">假阴性(FN)。</strong></li></ol><p id="3134" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这四个指标可以列表成一个矩阵，称为<strong class="jp ir"> <em class="md">混淆矩阵。</em>T9】</strong></p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi me"><img src="../Images/74a8ef706184998507c6063cc9d8f473.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*GEA1qMDQkc01Eu96."/></div></div></figure><p id="1b66" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从这四个度量中，我们将为分类器导出<strong class="jp ir">评估度量</strong>。让我们来讨论这些评估指标。</p><h1 id="ca35" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">精确度:</h1><p id="0995" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated"><strong class="jp ir">准确性</strong>衡量分类器对真阳性和真阴性情况的正确率。数学上，它被定义为:</p><blockquote class="kl"><p id="2267" class="km kn iq bd ko kp kq kr ks kt ku kk dk translated"><em class="ne">准确率=(真阳性+真阴性)/总预测。</em></p></blockquote><p id="1dd7" class="pw-post-body-paragraph jn jo iq jp b jq kv js jt ju kw jw jx jy kx ka kb kc ky ke kf kg kz ki kj kk ij bi translated">在这个例子中，贷款违约分类器的精度是:(12+57) / 100 = 0.69 = 69%。</p><h1 id="d2ca" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">敏感性或回忆:</h1><p id="731b" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated"><strong class="jp ir">回忆</strong>测量分类器获得正确真值的次数。数学上，它被定义为:</p><blockquote class="kl"><p id="ac41" class="km kn iq bd ko kp kq kr ks kt ku kk dk translated"><em class="ne">召回=真阳性/(真阳性+假阴性)</em></p></blockquote><p id="e7d4" class="pw-post-body-paragraph jn jo iq jp b jq kv js jt ju kw jw jx jy kx ka kb kc ky ke kf kg kz ki kj kk ij bi translated">在示例中，贷款违约分类器的召回率是:12/(12+8) = 0.60 = 60%。</p><h1 id="81ba" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">特异性:</h1><p id="7f45" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated"><strong class="jp ir">特异性</strong>衡量分类器获得正确否定的次数。数学上，它被定义为:</p><blockquote class="kl"><p id="2aa6" class="km kn iq bd ko kp kq kr ks kt ku kk dk translated"><em class="ne">特异性=(真阴性)/(真阴性+假阳性)</em></p></blockquote><p id="7d71" class="pw-post-body-paragraph jn jo iq jp b jq kv js jt ju kw jw jx jy kx ka kb kc ky ke kf kg kz ki kj kk ij bi translated">在示例中，贷款违约分类器的特异性为:57/(57+23) = 0.7125 = 71.25%。</p><h1 id="f8b9" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">精度:</h1><p id="63f9" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">精度衡量预测为正的总数中实际为正的有多少。数学上，它被定义为:</p><blockquote class="kl"><p id="f511" class="km kn iq bd ko kp kq kr ks kt ku kk dk translated"><em class="ne">精度=(真阳性)/(真阳性+假阳性)</em></p></blockquote><p id="7e0d" class="pw-post-body-paragraph jn jo iq jp b jq kv js jt ju kw jw jx jy kx ka kb kc ky ke kf kg kz ki kj kk ij bi translated">在这个例子中，贷款违约分类器的精度是:12/(12+23) = 0.48 = 48%。</p><p id="f3d9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些是很多指标。我们应该依赖哪些指标？这个问题在很大程度上取决于业务环境。在任何情况下，一个单独的度量标准都不能给出分类器有多好的全貌。让我们举一个例子。</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi me"><img src="../Images/464edc84a774930c66bd7fe1e710035d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*5kjlmyW0lJ5V5VJq."/></div></div></figure><p id="3d67" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们建立了一个识别欺诈交易的分类器。该分类器确定交易是否真实。历史模式显示，每100笔交易中就有两笔欺诈交易。我们构建的分类器具有以下混淆矩阵。</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi me"><img src="../Images/95092bed40c765254b1127f1e2f2ee4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*NtX9WGwSXWqoETJp."/></div></div></figure><ul class=""><li id="70e7" class="mq mr iq jp b jq jr ju jv jy ms kc mt kg mu kk mv mw mx my bi translated">准确率为98%</li><li id="7d13" class="mq mr iq jp b jq mz ju na jy nb kc nc kg nd kk mv mw mx my bi translated">召回率是100%</li><li id="1f51" class="mq mr iq jp b jq mz ju na jy nb kc nc kg nd kk mv mw mx my bi translated">精确度为98%</li><li id="aa38" class="mq mr iq jp b jq mz ju na jy nb kc nc kg nd kk mv mw mx my bi translated">特异性为0%</li></ul><p id="67c9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果这种模型是基于准确性、召回率和精确度的标准来部署的，那么公司肯定会完蛋。虽然这个模型表现很好，但事实上，它是一个愚蠢的模型。它没有做它应该做的事情，即标记欺诈交易。这个模型最重要的指标是特异性。其特异性为0%。</p><p id="a9c4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因为不能依赖单一的度量来评估分类器，所以创建了更复杂的度量。这些复杂的指标是上述所有指标的组合。这里解释几个关键的。</p><h1 id="857f" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">F1分数:</h1><p id="309e" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">F1分数是精确度和召回率之间的调和平均值。常规平均值平等对待所有值。调和平均值对较低值给予更大的权重。因此，只有在召回率和精确度都很高的情况下，分类器才会得到高的F1分数。它被定义为:</p><blockquote class="kl"><p id="382f" class="km kn iq bd ko kp kq kr ks kt ku kk dk translated"><em class="ne"> F1 = 2x(精度x召回)/(精度+召回)</em></p></blockquote><h1 id="9676" class="la lb iq bd lc ld le lf lg lh li lj lk ll ng ln lo lp nh lr ls lt ni lv lw lx bi translated">受试者工作特征(ROC)和曲线下面积(AUC):</h1><p id="6db9" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">接收机工作特性又名<strong class="jp ir"> ROC </strong>是一个视觉指标。这是一个二维的情节。它在X轴上具有假阳性率或1-特异性，在Y轴上具有真阳性率或灵敏度。</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi me"><img src="../Images/c5ecbcd006a4dfeb2db52d59a28eb4b1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ZmU_8MRTVbBOgbKx."/></div></div></figure><p id="32c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在ROC图中，有一条线测量一个<strong class="jp ir"> <em class="md">随机分类器</em> </strong>将如何预测TPR和FPR。它是直的，因为它有相等的概率预测0或1。</p><p id="c5c4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果一个分类器做得更好，那么与FPR相比，它应该具有更大比例的TPR。这将把曲线推向西北方向。</p><p id="8cd4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">曲线下面积(AUC)是ROC曲线的面积。如果AUC是1，即100%,这意味着它是一个完美的分类器。如果AUC是0.5，即50%，这意味着分类器不比掷硬币好。</p><figure class="mf mg mh mi gt mj gh gi paragraph-image"><div role="button" tabindex="0" class="mk ml di mm bf mn"><div class="gh gi me"><img src="../Images/70f6daf9283ed09908359f790115edb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_JEK09OLYTXZR7Yy."/></div></div></figure><p id="981a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有很多评估指标来测试一个分类器。分类器需要根据业务环境进行评估。需要根据上下文选择正确的指标。没有一个神奇的标准。</p><h1 id="0641" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">结论</h1><p id="842e" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">在这篇文章中，我们已经看到了分类器的基础知识。分类器在数据科学中无处不在。有许多实现分类器的算法。各有各的优缺点。我们将在本系列的后续文章中讨论一些算法。</p></div><div class="ab cl nj nk hu nl" role="separator"><span class="nm bw bk nn no np"/><span class="nm bw bk nn no np"/><span class="nm bw bk nn no"/></div><div class="ij ik il im in"><p id="dc6b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="md">原载于2017年9月18日</em><a class="ae nq" href="https://datascientia.blog/2017/09/18/dss-p10-class-models/" rel="noopener ugc nofollow" target="_blank"><em class="md">datascientia . blog</em></a><em class="md">。</em></p></div></div>    
</body>
</html>