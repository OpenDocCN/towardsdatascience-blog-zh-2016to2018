<html>
<head>
<title>Exploring the US University Ranks 2017 at the Command-line (Part III — cut, sort and uniq)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在命令行中探索美国大学排名2017(第三部分——剪切、排序和uniq)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-us-university-ranks-2017-at-the-command-line-part-iii-cut-sort-and-uniq-1a81dc0279c2?source=collection_archive---------9-----------------------#2017-08-30">https://towardsdatascience.com/the-us-university-ranks-2017-at-the-command-line-part-iii-cut-sort-and-uniq-1a81dc0279c2?source=collection_archive---------9-----------------------#2017-08-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/5f3ecdb852c52156ee3ec6ebf53d5428.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rvFxp4qJXnZMxHfmQ2c-Fg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Image adopted and modified from the unsplash.com</figcaption></figure><p id="cc70" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">各位编码员好！欢迎回到我的系列课程<strong class="ke ir">数据科学@ Bash Shell </strong>。在这一课中，我们要计算美国各州在数据集中有多少机构被排名。</p><p id="33a4" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">您应该从下面的网页下载数据，因为我们已经稍微简化了数据，让我们将数据保存为:<code class="fe la lb lc ld b">unirank.csv</code></p><pre class="le lf lg lh gt li ld lj lk aw ll bi"><span id="52c5" class="lm ln iq ld b gy lo lp l lq lr">wget https://www.scientificprogramming.io/datasets/unirank.csv</span></pre><h1 id="1689" class="ls ln iq bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">查找每个州的学院数量</h1><p id="5a08" class="pw-post-body-paragraph kc kd iq ke b kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv mt kx ky kz ij bi translated">让我们从提取每一行中与我们相关的部分开始。在我们的例子中，注意我们对列<code class="fe la lb lc ld b">#1</code>和<code class="fe la lb lc ld b">3</code>(分别是<code class="fe la lb lc ld b">university</code>和<code class="fe la lb lc ld b">state</code>的名称)感兴趣。为了提取这些列，我们可以使用名为<code class="fe la lb lc ld b">cut</code>的命令，如下所示:</p><pre class="le lf lg lh gt li ld lj lk aw ll bi"><span id="78b3" class="lm ln iq ld b gy lo lp l lq lr">$ cat unirank.csv | cut -f1,3 -d,</span></pre><p id="f021" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这里，命令行选项<code class="fe la lb lc ld b">-f</code>指定从文件中提取哪个字段(列)或<code class="fe la lb lc ld b">cut</code>(提取)，选项(<code class="fe la lb lc ld b">d,</code>)告诉我们要用逗号(<code class="fe la lb lc ld b">,</code>)分隔切割。当您运行该命令时，您应该看到输出只包含诸如university <code class="fe la lb lc ld b">names</code>和<code class="fe la lb lc ld b">states</code>这样行。注意，尽管名称如此，<code class="fe la lb lc ld b">cut</code>命令并不修改它所作用的原始文件。现在到最后一部分。我们想数一下每个州有多少警察。然而，这是一个复杂的过程，没有一个命令可以做到这一切；我们将不得不使用两个命令。这里我们需要命令<code class="fe la lb lc ld b">uniq -c</code>来计算(因此使用<code class="fe la lb lc ld b">-c</code>)每个状态有多少个独特的外观。但是，<code class="fe la lb lc ld b">uniq -c</code>需要对输入进行排序，所以第一步是<code class="fe la lb lc ld b">sort</code>大学和州的列表。我们可以很容易地用一个叫做<code class="fe la lb lc ld b">sort</code>的命令来做到这一点:</p><pre class="le lf lg lh gt li ld lj lk aw ll bi"><span id="c953" class="lm ln iq ld b gy lo lp l lq lr">$ cat unirank.csv | cut -f1,3 -d, | sort -k 2 -t”,”</span></pre><p id="9d01" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated"><code class="fe la lb lc ld b">sort</code>选项:<code class="fe la lb lc ld b">k 2</code>告诉排序函数选择列<code class="fe la lb lc ld b">2</code>作为键，<code class="fe la lb lc ld b">t”,”</code>选项告诉分隔符是逗号(<code class="fe la lb lc ld b">,</code>)。</p><figure class="le lf lg lh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mu"><img src="../Images/07bdd8a086a84ff0e517e7c6118dd0b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3Rvr64UCpIxvo4x1nZjK1Q.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Output: Institutes sorted by states</figcaption></figure><p id="677f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">注意，作为我们的列表被排序的结果，所有具有相同状态的行都紧挨着彼此。现在，正如我们在上面的计划中提到的，我们将使用<code class="fe la lb lc ld b">uniq -c</code>来“浓缩”相同的相邻行，在这个过程中，计算每一行有多少被看到:</p><pre class="le lf lg lh gt li ld lj lk aw ll bi"><span id="4578" class="lm ln iq ld b gy lo lp l lq lr">$ cat unirank.csv | cut -f3 -d, | sort | uniq -c</span></pre><figure class="le lf lg lh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mv"><img src="../Images/82a643e916a7827483536c585de534b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ih4B2uWmZ7mOGd8mjdQu-g.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Output: Institutes in the CA (California) state.</figcaption></figure><p id="ca61" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们现在有一个列表，列出了每个州有多少大学，很明显，绝大多数排名机构来自加利福尼亚州！</p><h1 id="2097" class="ls ln iq bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">找到排名和学费的相关性？</h1><p id="914b" class="pw-post-body-paragraph kc kd iq ke b kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv mt kx ky kz ij bi translated">我们已经知道排名和每所大学的学费(在数据中给出)。一个有趣的问题是研究大学排名和学费之间的关系。</p><p id="772f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">为了实现这一点，我们首先将<code class="fe la lb lc ld b">cat</code>和<code class="fe la lb lc ld b">cut</code>数据中的<strong class="ke ir">学杂费</strong>(列<code class="fe la lb lc ld b">4</code>)和排名(列<code class="fe la lb lc ld b">6</code>)放入名为<code class="fe la lb lc ld b">udata.csv</code>的新数据集中:</p><pre class="le lf lg lh gt li ld lj lk aw ll bi"><span id="07ba" class="lm ln iq ld b gy lo lp l lq lr">cat unirank.csv | cut -f4,6 -d, &gt; udata.csv</span></pre><p id="d478" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">注意重定向符号(<code class="fe la lb lc ld b">&gt;</code>)，帮助我们保存输出。现在，可以使用名为<code class="fe la lb lc ld b">scatter</code>(安装:<code class="fe la lb lc ld b">sudo pip install bashplotlib</code>)的散点图工具简单地绘制这些数据。</p><pre class="le lf lg lh gt li ld lj lk aw ll bi"><span id="bfbc" class="lm ln iq ld b gy lo lp l lq lr">cat udata.csv| tail -n +2 | scatter</span></pre><p id="6577" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">注意<code class="fe la lb lc ld b">tail -n +2</code>在将输出一直传递到结束<code class="fe la lb lc ld b">scatter</code>之前，不包括第一行，即列标题。然而，这个工具的输出没有多大意义，因为它没有显示任何<code class="fe la lb lc ld b">x,y</code> - axes图例。因此，我们将数据(<code class="fe la lb lc ld b">udata.csv</code>)上传到一个名为<strong class="ke ir"> plot.ly </strong>的在线工具上，产生了下面这张漂亮的散点图:</p><figure class="le lf lg lh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/41dafb1a9712b0ff42c448b9248b9f5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lod1NlnXeiBfJfj-07uO0A.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Output: Ranks vs. tuition: a scatterplot via <strong class="bd mx">plot.ly</strong></figcaption></figure><p id="121d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">从上面的情节不难理解，排名高的大学学费更高！然而，散点图也描述了一所大学(<strong class="ke ir">杨百翰大学-Provo</strong>)排名更高(排名=68)，学费极低(<strong class="ke ir"> $5300美元/年</strong>)。这是数据集中的异常(异常值)吗？我们把这个问题留给你进一步调查！</p><h1 id="617d" class="ls ln iq bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">摘要</h1><p id="0c81" class="pw-post-body-paragraph kc kd iq ke b kf mp kh ki kj mq kl km kn mr kp kq kr ms kt ku kv mt kx ky kz ij bi translated">在这个项目中，我们已经学会使用一些重要的bash命令，如<code class="fe la lb lc ld b">head</code>、<code class="fe la lb lc ld b">tail</code>、<code class="fe la lb lc ld b">sort</code>、<code class="fe la lb lc ld b">uniq</code>、<code class="fe la lb lc ld b">cut</code>等。在上下文中挖掘由美国学术机构排名组成的csv格式的玩具数据集。</p><p id="6b67" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">参见前面几个部分:<a class="ae my" href="https://medium.com/towards-data-science/how-to-analyze-us-university-ranks-2017-with-bash-part-i-data-preview-e39b8f2ffee9" rel="noopener"> <strong class="ke ir">第一部分</strong></a><a class="ae my" href="https://medium.com/towards-data-science/finding-the-percent-of-colleges-in-the-us-university-ranks-2017-at-the-command-line-part-ii-grep-5db6d59f76a1" rel="noopener"><strong class="ke ir">第二部分</strong> </a> <a class="ae my" href="https://apps.timwhitlock.info/emoji/tables/unicode#emoji-modal" rel="noopener ugc nofollow" target="_blank">🚶</a></p><p id="1120" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">[该项目是'<a class="ae my" href="https://www.scientificprogramming.io/learn-bash/" rel="noopener ugc nofollow" target="_blank">学习在Bash Shell和Linux中分析数据</a>课程的一部分。]</p><h1 id="9dfd" class="ls ln iq bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">相关作品</h1><div class="mz na gp gr nb nc"><a href="https://www.scientificprogramming.io/learn-bash/" rel="noopener  ugc nofollow" target="_blank"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd ir gy z fp nh fr fs ni fu fw ip bi translated">学习在Bash Shell和Linux中分析数据——学习科学编程</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">一个简单的课程演示了Bash shell在处理真实数据集时的使用</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">www . scientific编程. io</p></div></div><div class="nl l"><div class="nm l nn no np nl nq jw nc"/></div></div></a></div></div></div>    
</body>
</html>