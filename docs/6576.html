<html>
<head>
<title>NLP with Kotlin</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Kotlin 的 NLP</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/nlp-with-kotlin-ec84c068650?source=collection_archive---------16-----------------------#2018-12-19">https://towardsdatascience.com/nlp-with-kotlin-ec84c068650?source=collection_archive---------16-----------------------#2018-12-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="c00c" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">使用 n 元语法的第一种方法</h2></div><p id="0a64" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">自然语言处理(<strong class="kh ir"> NLP </strong>)是许多打着“机器学习”商标的应用程序的核心，尽管它们是自己的一组算法和接近人工智能的方式(对此有所保留)</p><p id="dac7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">NLP 用于创建聊天机器人，当你请求支持时，它可以帮助你提供相似的搜索结果；通过提供更容易处理的文本表示来翻译文本或减轻其他应用程序必须做的工作</p><p id="d2f0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">NLP 的一个应用是生成或猜测序列中的下一个单词。与其他机器学习过程一样，猜测下一个单词需要训练一个模型，并使用它进行推理。</p><p id="1b20" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这个例子中，您将看到如何构建一个在字符级工作的简单的单词生成器。</p><p id="856e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">完成这项任务有不同的方法。在过去的几年里，不同风格的 RNN 正在击败其他产生文本的机制。然而，在这个项目中，我决定放弃它们，转而采用更简单的 n-gram 表示，因为它更适合解决这个问题</p><p id="ec23" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你想直接进入代码，可以在这里找到</p><div class="lb lc gp gr ld le"><a href="https://github.com/mccorby/MachineLearning" rel="noopener  ugc nofollow" target="_blank"><div class="lf ab fo"><div class="lg ab lh cl cj li"><h2 class="bd ir gy z fp lj fr fs lk fu fw ip bi translated">麦考比/机器学习</h2><div class="ll l"><h3 class="bd b gy z fp lj fr fs lk fu fw dk translated">在 GitHub 上创建一个帐户，为 mccorby/MachineLearning 的开发做出贡献。</h3></div><div class="lm l"><p class="bd b dl z fp lj fr fs lk fu fw dk translated">github.com</p></div></div><div class="ln l"><div class="lo l lp lq lr ln ls lt le"/></div></div></a></div><h2 id="c997" class="lu lv iq bd lw lx ly dn lz ma mb dp mc ko md me mf ks mg mh mi kw mj mk ml mm bi translated">什么是 n 元模型？</h2><p id="3015" class="pw-post-body-paragraph kf kg iq kh b ki mn jr kk kl mo ju kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">n-gram 基本上是一种将文本分割成一系列连续标记的方法</p><p id="1f9d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，对于文本“<em class="ms">在拉曼查的一个村庄，我不想想起它的名字</em>”，一个 4 克的表示将是</p><figure class="mu mv mw mx gt my gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/014f98eb36478dc82f9f70d4c68b4c03.png" data-original-src="https://miro.medium.com/v2/resize:fit:208/format:webp/1*0D64vfm98TJmwW9aToemRw.png"/></div></figure><p id="ae82" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">n-gram 语言模型将使用这种表示，通过计算不同的可能延续出现的次数来估计序列中下一个项目(一个单词、一个字符、一个完整的句子)的概率</p><p id="d91f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此项目中使用的 n-gram 语言模型由地图的地图表示，如下图所示</p><figure class="mu mv mw mx gt my gh gi paragraph-image"><div class="gh gi na"><img src="../Images/63a888dcfd5a20e7deefb24b78cba0dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*uT5t60vOOd_1pvwHu39EPQ.png"/></div></figure><p id="853b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">每个条目代表一个 n-gram，带有序列中可能的字符的映射以及在语料库中找到的出现次数</p><p id="65c7" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这由一个<em class="ms">映射&lt;字符串、映射&lt;字符、Int &gt; &gt; </em>表示</p><p id="dc2f" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">下面的代码用于定型模型</p><figure class="mu mv mw mx gt my"><div class="bz fp l di"><div class="nb nc l"/></div><figcaption class="nd ne gj gh gi nf ng bd b be z dk">Training process for character-based n-gram language model</figcaption></figure><p id="8cf2" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在构建更复杂的架构和方法时，n 元模型经常被用作基线模型</p><h2 id="e05b" class="lu lv iq bd lw lx ly dn lz ma mb dp mc ko md me mf ks mg mh mi kw mj mk ml mm bi translated">生成文本</h2><p id="b16a" class="pw-post-body-paragraph kf kg iq kh b ki mn jr kk kl mo ju kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">为了使用这个模型生成文本，应用程序将获取一个初始输入(或空字符串)并查找下一个字符的候选字符。该字符被添加到输入中，形成在后续步骤中使用的历史</p><figure class="mu mv mw mx gt my"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="2230" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一个使用 5 克模型的样本没有唐吉诃德的初始种子，如下所示</p><blockquote class="nh ni nj"><p id="6f77" class="kf kg ms kh b ki kj jr kk kl km ju kn nk kp kq kr nl kt ku kv nm kx ky kz la ij bi translated">第十章。</p><p id="779b" class="kf kg ms kh b ki kj jr kk kl km ju kn nk kp kq kr nl kt ku kv nm kx ky kz la ij bi translated">它的工作是给<br/>的黑客装上马鞍，同时处理角色并追逐角色<br/>去了拉曼查的一个村庄</p><p id="2240" class="kf kg ms kh b ki kj jr kk kl km ju kn nk kp kq kr nl kt ku kv nm kx ky kz la ij bi translated">其中对待角色和追求他，他把角色和实践自己拿起他的收入。这个人物和追求他的那个保持兵刃<br/>的人物和追求它的人一样，都曾在他的收入里。所以，对它的追求也是如此，没有被称为 quexana 的欲望。角色的性格和追求，给角色装上马鞍，让自己成为一名骑士，周六吃点残羹剩饭，周六吃点扁豆，周六吃点扁豆，瘦瘦的，一个老圆盾，很久以前就不是他的收入了。这个人物和追求他的那个拉曼查保持兵刃之一</p></blockquote><p id="0a0a" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这段文字看起来很像塞万提斯写的东西(如果不是在他最好的时候)</p><h2 id="3419" class="lu lv iq bd lw lx ly dn lz ma mb dp mc ko md me mf ks mg mh mi kw mj mk ml mm bi translated">缓和</h2><p id="01d8" class="pw-post-body-paragraph kf kg iq kh b ki mn jr kk kl mo ju kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">但是当模型没有注册历史时会发生什么呢？然后它将停止工作，因为没有下一个字符</p><p id="7c8d" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这些情况下，使用一些技术。其中有平滑，特别是<a class="ae nn" href="https://rpubs.com/pferriere/dscapreport" rel="noopener ugc nofollow" target="_blank">愚蠢的退避</a>。</p><p id="9f26" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">简而言之，愚蠢的退避将使用较低阶的 n 元文法来计算丢失条目的概率</p><figure class="mu mv mw mx gt my"><div class="bz fp l di"><div class="nb nc l"/></div></figure><h2 id="dff0" class="lu lv iq bd lw lx ly dn lz ma mb dp mc ko md me mf ks mg mh mi kw mj mk ml mm bi translated">选择字符</h2><p id="b5db" class="pw-post-body-paragraph kf kg iq kh b ki mn jr kk kl mo ju kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">根据用于训练模型的语料库，选择下一个字符可能很棘手。如果总是选择具有最高概率的字符，则模型有可能陷入重复</p><p id="17c3" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了避免这个问题，使用了从与当前历史相关联的一组可能候选中随机选择的字符</p><figure class="mu mv mw mx gt my"><div class="bz fp l di"><div class="nb nc l"/></div></figure><h2 id="0186" class="lu lv iq bd lw lx ly dn lz ma mb dp mc ko md me mf ks mg mh mi kw mj mk ml mm bi translated">丰富</h2><ul class=""><li id="2afd" class="no np iq kh b ki mn kl mo ko nq ks nr kw ns la nt nu nv nw bi translated">与任何其他机器学习问题一样，在构建系统时需要一系列步骤:数据检查、清理、模型评估</li><li id="fefd" class="no np iq kh b ki nx kl ny ko nz ks oa kw ob la nt nu nv nw bi translated">用于训练模型的语料库可以被清理，去除停用词</li></ul><h2 id="6305" class="lu lv iq bd lw lx ly dn lz ma mb dp mc ko md me mf ks mg mh mi kw mj mk ml mm bi translated">结论</h2><p id="7c5f" class="pw-post-body-paragraph kf kg iq kh b ki mn jr kk kl mo ju kn ko mp kq kr ks mq ku kv kw mr ky kz la ij bi translated">这个项目展示了如何创建一个字符级的 n-gram 语言模型来生成文本。</p><p id="b9f0" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我将使用这个模型作为该项目的第二部分的基础。</p><p id="495b" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">敬请期待！</p></div></div>    
</body>
</html>