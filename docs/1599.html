<html>
<head>
<title>Solving the Multi-Armed Bandit Problem</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">解决多臂强盗问题</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/solving-the-multi-armed-bandit-problem-b72de40db97c?source=collection_archive---------1-----------------------#2017-09-25">https://towardsdatascience.com/solving-the-multi-armed-bandit-problem-b72de40db97c?source=collection_archive---------1-----------------------#2017-09-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="c594" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">多臂土匪问题是一个经典的强化学习例子，我们有一个带<em class="kl"> n </em>个臂(土匪)的老虎机，每个臂都有自己操纵的成功概率分布。拉任何一只手臂都会给你一个随机奖励，成功的话R=+1，失败的话R=0。我们的目标是按顺序一个接一个地拉动手臂，这样从长远来看，我们可以获得最大的总回报。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/fe592d8ce921405f3896d2914e7df9de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Tt8A6mP98ibBlrlFD5UJxg.png"/></div></div></figure><p id="0b60" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">多臂土匪问题的重要性在于我们(代理人)无法获得真正的土匪概率分布——所有的学习都是通过试错法和价值估计的方式进行的。所以问题是:</p><p id="98f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">我们如何设计一个系统的策略来适应这些随机的回报？</strong></p><p id="4559" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这是我们针对多兵种土匪问题的目标，拥有这样的策略将在许多现实世界的情况下证明非常有用，在这些情况下，人们希望从一群土匪<em class="kl">中选出“最好的”土匪，即A/B测试、阵容优化、评估社交媒体影响力</em>。</p><p id="da96" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本文中，我们使用一种经典的强化学习技术来解决多臂强盗问题，这种技术由一个<em class="kl">ε-贪婪代理</em>和一个学习框架<em class="kl">报酬-平均抽样</em>来计算行动值Q(a)以帮助代理改进其未来行动决策，从而实现长期报酬最大化。这个多臂bandit算法解决方案的Python代码实现可以在我的Github中找到，网址是:</p><blockquote class="ky kz la"><p id="4a2a" class="jn jo kl jp b jq jr js jt ju jv jw jx lb jz ka kb lc kd ke kf ld kh ki kj kk ij bi translated"><a class="ae le" href="https://github.com/ankonzoid/LearningX/tree/master/classical_RL/multiarmed_bandit" rel="noopener ugc nofollow" target="_blank"><strong class="jp ir">https://github . com/ankonzoid/learning x/tree/master/classical _ RL/multi armed _ bandit</strong></a></p></blockquote><p id="d82f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请参考我们的附录，了解关于ε贪婪代理的更多细节，以及如何使用平均回报采样方法迭代更新Q(a)。在下一节中，我们将解释在multi-armed bandit环境中部署这样一个代理的结果。</p><p id="4667" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我关于深度学习和强化学习的更多博客、教程和项目可以在我的<a class="ae le" href="https://medium.com/@ankonzoid" rel="noopener"><strong class="jp ir"/></a><strong class="jp ir"/>和我的<a class="ae le" href="https://github.com/ankonzoid" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> Github </strong> </a> <strong class="jp ir">找到。</strong></p><h1 id="2625" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">结果:代理选择了哪些土匪？</h1><p id="fc98" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">考虑我们的Python代码示例，其中有10个硬编码的盗匪，每个盗匪都有自己的成功概率(请记住，我们的代理对这些数字视而不见，它只能通过对盗匪进行单独采样来实现这些数字):</p><pre class="kn ko kp kq gt mi mj mk ml aw mm bi"><span id="a55b" class="mn lg iq mj b gy mo mp l mq mr">Bandit #1 = 10% success rate<br/>Bandit #2 = 50% success rate<br/>Bandit #3 = 60% success rate<br/><strong class="mj ir">Bandit #4 = 80% success rate (best)</strong><br/>Bandit #5 = 10% success rate<br/>Bandit #6 = 25% success rate<br/>Bandit #7 = 60% success rate<br/>Bandit #8 = 45% success rate<br/><strong class="mj ir">Bandit #9 = 75% success rate (2nd best)</strong><br/><strong class="mj ir">Bandit #10 = 65% success rate (3rd best)</strong></span></pre><p id="fccb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过检查，我们将期待我们的代理长期挑选出Bandit #4作为最强的信号，Bandit #9紧随其后，Bandit #10紧随其后，以此类推。</p><p id="12de" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在来看结果。我们以10%的epsilon探索概率对agent进行了2000次从头开始的实验，每次实验对agent进行10000集的训练。代理选择的强盗的平均比例作为集数的函数如图1所示。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ms"><img src="../Images/71fa96f83a09814d51deda83717c3065.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bziuySOR9kQitXVBm5_WNg.png"/></div></div><figcaption class="mt mu gj gh gi mv mw bd b be z dk">Fig 1) Bandit choices by the epsilon-greedy agent (epsilon = 10%) throughout its training</figcaption></figure><p id="1731" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在图1中，我们可以看到，在训练开始(&lt; 10 episodes) as it is in its exploratory phase of not knowing which bandits to take advantage of yet. It is until we reach later episodes (&gt; 100集)时，强盗的选择均匀地分布在所有强盗中约10%。我们是否看到一个明显的贪婪机制优先于决定哪个强盗应该获得更高的优先级，因为到目前为止所采样的奖励。不出所料，在训练的中后期阶段，4号、9号和10号强盗是被代理人选中的。最后，几乎不可避免的是，在训练结束时，代理人倾向于几乎总是选择Bandit #4作为“最佳”Bandit，其平台期约为90%(由于固定的epsilon exploration参数，应始终保持约10%)。</p><p id="2cf1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">尽管在这个问题中，最佳策略是选择强盗4，但是你会注意到，这并不意味着拉强盗4就一定会在给定的拉中击败任何其他强盗，因为奖励是随机的；在长期平均回报中，你会发现土匪#4占优势。此外，使用我们的代理来解决这个问题并没有什么特别之处——这只是可以适应性地最大化长期回报集合的许多方法之一。绝对存在这样的情况，完全探索性的(ε= 100%)，或完全贪婪的代理人(ε= 0%)，或介于两者之间的任何人，可能最终在有限的几集里获得比我们的ε= 10%贪婪的代理人更多的奖励。在我看来，部署这样一个代理的主要吸引力在于，可以自动最小化重新选择已经显示出一些失败迹象的强盗。从商业和实践的角度来看，这可以节省大量的时间和资源，否则会浪费在寻找“最佳”强盗的优化过程中。</p><h1 id="5f49" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">附录:ε-贪婪代理“个性”和报酬平均抽样“学习规则”</h1><p id="9ad4" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">简而言之，ε-贪婪代理是(1)完全探索代理和(2)完全贪婪代理的混合体。在多臂土匪问题中，一个完全探索性的代理将以统一的速率对所有土匪进行采样，并随着时间的推移获得关于每个土匪的知识；这种代理的警告是，这种知识从来没有被用来帮助自己做出更好的未来决策！在另一个极端，一个完全贪婪的代理人会选择一个强盗，并永远坚持自己的选择；它不会努力尝试系统中的其他强盗，看看他们是否有更好的成功率来帮助它实现长期回报的最大化，因此它是非常狭隘的！</p><p id="478c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了得到一个拥有两个世界的最好的有点令人满意的代理，ε贪婪代理被设计为在任何状态下给ε机会(例如10%)来随机地探索土匪，并且在所有其他时间贪婪地对其当前的“最佳”土匪值估计采取行动。围绕这一点的直觉是，贪婪机制可以帮助代理专注于其当前最“成功”的盗匪，而探索机制让代理探索可能存在的更好的盗匪。</p><p id="afc1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">剩下的唯一问题是:我们如何给代理定义一个强盗的“价值”概念，以便它可以贪婪地选择？借鉴强化学习，我们可以定义行动价值函数Q(s，a)来表示从状态<strong class="jp ir"> s </strong>采取行动<strong class="jp ir"> a </strong>的预期长期回报。在我们的多臂强盗的例子中，每一个动作都将代理带入一个终结状态，因此长期回报就是直接回报，我们将动作价值的定义简化为</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/7bb157120e480b0e61bf2fe9060f76eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:758/format:webp/1*Iry-6RawcJiaFGVMSmxt_g.png"/></div></figure><p id="404a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">其中<strong class="jp ir"> k </strong>是一个(强盗)在过去被选择的次数<strong class="jp ir">的计数器，而<strong class="jp ir"> r </strong>是每次选择强盗的随机奖励。通过一些额外的算术操作，这个定义可以递归地重写为</strong></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/30d4fbc4f57bccb7985d1e9d4ff864a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/format:webp/1*uyOlGzdo1Nf4koa777Ch6w.png"/></div></figure><p id="cc6c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于我们不知道从知道Q(a)的“真实”值开始，我们可以使用这个递归定义作为迭代工具，在每集结束时近似Q(a)。</p><p id="c793" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了将ε-贪婪代理与我们的动作值Q(a)估计配对，我们让ε-贪婪代理在时间的随机ε-概率上选择一个强盗，并让代理在其余时间从我们的Q(a)估计中贪婪地选择一个动作</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/17e9629f81769f58bfad6fd1a3970bff.png" data-original-src="https://miro.medium.com/v2/resize:fit:644/format:webp/1*I5mZLesyO5PkekbpwuzfTQ.png"/></div></figure><p id="6c71" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有了这两个概念，我们现在可以着手解决多臂土匪问题！</p></div></div>    
</body>
</html>