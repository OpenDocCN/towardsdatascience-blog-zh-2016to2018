<html>
<head>
<title>Announcing Optimus v2 — Agile Data Science Workflows Made Easy</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">宣布 Optimus v2 —简化敏捷数据科学工作流程</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/announcing-optimus-v2-agile-data-science-workflows-made-easy-c127a12d9e13?source=collection_archive---------13-----------------------#2018-08-22">https://towardsdatascience.com/announcing-optimus-v2-agile-data-science-workflows-made-easy-c127a12d9e13?source=collection_archive---------13-----------------------#2018-08-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="48e9" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">作为一名数据科学家，您是否正在寻找一个库来提升您的工作效率？看看这个。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/bab4b927d0dcebcea1329e7935b8b113.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*-I9oOWmM9tGIjalV"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@timothyeberly?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Timothy Eberly</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="d009" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">几年前，我们为一个零售客户项目清理、处理和应用 ML 聚类算法。</p><p id="9652" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当时，我们正在寻找一种工具，让我们能够轻松地处理数据。我们尝试了 trifacta，这是一个制作精美的工具，可以让你通过点击界面以可视化的方式应用转换。问题是可用的脚本语言不足以按照我们喜欢的方式处理数据。</p><p id="7f3f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们还尝试了令人惊叹的熊猫图书馆，但我们的数据大到足以让它哭泣。</p><p id="e2ea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以，大约一年前我们推出了擎天柱。Optimus 由 Spark (Pyspark)提供支持，允许您使用自己的或一组预先创建的数据转换函数清理数据，对其进行分析并应用机器学习，所有这些都很容易，并且具有 python 的所有功能。</p><h1 id="abe3" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">🚚Optimus v2 测试版推出</h1><p id="9423" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">现在，我们准备发射擎天柱 v2。借助 Apache Spark 和 Pyarrow 的全面重写，Optimus 提供了一种访问、转换数据和创建大规模机器学习和深度学习模型的单一方式。</p><p id="0e69" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于这个新版本，在我们惊人的用户反馈后，我们决定致力于三个主要目标:</p><ul class=""><li id="9fca" class="mp mq iq ky b kz la lc ld lf mr lj ms ln mt lr mu mv mw mx bi translated">创建一个可靠的 API 来访问和处理数据。</li><li id="6b46" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">让用户可以轻松地从熊猫迁移。</li><li id="b459" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">让数据探索更容易。</li></ul><h1 id="bc72" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">目标 1:创建可靠的 API 来访问和处理数据</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/6efc7fcaf7122af44cd431993333a306.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oILvCwuoTt7NnjILL6vZtQ.png"/></div></div></figure><p id="1af4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们经营游泳池快一年了。结论，Pandas 和 Spark 是用于数据清理的主要库。因此，我们使用 Optimus 的目标是创建一种可预测的、简单的方法来访问和处理数据。不管是来自熊猫，还是火花。</p><p id="f3a8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下表显示了火花，熊猫和我们用擎天柱创造的东西。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ne nf l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Basic data operations API for Pandas Spark and Optimus</figcaption></figure><p id="5c1e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们在这里看到了一些东西:</p><ul class=""><li id="f644" class="mp mq iq ky b kz la lc ld lf mr lj ms ln mt lr mu mv mw mx bi translated">Spark API 对于基本函数没有任何一致性。</li><li id="44b3" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">对于 Pandas，只有追加列/过滤器不一致。</li></ul><p id="b0cc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，第一步是为我们认为的核心数据操作创建一个一致的基础:</p><ul class=""><li id="4a9d" class="mp mq iq ky b kz la lc ld lf mr lj ms ln mt lr mu mv mw mx bi translated"><strong class="ky ir">创建</strong>数据帧</li><li id="8ea0" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated"><strong class="ky ir">用<strong class="ky ir">追加</strong>行或列()</strong></li><li id="fc1e" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated"><strong class="ky ir">用<strong class="ky ir"> select() </strong>选择</strong>行或列</li><li id="f2b0" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated"><strong class="ky ir">用<strong class="ky ir"> apply() </strong>更新</strong>或转换列数据</li><li id="eef8" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated"><strong class="ky ir">用<strong class="ky ir"> drop()删除</strong>行或列</strong></li></ul><p id="d644" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">其他基本功能是<strong class="ky ir"> read() </strong>和<strong class="ky ir"> write() </strong>操作，用于加载和保存数据帧。因为我们认为 Apache Spark API 是一致且强大的，所以我们将其直接映射到 Optimus，不做任何更改。</p><p id="1c21" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面是所有基本操作的示例:</p><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="4db7" class="nl lt iq nh b gy nm nn l no np">df = op.create.df(<br/>    [<br/>        ("names", "str", True),<br/>        ("height", "float", True),<br/>        ("function", "str", True),<br/>        ("rank", "int", True),<br/>    ],<br/>    [<br/>        ("bumbl#ebéé  ", 17.5, "Espionage", 7),<br/>        ("Optim'us", 28.0, "Leader", 10),<br/>        ("ironhide&amp;", 26.0, "Security", 7),<br/>    ]).show()</span><span id="f9c1" class="nl lt iq nh b gy nq nn l no np">df.rows.append(["Grimlock",80.0,"Commander",9])</span><span id="1330" class="nl lt iq nh b gy nq nn l no np">+------------+------+---------+----+<br/>|       names|height| function|rank|<br/>+------------+------+---------+----+<br/>|bumbl#ebéé  |  17.5|Espionage|   7|<br/>|    Optim'us|  28.0|   Leader|  10|<br/>|   ironhide&amp;|  26.0| Security|   7|<br/>+------------+------+---------+----+</span><span id="4bd7" class="nl lt iq nh b gy nq nn l no np">df.rows.append(["Grimlock",80.0,"Commander",9])\<br/>    .rows.select(df["rank"]&gt;7)\<br/>    .cols.select(["names","height","function"])\<br/>    .cols.apply_expr("height", df["height"]-1)\<br/>    .cols.drop("function")\<br/>.table()</span><span id="11f7" class="nl lt iq nh b gy nq nn l no np">+--------+------+<br/>|   names|height|<br/>+--------+------+<br/>|Optim'us|  27.0|<br/>|Grimlock|  79.0|<br/>+--------+------+</span></pre><h1 id="370f" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">列操作</h1><p id="5305" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">除了这个基本操作之外，我们还识别了列上的其他操作。这里的想法是一样的，创建一个简单和一致的方法来操作数据。所有手术的设计和命名都尽可能接近熊猫。此外，您可以轻松地对单个、多个或整个列数据集应用操作。</p><h2 id="4a8a" class="nl lt iq bd lu nr ns dn ly nt nu dp mc lf nv nw me lj nx ny mg ln nz oa mi ob bi translated">聚集</h2><p id="f5ae" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">让我们从聚合开始。我们扩展了 Apache Spark 操作，并创建了一种访问统计函数的简单方法。</p><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="187d" class="nl lt iq nh b gy nm nn l no np">print(df.cols.min("height"))<br/>print(df.cols.percentile(['height', 'rank'], [0.05, 0.25, 0.5, 0.75, 0.95]))<br/>print(df.cols.max("height"))<br/>print(df.cols.median(["height","rank"]))<br/>print(df.cols.range(["height","rank"]))<br/>print(df.cols.std(["height","rank"]))</span><span id="df7f" class="nl lt iq nh b gy nq nn l no np">17.5   <br/>{'height': {0.05: 17.5, 0.25: 17.5, 0.5: 26.0, 0.75: 28.0, 0.95: 28.0}, 'rank': {0.05: 7.0, 0.25: 7.0, 0.5: 7.0, 0.75: 10.0, 0.95: 10.0}}<br/>28.0<br/>{'height': 26.0, 'rank': 7.0}<br/>{'height': {'min': 17.5, 'max': 28.0}, 'rank': {'min': 7, 'max': 10}}<br/>{'height': {'stddev': 5.575242894559244}, 'rank': {'stddev': 1.7320508075688772}}</span></pre><h2 id="20b8" class="nl lt iq bd lu nr ns dn ly nt nu dp mc lf nv nw me lj nx ny mg ln nz oa mi ob bi translated">转换和链接</h2><p id="a5cc" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">有了擎天柱，你不仅可以链接擎天柱变形，还可以链接火花操作👏。让我们来看看这个:</p><p id="e7cf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">。行</strong>和。<strong class="ky ir"> cols </strong>可能会觉得有点冗长，但是看看你如何可以很容易地看到你的数据发生了什么，哪些列或行受到了影响，以及将要应用什么转换。</p><p id="6e95" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过链接，您可以利用 Spark 惰性评估的强大功能。链接转换，apache Spark 将通过 Catalyst 处理这个问题的更好的方法。</p><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="84c3" class="nl lt iq nh b gy nm nn l no np">df = df\<br/>    .rows.sort(["rank","height"])\<br/>    .cols.lower(["names","function"])\<br/>    .cols.remove_accents("names")\<br/>    .cols.remove_special_chars("names")\<br/>    .cols.trim("names").show()</span><span id="aa1c" class="nl lt iq nh b gy nq nn l no np">+---------+------+---------+----+<br/>|    names|height| function|rank|<br/>+---------+------+---------+----+<br/>|  optimus|  28.0|   leader|  10|<br/>| ironhide|  26.0| security|   7|<br/>|bumblebee|  17.5|espionage|   7|<br/>+---------+------+---------+----+</span></pre><h2 id="4716" class="nl lt iq bd lu nr ns dn ly nt nu dp mc lf nv nw me lj nx ny mg ln nz oa mi ob bi translated">嵌套操作</h2><p id="34f9" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">这是从多个列创建一个新列的操作*-&gt;1。<strong class="ky ir">(</strong>)可以压缩到<strong class="ky ir">字符串</strong>、<strong class="ky ir">数组</strong>或<strong class="ky ir">向量</strong>列。</p><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="2585" class="nl lt iq nh b gy nm nn l no np">df.cols.nest(["names", "function"], output_col = "new_col", shape ="string").show()</span><span id="b4d4" class="nl lt iq nh b gy nq nn l no np">+---------+------+---------+----+-------------------+<br/>|    names|height| function|rank|            new_col|<br/>+---------+------+---------+----+-------------------+<br/>|  optimus|  28.0|   leader|  10|     optimus leader|<br/>| ironhide|  26.0| security|   7|  ironhide security|<br/>|bumblebee|  17.5|espionage|   7|bumblebee espionage|<br/>+---------+------+---------+----+-------------------+</span></pre><h2 id="7b1e" class="nl lt iq bd lu nr ns dn ly nt nu dp mc lf nv nw me lj nx ny mg ln nz oa mi ob bi translated">非嵌套操作</h2><p id="1941" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">从单个列创建多个列的操作 1--&gt; *。<strong class="ky ir"> unnest() </strong>可以扩展<strong class="ky ir">字符串</strong>、<strong class="ky ir">数组</strong>和<strong class="ky ir">向量</strong>列。</p><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="950c" class="nl lt iq nh b gy nm nn l no np">df.cols.unnest("new_col", " ").cols.drop("new_col")</span><span id="ced9" class="nl lt iq nh b gy nq nn l no np">+---------+------+---------+----+---------+---------+<br/>|    names|height| function|rank|new_col_0|new_col_1|<br/>+---------+------+---------+----+---------+---------+<br/>|  optimus|  28.0|   leader|  10|  optimus|   leader|<br/>| ironhide|  26.0| security|   7| ironhide| security|<br/>|bumblebee|  17.5|espionage|   7|bumblebee|espionage|<br/>+---------+------+---------+----+---------+---------+</span></pre><h1 id="558e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">自定义转换</h1><p id="2b17" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">Spark 有多种多样的方式来转换数据:</p><ul class=""><li id="5606" class="mp mq iq ky b kz la lc ld lf mr lj ms ln mt lr mu mv mw mx bi translated">列表达式</li><li id="4ea1" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">南非民主统一战线(United Democratic Front)</li><li id="af07" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">熊猫 UDF</li><li id="9d5d" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">结构化查询语言</li><li id="bb70" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">RDD</li></ul><p id="e84f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里的问题是你必须学习如何处理每个 API 的细节。Optimus 有两个函数<strong class="ky ir"> apply() </strong>和<strong class="ky ir"> apply_expr() </strong>，在其中你可以实现函数(UDF 或熊猫 UDF)或列表达式。</p><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="6646" class="nl lt iq nh b gy nm nn l no np">from pyspark.sql import functions as F<br/>def func(value, args):<br/>    return value + 1</span><span id="fa0e" class="nl lt iq nh b gy nq nn l no np">df\<br/>    .cols.apply("height", func, "int")\<br/>    .cols.apply_expr("rank", F.col("rank")+1)\<br/>    .show()</span><span id="ea2b" class="nl lt iq nh b gy nq nn l no np">+---------+------+---------+----+<br/>|    names|height| function|rank|<br/>+---------+------+---------+----+<br/>|  optimus|    29|   leader|  11|<br/>| ironhide|    27| security|   8|<br/>|bumblebee|    18|espionage|   8|<br/>+---------+------+---------+----+</span></pre><p id="a06e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">列表达式是最快的，所以总是尝试将它们与<strong class="ky ir"> apply_expr() </strong>一起使用</p><p id="1993" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你需要更多的灵活性，你可以使用<strong class="ky ir"> apply() </strong>来转换你的数据。如果<em class="oc"> PyArrow </em>出现，apply() 将尝试使用熊猫 UDF，否则擎天柱将退回到标准的 UDF。</p><p id="61b9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">熊猫 UDF 比标准 UDF 快很多。检查下面的基准:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/3c5de2131733fddafd6b861962d7859b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-TPeFVcq1Mqq_fYi3YrV2w.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Pandas UDF Vs UDF</figcaption></figure><p id="4012" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如图表所示，Pandas UDFs 的性能比一次一行的 UDF 好得多，从 3 倍到 100 倍不等。<a class="ae kv" href="https://databricks.com/blog/2017/10/30/introducing-vectorized-udfs-for-pyspark.html" rel="noopener ugc nofollow" target="_blank">https://databricks . com/blog/2017/10/30/introducing-vectorized-UDFs-for-py spark . html</a></p><h2 id="ab71" class="nl lt iq bd lu nr ns dn ly nt nu dp mc lf nv nw me lj nx ny mg ln nz oa mi ob bi translated">抽象 UDF</h2><p id="1950" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">Optimus 提出了抽象 UDF 的概念，其中你可以使用列表达式、UDF 和熊猫 UDF，而不用担心下划线的实现。<strong class="ky ir">抽象 udf </strong>函数就是什么权力<strong class="ky ir"> apply() </strong>和<strong class="ky ir"> apply_expr()。</strong></p><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="e43a" class="nl lt iq nh b gy nm nn l no np">from optimus.functions import abstract_udf as audf<br/>def func(val, args):<br/>    return val&gt;8</span><span id="ace9" class="nl lt iq nh b gy nq nn l no np">df.rows.select(audf("rank", func, "bool")).show()</span><span id="d814" class="nl lt iq nh b gy nq nn l no np">+-------+------+--------+----+<br/>|  names|height|function|rank|<br/>+-------+------+--------+----+<br/>|optimus|  28.0|  leader|  10|<br/>+-------+------+--------+----+</span></pre><p id="72c8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以发挥想象力，使用一些论据:</p><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="c01b" class="nl lt iq nh b gy nm nn l no np">def func(val, args):<br/>    return val+args[0]+args[1]</span><span id="81cd" class="nl lt iq nh b gy nq nn l no np">df.withColumn("height", audf ("height", func, "int", [1,2])).show()</span><span id="e4c3" class="nl lt iq nh b gy nq nn l no np">+---------+------+---------+----+<br/>|    names|height| function|rank|<br/>+---------+------+---------+----+<br/>|  optimus|    31|   leader|  10|<br/>| ironhide|    29| security|   7|<br/>|bumblebee|    20|espionage|   7|<br/>+---------+------+---------+----+</span></pre><p id="64a3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">或者只使用列表达式</p><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="4e8d" class="nl lt iq nh b gy nm nn l no np">def func(col_name, args):<br/>    return F.col(col_name) + args</span><span id="eb07" class="nl lt iq nh b gy nq nn l no np">df.withColumn("height", audf ("height", func, "int", 2, "column_exp")).show()</span><span id="bd4b" class="nl lt iq nh b gy nq nn l no np">+---------+------+---------+----+<br/>|    names|height| function|rank|<br/>+---------+------+---------+----+<br/>|  optimus|  30.0|   leader|  10|<br/>| ironhide|  28.0| security|   7|<br/>|bumblebee|  19.5|espionage|   7|<br/>+---------+------+---------+----+</span></pre><p id="d538" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如你所看到的，可以将抽象 udf 与标准 Spark 函数一起使用。</p><h2 id="0652" class="nl lt iq bd lu nr ns dn ly nt nu dp mc lf nv nw me lj nx ny mg ln nz oa mi ob bi translated">结构化查询语言</h2><p id="b2a1" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">如果你觉得使用 SQL 很舒服，你可以通过<strong class="ky ir"> df.sql() </strong>轻松使用它。例如:</p><pre class="kg kh ki kj gt ng nh ni nj aw nk bi"><span id="4b78" class="nl lt iq nh b gy nm nn l no np">df.registerTempTable("autobots")<br/>df.sql("SELECT * FROM autobots").show()</span><span id="2bff" class="nl lt iq nh b gy nq nn l no np">+---------+------+---------+----+<br/>|    names|height| function|rank|<br/>+---------+------+---------+----+<br/>|  optimus|  28.0|   leader|  10|<br/>| ironhide|  26.0| security|   7|<br/>|bumblebee|  17.5|espionage|   7|<br/>+---------+------+---------+----+</span></pre><h1 id="ee72" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">目标 2:让用户轻松地从熊猫迁移</h1><p id="fd57" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">让我们再次回顾一下池图表:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/6efc7fcaf7122af44cd431993333a306.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oILvCwuoTt7NnjILL6vZtQ.png"/></div></div></figure><p id="ba04" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在总共 106 名投票者中，73%的人使用熊猫作为数据清理库。这给了我们一个很好的启示，告诉我们应该如何对待擎天柱。让擎天柱对熊猫尽可能友好。</p><blockquote class="oe"><p id="b3b4" class="of og iq bd oh oi oj ok ol om on lr dk translated">在总共 106 名投票者中，73%的人使用熊猫作为数据清理库。</p></blockquote><p id="40b1" class="pw-post-body-paragraph kw kx iq ky b kz oo jr lb lc op ju le lf oq lh li lj or ll lm ln os lp lq lr ij bi translated">考虑到这一点，我们搜索并找到了来自 riselab 的 Devin Petersohn 的惊人作品。他在 ka ggle(<a class="ae kv" href="https://rise.cs.berkeley.edu/blog/pandas-on-ray-early-lessons/" rel="noopener ugc nofollow" target="_blank">https://rise . cs . Berkeley . edu/blog/Pandas-on-ray-early-lessons/</a>)上发表了一篇关于更常用的 Pandas 方法的文章。我们用这个来增强和调整擎天柱。下面你可以找到这个功能，以及它与 Spark 和 Optimus 的比较。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ne nf l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Top 20 most used Pandas compared with Spark and Optimus</figcaption></figure><p id="7351" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">NI=未实施<br/> NA=未实施</p><p id="a241" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们实现了几乎所有可以应用于 Spark 的函数(暂时没有<strong class="ky ir"> get </strong>或者<strong class="ky ir"> subtract </strong>)。有些像<strong class="ky ir"> reset_index() </strong>是不可能的，因为 Spark 不处理索引。</p><p id="d076" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这一定够每个熊猫新人追上擎天柱了🙌</p><h1 id="a05b" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">让数据探索更容易</h1><p id="d27f" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">Optimus 有一个强大的内置数据分析器，除了所有的基本操作外，它还能给你一些独特的东西。您可以看到特定列中存在多少数据类型。</p><p id="2092" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，您有一百万行，颜色值为白色、黑色、红色和数百种其他颜色。你怎么能确定一百万行中没有“1”呢？此功能是一个额外的步骤，可以帮助您使您的数据处于完美的状态，以做您的 ML 和 DL 模型。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ot"><img src="../Images/7d6db6722b49db7cd8b24c97ccd68d28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LUKSjh9-Fp5BT6SgYlgUGw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Optimus Profiler</figcaption></figure><p id="ad37" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是我们想更进一步。虽然 Jupyter 笔记本是一个不可思议的数据转换和模型创建工具，但我们认为数据探索领域可以大大改进。工作区似乎永远不足以可视化你的东西，你有很多绘图选项，如 plotly，seaborn，matplotlib an a big 等，每个人都有不同的 API，你必须做很多工作才能使它们交互。</p><h2 id="fbc8" class="nl lt iq bd lu nr ns dn ly nt nu dp mc lf nv nw me lj nx ny mg ln nz oa mi ob bi translated">🚗大黄蜂 Alpha 卷展</h2><p id="66bc" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我们希望为用户提供探索数据的最佳工具。</p><p id="cc83" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Bumblebee 是一个使用 Vue.js 构建的 GUI，它与 Optimus 协同工作，并向您准确地展示您需要什么来决定如何转换您的数据。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ou nf l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Bumbleebee in action</figcaption></figure><p id="2eaf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此刻，邦布尔伯可以:</p><ul class=""><li id="2d8f" class="mp mq iq ky b kz la lc ld lf mr lj ms ln mt lr mu mv mw mx bi translated">使用交互式绘图浏览您的数据。</li><li id="d4e7" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">轻松检查丢失的数据。</li><li id="ac06" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">查看数据样本以检查数据结构。</li><li id="98e9" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">查看描述性和分位数分析。</li><li id="474a" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">查看直方图和频率表。</li><li id="c808" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">检测数字和分类列，并相应地为您提供额外的数据。</li></ul><p id="e9b1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">大黄蜂和擎天柱不是直接连在一起的。事实上，Bumblebee 可以与从 Pandas 到 dplyr(R)的任何数据处理库一起使用。如果你想从你最喜欢的库中创建一个“连接器”,你只需要用 bumblebee 格式写一个 JSON 文件。</p><p id="a7f2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">想了解更多关于大黄蜂的信息，请访问 Github <a class="ae kv" href="https://github.com/ironmussa/Bumblebee" rel="noopener ugc nofollow" target="_blank"> repo </a>。</p><h1 id="87e3" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">包裹</h1><p id="f950" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">我们希望 Optimus/Bumblebee 成为处理、探索和制作大数据模型的事实库。为此，我们需要您的反馈，所以我们将推出 Optimus v2 的测试版，为期几周，以听取您对我们所走道路的意见。</p><p id="4171" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您想投稿，请:</p><ul class=""><li id="abb6" class="mp mq iq ky b kz la lc ld lf mr lj ms ln mt lr mu mv mw mx bi translated"><a class="ae kv" href="https://github.com/ironmussa/Optimus" rel="noopener ugc nofollow" target="_blank">安装擎天柱</a>，玩一玩，跟我们说说你在 Gitter 上的经历。</li><li id="cdce" class="mp mq iq ky b kz my lc mz lf na lj nb ln nc lr mu mv mw mx bi translated">如果你对擎天柱对我们的回购有意见，请填写问题。</li></ul><p id="534d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，我们只是在探索擎天柱的表面功能。请访问 docs.hioptimus.com 的<a class="ae kv" href="http://docs.hioptimus.com/en/latest/" rel="noopener ugc nofollow" target="_blank">，访问我们的</a><a class="ae kv" href="https://www.hioptimus.com/" rel="noopener ugc nofollow" target="_blank">网站</a>或访问<a class="ae kv" href="https://github.com/ironmussa/Optimus/tree/master/examples" rel="noopener ugc nofollow" target="_blank">笔记本</a>示例，看看 Optimus 能为您的数据做些什么。</p></div></div>    
</body>
</html>