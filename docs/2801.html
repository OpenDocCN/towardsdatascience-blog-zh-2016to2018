<html>
<head>
<title>Hello World in TensorFlow</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">TensorFlow中的Hello World</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/hello-world-in-tensorflow-973e6c38e8ed?source=collection_archive---------6-----------------------#2018-03-06">https://towardsdatascience.com/hello-world-in-tensorflow-973e6c38e8ed?source=collection_archive---------6-----------------------#2018-03-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/a7bad4f73d7fb7683c620ca60eb15d6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zrzslINjY8-SRPkmn1BQrA.jpeg"/></div></div></figure><p id="25e0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">TensorFlow是Google开发的用于机器学习的开源软件库。它能够在所有Linux、Windows和MacOS平台的CPU和GPU上运行。Tensorflow可用于设计、实现和训练深度学习模型，这些模型的灵感来自大脑的结构和功能。</p><p id="35d6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这篇文章中，我将给出一个使用TensorFlow实现一个简单的神经网络的分步指南。著名的Iris flower数据集用于训练，然后将给定的花分类到正确的类型。</p><p id="785c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Iris数据集包含3种类型的花，如“Setosa”、“Versicolor”和“Virginica”。为了识别每种花的类型，给出了花的4个特性，即萼片长度、萼片宽度、花瓣长度和花瓣宽度。我们将使用这些因素实现一个神经网络来识别正确的类型。</p><p id="e585" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，我们将使用训练数据集来训练我们的模型，然后我们将使用测试数据集来测试它的准确性。你可以从<a class="ae kw" href="http://download.tensorflow.org/data/iris_training.csv" rel="noopener ugc nofollow" target="_blank">这里</a>下载训练数据集，从<a class="ae kw" href="http://download.tensorflow.org/data/iris_test.csv" rel="noopener ugc nofollow" target="_blank">这里</a>下载测试数据集。</p><p id="04d7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第一步</strong></p><p id="ea09" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，我们需要读入数据。csv文件并导入它们。熊猫图书馆可以用来轻松处理这一点。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi kx"><img src="../Images/7780310122914536a8cf7548b08c16ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1308/format:webp/1*F_Jq9YsTmg7cjCDimgMKUg.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk">Importing data</figcaption></figure><p id="6230" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Pandas中的read_csv()函数将读取文件并将内容加载到指定的变量中。作为函数的参数，我们需要指定文件的路径，names参数可用于指定每个文件的列名。</p><p id="9297" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第二步</strong></p><p id="73c5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在数据集中，每种类型的花被编码为0、1和2。我们需要使用一个热方法将它们编码为[1，0，0]、[0，1，0]和[0，0，1]。这将使得训练和优化网络变得容易，因为来自网络的输出也以一种热格式生成。</p><p id="0906" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后我们需要定义训练集的x，y和测试集的x，y</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi lg"><img src="../Images/03993e8334690a85db8f5b0450b2df1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1324/format:webp/1*hWm5FZXfXyE-saEU9Jc8sw.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk">Encoding classes and data separation</figcaption></figure><p id="d5b6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第三步</strong></p><p id="ce40" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后是定义输入(X)、输出(Y)的占位符以及定义网络的权重和偏差的时候了。这里我们有4列输入，因为数据集有4个特征和3列输出，以映射3种类型的花。占位符的形状应该满足这一点。此外，权重矩阵的形状必须是4x3，偏差必须是3的向量，以将输入映射到输出(无隐藏层)。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi lh"><img src="../Images/4b1258e39676ad2093b3d959c2808a88.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*yIJrLadIWKxGuCLJ0yM9pQ.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk">Defining weights, bias and placeholders</figcaption></figure><p id="8410" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第四步</strong></p><p id="234c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后，我们需要通过激活函数发送输出，这里我使用了tensorflow中可用的soft-max函数。为了训练模型，我们需要计算成本，即模型产生的输出中有多少误差。在这里，我们计算其均方误差。然后，我们可以使用AdamOptimizer来训练模型，从而降低成本。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi li"><img src="../Images/9f66d4fdaba5e18caea28f47bae72c46.png" data-original-src="https://miro.medium.com/v2/resize:fit:890/format:webp/1*eZKOJG3a8UYZWcEqB1I2lA.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk">Training tensor definition</figcaption></figure><p id="9171" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第五步</strong></p><p id="f5ea" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">经过训练以检查我们的模型有多准确后，我们需要将我们的模型预测与实际结果进行比较。然后我们可以通过计算我们得到了多少正确的结果来计算我们的模型的准确性。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/eb920c81ab0532ae2ad4b69e3546e3a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:986/format:webp/1*IiF0M2BISYOEgx6PG_pTgA.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk">Calculate accuracy</figcaption></figure><p id="1992" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里我们检查由我们的模型生成的输出是否等于实际结果(Y)。该模型将为每种类型的花计算一个值，该值可以被认为是每种类型的概率。我们选择最有可能的类型。<strong class="ka ir"> argmax </strong>函数将返回最大值的索引。请记住，结果是一个热格式，这种方法将很容易让我们检查正确性。</p><p id="fd31" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这之后，我们必须开始训练模型。在此之前，我们需要首先初始化所有的全局变量，而<strong class="ka ir">global _ variables _ initializer</strong>函数就是为此服务的。</p><p id="0651" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">第六步</strong></p><p id="1809" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在让我们训练我们的模型。每个张量执行都必须在tensorflow的一个会话中完成。因此，在培训之前，我们需要创建一个会话，在完成所有工作后，我们需要关闭该会话。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi lk"><img src="../Images/d058097d97327af7c1c7f9a895e474b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1356/format:webp/1*xlJ_LsJ-L21dW1kQN8IaJg.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk">Training model</figcaption></figure><p id="9ff5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">添加上述代码块是为了创建tensorflow会话，该代码块中的所有内容都将拥有该会话。此外，该代码块能够在一切完成时自动关闭会话。</p><p id="dfc5" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，执行变量初始化张量，然后训练模型1000次。当训练时，我们需要将训练数据集指定为X，将相应的结果指定为Y，因为训练张量期望它们执行。在这里，当传递Y时，我已经迭代并创建了一个新的数组，以确保它具有与我们上面定义的相同的形状。在每次迭代中，跟踪成本以绘制图表来查看实际的训练。</p><p id="767a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">最后一步</strong></p><p id="d97b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后，当训练过程结束时，绘制成本变化图，并通过测试数据集检验模型的准确性。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ll"><img src="../Images/888b26ae589ae822e6302ba609c018e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EUK9EdvXV_79azpJ2Y31tQ.png"/></div></div><figcaption class="lc ld gj gh gi le lf bd b be z dk">Plot graph and check accuracy</figcaption></figure><p id="30d9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">经过1000次训练迭代后，有可能获得<strong class="ka ir"> 96.67% </strong>的准确度，这确实令人印象深刻，成本变化图显示了通过降低每次迭代的成本，模型得到了显著发展。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div class="gh gi lm"><img src="../Images/4c80ea75a4a5a4859ea2efc89536ebe0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1236/format:webp/1*2BrOJkiCZqMfEihVnsCJJQ.png"/></div><figcaption class="lc ld gj gh gi le lf bd b be z dk">Cost reduction due to training</figcaption></figure><p id="9e47" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">以下是程序的完整代码</strong></p><figure class="ky kz la lb gt jr"><div class="bz fp l di"><div class="ln lo l"/></div></figure><p id="fb65" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这篇文章将有助于tensorflow的新手通过这个简单的例子理解它的概念，并将成为潜入海洋的开始。</p><p id="802e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">继续读</p><p id="417c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">干杯！</p></div></div>    
</body>
</html>