<html>
<head>
<title>Find Your Best Customers with Customer Segmentation in Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 Python 中的客户细分找到您的最佳客户</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/find-your-best-customers-with-customer-segmentation-in-python-61d602f9eee6?source=collection_archive---------1-----------------------#2017-10-13">https://towardsdatascience.com/find-your-best-customers-with-customer-segmentation-in-python-61d602f9eee6?source=collection_archive---------1-----------------------#2017-10-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/fec0940f6a78b782893257e999cee9de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gAb50bxp6ClLNapX8QNjeg.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo credit: Pixabay</figcaption></figure><h1 id="7b5f" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">概观</h1><p id="e635" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">当谈到找出谁是你最好的客户时，老 RFM 矩阵原则是最好的。RFM 代表近期、频率和货币。是一种利用过往购买行为<strong class="lc ir"> </strong>将客户分组的客户细分技术。</p><p id="7f16" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir"> RFM 分数计算</strong></p><p id="dc5a" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir">最近度(R): </strong>自上次购买后的天数<br/> <strong class="lc ir">频率(F): </strong>总购买次数<br/> <strong class="lc ir">货币价值(M): </strong>该客户的总消费金额</p><p id="4ac2" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">步骤 1:计算每个客户的 RFM 指标。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi md"><img src="../Images/83d4c713045ddff94092919d19145bec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1112/format:webp/1*uqIFE9igGhmxadB_dLz-WQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Source: Slideshare</figcaption></figure><p id="ed62" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">步骤 2:将段号添加到 RFM 表中。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/2688db7a8322ad6d75e3e3de53e3f212.png" data-original-src="https://miro.medium.com/v2/resize:fit:1032/format:webp/1*tfHBghAMkF_dUcaQa72tpQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Source: Slideshare</figcaption></figure><p id="7594" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">第三步:根据最佳客户的 RFM 得分(得分 111)进行排序。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/28d2264604727001a451f9cc942c1b15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1178/format:webp/1*MeXvFG4Ez0wStMDCXZyN-Q.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Source: Blast Analytics Marketing</figcaption></figure><p id="980c" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">由于 RFM 是基于用户活动数据，我们首先需要的是数据。</p><h1 id="bbf6" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">数据</h1><p id="7bed" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">我们将使用的数据集与我们进行<a class="ae mk" href="https://medium.com/towards-data-science/a-gentle-introduction-on-market-basket-analysis-association-rules-fa4b986a40ce" rel="noopener">购物篮分析</a> — <a class="ae mk" href="http://archive.ics.uci.edu/ml/datasets/online+retail" rel="noopener ugc nofollow" target="_blank">在线零售数据集</a>时的数据集相同，可以从<a class="ae mk" href="http://archive.ics.uci.edu/ml/datasets/online+retail" rel="noopener ugc nofollow" target="_blank"> UCI 机器学习库</a>下载。</p><pre class="me mf mg mh gt ml mm mn mo aw mp bi"><span id="55a6" class="mq kd iq mm b gy mr ms l mt mu">import pandas as pd<br/>import warnings<br/>warnings.filterwarnings('ignore')</span><span id="3edd" class="mq kd iq mm b gy mv ms l mt mu">df = pd.read_excel("Online_Retail.xlsx")<br/>df.head()<br/>df1 = df</span></pre><p id="4efe" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">该数据集包含一家总部位于英国的注册在线零售商在 2010 年 1 月 12 日和 2011 年 9 月 12 日之间发生的所有交易。</p><p id="c282" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">加载数据需要几分钟，所以我保留了一份备份。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/51e0ec9120f50d890301b0cb83361036.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pbqZaIHSBitAe2eMbQ8KTg.png"/></div></div></figure><p id="0ba1" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir">探索数据—验证和新变量</strong></p><ol class=""><li id="722c" class="mx my iq lc b ld ly lh lz ll mz lp na lt nb lx nc nd ne nf bi translated">重要列中缺少值；</li><li id="7b11" class="mx my iq lc b ld ng lh nh ll ni lp nj lt nk lx nc nd ne nf bi translated">每个国家的客户分布情况；</li><li id="a7ed" class="mx my iq lc b ld ng lh nh ll ni lp nj lt nk lx nc nd ne nf bi translated">单价和数量应该&gt; 0；</li><li id="e95c" class="mx my iq lc b ld ng lh nh ll ni lp nj lt nk lx nc nd ne nf bi translated">发票日期应为&lt; today.</li></ol><pre class="me mf mg mh gt ml mm mn mo aw mp bi"><span id="9c65" class="mq kd iq mm b gy mr ms l mt mu">df1.Country.nunique()</span></pre><p id="28a4" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir"> <em class="nl"> 38 </em> </strong></p><p id="fb7d" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">共有 38 个独特的国家，如下所示:</p><pre class="me mf mg mh gt ml mm mn mo aw mp bi"><span id="c8c5" class="mq kd iq mm b gy mr ms l mt mu">df1.Country.unique()</span></pre><p id="61fa" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir"> <em class="nl">数组(['英国'、'法国'、'澳大利亚'、'荷兰'、'德国'、<br/>、'挪威'、'爱尔兰'、'瑞士'、'西班牙'、'波兰'、'葡萄牙'、<br/>、'意大利'、'比利时'、'立陶宛'、'日本'、'冰岛'、【T28 '、'海峡群岛'、'丹麦'、'塞浦路斯'、'瑞典'、'奥地利'、【T29 '、'以色列'、'芬兰'、'巴林'、'希腊'、'香港'、'新加坡'、<br/>、'黎巴嫩'、'阿拉伯联合酋长国'、'沙特阿拉伯'、'捷克'、<br/>、'加拿大'、'未指明</em></strong></p><pre class="me mf mg mh gt ml mm mn mo aw mp bi"><span id="5c7f" class="mq kd iq mm b gy mr ms l mt mu">customer_country=df1[['Country','CustomerID']].drop_duplicates()</span><span id="df72" class="mq kd iq mm b gy mv ms l mt mu">customer_country.groupby(['Country'])['CustomerID'].aggregate('count').reset_index().sort_values('CustomerID', ascending=False)</span></pre><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/cb22384a23e563c8c5a29ed73bb5abb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:634/format:webp/1*bkswB0QEZaqB8ojCSKIRtg.png"/></div></figure><p id="eabe" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">数据中 90%以上的客户来自英国。一些研究表明，客户群因地理位置而异，因此这里我将数据仅限于英国。</p><pre class="me mf mg mh gt ml mm mn mo aw mp bi"><span id="75dd" class="mq kd iq mm b gy mr ms l mt mu">df1 = df1.loc[df1['Country'] == 'United Kingdom']</span></pre><p id="8c08" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">检查每列中是否有缺失值。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/c5e52f36909f83d1dcdef4c5023fccd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*4uWIA8cLqyoWpLdE44N40A.png"/></div></figure><p id="5053" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">CustomerID 列中缺少 133，600 个值，因为我们的分析是基于客户的，所以我们将删除这些缺少的值。</p><pre class="me mf mg mh gt ml mm mn mo aw mp bi"><span id="9dac" class="mq kd iq mm b gy mr ms l mt mu">df1 = df1[pd.notnull(df1['CustomerID'])]</span></pre><p id="d95e" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">检查单价和数量列中的最小值。</p><pre class="me mf mg mh gt ml mm mn mo aw mp bi"><span id="265a" class="mq kd iq mm b gy mr ms l mt mu">df1 = df1[pd.notnull(df1['CustomerID'])]</span></pre><p id="a47a" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir"> <em class="nl"> 0.0 </em> </strong></p><pre class="me mf mg mh gt ml mm mn mo aw mp bi"><span id="9fb0" class="mq kd iq mm b gy mr ms l mt mu">df1.Quantity.min()</span></pre><p id="4c2f" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir"> <em class="nl"> -80995 </em> </strong></p><p id="6075" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">删除数量列中的负值。</p><pre class="me mf mg mh gt ml mm mn mo aw mp bi"><span id="2389" class="mq kd iq mm b gy mr ms l mt mu">df1 = df1[(df1['Quantity']&gt;0)]<br/>df1.shape<br/>df1.info()</span></pre><p id="9177" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir"> <em class="nl"> (354345，8) </em> </strong></p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi no"><img src="../Images/991e33635d41290252beb656987864e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/1*4cL8zIMRaHwxV2OztqcviQ.png"/></div></figure><p id="6fdf" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">清理完数据后，我们现在处理 354，345 行和 8 列。</p><p id="a89a" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">检查每列的唯一值。</p><pre class="me mf mg mh gt ml mm mn mo aw mp bi"><span id="4caf" class="mq kd iq mm b gy mr ms l mt mu">def unique_counts(df1):<br/>   for i in df1.columns:<br/>       count = df1[i].nunique()<br/>       print(i, ": ", count)<br/>unique_counts(df1)</span></pre><p id="e327" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir"> <em class="nl">发票号:16649 <br/>库存代码:3645 <br/>描述:3844 <br/>数量:294 <br/>发票日期:15615 <br/>单价:403 <br/>客户 ID : 3921 <br/>国家:1</em>T22】</strong></p><p id="b1e6" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">为总价添加一列。</p><pre class="me mf mg mh gt ml mm mn mo aw mp bi"><span id="1faf" class="mq kd iq mm b gy mr ms l mt mu">df1['TotalPrice'] = df1['Quantity'] * df1['UnitPrice']</span></pre><p id="1ee2" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">找出数据中的第一个和最后一个订单日期。</p><pre class="me mf mg mh gt ml mm mn mo aw mp bi"><span id="3513" class="mq kd iq mm b gy mr ms l mt mu">df1['InvoiceDate'].min()</span></pre><p id="bd7d" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir"> <em class="nl">时间戳(' 2010–12–01 08:26:00))</em></strong></p><pre class="me mf mg mh gt ml mm mn mo aw mp bi"><span id="68c0" class="mq kd iq mm b gy mr ms l mt mu">df1['InvoiceDate'].max()</span></pre><p id="1214" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir"> <em class="nl">时间戳(' 2011–12–09 12:49:00 ')</em></strong></p><p id="b4ff" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">由于最近是针对某个时间点计算的，并且最后一个发票日期是 2011 年 12 月 9 日，因此我们将使用 2011 年 12 月 10 日来计算最近。</p><pre class="me mf mg mh gt ml mm mn mo aw mp bi"><span id="996d" class="mq kd iq mm b gy mr ms l mt mu">import datetime as dt<br/>NOW = dt.datetime(2011,12,10)</span><span id="59cb" class="mq kd iq mm b gy mv ms l mt mu">df1['InvoiceDate'] = pd.to_datetime(df1['InvoiceDate'])</span></pre><h1 id="730a" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">RFM 客户细分</h1><p id="6342" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">RFM 分割就是从这里开始的。</p><p id="7896" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir">创建一个 RFM 表</strong></p><pre class="me mf mg mh gt ml mm mn mo aw mp bi"><span id="0efe" class="mq kd iq mm b gy mr ms l mt mu">rfmTable = df1.groupby('CustomerID').agg({'InvoiceDate': lambda x: (NOW - x.max()).days, 'InvoiceNo': lambda x: len(x), 'TotalPrice': lambda x: x.sum()})</span><span id="a78b" class="mq kd iq mm b gy mv ms l mt mu">rfmTable['InvoiceDate'] = rfmTable['InvoiceDate'].astype(int)<br/>rfmTable.rename(columns={'InvoiceDate': 'recency', <br/>                         'InvoiceNo': 'frequency', <br/>                         'TotalPrice': 'monetary_value'}, inplace=True)</span></pre><p id="bff2" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir">计算每个客户的 RFM 指标</strong></p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi np"><img src="../Images/a03fd6b541c34459aa13078b9ea17b17.png" data-original-src="https://miro.medium.com/v2/resize:fit:958/format:webp/1*GOZBfNMjPGuANY2b22w-mA.png"/></div></figure><p id="66da" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">解释:</p><ul class=""><li id="b204" class="mx my iq lc b ld ly lh lz ll mz lp na lt nb lx nq nd ne nf bi translated">CustomerID 12346 的频率为 1，货币价值为 77，183.60 美元，最近时间为 325 天。</li><li id="ba40" class="mx my iq lc b ld ng lh nh ll ni lp nj lt nk lx nq nd ne nf bi translated">CustomerID 12747 的频率为 103，货币值为 4，196.01 美元，最近时间为 2 天</li></ul><p id="d77d" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">让我们检查一下第一个顾客的详细情况。</p><figure class="me mf mg mh gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nr"><img src="../Images/2f3457bf308ad35599c48a89af6347e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bUafekeXxfyWwRvE-OQehw.png"/></div></div></figure><p id="3b85" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">第一位顾客只购物过一次，购买了一件数量巨大的产品(74，215 件)。单价很低；也许清仓大甩卖。</p><p id="ff2e" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir">拆分指标</strong></p><p id="ad17" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">将指标分割成多个部分的最简单方法是使用四分位数。</p><ol class=""><li id="eaae" class="mx my iq lc b ld ly lh lz ll mz lp na lt nb lx nc nd ne nf bi translated">这给了我们详细分析的起点。</li><li id="16fc" class="mx my iq lc b ld ng lh nh ll ni lp nj lt nk lx nc nd ne nf bi translated">4 段易于理解和解释。</li></ol><pre class="me mf mg mh gt ml mm mn mo aw mp bi"><span id="14f3" class="mq kd iq mm b gy mr ms l mt mu">quantiles = rfmTable.quantile(q=[0.25,0.5,0.75])<br/>quantiles = quantiles.to_dict()</span></pre><p id="b4e7" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir">创建分段 RFM 表</strong></p><pre class="me mf mg mh gt ml mm mn mo aw mp bi"><span id="3231" class="mq kd iq mm b gy mr ms l mt mu">segmented_rfm = rfmTable</span></pre><p id="b121" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">最低的最近，最高的频率和金额是我们最好的客户。</p><pre class="me mf mg mh gt ml mm mn mo aw mp bi"><span id="e20a" class="mq kd iq mm b gy mr ms l mt mu">def RScore(x,p,d):<br/>    if x &lt;= d[p][0.25]:<br/>        return 1<br/>    elif x &lt;= d[p][0.50]:<br/>        return 2<br/>    elif x &lt;= d[p][0.75]: <br/>        return 3<br/>    else:<br/>        return 4<br/>    <br/>def FMScore(x,p,d):<br/>    if x &lt;= d[p][0.25]:<br/>        return 4<br/>    elif x &lt;= d[p][0.50]:<br/>        return 3<br/>    elif x &lt;= d[p][0.75]: <br/>        return 2<br/>    else:<br/>        return 1</span></pre><p id="528c" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir">向新创建的分段 RFM 表添加分段编号</strong></p><pre class="me mf mg mh gt ml mm mn mo aw mp bi"><span id="403f" class="mq kd iq mm b gy mr ms l mt mu">segmented_rfm['r_quartile'] = segmented_rfm['recency'].apply(RScore, args=('recency',quantiles,))<br/>segmented_rfm['f_quartile'] = segmented_rfm['frequency'].apply(FMScore, args=('frequency',quantiles,))<br/>segmented_rfm['m_quartile'] = segmented_rfm['monetary_value'].apply(FMScore, args=('monetary_value',quantiles,))</span><span id="8308" class="mq kd iq mm b gy mv ms l mt mu">segmented_rfm.head()</span></pre><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/7bbb471149ab33db12d22d295b2c3d66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1086/format:webp/1*g26xJnxOh-iIEkJafvqZfw.png"/></div></figure><p id="baa0" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">RFM 细分市场将客户群分割成一个难以想象的 3D 立方体。不过，我们可以整理一下。</p><p id="2e60" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir">添加一个新列来合并 RFM 得分:111 是我们之前确定的最高分。</strong></p><pre class="me mf mg mh gt ml mm mn mo aw mp bi"><span id="302a" class="mq kd iq mm b gy mr ms l mt mu">segmented_rfm['RFMScore'] = segmented_rfm.r_quartile.map(str) <br/>                            + segmented_rfm.f_quartile.map(str) <br/>                            + segmented_rfm.m_quartile.map(str)<br/>segmented_rfm.head()</span></pre><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/0d784d0e948b6c82f4c54d7617c0a951.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*1XuQNYb_FaNa-gl-BwY7ug.png"/></div></figure><p id="8e40" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">很明显，第一个客户根本不是我们的最佳客户。</p><p id="2647" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated"><strong class="lc ir">谁是我们的前 10 大最佳客户</strong>！</p><pre class="me mf mg mh gt ml mm mn mo aw mp bi"><span id="3374" class="mq kd iq mm b gy mr ms l mt mu">segmented_rfm[segmented_rfm['RFMScore']=='111'].sort_values('monetary_value', ascending=False).head(10)</span></pre><figure class="me mf mg mh gt jr gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/e01db2630629d579bbf5c10132425d4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1264/format:webp/1*QH7ijBZdeVHa6WJAepmKgg.png"/></div></figure><h1 id="c57b" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">了解更多信息</h1><p id="0377" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">有兴趣了解更多信息吗？</p><ol class=""><li id="8f2d" class="mx my iq lc b ld ly lh lz ll mz lp na lt nb lx nc nd ne nf bi translated"><a class="ae mk" href="http://www.kimberlycoffey.com/blog/2016/8/k-means-clustering-for-customer-segmentation" rel="noopener ugc nofollow" target="_blank"> Kimberly Coffey </a>有一个<a class="ae mk" href="http://www.kimberlycoffey.com/blog/2016/8/k-means-clustering-for-customer-segmentation" rel="noopener ugc nofollow" target="_blank">优秀的教程</a>关于同一个数据集使用 r。</li><li id="b536" class="mx my iq lc b ld ng lh nh ll ni lp nj lt nk lx nc nd ne nf bi translated">丹尼尔·麦卡锡和爱德华·沃兹沃斯的 R 包— <a class="ae mk" href="https://cran.r-project.org/web/packages/BTYD/vignettes/BTYD-walkthrough.pdf" rel="noopener ugc nofollow" target="_blank">买直到你死—一个演练</a>。</li><li id="f19c" class="mx my iq lc b ld ng lh nh ll ni lp nj lt nk lx nc nd ne nf bi translated"><a class="ae mk" href="http://blog.yhat.com/posts/customer-segmentation-using-python.html" rel="noopener ugc nofollow" target="_blank">来自 yhat 博客</a>的葡萄酒销售商的客户细分。</li></ol><p id="7a94" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">创建这个帖子的源代码可以在<a class="ae mk" href="https://github.com/susanli2016/Machine-Learning-with-Python/blob/master/Customer_Segmentation_Online_Retail.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>找到。我将很高兴收到关于上述任何反馈或问题。</p><p id="45ec" class="pw-post-body-paragraph la lb iq lc b ld ly lf lg lh lz lj lk ll ma ln lo lp mb lr ls lt mc lv lw lx ij bi translated">参考:<a class="ae mk" href="http://www.blastam.com/blog/rfm-analysis-boosts-sales" rel="noopener ugc nofollow" target="_blank">爆炸分析和营销</a></p></div></div>    
</body>
</html>