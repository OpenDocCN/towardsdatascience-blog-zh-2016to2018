<html>
<head>
<title>How to automatically segment customers using purchase data and a few lines of Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用购买数据和几行 Python 代码自动细分客户</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-automatically-segment-customers-using-purchase-data-and-a-few-lines-of-python-36939fb587a4?source=collection_archive---------9-----------------------#2018-09-29">https://towardsdatascience.com/how-to-automatically-segment-customers-using-purchase-data-and-a-few-lines-of-python-36939fb587a4?source=collection_archive---------9-----------------------#2018-09-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7c7d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">用简单的数据分析技术学习“客户细分”的小型教育项目</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/6702e66a7bc09e732e382613feb29bb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ocEjT9Hb8yudtqWqxlhzQw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Automatic Customer Segmentation using Recency/Monetary Matrix — Right: Photo by <a class="ae kv" href="https://unsplash.com/@michael75?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Michael</a> on <a class="ae kv" href="https://unsplash.com/s/photos/mountain?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="5455" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">您为什么应该关注客户细分？</strong>要向客户提供个性化体验，细分是关键。它可以洞察客户的行为、习惯和偏好，使您能够提供量身定制的营销活动，增加您的成功几率，并通过量身定制的内容改善客户体验。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/2b0ba533e1b6b07f4bec43ea774f9c13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AW-LW6i7BPBs4ED3hCCd8w.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Customer Segmentation</figcaption></figure><p id="0642" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">我们要建造什么？</strong>使用交易购买数据，我们将能够创建一个 2 x 2 价值矩阵来创建 4 个客户群。每一组都将根据两个维度来区分其他组:(1)当前客户价值，和(2)潜在客户价值。</p><p id="9703" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">我们要用什么技巧？</strong>我们将使用 RFM 模型从交易型采购数据中创建所需的功能。RFM 模式代表着:</p><ul class=""><li id="f8df" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated">最近:他们最后一次购买是什么时候？</li><li id="7fb0" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">频率:他们购买的频率和持续时间？</li><li id="374b" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated">货币价值/销售额:他们购买了多少？</li></ul><p id="f8bd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它通常用于在每三个问题的交叉点识别最高价值的客户。为了构建 2 x 2 矩阵，我们将只使用 RFM 的 R &amp;。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/73b2437c29e61f346699380ff18e5428.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*7JfiT-GBi4R501svnVrQFA.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">RFM Model</figcaption></figure><p id="1e9f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们使用的是什么数据？我们将使用 Tableau(也称为“全球超市”)提供的购买样本数据集。它通常用于预测和时间序列分析。它包含 1500 多个不同的客户和 4 年的购买数据。因为我们做的是行为细分，而不是人口统计细分，我们将通过只过滤 B2C 细分市场(消费者)和美国国家来消除一些潜在的人口统计偏见。</p><p id="e54c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">我们采取什么方法？</strong></p><ul class=""><li id="bfc4" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated"><strong class="ky ir">步骤 0: </strong>在客户级别加载、过滤、清理和聚合数据，</li><li id="dd18" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><strong class="ky ir">第一步:</strong>为每个客户创建 RFM 功能，</li><li id="15d6" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><strong class="ky ir">第 2 步:</strong>为了实现细分自动化，我们将使用 80%的分位数来表示近期和货币(我们也可以使用 k-mean 聚类或杠杆业务知识来创建存储桶，例如，全球超市企业用户将活跃客户视为最近订单不到 100 天的人)。</li><li id="c490" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><strong class="ky ir">第三步:</strong>计算 RM 评分，对客户进行排序，</li><li id="5969" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><strong class="ky ir">第四步:</strong>可视化价值矩阵，探究一些关键数字。</li></ul><p id="dc1f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">蟒蛇道:</strong></p><ul class=""><li id="c3af" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated"><strong class="ky ir">步骤 0: </strong>在客户级别加载、过滤、清理和聚集数据</li></ul><pre class="kg kh ki kj gt mh mi mj mk aw ml bi"><span id="4b31" class="mm mn iq mi b gy mo mp l mq mr">import matplotlib as plt<br/>import numpy as np<br/>%matplotlib inline  <br/>import warnings<br/>warnings.filterwarnings('ignore')<br/>import pandas as pd<br/>url = '<a class="ae kv" href="https://github.com/tristanga/Data-Analysis/raw/master/Global%20Superstore.xls'" rel="noopener ugc nofollow" target="_blank">https://github.com/tristanga/Data-Analysis/raw/master/Global%20Superstore.xls'</a><br/>df = pd.read_excel(url)<br/>df = df[(df.Segment == 'Consumer') &amp; (df.Country == 'United States')]<br/>df.head()</span></pre><ul class=""><li id="93a4" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated"><strong class="ky ir">步骤 1: </strong>为每个客户创建 RFM 功能</li></ul><pre class="kg kh ki kj gt mh mi mj mk aw ml bi"><span id="509e" class="mm mn iq mi b gy mo mp l mq mr">df_RFM = df.groupby('Customer ID').agg({'Order Date': lambda y: (df['Order Date'].max().date() - y.max().date()).days,<br/>                                        'Order ID': lambda y: len(y.unique()),  <br/>                                        'Sales': lambda y: round(y.sum(),2)})<br/>df_RFM.columns = ['Recency', 'Frequency', 'Monetary']<br/>df_RFM = df_RFM.sort_values('Monetary', ascending=False)<br/>df_RFM.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ms"><img src="../Images/10f36896f2f7f73c683b2226ce238e05.png" data-original-src="https://miro.medium.com/v2/resize:fit:590/format:webp/1*TqCBZt32v-jmJnPHSLci4w.png"/></div></figure><ul class=""><li id="13c1" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated"><strong class="ky ir">第 2 步:</strong>为了实现自动分割，我们将使用 80%的分位数来表示近期和货币</li></ul><pre class="kg kh ki kj gt mh mi mj mk aw ml bi"><span id="1234" class="mm mn iq mi b gy mo mp l mq mr"># We will use the 80% quantile for each feature<br/>quantiles = df_RFM.quantile(q=[0.8])<br/>print(quantiles)<br/>df_RFM['R']=np.where(df_RFM['Recency']&lt;=int(quantiles.Recency.values), 2, 1)<br/>df_RFM['F']=np.where(df_RFM['Frequency']&gt;=int(quantiles.Frequency.values), 2, 1)<br/>df_RFM['M']=np.where(df_RFM['Monetary']&gt;=int(quantiles.Monetary.values), 2, 1)<br/>df_RFM.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/eeed92b0796ae7e699fbb459bacf9105.png" data-original-src="https://miro.medium.com/v2/resize:fit:454/format:webp/1*MXjGscODA_WD8_42zOlENg.png"/></div></figure><ul class=""><li id="c553" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated"><strong class="ky ir">第三步:</strong>计算 RFM 分数，对客户进行排序</li></ul><pre class="kg kh ki kj gt mh mi mj mk aw ml bi"><span id="72f9" class="mm mn iq mi b gy mo mp l mq mr"># To do the 2 x 2 matrix we will only use Recency &amp; Monetary<br/>df_RFM['RMScore'] = df_RFM.M.map(str)+df_RFM.R.map(str)<br/>df_RFM = df_RFM.reset_index()<br/>df_RFM_SUM = df_RFM.groupby('RMScore').agg({'Customer ID': lambda y: len(y.unique()),<br/>                                        'Frequency': lambda y: round(y.mean(),0),<br/>                                        'Recency': lambda y: round(y.mean(),0),<br/>                                        'R': lambda y: round(y.mean(),0),<br/>                                        'M': lambda y: round(y.mean(),0),<br/>                                        'Monetary': lambda y: round(y.mean(),0)})<br/>df_RFM_SUM = df_RFM_SUM.sort_values('RMScore', ascending=False)<br/>df_RFM_SUM.head()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/40a14be49b0ee5807439b4b4aa01820c.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*6NRA2zfyQq5rbVWXs-z7Zg.png"/></div></figure><ul class=""><li id="c0ee" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated"><strong class="ky ir">第四步:</strong>形象化价值矩阵，探索一些关键数字</li></ul><pre class="kg kh ki kj gt mh mi mj mk aw ml bi"><span id="4a09" class="mm mn iq mi b gy mo mp l mq mr"># 1) Average Monetary Matrix<br/>df_RFM_M = df_RFM_SUM.pivot(index='M', columns='R', values='Monetary')<br/>df_RFM_M= df_RFM_M.reset_index().sort_values(['M'], ascending = False).set_index(['M'])<br/>df_RFM_M</span><span id="49fb" class="mm mn iq mi b gy mv mp l mq mr"># 2) Number of Customer Matrix<br/>df_RFM_C = df_RFM_SUM.pivot(index='M', columns='R', values='Customer ID')<br/>df_RFM_C= df_RFM_C.reset_index().sort_values(['M'], ascending = False).set_index(['M'])<br/>df_RFM_C</span><span id="595f" class="mm mn iq mi b gy mv mp l mq mr"># 3) Recency Matrix</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/94d522e9088986c9a7833b277ab0bd79.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/1*3VPCRFGYzxHmMBepRKqouQ.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/601783a22dfd59cd12d317706c66cb59.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zESqrQ1e6Tm5Uwu23PFtGA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Final Matrix</figcaption></figure><p id="7245" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">一些简单销售的外卖/速赢&amp;营销策略示例？</strong></p><ul class=""><li id="0e39" class="ls lt iq ky b kz la lc ld lf lu lj lv ln lw lr lx ly lz ma bi translated"><strong class="ky ir">处于“空闲”阶段的客户很少，他们的平均收入高于“明星”阶段</strong>。因为它们很少，所以应该很容易与业务合作，以了解在客户级别发生了什么。根据分析，可能会有一个简单的快速获胜方法:通过电话或会议重新激活他们中的一些人，希望他们回到“明星”行列(例如，参与的客户)。</li><li id="69f3" class="ls lt iq ky b kz mb lc mc lf md lj me ln mf lr lx ly lz ma bi translated"><strong class="ky ir">“轻量级”客户的平均最后订单时间非常长(超过 1 年，而“参与型”客户为 60-70 天)。</strong>利用优惠券发起简单的重新激活活动可能会带来一些新订单，并帮助其中一些客户转向“新”类别(例如，已参与的客户)。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mx"><img src="../Images/7bc0863ebae0088c6bf5446e1e5defef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*wZY7pxdnVgv-34v7gRQ9jw.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Simple Tactics Examples</figcaption></figure><p id="91c3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">该笔记本在<a class="ae kv" href="https://github.com/tristanga/Data-Analysis/blob/master/Notebooks/Automatic%20Customer%20Segmentation%20with%20RFM%20(Python).ipynb" rel="noopener ugc nofollow" target="_blank"> Github </a>上有售。感谢你阅读我的帖子，如果你喜欢，请鼓掌。如果您想在您的组织内进行简单或更复杂的 RFM 细分，请随时联系我。</p><p id="b127" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">通过 Python k-means 了解 RFM 更多信息的其他有趣读物:</p><div class="my mz gp gr na nb"><a href="http://www.kimberlycoffey.com/blog/2016/8/k-means-clustering-for-customer-segmentation" rel="noopener  ugc nofollow" target="_blank"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd ir gy z fp ng fr fs nh fu fw ip bi translated">用于客户细分的 k-均值聚类:一个实例</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">客户细分是一个听起来似乎很简单的概念。概括地说，目标是将客户分为…</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">www.kimberlycoffey.com</p></div></div><div class="nk l"><div class="nl l nm nn no nk np kp nb"/></div></div></a></div></div></div>    
</body>
</html>