<html>
<head>
<title>Evaluation Metrics for Recommender Systems</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">推荐系统的评价指标</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/evaluation-metrics-for-recommender-systems-df56c6611093?source=collection_archive---------0-----------------------#2018-11-23">https://towardsdatascience.com/evaluation-metrics-for-recommender-systems-df56c6611093?source=collection_archive---------0-----------------------#2018-11-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/8f6e86a41e7bf7c696b90a782190249e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*VmDDvBTscaJ2n6rx"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Photo by <a class="ae jd" href="https://unsplash.com/@rawpixel?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">rawpixel</a> on <a class="ae jd" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><div class=""/><p id="7d95" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">推荐系统在在线零售中越来越受欢迎，因为它们能够为独特的用户提供个性化的体验。K 处的平均精度(MAP@K)通常是用于评估推荐系统性能的选择度量。然而，使用额外的诊断指标和可视化可以对模型的性能提供更深入的、有时令人惊讶的见解。本文探讨了 K(MAR @ K)<em class="lb"/><em class="lb">个性化</em><em class="lb">列表内相似度</em>的平均召回率，并使用这些指标来比较三个简单的推荐系统。</p><p id="af35" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果您想使用本文中讨论的任何指标或图表，我已经在 python 库<a class="ae jd" href="https://github.com/statisticianinstilettos/recmetrics" rel="noopener ugc nofollow" target="_blank"> recmetrics </a>中提供了它们。</p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="3aaf" class="ll lm jg lh b gy ln lo l lp lq">$ pip install <!-- -->recmetrics</span></pre><h1 id="8e48" class="lr lm jg bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">Movielens 数据集</h1><p id="5b54" class="pw-post-body-paragraph kd ke jg kf b kg mo ki kj kk mp km kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated">本例中使用的数据是流行的<a class="ae jd" href="https://grouplens.org/datasets/movielens/20m/" rel="noopener ugc nofollow" target="_blank"> Movielens 20m </a>数据集。该数据包含用户对电影的评级，以及电影类型标签。(为了增加训练时间，对该数据进行了缩减采样，以仅包括来自对超过 1000 部电影进行评级的用户的评级，并且移除了少于 3 颗星的评级。)</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/e847f23733ab3a0b0b098fb2e9b6ab28.png" data-original-src="https://miro.medium.com/v2/resize:fit:632/format:webp/1*VT7yX-QQtnA-b4KMnxe5Uw.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Example of user movie ratings</figcaption></figure><h1 id="caff" class="lr lm jg bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">模型</h1><p id="e6ab" class="pw-post-body-paragraph kd ke jg kf b kg mo ki kj kk mp km kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated">测试和比较了三种不同的推荐系统。</p><ol class=""><li id="b37c" class="mu mv jg kf b kg kh kk kl ko mw ks mx kw my la mz na nb nc bi translated">随机推荐器(向每个用户随机推荐 10 部电影)</li><li id="77f6" class="mu mv jg kf b kg nd kk ne ko nf ks ng kw nh la mz na nb nc bi translated">受欢迎程度推荐器(向每个用户推荐 10 部最受欢迎的电影)</li><li id="1662" class="mu mv jg kf b kg nd kk ne ko nf ks ng kw nh la mz na nb nc bi translated">协同过滤(使用奇异值分解矩阵分解方法)</li></ol><p id="7895" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们深入研究指标和诊断图，并比较这些模型！</p><h1 id="630e" class="lr lm jg bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">长尾图</h1><p id="7815" class="pw-post-body-paragraph kd ke jg kf b kg mo ki kj kk mp km kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated">我喜欢通过查看<em class="lb">长尾理论</em>来开始每一个推荐项目。该图用于探索用户项目交互数据(如点击、评级或购买)中的流行模式。通常，只有一小部分项目具有高的交互量，这被称为“头部”。大多数项目都在“长尾”中，但它们只占交互的一小部分。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ni"><img src="../Images/5f6aea0613c00c2f2295feb677cd4bd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SIPN2FOu440_bhDvAkWdow.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Long tail plot. (Sample of Movielens 20m ratings data)</figcaption></figure><p id="60c7" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因为在训练数据中有许多流行项目的观察值，所以推荐系统学习准确预测这些项目并不困难。在电影数据集中，最受欢迎的电影是大片和经典。这些电影已经为大多数用户所熟知，对它们的推荐可能不会提供个性化的体验或帮助用户发现新的、相关的电影。相关推荐被定义为用户在测试数据中正面评价的项目的推荐。这里确定的指标提供了评估建议的相关性<em class="lb">和</em>有用性的方法。</p><h1 id="5cb1" class="lr lm jg bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">地图@K 和标记@K</h1><p id="41e4" class="pw-post-body-paragraph kd ke jg kf b kg mo ki kj kk mp km kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated">推荐系统通常为测试集中的每个用户产生一个有序的推荐列表。MAP@K 提供了对推荐项目列表的相关程度的洞察，而 MAR@K 提供了对推荐者能够回忆起用户在测试集中正面评价的所有项目的程度的洞察。我不会详细描述 MAP@K 和 MAR@K，因为在这里可以找到很好的描述:</p><div class="ip iq gp gr ir nj"><a href="http://sdsawtelle.github.io/blog/output/mean-average-precision-MAP-for-recommender-systems.html" rel="noopener  ugc nofollow" target="_blank"><div class="nk ab fo"><div class="nl ab nm cl cj nn"><h2 class="bd jh gy z fp no fr fs np fu fw jf bi translated">推荐系统的平均精度</h2><div class="nq l"><h3 class="bd b gy z fp no fr fs np fu fw dk translated">(好吧，这里有一个双关语。)既然你正在读这篇文章，你可能刚刚遇到了“平均精度”这个术语，或者…</h3></div><div class="nr l"><p class="bd b dl z fp no fr fs np fu fw dk translated">sdsawtelle.github.io</p></div></div><div class="ns l"><div class="nt l nu nv nw ns nx ix nj"/></div></div></a></div><p id="e3d6" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">MAP@K 在<a class="ae jd" href="https://github.com/benhamner/Metrics" rel="noopener ugc nofollow" target="_blank"> ml_metrics </a>库中可用，我已经让 MAR@K 在<a class="ae jd" href="https://github.com/statisticianinstilettos/recmetrics" rel="noopener ugc nofollow" target="_blank"> recmetrics </a>中可用。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi ny"><img src="../Images/90d5dbe13d7d37d13073e77655c1c578.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*szNmVeH2vaiORtvm4ZZdGA.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">By MAR@K, the collaborative filter is able to recall the relevant items for the user better than the other models.</figcaption></figure><h1 id="89b4" class="lr lm jg bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">新闻报道</h1><p id="0e2c" class="pw-post-body-paragraph kd ke jg kf b kg mo ki kj kk mp km kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated"><em class="lb">覆盖率</em>是模型能够在测试集上推荐的训练数据中的项目的百分比。在这个例子中，流行度推荐器只有 0.05%的覆盖率，因为它只推荐了 10 个项目。随机推荐器具有预期的接近 100%的覆盖率。令人惊讶的是，协作过滤器只能推荐 8.42%的经过训练的项目。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nz"><img src="../Images/685b23303385075c05deb1cd6b7fdb11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XFtaFeTMDbpuuEjqwQjH1w.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Coverage comparison for three recommender systems.</figcaption></figure><h1 id="8a3d" class="lr lm jg bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">个性化</h1><p id="1a5d" class="pw-post-body-paragraph kd ke jg kf b kg mo ki kj kk mp km kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated">个性化是评估一个模型是否向不同的用户推荐了许多相同的商品的好方法。它是用户推荐列表之间的相异度(1 余弦相似度)。一个例子将最好地说明个性化是如何计算的。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oa"><img src="../Images/5f7b931c2282bc3a0c4b95ed6499fa33.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dhRoTvKdph69JDoXdJ1QTg.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Example list of recommended items for 3 different users.</figcaption></figure><figure class="lc ld le lf gt is gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/335cc0a850ba4ef3c49a223f41bde5f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:692/format:webp/1*FwO0Fn3R4gOPl6Xic2C3jw.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">First, the recommended items for each user are represented as binary indicator variables (1: the item was recommended to the user. 0: the item was not recommended to the user).</figcaption></figure><figure class="lc ld le lf gt is gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/9420d92d649e38f80a581ec4af177184.png" data-original-src="https://miro.medium.com/v2/resize:fit:616/format:webp/1*v79uazbvN9ioWzpjioaZjw.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Then, the cosine similarity matrix is calculated across all user’s recommendation vectors.</figcaption></figure><figure class="lc ld le lf gt is gh gi paragraph-image"><div class="gh gi od"><img src="../Images/ad709454ef5741c341ca240792b4b59a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1064/format:webp/1*5cZ2NY-erzHJG_OCRihPsQ.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Finally, the average of the upper triangle of the cosine matrix is calculated. The personalization is 1-the average cosine similarity.</figcaption></figure><p id="3644" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">高个性化分数表明用户的推荐是不同的，这意味着该模型为每个用户提供了个性化的体验。</p><h1 id="32d1" class="lr lm jg bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">列表内相似性</h1><p id="a422" class="pw-post-body-paragraph kd ke jg kf b kg mo ki kj kk mp km kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated">列表内相似度是推荐列表中所有项目的平均余弦相似度。该计算使用推荐项目的特征(例如电影类型)来计算相似性。这个计算也最好用一个例子来说明。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi oe"><img src="../Images/02e8ea707bd53869f45a4cf4f2b4e571.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F4DMhu0PIoB0l9MKIus8dQ.png"/></div></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">Example recommendations of movie ids for 3 different users.</figcaption></figure><figure class="lc ld le lf gt is gh gi paragraph-image"><div class="gh gi of"><img src="../Images/ca3275c42a68209ac26eabf79f968697.png" data-original-src="https://miro.medium.com/v2/resize:fit:1024/format:webp/1*ktDTfqpvStT6l4dXMlG1NA.png"/></div><figcaption class="iz ja gj gh gi jb jc bd b be z dk">These movie genre features are used to calculate a cosine similarity between all the items recommended to a user. This matrix shows the features for all recommended movies for user 1.</figcaption></figure><p id="2955" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">可以为每个用户计算列表内相似性，并对测试集中的所有用户进行平均，以获得模型的列表内相似性的估计。</p><figure class="lc ld le lf gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi og"><img src="../Images/5d8bb93b77c8989c6b07e50cf60aace7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sg9ZpBBFpR0OJlmoVFnj4A.png"/></div></div></figure><p id="382c" class="pw-post-body-paragraph kd ke jg kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果推荐系统向单个用户推荐非常相似项目的列表(例如，用户只接收浪漫电影的推荐)，那么列表内的相似性将会很高。</p><h1 id="649f" class="lr lm jg bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">使用正确的训练数据</h1><p id="672c" class="pw-post-body-paragraph kd ke jg kf b kg mo ki kj kk mp km kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated">可以对训练数据做一些事情来快速改进推荐系统。</p><ol class=""><li id="1b70" class="mu mv jg kf b kg kh kk kl ko mw ks mx kw my la mz na nb nc bi translated">从培训数据中删除热门项目。(这适用于用户可以自己发现这些项目，并且可能不觉得这些建议有用的情况)。</li><li id="aaec" class="mu mv jg kf b kg nd kk ne ko nf ks ng kw nh la mz na nb nc bi translated">根据用户的价值(如平均交易价值)调整项目评级。这可以帮助模特学会推荐能带来忠诚或高价值顾客的商品。</li></ol><h1 id="a979" class="lr lm jg bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">结论</h1><p id="f7c6" class="pw-post-body-paragraph kd ke jg kf b kg mo ki kj kk mp km kn ko mq kq kr ks mr ku kv kw ms ky kz la ij bi translated">一个优秀的推荐系统会提供相关和有用的推荐。使用多个评估指标的组合，我们可以开始评估一个模型的性能，而不仅仅是相关性。如果您想使用这些指标和图表来评估您自己的推荐系统，请查看我的<a class="ae jd" href="https://github.com/statisticianinstilettos/recmetrics" rel="noopener ugc nofollow" target="_blank"> python 库</a>。有问题吗？请随意向<a class="ae jd" href="https://arize.com/community/" rel="noopener ugc nofollow" target="_blank">伸出手</a>放松！</p></div></div>    
</body>
</html>