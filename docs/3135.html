<html>
<head>
<title>Fraud Detection Under Extreme Class Imbalance</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">极端类别不平衡下的欺诈检测</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/fraud-detection-under-extreme-class-imbalance-c241854e60c?source=collection_archive---------3-----------------------#2018-04-12">https://towardsdatascience.com/fraud-detection-under-extreme-class-imbalance-c241854e60c?source=collection_archive---------3-----------------------#2018-04-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/008059b01dd9d38c24621a6ab973bd8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v8493OnMDLmt6IrRnWeqnA.png"/></div></div></figure><p id="52f8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">数据科学中的一个热门领域是欺诈分析。这可能包括信用卡/借记卡欺诈、反洗钱或网络安全。所有这些领域的一个共同点是阶级不平衡的程度。一般来说，交易总数中只有一小部分是真正的欺诈。以信用卡诈骗为例。在给定用户的1000次交易中，只有1次是真正的欺诈。这可能是因为客户的信用卡信息被盗，或者供应商的PoS设备受损。需要尽快抓住这个问题，以最大限度地减少对客户和供应商的经济损失。同时，我们需要注意假阳性。很自然，如果信用卡在没有发生实际欺诈的情况下被银行冻结，信用卡所有者会不高兴。在这篇博客中，我将介绍一些常用策略，用于揭露金融和网络不端行为，同时最大限度地减少假警报。</p><h1 id="68ab" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">无监督学习模型</h1><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/61372c997e33e5085488efe16cf7702f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KIWLBfmhwaXmxuCPrjxjAg.jpeg"/></div></div></figure><p id="352b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当交易记录没有被标记时，无监督学习模型是有用的。对于互联网流量数据来说尤其如此，因为没有明确的方法来判断特定的互联网交易本质上是否是恶意的。在这种情况下，异常检测是常见的。</p><h2 id="cc9d" class="ly kx iq bd ky lz ma dn lc mb mc dp lg kj md me lk kn mf mg lo kr mh mi ls mj bi translated">异常检测</h2><p id="432f" class="pw-post-body-paragraph jy jz iq ka b kb mk kd ke kf ml kh ki kj mm kl km kn mn kp kq kr mo kt ku kv ij bi translated">想象你在浏览互联网时有某种行为。你在浏览YouTube时传输了一定量的数据，通过脸书信使发送了一定量的数据。现在，让我们将它汇总到整个组织中。平均而言，端点将具有可预测的端口使用率。现在，假设其中一个端点碰巧使用某个端口(它通常从不使用)来访问服务器端口(该端口可能因发送恶意软件而被列入黑名单)。这可能是潜在的端口扫描，甚至是公司网络上的torrent使用。另一个例子可能是一个或多个端口的突然高使用率，这表明DDoS攻击。有很多无监督学习算法，从K-Means到高斯混合模型。</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div class="gh gi mp"><img src="../Images/158a0f792a6df8883fb3681212bbcf27.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*oLbGM94kT9wuSCXY9wZArA.png"/></div></figure><p id="2e26" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于时间序列数据，可以查看数据点的标准偏差来寻找异常值。时间序列中的某些异常值可能显示不同的模式，可以使用傅立叶变换或隐马尔可夫模型来检测。</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mq"><img src="../Images/d13903332fdaa47f1228ac9f872b5d15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e-XffrY5d3mTf-ZzVM6sgg.png"/></div></div></figure><p id="a753" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">更多细节，请查看我关于基于<a class="ae mr" rel="noopener" target="_blank" href="/clustering-based-unsupervised-learning-8d705298ae51">聚类的无监督学习</a>的博客。</p><h1 id="2883" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">监督学习模型</h1><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/94f7e435a57772dbb2f5dd92c11b280d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pY-mC4WVMunmnn5ui9s0Ng.jpeg"/></div></div></figure><p id="bf6b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">某些欺诈检测数据集带有标签。就拿信用卡诈骗来说吧。如果银行怀疑有欺诈行为，他们可以打电话给持卡人，检查卡是否真的被盗。该信息可以用作新模型构建的训练数据。正如我将在本节中介绍的那样，监督学习模型也有自己的一系列机遇和挑战。</p><h2 id="a0a7" class="ly kx iq bd ky lz ma dn lc mb mc dp lg kj md me lk kn mf mg lo kr mh mi ls mj bi translated">标签错误的数据</h2><p id="5f36" class="pw-post-body-paragraph jy jz iq ka b kb mk kd ke kf ml kh ki kj mm kl km kn mn kp kq kr mo kt ku kv ij bi translated">在欺诈检测问题中，数据集已经严重失衡。想象一下，除此之外还有贴错标签的数据？可惜现实世界没有Kaggle干净。你会得到极其杂乱的数据。我个人的一般策略是使用K-Means来可视化数据，以检查标记是否真的有意义。</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ms"><img src="../Images/733a19b9776f1211630ec7849851557e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BQosKd3FHZWsfKRF6pdVtQ.png"/></div></div></figure><p id="82b2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然而，这是非常主观的，将取决于用例。如果做得好，我们可以得到一个更可靠的数据集来训练我们的模型。不利的一面是，有目标泄露的可能。</p><h2 id="7001" class="ly kx iq bd ky lz ma dn lc mb mc dp lg kj md me lk kn mf mg lo kr mh mi ls mj bi translated">模型复杂性</h2><p id="e11e" class="pw-post-body-paragraph jy jz iq ka b kb mk kd ke kf ml kh ki kj mm kl km kn mn kp kq kr mo kt ku kv ij bi translated">自然，对于大多数欺诈检测用例，模型往往更复杂。考虑到所需的粒度和特性工程水平，简单的线性回归可能没有帮助。也就是说，人们需要意识到过度拟合他们的数据集。学习曲线通常有助于检查模型是否具有高偏差或高方差。</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/258d3311a39365ccfbb300772afcc0e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:970/format:webp/1*CFb_3aU73R9EZrfHfGV0kA.png"/></div></figure><p id="f92e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果模型是高度偏向的，那么就有可能研究更复杂的东西，比如决策树、随机森林甚至神经网络。通常，在金融机构中，通常使用系综模型。某些工程特征在单独的模型上工作得最好(通常是由于方差的巨大差异)。或者甚至将无监督学习模型与有监督模型结合使用(特别是当错误标签的可能性很大时)。</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mu"><img src="../Images/c2bebb24eead49d470eb3983fb7029aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cxdd6AsjU7Hzj-ax6Zv-tg.png"/></div></div></figure><p id="b2ca" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">关于学习曲线、集合模型和其他基础知识的复习，请查看我的<a class="ae mr" rel="noopener" target="_blank" href="/data-science-interview-guide-4ee9f5dc778">数据科学面试指南</a>。</p><h2 id="beca" class="ly kx iq bd ky lz ma dn lc mb mc dp lg kj md me lk kn mf mg lo kr mh mi ls mj bi translated">惩罚模型</h2><p id="a28d" class="pw-post-body-paragraph jy jz iq ka b kb mk kd ke kf ml kh ki kj mm kl km kn mn kp kq kr mo kt ku kv ij bi translated">你可以使用相同的算法，但给他们一个不同的角度来看问题。惩罚分类对模型施加了额外的成本，用于在训练期间对少数类进行分类错误。这些惩罚会使模型偏向于更多地关注少数群体。通常，类别惩罚或权重的处理专用于学习算法。有惩罚版本的算法，如惩罚SVM和惩罚LDA。</p><h1 id="5a92" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">性能指标</h1><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/c80ba35cc27f765bc2e968e3a5f1278a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yOjdqV61gJ8Xrd8uxCZyMw.png"/></div></div></figure><p id="0dd0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">评估模型性能最常用的方法是分类得分。然而，当只有2%的数据集属于一个类别(欺诈)，而98%属于其他类别(非欺诈)时，错误分类分数实际上没有意义。你可以达到98%的准确率，但仍然没有发现任何欺诈行为。此外，请记住，在处理欺诈时，我们关心误报。在这一部分，我将讨论一些可供选择的性能指标。</p><h2 id="214e" class="ly kx iq bd ky lz ma dn lc mb mc dp lg kj md me lk kn mf mg lo kr mh mi ls mj bi translated">混淆矩阵</h2><p id="b237" class="pw-post-body-paragraph jy jz iq ka b kb mk kd ke kf ml kh ki kj mm kl km kn mn kp kq kr mo kt ku kv ij bi translated">在分析误分类时，混淆矩阵是一种常见的偏好。矩阵的每一行代表预测类中的实例，而每一列代表实际类中的实例</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/447ad8ab7874e239844e63c6f84e2bfa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*gLrUFxK3E3ltmDy4OX9PFQ.png"/></div></figure><p id="92af" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对角线代表已被正确分类的类别。这很有帮助，因为我们不仅知道哪些类被错误分类，还知道它们被错误分类为什么。</p><h2 id="cfba" class="ly kx iq bd ky lz ma dn lc mb mc dp lg kj md me lk kn mf mg lo kr mh mi ls mj bi translated">精确度、召回率和F1分数</h2><p id="01c3" class="pw-post-body-paragraph jy jz iq ka b kb mk kd ke kf ml kh ki kj mm kl km kn mn kp kq kr mo kt ku kv ij bi translated">为了更好地了解错误分类，我们经常使用以下指标来更好地了解真阳性(TP)、真阴性(TN)、假阳性(FP)和假阴性(FN)。</p><p id="0655" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">精度</strong>是正确预测的正观测值与总预测正观测值之比。</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/612d72bc2c6ced81c4990aab4a94974c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fY7UgscD6dUavqT7P5ZKCg.png"/></div></div></figure><p id="7094" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">回忆</strong>是正确预测的正面观察值与实际类中所有观察值的比率。</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mx"><img src="../Images/d1e1edf71d9e50536de6d3ce9ff1426a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pJsRlL6QLTLTHdegtUPdkg.png"/></div></div></figure><p id="8d52" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> F1-Score </strong>是准确率和召回率的加权平均值。</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div class="gh gi my"><img src="../Images/b8de866399e316f37f2969517d88fec8.png" data-original-src="https://miro.medium.com/v2/resize:fit:750/format:webp/1*D16HfhYgqPL0ex7BZz_Qqw.png"/></div></figure><p id="6963" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">F1分数越高，模型越好。对于所有三个指标，0是最差的，而1是最好的。</p><h2 id="bf97" class="ly kx iq bd ky lz ma dn lc mb mc dp lg kj md me lk kn mf mg lo kr mh mi ls mj bi translated">ROC曲线</h2><p id="9c57" class="pw-post-body-paragraph jy jz iq ka b kb mk kd ke kf ml kh ki kj mm kl km kn mn kp kq kr mo kt ku kv ij bi translated">接收器操作特性或ROC曲线是欺诈分析(以及数字信号处理)领域中非常流行的指标。</p><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mz"><img src="../Images/b886517a46f849ab71a5303f7263580b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RsR3YZmL-c2x7WZggOLrhA.png"/></div></div></figure><p id="e145" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">45度线是随机线，其中曲线下面积或AUC是0.5。曲线离这条线越远，AUC越高，模型越好。一个模型能得到的最高AUC是1，其中曲线形成一个直角三角形。ROC曲线也可以帮助调试模型。例如，如果曲线的左下角更接近随机线，则暗示模型在Y=0处分类错误。然而，如果右上角是随机的，则意味着误差发生在Y=1处。此外，如果曲线上有尖峰(而不是平滑的)，这意味着模型不稳定。对付诈骗模特，ROC是你最好的朋友。更多信息，请阅读<a class="ae mr" rel="noopener" target="_blank" href="/receiver-operating-characteristic-curves-demystified-in-python-bd531a4364d0">接收器工作特性曲线解密(Python语言)</a>。</p><h1 id="7bab" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">重新取样</h1><figure class="lu lv lw lx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/df9803dbab3485d393159ca23786b2ec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SUOfSQ4gIB19_wn83WKopg.jpeg"/></div></div></figure><p id="77ef" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我的最后一个建议是重新采样。如果有可能获得更多的数据来使这些类更加平衡，这将是最简单和最好的方法。如果没有，创建合成数据也是一种可能。本节将介绍这些方法。</p><h2 id="a4fa" class="ly kx iq bd ky lz ma dn lc mb mc dp lg kj md me lk kn mf mg lo kr mh mi ls mj bi translated">过采样</h2><p id="e260" class="pw-post-body-paragraph jy jz iq ka b kb mk kd ke kf ml kh ki kj mm kl km kn mn kp kq kr mo kt ku kv ij bi translated">对模型中的欺诈记录进行过采样有助于改进分类。但是，要意识到它需要代表真实世界(相对于非欺诈，欺诈实际上很少发生)。SMOTE和ADASYN是这方面的常用算法。自动编码器也可用于创建合成欺诈数据。</p><h2 id="6ae9" class="ly kx iq bd ky lz ma dn lc mb mc dp lg kj md me lk kn mf mg lo kr mh mi ls mj bi translated">欠采样</h2><p id="1857" class="pw-post-body-paragraph jy jz iq ka b kb mk kd ke kf ml kh ki kj mm kl km kn mn kp kq kr mo kt ku kv ij bi translated">欠采样非欺诈是另一种被使用的技术。基于聚类方法(例如K-Means)生成质心是一种常见的策略。</p><h1 id="b1e8" class="kw kx iq bd ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt bi translated">结束语</h1><p id="b67b" class="pw-post-body-paragraph jy jz iq ka b kb mk kd ke kf ml kh ki kj mm kl km kn mn kp kq kr mo kt ku kv ij bi translated">理想情况下，我在这篇博客中提到的内容将帮助你想出更好的方法来应对欺诈模型(无论是工作、学校还是Kaggle竞赛)。我提到的许多事情可以在我的其他博客中找到更多细节:</p><div class="na nb gp gr nc nd"><a rel="noopener follow" target="_blank" href="/data-science-interview-guide-4ee9f5dc778"><div class="ne ab fo"><div class="nf ab ng cl cj nh"><h2 class="bd ir gy z fp ni fr fs nj fu fw ip bi translated">数据科学面试指南</h2><div class="nk l"><h3 class="bd b gy z fp ni fr fs nj fu fw dk translated">数据科学是一个相当大且多样化的领域。因此，做一个万事通真的很难…</h3></div><div class="nl l"><p class="bd b dl z fp ni fr fs nj fu fw dk translated">towardsdatascience.com</p></div></div><div class="nm l"><div class="nn l no np nq nm nr jw nd"/></div></div></a></div><div class="na nb gp gr nc nd"><a rel="noopener follow" target="_blank" href="/clustering-based-unsupervised-learning-8d705298ae51"><div class="ne ab fo"><div class="nf ab ng cl cj nh"><h2 class="bd ir gy z fp ni fr fs nj fu fw ip bi translated">基于聚类的无监督学习</h2><div class="nk l"><h3 class="bd b gy z fp ni fr fs nj fu fw dk translated">无监督机器学习是一种机器学习任务，它从神经网络中推断出一个描述隐藏结构的函数</h3></div><div class="nl l"><p class="bd b dl z fp ni fr fs nj fu fw dk translated">towardsdatascience.com</p></div></div><div class="nm l"><div class="ns l no np nq nm nr jw nd"/></div></div></a></div><div class="na nb gp gr nc nd"><a href="https://medium.com/@sadatnazrul/study-of-decision-trees-and-ensembles-on-scikit-learn-e713a8e532b8" rel="noopener follow" target="_blank"><div class="ne ab fo"><div class="nf ab ng cl cj nh"><h2 class="bd ir gy z fp ni fr fs nj fu fw ip bi translated">Scikit-Learn上决策树和集成的研究</h2><div class="nk l"><h3 class="bd b gy z fp ni fr fs nj fu fw dk translated">现在科技界最热门的话题之一是机器学习领域。应用范围从…</h3></div><div class="nl l"><p class="bd b dl z fp ni fr fs nj fu fw dk translated">medium.com</p></div></div><div class="nm l"><div class="nt l no np nq nm nr jw nd"/></div></div></a></div></div></div>    
</body>
</html>