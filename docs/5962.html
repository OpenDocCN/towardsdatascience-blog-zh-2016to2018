<html>
<head>
<title>How to plot seismic activity with Anaconda and Jupyter Notebooks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用 Anaconda 和 Jupyter 笔记本绘制地震活动图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-plot-seismic-activity-with-anaconda-and-jupyter-notebooks-7ed23ce9aa5?source=collection_archive---------8-----------------------#2018-11-18">https://towardsdatascience.com/how-to-plot-seismic-activity-with-anaconda-and-jupyter-notebooks-7ed23ce9aa5?source=collection_archive---------8-----------------------#2018-11-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/d7193017e76d9849b1bb18a1d0927bc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ColUSq5DgIpL83TYa958AQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Demo of our end product</figcaption></figure><p id="2f1d" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">在这个活动中，我们将使用 Anaconda 作为我们的分发平台。要开始使用 Anaconda，从<a class="ae la" href="https://www.anaconda.com/download/" rel="noopener ugc nofollow" target="_blank"> Anaconda </a>下载发行版，根据您的操作系统说明进行安装，通过单击左下角的 create 按钮创建一个新环境，然后搜索、选择并安装以下包[matplotlib、basemap、pillow、pandas]</p><p id="a282" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">接下来，转到 Anaconda Navigator 的主页，确保左上角的下拉菜单选择了您新创建的环境，并安装 Jupyter Notebook。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lb"><img src="../Images/e3e548fce4656c7e901c8b2329c41328.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9j03jbQFuWYV-rZESJKXaQ.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Homepage of your selected environment</figcaption></figure><p id="f275" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果您已经安装了 Anaconda，请确保您已将 Matplotlib 更新到版本 3.0.2，或降级到版本 3.0.0，3.0.1 在使用设置属性时引入了底图错误。plot()，我们稍后会用到它。参考 github 问题<a class="ae la" href="https://github.com/matplotlib/basemap/issues/435" rel="noopener ugc nofollow" target="_blank">这里</a>了解更多信息。如果你不确定如何更新 conda 和它的包，请看这个堆栈溢出<a class="ae la" href="https://stackoverflow.com/questions/45197777/how-do-i-update-anaconda" rel="noopener ugc nofollow" target="_blank">帖子</a>，尽管如果在阅读时发行版没有更新，你可能不得不求助于 pip。(截至 2018 年 11 月 17 日尚未发布)</p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="9876" class="ll lm iq lh b gy ln lo l lp lq"># open your environment with cmd prompt/shell<br/>pip install matplotlib --upgrade</span><span id="1438" class="ll lm iq lh b gy lr lo l lp lq"># conda version will still display what it's distro is set to<br/># feel free to check your version <br/>import matplotlib<br/>print(matplotlib.__version__)</span></pre><p id="6d90" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">很好，现在在左侧菜单中选择“环境”,您会在新创建的环境中看到一个图标，您会看到几个选项，您想要的是“用 Jupyter 笔记本打开”</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/85b9bb7425adefdbe58b0b63423ce248.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/format:webp/1*oX64tDHEIdV1BYa0nSRGrQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Menu for launching environment</figcaption></figure><p id="c391" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">继续运行它，一个新的窗口将在你的默认浏览器中打开，列出你的根目录。浏览您的文件夹，选择一个位置来存储您的 Jupyter 笔记本，然后单击文件夹上方菜单上的“新建”按钮创建一个新笔记本。如果您正确地遵循了说明，您应该会看到类似这样的内容。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lt"><img src="../Images/fa8a39bf677b9d0007c7934fd309ac8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rbD_CyRGjd7E7NP9Ut9iZw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Newly created notebook</figcaption></figure><p id="e202" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">太棒了，你已经做了你的第一个笔记本。现在我们可以开始玩了！请打开笔记本。你将得到一个交互式 shell，如果你不熟悉的话，我鼓励你使用 Jupyter Notebook 来阅读<a class="ae la" href="https://www.dataquest.io/blog/jupyter-notebook-tutorial/" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="ec43" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">首先，我们将创建一个基本的彩色正交地图。有关所有支持的投影列表，请参见此处的<a class="ae la" href="https://matplotlib.org/basemap/users/mapsetup.html" rel="noopener ugc nofollow" target="_blank"/>。</p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="cf45" class="ll lm iq lh b gy ln lo l lp lq"># import dependencies<br/># note that Basemap will be supported until 2020 only<br/>from mpl_toolkits.basemap import Basemap<br/>import matplotlib.pyplot as plt<br/>import numpy as np</span><span id="181a" class="ll lm iq lh b gy lr lo l lp lq"># make sure to set your plot size before you start rendering to screen<br/>plt.figure(figsize=(8, 8))</span><span id="adb7" class="ll lm iq lh b gy lr lo l lp lq"># by default, only crude and low resolutions are installed, if you wanted<br/># higher fidelity images, refer to the documentation.</span><span id="4d25" class="ll lm iq lh b gy lr lo l lp lq">default_map = Basemap(projection='ortho', lat_0=45, lon_0=-105,<br/>                     resolution='l', area_thresh=1000.0)</span><span id="7b9f" class="ll lm iq lh b gy lr lo l lp lq">default_map.drawcoastlines()<br/>default_map.drawcountries() <br/># matplotlib provides color creation <br/>default_map.fillcontinents(color='navajowhite')<br/>default_map.drawmapboundary()</span><span id="0812" class="ll lm iq lh b gy lr lo l lp lq">plt.show()</span></pre><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/ffd60e4d9cf654401931c5d9ceb40e24.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*rJY1P2FBYTFy1XB6KDf8Ew.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Default Map</figcaption></figure><p id="cedb" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">接下来，让我们通过在 plt.show()前添加以下代码来添加经纬线</p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="3233" class="ll lm iq lh b gy ln lo l lp lq">default_map.drawmeridians(np.arange(0, 360, 30))<br/>default_map.drawparallels(np.arange(-90, 90, 30))</span></pre><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lu"><img src="../Images/8b1946ea60b5681734ca9e45944f747b.png" data-original-src="https://miro.medium.com/v2/resize:fit:912/format:webp/1*uOTiVTHyypOLCAkrlxxajw.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Longitude and Latitude added</figcaption></figure><p id="c186" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这开始看起来挺帅的！可悲的是，尽管它很漂亮，但它可能不是观察全球地震活动的最佳预测。我鼓励你在这一点上玩投影，看看你喜欢哪一个！至于我自己，我选择了锤子投影，并根据自己的喜好调整了纬度/经度值。</p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="90b5" class="ll lm iq lh b gy ln lo l lp lq"># change to hammer projection, fix lat/long<br/># import dependencies<br/># note that Basemap will be supported until 2020 only<br/>from mpl_toolkits.basemap import Basemap<br/>import matplotlib.pyplot as plt<br/>import numpy as np</span><span id="3e8a" class="ll lm iq lh b gy lr lo l lp lq"># make sure to set your plot size before you start rendering to screen<br/>plt.figure(figsize=(18, 18))</span><span id="b9fa" class="ll lm iq lh b gy lr lo l lp lq"># by default, only crude and low resolutions are installed, if you wanted<br/># higher fidelity images, refer to the documentation.</span><span id="33dd" class="ll lm iq lh b gy lr lo l lp lq">default_map = Basemap(projection='hammer', lat_0=0, lon_0=-100,<br/>                     resolution='l', area_thresh=1000.0)</span><span id="286a" class="ll lm iq lh b gy lr lo l lp lq">default_map.drawcoastlines()<br/>default_map.drawcountries() <br/># matplotlib provides color creation <br/>default_map.fillcontinents(color='navajowhite')<br/>default_map.drawmapboundary()</span><span id="142a" class="ll lm iq lh b gy lr lo l lp lq">default_map.drawmeridians(np.arange(0, 360, 30))<br/>default_map.drawparallels(np.arange(-90, 90, 30))</span><span id="3af9" class="ll lm iq lh b gy lr lo l lp lq">plt.show()</span></pre><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lv"><img src="../Images/7a3514a0912d9809e07f11ea4fe7bf03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MHjMjLp_Gfs_dO6NtNF6Zg.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Hammer projection with longitude/latitude lines</figcaption></figure><p id="0f6f" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我知道你现在在想什么！"看，妈妈，从这里我能看见我的房子."那么，我们为什么不试着放大我们自己的地理区域，仔细看看。最简单的方法是将您的投影类型更改为“墨卡托投影”，它支持缩放。我在网上查找我的经度，纬度坐标，并向外调整以获得更清晰的图像。如果您希望放大后的地图具有更高的分辨率，也可以安装 Anaconda 的 basemap-data-hires。</p><p id="f3ec" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">对于下一步，我大胆地将 merc 投影仪放入一个接受两个整数的函数中，以创建一个区域地图生成器。现在，如果您超出纬度/经度限制，可能会出现一些问题，但是您可以轻松地调整输入来解决这个问题。这是没有异常处理的快速而肮脏的代码。</p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="7bb3" class="ll lm iq lh b gy ln lo l lp lq"># what if we want to look at a specific area of the world?</span><span id="ad9a" class="ll lm iq lh b gy lr lo l lp lq">from mpl_toolkits.basemap import Basemap<br/>import matplotlib.pyplot as plt<br/>import numpy as np</span><span id="9e64" class="ll lm iq lh b gy lr lo l lp lq">def create_merc(lat, long):<br/>    <br/>    plt.figure(figsize=(10, 10))</span><span id="c9d0" class="ll lm iq lh b gy lr lo l lp lq"># make sure the value of resolution is a lowercase L,<br/>    #  for 'low', not a numeral 1<br/>    my_map = Basemap(projection='merc', lat_0=(lat-20), lon_0=(long+15),<br/>        resolution = 'h', area_thresh = .1,<br/>        # lower left hand corner longitude, lat<br/>        # upper right hand corner long, lat<br/>        llcrnrlon=(long-10), llcrnrlat=(lat-10),<br/>        urcrnrlon=(long+10), urcrnrlat=(lat+10))</span><span id="75e5" class="ll lm iq lh b gy lr lo l lp lq">my_map.drawcoastlines()<br/>    my_map.drawcountries()<br/>    my_map.fillcontinents(color='navajowhite', lake_color='paleturquoise')<br/>    my_map.drawmapboundary()</span><span id="17a4" class="ll lm iq lh b gy lr lo l lp lq">my_map.drawmeridians(np.arange(0, 360, 30))<br/>    my_map.drawparallels(np.arange(-90, 90, 30))</span><span id="0163" class="ll lm iq lh b gy lr lo l lp lq">plt.show()</span><span id="f09b" class="ll lm iq lh b gy lr lo l lp lq">create_merc(39, -76)</span></pre><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/1e871edf0dc44e1f2da8abd1965a83b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*T1ejhnTqO7iwZmOdk5G7GQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">You might recognize these iconic US lakes.</figcaption></figure><p id="9ca1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">哇哦。我们能不能感谢这些库所付出的努力，让我们在几个小时内通读文档就能做出这样的东西？(不可否认，我花了更多的时间来克服一些错误)</p><p id="d1d1" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">好吧，继续！让我们试着画出具体的坐标。比如我现在住的地方。</p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="1fea" class="ll lm iq lh b gy ln lo l lp lq"># plot the initial coordinate input<br/>x, y = merc_map(long, lat)<br/>merc_map.plot(x, y, 'go', markersize=12)</span><span id="b39c" class="ll lm iq lh b gy lr lo l lp lq">plt.show()</span></pre><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/ecd65b88c3af5ddc7b24bfd5ce61686f.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/format:webp/1*54Tqg07b0EGiJf3vHKnJdA.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">A nice big green dot</figcaption></figure><p id="5de9" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">好的，我们已经证明了我们可以绘制图形。但是我们可能需要多个，所以让我们从函数输入中删除赋值，并使用一个容器来存储我们需要的内容(记住，我们希望读入数据并存储它以便以后绘制),让我们继续为我们的图添加一些标签。这里的想法和坐标一样！我们先手动测试一下。(和你真正的一点点偷懒)</p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="0af3" class="ll lm iq lh b gy ln lo l lp lq"># what if we want to look at a specific area of the world?</span><span id="6d84" class="ll lm iq lh b gy lr lo l lp lq">from mpl_toolkits.basemap import Basemap<br/>import matplotlib<br/>import matplotlib.pyplot as plt<br/>import numpy as np</span><span id="ade2" class="ll lm iq lh b gy lr lo l lp lq">def create_merc(lat, long):<br/>    <br/>    plt.figure(figsize=(10, 10), dpi=100)<br/>    # increase font size<br/>    matplotlib.rcParams.update({'font.size': 16})</span><span id="f18a" class="ll lm iq lh b gy lr lo l lp lq"># make sure the value of resolution is a lowercase L,<br/>    #  for 'low', not a numeral 1<br/>    merc_map = Basemap(projection='merc', lat_0=(lat-20), lon_0= (long+15),<br/>        resolution = 'h', area_thresh = .1,<br/>        # lower left hand corner longitude, lat<br/>        # upper right hand corner long, lat<br/>        llcrnrlon=(long-10), llcrnrlat=(lat-10),<br/>        urcrnrlon=(long+10), urcrnrlat=(lat+10))<br/>    <br/>    <br/>    longs = [-77, -74]<br/>    lats = [39, 40]<br/>    <br/>    x, y = merc_map(longs, lats)<br/>    <br/>    merc_map.plot(x, y, 'go', markersize=8)<br/>    <br/>    locations = ['Columbia, MD', 'New York City']<br/>    for label, xc, yc in zip(locations, x, y):<br/>        plt.text(xc-100000, yc+55000, label, color='teal')<br/>    <br/>    merc_map.drawcoastlines(color='grey', linestyle=':')<br/>    merc_map.drawrivers(linewidth=0.3, color="cornflowerblue")<br/>    merc_map.fillcontinents(color='navajowhite',                              lake_color='paleturquoise')<br/>    merc_map.drawcountries()<br/>    merc_map.drawmapboundary()</span><span id="d03b" class="ll lm iq lh b gy lr lo l lp lq">    merc_map.drawmeridians(np.arange(0, 360, 30))<br/>    merc_map.drawparallels(np.arange(-90, 90, 30))<br/>    <br/>    <br/>    <br/>    plt.show()</span><span id="8f62" class="ll lm iq lh b gy lr lo l lp lq">create_merc(39, -77)</span></pre><figure class="lc ld le lf gt jr gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/00d90b144b6220491031bf44a597a8ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1212/format:webp/1*4Xw2cRWxGx4HU82G2OK1tg.png"/></div></figure><p id="c9df" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">现在我们已经探索了映射、绘图和注释，让我们开始引入一些数据。出于本教程的目的，我已经将地震数据下载为 CSV 格式，并将其存放在 github 上，供您以其<a class="ae la" href="https://raw.githubusercontent.com/edwardauron/working_data/master/all_week.csv" rel="noopener ugc nofollow" target="_blank"> raw 格式</a>访问。</p><p id="ce89" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">继续将原始数据加载到 pandas 中，并开始研究数据。我们实际上想要绘制地震活动的是它的地理位置，所以检查纬度和经度列中是否有任何缺失的值。</p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="b72d" class="ll lm iq lh b gy ln lo l lp lq">import pandas as pd<br/>seismic_activity_30_days = pd.read_csv('<a class="ae la" href="https://raw.githubusercontent.com/edwardauron/working_data/master/all_week.csv'" rel="noopener ugc nofollow" target="_blank">https://raw.githubusercontent.com/edwardauron/working_data/master/all_week.csv'</a>)</span><span id="22bf" class="ll lm iq lh b gy lr lo l lp lq">seismic_activity_30_days.head()</span><span id="9d37" class="ll lm iq lh b gy lr lo l lp lq">print(seismic_activity_30_days['latitude'].isnull().values.any())<br/>print(seismic_activity_30_days['longitude'].isnull().values.any())</span><span id="0998" class="ll lm iq lh b gy lr lo l lp lq">False<br/>False</span></pre><p id="f201" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">太好了，没有丢失 lat 或 long 数据，所以我们可以跳过清理，直接将列中的数据放到我们函数中先前定义的列表中。我们重用先前函数中的现有代码来获取一个数据帧，并添加一些方法来处理它。</p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="ab11" class="ll lm iq lh b gy ln lo l lp lq">def create_hammer(df):<br/>    <br/>    plt.figure(figsize=(10, 10), dpi=100)<br/>    # increase font size<br/>    matplotlib.rcParams.update({'font.size': 16})</span><span id="6566" class="ll lm iq lh b gy lr lo l lp lq"># make sure the value of resolution is a lowercase L,<br/>    #  for 'low', not a numeral 1<br/>    merc_map = Basemap(projection='hammer', lat_0=0, lon_0=-130,<br/>        resolution = 'l', area_thresh = 1000)<br/>    <br/>    <br/>    working_df = df<br/>    <br/>    longs = working_df['longitude'].tolist()<br/>    lats = working_df['latitude'].tolist()<br/>    <br/>    x, y = merc_map(longs, lats)<br/>    merc_map.plot(x, y, marker='o', color='lavenderblush', markersize=4)<br/>    <br/>    merc_map.drawcoastlines(color='grey', linestyle=':')<br/>    merc_map.drawrivers(linewidth=0.3, color="cornflowerblue")<br/>    merc_map.fillcontinents(color='navajowhite', lake_color='paleturquoise')<br/>    merc_map.drawcountries()<br/>    merc_map.drawstates(linewidth=0.3, color='saddlebrown')<br/>    merc_map.drawmapboundary()</span><span id="d855" class="ll lm iq lh b gy lr lo l lp lq">merc_map.drawmeridians(np.arange(0, 360, 30))<br/>    merc_map.drawparallels(np.arange(-90, 90, 30))<br/>    <br/>    <br/>    <br/>    plt.show()</span><span id="5189" class="ll lm iq lh b gy lr lo l lp lq">create_hammer(seismic_activity_30_days)</span></pre><p id="93fa" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">如果你跟着做，你会注意到这造成了一片混乱。</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ly"><img src="../Images/33b71e484e0b8ce4a10e03aa1d3ac0dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*i-AtFAiQdYC5ayq0Z0Vf1g.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Yikes!</figcaption></figure><p id="4137" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们需要单独绘制所有这些点，而不是一次绘制所有这些点。是的，是时候来个<code class="fe lz ma mb lh b">for</code>循环了。事实证明“淡紫色”并不是最容易看到的颜色！</p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="840c" class="ll lm iq lh b gy ln lo l lp lq">def create_hammer(df):<br/>    <br/>    plt.figure(figsize=(10, 10), dpi=100)<br/>    # increase font size<br/>    matplotlib.rcParams.update({'font.size': 16})</span><span id="fb50" class="ll lm iq lh b gy lr lo l lp lq"># make sure the value of resolution is a lowercase L,<br/>    #  for 'low', not a numeral 1<br/>    hammer_map = Basemap(projection='hammer', lat_0=0, lon_0=-130,<br/>        resolution = 'l', area_thresh = 1000)<br/>    <br/>    <br/>    working_df = df<br/>    <br/>    longs = working_df['longitude'].tolist()<br/>    lats = working_df['latitude'].tolist()<br/>    <br/>    min_marker_size = 2.5<br/>    for longitude, latitude in zip(longs, lats):<br/>        x, y = hammer_map(longitude, latitude)<br/>        marker_size = min_marker_size<br/>        hammer_map.plot(x, y, marker='o', color='maroon', markersize=marker_size)<br/>    <br/>    hammer_map.drawcoastlines(color='grey', linestyle=':')<br/>    hammer_map.drawrivers(linewidth=0.3, color="cornflowerblue")<br/>    hammer_map.fillcontinents(color='navajowhite', lake_color='paleturquoise')<br/>    hammer_map.drawcountries()<br/>    hammer_map.drawstates(linewidth=0.3, color='saddlebrown')<br/>    hammer_map.drawmapboundary()</span><span id="d7be" class="ll lm iq lh b gy lr lo l lp lq">hammer_map.drawmeridians(np.arange(0, 360, 30))<br/>    hammer_map.drawparallels(np.arange(-90, 90, 30))<br/>    <br/>    <br/>    <br/>    plt.show()</span></pre><p id="3b33" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">这才像话！</p><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ly"><img src="../Images/02e648e27abe4326de3c49d23abcc6ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-Ai3wY9fidovBkmE8jtf7A.png"/></div></div></figure><p id="1c05" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">我们还需要做最后一件事。你能猜到吗？我们需要一种方法来区分这些情节点！你能在数据框中找到对我们有帮助的列吗？我们应该将该列映射到哪种表达式？在查看我的解决方案之前，请随意探索并提出想法。</p><p id="5664" class="pw-post-body-paragraph kc kd iq ke b kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz ij bi translated">嗯，这是我的成品。它仍然需要一些提炼，就像一个传说。但是我继续添加了一个格式化的标题，以及一些玩弄绘制的圆圈大小。它可以使用一些悬停事件，我计划添加一个选项来放大和投影用户指定的区域与墨卡托投影，但我对我在这里感到满意。暂时如此。</p><pre class="lc ld le lf gt lg lh li lj aw lk bi"><span id="d1ce" class="ll lm iq lh b gy ln lo l lp lq"># plotting seismic activity</span><span id="81fd" class="ll lm iq lh b gy lr lo l lp lq">from mpl_toolkits.basemap import Basemap<br/>import matplotlib<br/>import matplotlib.pyplot as plt<br/>import numpy as np<br/>import pandas as pd</span><span id="02aa" class="ll lm iq lh b gy lr lo l lp lq">def create_hammer(df):<br/>    <br/>    plt.figure(figsize=(18, 12), dpi=100)<br/>    # increase font size<br/>    matplotlib.rcParams.update({'font.size': 16})</span><span id="9c0c" class="ll lm iq lh b gy lr lo l lp lq"># make sure the value of resolution is a lowercase L,<br/>    #  for 'low', not a numeral 1<br/>    hammer_map = Basemap(projection='hammer', lat_0=0, lon_0=-130,<br/>        resolution = 'l', area_thresh = 1000)<br/>    <br/>    <br/>    working_df = df<br/>    <br/>    # generate data for plotting from our df<br/>    longs = working_df['longitude'].tolist()<br/>    lats = working_df['latitude'].tolist()<br/>    mags = working_df['mag'].tolist()<br/>    <br/>    # handle dates for title<br/>    start = working_df.time.iloc[0]<br/>    end = working_df.time.iloc[1825]<br/>    <br/>    min_marker_size = 2.5<br/>    for longitude, latitude, magnitude in zip(longs, lats, mags):<br/>        x, y = hammer_map(longitude, latitude)<br/>        marker_size = min_marker_size * magnitude\<br/>        <br/>        if magnitude &lt; 3.0:<br/>            hammer_map.plot(x, y, marker='o', color='maroon', markersize=marker_size)<br/>        elif magnitude &lt; 5.0:<br/>            hammer_map.plot(x, y, marker='o', color='slateblue', markersize=marker_size)<br/>        else:<br/>            hammer_map.plot(x, y, marker='o', color='goldenrod', markersize=marker_size)<br/>    <br/>    hammer_map.drawcoastlines(color='grey', linestyle=':')<br/>    hammer_map.drawrivers(linewidth=0.3, color="cornflowerblue")<br/>    hammer_map.fillcontinents(color='navajowhite', lake_color='paleturquoise')<br/>    hammer_map.drawcountries()<br/>    hammer_map.drawstates(linewidth=0.3, color='saddlebrown')<br/>    hammer_map.drawmapboundary()</span><span id="7f67" class="ll lm iq lh b gy lr lo l lp lq">hammer_map.drawmeridians(np.arange(0, 360, 30))<br/>    hammer_map.drawparallels(np.arange(-90, 90, 30))<br/>    <br/>    title = "Seismic activity with Magnitudes more than 1.0\n"<br/>    # string manipulation, list slicing<br/>    title += "%s through %s" % (start[:10], end[:10])<br/>    <br/>    plt.title(title)<br/>    plt.show()</span><span id="e6f1" class="ll lm iq lh b gy lr lo l lp lq">create_hammer(seismic_activity_30_days)</span></pre><figure class="lc ld le lf gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mc"><img src="../Images/85215af2119eddfa56ffe423bf479c27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q7z2wuWcfYRmjE4qBXp82A.png"/></div></div></figure></div></div>    
</body>
</html>