<html>
<head>
<title>My 1st Machine Learning Project PT1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我的第一个机器学习项目PT1</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/my-1st-machine-learning-project-pt1-2f4368f63f52?source=collection_archive---------11-----------------------#2017-08-09">https://towardsdatascience.com/my-1st-machine-learning-project-pt1-2f4368f63f52?source=collection_archive---------11-----------------------#2017-08-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="4c10" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这一刻终于到来了</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/fba528881dea32654e16d02aa73c2f1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*ggCqQduKXeaTLuP8bjxXfA.jpeg"/></div><figcaption class="kt ku gj gh gi kv kw bd b be z dk"><a class="ae kx" href="https://www.flickr.com/photos/wocintechchat/25497596540/in/photostream/" rel="noopener ugc nofollow" target="_blank">WOCinTechChat</a></figcaption></figure><p id="cc37" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大家好！希望你们都过得好。我正在兑现我在<a class="ae kx" href="https://medium.com/the-data-logs/machine-learning-as-explained-by-a-beginner-dd5b8119a45" rel="noopener">上一篇文章</a>中的承诺。今天我们将关注线性回归。数据集是关于国王郡地区2014年5月至2015年5月间出售的房屋。你可以在<a class="ae kx" href="https://www.kaggle.com/harlfoxem/housesalesprediction" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>上自己下载。这是一个寻找数据集和练习机器学习的好地方。如果你和我一样兴奋，让我们开始吧。</p><h2 id="4861" class="ky kz iq bd la lb lc dn ld le lf dp lg jy lh li lj kc lk ll lm kg ln lo lp lq bi translated">线性回归</h2><p id="0341" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">线性回归是一种使用变量(或机器学习的特征)来预测定量变量(目标变量)的算法。更具体地说，它试图拟合一条穿过数据的直线，该直线最好地表示预测变量和目标变量之间的关系。</p><p id="2bdb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">想起我在上一篇帖子里举的工资例子。你试图根据某人多年的工作经验来预测你的薪水。工资是目标变量，工作年限是预测变量。这个数据集的目标变量是房屋的价格。我们的预测者呢？我们把这个装进去，看看有什么发现。他们所代表的东西可以在<a class="ae kx" href="https://rstudio-pubs-static.s3.amazonaws.com/155304_cc51f448116744069664b35e7762999f.html" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><pre class="km kn ko kp gt lw lx ly lz aw ma bi"><span id="78ab" class="ky kz iq lx b gy mb mc l md me">Housing_df &lt;- read.csv("kc_house_data.csv")<br/>str(Housing_df)<br/>'data.frame': 21613 obs. of  21 variables:<br/> <br/>$ id           : num  7.13e+09 6.41e+09 5.63e+09 2.49e+09 1.95e+09 ...<br/> <br/>$ date         : Factor w/ 372 levels "20140502T000000",..: 165 221 291 221 284 11 57 252 340 306 ...<br/> <br/>$ price        : num  221900 538000 180000 604000 510000 ...<br/> $ bedrooms     : int  3 3 2 4 3 4 3 3 3 3 ...<br/> $ bathrooms    : num  1 2.25 1 3 2 4.5 2.25 1.5 1 2.5 ...<br/> <br/>$ sqft_living  : int  1180 2570 770 1960 1680 5420 1715 1060 1780 1890 ...<br/> <br/>$ sqft_lot     : int  5650 7242 10000 5000 8080 101930 6819 9711   7470 6560 ...<br/> <br/> $ floors       : num  1 2 1 1 1 1 2 1 1 2 ...<br/> $ waterfront   : int  0 0 0 0 0 0 0 0 0 0 ...<br/> $ view         : int  0 0 0 0 0 0 0 0 0 0 ...<br/> $ condition    : int  3 3 3 5 3 3 3 3 3 3 ...<br/> $ grade        : int  7 7 6 7 8 11 7 7 7 7 ...<br/> $ sqft_above   : int  1180 2170 770 1050 1680 3890 1715 1060 1050 1890 ...<br/> <br/>$ sqft_basement: int  0 400 0 910 0 1530 0 0 730 0 ...<br/> <br/>$ yr_built     : int  1955 1951 1933 1965 1987 2001 1995 1963 1960 2003 ...<br/> <br/>$ yr_renovated : int  0 1991 0 0 0 0 0 0 0 0 ...<br/> <br/>$ zipcode      : int  98178 98125 98028 98136 98074 98053 98003 98198 98146 98038 ...<br/> <br/>$ lat          : num  47.5 47.7 47.7 47.5 47.6 ...<br/> <br/>$ long         : num  -122 -122 -122 -122 -122 ...<br/> <br/>$ sqft_living15: int  1340 1690 2720 1360 1800 4760 2238 1650 1780 2390 ...<br/> <br/>$ sqft_lot15   : int  5650 7639 8062 5000 7503 101930 6819 9711 8113 7570 ...</span></pre><p id="7aaa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不算价格，我们总共有20个可能的预测变量。如果只选一个，那就叫简单线性回归。如果我们选择1以上，多元线性回归。很简单，不是吗？现在我们如何选择我们应该使用的变量呢？一种方法是使用所有的东西来建立一个模型，根据一个特定的标准来评估这个模型，然后一个接一个地移除每个预测因子。我们将执行的另一个方法是对每个预测值进行逻辑思考，看看创建模型和做出好的预测是否有统计学意义。更具体地说，我们将保留本质上是有序的变量。</p><p id="a3f3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">所以现在让我们开始移除一些。ID &amp; zipcode可以走了。它们都是标签，不会从数字上告诉你一个数字是否比另一个好。id 2346并不比2342好。所以现在我们只剩18个了。接下来，我们将删除纬度和经度。这些只是地图上房子的坐标。对于线性回归模型，它们是不需要的。</p><p id="9078" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">其他16个暂时可以接受。尽管我们需要做些调整。如果您查看日期变量，您会注意到它不是最易读的。最重要的是，它也不是定量的。所以我们将它转换成数字:</p><pre class="km kn ko kp gt lw lx ly lz aw ma bi"><span id="19c0" class="ky kz iq lx b gy mb mc l md me">#Converting to regular text first<br/>Housing_df$date&lt;- as.Date(as.Date(as.character(Housing_df$date),"%Y%m%d"))</span><span id="12d1" class="ky kz iq lx b gy mf mc l md me">#Now converting to number<br/>Housing_df$date &lt;- as.numeric(Housing_df$date)</span></pre><p id="25c1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">太棒了。我们现在准备进入机器学习的下一步。</p><h2 id="09f8" class="ky kz iq bd la lb lc dn ld le lf dp lg jy lh li lj kc lk ll lm kg ln lo lp lq bi translated">训练和测试集</h2><p id="1500" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">在机器学习中，你将数据分成两组:训练集和测试集。定型集是您的模型从中学习的数据部分。测试集用于查看您的模型对以前没有见过的数据的预测效果。为什么不用整个数据集来代替呢？如果你这样做了，你的模型在预测新值方面就不会做得很好，因为它捕捉了特定数据集的模式。这么看吧。你通过模拟考试来准备考试。你只研究你在课堂上得到的答案和问题出现的顺序，而不理解概念。当真正的考试以随机顺序出现问题时，你不会做得很好。</p><p id="2171" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们要做的第一件事是考虑有多少数据将进入训练集，哪些数据将留给测试集。通常越多越好，所以我会把数据分成80-20份训练测试。</p><pre class="km kn ko kp gt lw lx ly lz aw ma bi"><span id="1ded" class="ky kz iq lx b gy mb mc l md me">#Split data into training and test sets</span><span id="ea31" class="ky kz iq lx b gy mf mc l md me">library(caTools)</span><span id="9aef" class="ky kz iq lx b gy mf mc l md me">set.seed(1234)<br/>split &lt;- sample.split(Housing_df$price, SplitRatio = 0.8)<br/>training_set &lt;- subset(Housing_df, split == T)<br/>test_set &lt;- subset(Housing_df, split == F)</span></pre><p id="b8af" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">已经完成了。训练集包含17，839个观察值，测试集将包含3，774个观察值。如果你对布景有疑问，seed是为团队工作准备的。当一个数据集被分割时，最终出现在一个数据集和另一个数据集之间的观察值是随机的。由于一个随机数发生器。当你设置了一个种子，你就说明了rng从哪里开始。这使得您的工作具有可重复性，这在数据科学中非常重要。所以如果你的同事想评价你的工作，或者想看看你哪里出了问题，只要输入相同的种子，他们就可以下载相同的数据集，得到和你一样的观察结果。</p><p id="292f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们开始做好事了。我们要建立一个线性回归模型！终于！</p><h2 id="94c9" class="ky kz iq bd la lb lc dn ld le lf dp lg jy lh li lj kc lk ll lm kg ln lo lp lq bi translated">模型结构</h2><p id="cc8f" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">线性回归模型基本上是一个数学公式的表示。不要担心，我们不会在第1部分得到超级数学；只是想给你提个醒。这就是我们将如何建立这个模型。</p><pre class="km kn ko kp gt lw lx ly lz aw ma bi"><span id="8df7" class="ky kz iq lx b gy mb mc l md me">model1 &lt;- lm(formula = price ~ date + bedrooms + bathrooms + sqft_living + sqft_lot + floors + waterfront + view + condition + grade + sqft_above + sqft_basement + yr_built + yr_renovated + sqft_living15 +  sqft_lot15, data = training_set )</span></pre><p id="f8ca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，我们使用lm函数让我们知道我们在构建什么样的算法。价格是我们的目标变量，所以我们首先列出它。在~之后，我们列出所有我们想用来预测的变量。最后，让我们陈述我们用来构建模型的数据集。如果我们想看看它是什么样子:</p><pre class="km kn ko kp gt lw lx ly lz aw ma bi"><span id="8c6f" class="ky kz iq lx b gy mb mc l md me">Call:<br/>lm(formula = price ~ date + bedrooms + bathrooms + sqft_living + <br/>    sqft_lot + floors + waterfront + view + condition + grade + <br/>    sqft_above + sqft_basement + yr_built + yr_renovated + sqft_living15 + <br/>    sqft_lot15, data = trainig_set)</span><span id="7548" class="ky kz iq lx b gy mf mc l md me">Residuals:<br/>     Min       1Q   Median       3Q      Max <br/>-1415203  -110571   -10066    92170  4203618</span><span id="ec09" class="ky kz iq lx b gy mf mc l md me">Coefficients: (1 not defined because of singularities)<br/>                Estimate Std. Error t value Pr(&gt;|t|)    <br/>(Intercept)    4.687e+06  2.860e+05  16.384  &lt; 2e-16 ***<br/>date           1.027e+02  1.463e+01   7.017 2.34e-12 ***<br/>bedrooms      -4.568e+04  2.354e+03 -19.406  &lt; 2e-16 ***<br/>bathrooms      4.805e+04  3.893e+03  12.342  &lt; 2e-16 ***<br/>sqft_living    1.707e+02  5.195e+00  32.859  &lt; 2e-16 ***<br/>sqft_lot      -6.375e-03  5.472e-02  -0.117  0.90725    <br/>floors         2.323e+04  4.246e+03   5.470 4.56e-08 ***<br/>waterfront     6.149e+05  2.042e+04  30.116  &lt; 2e-16 ***<br/>view           4.267e+04  2.534e+03  16.840  &lt; 2e-16 ***<br/>condition      1.979e+04  2.824e+03   7.009 2.49e-12 ***<br/>grade          1.226e+05  2.515e+03  48.748  &lt; 2e-16 ***<br/>sqft_above    -1.207e+00  5.074e+00  -0.238  0.81199    <br/>sqft_basement         NA         NA      NA       NA    <br/>yr_built      -3.663e+03  7.966e+01 -45.989  &lt; 2e-16 ***<br/>yr_renovated   1.346e+01  4.408e+00   3.053  0.00227 ** <br/>sqft_living15  2.293e+01  4.045e+00   5.669 1.46e-08 ***<br/>sqft_lot15    -6.312e-01  8.790e-02  -7.181 7.22e-13 ***<br/>---<br/>Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span><span id="e20c" class="ky kz iq lx b gy mf mc l md me">Residual standard error: 220400 on 17823 degrees of freedom<br/>Multiple R-squared:  0.6607, Adjusted R-squared:  0.6604 <br/>F-statistic:  2314 on 15 and 17823 DF,  p-value: &lt; 2.2e-16</span></pre><p id="6d46" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">呜！我们的模型建成了！但是这些数字是怎么回事？星星呢？模型有多好？这些是我们将在第2部分中回答的问题。我现在不想打击你们。</p><p id="9e65" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你学到了新的东西，并准备好第2部分，点击推荐按钮！</p></div></div>    
</body>
</html>