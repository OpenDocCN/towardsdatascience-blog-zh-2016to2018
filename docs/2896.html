<html>
<head>
<title>Steganography: Hiding an image inside another</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">隐写术:将一幅图像隐藏在另一幅图像中</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/steganography-hiding-an-image-inside-another-77ca66b2acb1?source=collection_archive---------1-----------------------#2018-03-18">https://towardsdatascience.com/steganography-hiding-an-image-inside-another-77ca66b2acb1?source=collection_archive---------1-----------------------#2018-03-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/f359dff04375df3e084f4821e7697c78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dQyfOpFWmSxrmdOcQgW6OQ.jpeg"/></div></div></figure><p id="7dfc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在这个故事中，我们将学习一些图像处理的概念，以及如何将一个图像隐藏在另一个图像文件中。</p><p id="63ec" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了提供一个功能示例，实现了一个<a class="ae kw" href="https://github.com/kelvins/steganography/blob/master/steganography.py" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> Python </strong>类</a>来执行本故事结尾提到的过程。</p><p id="2a06" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先我们来了解一下什么是隐写术，数字图像，像素，颜色模型。</p><h2 id="fb83" class="kx ky iq bd kz la lb dn lc ld le dp lf kj lg lh li kn lj lk ll kr lm ln lo lp bi translated">什么是隐写术？</h2><blockquote class="lq lr ls"><p id="dc26" class="jy jz lt ka b kb kc kd ke kf kg kh ki lu kk kl km lv ko kp kq lw ks kt ku kv ij bi translated"><a class="ae kw" href="https://en.wikipedia.org/wiki/Steganography" rel="noopener ugc nofollow" target="_blank">隐写术</a>是将一个文件、消息、图像或视频隐藏在另一个文件、消息、图像或视频中的做法。</p></blockquote><h2 id="bf30" class="kx ky iq bd kz la lb dn lc ld le dp lf kj lg lh li kn lj lk ll kr lm ln lo lp bi translated">隐写术比密码学有什么优势？</h2><blockquote class="lq lr ls"><p id="ff1a" class="jy jz lt ka b kb kc kd ke kf kg kh ki lu kk kl km lv ko kp kq lw ks kt ku kv ij bi translated">隐写术相对于单独的<a class="ae kw" href="https://en.wikipedia.org/wiki/Cryptography" rel="noopener ugc nofollow" target="_blank">密码术</a>的优势在于，预期的秘密消息不会引起对其自身作为审查对象的注意。显而易见的加密信息，无论如何无法破解，都会引起人们的兴趣，而且在加密不合法的国家，这些信息本身可能会被定罪。</p></blockquote><p id="b25b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">换句话说，当我们想要发送秘密信息时，隐写术比密码学更谨慎。另一方面，隐藏的信息更容易提取。</p><h2 id="062a" class="kx ky iq bd kz la lb dn lc ld le dp lf kj lg lh li kn lj lk ll kr lm ln lo lp bi translated">什么是数字图像？</h2><p id="bc4b" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv ij bi translated">好了，现在我们知道了隐写术的基础知识，让我们学习一些简单的图像处理概念。</p><p id="d700" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在了解如何将一幅图像隐藏在另一幅图像中之前，我们需要了解什么是数字图像。</p><p id="a134" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们可以将数字图像<strong class="ka ir">描述为一组有限的数字值，称为像素。像素是图像中最小的单个元素，包含代表给定颜色在任何特定点的亮度的值。所以我们可以把一幅图像想象成一个包含固定数量的行和列的像素矩阵(或二维数组)。</strong></p><figure class="md me mf mg gt jr gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/b9b5ef8d4d2a4793e04ac9df5bda3fe4.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*-Vreo05sajRL8dRibXIWXA.png"/></div></figure><p id="1335" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当在此使用“<strong class="ka ir">数字图像</strong>术语时，我们指的是“<strong class="ka ir">光栅图形</strong>，它基本上是一种点阵数据结构，代表像素网格，进而可以存储在不同格式的图像文件中。你可以在<a class="ae kw" href="https://en.wikipedia.org/wiki/Main_Page" rel="noopener ugc nofollow" target="_blank">维基百科</a>网站上阅读更多关于<a class="ae kw" href="https://en.wikipedia.org/wiki/Digital_image" rel="noopener ugc nofollow" target="_blank">数字图像</a>、<a class="ae kw" href="https://en.wikipedia.org/wiki/Raster_graphics" rel="noopener ugc nofollow" target="_blank">光栅图形</a>和<a class="ae kw" href="https://en.wikipedia.org/wiki/Bitmap" rel="noopener ugc nofollow" target="_blank">位图</a>的内容。</p><h2 id="3184" class="kx ky iq bd kz la lb dn lc ld le dp lf kj lg lh li kn lj lk ll kr lm ln lo lp bi translated">像素概念和颜色模型</h2><p id="e8aa" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv ij bi translated">如前所述，像素是图像的最小元素。因此，每个像素都是原始图像的样本。这意味着，更多的样本可以更准确地再现原始图像。每个像素的强度<a class="ae kw" href="https://en.wikipedia.org/wiki/Intensity_(physics)" rel="noopener ugc nofollow" target="_blank">是可变的。在彩色成像系统中，一种颜色通常由三种或四种分量强度表示，如</a><a class="ae kw" href="https://en.wikipedia.org/wiki/RGB_color_model" rel="noopener ugc nofollow" target="_blank">红色、绿色和蓝色</a>，或<a class="ae kw" href="https://en.wikipedia.org/wiki/CMYK_color_model" rel="noopener ugc nofollow" target="_blank">青色、品红色、黄色和黑色</a>。</p><p id="4f5a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这里，我们将使用<a class="ae kw" href="https://en.wikipedia.org/wiki/RGB_color_model" rel="noopener ugc nofollow" target="_blank"> RGB颜色模型</a>。可以想象，RGB颜色模型有3个通道，红、绿、蓝。</p><blockquote class="lq lr ls"><p id="be41" class="jy jz lt ka b kb kc kd ke kf kg kh ki lu kk kl km lv ko kp kq lw ks kt ku kv ij bi translated"><strong class="ka ir"> RGB颜色模型</strong>是一种加色<a class="ae kw" href="https://en.wikipedia.org/wiki/Color_model" rel="noopener ugc nofollow" target="_blank">颜色模型</a>，其中红色、绿色和蓝色光以各种方式相加在一起，以再现各种颜色。该型号的名称来自三种加色原色的首字母，即红、绿和蓝。RGB颜色模型的主要用途是用于电子系统(如电视和计算机)中图像的感测、表示和显示，尽管它也用于传统的<a class="ae kw" href="https://en.wikipedia.org/wiki/Photography" rel="noopener ugc nofollow" target="_blank">摄影</a>。</p></blockquote><figure class="md me mf mg gt jr gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/d98ce5c92332004bea188704c35f9865.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*tcTa2Cst3FXkDpxTg-_1mA.jpeg"/></div></figure><p id="8117" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">因此，图像中的每个像素由3个值(红、绿、蓝)组成，这3个值是<a class="ae kw" href="https://en.wikipedia.org/wiki/8-bit" rel="noopener ugc nofollow" target="_blank"> 8位</a>值(范围是0–255)。</p><figure class="md me mf mg gt jr gh gi paragraph-image"><div class="gh gi mi"><img src="../Images/b6445e034ca60931f8bf44870325ed7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1300/format:webp/1*Mt3yDPhS3aq_spPfWTW9BA.png"/></div></figure><p id="2d5a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如我们在上面的图像中看到的，对于每个像素，我们有三个值，可以用<a class="ae kw" href="https://en.wikipedia.org/wiki/Binary_code" rel="noopener ugc nofollow" target="_blank">二进制代码</a>(计算机语言)来表示。</p><p id="dc8a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">处理二进制代码时，我们有较高的有效位和较低的有效位，如下图所示。</p><figure class="md me mf mg gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mh"><img src="../Images/e8b0484626cd1cace0cc76711d2443be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*YQGZLBpDn2U9Bu8sZphzXQ.jpeg"/></div></div></figure><p id="a299" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最左边的<strong class="ka ir">位</strong>是<strong class="ka ir">最高有效位</strong>。如果我们改变最左边的位，它将对最终值有很大的影响。例如，如果我们将最左边的位从<strong class="ka ir"> 1 </strong>更改为<strong class="ka ir"> 0 </strong> ( <strong class="ka ir"> 11111111 </strong>更改为<strong class="ka ir"> 01111111 </strong>)它会将十进制值从<strong class="ka ir"> 255 </strong>更改为<strong class="ka ir"> 127 </strong>。</p><p id="7b16" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">另一方面，<strong class="ka ir">最右边的</strong>位是<strong class="ka ir">最低有效位</strong>。如果我们改变最右边的位，对最终值的影响会更小。例如，如果我们将最左边的位从<strong class="ka ir"> 1 </strong>更改为<strong class="ka ir">0</strong>(<strong class="ka ir">111111111</strong>更改为<strong class="ka ir"> 11111110 </strong>)它会将十进制值从<strong class="ka ir"> 255 </strong>更改为<strong class="ka ir"> 254 </strong>。注意，最右边的位在256的范围内只改变1(它表示小于1%)。</p><p id="b91d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">总结:</strong>每个像素有三个值(RGB)，每个RGB值都是8位(意味着我们可以存储8个二进制值)，最右边的位不太重要。因此，如果我们改变最右边的位，它将对最终图像有一个小的视觉影响。这是将一幅图像隐藏在另一幅图像中的隐写术密钥。更改一幅图像的较低有效位，并包含另一幅图像的最高有效位。</p><figure class="md me mf mg gt jr gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/1ee9c3077b85cb7c435f7686189cfc4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*kpDa0jt6ftSce4b4DQA2MQ.png"/></div></figure><h2 id="e1eb" class="kx ky iq bd kz la lb dn lc ld le dp lf kj lg lh li kn lj lk ll kr lm ln lo lp bi translated">将图像隐藏在另一个图像中</h2><p id="eda6" class="pw-post-body-paragraph jy jz iq ka b kb lx kd ke kf ly kh ki kj lz kl km kn ma kp kq kr mb kt ku kv ij bi translated">既然我们理解了像素概念和颜色模型，我们就可以讨论将一个图像隐藏到另一个图像中的过程。</p><p id="870c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在本节中，我们可以找到使用Python代码的隐藏和显示过程的一步一步。</p><p id="1262" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">隐藏图像</strong>:</p><ol class=""><li id="1bc2" class="mk ml iq ka b kb kc kf kg kj mm kn mn kr mo kv mp mq mr ms bi translated">要将一个图像隐藏在另一个图像中，被隐藏的图像最多需要与隐藏它的图像大小相同。</li></ol><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="8252" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">2.我们必须创建两个循环来遍历图像的所有行和列(实际上是每个像素)。</p><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="581d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">3.因此，我们从图像1和图像2获得RGB二进制值:</p><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="85bb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们可以使用<strong class="ka ir"> __int_to_bin </strong>方法将十进制值转换为二进制值:</p><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="5e01" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">4.我们将图像1的最高有效位与图像2的最高有效位合并:</p><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="c47b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用<strong class="ka ir"> __merge_rgb </strong>方法:</p><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="f129" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">请注意，<strong class="ka ir"> __merge_rgb </strong>函数使用每幅图像的4个最高有效位，但也可以改变。请记住，使用隐藏图像中较少的位会导致恢复图像的质量较低。</p><p id="358b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">5.最后，我们将新的二进制值转换为十进制值:</p><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="048e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用<strong class="ka ir"> __bin_to_int </strong>方法:</p><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="108d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">并将其设置为结果图像中的新像素位置。</p><p id="2717" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我们有了一个隐藏在另一个图像中的图像。</p><p id="b6e7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">整个<strong class="ka ir">合并</strong>的方法可以在<a class="ae kw" href="https://github.com/kelvins/steganography/blob/master/steganography.py#L49" rel="noopener ugc nofollow" target="_blank">这里找到</a>。</p><p id="1fcd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">露出一个形象</strong>:</p><ol class=""><li id="98af" class="mk ml iq ka b kb kc kf kg kj mm kn mn kr mo kv mp mq mr ms bi translated">要显示一幅图像，我们必须知道用了多少位来隐藏图像。在这种情况下，我们使用固定数量的4位。</li><li id="682d" class="mk ml iq ka b kb mv kf mw kj mx kn my kr mz kv mp mq mr ms bi translated">首先，我们需要创建两个循环来遍历图像中的所有像素:</li></ol><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="6fb0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">3.因此，我们从当前像素中提取每个RGB通道作为二进制值:</p><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="ea83" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用<strong class="ka ir"> __int_to_bin </strong>方法:</p><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="ff90" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">4.然后，我们创建一个新的RGB值，只将当前像素最右边的4位与零值连接起来(以创建一个新的8位值):</p><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="bc59" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">5.最后，我们将二进制值转换为十进制值，并将其设置为新图像中的当前像素:</p><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="cb37" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">6.当隐藏的图像小于隐藏它的图像时，所开发的算法只有最后一步来去除黑边。</p><figure class="md me mf mg gt jr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="ec80" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">通过这个简单的代码，我们可以从另一幅图像中提取一幅图像。</p><p id="45a2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">整个<strong class="ka ir">解合并</strong>方法可以在<a class="ae kw" href="https://github.com/kelvins/steganography/blob/master/steganography.py#L88" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><p id="5bf3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">您可以在下图</strong>中查看结果:</p><p id="75b3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">左上角的图像将隐藏右上角的图像。左下图像是两个合并的图像，右下图像是提取的(未合并的)图像。</p><figure class="md me mf mg gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/4e61d48e9bccd12b7b449b03430a3db9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4paRMea_BGeNpJ2VzFGCoA.png"/></div></div></figure><p id="2d4f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">正如你在上面的图像中看到的，我们在这个过程中损失了一些图像质量，但这并不影响对图像的理解。</p><p id="1a43" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你可以在https://github.com/kelvins/steganography的<strong class="ka ir">Github</strong>:<a class="ae kw" href="https://github.com/kelvins/steganography" rel="noopener ugc nofollow" target="_blank"/>上找到<strong class="ka ir">隐写术Python代码</strong></p></div></div>    
</body>
</html>