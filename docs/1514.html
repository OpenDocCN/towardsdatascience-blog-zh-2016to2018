<html>
<head>
<title>When was this poem written? My computer can tell you</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">这首诗是什么时候写的？我的电脑可以告诉你</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/identifying-when-poems-were-written-with-natural-language-processing-a40ff286bcd?source=collection_archive---------6-----------------------#2017-09-13">https://towardsdatascience.com/identifying-when-poems-were-written-with-natural-language-processing-a40ff286bcd?source=collection_archive---------6-----------------------#2017-09-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/00bf516825333d2492e976cf5eacf897.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rrDjzWfp5-J4i7-u0iX_MA.jpeg"/></div></div></figure><div class=""/><div class=""><h2 id="ae21" class="pw-subtitle-paragraph jy ja jb bd b jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp dk translated">用数据科学来理解诗歌中的动作</h2></div><p id="2bdd" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">我最近的项目真的很令人兴奋。我热爱诗歌已经有一段时间了，所以我选择它作为我第一次涉足自然语言处理(NLP)的主要领域。</p><p id="d016" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">数据科学最酷的事情之一是它的普遍性和多功能性。你可以“数据科学”几乎任何东西。所以我用这个项目来拓展我的数据科学经验，并用一种非常酷的方式来阐述这个想法。</p><figure class="ln lo lp lq gt is gh gi paragraph-image"><div class="gh gi lm"><img src="../Images/55ffe141488c42d0c911f05da1079257.png" data-original-src="https://miro.medium.com/v2/resize:fit:502/format:webp/1*h6urCuTXW5BpDlzDDbjjUg.jpeg"/></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk">To be or not to be?</figcaption></figure><p id="943a" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">你也许能分辨出莎士比亚的诗和艾米莉·狄金森的作品。莎士比亚死于1616年，狄金森死于1886年，在这270年里，英语的使用方式发生了相当大的变化。但是狄金森和罗伯特·弗罗斯特之间的区别呢？罗伯特·弗罗斯特一直活到1963年。他们两人都用今天仍可理解的语言写作，没有“thous”和“thys”。在他们所处的时代，英语发生了多大的变化？毕竟，1886年并不算太久。那是可口可乐被发明的那一年。</p><p id="ea74" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">但也许你是诗歌专家。也许你对弗罗斯特的风格超级熟悉。如果是这样的话，你也许能分辨出其中的区别，但这远不像对莎士比亚那样容易。但是你，专家先生，如果我给你1500首诗，然后问你哪些是18、19和20世纪的呢？你现在有多自信？</p><p id="0ad9" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">对我们大多数人来说，这是相当困难的。风格和用词的差异并不明显。</p><p id="c5e1" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">这个项目旨在发现这些差异<strong class="ks jc">是否</strong>实际上<strong class="ks jc"> </strong>是可以区分的。机器学习模型可以学习几个世纪之间的风格和单词选择的差异吗？如果有，准确度如何？<em class="lw">剧透警告:可以。也很好。</em></p></div><div class="ab cl lx ly hu lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ij ik il im in"><h2 id="ab33" class="me mf jb bd mg mh mi dn mj mk ml dp mm kz mn mo mp ld mq mr ms lh mt mu mv mw bi translated">获取数据:</h2><p id="5b7b" class="pw-post-body-paragraph kq kr jb ks b kt mx kc kv kw my kf ky kz mz lb lc ld na lf lg lh nb lj lk ll ij bi translated">我的第一个挑战是获得足够大的诗歌语料库来训练模型。起初，我期望这在互联网的某个地方很容易得到。我是说，互联网什么都有，对吧？不对。如果有，我没找到。</p><p id="3ff9" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">下一个可能性是网络抓取。有很多网站上有大量的诗歌。问题是他们中的一些人喝太多了。我指的是用户提交的内容。让任何一个汤姆、迪克或哈利出版他们杰作的网站。伟大的家伙，汤姆，迪克和哈利。但是为了<em class="lw">这个</em>项目，我没有要他们的大作。</p><p id="607b" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">经过一番搜索，我找到了一个合适的网站，但不幸的是，这个网站做得不是很好。一个完全不合逻辑的URL方案和一个过时的HTML结构使它成为一个挑战。但是我刮了。我想出了大约30，000首诗，并对其进行删减以创建我的最终数据集。</p><h2 id="32a3" class="me mf jb bd mg mh mi dn mj mk ml dp mm kz mn mo mp ld mq mr ms lh mt mu mv mw bi translated">数据清理:</h2><p id="ca2f" class="pw-post-body-paragraph kq kr jb ks b kt mx kc kv kw my kf ky kz mz lb lc ld na lf lg lh nb lj lk ll ij bi translated">下一步是清洗和预处理。有几个步骤。</p><p id="fa0c" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">由于数据来自一个网站，我必须在不丢失任何内容的情况下删除所有的HTML标签。我还去掉了所有的标点符号和数字，把所有的字母都改成了小写。这很重要，因为计算机将大写和小写字母视为不同的字母，即使它们代表相同的字符。</p><p id="5c12" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">在这个过程的最后，我留下了大约4000首诗，每一首都只是一滴原始文本，没有标点符号或大写字母。看起来像这样:</p><figure class="ln lo lp lq gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nc"><img src="../Images/8299770662ea38fb55b456f2d374527d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1192/format:webp/1*tyKcyZ_9o3gXpu0TX6sPfQ.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk">If you can figure out what ‘bughts’ are, you get ten points.</figcaption></figure><h2 id="dec1" class="me mf jb bd mg mh mi dn mj mk ml dp mm kz mn mo mp ld mq mr ms lh mt mu mv mw bi translated">建模:</h2><p id="f6d5" class="pw-post-body-paragraph kq kr jb ks b kt mx kc kv kw my kf ky kz mz lb lc ld na lf lg lh nb lj lk ll ij bi translated">下一步是建模。我决定使用计数矢量器来分析这些诗歌。计数矢量器是NLP任务中常用的一种相对简单的方法。它基本上从整个语料库中的每个单词创建一个特征，然后为每首诗中的每个特征分配一个频率计数。它通常被称为“单词包”，因为它只是简单地统计每个单词在每次观察中的出现次数。还有更复杂的文本分析方法，但我选择这种方法主要是因为它简单。大多数自然语言处理任务集中在分析文本的内容，但是在这个任务中，我关注的是T2风格。</p><p id="9e39" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">关于这一点，我在这个项目中做了另一个有趣的决定。NLP项目中的一个标准步骤是去除“停用词”。停用词是像“the”这样的词，它们在所有文本中如此普遍，以至于不能提供任何见解。如果你看词频的话，<a class="ae lv" href="https://simple.wikipedia.org/wiki/Zipf%27s_law" rel="noopener ugc nofollow" target="_blank"/>几乎总是最常见的一个，但它并不能真正告诉我们什么。这个项目是不同的。因为我寻找的是风格，而不是内容，所以我可以从“the”中学到很多。也许20世纪的诗人比18世纪的诗人更经常使用特定的连词。所以我决定留下停用词。这被证明是一个好的决定，因为去掉它们会损害模型的性能。</p><p id="10e7" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">预处理之后是模型构建阶段。scikit-learn和nltk中有许多现成的建模技术，适用于文本分类项目。在尝试了许多方法并试验了它们的不同参数后，我选定了一个多项式朴素贝叶斯分类器。</p><p id="6736" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">朴素贝叶斯模型之所以被称为朴素贝叶斯模型，是因为它们假设所有特征都是独立的，即使这并不完全正确。通过这样做，他们可以查看每个特征属于每个类的概率。然后，他们将每个观察值分配给其组合特征具有最高概率的类。尽管有天真的假设，但它们通常在文本数据上表现得非常好。</p><p id="cbb3" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">朴素贝叶斯模型获得了82%的总准确率。不同班级的分数有一个有趣的分类。下面是一个混乱矩阵，显示了正确和错误分类的诗歌。</p><figure class="ln lo lp lq gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi nd"><img src="../Images/3ed7db283d625ce7c103fb344f3905d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4NKBYBJoKFKXw1vugx9Ufg.png"/></div></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk">It’s appropriately called a confusion matrix because it can be confusing. A more detailed description below.</figcaption></figure><p id="9774" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">看这个矩阵，看起来18世纪和其他阶级最有区别。该模型正确预测了91%的18世纪诗歌。有趣的是，虽然它确实将一些18世纪的诗歌误归类为19世纪和20世纪，但它没有将任何20世纪的诗歌误归类为属于18世纪。</p><p id="9112" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">这个模型在19世纪和20世纪遇到了更多的麻烦。你可以看到它只正确识别了72%的19世纪诗歌，和81%的20世纪诗歌。夹在另外两个阶级中间的19世纪，给这一模式造成了最大的混乱。时间上更远的几个世纪比中间的几个世纪更容易区分，这肯定是有道理的。</p><p id="d033" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">下面是一些最有可能属于每个世纪的特征。许多单词可能会出现在不止一个类中，这似乎有悖常理。但它确实有意义，因为为了识别类别，模型结合了这首诗中所有单词的概率。但是每个单词对于每个类别都有一个可能性。通过观察某些单词在不同类别中的概率差异，你仍然可以获得一些有趣的见解。当停用词被实际取出时，下面的单词属于每一类的概率最高。即使我把它们留在我的最具预测性的模型中，我还是把它们拿出来放在一个模型中，以便对特定的单词有所了解。看一看:</p><figure class="ln lo lp lq gt is gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/e5f8f26350de8769ed45a6586f25b8a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/format:webp/1*5RRZqPBgPSqPv8HY81m5bA.png"/></div><figcaption class="lr ls gj gh gi lt lu bd b be z dk">Looks like God went out of style!</figcaption></figure><p id="b8b3" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">如果你注意到其他有趣的东西，请在下面留言。</p><h2 id="b73f" class="me mf jb bd mg mh mi dn mj mk ml dp mm kz mn mo mp ld mq mr ms lh mt mu mv mw bi translated">后续步骤:</h2><p id="c2fd" class="pw-post-body-paragraph kq kr jb ks b kt mx kc kv kw my kf ky kz mz lb lc ld na lf lg lh nb lj lk ll ij bi translated">这个项目让我着迷，我会继续探索和发展它。</p><p id="b438" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">下一步是动态主题建模，这是一种提取数据中正在谈论的主题，并观察它们如何随时间变化的方法。请继续关注这方面的新闻。</p><p id="d481" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">在那之后，我计划收集更多的数据，创建额外的功能，并在分类上做出一些深思熟虑的决定。</p><p id="7225" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">Jupyter笔记本和原始诗歌数据可以在我的Github <a class="ae lv" href="https://github.com/chaimgluck/projects/tree/master/Project-poems" rel="noopener ugc nofollow" target="_blank">这里</a>找到。如果你对这些数据有任何创造性的使用，我很乐意听到并贡献出来。</p><p id="a28f" class="pw-post-body-paragraph kq kr jb ks b kt ku kc kv kw kx kf ky kz la lb lc ld le lf lg lh li lj lk ll ij bi translated">有问题吗？评论？喜欢吗？讨厌？在下面留言。</p></div></div>    
</body>
</html>