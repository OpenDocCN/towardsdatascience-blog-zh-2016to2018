# 使用 Python 和 Pyomo 对每周劳动力进行建模和优化

> 原文：<https://towardsdatascience.com/modeling-and-optimization-of-a-weekly-workforce-with-python-and-pyomo-29484ba065bb?source=collection_archive---------5----------------------->

![](img/7c57afd548976f8b23da1adb0d8e408a.png)

Credit: [https://unsplash.com/@rawpixel](https://unsplash.com/@rawpixel?utm_medium=referral&utm_campaign=photographer-credit&utm_content=creditBadge)

使用 Python 和 Pyomo 逐步建模和优化劳动力设计和分配问题。

在本帖中，我们将对一个调度问题进行建模和求解，在这个问题中，工人必须被分配到不同的班次，以优化给定的标准，满足不同的工作条件约束。

当开始一个新项目，计划开一家新商店，甚至准备大学的课程表时，负责任务的人有两种选择:手工求解或建模并作为优化问题求解。

即使有一个优秀的劳动力规划者，使用优化框架来处理这个问题也有很多好处:

*   扩展:问题可能会变得和适当的环境一样大，这可能会超出一个人的能力。
*   不平衡:在很多情况下，员工之间的不平衡是不可避免的。在这种情况下，决定将不是个人的。

## Pyomo 作为优化建模环境

为了解决这个问题，我们将使用 Pyomo，用他们自己的话说，这是一种“基于 Python 的开源优化建模语言，具有多种优化功能”。对于那些已经使用 Python 的人来说，用 Pyomo 建模和解决问题会很简单。

[](http://www.pyomo.org/) [## 主页

### Pyomo 的主页，这是一种用于线性编程的基于 Python 的可扩展开源优化建模语言…

www.pyomo.org](http://www.pyomo.org/) 

Pyomo 允许在各种解决方案中进行选择，包括开源和商业解决方案。此外，用户可以选择在 Neos 服务器上解决问题，这是一个免费的基于互联网的解决方案，可以直接从 Pyomo 使用。这让我们不用在机器上下载和安装不同的解算器，也允许免费使用商业解算器。更多信息在[https://neos-server.org/neos](https://neos-server.org/neos/)。

我已经在我的机器上安装了带有 conda 的 Pyomo，但也可以用 pip 来完成。可以在 http://www.pyomo.org/installation 的[阅读安装说明。](http://www.pyomo.org/installation)

在这篇文章中，我们将利用硬币或项目 Cbc，【https://projects.coin-or.org/Cbc】T4，来解决一个混合整数规划问题。

## 问题描述

大学校园里新开了一家食品店，一周 7 天，一天 24 小时营业。每天有三次八小时轮班。早班为 6 时至 14 时，晚班为 14 时至 22 时，夜班为 22 时至次日 6 时。

晚上只有一个工人，而白天有两个，除了星期天，每班只有一个。每个工人每周最多不超过 40 小时，并且在两班之间必须休息 12 小时。

至于每周的休息日，一个周日休息的员工也会喜欢在周六也休息。

原则上，有 10 名员工可用，这显然超出了规模。需要的工人越少，其他商店的资源就越多。

## 模型组成

为了使用 Pyomo 并解决这个问题，需要导入一些包。

第一步是输入数据，这意味着提供模型，在这种情况下，我们正在考虑的日子，工人，班次…我们不能明确地定义它们，稍后通过使用 *AbstractModel()* 输入数据，但对于这个帖子，继续使用 *ConcreteModel()* ，因此所有数据必须在建模步骤中可用。

我们已经添加了模型所需的所有数据。我们将能够在定义约束时调用这些元素，而不需要手动插入每个元素或考虑 if、else 子句。

为了构建模型，我们需要初始化模型并创建决策变量。

将模型初始化为对象后，将变量、约束和目标函数等元素作为属性添加。正如前面所解释的，我们创建了一个*混凝土模型()*，因为此时数据正在被提供。我们用 *Var()* 变量添加到模型中，用列表索引。

*   works:由工人、天数和班次索引的二元变量。1 如果工人必须在那天轮班工作。
*   需要:由工人索引的二进制变量。1 员工是否必须包括在员工队伍中。
*   no_pref:由 workers 索引的二进制变量。1 如果它在周日不工作，但在周六工作。

定义完所有变量后，我们就可以添加目标函数了。

目标是找到一个最大限度地减少工人数量的时间表，一旦实现了这个目标，也是最大限度地减少在星期天工作但在星期六不工作的工人数量。我们将工人数量部分乘以一个足够大的常数，这样只有在决定了最佳工人数量后，才考虑最小化周末偏好。

我们还需要添加约束，首先创建一个调用 *ConstraintList()* 的约束容器，然后用函数 *add* 将我们想要的任何约束添加到容器中。约束的代码如下，每个约束的解释都是行内注释:

现在，创建的模型可以求解了。一个模型可以用 *model.pprint()* 来可视化。这个问题是由二进制变量组成的，所以一个混合整数规划求解器适合我们的要求，CBC 从 COIN-OR 将被选中，【https://projects.coin-or.org/Cbc】T2。

这需要在本地安装求解器(不要忘记将它添加到路径中，以便 Pyomo 识别它)。然而，在 neos-server 中运行它将我们从这一过程中解放出来。

## 提取溶液

我们这样做是为了得到一个问题的解决方案，所以这是下一步。问题的解决方案是稀疏的，从这个意义上说，我们只是想知道它们中哪些是非零的，为了可视化，我们必须处理给定的解决方案。

我们现在可以检查所获得的解，并验证所有提出的约束条件是否得到满足。以 JSON 格式保存最佳时间表的字典，解决方案如下:

最佳解决方案需要激活 7 个工人。然后，有 7 名工人，他们不满意的人数是 2 (W6，W9)，因为他们在星期天不工作，但在星期六必须工作。观察问题公式，由于周日有 3 个班次，周六有 5 个班次，人们不能期望少于 2 个周六工人在周日不工作。

## 结论

在这篇文章中，我们已经完成了以下目标:

*   解释 Pyomo 作为 Python 中优化建模框架的基础知识。
*   学习如何建立一个特定问题的模型，在这个问题中，劳动力计划者必须在各种限制下优化每周时间表。

这篇文章旨在友好地介绍 Pyomo 的使用和优化问题的建模，因此，解决由于问题的规模或难以制定一个好的模型(是的，建模可以被认为是一门艺术)而导致的更困难的问题可能需要更深入地了解这些主题。

感谢您的阅读。玩得开心！

最新代码可在[https://github . com/ccarballozano/blog-post-codes/tree/master/Modeling-and-optimization-of-weekly-work force-with Python-and-py Omo](https://github.com/ccarballolozano/blog-post-codes/tree/master/Modeling-and-optimization-of-a-weekly-workforce-with-Python-and-Pyomo)获得。