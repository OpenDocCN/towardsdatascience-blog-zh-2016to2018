<html>
<head>
<title>Consistently Beautiful Visualizations with Altair Themes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">与牛郎星主题一致的美丽的可视化</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/consistently-beautiful-visualizations-with-altair-themes-c7f9f889602?source=collection_archive---------6-----------------------#2018-10-06">https://towardsdatascience.com/consistently-beautiful-visualizations-with-altair-themes-c7f9f889602?source=collection_archive---------6-----------------------#2018-10-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/49d1d472c74b65ffb4fe9d54b7228ce8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bimgd0NkkApEbjcf"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">“rainbow frequency” by <a class="ae kc" href="https://unsplash.com/@ripato?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Ricardo Gomez Angel</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="ca7f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你是一个数据可视化爱好者或者也使用<code class="fe lb lc ld le b">python</code>的实践者，你可能听说过 Jake Vanderplas 和 Brian Granger 的<code class="fe lb lc ld le b">altair</code> : <em class="lf">“一个基于 Vega 和 Vega-lite 的用于 Python 的声明性统计可视化库”</em>。</p><blockquote class="lg lh li"><p id="144d" class="kd ke lf kf b kg kh ki kj kk kl km kn lj kp kq kr lk kt ku kv ll kx ky kz la ij bi translated">有了 Altair，你可以花更多的时间去理解你的数据及其意义。Altair 的 API 简单、友好、一致，建立在强大的 Vega-Lite 可视化语法之上。这种优雅的简单性用最少的代码产生了漂亮而有效的可视化效果。</p></blockquote></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><p id="804d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在这篇文章中，我们将深入挖掘<code class="fe lb lc ld le b">altair</code>的一个鲜为人知的特点:主题。</p><h1 id="5d4c" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">什么是<code class="fe lb lc ld le b">altair</code>主题？</h1><p id="1b4e" class="pw-post-body-paragraph kd ke iq kf b kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">在<code class="fe lb lc ld le b">altair</code>中，一个主题是在每个<code class="fe lb lc ld le b">python</code>会话中全局应用的一组图表配置。这意味着您可以始终如一地生成外观相似的可视化效果。</p><h1 id="bea1" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">为什么会有用？</h1><p id="5062" class="pw-post-body-paragraph kd ke iq kf b kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">也许你正在为你的博客开发一种个人风格，也许你所在的公司已经有了一种风格，也许你讨厌网格线，厌倦了每次创建图表时都把它们关掉。当您生成数据可视化时，有一个遵循的样式指南总是有好处的。</p><p id="cf8d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将探讨如何通过重新创建<a class="ae kc" href="http://urbaninstitute.github.io/graphics-styleguide/" rel="noopener ugc nofollow" target="_blank">城市研究所的数据可视化风格指南</a>，在<code class="fe lb lc ld le b">altair</code>中实现一个风格指南，而不是解释你的可视化中风格指南和一致性的价值。</p><h1 id="5585" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated"><code class="fe lb lc ld le b">altair</code>中的主题</h1><p id="40cb" class="pw-post-body-paragraph kd ke iq kf b kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">下面是文档中的一个简单示例:</p><pre class="mw mx my mz gt na le nb nc aw nd bi"><span id="d403" class="ne lu iq le b gy nf ng l nh ni"><strong class="le ir">import</strong> altair <strong class="le ir">as</strong> alt<br/><strong class="le ir">from</strong> vega_datasets <strong class="le ir">import</strong> data</span><span id="83e4" class="ne lu iq le b gy nj ng l nh ni"><em class="lf"># define the theme by returning the dictionary of configurations</em><br/><strong class="le ir">def</strong> black_marks():<br/>    <strong class="le ir">return</strong> {<br/>        'config': {<br/>            'view': {<br/>                'height': 300,<br/>                'width': 400,<br/>            },<br/>            'mark': {<br/>                'color': 'black',<br/>                'fill': 'black'<br/>            }<br/>        }<br/>    }</span><span id="9d8c" class="ne lu iq le b gy nj ng l nh ni"><em class="lf"># register the custom theme under a chosen name</em><br/>alt.themes.register('black_marks', black_marks)</span><span id="ac42" class="ne lu iq le b gy nj ng l nh ni"><em class="lf"># enable the newly registered theme</em><br/>alt.themes.enable('black_marks')</span><span id="edc3" class="ne lu iq le b gy nj ng l nh ni"><em class="lf"># draw the chart</em><br/>cars <strong class="le ir">=</strong> data.cars.url<br/>alt.Chart(cars).mark_point().encode(<br/>    x<strong class="le ir">=</strong>'Horsepower:Q',<br/>    y<strong class="le ir">=</strong>'Miles_per_Gallon:Q'<br/>)</span></pre><p id="0ea9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe lb lc ld le b">height</code>和<code class="fe lb lc ld le b">width</code>仍然与默认主题相同，但是我们现在已经包括了<code class="fe lb lc ld le b">color</code>和<code class="fe lb lc ld le b">fill</code>值，这些值将被全局地<strong class="kf ir"/>(除非另有说明)应用于从此刻起直到<strong class="kf ir">这个</strong> <code class="fe lb lc ld le b">python</code>会话结束为止生成的任何图表。</p><p id="c2e4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这相当于</p><pre class="mw mx my mz gt na le nb nc aw nd bi"><span id="be5e" class="ne lu iq le b gy nf ng l nh ni">alt.Chart(cars).mark_point(color <strong class="le ir">=</strong> 'black', fill <strong class="le ir">=</strong> 'black').encode(<br/>    x<strong class="le ir">=</strong>'Horsepower:Q',<br/>    y<strong class="le ir">=</strong>'Miles_per_Gallon:Q'<br/>)</span></pre><figure class="mw mx my mz gt jr gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/a2ac8f1322fbb7cb772216fe36e9d7dc.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*Wu4cz9Bixqr2iVh5h0lpKw.png"/></div></figure><p id="455c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在返回的<code class="fe lb lc ld le b">black_marks</code> <code class="fe lb lc ld le b">config</code>字典中，您可以看到我们为<code class="fe lb lc ld le b">mark</code>中的键<code class="fe lb lc ld le b">color</code>和<code class="fe lb lc ld le b">fill</code>指定了值<code class="fe lb lc ld le b">black</code>。这是所有这些规范遵循的格式。例如，如果您想要配置左轴标签的字体大小:</p><pre class="mw mx my mz gt na le nb nc aw nd bi"><span id="c4a4" class="ne lu iq le b gy nf ng l nh ni"><strong class="le ir">def</strong> my_theme():<br/>    <strong class="le ir">return</strong> {<br/>        'config': {<br/>            'view': {<br/>                'height': 300,<br/>                'width': 400,<br/>            },<br/>            'mark': {<br/>                'color': 'black',<br/>                'fill': '#000000',<br/>            },<br/>            'axisLeft': {<br/>                'labelFontSize': 30,<br/>            },<br/>        }<br/>    }</span><span id="91d8" class="ne lu iq le b gy nj ng l nh ni"><em class="lf"># register the custom theme under a chosen name</em><br/>alt.themes.register('my_theme', my_theme)</span><span id="cf2f" class="ne lu iq le b gy nj ng l nh ni"><em class="lf"># enable the newly registered theme</em><br/>alt.themes.enable('my_theme')</span></pre><figure class="mw mx my mz gt jr gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/bb20a93d39845a17bba45ee01c4e52d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/1*Z1LULtocEPB_t8G21LOyYQ.png"/></div></figure><p id="78d7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lf">(旁注:可以从</em> <a class="ae kc" href="https://vega.github.io/vega-lite/docs/config.html." rel="noopener ugc nofollow" target="_blank"> <em class="lf"> Vega-Lite 的文档</em> </a>中获取这些 <strong class="kf ir"> <em class="lf">规格</em> </strong> <em class="lf">(即</em> <code class="fe lb lc ld le b"><em class="lf">'axisLeft'</em></code> <em class="lf"/></p><p id="41af" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你或你的公司有你必须遵循的风格指南，这可能特别有用。即使你没有风格指南，你也可以通过在你的个人主题上保存你的配置而不是在你的 viz 代码中开始建立一个风格指南(从长远来看这是值得的！).</p><p id="6367" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Vega 已经在 GitHub 上有了一些<a class="ae kc" href="https://github.com/vega/vega-themes/tree/master/src" rel="noopener ugc nofollow" target="_blank">主题。</a></p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/a80b57f7b7dd64e01ae5aa01c7f07627.png" data-original-src="https://miro.medium.com/v2/resize:fit:934/format:webp/1*kSrMyyGiXRCxHGKSxvM2ig.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk"><strong class="bd nn">fivethirtyeight</strong></figcaption></figure><figure class="mw mx my mz gt jr gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/95f7139c4927f0da653b1b3cac8f1a87.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*hH0W3FmXFcICWTO0YTZgtQ.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk"><strong class="bd nn">excel</strong></figcaption></figure><figure class="mw mx my mz gt jr gh gi paragraph-image"><div class="gh gi no"><img src="../Images/4995f1462a7a9607ec418b8625bc3ae7.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*ZQWuqdQF_KMKZEqSbcd6yA.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk"><strong class="bd nn">ggplot2</strong></figcaption></figure><figure class="mw mx my mz gt jr gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/4efb1a35505ad47b402f6f6b0a2f8683.png" data-original-src="https://miro.medium.com/v2/resize:fit:916/format:webp/1*MQNiv4-khN2soV8Da1UDRw.png"/></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk"><strong class="bd nn">vox</strong></figcaption></figure></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><p id="2c91" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以让我们建立一个<strong class="kf ir"> <em class="lf">简化的</em> </strong>城市学院的<code class="fe lb lc ld le b">altair</code>主题。</p><p id="5a67" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">城市学院风格的这个<strong class="kf ir"> <em class="lf">简化版</em> </strong>的所有信息都可以从他们的 GitHub 页面的这个图中找到。</p><figure class="mw mx my mz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi np"><img src="../Images/6181486925d4f8861de6a575acd12e99.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mS4Pb0pWUaPPbQqGU_ZENw.png"/></div></div></figure><p id="1e32" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这个主题的基本结构如下:</p><pre class="mw mx my mz gt na le nb nc aw nd bi"><span id="bc07" class="ne lu iq le b gy nf ng l nh ni"><strong class="le ir">def</strong> theme_name():</span><span id="1911" class="ne lu iq le b gy nj ng l nh ni"><strong class="le ir">return</strong> {<br/>        "config": { <br/>            "TOP_LEVEL_OBJECT": { <em class="lf"># i.e. "title", "axisX", "legend",</em><br/>                "CONFIGURATION": "VALUE",<br/>                "ANOTHER_ONE": "ANOTHER_VALUE",<br/>                "MAYBE_A_SIZE": 14, <em class="lf"># values can be a string, boolean, or number,</em><br/>            },<br/>            "ANOTHER_OBJECT": {<br/>                "CONFIGURATION": "VALUE",<br/>            }<br/>        }<br/>    }</span></pre><p id="9e8d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将配置顶级对象“<em class="lf">标题</em>”、“<em class="lf"> axisX </em>”、“<em class="lf"> axisY </em>”、“<em class="lf">范围</em>”和“<em class="lf">图例</em>”，以及其他一些一行程序规范。</p><p id="b9f6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在，我们马上看到 Urban 在所有文本上使用“Lato”字体，我们可以将其保存为一个变量，这样我们就不必重复使用它。</p><ol class=""><li id="3cfe" class="nq nr iq kf b kg kh kk kl ko ns ks nt kw nu la nv nw nx ny bi translated"><em class="lf">标题</em></li></ol><p id="27b2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">Urban 的标题大小为<strong class="kf ir"> 18px，Lato 字体，左对齐，黑色。</strong></p><pre class="mw mx my mz gt na le nb nc aw nd bi"><span id="6acb" class="ne lu iq le b gy nf ng l nh ni"><strong class="le ir">def</strong> urban_theme():<br/>    font <strong class="le ir">=</strong> "Lato"</span><span id="e2b0" class="ne lu iq le b gy nj ng l nh ni"><strong class="le ir">return</strong> {<br/>        "config": {<br/>            "title": {<br/>                "fontSize": 18,<br/>                "font": font,<br/>                "anchor": "start", <em class="lf"># equivalent of left-aligned.</em><br/>                "fontColor": "#000000"<br/>            }<br/>        }<br/>    }</span></pre><p id="b79d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此时，你可以<em class="lf">注册</em>和<em class="lf">启用</em>这个主题，并且在这个<code class="fe lb lc ld le b">python</code>会话中你所有的<code class="fe lb lc ld le b">altair</code>图表将会有一个看起来像城市研究所的标题。</p><pre class="mw mx my mz gt na le nb nc aw nd bi"><span id="ddd6" class="ne lu iq le b gy nf ng l nh ni"><em class="lf"># register</em><br/>alt.themes.register("my_custom_theme", urban_theme)<br/><em class="lf"># enable</em><br/>alt.themes.enable("my_custom_theme")</span></pre><h2 id="81f0" class="ne lu iq bd lv nz oa dn lz ob oc dp md ko od oe mh ks of og ml kw oh oi mp oj bi translated">旁注</h2><p id="b6b0" class="pw-post-body-paragraph kd ke iq kf b kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">如果您的计算机中没有安装“Lato”字体，您可以在单元格中运行此代码，暂时将它从 Google Fonts 导入到您的浏览器中。</p><pre class="mw mx my mz gt na le nb nc aw nd bi"><span id="2e82" class="ne lu iq le b gy nf ng l nh ni"><strong class="le ir">%%</strong>html<br/><strong class="le ir">&lt;</strong>style<strong class="le ir">&gt;</strong><br/>@<strong class="le ir">import</strong> url('https://fonts.googleapis.com/css?family=Lato');<br/><strong class="le ir">&lt;/</strong>style<strong class="le ir">&gt;</strong></span></pre><ol class=""><li id="b80d" class="nq nr iq kf b kg kh kk kl ko ns ks nt kw nu la nv nw nx ny bi translated"><em class="lf"> axisX </em>和<em class="lf"> axisY </em></li></ol><p id="b205" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在市区，X 轴和 Y 轴略有不同。x 轴有一条在<code class="fe lb lc ld le b">altair</code>被称为<em class="lf">域</em>的线，这条线穿过轴。y 轴没有这个(类似于<code class="fe lb lc ld le b">seaborn</code>的<code class="fe lb lc ld le b">sns.despine()</code>)。y 轴有网格线，X 轴没有。x 轴有刻度，Y 轴没有。但两者都有同样大小的标签和标题。</p><pre class="mw mx my mz gt na le nb nc aw nd bi"><span id="597a" class="ne lu iq le b gy nf ng l nh ni"><strong class="le ir">def</strong> urban_theme():<br/>    <em class="lf"># Typography</em><br/>    font <strong class="le ir">=</strong> "Lato"<br/>    <em class="lf"># At Urban it's the same font for all text but it's good to keep them separate in case you want to change one later.</em><br/>    labelFont <strong class="le ir">=</strong> "Lato" <br/>    sourceFont <strong class="le ir">=</strong> "Lato"</span><span id="5519" class="ne lu iq le b gy nj ng l nh ni"><em class="lf">    # Axes</em><br/>    axisColor <strong class="le ir">=</strong> "#000000"<br/>    gridColor <strong class="le ir">=</strong> "#DEDDDD"</span><span id="fbf6" class="ne lu iq le b gy nj ng l nh ni"><strong class="le ir">return</strong> {<br/>        "config": {<br/>            "title": {<br/>                "fontSize": 18,<br/>                "font": font,<br/>                "anchor": "start", <em class="lf"># equivalent of left-aligned.</em><br/>                "fontColor": "#000000"<br/>            },<br/>            "axisX": {<br/>                "domain": <strong class="le ir">True</strong>,<br/>                "domainColor": axisColor,<br/>                "domainWidth": 1,<br/>                "grid": <strong class="le ir">False</strong>,<br/>                "labelFont": labelFont,<br/>                "labelFontSize": 12,<br/>                "labelAngle": 0, <br/>                "tickColor": axisColor,<br/>                "tickSize": 5, <em class="lf"># default, including it just to show you can change it</em><br/>                "titleFont": font,<br/>                "titleFontSize": 12,<br/>                "titlePadding": 10, <em class="lf"># guessing, not specified in styleguide</em><br/>                "title": "X Axis Title (units)", <br/>            },<br/>            "axisY": {<br/>                "domain": <strong class="le ir">False</strong>,<br/>                "grid": <strong class="le ir">True</strong>,<br/>                "gridColor": gridColor,<br/>                "gridWidth": 1,<br/>                "labelFont": labelFont,<br/>                "labelFontSize": 12,<br/>                "labelAngle": 0, <br/>                "ticks": <strong class="le ir">False</strong>, <em class="lf"># even if you don't have a "domain" you need to turn these off.</em><br/>                "titleFont": font,<br/>                "titleFontSize": 12,<br/>                "titlePadding": 10, <em class="lf"># guessing, not specified in styleguide</em><br/>                "title": "Y Axis Title (units)", <br/>                <em class="lf"># titles are by default vertical left of axis so we need to hack this </em><br/>                "titleAngle": 0, <em class="lf"># horizontal</em><br/>                "titleY": <strong class="le ir">-</strong>10, <em class="lf"># move it up</em><br/>                "titleX": 18, <em class="lf"># move it to the right so it aligns with the labels </em><br/>            },</span><span id="c3b7" class="ne lu iq le b gy nj ng l nh ni">}<br/>    }</span></pre><p id="f3ce" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果你<em class="lf">注册</em> ed 并且<em class="lf">启用</em> d 这个主题，你会得到一个看起来有点像城市研究所图表的东西。但是让你马上知道你正在看一个城市研究所的数据可视化的是颜色。</p><p id="e46a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe lb lc ld le b">altair</code>中，你有<code class="fe lb lc ld le b">scales</code>与<code class="fe lb lc ld le b">domain</code>和<code class="fe lb lc ld le b">range</code>。这些是"<em class="lf">函数，将数据域中的值(数字、日期、字符串等)转换为编码通道的可视值(像素、颜色、大小)。因此，如果你想添加一个默认的配色方案，你所要做的就是在你的主题中编码顶层对象<code class="fe lb lc ld le b">"range"</code>的值。</em></p><p id="9fd0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将这些值保存为列表<code class="fe lb lc ld le b">main_palette</code>和<code class="fe lb lc ld le b">sequential_palette</code>。城市研究所的数据可视化风格指南有很多颜色组合。我们将这两个编码为默认值，但是当涉及到颜色时，您很可能会在移动中修改您的数据可视化。</p><pre class="mw mx my mz gt na le nb nc aw nd bi"><span id="fb93" class="ne lu iq le b gy nf ng l nh ni"><strong class="le ir">def</strong> urban_theme():<br/>    <em class="lf"># Typography</em><br/>    font <strong class="le ir">=</strong> "Lato"<br/>    <em class="lf"># At Urban it's the same font for all text but it's good to keep them separate in case you want to change one later.</em><br/>    labelFont <strong class="le ir">=</strong> "Lato" <br/>    sourceFont <strong class="le ir">=</strong> "Lato"</span><span id="0da3" class="ne lu iq le b gy nj ng l nh ni"><em class="lf">    # Axes</em><br/>    axisColor <strong class="le ir">=</strong> "#000000"<br/>    gridColor <strong class="le ir">=</strong> "#DEDDDD"</span><span id="6f73" class="ne lu iq le b gy nj ng l nh ni"><em class="lf">    # Colors</em><br/>    main_palette <strong class="le ir">=</strong> ["#1696d2", <br/>                    "#d2d2d2",<br/>                    "#000000", <br/>                    "#fdbf11", <br/>                    "#ec008b", <br/>                    "#55b748", <br/>                    "#5c5859", <br/>                    "#db2b27", <br/>                   ]<br/>    sequential_palette <strong class="le ir">=</strong> ["#cfe8f3", <br/>                          "#a2d4ec", <br/>                          "#73bfe2", <br/>                          "#46abdb", <br/>                          "#1696d2", <br/>                          "#12719e", <br/>                         ]</span><span id="396d" class="ne lu iq le b gy nj ng l nh ni"><strong class="le ir">return</strong> {<br/>        "config": {<br/>            "title": {<br/>                "fontSize": 18,<br/>                "font": font,<br/>                "anchor": "start", <em class="lf"># equivalent of left-aligned.</em><br/>                "fontColor": "#000000"<br/>            },<br/>            "axisX": {<br/>                "domain": <strong class="le ir">True</strong>,<br/>                "domainColor": axisColor,<br/>                "domainWidth": 1,<br/>                "grid": <strong class="le ir">False</strong>,<br/>                "labelFont": labelFont,<br/>                "labelFontSize": 12,<br/>                "labelAngle": 0, <br/>                "tickColor": axisColor,<br/>                "tickSize": 5, <em class="lf"># default, including it just to show you can change it</em><br/>                "titleFont": font,<br/>                "titleFontSize": 12,<br/>                "titlePadding": 10, <em class="lf"># guessing, not specified in styleguide</em><br/>                "title": "X Axis Title (units)", <br/>            },<br/>            "axisY": {<br/>                "domain": <strong class="le ir">False</strong>,<br/>                "grid": <strong class="le ir">True</strong>,<br/>                "gridColor": gridColor,<br/>                "gridWidth": 1,<br/>                "labelFont": labelFont,<br/>                "labelFontSize": 12,<br/>                "labelAngle": 0, <br/>                "ticks": <strong class="le ir">False</strong>, <em class="lf"># even if you don't have a "domain" you need to turn these off.</em><br/>                "titleFont": font,<br/>                "titleFontSize": 12,<br/>                "titlePadding": 10, <em class="lf"># guessing, not specified in styleguide</em><br/>                "title": "Y Axis Title (units)", <br/>                <em class="lf"># titles are by default vertical left of axis so we need to hack this </em><br/>                "titleAngle": 0, <em class="lf"># horizontal</em><br/>                "titleY": <strong class="le ir">-</strong>10, <em class="lf"># move it up</em><br/>                "titleX": 18, <em class="lf"># move it to the right so it aligns with the labels </em><br/>            },<br/>            "range": {<br/>                "category": main_palette,<br/>                "diverging": sequential_palette,<br/>            }</span><span id="4459" class="ne lu iq le b gy nj ng l nh ni">}<br/>    }</span></pre><p id="a6c4" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此时，默认情况下，您的主题将具有城市研究所的标题、轴和颜色配置。很酷，但这不是你能做的全部。</p><p id="f957" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">让我们添加一个默认的图例配置。这一次我们将稍微偏离样式指南，因为图例的位置取决于手边的图表(在 Vega-lite 中不能有水平图例)。</p><p id="9073" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">该代码还包括“<em class="lf">视图</em>”和“<em class="lf">背景</em>”配置，无需过多解释，简单易懂。还包括“<em class="lf">区域</em>”、“<em class="lf">线</em>”、“<em class="lf">轨迹</em>”、“<em class="lf">条</em>”、“<em class="lf">点</em>”等标识的配置。这只是为每个特定的标记设置正确的颜色。</p><pre class="mw mx my mz gt na le nb nc aw nd bi"><span id="f576" class="ne lu iq le b gy nf ng l nh ni"><strong class="le ir">def</strong> urban_theme():<br/>    <em class="lf"># Typography</em><br/>    font <strong class="le ir">=</strong> "Lato"<br/>    <em class="lf"># At Urban it's the same font for all text but it's good to keep them separate in case you want to change one later.</em><br/>    labelFont <strong class="le ir">=</strong> "Lato" <br/>    sourceFont <strong class="le ir">=</strong> "Lato"</span><span id="1f9d" class="ne lu iq le b gy nj ng l nh ni"><em class="lf">    # Axes</em><br/>    axisColor <strong class="le ir">=</strong> "#000000"<br/>    gridColor <strong class="le ir">=</strong> "#DEDDDD"</span><span id="ced6" class="ne lu iq le b gy nj ng l nh ni"><em class="lf">    # Colors</em><br/>    main_palette <strong class="le ir">=</strong> ["#1696d2", <br/>                    "#d2d2d2",<br/>                    "#000000", <br/>                    "#fdbf11", <br/>                    "#ec008b", <br/>                    "#55b748", <br/>                    "#5c5859", <br/>                    "#db2b27", <br/>                   ]<br/>    sequential_palette <strong class="le ir">=</strong> ["#cfe8f3", <br/>                          "#a2d4ec", <br/>                          "#73bfe2", <br/>                          "#46abdb", <br/>                          "#1696d2", <br/>                          "#12719e", <br/>                         ]</span><span id="10ac" class="ne lu iq le b gy nj ng l nh ni"><strong class="le ir">return</strong> {<br/>        <em class="lf"># width and height are configured outside the config dict because they are Chart configurations/properties not chart-elements' configurations/properties.</em><br/>        "width": 685, <em class="lf"># from the guide</em><br/>        "height": 380, <em class="lf"># not in the guide</em><br/>        "config": {<br/>            "title": {<br/>                "fontSize": 18,<br/>                "font": font,<br/>                "anchor": "start", <em class="lf"># equivalent of left-aligned.</em><br/>                "fontColor": "#000000"<br/>            },<br/>            "axisX": {<br/>                "domain": <strong class="le ir">True</strong>,<br/>                "domainColor": axisColor,<br/>                "domainWidth": 1,<br/>                "grid": <strong class="le ir">False</strong>,<br/>                "labelFont": labelFont,<br/>                "labelFontSize": 12,<br/>                "labelAngle": 0, <br/>                "tickColor": axisColor,<br/>                "tickSize": 5, <em class="lf"># default, including it just to show you can change it</em><br/>                "titleFont": font,<br/>                "titleFontSize": 12,<br/>                "titlePadding": 10, <em class="lf"># guessing, not specified in styleguide</em><br/>                "title": "X Axis Title (units)", <br/>            },<br/>            "axisY": {<br/>                "domain": <strong class="le ir">False</strong>,<br/>                "grid": <strong class="le ir">True</strong>,<br/>                "gridColor": gridColor,<br/>                "gridWidth": 1,<br/>                "labelFont": labelFont,<br/>                "labelFontSize": 12,<br/>                "labelAngle": 0, <br/>                "ticks": <strong class="le ir">False</strong>, <em class="lf"># even if you don't have a "domain" you need to turn these off.</em><br/>                "titleFont": font,<br/>                "titleFontSize": 12,<br/>                "titlePadding": 10, <em class="lf"># guessing, not specified in styleguide</em><br/>                "title": "Y Axis Title (units)", <br/>                <em class="lf"># titles are by default vertical left of axis so we need to hack this </em><br/>                "titleAngle": 0, <em class="lf"># horizontal</em><br/>                "titleY": <strong class="le ir">-</strong>10, <em class="lf"># move it up</em><br/>                "titleX": 18, <em class="lf"># move it to the right so it aligns with the labels </em><br/>            },<br/>            "range": {<br/>                "category": main_palette,<br/>                "diverging": sequential_palette,<br/>            },<br/>            "legend": {<br/>                "labelFont": labelFont,<br/>                "labelFontSize": 12,<br/>                "symbolType": "square", <em class="lf"># just 'cause</em><br/>                "symbolSize": 100, <em class="lf"># default</em><br/>                "titleFont": font,<br/>                "titleFontSize": 12,<br/>                "title": "", <em class="lf"># set it to no-title by default</em><br/>                "orient": "top-left", <em class="lf"># so it's right next to the y-axis</em><br/>                "offset": 0, <em class="lf"># literally right next to the y-axis.</em><br/>            },<br/>            "view": {<br/>                "stroke": "transparent", <em class="lf"># altair uses gridlines to box the area where the data is visualized. This takes that off.</em><br/>            },<br/>            "background": {<br/>                "color": "#FFFFFF", <em class="lf"># white rather than transparent</em><br/>            },<br/>            <em class="lf">### MARKS CONFIGURATIONS ###</em><br/>            "area": {<br/>               "fill": markColor,<br/>           },<br/>           "line": {<br/>               "color": markColor,<br/>               "stroke": markColor,<br/>               "strokeWidth": 5,<br/>           },<br/>           "trail": {<br/>               "color": markColor,<br/>               "stroke": markColor,<br/>               "strokeWidth": 0,<br/>               "size": 1,<br/>           },<br/>           "path": {<br/>               "stroke": markColor,<br/>               "strokeWidth": 0.5,<br/>           },<br/>           "point": {<br/>               "filled": <strong class="le ir">True</strong>,<br/>           },<br/>           "text": {<br/>               "font": sourceFont,<br/>               "color": markColor,<br/>               "fontSize": 11,<br/>               "align": "right",<br/>               "fontWeight": 400,<br/>               "size": 11,<br/>           }, <br/>           "bar": {<br/>                "size": 40,<br/>                "binSpacing": 1,<br/>                "continuousBandSize": 30,<br/>                "discreteBandSize": 30,<br/>                "fill": markColor,<br/>                "stroke": <strong class="le ir">False</strong>,<br/>            },</span><span id="3670" class="ne lu iq le b gy nj ng l nh ni">}<br/>    }</span></pre><h2 id="8afb" class="ne lu iq bd lv nz oa dn lz ob oc dp md ko od oe mh ks of og ml kw oh oi mp oj bi translated">边注</h2><p id="4b3c" class="pw-post-body-paragraph kd ke iq kf b kg mr ki kj kk ms km kn ko mt kq kr ks mu ku kv kw mv ky kz la ij bi translated">我个人将这些主题保存在一个<code class="fe lb lc ld le b">.py</code>脚本中</p><pre class="mw mx my mz gt na le nb nc aw nd bi"><span id="c9f6" class="ne lu iq le b gy nf ng l nh ni"><strong class="le ir">import</strong> altair <strong class="le ir">as</strong> alt<br/>alt.themes.register("my_custom_theme", urban_theme)<br/>alt.themes.enable("my_custom_theme")</span></pre><p id="bf16" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我的笔记本上。</p></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><p id="d9df" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以下是用该主题创建的一些图表示例。</p><h2 id="ab0d" class="ne lu iq bd lv nz oa dn lz ob oc dp md ko od oe mh ks of og ml kw oh oi mp oj bi translated">条形图</h2><figure class="mw mx my mz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ok"><img src="../Images/2b87623d0fee0aa46389047b76bda620.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J2lR-fDHQIweEW8woKzvKQ.png"/></div></div></figure><h2 id="aaa8" class="ne lu iq bd lv nz oa dn lz ob oc dp md ko od oe mh ks of og ml kw oh oi mp oj bi translated">面积图(分类)</h2><figure class="mw mx my mz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ok"><img src="../Images/31bb337d9fa18d45972a4c98985d3133.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U7E82gy8orQ9CrovbmdG1w.png"/></div></div></figure><h2 id="97b3" class="ne lu iq bd lv nz oa dn lz ob oc dp md ko od oe mh ks of og ml kw oh oi mp oj bi translated">面积图(顺序)</h2><figure class="mw mx my mz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ok"><img src="../Images/dc0c26defcc333ce1f4101e2902e5b23.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Awdq_0cscDJmULHzR42V2A.png"/></div></div></figure><h2 id="0443" class="ne lu iq bd lv nz oa dn lz ob oc dp md ko od oe mh ks of og ml kw oh oi mp oj bi translated">折线图</h2><figure class="mw mx my mz gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ol"><img src="../Images/ed3182b323c02a91f28af8fb1c727865.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kBE2VZcM2vU3OJSZyN4H6w.png"/></div></div></figure></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><p id="8c67" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有很多方法来配置你的主题，我鼓励你尝试很多不同的东西。你可以把我们刚刚整理好的主题和价值观结合起来。使用不同的字体，字体大小，配色方案。有网格线，没有网格线。给你的斧子贴上非常非常大的标签。做你想做的事情，但是把它保存在某个地方，这样你就可以在它的基础上发展你的个人风格。</p><p id="753b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然你可能想在<code class="fe lb lc ld le b"><a class="ae kc" href="http://altair-viz.github.io" rel="noopener ugc nofollow" target="_blank">altair</a></code> <a class="ae kc" href="http://altair-viz.github.io" rel="noopener ugc nofollow" target="_blank">文档</a>中查找更多这方面的信息，但我发现使用<a class="ae kc" href="https://vega.github.io/vega-lite/docs/config.html" rel="noopener ugc nofollow" target="_blank"> Vega-lite </a>文档更好。毕竟，<code class="fe lb lc ld le b">altair</code>是 Vega-lite 的 python-wrapper。</p></div><div class="ab cl lm ln hu lo" role="separator"><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr ls"/><span class="lp bw bk lq lr"/></div><div class="ij ik il im in"><p id="2587" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所有的图片和代码都可以在这个<a class="ae kc" href="https://github.com/Chekos/altair_themes_blog" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>中找到。</p><p id="54c6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有什么意见，问题，建议吗？<a class="ae kc" href="http://twitter.com/ChekosWH" rel="noopener ugc nofollow" target="_blank">我在 twitter </a>、<a class="ae kc" href="http://www.linkedin.com/in/chekos" rel="noopener ugc nofollow" target="_blank"> linkedin </a>和<a class="ae kc" href="http://instagram.com/chekos.visuals" rel="noopener ugc nofollow" target="_blank"> Instagram </a>。</p></div></div>    
</body>
</html>