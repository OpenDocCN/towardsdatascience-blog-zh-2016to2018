<html>
<head>
<title>The Mystery of the Origin — Cancer Type Classification using Fast.AI Library</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">起源之谜——利用 Fast 进行癌症类型分类。人工智能图书馆</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-mystery-of-the-origin-cancer-type-classification-using-fast-ai-libray-212eaf8d3f4e?source=collection_archive---------7-----------------------#2018-10-30">https://towardsdatascience.com/the-mystery-of-the-origin-cancer-type-classification-using-fast-ai-libray-212eaf8d3f4e?source=collection_archive---------7-----------------------#2018-10-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/736c0edf59d6ca1ead24f9e7ecd1f3af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GVK0FEX86Laqm6L_l-63dg.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">tree without its roots</figcaption></figure><h1 id="a91d" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">第一章。问题——没有根的树</h1><p id="de4b" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">大约 15%的癌症转移，<em class="ly">即</em>癌细胞从它们最初形成的地方(原发部位或起源组织)脱离，并通过血液或淋巴系统形成新的转移性肿瘤。确定转移肿瘤<a class="ae lz" href="https://www.cancercenter.com/terms/metastasis/" rel="noopener ugc nofollow" target="_blank"><strong class="lc ir"/></a>的原发部位是癌症治疗中的公开问题之一，因为治疗的功效通常取决于癌症原发部位。</p><p id="39a7" class="pw-post-body-paragraph la lb iq lc b ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt me lv lw lx ij bi translated">使用肿瘤中的<a class="ae lz" href="https://en.wikipedia.org/wiki/Point_mutation" rel="noopener ugc nofollow" target="_blank"> <strong class="lc ir">点突变</strong> </a>进行癌症分类具有挑战性，主要是因为数据非常稀少。许多肿瘤在编码区只有少数突变，而且许多突变是独特的。</p><p id="4bb3" class="pw-post-body-paragraph la lb iq lc b ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt me lv lw lx ij bi translated">先前已经证明，依赖于肿瘤中点突变的分类器实现了有限的准确性，特别是在 12 个肿瘤类别上<strong class="lc ir"> 64.9%，例如<a class="ae lz" href="https://github.com/yuanyc06/deepgene" rel="noopener ugc nofollow" target="_blank"> <strong class="lc ir"> DeepGene </strong> </a>算法。依靠<strong class="lc ir">基因表达数据</strong>的可用性，可以大大提高肿瘤分类的准确率(33 个肿瘤类别</strong><a class="ae lz" href="https://bmcgenomics.biomedcentral.com/articles/10.1186/s12864-017-3906-0" rel="noopener ugc nofollow" target="_blank">~ 90%)。然而，这些额外的数据在临床环境中通常不容易获得。因此，能够仅从 DNA 点突变预测肿瘤类别而不依赖于额外的基因表达数据的精确计算方法是非常令人感兴趣的。</a></p><h1 id="4041" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">第二章。解决方案=嵌入+迁移学习和微调</h1><p id="9fa2" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">那么解决办法是什么呢？</p><p id="d2a3" class="pw-post-body-paragraph la lb iq lc b ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt me lv lw lx ij bi translated">正如量子理论物理学家<a class="ae lz" href="https://www.brainyquote.com/quotes/niels_bohr_390862?src=t_solution" rel="noopener ugc nofollow" target="_blank"> <strong class="lc ir">尼尔斯·玻尔</strong> </a>所指出的那样:<strong class="lc ir"> <em class="ly">“每一个巨大而深刻的困难本身都有它自己的解决方案。”为了找到它，它迫使我们改变思维。</em> </strong></p><p id="f3d5" class="pw-post-body-paragraph la lb iq lc b ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt me lv lw lx ij bi translated">让我们检查一下我们面临的困难:</p><ol class=""><li id="b7f9" class="mf mg iq lc b ld ma lh mb ll mh lp mi lt mj lx mk ml mm mn bi translated"><strong class="lc ir">数据的表示</strong> —当前的数据表示不允许我们使用预训练的深度神经网络，这些网络在图像数据集上表现非常好。不幸的是，在癌症基因组应用领域，训练数据很少，并且诸如数据扩充的方法不适用。从<a class="ae lz" href="https://cancergenome.nih.gov/" rel="noopener ugc nofollow" target="_blank">癌症基因组图谱(TCGA) </a>可获得 9642 个样本，分布在 29 个类别。</li><li id="375f" class="mf mg iq lc b ld mo lh mp ll mq lp mr lt ms lx mk ml mm mn bi translated"><strong class="lc ir">即使在基因水平上总结，肿瘤点突变数据也很少</strong>。来自癌症生物学的一个有趣观察是，属于同一<a class="ae lz" href="https://en.wikipedia.org/wiki/Biological_pathway" rel="noopener ugc nofollow" target="_blank">途径</a>的基因中的癌症突变通常是互斥的。下面是癌症中受影响的“标志性”过程(途径)的一个例子。路径以蓝色列出；图片摘自<a class="ae lz" href="https://linkinghub.elsevier.com/retrieve/pii/S0092867400816839" rel="noopener ugc nofollow" target="_blank">本文</a>。</li></ol><figure class="mu mv mw mx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mt"><img src="../Images/3212b8e5c272e0a0bc4e45942f820a66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fb4vhxDrko_QW3DFtoJg5Q.png"/></div></div></figure><p id="73d8" class="pw-post-body-paragraph la lb iq lc b ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt me lv lw lx ij bi translated">那么，为什么<strong class="lc ir">不用途径</strong>编码点突变数据，但是怎么编码呢？使用来自通路中<strong class="lc ir">基因成员的信息来训练我们自己的<strong class="lc ir">基因 2Vec 编码</strong>怎么样？</strong></p><p id="ae22" class="pw-post-body-paragraph la lb iq lc b ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt me lv lw lx ij bi translated">这里有一个预览，它在不阅读细节的情况下工作得有多好— <strong class="lc ir">仅依靠 DNA 点突变对 29 种肿瘤分类的准确率为 78.2%</strong>。</p><h1 id="bfb7" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">第三章。循序渐进的“如何做”</h1><p id="e30f" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated"><strong class="lc ir"> 3.1 数据及其预处理:</strong>我从<a class="ae lz" href="https://portal.gdc.cancer.gov/" rel="noopener ugc nofollow" target="_blank">基因组数据共享门户</a>下载了 TCGA 突变注释格式(MAF)文件。我去除了沉默突变，只保留了带有智人基因组组装 GRCh38 (hg38)注释的基因。数据集被分成 29 种肿瘤类型，每种类型中 80%的样本用于训练，20%用于测试。</p><p id="6815" class="pw-post-body-paragraph la lb iq lc b ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt me lv lw lx ij bi translated"><a class="ae lz" href="http://software.broadinstitute.org/cancer/software/genepattern/modules/docs/MutSigCV" rel="noopener ugc nofollow" target="_blank"> MutSigCV </a>用于识别在每个肿瘤类型训练集中检测到的<a class="ae lz" href="https://en.wikipedia.org/wiki/Mutation" rel="noopener ugc nofollow" target="_blank">非沉默突变</a>中的显著突变基因。这让我能够提取非常稀疏的数据集的重要特征。考虑到包括给定基因的碱基组成、长度和背景突变率在内的协变量，MuTSigCV 检测突变发生率高于随机预期的基因。我只剩下<strong class="lc ir">1348 个独特的显著突变基因</strong>。</p><p id="d227" class="pw-post-body-paragraph la lb iq lc b ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt me lv lw lx ij bi translated">为了学习数据的生物学相关嵌入，我训练了<strong class="lc ir"> Gene2Vec </strong>嵌入。我使用了所有已知途径的数据库，<a class="ae lz" href="http://software.broadinstitute.org/gsea/msigdb/index.jsp" rel="noopener ugc nofollow" target="_blank">MSI gdb</a>6.2 版，包含 17810 个途径。本着<a class="ae lz" href="https://papers.nips.cc/paper/5021-distributed-representations-of-words-and-phrases-and-their-compositionality.pdf" rel="noopener ugc nofollow" target="_blank"> Word2Vec </a>的精神，我将路径相似的基因映射到附近的点上。在这里，我假设出现在相同途径环境中的基因共享生物功能。我在定义 Gene2Vec 时使用了标准的<a class="ae lz" href="https://papers.nips.cc/paper/5021-distributed-representations-of-words-and-phrases-and-their-compositionality.pdf" rel="noopener ugc nofollow" target="_blank"> Skip-Gram </a>模型。</p><figure class="mu mv mw mx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi my"><img src="../Images/195558a43b38e2327206caea7cc736cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gFhburrx4iJF0xj8Hz2MCQ.png"/></div></div></figure><p id="515c" class="pw-post-body-paragraph la lb iq lc b ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt me lv lw lx ij bi translated"><strong class="lc ir"> 3.2 突变数据到图像的转换:</strong> <br/>然后我提取学习过的基因 2Vec 嵌入我们训练集中的 1348 个明显突变的基因，这一步产生了一个方阵。我使用<a class="ae lz" href="http://www1.icsi.berkeley.edu/~stellayu/publication/doc/2003kwayICCV.pdf" rel="noopener ugc nofollow" target="_blank">谱聚类算法</a>在嵌入矩阵中创建视觉结构。谱聚类是一种将一维空间中的 N 个数据点分成几个簇的技术。然后使用光谱聚类基因嵌入对训练和测试样本进行编码。左图是胃癌样本的包埋示例。下图是 1348 个显著突变基因的 t 分布随机邻近嵌入(<a class="ae lz" href="https://lvdmaaten.github.io/tsne/" rel="noopener ugc nofollow" target="_blank"> t-SNE </a>)基因嵌入可视化。参与相同癌症途径的基因在它们的表达中彼此更接近，例如 KRAS 和 PTEN(结肠直肠癌)；TP53、APC 和 MSH6 (DNA 错配修复)比其他基因靠得更近。</p><figure class="mu mv mw mx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mz"><img src="../Images/49e5436a3161a390bfec574bb1a8a87b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zmI35pyLmkefmm4TbPncdw.png"/></div></div></figure><p id="448a" class="pw-post-body-paragraph la lb iq lc b ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt me lv lw lx ij bi translated"><strong class="lc ir"> 3.3 迁移学习和微调— </strong> <a class="ae lz" href="https://www.fast.ai/" rel="noopener ugc nofollow" target="_blank"> <strong class="lc ir">快速。AI </strong> </a> <strong class="lc ir"> : </strong> <br/>我使用<a class="ae lz" href="https://arxiv.org/abs/1512.03385" rel="noopener ugc nofollow" target="_blank"> ResNet34 </a>模型在<a class="ae lz" href="https://en.wikipedia.org/wiki/ImageNet" rel="noopener ugc nofollow" target="_blank"> ImageNet </a>上预先训练好的权重作为使用我们的肿瘤图像嵌入进行肿瘤分类的目标任务的初始化。图像被重新缩放到 512x512，并被归一化以匹配 ImageNet 图像的平均值和标准偏差，批量大小被设置为 32 以适合我的 GTX 1070 Ti GPU。</p><p id="5608" class="pw-post-body-paragraph la lb iq lc b ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt me lv lw lx ij bi translated">在微调的第一阶段，<a class="ae lz" href="https://arxiv.org/abs/1512.03385" rel="noopener ugc nofollow" target="_blank"> ResNet34 </a>除了最后一个自定义全连接层外，其他层都被冻结。使用学习率查找器将学习率选择为 0.01，参见<a class="ae lz" href="https://arxiv.org/abs/1506.01186" rel="noopener ugc nofollow" target="_blank"> Leslie Smith 的论文</a>及其在<a class="ae lz" href="https://github.com/fastai/fastai" rel="noopener ugc nofollow" target="_blank"> Fast 中的实现。AI 回购</a>。<a class="ae lz" href="https://arxiv.org/pdf/1801.06146.pdf" rel="noopener ugc nofollow" target="_blank">倾斜三角形学习率训练计划</a>用于 10 个周期。第一阶段达到的精度为<strong class="lc ir"> 73.2% </strong>。</p><p id="e37a" class="pw-post-body-paragraph la lb iq lc b ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt me lv lw lx ij bi translated">在第二阶段，<a class="ae lz" href="https://arxiv.org/pdf/1801.06146.pdf" rel="noopener ugc nofollow" target="_blank">区别微调</a>使用 0.000001 至 0.001 的学习率序列，这些也是使用学习率查找器确定的。区别性微调将深度神经网络的层分成组，并对每个组应用不同的学习率，因为不同的层应该被微调到不同的程度；最早的残差块最小，全连通层的学习率最大。在第二阶段的训练中，我使用了 12 个周期的倾斜三角形学习率训练计划。第一阶段达到的准确度为<strong class="lc ir"> 78.3% </strong>。</p><p id="4943" class="pw-post-body-paragraph la lb iq lc b ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt me lv lw lx ij bi translated">这是我们分类器的混淆矩阵:</p><figure class="mu mv mw mx gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi na"><img src="../Images/35d454aabbf118cc5719c1c4ff9463af.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yfpz2ePTKJ2neyCftb5N-Q.png"/></div></div></figure><h1 id="58b1" class="kc kd iq bd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz bi translated">第四章。一些观察</h1><p id="4b16" class="pw-post-body-paragraph la lb iq lc b ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ij bi translated">我观察到我们的错误分类主要在相同的器官系统内，<em class="ly">例如</em>卵巢浆液性囊腺癌(OV)和乳腺癌(BRCA)。</p><p id="5b00" class="pw-post-body-paragraph la lb iq lc b ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt me lv lw lx ij bi translated">我还观察到卵巢浆液性囊腺癌(OV)是错误最多的一类。这实际上并不令人惊讶，因为与其他群组的大量基因相比，在该群组中只有 6 个基因被确定为显著突变。</p><p id="4f7c" class="pw-post-body-paragraph la lb iq lc b ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt me lv lw lx ij bi translated">但是我最重要的观察是<strong class="lc ir">快。AI 库允许最先进的迁移学习和微调</strong>。给定数据的正确表示，构建最先进的分类器变得非常容易:在这里，我将这个问题<strong class="lc ir">的先前最先进的错误减少了 30%以上</strong>，而<strong class="lc ir"> </strong>同时区分了更多的类。<strong class="lc ir">谢谢杰里米、雷切尔和 Fast。艾！</strong></p><p id="0890" class="pw-post-body-paragraph la lb iq lc b ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt me lv lw lx ij bi translated">我真的很期待表演更多的<strong class="lc ir"> <em class="ly">【知识转移】从 Jeremy 和 Rachel </em> </strong>到我自己<strong class="lc ir"> (:-) </strong>，<strong class="lc ir">有区别地微调</strong>我在其他重要和有趣的问题上所学的 hack！</p><p id="02f7" class="pw-post-body-paragraph la lb iq lc b ld ma lf lg lh mb lj lk ll mc ln lo lp md lr ls lt me lv lw lx ij bi translated">如果您对上述内容有任何疑问<strong class="lc ir">请在 twitter @alenushka 上找到我</strong></p></div></div>    
</body>
</html>