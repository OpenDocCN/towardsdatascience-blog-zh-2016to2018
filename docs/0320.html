<html>
<head>
<title>Predicting house value using regression analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用回归分析预测房价</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/regression-analysis-model-used-in-machine-learning-318f7656108a?source=collection_archive---------1-----------------------#2017-04-17">https://towardsdatascience.com/regression-analysis-model-used-in-machine-learning-318f7656108a?source=collection_archive---------1-----------------------#2017-04-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="f85f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">机器学习模型</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/9a3e503313454fee0fe6cf9fa83743c1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Yl2LZkV5TbCk_Phi_UYfFw.jpeg"/></div></div></figure><h1 id="bd27" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">介绍</h1><p id="0754" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">回归分析是数据统计分析的基本方法。这是一种统计方法，允许估计变量之间的关系。人们需要确定因变量，它将根据自变量的值而变化。例如，房子的价值(因变量)根据房子的平方英尺(自变量)而变化。回归分析是预测分析中非常有用的工具。</p><p id="6fd3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ma">E</em>(<em class="ma">Y</em>|<strong class="jp ir">X</strong>)=<em class="ma">f</em>(<strong class="jp ir">X</strong>，<strong class="jp ir"> β </strong>)</p><h1 id="7a80" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">分析背后的统计数据</h1><p id="71d1" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">用图表很容易理解(来源:维基百科)</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mb"><img src="../Images/0c459b954b9f2e10fe1de85dce6e38f4.png" data-original-src="https://miro.medium.com/v2/resize:fit:876/0*YnFjHIvXcDv8oL3q."/></div></figure><p id="2cb8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ma"> Y = f(X) = 𝛽0 + 𝛽1 * X </em></p><p id="a4be" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">𝛽0 是这条线的截击点</p><p id="c006" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">𝛽1 是这条线的斜率</p><p id="a60b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">线性回归算法用于预测数据点之间的关系(直线)。可以有许多不同的(线性或非线性)方法来定义这种关系。在线性模型中，它基于截距和斜率。为了找出最佳关系，我们需要用数据训练模型。</p><p id="a2b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在应用线性回归模型之前，我们应该确定感兴趣的变量之间是否存在关系。散点图是帮助确定两个变量之间关系强度的良好起点。相关系数是变量之间关联的一个有价值的量度。其值在-1(弱关系)和 1(强关系)之间变化。</p><p id="1320" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦我们确定变量之间存在关系，下一步就是确定变量之间的最佳拟合关系(直线)。最常用的方法是残差平方和(RSS)。该方法计算观测数据(实际值)与其与建议的最佳拟合线(预测值)的垂直距离之间的差异。它计算每个差值的平方，并将所有差值相加。</p><p id="553c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">MSE(均方误差)是通过将 RSS 除以总观察数据点来衡量估计量的质量。它总是一个非负数。越接近零的值表示误差越小。RMSE(均方根误差)是 MSE 的平方根。RMSE 是估计值与观察值的平均偏差的度量。这比 MSE 更容易观察到，MSE 可能是一个很大的数字。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/9ecd6007d017dc716c42952e92991a71.png" data-original-src="https://miro.medium.com/v2/resize:fit:358/format:webp/1*mD_NzMgIBvq_7xWXXF9c2g.png"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi md"><img src="../Images/fdf773faac412ef30bcbb1964f61b6a6.png" data-original-src="https://miro.medium.com/v2/resize:fit:388/0*o4rZDYjsg-88hGXZ."/></div></figure><p id="5755" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"><em class="ma">RMSE</em></strong><em class="ma">(MSE 的平方根)=√(</em><strong class="jp ir"><em class="ma">MSE</em></strong><em class="ma">)</em></p><p id="130e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">额外数量的变量将增加模型的维数。</p><p id="3f74" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ma">y = f(x)= 𝛽0+𝛽1 * x1+𝛽1 * x2+𝛽1 * x3</em></p><h1 id="0b16" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">使用的工具</h1><ol class=""><li id="9366" class="me mf iq jp b jq lv ju lw jy mg kc mh kg mi kk mj mk ml mm bi translated">计算机编程语言</li><li id="896c" class="me mf iq jp b jq mn ju mo jy mp kc mq kg mr kk mj mk ml mm bi translated">Graphlab</li><li id="cc9c" class="me mf iq jp b jq mn ju mo jy mp kc mq kg mr kk mj mk ml mm bi translated">s 帧(类似于熊猫数据帧)</li></ol><h1 id="e803" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">数据加载</h1><p id="81a0" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">使用华盛顿地区西雅图的房屋数据。它包含以下各列和大约 21，000 行。</p><p id="c3e6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Id:日期:价格:卧室:卫生间:sqft_living sqft_lot:楼层:滨水:景观:条件:等级:sqft _ above:sqft _ basement:yr _ build:yr _ revenued:zip code:lat:long:sqft _ living:sqft _ lot</p><pre class="km kn ko kp gt ms mt mu mv aw mw bi"><span id="13a9" class="mx ky iq mt b gy my mz l na nb"><em class="ma">&gt; homesales = graphlab.SFrame(‘home_data.gl’)</em></span><span id="8eb2" class="mx ky iq mt b gy nc mz l na nb"><em class="ma">&gt; homesales</em></span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nd"><img src="../Images/59b13a39d3b389949c484f33ebd4e991.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*EYni6dFj_fMoD-d3."/></div></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ne"><img src="../Images/9f02afa34944c279657b32ec85543b66.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*MwPEMWnRc__WnAsH."/></div></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/33de20cb6a335cb0bf25291dbe3f46c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/0*a03iFU17cWD_vBD2."/></div></figure><p id="c9c5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们需要了解两个变量之间是否有关系。我们来挑房价和居住平方英尺。</p><pre class="km kn ko kp gt ms mt mu mv aw mw bi"><span id="f9ce" class="mx ky iq mt b gy my mz l na nb"><em class="ma">&gt; homesales.show(view=”Scatter Plot”, x=”sqft_living”, y=”price”)</em></span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ng"><img src="../Images/08f3d24f41f02b653702e79976a1284a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HaJmuawhpwno0Jr7."/></div></div></figure><p id="0ea3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以观察到居住面积平方英尺和房价是有关系的。</p><p id="dccf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们使用带误差线的箱线图来观察数据，以了解邮政编码的价格。</p><pre class="km kn ko kp gt ms mt mu mv aw mw bi"><span id="6f90" class="mx ky iq mt b gy my mz l na nb"><em class="ma">&gt; homesales.show(view=’BoxWhisker Plot’, x=’zipcode’, y=’price’)</em></span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nh"><img src="../Images/60bff47d198b8ab8bfffa98a272695a7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Id1tBsoKJSYhChdC."/></div></div></figure><p id="7e82" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">探索和理解周围的数据总是一个好主意。Graphlab 有一个显示数据统计的好方法。</p><pre class="km kn ko kp gt ms mt mu mv aw mw bi"><span id="9444" class="mx ky iq mt b gy my mz l na nb"><em class="ma">&gt; my_features = [‘bedrooms’, ‘bathrooms’, ‘sqft_living’, ‘sqft_lot’, ‘floors’, ‘zipcode’]</em></span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ni"><img src="../Images/1aca43236c46868190dc07214abc3b2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*WFakkrqh7NtypENA."/></div></div></figure><h1 id="2b64" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">预测分析</h1><p id="5186" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">第一步是得到训练数据集和测试数据集。让我们用 80%作为训练数据，剩下的 20%用于测试。</p><pre class="km kn ko kp gt ms mt mu mv aw mw bi"><span id="c5be" class="mx ky iq mt b gy my mz l na nb"><em class="ma">&gt; train_data, test_data = homesales.random_split(0.8, seed=0)</em></span></pre><p id="7561" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们建立一个平方英尺的回归模型，并存储结果。因变量价格是模型需要预测的。</p><pre class="km kn ko kp gt ms mt mu mv aw mw bi"><span id="b01f" class="mx ky iq mt b gy my mz l na nb"><em class="ma">&gt; sqft_model = graphlab.linear_regression.create(train_data, target=’price’, features=[‘sqft_living’], validation_set=None)</em></span></pre><p id="d22e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以使用 matplotlib 绘制模型值和实际值。</p><pre class="km kn ko kp gt ms mt mu mv aw mw bi"><span id="0544" class="mx ky iq mt b gy my mz l na nb"><em class="ma">&gt; plt.plot(test_data[‘sqft_living’],test_data[‘price’],’.’, test_data[‘sqft_living’],sqft_model.predict(test_data),’-’)</em></span></pre><p id="c3a8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">蓝点代表显示房价和居住面积平方英尺之间关系的测试数据。绿线显示了使用我们构建的“sqft_model”线性回归模型对给定平方英尺的房价(因变量)的预测。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/a93feb5248ced1ec461d9eb49b9972e7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/0*VJD9B_5XENkhyDMi."/></div></figure><h1 id="b10b" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">结果</h1><p id="784f" class="pw-post-body-paragraph jn jo iq jp b jq lv js jt ju lw jw jx jy lx ka kb kc ly ke kf kg lz ki kj kk ij bi translated">让我们挑选一所房子，并使用“sqft_model”预测其价值。</p><pre class="km kn ko kp gt ms mt mu mv aw mw bi"><span id="e450" class="mx ky iq mt b gy my mz l na nb"><em class="ma">&gt; house2 = homesales[homesales[‘id’]==’5309101200']</em></span><span id="753c" class="mx ky iq mt b gy nc mz l na nb"><em class="ma">&gt; house2</em></span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nk"><img src="../Images/f5e3b31d55fed4a5a0af44f494e10e94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SET_2tVgjiF6Jglc."/></div></div></figure><p id="9657" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在让我们使用“sqft_model”来预测房子价值。</p><pre class="km kn ko kp gt ms mt mu mv aw mw bi"><span id="3feb" class="mx ky iq mt b gy my mz l na nb"><em class="ma">&gt; print sqft_model.predict(house2)</em></span></pre><p id="0809" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi">[629584.8197281545]</p><p id="679d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">其预测值为 629，584 美元，与实际值 620，000 美元非常接近。</p><p id="58da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">虽然我们的模型运行得相当好，但预测值和实际值之间存在差距。</p><pre class="km kn ko kp gt ms mt mu mv aw mw bi"><span id="7324" class="mx ky iq mt b gy my mz l na nb"><em class="ma">&gt; print sqft_model.evaluate(test_data)</em></span></pre><p id="4b6f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="ma">{ ' max _ error ':41425228938，' RMSE ':25358 }</em></p><p id="bc85" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">“最大误差”是由异常值引起的。它显示在 matplot 可视化的右上角。该模型基于 RMSE 的误差值为 255，191 美元。</p></div></div>    
</body>
</html>