<html>
<head>
<title>How Attractive Are You in the Eyes of Deep Neural Network?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">深度神经网络眼中的你有多有魅力？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-attractive-are-you-in-the-eyes-of-deep-neural-network-3d71c0755ccc?source=collection_archive---------1-----------------------#2018-04-12">https://towardsdatascience.com/how-attractive-are-you-in-the-eyes-of-deep-neural-network-3d71c0755ccc?source=collection_archive---------1-----------------------#2018-04-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="ed07" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">几个月前，华南大学发表了一篇论文和一个关于“面部美容预测”的数据集。这里可以找到<a class="ae kl" href="https://arxiv.org/abs/1801.06345" rel="noopener ugc nofollow" target="_blank">。该数据集包括5500人，他们对自己的吸引力进行了1到5分的评分。<br/> <br/>以下是文中的一些例子:</a></p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi km"><img src="../Images/d252a05542b8a9e0acaee51260a6cee1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1372/format:webp/1*MEG1LZPHtp72xaKuBH-JPg.png"/></div></figure><p id="8997" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">片场还有几个名人。这张朱莉娅·罗伯特的照片平均得分为3.78:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ku"><img src="../Images/62ebfa19b7574a91b6e4950b4946a6f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1080/format:webp/1*TYO2-vJXBBX8jAblvXdKHA.png"/></div></figure><p id="7392" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以色列著名模特芭儿·莱法利的这张照片得到了3.7分:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi kv"><img src="../Images/d97978bf2729e4094c99936a708faa6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1068/format:webp/1*NoAGOF-PE6_QoLoqCeMesg.png"/></div></figure><p id="6086" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些看起来可能很低，但3.7分意味着bar比数据集中的80%的人更有吸引力。</p><p id="1d55" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">除了数据集，作者还训练了多个模型，试图根据面部照片预测一个人的吸引力。</p><p id="70a4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这篇文章中，我想复制他们的结果，看看我有多有魅力。</p></div><div class="ab cl kw kx hu ky" role="separator"><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb lc"/><span class="kz bw bk la lb"/></div><div class="ij ik il im in"><p id="be05" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">原始论文实现了一堆不同的模型，包括具有手工制作功能的经典ML模型和3个深度学习模型:AlexNet、ResNet18和ResNext50。<br/>我想让我的工作尽可能简单(我不想从头开始实施和培训整个<code class="fe ld le lf lg b">resnet</code>网络)，我想微调一些将完成工作的现有模型。在<code class="fe ld le lf lg b">keras</code>中，有一个叫做<code class="fe ld le lf lg b">applications</code>的模块，它是不同预训练模型的集合。其中一个就是<code class="fe ld le lf lg b">resnet50</code>。不幸的是，在<code class="fe ld le lf lg b">keras.applications</code>没有ResNet18或ResNext50，所以我无法复制完全相同的作品，但我应该足够接近<code class="fe ld le lf lg b">resnet50</code>。</p><p id="99bb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe ld le lf lg b">from keras.applications import ResNet50</code></p><p id="521e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">ResNet是一个深度卷积网络，由微软开发，并赢得了2015年ImageNet竞赛，这是一个图像分类任务。<br/>当我们在<code class="fe ld le lf lg b">keras</code>中启动<code class="fe ld le lf lg b">resnet50 </code>模型时，我们创建了一个具有ResNet50架构的模型，并且我们还下载了在ImageNet数据集上训练的训练权重。</p><p id="b84c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">论文作者没有提到他们到底是如何训练模型的，所以我尽量做到最好。<br/>我想删除最后一层(“softmax”层)并添加一个没有激活功能的密集层来执行回归。</p><pre class="kn ko kp kq gt lh lg li lj aw lk bi"><span id="f23e" class="ll lm iq lg b gy ln lo l lp lq">resnet = ResNet50(include_top=False, pooling=’avg’)<br/>model = Sequential()<br/>model.add(resnet)<br/>model.add(Dense(1))</span><span id="4083" class="ll lm iq lg b gy lr lo l lp lq">model.layers[0].trainable = False</span><span id="336c" class="ll lm iq lg b gy lr lo l lp lq">print model.summary()</span><span id="194d" class="ll lm iq lg b gy lr lo l lp lq"># Output:<br/>  Layer (type)                 Output Shape              Param #    ================================================================= resnet50 (Model)             (None, 2048)              23587712   _________________________________________________________________ dense_1 (Dense)              (None, 1)                 2049       ================================================================= Total params: 23,589,761 <br/>Trainable params: 23,536,641 <br/>Non-trainable params: 53,120</span></pre><p id="e009" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您可以看到，我将第一层(resnet模型)设置为不可训练，因此我只有2，049个可训练参数，而不是23，589，761个。</p><p id="cfa0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我的计划是训练最后的密集层，然后，用更小的学习率训练整个网络。</p><pre class="kn ko kp kq gt lh lg li lj aw lk bi"><span id="42f2" class="ll lm iq lg b gy ln lo l lp lq">model.compile(loss='mean_squared_error', optimizer=Adam())</span><span id="3a27" class="ll lm iq lg b gy lr lo l lp lq">model.fit(batch_size=32, x=train_X, y=train_Y, epochs=30)</span></pre><p id="db32" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在那之后，我改变第一层为可训练的，编译并且适合另外30个时期的模型。</p><p id="fc16" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里的<code class="fe ld le lf lg b">train_X</code>是照片，即<code class="fe ld le lf lg b">numpy</code>个形状<code class="fe ld le lf lg b">(350, 350, 3)</code>的数组，<code class="fe ld le lf lg b">train_Y</code>是被标记图像的分数。</p><h1 id="1142" class="ls lm iq bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated"><strong class="ak">结果</strong></h1><p id="e498" class="pw-post-body-paragraph jn jo iq jp b jq mp js jt ju mq jw jx jy mr ka kb kc ms ke kf kg mt ki kj kk ij bi translated">论文使用两种技术训练模型:5重交叉验证和60%-40%的训练测试分割。他们使用皮尔逊相关(PC)、平均绝对误差(MAE)和均方根误差(RMSE)来衡量他们的结果。这些是他们使用五重交叉验证得到的结果:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi mu"><img src="../Images/5bac8be6e0273e0d9539d3e230b25133.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4bAKm7_2aNkgbJE-1Rxl9w.png"/></div></div></figure><p id="341b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些是他们用60%-40%的训练测试分割得到的结果:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi mz"><img src="../Images/c5f232561042ff4ef14ae0c6409d58dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*izhqTzpeSu5WKCw3OBmADA.png"/></div></div></figure><p id="a43d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我将进行80%-20%的训练测试分割，因此这类似于执行1倍的交叉验证部分。</p><p id="838b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我得到了以下结果:</p><pre class="kn ko kp kq gt lh lg li lj aw lk bi"><span id="5f7f" class="ll lm iq lg b gy ln lo l lp lq">RMSE: 0.301799791952313 <br/>MAE: 0.2333630505619627 <br/>PC: 0.9012570266136678</span></pre><p id="a157" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">非常好。此外，查看分数的散点图和直方图总是很好的:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi na"><img src="../Images/40b328a781fb589d087b13ffd3a8b99f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EBn9LujeR6jb3TiWuFkGng.png"/></div></div></figure><p id="4a91" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">原始分数分布(标准化):</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi nb"><img src="../Images/d357218417490c509ee9d9babced1083.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*svYs9_cfQ-DD5YuaQE7xoQ.png"/></div></div></figure><p id="0ef1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">预测分数分布(标准化):</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="mv mw di mx bf my"><div class="gh gi nc"><img src="../Images/2f2aa9b56bc7888cc7711d1e429d8201.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7q7ZbSRmwZ9azK1QCerwMA.png"/></div></div></figure><p id="0a02" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">结果看起来相当不错。现在让我们看看这个深度神经网络对我说了什么。我一开始用这张照片:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/93eccb1a2e7509f4d8a25011ada17653.png" data-original-src="https://miro.medium.com/v2/resize:fit:932/format:webp/1*5RlJZb26-7ieTGrn1O71Xg.png"/></div></figure><p id="fcb0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我得了2.85分，这意味着我比这个数据集中52%的人更有吸引力。我不得不说我有点失望，我希望我会比那更好。所以我试图改善我的处境。</p><p id="72ec" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我拍了很多照片，最终这张照片我得到了3.15分，这意味着我比数据集中64%的人都更有吸引力。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/bca43124a60e798107922ed318a8f7a4.png" data-original-src="https://miro.medium.com/v2/resize:fit:840/format:webp/1*TUCgRbIfAOuu756yUZcUog.png"/></div></figure><p id="6528" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这好多了，我必须诚实地说，我希望更好:)</p><p id="c3ab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后一点，我使用<a class="ae kl" href="https://colab.research.google.com/" rel="noopener ugc nofollow" target="_blank">谷歌合作实验室</a>构建并微调了这个模型，简而言之，它给你一个免费使用GPU的python笔记本！</p><p id="5349" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">希望你喜欢这篇文章。</p></div></div>    
</body>
</html>