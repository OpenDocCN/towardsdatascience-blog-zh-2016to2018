<html>
<head>
<title>Python for data science : Part 4</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用于数据科学的 Python:第 4 部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/python-for-data-science-part-4-6087cb811a29?source=collection_archive---------16-----------------------#2018-08-19">https://towardsdatascience.com/python-for-data-science-part-4-6087cb811a29?source=collection_archive---------16-----------------------#2018-08-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/94eba9552749844c2b7afd13ac1c324b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/1*aNMBIivJppLy2fMRVUSgHA.gif"/></div></figure><p id="f989" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在 Python for data science 系列文章的第 3 部分<a class="ae ks" rel="noopener" target="_blank" href="/python-for-data-science-part-3-be9b08660af9">中，我们查看了 pandas 库及其最常用的功能——读写文件、索引、合并、聚合、过滤等。在这一部分中，我们将继续深入研究 Pandas 库，看看它如何与其他 Python 函数一起用于查询数据帧。</a></p><p id="15ba" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">让我们从导入所有必需的库开始。</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="58e9" class="lc ld iq ky b gy le lf l lg lh">import pandas as pd<br/>import os<br/>import numpy as np</span></pre><p id="8b49" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在，设置工作目录并导入 iris 数据集。</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="9dd0" class="lc ld iq ky b gy le lf l lg lh">os.chdir('C:\\Users\\rohan\\Documents\\Analytics\\Data')<br/>a = pd.read_csv('iris.csv')<br/>a.head()</span></pre><p id="5d22" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir"> <em class="li">输出:</em> </strong></p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/c82fda2e47b218f5f01d554b29b0f72e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1196/format:webp/1*I-aLp3CuSSrvUqnO3Gnshw.png"/></div></figure><h1 id="5a74" class="lk ld iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated"><strong class="ak"> 1。数字列的描述性统计</strong></h1><p id="9811" class="pw-post-body-paragraph ju jv iq jw b jx mh jz ka kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr ij bi translated">总结(平均值、标准偏差、最小值、最大值等。)使用 describe 函数的数据集的数字列。</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="3339" class="lc ld iq ky b gy le lf l lg lh">a.describe()</span></pre><p id="bbef" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir"> <em class="li">输出:</em> </strong></p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div class="gh gi mm"><img src="../Images/4b6bd147ea9df9ed2dde0efc02d907f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1136/format:webp/1*uNPoLyNbMqbwHsGYBihDxw.png"/></div></figure><h1 id="5a73" class="lk ld iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated"><strong class="ak"> 2。基于条件创建列</strong></h1><p id="073d" class="pw-post-body-paragraph ju jv iq jw b jx mh jz ka kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr ij bi translated">让我们创建一个名为'<strong class="jw ir"> SepalLength_Size' </strong>的新列，如果萼片长度≥ 5，则包含“高”，如果萼片长度&lt; 5，则包含“低”。</p><p id="3a8e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">有许多方法可以执行上述任务。让我们来看看四种不同的方法。</p><ol class=""><li id="4448" class="mn mo iq jw b jx jy kb kc kf mp kj mq kn mr kr ms mt mu mv bi translated">首先，让我们通过使用<strong class="jw ir"> np.where </strong>函数来执行这个任务。</li></ol><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="fb56" class="lc ld iq ky b gy le lf l lg lh">a['SepalLength_Size'] = np.where(a['SepalLength']&gt;=5,'High','Low')<br/>a.head()</span></pre><p id="7462" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir"> <em class="li">输出:</em> </strong></p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi mw"><img src="../Images/6618bdbb3969473903b94933e3d9ca83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZNsvei51-6vHQQYL7BI_UA.png"/></div></div></figure><p id="d7d8" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">2.现在，使用<strong class="jw ir">列表理解</strong>(如果你忘了那是什么，在<a class="ae ks" rel="noopener" target="_blank" href="/python-for-data-science-part-1-759524eb493b">第一部分</a>中检查一下)来完成同样的任务。此外，列表理解通常比所有其他方法更快。</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="85a7" class="lc ld iq ky b gy le lf l lg lh">a['SepalLength_Size'] = ['High' if x &gt;= 5 else 'Low' for x in a['SepalLength'] ]</span></pre><p id="1945" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir"> <em class="li">输出:</em> </strong></p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi mw"><img src="../Images/6618bdbb3969473903b94933e3d9ca83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZNsvei51-6vHQQYL7BI_UA.png"/></div></div></figure><p id="4224" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">3.现在，让我们使用 pandas dataframe 中的<strong class="jw ir">‘assign’</strong>函数创建列。</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="7976" class="lc ld iq ky b gy le lf l lg lh">def size(row_number):<br/>    if row_number["SepalLength"] &gt;=5:<br/>        return 'High'<br/>    else:<br/>        return 'Low'</span><span id="bd1a" class="lc ld iq ky b gy nb lf l lg lh">a = a.assign(SepalLength_Size=a.apply(size, axis=1))</span><span id="d919" class="lc ld iq ky b gy nb lf l lg lh">a.head()</span></pre><p id="5d06" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">T33】输出:T35】</strong></p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi mw"><img src="../Images/6618bdbb3969473903b94933e3d9ca83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZNsvei51-6vHQQYL7BI_UA.png"/></div></div></figure><p id="2087" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">4.最后，让我们使用<strong class="jw ir"> lambda </strong>函数。</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="f788" class="lc ld iq ky b gy le lf l lg lh">a['SepalLength_Size'] = a['SepalLength'].map( lambda x: 'High' if x &gt;= 5 else 'Low')</span></pre><p id="f12b" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">T39】输出:T41】</strong></p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi mw"><img src="../Images/6618bdbb3969473903b94933e3d9ca83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZNsvei51-6vHQQYL7BI_UA.png"/></div></div></figure><h1 id="beee" class="lk ld iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">3.列的唯一值</h1><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="6094" class="lc ld iq ky b gy le lf l lg lh">a['Name'].unique()</span></pre><p id="268c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir"> <em class="li">输出:</em> </strong></p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/22090ad28d21ab4830f5aa7df5b39451.png" data-original-src="https://miro.medium.com/v2/resize:fit:1390/format:webp/1*zmVvSKnUm6ZwcLiHUga4pg.png"/></div></figure><p id="3564" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">仅获取“名称”列的唯一值的数量。</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="ec13" class="lc ld iq ky b gy le lf l lg lh">a['Name'].nunique()</span></pre><p id="f40c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir"> <em class="li">输出:</em> </strong> 3</p><h1 id="7a19" class="lk ld iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated"><strong class="ak"> 4。十字页签(类似 Excel 中的透视表)</strong></h1><p id="18a6" class="pw-post-body-paragraph ju jv iq jw b jx mh jz ka kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr ij bi translated">此函数用于查找两个或多个因子的简单交叉列表。让我们使用列“Name”和“SepalLength_Size”(我们创建的新列)，看看它是如何工作的。</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="35d8" class="lc ld iq ky b gy le lf l lg lh">pd.crosstab(a['Name'],a['SepalLength_Size'])</span></pre><p id="23f3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">输出:输出:</strong></p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/c829a3ff32a115472b87b44894db5362.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/1*OvwGBy9xZeDNeSk4gfvD9Q.png"/></div></figure><p id="a383" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">上面的十字标签提供了每种组合的行数，例如，有 30 个具有高萼片长度的刚毛藻种。</p><p id="06c6" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">让我们再做一次交叉制表，找出每个桶中萼片的平均长度。</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="d00b" class="lc ld iq ky b gy le lf l lg lh">pd.crosstab(a['Name'],a['SepalLength_Size'],values=a['SepalLength'],aggfunc=np.mean)</span></pre><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/52fb56d9409c65a7781434705e5520f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:696/format:webp/1*R4meZlefEFiFPe3A80gW4g.png"/></div></figure><h1 id="677d" class="lk ld iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">5.排序值</h1><p id="4c03" class="pw-post-body-paragraph ju jv iq jw b jx mh jz ka kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr ij bi translated">让我们按“萼片长度”对数据进行分类。</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="aa18" class="lc ld iq ky b gy le lf l lg lh">a.sort_values('SepalLength')</span></pre><p id="55b3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">输出:输出:</strong></p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi nf"><img src="../Images/34c40d7992c4bad02f558c6b50f716c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h11PNc_wN372t6ktoxHdRQ.png"/></div></div></figure><p id="de1a" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">首先按“名称”排序(升序)，然后按“萼片长度”排序(降序)。</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="5d2d" class="lc ld iq ky b gy le lf l lg lh">a.sort_values(['Name','SepalLength'],ascending=[True,False])</span></pre><p id="cedd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir"> <em class="li">输出:</em> </strong></p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi ng"><img src="../Images/46c5be403fc1aaf07798f59b19fb8688.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yD29VE-q68800Yd56tN9bA.png"/></div></div></figure><p id="124e" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">检查所有列的数据类型</p><h1 id="93d8" class="lk ld iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated"><strong class="ak"> 6。检查列数据类型</strong></h1><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="6f29" class="lc ld iq ky b gy le lf l lg lh">a.dtypes</span></pre><p id="ef40" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir"> <em class="li">输出:</em> </strong></p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/2f2c33fb3795163abe9ecc08e33247ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:664/format:webp/1*i6dMIpt0ypUp5V6Hr3czDw.png"/></div></figure><h1 id="c5a7" class="lk ld iq bd ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me mf mg bi translated">7.宁滨数字列</h1><p id="3ab7" class="pw-post-body-paragraph ju jv iq jw b jx mh jz ka kb mi kd ke kf mj kh ki kj mk kl km kn ml kp kq kr ij bi translated">在 iris 数据集中创建一个新列来存储“萼片长度”。我们可以使用“剪切”功能来执行此操作。</p><pre class="kt ku kv kw gt kx ky kz la aw lb bi"><span id="aca4" class="lc ld iq ky b gy le lf l lg lh">bins = [0, 1, 2, 3, 4, 5,6,7]<br/>a[‘bins’] = pd.cut(a[‘SepalLength’], bins)</span></pre><p id="af19" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir"> <em class="li">输出:</em> </strong></p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mx my di mz bf na"><div class="gh gi ni"><img src="../Images/63c611ce27c4ff73ae509cff5df21035.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Na5YAubCRbT9I0pPNiybtA.png"/></div></div></figure><p id="5984" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">现在，使用“value_counts”函数计算每个存储桶下有多少行。</p><p id="039c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir"> <em class="li">输出:</em> </strong></p><figure class="kt ku kv kw gt jr gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/ed3c7de06c351bef2777a62bc570d1ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:618/format:webp/1*tqdmsVzK-3TSnyKdHCc76w.png"/></div></figure><p id="b40c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">这涵盖了在数据科学中经常使用的大部分熊猫函数。在接下来的部分中，我们将会看到 Python 中的可视化和假设检验。</p></div><div class="ab cl nk nl hu nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ij ik il im in"><p id="c9dd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">在 LinkedIn 上连接，并查看 Github(如下)以获得完整的笔记本。</p><div class="nr ns gp gr nt nu"><a href="https://github.com/rohanjoseph93/Python-for-data-science/blob/master/Python%20for%20data%20science%20-%20Part%204.ipynb" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd ir gy z fp nz fr fs oa fu fw ip bi translated">rohanjoseph 93/用于数据科学的 Python</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">Python-for-data-science -用 Python 学习数据科学</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="oe l of og oh od oi js nu"/></div></div></a></div></div></div>    
</body>
</html>