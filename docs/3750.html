<html>
<head>
<title>How to build a simple Linear Regression Model?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何建立简单的线性回归模型？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/linear-regression-model-899558ba0fc4?source=collection_archive---------2-----------------------#2018-06-14">https://towardsdatascience.com/linear-regression-model-899558ba0fc4?source=collection_archive---------2-----------------------#2018-06-14</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="1715" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这篇文章是关于一步一步地为 ML 初学者实现简单的线性回归模型，并有详细的解释。</p><p id="cba7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你是机器学习的新手，请查看<a class="ae kl" href="https://medium.com/@diti.modi/machine-learning-simplified-3f964c1a64a6" rel="noopener"> <strong class="jp ir"> <em class="km">这篇</em> </strong> </a>的帖子，了解机器学习及其基础知识。</p><p id="a45c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">简单线性回归模型背后的逻辑是什么？</strong></p><p id="e3b1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">顾名思义，线性回归遵循从一个给定自变量的值确定一个因变量的值的线性数学模型。还记得学校里的线性方程吗？</p><h1 id="01ae" class="kn ko iq bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">y=mx+c</h1><p id="dfbf" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">其中 y 是因变量，m 是斜率，x 是自变量，c 是给定直线的截距。</p><p id="74d0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们也有多元回归模型，其中多个自变量用于计算一个因变量。</p><p id="ef5d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我已经用 Jupyter 笔记本实现了。您可以选择使用任何 Python IDE 所以让我们开始吧..</p><p id="2626" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">步骤 1:导入库</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi lq"><img src="../Images/b760960fee1b77429f18ffd6176ff70f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XhPNXcPI8rtlLfRGrK0mkQ.png"/></div></div><figcaption class="mc md gj gh gi me mf bd b be z dk">Step 1</figcaption></figure><p id="906c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Python 中已经开发了用于实现机器学习模型的库。</p><p id="89c3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第一个名为 matplotlib 的库用于在最后一步绘制图形。“plt”用作变量名，用于在前面的代码中使用该库。</p><p id="edbd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">sklearn 是 python 中的官方机器学习库，用于各种模型实现。</p><p id="c3c2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">numpy 用于将数据转换成数组，供 sklearn 库实际使用。</p><p id="1854" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">熊猫是用来访问的。数据集的 csv 文件。</p><p id="4ea9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">步骤 2:加载数据集</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi mg"><img src="../Images/6672c1a50c1f5797dd92086c171f3a3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MCwFNUzJF9mokgz2no8VOw.png"/></div></div></figure><p id="5533" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的数据集是. csv 文件类型。Pandas 变量 pd 用于通过 read_csv()函数访问数据集。</p><p id="7827" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第三步:分解为自变量和因变量</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi mh"><img src="../Images/7783a10d0fcc103a2c7b58e25db52376.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mGUxLFpCR8wBiMPmXLbHIw.png"/></div></div></figure><p id="7bb2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们通过 iloc(索引位置)值定义 x 为数据集中的自变量。[]用于定义数组元素。":"[]内表示考虑数据集中的所有行，并使用" "分隔。我们指定要用作自变量或因变量的列数，从数据集中的零开始计数。</p><p id="2f97" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">步骤 4:将数据分为训练数据和测试数据</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi mi"><img src="../Images/d4e091deeb0a519a708e52739c2a839f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4OsNhmwslwgeFq10ukFtMw.png"/></div></div></figure><p id="498d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，整个数据集被分为训练集和测试集，这样预测就不会过拟合或欠拟合，从而获得正确值。train_test_split()是 scikit learn 的内置函数，用于拆分 x 和 y 变量数据。“test_size”参数用于将整个数据集(30%)的 1/3 划分为测试数据，其余部分作为训练数据。将 random_state 设置为 null 将不允许从数据集中获取随机值。</p><p id="4412" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第五步:选择模型</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi mj"><img src="../Images/0096e7effbeced1086c7ee8c7e08ade0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IrE4WIdiR4viRSF5HuDPjg.png"/></div></div></figure><p id="ce2b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们重塑我们的自变量，因为 sklearn 期望一个 2D 数组作为输入。</p><p id="9064" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里的线性回归是我们的模型，模型的变量名为“lin_reg”。我们也可以用许多其他模型来尝试相同的数据集。该部分因型号而异，否则所有其他步骤都与此处描述的相似。</p><p id="65d6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第六步:符合我们的模型</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi mk"><img src="../Images/6839cd1f694f3595494e6ecccf081327.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*npLvvzhoNbC9Wql2nmACTA.png"/></div></div></figure><p id="c94b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我们通过用自变量和因变量训练模型，使我们的模型适合线性回归模型。</p><p id="0532" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第七步:预测输出</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi ml"><img src="../Images/bfd197481f36432301281baeeef45d28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*deIH021RLjOdrd50MttZcA.png"/></div></div></figure><p id="9adf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，我们的模型使用自变量的测试值来预测因变量“lin_reg_pred”。</p><p id="3dcd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们可以看到异常值的系数、截距值，以及预测值(lin_reg_pred)和因变量的实际测试值(y_test)的均方误差和方差。内置方法使用预定义的公式计算每个值。</p><p id="9c7d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第八步:绘制图表</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div role="button" tabindex="0" class="lw lx di ly bf lz"><div class="gh gi mm"><img src="../Images/f1ddff7c83a25acdeb2cece811823029.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2mnCfmC9XiK_4OcuNNnoSw.png"/></div></div></figure><p id="29f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们最终希望以图形格式可视化实际数据值和预测数据值。matplotlib 变量“plt”用于使用“scatter()”绘制点，使用“plot()”函数绘制异常值。</p><p id="d19a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">输出可能因不同的系统功能而异。我得到的输出如下:</p><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div class="gh gi mn"><img src="../Images/95125fef0f7708b9dc219b9a1255a103.png" data-original-src="https://miro.medium.com/v2/resize:fit:764/format:webp/1*Ug_PyF6kggspeTi4Jjremg.png"/></div><figcaption class="mc md gj gh gi me mf bd b be z dk">Output</figcaption></figure><figure class="lr ls lt lu gt lv gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/9b6d94c8301d2557206312ecf8c05e76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1026/format:webp/1*4W-T0cXlcmJP9qpj9xlOLA.png"/></div><figcaption class="mc md gj gh gi me mf bd b be z dk">Output Graph</figcaption></figure><p id="70e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">就是这个！我们的第一个线性回归模型实现了！下面是我们在这里实现的整个模型的完整代码的链接。</p><div class="mp mq gp gr mr ms"><a href="https://github.com/ditsme/MachineLearning" rel="noopener  ugc nofollow" target="_blank"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd ir gy z fp mx fr fs my fu fw ip bi translated">ditsme/机器学习</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">机器学习——我所有的机器学习项目</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">github.co</p></div></div><div class="nb l"><div class="nc l nd ne nf nb ng ma ms"/></div></div></a></div><p id="0d25" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在 LinkedIn 上关注我:<a class="ae kl" href="http://www.linkedin.com/comm/mynetwork/discovery-see-all?usecase=PEOPLE_FOLLOWS&amp;followMember=ditimodi" rel="noopener ugc nofollow" target="_blank">www.linkedin.com/comm/mynetwork/discovery-see-all?use case = PEOPLE _ FOLLOWS&amp;follow member = dit modi</a></p></div></div>    
</body>
</html>