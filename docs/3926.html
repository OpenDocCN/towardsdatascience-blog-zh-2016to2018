<html>
<head>
<title>Multi-Label Classification and Class Activation Map on Fashion-MNIST</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">时尚 MNIST 的多标签分类和类别激活图</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/multi-label-classification-and-class-activation-map-on-fashion-mnist-1454f09f5925?source=collection_archive---------2-----------------------#2018-07-02">https://towardsdatascience.com/multi-label-classification-and-class-activation-map-on-fashion-mnist-1454f09f5925?source=collection_archive---------2-----------------------#2018-07-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="2dab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">时尚-MNIST </strong>是一个时尚产品图像数据集，用于对计算机视觉的机器学习算法进行基准测试。该数据集包括 60，000 幅 28x28 的训练图像和 10，000 幅 28x28 的测试图像，包括 10 类时尚产品。图 1 显示了所有的标签和一些图像在<strong class="jp ir">时尚-MNIST </strong>。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/7cd2e7baa36df54eabdcc584c09184ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-kpgaee9X9Gm-SrQKdk_og.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk"><strong class="bd lb">Figure 1. Fashion-MNIST dataset. [</strong><a class="ae lc" href="https://github.com/zalandoresearch/fashion-mnist" rel="noopener ugc nofollow" target="_blank">github</a> and <a class="ae lc" href="https://arxiv.org/abs/1708.07747?context=cs" rel="noopener ugc nofollow" target="_blank">arxiv</a><strong class="bd lb">]</strong></figcaption></figure><p id="046d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">有很多关于时尚的文章——MNIST[</strong><a class="ae lc" href="https://medium.com/search?q=fashion%20mnist" rel="noopener">ref</a><strong class="jp ir">]。然而，这篇文章的目标是在多标签分类的背景下，而不是在多类分类的背景下，提出一项关于时尚 MNIST 的深度学习的研究。此外，这篇文章还研究了我们是否可以可视化卷积神经网络如何看待图像，并识别激活特定标签的区域。</strong></p><h1 id="c9ed" class="ld le iq bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">1.可视化，可视化，可视化</h1><p id="bcd7" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy md ka kb kc me ke kf kg mf ki kj kk ij bi translated">在进入所有细节之前，让我们想象一下我们能达到的一些结果。</p><div class="km kn ko kp gt ab cb"><figure class="mg kq mh mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/1ae7e55f264f8a28eae815953da079fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*EA1Yi9Oj2UNsUS8lZ5O66w.png"/></div></figure><figure class="mg kq mm mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/87d52a6294884f36cba022d06d614737.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*B249gN1JgSuVL-bLoCLmxw.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk mn di mo mp"><strong class="bd lb">Figure 2. (a) A multi-label image, (b) The predicted probabilities over labels, (c) The class activation maps for the labels with higher probabilities.</strong></figcaption></figure></div><p id="3ca5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们逐一分解图 2 中的图表。</p><ol class=""><li id="5341" class="mq mr iq jp b jq jr ju jv jy ms kc mt kg mu kk mv mw mx my bi translated">第一个图显示了一个多标签图像，由来自<strong class="jp ir">时尚-MNIST </strong>的四个时尚产品图像组成:<em class="mz">一条裤子</em>、<em class="mz">一双运动鞋</em>、<em class="mz">一个包</em>和<em class="mz">一件衣服</em>。与该多标签图像相关联的标签是<em class="mz"> 1 </em>、7、8 和 3。请注意，实际上我们在这项研究中考虑的是标签的存在(例如 1/3/7/8)而不是标签的顺序(例如 1/7/8/3)。如果一个图像只包含两类时尚产品，那么只有两个标签会被分配给该图像。</li><li id="ad72" class="mq mr iq jp b jq na ju nb jy nc kc nd kg ne kk mv mw mx my bi translated">给出了多标签图像，第二张图显示了由我们训练的卷积神经网络计算的所有标签的预测概率。请注意，<em class="mz">标签 1 </em>、<em class="mz">标签 3 </em>、<em class="mz">标签 7 </em>和<em class="mz">标签 8 </em>的概率都接近 1，这表明我们训练的卷积神经网络在给定图像上标记正确标签方面做得很好。</li><li id="0cfe" class="mq mr iq jp b jq na ju nb jy nc kc nd kg ne kk mv mw mx my bi translated">第三张图显示了与前四个预测标签相关的热图，即以较高概率激活标签的区域。突出显示热图(也称为类激活图)的目的是打开我们的卷积神经网络的黑盒，看看它是否真的精确定位了进行预测的关键区域。</li></ol><p id="6a1e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">再举两个例子:一个有 3 个标签(图 3)，一个有 2 个标签(图 4)。</p><div class="km kn ko kp gt ab cb"><figure class="mg kq mh mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/ea80d7a97cbd62a05f53edf8b3f38fd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*N0v3Waw0sZui0acC5KOPWQ.png"/></div></figure><figure class="mg kq mm mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/9f9b081297ae2e0e1a832384c85a6c5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*kO-ANpRG54xss75yF1mIEQ.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk mn di mo mp"><strong class="bd lb">Figure 3. An image with 3 labels: 2, 3, and 8.</strong></figcaption></figure></div><div class="ab cb"><figure class="mg kq mh mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/a27c16ed97dd12b3be35796f9e806229.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/1*m8yecx2vFgNRw9e4a2KMcQ.png"/></div></figure><figure class="mg kq mm mi mj mk ml paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><img src="../Images/5bb1b7f8e7abfcbf29b1d08df7fd680e.png" data-original-src="https://miro.medium.com/v2/resize:fit:780/format:webp/1*DKM5w4eMwwjFXXJPNava0g.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk mn di mo mp"><strong class="bd lb">Figure 4. An image with 2 labels: 3 and 9.</strong></figcaption></figure></div><p id="a5a7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">图 5 给出了超过 9000 幅用于训练的图像和 1000 幅用于验证的图像的总体训练历史。在 1000 张测试图像上的准确率在 95% ~ 96%左右。该程序是在 Keras 中实现的，后台是 Theano。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nf"><img src="../Images/35897d5ddd716ecbdca43df5200e91bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uiBbfaDtXo6_UGjxeWjc8g.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk"><strong class="bd lb">Figure 5. Training history on accuracy and loss.</strong></figcaption></figure><h1 id="a0cb" class="ld le iq bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">2.多标签时尚-MNIST</h1><p id="7115" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy md ka kb kc me ke kf kg mf ki kj kk ij bi translated">以下是我们用于多标签分类的新数据集的简介:</p><ul class=""><li id="0211" class="mq mr iq jp b jq jr ju jv jy ms kc mt kg mu kk ng mw mx my bi translated">10000 幅 646×184 的训练图像和 1000 幅 646×184 的测试图像；</li><li id="a86e" class="mq mr iq jp b jq na ju nb jy nc kc nd kg ne kk ng mw mx my bi translated">每张图片有四张从<strong class="jp ir">时尚-MNIST </strong>中随机选取的时尚产品图片；</li><li id="6aa7" class="mq mr iq jp b jq na ju nb jy nc kc nd kg ne kk ng mw mx my bi translated">元数据文件保存了图像的有序标签，以及它的单主机编码方案。</li></ul><p id="75f1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">图 6 显示了我们数据集中的一些图像，图 7 显示了元数据文件中的一些信息。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nh"><img src="../Images/171e7c9b3fa0ebf2a7ede20fc2acfb3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HkW94w1erHUYMguiDWWHJQ.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk"><strong class="bd lb">Figure 6. Sample images in Multi-Label Fashion-MNIST.</strong></figcaption></figure><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ni nj l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk"><strong class="ak">Figure 7. Sample meta-data in Multi-Label Fashion-MNIST.</strong></figcaption></figure><h1 id="06e2" class="ld le iq bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">3.神经网络体系结构</h1><p id="a6f0" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy md ka kb kc me ke kf kg mf ki kj kk ij bi translated">我们神经网络的重点是将<strong class="jp ir">执行多标签分类</strong>和<strong class="jp ir">生成类激活图</strong>的基本机制集成在一起。我们将遍历执行多标签分类的基本框架，然后检查生成类激活图所需的增强。</p><p id="af2b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，让我们比较实现<strong class="jp ir">多类分类</strong>(其中一个图像仅属于一个类)和<strong class="jp ir">多标签分类</strong>(其中一个图像可以与多个标签相关联)的常见做法。)</p><ul class=""><li id="b192" class="mq mr iq jp b jq jr ju jv jy ms kc mt kg mu kk ng mw mx my bi translated">用于图像分类的基本神经网络架构通常由用于特征提取的卷积层和最大池层的堆叠组成，随后是用于类别/标签预测的一些全连接层。</li><li id="107a" class="mq mr iq jp b jq na ju nb jy nc kc nd kg ne kk ng mw mx my bi translated">对于<strong class="jp ir">多类分类</strong>，模型中的最后一层使用<strong class="jp ir"> softmax </strong>函数进行类预测，训练过程使用<strong class="jp ir">category _ cross entropy</strong>函数作为损失函数。</li><li id="a53b" class="mq mr iq jp b jq na ju nb jy nc kc nd kg ne kk ng mw mx my bi translated">对于<strong class="jp ir">多标签分类</strong>，模型中的最后一层使用<strong class="jp ir"> sigmoid </strong>函数进行标签预测，训练过程使用<strong class="jp ir"> binary_crossentropy </strong>函数作为损失函数。</li></ul><p id="7b26" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上述实践基于在深度学习中实现最后一层激活函数和损失函数的传统智慧，如图 8 所示。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nk"><img src="../Images/278e7255ab007c7c71f1d525082b6f9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*24c3Wx4vEUK836qVcyKQuA.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk"><strong class="bd lb">Figure 8. Summary of last-layer activation function and loss function. [</strong><a class="ae lc" href="https://www.manning.com/books/deep-learning-with-python" rel="noopener ugc nofollow" target="_blank">Deep Learning with Python</a>, Ch4/Ch9<strong class="bd lb">]</strong></figcaption></figure><p id="e779" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，让我们考虑生成类激活映射的机制。有许多不同的方法来创建类激活映射。我们的想法和代码基于<a class="ae lc" href="https://alexisbcook.github.io/2017/global-average-pooling-layers-for-object-localization/" rel="noopener ugc nofollow" target="_blank">用于对象本地化的全局平均池层</a>。这种方法有两个要点。首先，给定类的类激活图被视为最后一个卷积层的特征图的加权和。其次，全局平均池图层用于将要素地图转换为单个值，并作为计算相关权重的粘合剂。原始论文中的图 9 展示了完整的过程。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nl"><img src="../Images/4123cf9faf4a851ffa6ce71342796537.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XXfXF2FZosBM-in8ijiGsg.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk"><strong class="bd lb">Figure 9. Class Activation Mapping. [</strong><a class="ae lc" href="https://github.com/metalbubble/CAM" rel="noopener ugc nofollow" target="_blank">ref</a><strong class="bd lb">]</strong></figcaption></figure><p id="442e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">图 10 显示了 Keras 中用于构建和训练深度神经网络的代码。图 11 显示了整个模型的概要。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ni nj l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk"><strong class="ak">Figure 10. The code for building and training the deep neural network.</strong></figcaption></figure><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ni nj l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk"><strong class="ak">Figure 11. The summary of the whole model.</strong></figcaption></figure><p id="ee8a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">图 12 显示了创建类激活映射的代码。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="ni nj l"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk"><strong class="ak">Figure 12. The code for creating a class activation map.</strong></figcaption></figure><h1 id="4efb" class="ld le iq bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">4.结论</h1><p id="e169" class="pw-post-body-paragraph jn jo iq jp b jq mb js jt ju mc jw jx jy md ka kb kc me ke kf kg mf ki kj kk ij bi translated">这篇文章介绍了在<strong class="jp ir">多标签分类</strong>的背景下为<strong class="jp ir">时尚-MNIST </strong>进行的深度学习研究。我们还试图打开我们的卷积神经网络的黑盒，以查看预测标签的<strong class="jp ir">类激活图</strong>。这项研究中最有趣但最具挑战性的问题是用全局平均池函数实现和验证类激活映射，特别是当一个映射看起来不正确时。最后，让我用两个数字来说明今后工作的方向。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nm"><img src="../Images/f70eb2eb523d7a0e49b91b00cc28c611.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*toypAMKChmQn3-XizfbkBA.jpeg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk"><strong class="bd lb">Ref-1. </strong><a class="ae lc" href="http://mmlab.ie.cuhk.edu.hk/projects/DeepFashion.html" rel="noopener ugc nofollow" target="_blank"><strong class="bd lb">DeepFashion</strong></a></figcaption></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nn"><img src="../Images/3b7a199356b9bc705eaf77f03b98b7be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pBnmzzgmg32_stKe1G-UgQ.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk"><strong class="bd lb">Ref-2. </strong><a class="ae lc" href="https://arxiv.org/abs/1610.02391" rel="noopener ugc nofollow" target="_blank"><strong class="bd lb">Grad-CAM</strong></a></figcaption></figure><p id="537a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">还有一件事…你喜欢 MNIST 吗？</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi no"><img src="../Images/8d26594819feabdcd917fddcd634c37c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*P5NsXFLbLWFlTpWmnvFvLg.jpeg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk"><strong class="bd lb">Ref-3. DO YOU MNIST from </strong><a class="ae lc" href="https://anztee.com/product/do-you-mnist-computer-data-science-machine-learning-t-shirt/" rel="noopener ugc nofollow" target="_blank"><strong class="bd lb">anztee.com</strong></a><strong class="bd lb"> and </strong><a class="ae lc" href="https://www.teezily.com/" rel="noopener ugc nofollow" target="_blank"><strong class="bd lb">teezily.com</strong></a></figcaption></figure></div></div>    
</body>
</html>