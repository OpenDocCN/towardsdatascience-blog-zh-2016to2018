<html>
<head>
<title>Training a Goal-Oriented Chatbot with Deep Reinforcement Learning — Part V</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用深度强化学习训练面向目标的聊天机器人——第五部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/training-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-v-running-the-agent-and-63d8cd27d1d?source=collection_archive---------15-----------------------#2018-12-01">https://towardsdatascience.com/training-a-goal-oriented-chatbot-with-deep-reinforcement-learning-part-v-running-the-agent-and-63d8cd27d1d?source=collection_archive---------15-----------------------#2018-12-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="05e9" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">第五部分:代理运行及未来研究</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><a href="https://www.nasa.gov/mission_pages/shuttle/shuttlemissions/sts127/launch/index.html"><div class="gh gi kf"><img src="../Images/9b87f09335e53a340ee2d59963927586.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Nw2jZCYdknEjua-VZLEQlQ.jpeg"/></div></a><figcaption class="kn ko gj gh gi kp kq bd b be z dk"><a class="ae kr" href="https://www.nasa.gov/mission_pages/shuttle/shuttlemissions/sts127/launch/index.html" rel="noopener ugc nofollow" target="_blank">https://www.nasa.gov/mission_pages/shuttle/shuttlemissions/sts127/launch/index.html</a></figcaption></figure><p id="1b54" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">在前面的部分中，我们介绍了面向目标的代理的所有部分和代码！</p><p id="fbb0" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">这是第五部分，也是最后一部分，我们将介绍如何运行代码以及未来的研究和改进！</p><p id="2a3d" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">这个系列教程是基于<a class="ae kr" href="https://github.com/MiuLab/TC-Bot" rel="noopener ugc nofollow" target="_blank"> TC-Bot </a>的。这个系列的代码可以在<a class="ae kr" href="https://github.com/maxbren/GO-Bot-DRL" rel="noopener ugc nofollow" target="_blank">这里</a>找到。在这一部分，我们将快速回顾一下<code class="fe lo lp lq lr b"><a class="ae kr" href="https://github.com/maxbren/GO-Bot-DRL/blob/master/user.py" rel="noopener ugc nofollow" target="_blank">user.py</a></code>和<code class="fe lo lp lq lr b"><a class="ae kr" href="https://github.com/maxbren/GO-Bot-DRL/blob/master/test.py" rel="noopener ugc nofollow" target="_blank">test.py.</a></code></p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="38c8" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">运行代码</h1><p id="b5d8" class="pw-post-body-paragraph ks kt iq ku b kv mr jr kx ky ms ju la lb mt ld le lf mu lh li lj mv ll lm ln ij bi translated">您既可以培训代理，也可以测试经过培训的代理。此外，代替使用用户模拟器，你可以作为一个真正的用户自己输入动作。</p><h2 id="50dc" class="mw ma iq bd mb mx my dn mf mz na dp mj lb nb nc ml lf nd ne mn lj nf ng mp nh bi translated">培训代理</h2><p id="0093" class="pw-post-body-paragraph ks kt iq ku b kv mr jr kx ky ms ju la lb mt ld le lf mu lh li lj mv ll lm ln ij bi translated">运行<code class="fe lo lp lq lr b">train.py</code>，用给定的<code class="fe lo lp lq lr b">constants.json</code>文件从头开始训练。改变常数值，看看是否能找到更好的超参数。</p><h2 id="3399" class="mw ma iq bd mb mx my dn mf mz na dp mj lb nb nc ml lf nd ne mn lj nf ng mp nh bi translated">保存和加载模型权重</h2><p id="c8b9" class="pw-post-body-paragraph ks kt iq ku b kv mr jr kx ky ms ju la lb mt ld le lf mu lh li lj mv ll lm ln ij bi translated">通过将<code class="fe lo lp lq lr b">constants.json</code>中的<code class="fe lo lp lq lr b">"save_weights_file_path”</code>设置为您想要保存行为和目标模型权重的相对文件路径，您可以将训练模型的权重保存在一个目录中。要加载保存的重量，将<code class="fe lo lp lq lr b">"load_weights_file_path”</code>设置到相同的路径。例如，要加载回购中的权重，将其设置为<code class="fe lo lp lq lr b">"weights/model.h5"</code>。权重文件必须是. h5 文件，这是 Keras 使用的文件类型。您可以加载已经训练好的重量，并对其进行更多训练！</p><h2 id="d3a3" class="mw ma iq bd mb mx my dn mf mz na dp mj lb nb nc ml lf nd ne mn lj nf ng mp nh bi translated">测试代理</h2><p id="3022" class="pw-post-body-paragraph ks kt iq ku b kv mr jr kx ky ms ju la lb mt ld le lf mu lh li lj mv ll lm ln ij bi translated">通过运行<code class="fe lo lp lq lr b">test.py</code>并将<code class="fe lo lp lq lr b">"load_weights_file_path”</code>设置为正确的文件路径，可以使用经过训练的权重对代理进行测试。</p><h2 id="faca" class="mw ma iq bd mb mx my dn mf mz na dp mj lb nb nc ml lf nd ne mn lj nf ng mp nh bi translated">用真实用户测试(或培训)代理</h2><p id="86cb" class="pw-post-body-paragraph ks kt iq ku b kv mr jr kx ky ms ju la lb mt ld le lf mu lh li lj mv ll lm ln ij bi translated">您可以通过将<code class="fe lo lp lq lr b">constants.json</code>中<code class="fe lo lp lq lr b">“run”</code>下的<code class="fe lo lp lq lr b">"usersim”</code>设置为<code class="fe lo lp lq lr b">false</code>，以用户身份输入您自己的动作(而不是使用用户 sim)来测试代理。你在控制台中输入一个动作和一个成功指示器。动作输入的格式是:意图/通知槽/请求槽。</p><p id="52ac" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">动作输入示例:</p><ul class=""><li id="4992" class="ni nj iq ku b kv kw ky kz lb nk lf nl lj nm ln nn no np nq bi translated">请求/电影名称:房间，日期:星期五/开始时间，城市，剧院</li><li id="2eca" class="ni nj iq ku b kv nr ky ns lb nt lf nu lj nv ln nn no np nq bi translated">通知/电影名称:疯狂动物城/</li><li id="07ec" class="ni nj iq ku b kv nr ky ns lb nt lf nu lj nv ln nn no np nq bi translated">请求//开始时间</li><li id="3005" class="ni nj iq ku b kv nr ky ns lb nt lf nu lj nv ln nn no np nq bi translated">完成//</li></ul><p id="f52c" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">此外，控制台将询问代理是否成功的指示器(除了在一集的初始动作输入之后)。允许的输入是-1 表示失败，0 表示没有结果，1 表示成功。</p><p id="8ed8" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">与训练有素的代理人一起玩得开心，并定性测试您的改进！</p><h2 id="f5e7" class="mw ma iq bd mb mx my dn mf mz na dp mj lb nb nc ml lf nd ne mn lj nf ng mp nh bi translated">结果</h2><p id="a425" class="pw-post-body-paragraph ks kt iq ku b kv mr jr kx ky ms ju la lb mt ld le lf mu lh li lj mv ll lm ln ij bi translated">我的数据是使用<code class="fe lo lp lq lr b"><a class="ae kr" href="https://github.com/maxbren/GO-Bot-DRL/blob/master/constants.json" rel="noopener ugc nofollow" target="_blank">constants.json</a></code>中设置的超参数收集的，并且是 10 次训练运行的平均值。</p><p id="8a64" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">常数:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nw nx l"/></div></figure><p id="ca07" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">按<em class="ny">一段时间的最大成功率</em>/到该集为止的训练频率(每 100 集)列出的集数(每 40000 集中的 2000 集)表:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/dcf0b9acfbb5b27b568b017282e0fd75.png" data-original-src="https://miro.medium.com/v2/resize:fit:416/format:webp/1*E3s2K6tsy40Bh2w4hvhNjw.png"/></div></figure></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="4888" class="lz ma iq bd mb mc md me mf mg mh mi mj jw mk jx ml jz mm ka mn kc mo kd mp mq bi translated">未来的研究和实验</h1><p id="630a" class="pw-post-body-paragraph ks kt iq ku b kv mr jr kx ky ms ju la lb mt ld le lf mu lh li lj mv ll lm ln ij bi translated">我们刚刚编写的代码是一个非常简单的面向目标的聊天机器人系统的例子。用户 sim 不是太先进，不像 TC-Bot 在这个系统中没有自然语言组件。代理还有很大的改进空间，包括允许更复杂的操作。然而，这是进一步研究和试验这个主题的一个非常好的起点。这里有一些重要的地方需要改进或添加到现有的代码中，或者只是为了研究:</p><h2 id="6018" class="mw ma iq bd mb mx my dn mf mz na dp mj lb nb nc ml lf nd ne mn lj nf ng mp nh bi translated">自然语言</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><a href="https://www.csie.ntu.edu.tw/~yvchen/doc/SLT16_SyntaxSemantics.pdf"><div class="gh gi oa"><img src="../Images/5eef61069999bdf0e1ae61e8a2cd1a53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vl7eiOA08cVWG3x1c3d6hA.png"/></div></a><figcaption class="kn ko gj gh gi kp kq bd b be z dk">Diagram from an NTU and Microsoft paper</figcaption></figure><p id="e1a8" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">在 TC-Bot 中添加自然语言组件，这样您就可以在更真实的对话环境中测试它。请记住，自然语言组件不是用这种深度强化学习循环来训练的，它们是用 LSTMs 使用不同的通常受监督的学习方法单独进行预训练的。这里有几个关于这个话题的资源:<a class="ae kr" href="https://medium.com/analytics-vidhya/building-a-simple-chatbot-in-python-using-nltk-7c8c8215ac6e" rel="noopener">媒体文章</a>、<a class="ae kr" href="https://www.csie.ntu.edu.tw/~yvchen/doc/IS16_MultiJoint.pdf" rel="noopener ugc nofollow" target="_blank"> NTU 论文</a>、<a class="ae kr" href="https://www.csie.ntu.edu.tw/~yvchen/doc/SLT16_SyntaxSemantics.pdf" rel="noopener ugc nofollow" target="_blank"> NTU 和微软</a>当然还有<a class="ae kr" href="https://github.com/MiuLab/TC-Bot" rel="noopener ugc nofollow" target="_blank"> TC-Bot </a>及其<a class="ae kr" href="http://aclweb.org/anthology/I17-1074" rel="noopener ugc nofollow" target="_blank">论文</a>。</p><h2 id="8fec" class="mw ma iq bd mb mx my dn mf mz na dp mj lb nb nc ml lf nd ne mn lj nf ng mp nh bi translated">其他数据集和语料库</h2><p id="c919" class="pw-post-body-paragraph ks kt iq ku b kv mr jr kx ky ms ju la lb mt ld le lf mu lh li lj mv ll lm ln ij bi translated">我们只看到了这个系统如何与一个简单的电影票数据库一起工作。在与此数据库结构相同的另一个数据库上尝试它。请确保相应地更改对话配置，但记住这是一个简单的系统，它只能以找到单个项目来实现用户目标为目标。看看你是否能改变它来找到一个目标需要的多个项目！这里有一些谷歌数据集和一个来自 T2 斯坦福大学的数据集。但是外面还有很多。</p><h2 id="744b" class="mw ma iq bd mb mx my dn mf mz na dp mj lb nb nc ml lf nd ne mn lj nf ng mp nh bi translated">对话状态跟踪</h2><p id="1282" class="pw-post-body-paragraph ks kt iq ku b kv mr jr kx ky ms ju la lb mt ld le lf mu lh li lj mv ll lm ln ij bi translated">状态跟踪的发展可能是聊天机器人中最突出的话题。对于系统的状态跟踪器来说,<em class="ny">准备一个有用的状态让代理采取接近最优的行动是非常重要的。如果重要的信息丢失了，比如用户的行为是什么，那么代理就很难很好的回复。此外，这些信息的编码方式以及是否有无用信息也会影响所采取行动的优化。这里有一些关于 ST: <a class="ae kr" href="https://arxiv.org/pdf/1506.07190.pdf" rel="noopener ugc nofollow" target="_blank">剑桥论文</a>、<a class="ae kr" href="https://www.sigdial.org/files/workshops/conference17/proceedings/pdf/SIGDIAL02.pdf" rel="noopener ugc nofollow" target="_blank">雅虎</a>和<a class="ae kr" href="https://pdfs.semanticscholar.org/4ba3/39bd571585fadb1fb1d14ef902b6784f574f.pdf" rel="noopener ugc nofollow" target="_blank">对话状态跟踪挑战</a>的资源。</em></p><h2 id="b55d" class="mw ma iq bd mb mx my dn mf mz na dp mj lb nb nc ml lf nd ne mn lj nf ng mp nh bi translated">高级 DRL 算法</h2><p id="c359" class="pw-post-body-paragraph ks kt iq ku b kv mr jr kx ky ms ju la lb mt ld le lf mu lh li lj mv ll lm ln ij bi translated">虽然我找不到任何讨论这一点的论文或其他资源，但我尝试了更高级/不同的 DRL 算法，如 A3C、PPO、TRPO、ACKTR、基于模型的方法、基于混合模型的方法等。将是一个伟大的领域进行实验的围棋机器人！请记住，因为这段代码中的训练方法集中在使用内存和在特定时间刷新内存，所以新的训练方法必须伴随不使用内存池的算法(这是大多数算法)。</p><h2 id="d31f" class="mw ma iq bd mb mx my dn mf mz na dp mj lb nb nc ml lf nd ne mn lj nf ng mp nh bi translated">高级用户模拟器</h2><p id="61bf" class="pw-post-body-paragraph ks kt iq ku b kv mr jr kx ky ms ju la lb mt ld le lf mu lh li lj mv ll lm ln ij bi translated">目前有很多关于创建更像人类的用户模拟器的研究，因为这对于获得高质量的培训很重要。这里构建的用户 sim 是可靠的，但仍然可以大大改进。这篇<a class="ae kr" href="http://alborz-geramifard.com/workshops/nips17-Conversational-AI/Papers/17nipsw-cai-collaboration-based-simulator.pdf" rel="noopener ugc nofollow" target="_blank">论文</a>用于构建真实的用户模拟人生。</p><h2 id="4aa1" class="mw ma iq bd mb mx my dn mf mz na dp mj lb nb nc ml lf nd ne mn lj nf ng mp nh bi translated">复杂域</h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><a href="https://www.microsoft.com/en-us/research/uploads/prod/2017/04/emnlp2017_arxiv.pdf"><div class="gh gi ob"><img src="../Images/5c2baf453fe016f4d6183d054d0190c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-YSFR35zqR0GdD0ZFiacLQ.png"/></div></a><figcaption class="kn ko gj gh gi kp kq bd b be z dk">Hierarchical successor to TC-Bot</figcaption></figure><p id="13ed" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated">这里涉及的电影票领域是 GO 聊天机器人的一个实际用例，但仍然非常简单。在大多数情况下，问题的复杂性在现实世界中是上升的，在这里也是如此。面向目标的问题往往是复合的和分层次的，这意味着问题实际上是一堆必须完成的子问题。这篇<a class="ae kr" href="https://www.microsoft.com/en-us/research/uploads/prod/2017/04/emnlp2017_arxiv.pdf" rel="noopener ugc nofollow" target="_blank">论文</a>解释了如何增强现有的 TC-Bot 框架，以允许完成更复杂的层次目标。这又可以添加到这里创建的代码中。</p><h2 id="ac31" class="mw ma iq bd mb mx my dn mf mz na dp mj lb nb nc ml lf nd ne mn lj nf ng mp nh bi translated">更多资源</h2><ul class=""><li id="54b8" class="ni nj iq ku b kv mr ky ms lb oc lf od lj oe ln nn no np nq bi translated"><a class="ae kr" href="http://aclweb.org/anthology/N18-3006" rel="noopener ugc nofollow" target="_blank">高级实战训练</a></li><li id="7a5e" class="ni nj iq ku b kv nr ky ns lb nt lf nu lj nv ln nn no np nq bi translated"><a class="ae kr" href="https://arxiv.org/pdf/1802.00500.pdf" rel="noopener ugc nofollow" target="_blank">用围棋机器人转移学习</a></li><li id="422c" class="ni nj iq ku b kv nr ky ns lb nt lf nu lj nv ln nn no np nq bi translated"><a class="ae kr" href="https://arxiv.org/pdf/1809.08267.pdf" rel="noopener ugc nofollow" target="_blank">深度学习中的一切围棋机器人概述</a></li><li id="6096" class="ni nj iq ku b kv nr ky ns lb nt lf nu lj nv ln nn no np nq bi translated"><a class="ae kr" href="https://www.poly-ai.com/docs/naacl18.pdf" rel="noopener ugc nofollow" target="_blank">深度学习中的一切 GO 机器人的另一个概述</a></li><li id="f9f7" class="ni nj iq ku b kv nr ky ns lb nt lf nu lj nv ln nn no np nq bi translated"><a class="ae kr" href="https://medium.com/gobeyond-ai/a-reading-list-and-mini-survey-of-conversational-ai-32fceea97180" rel="noopener">在聊天机器人上拥有大量资源的大型媒体帖子</a></li></ul><p id="c26f" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><em class="ny">用您目前所学的知识和编码进行实验！随着机器和深度学习的新功能，这个领域正在快速发展！</em></p><p id="7ead" class="pw-post-body-paragraph ks kt iq ku b kv kw jr kx ky kz ju la lb lc ld le lf lg lh li lj lk ll lm ln ij bi translated"><strong class="ku ir">感谢您的关注，希望您能从这个系列和代码中获益良多！如有任何问题，欢迎随时评论！</strong></p></div></div>    
</body>
</html>