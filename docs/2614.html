<html>
<head>
<title>Only Numpy: Implementing Highway Network, OOP approach with Mini Batch with Interactive Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Only Numpy:实现高速公路网络，使用带有交互代码的小批量OOP方法</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/only-numpy-implementing-highway-network-oop-approach-with-mini-batch-with-interactive-code-b5c2de2df842?source=collection_archive---------8-----------------------#2018-02-12">https://towardsdatascience.com/only-numpy-implementing-highway-network-oop-approach-with-mini-batch-with-interactive-code-b5c2de2df842?source=collection_archive---------8-----------------------#2018-02-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/cd380d80469f3c04f4d2e7f37bcd1006.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-OkJBYW58x1kifsE7hBXnQ.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo of Han River in <a class="ae kc" href="https://pixabay.com/en/seoul-south-korea-lotte-tower-2968290/" rel="noopener ugc nofollow" target="_blank">Seoul, from Pixel Bay</a></figcaption></figure><p id="ee66" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我今天感觉有点懒，但是我仍然想练习我的反向传播技能以及实现神经网络的OOP方法。因此，实施网络的明显选择是<a class="ae kc" href="https://arxiv.org/pdf/1505.00387.pdf" rel="noopener ugc nofollow" target="_blank">高速公路网</a>。(我想实现这个网络已经有一段时间了。)</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><p id="9feb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">网络架构(数学形式)/修改</strong></p><figure class="lj lk ll lm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi li"><img src="../Images/98a3c695cad0788166033818c10b481f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q4tZusrrvnyU9B_8jBRbZw.png"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Screen Shot from <a class="ae kc" href="https://arxiv.org/pdf/1505.00387.pdf" rel="noopener ugc nofollow" target="_blank">Original Paper</a></figcaption></figure><p id="8250" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">红框→ </strong>仿射变换+非线性激活，我们可以认为这是标准全连接网络中的“正常”层</p><p id="115f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">蓝框</strong> →变换门，我们也可以认为是仿射变换+非线性激活(但激活函数不同)</p><p id="9186" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">绿框</strong> →我们将在原始文件的基础上增加我们的修改。在论文中，我们应该直接传递输入，然而为了匹配维度，我将在这里添加仿射变换以及非线性激活函数。(另外，请注意，我将把它们称为“A ”,作为“Added”的缩写形式。)</p><figure class="lj lk ll lm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ln"><img src="../Images/471478352394d145baebfd2d501f55d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5WMg8Jqgep05Ov2XYmR1Pw.png"/></div></div></figure><p id="c078" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以防万一，如果有人想知道，原始论文的作者实际上说，如果需要改变维度。然而，为了尽可能保持输入“不变”,我将为添加的部分初始化权重，如下所示。</p><figure class="lj lk ll lm gt jr gh gi paragraph-image"><div class="gh gi lo"><img src="../Images/949b4282f9a4c33dbb257cb9ca7e316f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1098/format:webp/1*y8pg9PmyO90N0ivGDhhNdA.png"/></div></figure><p id="769f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当公路图层对象初始化时，添加部分的权重都被初始化为1，而不是高斯分布。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><p id="c70e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">网络架构(面向对象形式)</strong></p><figure class="lj lk ll lm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lp"><img src="../Images/13735659bb9e7047f7c577e350a1152b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vSqRcvxb4B6_VQQtS9w47A.png"/></div></div></figure><p id="174a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">红框</strong> →每层进给部分</p><p id="6cfb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">蓝框</strong> →每层反向传播</p><p id="7cbe" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">绿色下划线</strong> →来自下一层的梯度，需要计算当前层的梯度</p><p id="2bd7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">黄框</strong> →在更新权重之前，计算传递到前一层<em class="lq">的梯度(为了保持链式法则。)</em></p><p id="e49f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">粉色下划线</strong> →将渐变传递给上一层，计算其渐变。</p><p id="72bb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我真的很喜欢这种面向对象的方法，我想我会以这种方式实现我的大部分神经网络。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><p id="9843" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">前馈/反向传播</strong></p><figure class="lj lk ll lm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lr"><img src="../Images/46146f459efcf599949acb8235197d42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HufgDcni5zQZUzTK77O3Zw.png"/></div></div></figure><p id="5573" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">红框</strong> →用合适的维度初始化各层</p><p id="26ef" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">黄框</strong> →前馈操作以及重量更新的反向传播。最小批量为3。</p><p id="9504" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">粉色方框</strong> →每2次迭代，看网络做的怎么样。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><p id="164c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">训练和结果</strong></p><figure class="lj lk ll lm gt jr gh gi paragraph-image"><div class="gh gi ls"><img src="../Images/0cb72137e10e8beb4ff5595500985593.png" data-original-src="https://miro.medium.com/v2/resize:fit:974/format:webp/1*IBKWQ42tE2n5jeycFf0kMA.png"/></div></figure><p id="f675" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">首先，成本从3.75英镑开始，然后下降到1.9英镑，所以网络似乎在学习。然而准确性是可笑的LOL。</p><figure class="lj lk ll lm gt jr gh gi paragraph-image"><div class="gh gi lt"><img src="../Images/53ee8a0b7f3dc20ec4c583574824f655.png" data-original-src="https://miro.medium.com/v2/resize:fit:1354/format:webp/1*Sg0a72MD6_ZlSrjwfGu1kA.png"/></div></figure><p id="becd" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">四层高速公路网77%的准确率，我不知道这是好是坏。如果你能提高网络准确度，请分享你的森派诀窍！</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><p id="d635" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">交互代码</strong></p><figure class="lj lk ll lm gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi lu"><img src="../Images/c2cf3dec90edce85d4d015509515ffc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oA6SvXea7UnoR8fowGy1mw.png"/></div></div></figure><p id="21d1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lq">我搬到了谷歌Colab寻找交互代码！所以你需要一个谷歌帐户来查看代码，你也不能在谷歌实验室运行只读脚本，所以在你的操场上做一个副本。最后，我永远不会请求允许访问你在Google Drive上的文件，仅供参考。编码快乐！</em></p><p id="88c8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">要访问互动<a class="ae kc" href="https://colab.research.google.com/drive/1-xrEyQmJKcBqqRNLRqhil6kxd8n-xEQw" rel="noopener ugc nofollow" target="_blank"> e代码，请点击此处</a>。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><p id="a622" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">最后的话</strong></p><p id="cfb1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我知道我应该努力提高模型的准确性，但今晚我只是觉得很懒，对不起，哈哈。</p><p id="234b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果发现任何错误，请发电子邮件到jae.duk.seo@gmail.com找我。</p><p id="ccc9" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同时，在我的twitter <a class="ae kc" href="https://twitter.com/JaeDukSeo" rel="noopener ugc nofollow" target="_blank">这里</a>关注我，并访问<a class="ae kc" href="https://jaedukseo.me/" rel="noopener ugc nofollow" target="_blank">我的网站</a>，或我的<a class="ae kc" href="https://www.youtube.com/c/JaeDukSeo" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>了解更多内容。如果你感兴趣的话，我还做了解耦神经网络的比较。</p></div><div class="ab cl lb lc hu ld" role="separator"><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg lh"/><span class="le bw bk lf lg"/></div><div class="ij ik il im in"><p id="1afc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">参考</strong></p><ol class=""><li id="4aad" class="lv lw iq kf b kg kh kk kl ko lx ks ly kw lz la ma mb mc md bi translated">Srivastava，R. K .，Greff，k .，&amp; Schmidhuber，J. (2015年)。高速公路网。<em class="lq"> arXiv预印本arXiv:1505.00387 </em>。</li><li id="d17c" class="lv lw iq kf b kg me kk mf ko mg ks mh kw mi la ma mb mc md bi translated">Romero，a .，Ballas，n .，Kahou，S. E .，Chassang，a .，Gatta，c .，&amp; Bengio，Y. (2014年)。Fitnets:薄深网的提示。arXiv预印本arXiv:1412.6550 。</li></ol></div></div>    
</body>
</html>