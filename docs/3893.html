<html>
<head>
<title>Speech recognition on Raspberry Pi 3 B</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">树莓 Pi 3 B 上的语音识别</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/speech-recognition-on-raspberry-pi-3-b-8351c418dc25?source=collection_archive---------11-----------------------#2018-06-28">https://towardsdatascience.com/speech-recognition-on-raspberry-pi-3-b-8351c418dc25?source=collection_archive---------11-----------------------#2018-06-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/37f53873103af24c1d08ce4a0443d887.png" data-original-src="https://miro.medium.com/v2/resize:fit:924/format:webp/1*DXkEWI6tMHrm-jgdMNSwGQ.jpeg"/></div></figure><p id="76bb" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">网上分享的大多数 Raspberry Pi 语音转文本示例似乎依赖于各种云解决方案(例如<a class="ae ks" href="https://cloud.google.com/speech-to-text/" rel="noopener ugc nofollow" target="_blank">谷歌云语音转文本</a>)进行实际的音频处理。本文将向您展示如何在您的 Raspberry Pi 上配置一个不需要第三方云服务的“离线”语音处理解决方案。</p><p id="50fe" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我们将使用<a class="ae ks" href="https://cmusphinx.github.io/" rel="noopener ugc nofollow" target="_blank"> CMUSphinx </a>，一组由<a class="ae ks" href="https://www.cmu.edu/" rel="noopener ugc nofollow" target="_blank">卡耐基梅隆大学</a>开发的连续语音、非特定人语音识别系统。</p><p id="8967" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">第一步</strong>。打开您的虚拟环境(除非您想要全局安装)。使用<em class="kt"> virtualenv </em>的好处在我之前关于 OpenCV 的<a class="ae ks" href="https://www.alatortsev.com/2018/04/27/installing-opencv-on-raspberry-pi-3-b/" rel="noopener ugc nofollow" target="_blank">文章</a>中有解释。我的名为“cv ”,我通过发出以下命令启动它:</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="b45a" class="ld le iq kz b gy lf lg l lh li">workon cv</span></pre><p id="00d1" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我的 shell 提示符会相应地改变:</p><figure class="ku kv kw kx gt jr gh gi paragraph-image"><div class="gh gi lj"><img src="../Images/55ac89c03e32c4c138ac0a9063edef3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/0*UDiMDFj6kVD3cXwV.png"/></div></figure><p id="5d10" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">第二步</strong>。更新包列表并获取包的新版本(可能需要几分钟):</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="99d9" class="ld le iq kz b gy lf lg l lh li">sudo apt-get update <br/>sudo apt-get upgrade</span></pre><p id="30ba" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">第三步</strong>。如果您要使用麦克风(相对于处理音频文件或从其他设备接收音频流)，请验证您的声卡配置:</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="8674" class="ld le iq kz b gy lf lg l lh li">cat /proc/asound/cards</span></pre><p id="1b7d" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">我的树莓派 3B 显示如下:</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="51d9" class="ld le iq kz b gy lf lg l lh li">(cv) pi@raspberrypi:~ $ cat /proc/asound/cards<br/> 0 [ALSA ]: bcm2835_alsa - bcm2835 ALSA <br/>            bcm2835 ALSA <br/>(cv) pi@raspberrypi:~ $</span></pre><p id="a40c" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">第四步</strong>。安装 Bison (GNU 解析器生成器):</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="d9cd" class="ld le iq kz b gy lf lg l lh li">sudo apt-get install bison</span></pre><p id="25db" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">第五步</strong>。安装 ALSA(高级 Linux 声音架构)库:</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="4455" class="ld le iq kz b gy lf lg l lh li">sudo apt-get install libasound2-dev</span></pre><p id="cffb" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">第六步</strong>。下载并解压<em class="kt"> sphinxbase </em>(最新版本为 5 个真实版本，此处显示<a class="ae ks" href="https://sourceforge.net/projects/cmusphinx/files/sphinxbase/5prealpha/" rel="noopener ugc nofollow" target="_blank"/>):</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="141c" class="ld le iq kz b gy lf lg l lh li">wget <a class="ae ks" href="https://sourceforge.net/projects/cmusphinx/files/sphinxbase/5prealpha/sphinxbase-5prealpha.tar.gz" rel="noopener ugc nofollow" target="_blank">https://sourceforge.net/projects/cmusphinx/files/sphinxbase/5prealpha/sphinxbase-5prealpha.tar.gz</a></span><span id="5cb5" class="ld le iq kz b gy lk lg l lh li">tar -xzvf sphinxbase-5prealpha.tar.gz</span></pre><p id="9bef" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">第七步</strong>。安装 SWIG。SWIG 是一个接口编译器，它将用 C 和 C++编写的程序与 Python 等脚本语言连接起来:</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="e572" class="ld le iq kz b gy lf lg l lh li">sudo apt-get install swig</span></pre><p id="8fb3" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">第八步</strong>。进入刚刚提取的 sphinxbase 目录并编译 sphinx base——确保没有错误:</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="6450" class="ld le iq kz b gy lf lg l lh li">cd sphinxbase-5prealpha <br/>./configure --enable-fixed <br/>make clean all <br/>sudo make install</span></pre><p id="e655" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">第九步</strong>。下载并解压<em class="kt"> pocketsphinx </em>(同样，最新版本是 5prealpha，此处显示为<a class="ae ks" href="https://sourceforge.net/projects/cmusphinx/files/pocketsphinx/5prealpha/" rel="noopener ugc nofollow" target="_blank"/>)，但首先向上一个目录:</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="66d7" class="ld le iq kz b gy lf lg l lh li">cd .. </span><span id="fede" class="ld le iq kz b gy lk lg l lh li">wget <a class="ae ks" href="https://sourceforge.net/projects/cmusphinx/files/pocketsphinx/5prealpha/pocketsphinx-5prealpha.tar.gz" rel="noopener ugc nofollow" target="_blank">https://sourceforge.net/projects/cmusphinx/files/pocketsphinx/5prealpha/pocketsphinx-5prealpha.tar.gz</a></span><span id="ae09" class="ld le iq kz b gy lk lg l lh li">tar -xzvf pocketsphinx-5prealpha.tar.gz</span></pre><p id="98cd" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">第十步</strong>。进入刚刚提取的 pocketsphinx 目录并编译 pocket sphinx——确保没有错误:</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="9b08" class="ld le iq kz b gy lf lg l lh li">cd pocketsphinx-5prealpha <br/>./configure <br/>make <br/>sudo make install <br/>export LD_LIBRARY_PATH=/usr/local/lib <br/>export PKG_CONFIG_PATH=/usr/local/lib/pkgconfig</span></pre><p id="fce0" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">第十一步</strong>。获取一些音频文件进行测试。我们将使用来自<a class="ae ks" href="http://www.voiptroubleshooter.com/open_speech/american.html" rel="noopener ugc nofollow" target="_blank">开放语音库</a>的几个美国英语样本:</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="ae3e" class="ld le iq kz b gy lf lg l lh li">wget <a class="ae ks" href="http://www.voiptroubleshooter.com/open_speech/american/OSR_us_000_0019_8k.wav" rel="noopener ugc nofollow" target="_blank">http://www.voiptroubleshooter.com/open_speech/american/OSR_us_000_0019_8k.wav</a> </span><span id="5601" class="ld le iq kz b gy lk lg l lh li">wget <a class="ae ks" href="http://www.voiptroubleshooter.com/open_speech/american/OSR_us_000_0030_8k.wav" rel="noopener ugc nofollow" target="_blank">http://www.voiptroubleshooter.com/open_speech/american/OSR_us_000_0030_8k.wav</a></span></pre><p id="27ea" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">第十二步</strong>。这是我在一个样本上运行斯芬克斯。我下载的 wav 文件:</p><pre class="ku kv kw kx gt ky kz la lb aw lc bi"><span id="bc38" class="ld le iq kz b gy lf lg l lh li">pocketsphinx_continuous -samprate 8000 -hmm en-us-8khz -infile OSR_us_000_0030_8k.wav</span></pre><p id="5bf6" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">正如你从我下面的屏幕记录中看到的，这个过程不是很快，所以我需要优化:</p><div class="ll lm gp gr ln lo"><a href="https://asciinema.org/a/3UNRmoCxmNOj5KfkKpR810ZUB" rel="noopener  ugc nofollow" target="_blank"><div class="lp ab fo"><div class="lq ab lr cl cj ls"><h2 class="bd ir gy z fp lt fr fs lu fu fw ip bi translated">使用 Sphinx 解析一个小的。wav 文件</h2><div class="lv l"><h3 class="bd b gy z fp lt fr fs lu fu fw dk translated">迈克尔·阿拉托尔采夫录制</h3></div><div class="lw l"><p class="bd b dl z fp lt fr fs lu fu fw dk translated">asciinema.org</p></div></div><div class="lx l"><div class="ly l lz ma mb lx mc js lo"/></div></div></a></div><p id="2297" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><strong class="jw ir">出了问题怎么办？</strong> <br/>如果你第一次编译或运行<em class="kt"> pocketsphinxcontinuous </em>时遇到错误，请在下面的评论中分享你的错误信息，我会添加一些故障排除步骤。在我的例子中，我必须帮助编译器找到一些库。我还不得不<a class="ae ks" href="https://sourceforge.net/projects/cmusphinx/files/Acoustic%20and%20Language%20Models/US%20English/" rel="noopener ugc nofollow" target="_blank">下载</a>一个 8kHz 的 Sphinx 声学模型，以便处理我的。wav 样本。</p><p id="1685" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated">祝你好运！</p></div><div class="ab cl md me hu mf" role="separator"><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi mj"/><span class="mg bw bk mh mi"/></div><div class="ij ik il im in"><p id="07ef" class="pw-post-body-paragraph ju jv iq jw b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ij bi translated"><em class="kt">原载于 2018 年 6 月 28 日</em><a class="ae ks" href="https://www.alatortsev.com/2018/06/28/speech-processing-on-raspberry-pi-3-b/" rel="noopener ugc nofollow" target="_blank"><em class="kt">www.alatortsev.com</em></a><em class="kt">。</em></p></div></div>    
</body>
</html>