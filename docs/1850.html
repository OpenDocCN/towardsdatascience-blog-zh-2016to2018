<html>
<head>
<title>Machine Learning Meets Fashion</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习遇上时尚</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-meets-fashion-48ee8f6541ad?source=collection_archive---------3-----------------------#2017-11-03">https://towardsdatascience.com/machine-learning-meets-fashion-48ee8f6541ad?source=collection_archive---------3-----------------------#2017-11-03</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="07db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在《人工智能历险记》的这一集中，我们将尝试把整个机器学习工作流程整合成一个流程，从我们之前的剧集中汲取最佳实践。这是一个很大的材料，但我认为我们可以做到这一点！</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="kq kr l"/></div></figure><p id="1e74" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">用<a class="ae ks" href="http://yann.lecun.com/exdb/mnist/" rel="noopener ugc nofollow" target="_blank"> MNIST数据集</a>训练一个模型通常被认为是机器学习的“Hello world”。这已经做过很多次了，但不幸的是，仅仅因为一个模型在MNIST上表现良好，并不一定意味着它在其他数据集上的高性能预测，尤其是因为我们今天拥有的大多数图像数据都比手写数字复杂得多。</p><h1 id="8274" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">时髦的机器学习</h1><p id="122b" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">Zalando决定是时候让<a class="ae ks" href="https://github.com/zalandoresearch/fashion-mnist" rel="noopener ugc nofollow" target="_blank"> MNIST再次流行起来</a>，最近发布了一个名为<code class="fe lw lx ly lz b">fashion-mnist</code>的数据集。这是与“常规”MNIST完全相同的格式，除了数据是以各种服装类型、鞋子和包包的图片的形式。它仍然跨越10个类别，图像仍然是28×28像素。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mb"><img src="../Images/3e0a69da576c12e64315258487702eaa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3bi1v9ecUtTWMOLpj7LKjQ.png"/></div></div></figure><p id="780c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们训练一个模型来检测正在展示哪种类型的服装！</p><h1 id="7e42" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">线性分类器</h1><p id="172b" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">我们将从构建一个线性分类器开始，看看我们是如何做的。像往常一样，我们将使用<a class="ae ks" href="https://www.tensorflow.org/extend/estimators" rel="noopener ugc nofollow" target="_blank"> TensorFlow的评估框架</a>来使我们的代码易于编写和维护。提醒一下，我们将加载数据，创建分类器，然后运行训练和评估。我们也将直接从本地模型中做出一些预测。</p><p id="0b28" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们从创建模型开始。我们将把数据集从28x28像素展平到1x784像素，并创建一个名为<code class="fe lw lx ly lz b">pixels</code>的特征列。这类似于我们第三集的<code class="fe lw lx ly lz b">flower_features</code>，<a class="ae ks" href="https://medium.com/towards-data-science/plain-and-simple-estimators-d8d3f4c185c1" rel="noopener">简单明了的评估者</a>。</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="mi kr l"/></div></figure><p id="5998" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，让我们创建我们的线性分类器。我们有10个不同的可能的类别来标记，而不是我们之前使用的鸢尾花的3个类别。</p><p id="aa40" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了运行我们的训练，我们需要设置数据集和输入函数。TensorFlow有一个内置的实用程序来接受一个<code class="fe lw lx ly lz b">numpy</code>数组来生成一个输入函数，所以我们将利用它。</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="mi kr l"/></div></figure><p id="6d38" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将使用<code class="fe lw lx ly lz b">input_data</code>模块加载我们的数据集。将函数指向下载数据集的文件夹。</p><p id="b178" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们可以调用<code class="fe lw lx ly lz b">classifier.train()</code>来集合我们的分类器、输入函数和数据集。</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="mi kr l"/></div></figure><p id="ea66" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，我们运行一个评估步骤，看看我们的模型做得如何。当我们使用经典的MNIST数据集时，这个模型通常可以达到91%的准确率。然而，fashion-mnist是一个相当复杂的数据集，我们只能达到80%左右的精度，有时甚至更低。</p><p id="7dc7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们怎样才能做得更好？正如我们在第六集看到的，<a class="ae ks" href="https://medium.com/towards-data-science/estimators-revisited-deep-neural-networks-311f38fe1986" rel="noopener">让我们深入</a>！</p><h1 id="d512" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">深入</h1><p id="a06d" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">换入DNNClassifier只是一行的变化，我们现在可以重新运行我们的训练和评估，看看深度神经网络是否能比线性神经网络表现得更好。</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="mi kr l"/></div></figure><p id="e0ae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如我们在<a class="ae ks" href="https://medium.com/towards-data-science/visualizing-your-model-using-tensorboard-796ebb73e98d" rel="noopener">第5集</a>中所讨论的，我们现在应该打开<a class="ae ks" href="https://www.tensorflow.org/get_started/summaries_and_tensorboard" rel="noopener ugc nofollow" target="_blank"> TensorBoard </a>来并排看看这两个模型！</p><p id="8cc4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe lw lx ly lz b">$ tensorboard --logdir=models/fashion_mnist/</code></p><p id="6a3d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">(浏览至<a class="ae ks" href="http://localhost:6006" rel="noopener ugc nofollow" target="_blank"> http://localhost:6006 </a>)</p><h2 id="eafd" class="mj ku iq bd kv mk ml dn kz mm mn dp ld jy mo mp lh kc mq mr ll kg ms mt lp mu bi translated">张量板</h2><p id="c003" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">看看tensorboard，看起来我的深度模型并不比我的线性模型表现得更好！这也许是一个调整我的一些超参数的机会，就像在<a class="ae ks" href="https://medium.com/towards-data-science/the-7-steps-of-machine-learning-2877d7e5548e" rel="noopener">第2集</a>中讨论的那样。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi mv"><img src="../Images/cdbde8b20bbc553c502daa313d2e528e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cVVu0UokMYdBuMbC9szWNw.png"/></div></div><figcaption class="mw mx gj gh gi my mz bd b be z dk">Looks like a race to the bottom…</figcaption></figure><p id="e61b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">也许我的模型需要更大，以适应这个数据集中的复杂性？或者也许我的学习速度需要降低？让我们试试看。稍微试验一下这些参数，我们就可以突破，获得比线性模型更高的精度。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><div class="gh gi na"><img src="../Images/ec6d64b7b1e7e57544dacba97ec141aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tsR4_3ressFX_rLUGWuwsQ.png"/></div></div><figcaption class="mw mx gj gh gi my mz bd b be z dk">The deep model (in blue/red) achieves a consistently lower loss</figcaption></figure><p id="e3af" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要达到这种精度需要更多的训练步骤，但最终对于更高精度的数字来说，这是值得的。</p><p id="01d2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">还要注意，线性模型比深度网络更早达到稳定状态。因为深度模型通常比线性模型更复杂，所以它们需要更长的训练时间。</p><p id="bf93" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个阶段，假设我们对我们的模型很满意。我们将能够导出它并产生一个可伸缩的时尚分类器API。你可以看<a class="ae ks" href="https://medium.com/@yufengg/serverless-predictions-at-scale-28ab77203a42" rel="noopener">第4集</a>了解更多关于如何做的细节。</p><h1 id="22e6" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">做预测</h1><p id="b256" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">让我们快速浏览一下如何使用估计器进行预测。在很大程度上，它看起来就像我们如何调用培训和评估；这是评估者的伟大之处之一——一致的界面。</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="mi kr l"/></div></figure><p id="3052" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意，这一次我们指定了1的<code class="fe lw lx ly lz b">batch_size</code>、1的<code class="fe lw lx ly lz b">num_epochs</code>和假的<code class="fe lw lx ly lz b">shuffle</code>。这是因为我们希望预测一个接一个地进行，一次对所有数据进行预测，保持顺序。我从评估数据集的中间提取了5幅图像，供我们尝试预测。</p><div class="kl km kn ko gt ab cb"><figure class="nb kp nc nd ne nf ng paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><img src="../Images/07d8fa0f61b4e4eec9e9e689493ee713.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*DwVg7H4GKhz8IPK-z1BU5Q.png"/></div></figure><figure class="nb kp nh nd ne nf ng paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><img src="../Images/368a5f60704058ae1159edeea371a5c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:658/format:webp/1*V7NBJ0Pos7_pAiT5QeF3Ug.png"/></div></figure><figure class="nb kp ni nd ne nf ng paragraph-image"><div role="button" tabindex="0" class="mc md di me bf mf"><img src="../Images/84baebf3520915c17e051f3c067982b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*Sg8nkiUSqnOERSKNKO5kAQ.png"/></div></figure></div><div class="ab cb"><figure class="nb kp nj nd ne nf ng paragraph-image"><img src="../Images/f83119173c89c9b5b6b3ce6605ca8dc6.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*VJNAJEmCqHcgTiAhAkIFzQ.png"/></figure><figure class="nb kp nk nd ne nf ng paragraph-image"><img src="../Images/220c409cdaef9677d423ecd517c6c519.png" data-original-src="https://miro.medium.com/v2/resize:fit:716/format:webp/1*BtEROshGMssvllX0uRzSDA.png"/></figure></div><p id="036a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我选择这5个不仅仅是因为它们在中间，而是因为模型得到了其中的2个错误。这两个例子都应该是衬衫，但是模型认为第三个例子是一个包，第五个例子是一件外套。你可以看到这些例子比手写数字更具挑战性，如果没有其他原因，只是图像的颗粒感。</p><h1 id="bcdc" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">后续步骤</h1><p id="1792" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">你可以在这里找到我用来训练这个模型并生成图像的全部代码<a class="ae ks" href="https://gist.github.com/yufengg/2b2fd4b81b72f0f9c7b710fa87077145" rel="noopener ugc nofollow" target="_blank">。你的模特表现如何？你最终使用了什么参数来达到这个精度？请在评论中告诉我！</a></p><p id="bdfd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的下一集将关注机器学习生态系统的一些工具，以帮助您构建工作流和工具链，并展示更多可以用来解决机器学习问题的架构。我期待在那里见到你！在那之前，继续机器学习！</p></div><div class="ab cl nl nm hu nn" role="separator"><span class="no bw bk np nq nr"/><span class="no bw bk np nq nr"/><span class="no bw bk np nq"/></div><div class="ij ik il im in"><p id="de10" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢阅读本集<a class="ae ks" href="https://goo.gl/UC5usG" rel="noopener ugc nofollow" target="_blank">云AI冒险</a>。如果你喜欢这个系列，请为这篇文章鼓掌让我知道。如果你想要更多的机器学习动作，一定要关注Medium 上的<a class="ae ks" href="https://medium.com/@yufengg" rel="noopener"> me或者订阅YouTube频道</a>来观看未来的剧集。更多剧集即将推出！</p></div></div>    
</body>
</html>