<html>
<head>
<title>My Journey into Deep Learning using Keras</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我使用 Keras 的深度学习之旅</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/my-journey-into-deeplearning-using-keras-part-1-67cbb50f65e6?source=collection_archive---------13-----------------------#2018-11-02">https://towardsdatascience.com/my-journey-into-deeplearning-using-keras-part-1-67cbb50f65e6?source=collection_archive---------13-----------------------#2018-11-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="ffae" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">介绍如何在 Keras 中从头开始构建和训练神经网络。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/10b5bbd610d0341528eea645a953fa81.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hdmMiaU6kwtMtCVl"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">PC: <a class="ae kv" href="https://unsplash.com/@flopez_nice?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Felipe Lopez</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><blockquote class="kw"><p id="6652" class="kx ky iq bd kz la lb lc ld le lf lg dk translated">“不要相信短期炒作，但要相信长期愿景。人工智能可能需要一段时间才能发挥其真正的潜力——这种潜力的全部程度还没有人敢梦想——但人工智能正在到来，它将以一种奇妙的方式改变我们的世界”——Francois Chollet</p></blockquote><p id="4acd" class="pw-post-body-paragraph lh li iq lj b lk ll jr lm ln lo ju lp lq lr ls lt lu lv lw lx ly lz ma mb lg ij bi translated">深度学习是机器学习的一个迷人领域，也是一个有前途的领域。它表现得非常好，尤其是在视觉和听觉等感知问题领域，这些问题曾经是机器无法解决的。我第一次接触深度学习发生在几年前，当时我正在 Kaggle 解决问题。正是在这里，我被介绍给 Keras，我想探索它的细节。在我遇到的所有其他深度学习库中，我发现 Keras 非常容易、灵活和简单易用。文档和示例也很方便，容易理解。</p><p id="aaea" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">为了对这个主题有更强的理解，我一直在看一本名为《<a class="ae kv" href="https://twitter.com/fchollet" rel="noopener ugc nofollow" target="_blank"><strong class="lj ir">Francois Chollet</strong></a><strong class="lj ir"/>用 Python  进行深度学习》的书，他也是 Keras <strong class="lj ir">的作者。这已经成为我最喜欢的关于这个话题的书之一，我从中学到了很多。就像我常说的，我有在阅读任何书籍时创建笔记的习惯，所以这里是我从使用 Python 的<strong class="lj ir">深度学习</strong>一书中获得的笔记。我试图总结基本概念，并以一篇文章的形式呈现出来。对于任何想开始或刚刚开始进入深度学习世界的人来说，这些笔记会很有用。</strong></p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="edf0" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated">目标</h1><p id="cd6a" class="pw-post-body-paragraph lh li iq lj b lk ng jr lm ln nh ju lp lq ni ls lt lu nj lw lx ly nk ma mb lg ij bi translated">本文的目标是熟悉 Keras 的世界、它的安装、部署以及如何用它来解决机器学习问题。本文不涉及像 LSTM、康维兹等先进的深度学习概念。我打算在我的下一系列文章中讨论这些主题。</p><h1 id="2624" class="mo mp iq bd mq mr nl mt mu mv nm mx my jw nn jx na jz no ka nc kc np kd ne nf bi translated">你应该知道什么</h1><p id="62b6" class="pw-post-body-paragraph lh li iq lj b lk ng jr lm ln nh ju lp lq ni ls lt lu nj lw lx ly nk ma mb lg ij bi translated">由于你已经涉足深度学习领域，并且对 Keras 特别感兴趣，所以假设你:</p><ul class=""><li id="5bab" class="nq nr iq lj b lk mc ln md lq ns lu nt ly nu lg nv nw nx ny bi translated">有基本的编程经验</li><li id="5d01" class="nq nr iq lj b lk nz ln oa lq ob lu oc ly od lg nv nw nx ny bi translated">有一个在 Python 和</li><li id="f018" class="nq nr iq lj b lk nz ln oa lq ob lu oc ly od lg nv nw nx ny bi translated">都知道基本的机器学习概念。</li></ul></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="212f" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated">目录</h1><ul class=""><li id="e3d4" class="nq nr iq lj b lk ng ln nh lq oe lu of ly og lg nv nw nx ny bi translated">深度学习:初级读本</li><li id="5234" class="nq nr iq lj b lk nz ln oa lq ob lu oc ly od lg nv nw nx ny bi translated">Keras:简介|安装|硬件要求</li><li id="16cb" class="nq nr iq lj b lk nz ln oa lq ob lu oc ly od lg nv nw nx ny bi translated">MNIST 的 Keras 工作流程示例</li><li id="9458" class="nq nr iq lj b lk nz ln oa lq ob lu oc ly od lg nv nw nx ny bi translated">结论</li></ul></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="2245" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated">1.深度学习:初级读本</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/3c0dde6c4cc5a2732c6c3b848fc970a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:708/format:webp/1*B5cal2HdtVbJu-P5XyILpA.png"/></div></figure><p id="a8af" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">深度学习是机器学习的一个特定子领域。深度学习强调学习越来越有意义的表示的连续<em class="oi">层</em>。深度学习中的<strong class="lj ir"> <em class="oi">深度</em> </strong> <em class="oi"> </em>代表使用连续层表示的思想。这些分层表示是通过被称为神经网络的模型来学习的，这些神经网络被构造成堆叠在彼此顶部的文字层。</p><h2 id="5cff" class="oj mp iq bd mq ok ol dn mu om on dp my lq oo op na lu oq or nc ly os ot ne ou bi translated">为什么现在要深度学习？</h2><p id="9707" class="pw-post-body-paragraph lh li iq lj b lk ng jr lm ln nh ju lp lq ni ls lt lu nj lw lx ly nk ma mb lg ij bi translated">总的来说，今天有三种技术力量正在推动机器学习的重大进步</p><ul class=""><li id="80c5" class="nq nr iq lj b lk mc ln md lq ns lu nt ly nu lg nv nw nx ny bi translated">五金器具</li><li id="89c9" class="nq nr iq lj b lk nz ln oa lq ob lu oc ly od lg nv nw nx ny bi translated">数据集和基准以及</li><li id="4ba1" class="nq nr iq lj b lk nz ln oa lq ob lu oc ly od lg nv nw nx ny bi translated">算法进步</li></ul><p id="69c0" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">正是由于今天所有这三个领域的丰富和改进，深度学习获得了动力。</p><h2 id="e773" class="oj mp iq bd mq ok ol dn mu om on dp my lq oo op na lu oq or nc ly os ot ne ou bi translated">深度学习到目前为止取得了哪些成果</h2><p id="ef67" class="pw-post-body-paragraph lh li iq lj b lk ng jr lm ln nh ju lp lq ni ls lt lu nj lw lx ly nk ma mb lg ij bi translated">深度学习已经取得的一些主要成功是:</p><ul class=""><li id="4605" class="nq nr iq lj b lk mc ln md lq ns lu nt ly nu lg nv nw nx ny bi translated">接近人类水平的图像分类和语音识别。</li><li id="c8d5" class="nq nr iq lj b lk nz ln oa lq ob lu oc ly od lg nv nw nx ny bi translated">接近人类水平的手写转录</li><li id="d202" class="nq nr iq lj b lk nz ln oa lq ob lu oc ly od lg nv nw nx ny bi translated">改进的机器翻译</li><li id="f362" class="nq nr iq lj b lk nz ln oa lq ob lu oc ly od lg nv nw nx ny bi translated">改进的文本到语音转换</li><li id="0ef7" class="nq nr iq lj b lk nz ln oa lq ob lu oc ly od lg nv nw nx ny bi translated">Google Now 和亚马逊 Alexa 等数字助手</li><li id="fead" class="nq nr iq lj b lk nz ln oa lq ob lu oc ly od lg nv nw nx ny bi translated">回答自然语言问题的能力</li></ul></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="9ddf" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated">2.keras:Python 深度学习库</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/548c77986cc1b5735dcae44f3a25044d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*GSonv2HGrtELRBLm-ZA_bw.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk"><a class="ae kv" href="https://keras.io/#keras-the-python-deep-learning-library" rel="noopener ugc nofollow" target="_blank">source</a></figcaption></figure><p id="4ace" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated"><a class="ae kv" href="https://keras.io/#keras-the-python-deep-learning-library" rel="noopener ugc nofollow" target="_blank"> <strong class="lj ir"> Keras </strong> </a> (κέρας)在希腊语中是<em class="oi">号角</em>的意思。这是指古希腊和拉丁文学中的一个文学形象，最早见于《奥德赛》。 Keras 最初是作为 ONEIROS 项目(开放式神经电子智能机器人操作系统)研究工作的一部分而开发的。Keras 是一个用 Python 构建深度神经网络的框架。Keras 使我们能够建立最先进的深度学习系统，就像在谷歌和脸书使用的那些系统一样，没有什么复杂性，也只有几行代码。其<strong class="lj ir">的一些主要特征</strong>是:</p><ul class=""><li id="4964" class="nq nr iq lj b lk mc ln md lq ns lu nt ly nu lg nv nw nx ny bi translated">用户友好的 API</li><li id="eef8" class="nq nr iq lj b lk nz ln oa lq ob lu oc ly od lg nv nw nx ny bi translated">内置对卷积网络(用于计算机视觉)、递归网络(用于序列处理)以及两者任意组合的支持。</li><li id="b101" class="nq nr iq lj b lk nz ln oa lq ob lu oc ly od lg nv nw nx ny bi translated">支持任意网络架构:多输入或多输出模型、层共享、模型共享等等。</li></ul><p id="e8e8" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">Keras 是用 Python 编写的前端层，运行在其他流行的深度学习工具包之上，如<strong class="lj ir"> TensorFlow、Theano </strong>和<strong class="lj ir">微软认知工具包(CNTK) </strong>。您用 Keras 编写的任何代码都可以在这些后端中的任何一个上运行，而无需对代码做任何修改。通过 TensorFlow/Theano /CNTK，Keras 可以在 CPU 和 GPU 上无缝运行。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ow"><img src="../Images/0cff2f8ac5b4714dc60047c9b6662f2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:834/format:webp/1*OxAgYCBDKyXYLiWWUoKUcQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">The deep-learning software and hardware stack</figcaption></figure><h2 id="52d4" class="oj mp iq bd mq ok ol dn mu om on dp my lq oo op na lu oq or nc ly os ot ne ou bi translated">装置</h2><p id="056e" class="pw-post-body-paragraph lh li iq lj b lk ng jr lm ln nh ju lp lq ni ls lt lu nj lw lx ly nk ma mb lg ij bi translated">在安装 Keras 之前，我们需要安装它的一个后端引擎，即 TensorFlow、Theano 或 CNTK 中的任意一个。在本文中，我们将使用 TensorFlow 后端。阅读详细说明<a class="ae kv" href="https://www.tensorflow.org/install/" rel="noopener ugc nofollow" target="_blank">这里</a>安装 Tensorflow。</p><p id="61ba" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated"><strong class="lj ir">安装 Keras 有两种方式:</strong></p><ul class=""><li id="8d6e" class="nq nr iq lj b lk mc ln md lq ns lu nt ly nu lg nv nw nx ny bi translated"><strong class="lj ir">从 PyPI 安装 Keras(推荐):</strong></li></ul><pre class="kg kh ki kj gt ox oy oz pa aw pb bi"><span id="2754" class="oj mp iq oy b gy pc pd l pe pf">sudo pip install keras</span></pre><p id="551f" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">如果您使用的是 virtualenv，您可能希望避免使用 sudo:</p><pre class="kg kh ki kj gt ox oy oz pa aw pb bi"><span id="5e82" class="oj mp iq oy b gy pc pd l pe pf">pip install keras</span></pre><ul class=""><li id="d3c6" class="nq nr iq lj b lk mc ln md lq ns lu nt ly nu lg nv nw nx ny bi translated"><strong class="lj ir">或者:从 GitHub 源安装 Keras】</strong></li></ul><p id="2212" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">首先，使用<code class="fe pg ph pi oy b">git</code>克隆 Keras:</p><pre class="kg kh ki kj gt ox oy oz pa aw pb bi"><span id="3315" class="oj mp iq oy b gy pc pd l pe pf">git clone <a class="ae kv" href="https://github.com/keras-team/keras.git" rel="noopener ugc nofollow" target="_blank">https://github.com/keras-team/keras.git</a></span></pre><p id="656c" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">然后，<code class="fe pg ph pi oy b">cd</code>到 Keras 文件夹并运行安装命令:</p><pre class="kg kh ki kj gt ox oy oz pa aw pb bi"><span id="a0e2" class="oj mp iq oy b gy pc pd l pe pf">cd keras<br/>sudo python setup.py install</span></pre><p id="fc2c" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">如有任何安装相关的疑问，请参考 Keras <a class="ae kv" href="https://keras.io/#installation" rel="noopener ugc nofollow" target="_blank">官方文件</a>。</p><h2 id="a9b6" class="oj mp iq bd mq ok ol dn mu om on dp my lq oo op na lu oq or nc ly os ot ne ou bi translated">硬件要求:设置工作站。</h2><p id="44c9" class="pw-post-body-paragraph lh li iq lj b lk ng jr lm ln nh ju lp lq ni ls lt lu nj lw lx ly nk ma mb lg ij bi translated">作者建议(尽管不是绝对必要的)在现代 NVIDIA GPU 上运行深度学习代码。或者，您可以考虑在 AWS EC2 GPU 实例或 Google 云平台上运行您的实验(随着时间的推移，这将变得非常昂贵)。</p><p id="1396" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">在本文中，我将使用<strong class="lj ir"> Jupyter notebooks </strong>来开始使用 Keras，尽管这不是必需的:您也可以运行独立的 Python 脚本，或者从 PyCharm 之类的 IDE 中运行代码。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="b75f" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated">3.Keras 工作流程</h1><p id="4105" class="pw-post-body-paragraph lh li iq lj b lk ng jr lm ln nh ju lp lq ni ls lt lu nj lw lx ly nk ma mb lg ij bi translated">典型的机器学习工作流程如下:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pj"><img src="../Images/73e0632b7941dcc5955bb229a81be331.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*lrxPlkyeTSrizVQmpZaIWQ.png"/></div></figure><p id="42b6" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">一个 Keras 工作流没有什么不同，要完全理解它；我们将在<em class="oi"> </em>中使用一个神经网络的例子，这个神经网络使用 Keras 对手写数字进行分类。它就是著名的<strong class="lj ir"> MNIST </strong>数据库问题也叫深度学习的“<strong class="lj ir"> Hello World </strong>”。问题是将手写数字(28 × 28 像素)的灰度图像分为十类(0 到 9)。</p><div class="pk pl gp gr pm pn"><a href="http://yann.lecun.com/exdb/mnist/" rel="noopener  ugc nofollow" target="_blank"><div class="po ab fo"><div class="pp ab pq cl cj pr"><h2 class="bd ir gy z fp ps fr fs pt fu fw ip bi translated">MNIST 手写数字数据库，Yann LeCun，Corinna Cortes 和 Chris Burges</h2><div class="pu l"><h3 class="bd b gy z fp ps fr fs pt fu fw dk translated">MNIST 数据库是由 NIST 专题数据库 3 和专题数据库 1 构成的</h3></div><div class="pv l"><p class="bd b dl z fp ps fr fs pt fu fw dk translated">yann.lecun.com</p></div></div></div></a></div><blockquote class="pw px py"><p id="c8f4" class="lh li oi lj b lk mc jr lm ln md ju lp pz me ls lt qa mf lw lx qb mg ma mb lg ij bi translated"><em class="iq">MNIST 数据集以一组四个 Numpy 数组的形式预加载到 Keras 中。</em></p></blockquote><h1 id="4e2b" class="mo mp iq bd mq mr nl mt mu mv nm mx my jw nn jx na jz no ka nc kc np kd ne nf bi translated">步伐</h1><p id="10c3" class="pw-post-body-paragraph lh li iq lj b lk ng jr lm ln nh ju lp lq ni ls lt lu nj lw lx ly nk ma mb lg ij bi translated">让我们强调我们将采取的步骤，利用 Keras 解决这一问题。</p><h1 id="8425" class="mo mp iq bd mq mr nl mt mu mv nm mx my jw nn jx na jz no ka nc kc np kd ne nf bi translated">I)在 Keras 中加载 MNIST 数据集</h1><pre class="kg kh ki kj gt ox oy oz pa aw pb bi"><span id="ad74" class="oj mp iq oy b gy pc pd l pe pf"><strong class="oy ir">from keras.datasets import mnist</strong></span><span id="3552" class="oj mp iq oy b gy qc pd l pe pf"><strong class="oy ir">(train_images, train_labels), (test_images, test_labels) = mnist.load_data()</strong></span></pre><p id="761c" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">图像被编码为 Numpy 数组，标签是一个数字数组，范围从 0 到 9。存储数据的多维数组称为<strong class="lj ir">张量</strong>。你可以把张量想象成数据的容器。更具体地说，张量是矩阵到任意维数的推广。张量可以由三个关键特征来定义:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi qd"><img src="../Images/566d36bbb406540a659063d7717528bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1016/format:webp/1*Bg-Gz1hsKCuYjJ8lpZW2LQ.png"/></div></figure><p id="c48f" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated"><strong class="lj ir">我们来看看训练和测试数据。</strong></p><pre class="kg kh ki kj gt ox oy oz pa aw pb bi"><span id="2caf" class="oj mp iq oy b gy pc pd l pe pf"><strong class="oy ir">#Training Data<br/>train_images.shape</strong><br/>(60000, 28, 28)<br/><strong class="oy ir">len(train_labels) # </strong>Total no. of training images<br/>60000<br/><strong class="oy ir">train_labels</strong><br/>array([5, 0, 4, ..., 5, 6, 8], dtype=uint8)</span><span id="521a" class="oj mp iq oy b gy qc pd l pe pf"><strong class="oy ir">#Testing Data<br/>test_images.shape</strong><br/>(10000, 28, 28)<br/><strong class="oy ir">len(test_labels)</strong><br/>10000<br/><strong class="oy ir">test_labels</strong><br/>array([7, 2, 1, ..., 4, 5, 6], dtype=uint8)</span></pre><p id="2a11" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">所以我们这里有一个 8 位整数的 3D 张量。更准确地说，它是一个由 60，000 个 28 × 28 整数矩阵组成的数组。每个这样的矩阵都是灰度图像，系数在 0 到 255 之间。</p><h1 id="6146" class="mo mp iq bd mq mr nl mt mu mv nm mx my jw nn jx na jz no ka nc kc np kd ne nf bi translated">ii)预处理数据</h1><p id="9ed5" class="pw-post-body-paragraph lh li iq lj b lk ng jr lm ln nh ju lp lq ni ls lt lu nj lw lx ly nk ma mb lg ij bi translated">i) <strong class="lj ir">准备图像数据</strong></p><p id="d8a4" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">在输入之前，我们需要对数据进行预处理。这是通过将其重新整形为网络所期望的形状来实现的。我们还将缩放范围(0，1)之间的所有值。</p><pre class="kg kh ki kj gt ox oy oz pa aw pb bi"><span id="eccf" class="oj mp iq oy b gy pc pd l pe pf">train_images = train_images.reshape((60000, 28 * 28))<br/>train_images = train_images.astype('float32') / 255</span><span id="c667" class="oj mp iq oy b gy qc pd l pe pf">test_images = test_images.reshape((10000, 28 * 28))<br/>test_images = test_images.astype('float32') / 255</span></pre><p id="292f" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">因此，我们将形状为<code class="fe pg ph pi oy b">(6000, 28, 28), type — uint8</code>的数组中的训练图像转换为形状为<code class="fe pg ph pi oy b">(60000, 28 * 28)</code>的<code class="fe pg ph pi oy b">float32</code>数组，其值介于 0 和 1 之间。</p><p id="f77f" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">ii) <strong class="lj ir">对标签进行编码</strong></p><p id="9d04" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">标签也需要被分类编码，因为我们不能将整数列表输入神经网络。</p><pre class="kg kh ki kj gt ox oy oz pa aw pb bi"><span id="08e9" class="oj mp iq oy b gy pc pd l pe pf">from keras.utils import to_categorical</span><span id="7521" class="oj mp iq oy b gy qc pd l pe pf">train_labels = to_categorical(train_labels)<br/>test_labels = to_categorical(test_labels)</span></pre><h1 id="1217" class="mo mp iq bd mq mr nl mt mu mv nm mx my jw nn jx na jz no ka nc kc np kd ne nf bi translated">iii)构建网络架构</h1><p id="14cc" class="pw-post-body-paragraph lh li iq lj b lk ng jr lm ln nh ju lp lq ni ls lt lu nj lw lx ly nk ma mb lg ij bi translated">深度学习网络本质上由模型和层组成。</p><h2 id="9c8e" class="oj mp iq bd mq ok ol dn mu om on dp my lq oo op na lu oq or nc ly os ot ne ou bi translated">层</h2><p id="a499" class="pw-post-body-paragraph lh li iq lj b lk ng jr lm ln nh ju lp lq ni ls lt lu nj lw lx ly nk ma mb lg ij bi translated"><strong class="lj ir">层</strong>是神经网络的核心构建模块。它充当一种数据处理模块。各层从输入数据中提取出<strong class="lj ir"> <em class="oi">表示</em> </strong>，并输入其中。本质上，深度学习包括堆叠这些层以形成模型。</p><blockquote class="kw"><p id="b0bd" class="kx ky iq bd kz la qe qf qg qh qi lg dk translated">层是深度学习的乐高积木</p></blockquote><h2 id="85ed" class="oj mp iq bd mq ok qj dn mu om qk dp my lq ql op na lu qm or nc ly qn ot ne ou bi translated">模型</h2><p id="4813" class="pw-post-body-paragraph lh li iq lj b lk ng jr lm ln nh ju lp lq ni ls lt lu nj lw lx ly nk ma mb lg ij bi translated">模型是层的线性堆叠。它就像一个数据处理的筛子，由一系列不断增加的称为层的精细数据过滤器组成。Keras 中最简单的模型是<strong class="lj ir"> sequential </strong>，由层顺序堆叠而成。</p><h2 id="68fc" class="oj mp iq bd mq ok ol dn mu om on dp my lq oo op na lu oq or nc ly os ot ne ou bi translated">模型结构</h2><p id="9735" class="pw-post-body-paragraph lh li iq lj b lk ng jr lm ln nh ju lp lq ni ls lt lu nj lw lx ly nk ma mb lg ij bi translated">我们将在 Keras 建立我们的第一个模型，只有两层。这里，我们将输入数据的预期形状传递给第一层。</p><pre class="kg kh ki kj gt ox oy oz pa aw pb bi"><span id="bf3e" class="oj mp iq oy b gy pc pd l pe pf"><strong class="oy ir">from keras import models<br/>from keras import layers</strong></span><span id="e6ec" class="oj mp iq oy b gy qc pd l pe pf"><strong class="oy ir">network = models.Sequential()<br/>network.add(layers.Dense(512, activation='relu', input_shape=(28 * 28,)))<br/>network.add(layers.Dense(10, activation='softmax'))</strong></span></pre><p id="4d6c" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">我们的网络由一系列两个<strong class="lj ir">层</strong>组成，它们是<strong class="lj ir">密集连接的</strong>(也叫<em class="oi">全连接的</em>)神经层。</p><ul class=""><li id="b527" class="nq nr iq lj b lk mc ln md lq ns lu nt ly nu lg nv nw nx ny bi translated">第一层由 512 个单元组成，接受从 28×28 图像转换的 784 维阵列的输入。使用的激活函数是 ReLU(整流线性单位)。一个<a class="ae kv" href="https://github.com/Kulbear/deep-learning-nano-foundation/wiki/ReLU-and-Softmax-Activation-Functions" rel="noopener ugc nofollow" target="_blank"> <strong class="lj ir">整流线性单元</strong> </a>如果输入小于 0 则输出 0，否则为原始输出。也就是说，如果输入大于 0，则输出等于输入。</li><li id="7552" class="nq nr iq lj b lk nz ln oa lq ob lu oc ly od lg nv nw nx ny bi translated">第二层(也是这里的最后一层)是 10 路<strong class="lj ir"> <em class="oi"> softmax </em> </strong> <em class="oi"> </em>层，这意味着它将返回 10 个概率分数的数组(总和为 1)。每个分数将是当前数字图像属于我们的 10 个数字类之一的概率。你可以在下面阅读更多关于<strong class="lj ir"> softmax </strong>函数的信息。</li></ul><div class="pk pl gp gr pm pn"><a href="https://developers.google.com/machine-learning/crash-course/multi-class-neural-networks/softmax" rel="noopener  ugc nofollow" target="_blank"><div class="po ab fo"><div class="pp ab pq cl cj pr"><h2 class="bd ir gy z fp ps fr fs pt fu fw ip bi translated">多类神经网络:Softmax</h2><div class="pu l"><h3 class="bd b gy z fp ps fr fs pt fu fw dk translated">例如，假设您的例子是只包含一个项目的图像——一片水果。Softmax 可以确定…</h3></div><div class="pv l"><p class="bd b dl z fp ps fr fs pt fu fw dk translated">developers.google.com</p></div></div><div class="qo l"><div class="qp l qq qr qs qo qt kp pn"/></div></div></a></div><p id="b364" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">不同的层最适合不同类型的数据处理。<strong class="lj ir">一般</strong>规则(不是经验法则)是:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi qu"><img src="../Images/c98fb235b6194170c48e8fd8188401d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:812/format:webp/1*pjAG6h8Rggubkavdds0oug.png"/></div></figure><h1 id="f0b5" class="mo mp iq bd mq mr nl mt mu mv nm mx my jw nn jx na jz no ka nc kc np kd ne nf bi translated">iv)网络编译</h1><p id="73e9" class="pw-post-body-paragraph lh li iq lj b lk ng jr lm ln nh ju lp lq ni ls lt lu nj lw lx ly nk ma mb lg ij bi translated">我们现在知道，我们的网络由两个密集层组成，每一层都对输入数据应用一些张量运算。这些操作涉及权重张量，并且网络的<em class="oi">知识</em>出现在这些权重上。</p><p id="0ab2" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">模型构建完成后，我们进入编译阶段，该阶段主要包括三个基本要素:</p><ul class=""><li id="0599" class="nq nr iq lj b lk mc ln md lq ns lu nt ly nu lg nv nw nx ny bi translated"><strong class="lj ir">损失函数(目标函数)</strong> : <strong class="lj ir"> <em class="oi">损失</em> </strong> <em class="oi"> </em>【预测—实际值】<em class="oi"> </em>是我们在训练一个神经网络的过程中试图最小化的量。因此，测量损失函数是我们试图解决的任务成功的度量。为一个问题选择正确的目标函数是非常必要的。常用损失函数见下图。</li></ul><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi qv"><img src="../Images/58ad568bb344daa8bdb8bc83e40280f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/1*FOBmzbE-CMAUwQz2KecsVA.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Commonly used Loss functions</figcaption></figure><ul class=""><li id="aa43" class="nq nr iq lj b lk mc ln md lq ns lu nt ly nu lg nv nw nx ny bi translated"><strong class="lj ir">优化器</strong>:指定损耗梯度用于更新参数的确切方式。换句话说，它决定了如何根据损失函数更新网络。优化器可以是 RMSProp 优化器、SGD with momentum 等等。</li><li id="27ec" class="nq nr iq lj b lk nz ln oa lq ob lu oc ly od lg nv nw nx ny bi translated"><strong class="lj ir">度量</strong>:衡量模型的准确性。在这种情况下，我们将使用准确性。</li></ul><pre class="kg kh ki kj gt ox oy oz pa aw pb bi"><span id="37f8" class="oj mp iq oy b gy pc pd l pe pf"><strong class="oy ir">network.compile(optimizer='rmsprop', loss='categorical_crossentropy',</strong></span><span id="8e26" class="oj mp iq oy b gy qc pd l pe pf"><strong class="oy ir">metrics=['accuracy'])</strong></span></pre><p id="6ae3" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">本质上，损失的减少是通过小批量随机梯度下降实现的。管理梯度下降的具体使用的确切规则由作为第一个参数传递的 rmsprop 优化器定义。</p><h1 id="babd" class="mo mp iq bd mq mr nl mt mu mv nm mx my jw nn jx na jz no ka nc kc np kd ne nf bi translated">五)培训网络</h1><p id="5786" class="pw-post-body-paragraph lh li iq lj b lk ng jr lm ln nh ju lp lq ni ls lt lu nj lw lx ly nk ma mb lg ij bi translated">我们现在准备训练网络，这在 Keras 中是通过调用网络的<strong class="lj ir">拟合方法</strong>来完成的——我们<em class="oi">将模型拟合</em>到它的训练数据:</p><pre class="kg kh ki kj gt ox oy oz pa aw pb bi"><span id="fdfa" class="oj mp iq oy b gy pc pd l pe pf"><strong class="oy ir">network.fit(train_images, train_labels, epochs=5,batch_size=128)</strong></span><span id="210c" class="oj mp iq oy b gy qc pd l pe pf">Epoch 1/5<br/>60000/60000 [==============================] - 5s 90us/step - loss: 0.2567 - acc: 0.9264<br/>Epoch 2/5<br/>60000/60000 [==============================] - 5s 88us/step - loss: 0.1032 - acc: 0.9694<br/>Epoch 3/5<br/>60000/60000 [==============================] - 5s 89us/step - loss: 0.0679 - acc: 0.9798<br/>Epoch 4/5<br/>60000/60000 [==============================] - 6s 92us/step - loss: 0.0490 - acc: 0.9856<br/>Epoch 5/5<br/>60000/60000 [==============================] - 5s 89us/step - loss: 0.0375 - acc: 0.9885</span></pre><p id="26aa" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">网络将开始以 128 个样本的小批量迭代训练数据 5 次(所有训练数据的每次迭代称为一个<strong class="lj ir"> <em class="oi">时期</em> </strong>)。在每次迭代中，网络将计算关于批次损失的权重梯度，并更新权重</p><p id="b5aa" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">训练期间显示两个量:</p><ul class=""><li id="e900" class="nq nr iq lj b lk mc ln md lq ns lu nt ly nu lg nv nw nx ny bi translated"><strong class="lj ir">训练数据的网络丢失</strong>，以及</li><li id="89e3" class="nq nr iq lj b lk nz ln oa lq ob lu oc ly od lg nv nw nx ny bi translated"><strong class="lj ir">网络对训练数据的准确度</strong>。</li></ul><p id="e887" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">训练数据的准确性大约在<code class="fe pg ph pi oy b">98.9%</code>左右。现在让我们检查一下模型在测试集上的表现。</p><h1 id="08ec" class="mo mp iq bd mq mr nl mt mu mv nm mx my jw nn jx na jz no ka nc kc np kd ne nf bi translated">vi)测试数据测试</h1><pre class="kg kh ki kj gt ox oy oz pa aw pb bi"><span id="2043" class="oj mp iq oy b gy pc pd l pe pf">test_loss, test_acc = network.evaluate(test_images, test_labels)<br/>10000/10000 [==============================] - 1s 66us/step</span><span id="6423" class="oj mp iq oy b gy qc pd l pe pf">print('test_acc:', test_acc)<br/>test_acc: 0.9783</span></pre><p id="baa7" class="pw-post-body-paragraph lh li iq lj b lk mc jr lm ln md ju lp lq me ls lt lu mf lw lx ly mg ma mb lg ij bi translated">测试集的准确度是<code class="fe pg ph pi oy b"> 97.8%</code>——比训练集的准确度低很多。但这就是 ML 术语中著名的<a class="ae kv" href="https://machinelearningmastery.com/overfitting-and-underfitting-with-machine-learning-algorithms/" rel="noopener ugc nofollow" target="_blank"> <strong class="lj ir">过度拟合</strong> </a>的问题。通过从原始训练数据中创建大约 10，000 个图像的验证样本并将其放在一边，可以避免这种情况。测试可以在这个样本上进行，因为它以前没有暴露于训练。整个代码可以从这里的<a class="ae kv" href="https://github.com/parulnith/My-Journey-into-DeepLearning-using-Keras/blob/master/MNIST%20problem%20with%20Keras.ipynb" rel="noopener ugc nofollow" target="_blank">访问</a>。</p></div><div class="ab cl mh mi hu mj" role="separator"><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm mn"/><span class="mk bw bk ml mm"/></div><div class="ij ik il im in"><h1 id="eb0d" class="mo mp iq bd mq mr ms mt mu mv mw mx my jw mz jx na jz nb ka nc kc nd kd ne nf bi translated">结论</h1><p id="6bc5" class="pw-post-body-paragraph lh li iq lj b lk ng jr lm ln nh ju lp lq ni ls lt lu nj lw lx ly nk ma mb lg ij bi translated">差不多就是这样了。在 Keras 的帮助下，我们详细解决了整个 MNIST 数字分类问题。我们刚刚从零开始建立并训练了一个神经网络。但是，理论是学习的一个方面，实际应用又是另一个方面。所以起来出发吧。通过处理一些真实的数据集来利用你新发现的知识。我们将在下一部分看到，我们将学习利用 Keras 解决一些高级问题。在那之前，祝你阅读愉快。</p></div></div>    
</body>
</html>