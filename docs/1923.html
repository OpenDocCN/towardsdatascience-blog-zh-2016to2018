<html>
<head>
<title>Wrangling data with Pandas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">与熊猫争论数据</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/wrangling-data-with-pandas-27ef828aff01?source=collection_archive---------2-----------------------#2017-11-17">https://towardsdatascience.com/wrangling-data-with-pandas-27ef828aff01?source=collection_archive---------2-----------------------#2017-11-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="f751" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">熊猫以竹子为食，非常擅长长时间睡眠。但是他们也有一个秘密的力量:啃下大数据集。今天，我们将介绍数据争论中最强大和最受欢迎的工具之一，它叫熊猫！</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="kq kr l"/></div></figure><p id="ef64" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当你想到数据科学时，熊猫可能不是第一个想到的。这些黑白熊通常大部分时间都在吃竹子和睡觉，而不是做数据科学！但是今天，我们将使用<a class="ae ks" href="http://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank">熊猫</a>来操作我们的数据集，并为机器学习设置它。我不能在一个视频中对整个图书馆进行公正的评价，但希望这个概述能帮助你开始，我会让你更深入地探索熊猫的迷人世界。</p><div class="kl km kn ko gt ab cb"><figure class="kt kp ku kv kw kx ky paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><img src="../Images/93c6dfda632f688f2c08df2b9c72cd9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*SKGhn-eVgfbEWK5fen1Z3A.jpeg"/></div></figure><figure class="kt kp lf kv kw kx ky paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><img src="../Images/58b4bf61ea4c107ddff3c50594bba51b.png" data-original-src="https://miro.medium.com/v2/resize:fit:942/format:webp/1*bIlUDodNnDvRELa7yR_8fA.jpeg"/></div><figcaption class="lg lh gj gh gi li lj bd b be z dk lk di ll lm">Chomping on datasets! This dataset looks like bamboo, however.</figcaption></figure></div><p id="a9ad" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae ks" href="http://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank"> Pandas </a>是一个开源的 python 库，它提供了易于使用的高性能数据结构和数据分析工具。撇开 Cuddley bears 不谈，这个名字来自术语‘panel data’，指的是统计学和计量经济学中遇到的多维数据集。</p><p id="f1c6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要安装 pandas，只需在 python 环境中运行<code class="fe ln lo lp lq b">pip install pandas</code>。然后我们就可以<code class="fe ln lo lp lq b">import pandas as pd</code>了。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi lr"><img src="../Images/10869baa4455316bfcb524c96204c334.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1Ne8THAg7FfHWjwbHWXqsQ.png"/></div></div></figure><p id="d132" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">熊猫最常见的用途之一是使用<code class="fe ln lo lp lq b">pd.read_csv</code>读取 CSV 文件。往往是利用熊猫的起点。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi ls"><img src="../Images/329eeee2558c496f966730776aa8b8d2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BJnci0MAy57d0wplIPJibg.png"/></div></div></figure><p id="87bf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe ln lo lp lq b">pd.read_csv</code>将该数据加载到数据帧中。这可以被认为本质上是一个表格或电子表格。我们可以通过在数据帧上调用<code class="fe ln lo lp lq b">head()</code>来快速浏览一下我们的数据集。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi lt"><img src="../Images/681228bd47bcb3493e9ee1dced2b5f9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_RV89N_5YlZURva7i4fSCA.png"/></div></div></figure><p id="f739" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">数据帧包含带有命名列的数据行，在 pandas 中称为“系列”。</p><p id="0afd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对我来说，Dataframes 最棒的地方之一是<code class="fe ln lo lp lq b">describe()</code>函数，它显示了关于 Dataframe 的统计表。这对于检查数据集的完整性非常有用，可以查看数据的分布是否合理，以及属性是否符合您的预期。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi lu"><img src="../Images/ce89501048f0fb915d7f1d05645a9fe7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*z2h_VXhlGa3VM0ywX57fyg.png"/></div></div></figure><p id="abfb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我有时也会用熊猫来打乱我的数据。这在您想要混洗整个数据集而不仅仅是在提取数据时有一个先行缓冲区的情况下非常有用。例如，如果您的数据根本没有被打乱，而且实际上是排序的，那么您会希望对它进行额外的混合。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi lv"><img src="../Images/cb50a35082a5c332c1c8e61c6edf218e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k8W5onp4YndXJ-rM25rB4Q.png"/></div></div></figure><p id="d907" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然而，对于不适合内存的非常大的数据集，如果没有更复杂的方法，这可能是不切实际的。</p><h2 id="27a8" class="lw lx iq bd ly lz ma dn mb mc md dp me jy mf mg mh kc mi mj mk kg ml mm mn mo bi translated">列访问</h2><p id="ae7f" class="pw-post-body-paragraph jn jo iq jp b jq mp js jt ju mq jw jx jy mr ka kb kc ms ke kf kg mt ki kj kk ij bi translated">要访问数据集的特定列，请使用括号符号来提取该列，并传递该列的名称。如果您想知道可能的列名是什么，您可以回顾一下<code class="fe ln lo lp lq b">.describe()</code>输出的顶部，或者使用<code class="fe ln lo lp lq b">.columns</code>将数据帧中的所有列作为一个数组来访问。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi mu"><img src="../Images/7dba1f2f8a46b91fe5e1b741efaf24ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JlBT4HmnIVNHXK1GgSk1ng.png"/></div></div></figure><h2 id="65ab" class="lw lx iq bd ly lz ma dn mb mc md dp me jy mf mg mh kc mi mj mk kg ml mm mn mo bi translated">行访问</h2><p id="6513" class="pw-post-body-paragraph jn jo iq jp b jq mp js jt ju mq jw jx jy mr ka kb kc ms ke kf kg mt ki kj kk ij bi translated">访问数据帧的行与访问列略有不同。例如，如果我们想要一个给定数据帧的索引为<code class="fe ln lo lp lq b">i</code>的行，我们可以使用<code class="fe ln lo lp lq b">.iloc[i]</code>。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/4ea725719aac35dfa41430b0e4c6dc22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1342/format:webp/1*a7cC-84CU5mtF2VrsVJrvQ.png"/></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">This is index 5, so it’s the 6th row of data</figcaption></figure><p id="2e28" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请记住，Pandas 是基于 0 的索引系统，所以第一行实际上是索引 0。</p><h2 id="58be" class="lw lx iq bd ly lz ma dn mb mc md dp me jy mf mg mh kc mi mj mk kg ml mm mn mo bi translated">列和行在一起</h2><p id="fdea" class="pw-post-body-paragraph jn jo iq jp b jq mp js jt ju mq jw jx jy mr ka kb kc ms ke kf kg mt ki kj kk ij bi translated">有时您可能需要特定的行和列。因为行和列的访问方式不同，所以我们需要结合上述技术来完成这项工作。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi mw"><img src="../Images/5290dd44ed53f2fe5bfe0b3c3cccca72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8FyVqiRBfo3I0WKF_K-4Jw.png"/></div></div></figure><p id="d364" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你也可以把事情调换一下，使用<code class="fe ln lo lp lq b">csv_data.iloc[5][‘sepal_len’]</code>，但我觉得这样可读性较差。</p><h2 id="f6a4" class="lw lx iq bd ly lz ma dn mb mc md dp me jy mf mg mh kc mi mj mk kg ml mm mn mo bi translated">行和列范围</h2><p id="7e6c" class="pw-post-body-paragraph jn jo iq jp b jq mp js jt ju mq jw jx jy mr ka kb kc ms ke kf kg mt ki kj kk ij bi translated">更有趣的是当你想得到一系列的行和列时。</p><p id="2821" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在列方面，获取多列的方法是传入一个列名数组。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi mx"><img src="../Images/aae4740f011b9aa6f96705cea8b9d6ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AVS9Xf2HAvLUeh8ymdJyJQ.png"/></div></div></figure><p id="c04c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果需要输入更多的列名，您可以使用<code class="fe ln lo lp lq b">csv_data.columns</code>输出数组并从中选择一系列列名，然后使用它来选择列。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi my"><img src="../Images/ea50a02cae461fd13d6450c6c52e904a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oQZdru0T7gPu68euQwl7Dw.png"/></div></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">I guess I could have just typed the names of the 2 columns … but you get the idea.</figcaption></figure><p id="db41" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们想要得到一系列的行，我们在跟随<code class="fe ln lo lp lq b">.iloc</code>的括号内使用冒号符号:</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi mz"><img src="../Images/a6f8a71f20422fd627e6c9a6cc8e1fd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*E8SRR0IHhcnCB-RQrenKbw.png"/></div></div></figure><p id="660d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">包括起始索引，但不包括结束索引。请注意，这会返回行索引 5、6、7、8 和 9，但不会返回行索引 10。</p><h2 id="b55b" class="lw lx iq bd ly lz ma dn mb mc md dp me jy mf mg mh kc mi mj mk kg ml mm mn mo bi translated">行和列的范围</h2><p id="79ef" class="pw-post-body-paragraph jn jo iq jp b jq mp js jt ju mq jw jx jy mr ka kb kc ms ke kf kg mt ki kj kk ij bi translated">假设我们两个都想要——列的子集<em class="na">和行的子集</em>。那会是什么样子？我们可以将目前使用的所有技术结合起来，做出一个表达式来完成这项工作。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi nb"><img src="../Images/ed139c96f6947682df86191b1b1ef0e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Q1VSsUVwO4SB2V4exAX7w.png"/></div></div></figure><p id="14db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先，像前面一样选择列名:</p><p id="d0e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe ln lo lp lq b">cols_2_4 = csv_data.column[2:4]</code></p><p id="28ca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">然后我们得到列:</p><p id="5dc2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe ln lo lp lq b">df_cols_2_4 = df[cols_2_4]</code></p><p id="f840" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在从该数据帧中选择行:</p><p id="9d59" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe ln lo lp lq b">df_cols_2_4.iloc[5:10]</code></p><p id="02d5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦你掌握了窍门，你将开始把这些变量压缩成一个表达式，就像这样:</p><p id="4881" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><code class="fe ln lo lp lq b">csv_data[csv_data.columns[2:4]].iloc[5:10]</code></p><p id="97e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我鼓励你在这里停下来，看看这个表达式是如何等价于我们刚刚在上面展示的。你回来的时候我还会在这里。</p></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><h2 id="ae1f" class="lw lx iq bd ly lz ma dn mb mc md dp me jy mf mg mh kc mi mj mk kg ml mm mn mo bi translated">包扎</h2><p id="02f9" class="pw-post-body-paragraph jn jo iq jp b jq mp js jt ju mq jw jx jy mr ka kb kc ms ke kf kg mt ki kj kk ij bi translated">Pandas 中的链接操作不仅能让你更快地处理数据，而且一旦你掌握了它，它的可读性会更好。</p><p id="b56a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">到目前为止，我们已经看到了一些简单的数据帧操作，但是熊猫生态系统还提供了更多的功能，从 PyTables 和 HDF5 格式的高效文件存储，到运行各种统计分析。</p><p id="5cb7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">走出去，尝试野生大熊猫！</p></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="kz la di lb bf lc"><div class="gh gi nj"><img src="../Images/0abec92252565d033a2519f5e973871a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6KivIgVDshe-yknzLhH1sA.jpeg"/></div></div></figure><p id="27d1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">感谢阅读这一集的<a class="ae ks" href="https://goo.gl/UC5usG" rel="noopener ugc nofollow" target="_blank">云人工智能冒险</a>。如果你喜欢这个系列，请为这篇文章鼓掌让我知道。如果你想要更多的机器学习动作，一定要关注媒体上的<a class="ae ks" href="https://medium.com/@yufengg" rel="noopener">我</a>或<a class="ae ks" href="https://goo.gl/S0AS51" rel="noopener ugc nofollow" target="_blank">订阅 YouTube 频道</a>以观看未来的剧集。更多剧集即将推出！</p></div></div>    
</body>
</html>