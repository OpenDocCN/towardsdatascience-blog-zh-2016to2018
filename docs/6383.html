<html>
<head>
<title>Classifying Cats &amp; Dogs images with AutoML Vision</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">基于自动视觉的猫狗图像分类</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/classifying-cats-dogs-images-with-automl-vision-235b6d6bf27f?source=collection_archive---------20-----------------------#2018-12-10">https://towardsdatascience.com/classifying-cats-dogs-images-with-automl-vision-235b6d6bf27f?source=collection_archive---------20-----------------------#2018-12-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="bc79" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我第一次正式接触谷歌云平台是在 2018 年 11 月参加<a class="ae kl" href="https://calhacks.io" rel="noopener ugc nofollow" target="_blank"> CalHacks 5.0 </a>的时候。我很快发现他们的云 AI 套件由一系列机器学习产品组成——Cloud AutoML、Cloud Natural Language、Cloud Vision API，仅举几例。</p><p id="8c7e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本学期早些时候我的一次 DataX 课上，我们使用<a class="ae kl" href="https://keras.io" rel="noopener ugc nofollow" target="_blank"> Python Keras 库</a>对猫和狗的照片进行分类。这给了我用类似的数据集工作的想法。<em class="km">出于一个更无聊的原因，我的兄弟们非常喜欢宠物(尤其是猫和狗)，我认为部署这种模型对他们来说也是一件有趣的事情。</em></p><p id="2804" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">通过 Keras 进行图像分类通常需要我(1)找到并标记数据集；(2)训练一个 ML 分类器；(3)部署 ML 模型；&amp; (4)使用 REST API 创建一个服务器来调用 web 上的 ML 分类器。</p><p id="52ef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">多亏了 Cloud AutoML，我们只需要执行上面的步骤 1！</p><p id="fb94" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">数据集:猫和狗的图像</strong></p><p id="73c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">幸运的是，为此目的找到一个合适的数据集并不是一件容易的事情。我输入“kaggle 猫狗数据集”，这个链接<a class="ae kl" href="https://www.microsoft.com/en-us/download/details.aspx?id=54765" rel="noopener ugc nofollow" target="_blank">作为谷歌搜索结果之一弹出。我分别选取了 150 张猫狗的图片，将这些图片导入到云平台上。之后，我给每张照片贴上“狗”或“猫”的标签。</a></p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi kn"><img src="../Images/25edc8ee3580fb908b990583c246efec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I__qIOfWjvvarYW7ZgkTHg.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk">Uploading a total of 300 images for the model (150 each for cats and dogs respectively)</figcaption></figure><p id="2020" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">培训和评估</strong></p><p id="86a0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下一步是训练模型。默认情况下，AutoML Vision 在训练模型时会将数据集随机分为 3 个独立的集合。</p><ul class=""><li id="7499" class="ld le iq jp b jq jr ju jv jy lf kc lg kg lh kk li lj lk ll bi translated">训练数据集:80% —用于训练</li><li id="3333" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">验证数据集:10% —用于超参数调整和决定何时停止训练</li><li id="8399" class="ld le iq jp b jq lm ju ln jy lo kc lp kg lq kk li lj lk ll bi translated">测试数据集:10% —用于模型评估</li></ul><p id="e398" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对模型进行训练和评估后，我发现了以下情况:</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi lr"><img src="../Images/1fa9b46a7cc8cfe715364362e8e8d868.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0h0QzkwEyJb5H7bImBBBGA.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk">Precision and Recall values for the Model</figcaption></figure><p id="224d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">准确率和召回率都是 100% —这意味着什么？从所有被分配了猫/狗标签的测试示例中，所有的测试示例实际上都被准确地分类了。并且，在所有应该被分配了猫/狗标签的测试例子中，所有的例子实际上都被分配了正确的标签。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi ls"><img src="../Images/07fb379404b63928e15a4e32426975aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gfum9Dlyf02cT3agxlwhIg.png"/></div></div></figure><p id="8c9e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">根据混淆矩阵，ML 模型能够准确地对所有照片进行分类(100%)。毕竟没有那么令人困惑。</p><p id="8052" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">用新图像进行预测</strong></p><p id="e54c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我用新图像测试了 ML 模型。我下载的数据集实际上有超过 10 000 张图片，所以我随机选择了一张狗和一张猫的图片，并将这些图片上传到模型中。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi lt"><img src="../Images/c4c1f0b03ce911e57ed2e04c72167b96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AQrjF-mlTPNreE-ikpHQoQ.jpeg"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk">I uploaded an image of a cat for prediction, and the model was able to predict with 100% accuracy that it was <strong class="bd lu">indeed</strong><em class="lv"> a cat!</em></figcaption></figure><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi lw"><img src="../Images/f879bcffc4535f5e747a0a8fd496ccf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OBiEga5buOF2WltTTSi3-g.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk">Also predicted with 100% accuracy that it was a dog!</figcaption></figure><p id="59f4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">即使有了新的图像，这个模型也预测得很好。</p><p id="8238" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">不过，我不相信。所以我在网上寻找斯芬克斯的照片——这是一种与狗有着高度相似外貌的猫。我想知道 ML 模型是否会与这张图片混淆。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi lx"><img src="../Images/d703be4d3a5d540b3c061369eb9d0036.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8SYD3gtKCd8Hycnxq7pTWA.png"/></div></div><figcaption class="kz la gj gh gi lb lc bd b be z dk">Sphynxes — a breed of cats that resembles dogs; I was mildy surprised to find out that the ML model was still able to classify this 100% with a “cat” label</figcaption></figure><p id="3fde" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">事实证明，这个模型仍然能够以 100%的准确率预测出这是一张猫的照片。</p><p id="e129" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是…如果我们有一只猫和一只狗在同一个图像中会怎么样？</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi lt"><img src="../Images/905fdb8a77ee31c62eadd98bb14c8dc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mC4pjpVtGMsPrPqmYFyeyw.png"/></div></div></figure><p id="5a45" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">看起来这个模型在这里有点混乱——但是这绝对是我需要努力的地方。</p><p id="87ef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">滑稽的吉娃娃对松饼挑战怎么样？</strong></p><p id="3930" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你可能已经在互联网上看到了“吉娃娃 vs 松饼”的迷因——这里是<a class="ae kl" href="https://www.boredpanda.com/chihuahua-or-muffin/?utm_source=google&amp;utm_medium=organic&amp;utm_campaign=organic" rel="noopener ugc nofollow" target="_blank"/>。鉴于巧克力碎片松饼(事后看来也可能是巧克力碎片饼干)与吉娃娃的高度相似性，我想测试一下这个模型是否能区分这两者。</p><figure class="ko kp kq kr gt ks gh gi paragraph-image"><div role="button" tabindex="0" class="kt ku di kv bf kw"><div class="gh gi ly"><img src="../Images/890a95526dc2b4ff1be8486deba7ccf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AXUy8eJU0QJg9rOn_170IQ.png"/></div></div></figure><p id="6e9d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">看起来它被愚弄了。但老实说，我认为这也可能让人类眼花缭乱。</p><p id="081e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下一步是什么？</p><p id="e5c8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">鉴于猫狗分类是一个相对典型的机器学习图像分类问题，算法可能已经针对它进行了良好的训练。我们可以看到，当我们试图将分类问题复杂化时，出现了一些复杂性。</p><p id="6884" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">虽然它可能没有最复杂的算法来解决挑战性问题，但它仍然为非 ML 专家提供了一个非常友好的切入点来开始涉足一点 ML！</p></div><div class="ab cl lz ma hu mb" role="separator"><span class="mc bw bk md me mf"/><span class="mc bw bk md me mf"/><span class="mc bw bk md me"/></div><div class="ij ik il im in"><p id="1d7c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="km">嗯，下次更好玩的实验！</em></p></div></div>    
</body>
</html>