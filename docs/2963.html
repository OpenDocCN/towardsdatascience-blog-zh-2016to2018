<html>
<head>
<title>Everything you’ve ever wanted to know about New York City’s restaurant ratings</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你想知道的关于纽约市餐馆等级的一切</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/everything-youve-ever-wanted-to-know-about-new-york-city-s-restaurant-ratings-cb73a8701f28?source=collection_archive---------1-----------------------#2018-03-25">https://towardsdatascience.com/everything-youve-ever-wanted-to-know-about-new-york-city-s-restaurant-ratings-cb73a8701f28?source=collection_archive---------1-----------------------#2018-03-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="a66a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">任何去过纽约市的人都可能注意到几乎所有餐馆的餐馆字母等级。字母等级是在 2010 年引入的，范围从 A 到 C，A 是最高(最好)的评级。餐馆被要求清楚地展示字母等级，尽管一些机构很有创意。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/d2accced3b2d613b2099d3329e5f9d83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4tpEbdwiTUMU0zpzExqvNQ.jpeg"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">The “B” is for Brunch!</figcaption></figure><p id="81da" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我一直对收视率很好奇，既然数据可以在网上获得，我想我应该亲自测试一下。TLDR:检查员不喜欢给除了 As 以外的分数，不喜欢周末工作，连锁餐厅也很干净。还有一个我无法解开的谜团(跳到结尾，关于餐馆多久被评论一次)。所有的代码都可以在<a class="ae lb" href="https://github.com/breeko/nyc_restaurants/blob/master/nyc_restaurants.ipynb" rel="noopener ugc nofollow" target="_blank">这里</a>找到。</p><h1 id="7c76" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">无聊的东西</h1><p id="07aa" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">数据(186，185 行，12 列):</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mf"><img src="../Images/582f4d31867b2099f10315309cab90bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1246/format:webp/1*EI0toR-9052f4jcSdrxuag.png"/></div></div></figure><p id="3b47" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">DBA 是餐厅名称，其余部分不言自明。餐厅的命名并不总是一致的(例如星巴克和星巴克咖啡)，所以我必须稍微清理一下。</p><p id="4476" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">数据集提供了每家餐厅的历史评分以及最近的评分。但是评级也分为重要和不重要两类。因此，一个评级将有两行，一行表示严重违规，另一行表示非严重违规。所以我删除了关于违规描述/类型的信息，并删除了重复的内容。</p><p id="aa69" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于数据集包含历史信息，我还为每个餐馆创建了一个惟一的键。为此，我创建了一个结合了餐馆名称、建筑、街道和邮政编码的值(例如，DARKHORSE 17 MURRAY STREET 10007)。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mg mh l"/></div></figure><h1 id="f49d" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">成绩的分类是什么？</h1><p id="6826" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">分数从 0 开始。低分数是好的，因为它表示没有违规。每个违规都有一定的分值，因此 0 分意味着没有违规。有三种类型的违规:</p><ol class=""><li id="b401" class="mi mj iq jp b jq jr ju jv jy mk kc ml kg mm kk mn mo mp mq bi translated">一般——例如，没有正确消毒烹饪用具——最低 2 分</li><li id="cd05" class="mi mj iq jp b jq mr ju ms jy mt kc mu kg mv kk mn mo mp mq bi translated">关键——例如，提供生的食物，如沙拉，但没有先清洗干净——最低 5 分</li><li id="22f1" class="mi mj iq jp b jq mr ju ms jy mt kc mu kg mv kk mn mo mp mq bi translated">公共健康危害——例如，未能将食物保存在合适的温度下——最低 7 分</li></ol><p id="c865" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最终成绩是基于所有分数的总和。</p><ol class=""><li id="7713" class="mi mj iq jp b jq jr ju jv jy mk kc ml kg mm kk mn mo mp mq bi translated">0 到 13 岁的学生得 A</li><li id="9723" class="mi mj iq jp b jq mr ju ms jy mt kc mu kg mv kk mn mo mp mq bi translated">14 岁到 27 岁可以得 B</li><li id="5f17" class="mi mj iq jp b jq mr ju ms jy mt kc mu kg mv kk mn mo mp mq bi translated">28 岁或以上得 C</li></ol><p id="54ef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面可以看到按百分比分列的成绩细目，按最近成绩和所有成绩分组。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mg mh l"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi mw"><img src="../Images/d6c694529d35b0ea7e392e406e6608b7.png" data-original-src="https://miro.medium.com/v2/resize:fit:950/format:webp/1*0MQJbJMGD0jlZ4PgBpdUbQ.png"/></div></figure><p id="6db0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我并不感到惊讶，大部分成绩是 As，只有不到 2%的检查结果是 C。数字分数的分布情况如何？</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mg mh l"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mx"><img src="../Images/e1ef99e202b5011c891bb33bb0fa9228.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LBfqyQhuwam2iDgAcvspZw.png"/></div></div></figure><p id="fc6b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在从 A 到 b 的分界点上有 14 个点的急剧下降。来自<a class="ae lb" href="http://www1.nyc.gov/assets/doh/downloads/pdf/rii/how-we-score-grade.pdf" rel="noopener ugc nofollow" target="_blank">城市的网站</a>:</p><blockquote class="my mz na"><p id="bb09" class="jn jo nb jp b jq jr js jt ju jv jw jx nc jz ka kb nd kd ke kf ne kh ki kj kk ij bi translated">两种类型的检查会导致字母等级:餐厅获得 A 的初次检查和获得 A、B 或 c 的再次检查。餐厅在每个检查周期有两次获得 A 的机会。如果它在第一次检查中没有获得 A，它被计分但未被分级。检查员通常会在一个月内突然回到餐馆，再次检查，并对再次检查进行评分。如果等级为 B 或 C，餐厅将获得等级卡和等级待定卡。它可以邮寄任何一张卡片，直到它有机会在行政审判和听证办公室健康法庭得到听证。直到一家餐厅有了分级检查，才在卫生部门网站上列为尚未分级。</p></blockquote><p id="a2fe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，非 A 级最初不会被报道，餐厅还有一次机会。这抑制了报告的 B 和 C 等级。但是在 A 到 B 的分界点上的高分数是很奇怪的。我的猜测是，视察员在接近禁产门槛时会表现出宽容。如果很接近，检查员会给餐馆更高的分数，因为字母分数对顾客来说是最明显的部分。它也可能是分配给每个违规的分数的结果。例如，严重违规最低为 5 次，公共健康危害最低为 7 次。所以 10 分或 12 分应该更常见，这就是我们看到的。</p><h1 id="44ff" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">检查员什么时候检查？</h1><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mg mh l"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nf"><img src="../Images/57599057cd06f4d91e6dad4dbcd23947.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IWCunf1Xm2BF2UdiFCpJvA.png"/></div></div></figure><p id="d08f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">看来食品检查员不喜欢周末工作，尤其是周日。哦，他们在七月也很放松。</p><h1 id="a3ce" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">这些年来有分数膨胀吗？</h1><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mg mh l"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ng"><img src="../Images/39cd054fd4318ed02daa2d9621693915.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fsjDZJabY9bgb4BPhAnW4g.png"/></div></div></figure><p id="8123" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">呃，也不尽然。第一年只有大约 80%的 A 评级，但样本量只有大约 100 人。B 级和 C 级评级分别稳定在 12%和 4%左右。今年到目前为止还有很多 Z 或者还没有评分。</p><h1 id="708e" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">哪些餐厅的菜肴评价最高？</h1><p id="85cd" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">数据集对美食描述的命名不一致(例如，16 柄有时归类为美式，有时归类为冰淇淋)。在这种情况下，我使用了最常见的美食描述。我也排除了评级总数少于 50 的公司。分数越低越好(违规越少)。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mg mh l"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nh"><img src="../Images/24bbee9d4fa7af09738bbc2263070d7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eQuXoV6v6Zy412rQcUEfag.png"/></div></div></figure><p id="623a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">收视率出奇的好，但我想这是大型连锁店的预期。记住高分是不好的。一些机构像苹果蜂的，Panera 面包和白色城堡(！)除了 a 之外从来没有拿到过一个公开的成绩，其他像达美乐这样的团体很不一致，经常很差(他们拿到的成绩只有 81%是 a，5%是 c)。然而，麦当劳在所有大型餐厅中拥有最差(最高)分数 62 分的可疑荣誉。</p><h1 id="5b50" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">个别餐厅的评分如何随时间变化？</h1><p id="5acb" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">考虑这个问题的一个方法是通过滚动率。滚动率是从一种状态转换到另一种状态(或停留在同一状态)的概率。我根据从一个等级到另一个等级的概率创建了一个滚动率(关于如何创建滚动率的更简单的通用示例，请参见<a class="ae lb" href="https://stackoverflow.com/questions/48671636/designing-a-roll-rate-transition-martix-table-in-python/49319388#49319388" rel="noopener ugc nofollow" target="_blank">这个堆栈溢出问题</a>)。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mg mh l"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi ni"><img src="../Images/cb203da527b8f372a61770ee3423d6e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:492/format:webp/1*DtT58HW1jy2fJBh_6VQHFg.png"/></div></figure><p id="75ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">大约 90%的情况下，A 评级会在下一次检查中再次获得 A。在下一次评级中，B 级餐厅有 71%的机会获得 A 级，C 级餐厅有 68%的机会获得 A 级。这对那些在 B 级和 C 级餐厅用餐的人来说应该是一种安慰。</p><h1 id="a933" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">餐厅多长时间保持一个给定的等级？</h1><p id="d5eb" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">我查看了每家餐厅点评的时间间隔。我把它按等级分类，因为我发现等级低的餐馆更容易被评论。</p><figure class="km kn ko kp gt kq"><div class="bz fp l di"><div class="mg mh l"/></div></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nj"><img src="../Images/8d1aca48ce858854821111c1fb1c151b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1z5ToRHSHJgUKDaqKoqMqg.png"/></div></div></figure><p id="5029" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从上面看不出来，但是 A 级有双峰分布。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nj"><img src="../Images/69a0a642e93e34eca410191a3a662b73.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UHVYshf130jrPRm6IXpkzw.png"/></div></div></figure><p id="15ea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我花了一些时间试图找出区别，但我从来没有找到一个令人满意的答案。A 级天数的分布在几年内和几个月内都是一致的。一般来说，所有菜系和所有行政区都是双模式的。</p><p id="fbc6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这多少与餐馆被分级的频率有关，但不是绝对相关(例如，像星巴克这样的餐馆几乎都在右峰)。我可能遗漏了一些显而易见的东西，但我猜测这是由于一些没有报告的分数。如前所述，如果一家餐馆得到了 B 以外的分数，分数不会被报告，餐馆在一个月内还有机会得到 A。我的猜测是，未能通过这一未被报道的评级会导致餐馆更频繁地被审查。这就解释了为什么评级高的餐厅很少得到评级。即使你看看那些从未被评为 A 级以下的餐馆，双峰分布也是存在的，但那可能只是因为非 A 级餐馆没有被报道。</p><p id="6330" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我对其他想法持开放态度。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nj"><img src="../Images/95d0a52ff8ae4fd117590ab1d770876f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eaoa0drCa6MWeecpDSZ9RQ.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">It always existed</figcaption></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/d981ec878dcc44eefbd9a03085e76a75.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*UAADNKPke2Gr5_XZtYp7Ig.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Large chains are still somewhat bi-modal</figcaption></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nl"><img src="../Images/e8fe66c665b0cfe1b4eebf561b872ff1.png" data-original-src="https://miro.medium.com/v2/resize:fit:768/format:webp/1*G_picNz-Jrrjuqw6p5ORzw.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Even those with perfect grades are bi-modal</figcaption></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi mx"><img src="../Images/e3969c2ef7e0fa503439c57112fba124.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rTnFGwfZtuKedU88Lh6c8w.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">Bi-modal across months</figcaption></figure><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/eab7ace25e15dacc16fd3602d3fe0560.png" data-original-src="https://miro.medium.com/v2/resize:fit:796/format:webp/1*4XIAZiy1QQQuBa8iYlfgVg.png"/></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">No clear pattern between A-grade consistency and time at grade</figcaption></figure></div></div>    
</body>
</html>