<html>
<head>
<title>Manage your Machine Learning Lifecycle with MLflow — Part 1.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用 MLflow 管理您的机器学习生命周期—第 1 部分。</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/manage-your-machine-learning-lifecycle-with-mlflow-part-1-a7252c859f72?source=collection_archive---------1-----------------------#2018-06-13">https://towardsdatascience.com/manage-your-machine-learning-lifecycle-with-mlflow-part-1-a7252c859f72?source=collection_archive---------1-----------------------#2018-06-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a8a7" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">重现性，良好的管理和跟踪实验是必要的，以方便测试他人的工作和分析。在第一部分中，我们将从简单的例子开始学习如何记录和查询实验，包装机器学习模型，以便它们可以在任何使用 MLflow 的平台上重现和运行。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/95d5d31aad2e9872adf368a8fffa7ff5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dslIrTa9vtUvAUv5oixsEQ.jpeg"/></div></div></figure><h1 id="8c1c" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">机器学习生命周期难题</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi lj"><img src="../Images/d869406e423d5f8b37bf56f9d1a382a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*sEopGE9U81tpIkTv"/></div></div></figure><p id="10e9" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">机器学习(ML)并不容易，但创建一个良好的工作流，让您可以重现、重新访问并部署到生产中，就更难了。在为 ML 创建一个好的平台或管理解决方案方面已经取得了很多进展。注意，t <strong class="lm ir"> his 不是数据科学(DS)生命周期</strong>，后者更复杂，有很多部分。</p><p id="ce9f" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">ML 生命周期存在于 DS 生命周期中。</p><p id="cb33" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">您可以在此处查看一些用于创建 ML 工作流的项目:</p><div class="mg mh gp gr mi mj"><a href="https://github.com/pachyderm/pachyderm" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab fo"><div class="ml ab mm cl cj mn"><h2 class="bd ir gy z fp mo fr fs mp fu fw ip bi translated">厚皮动物/厚皮动物</h2><div class="mq l"><h3 class="bd b gy z fp mo fr fs mp fu fw dk translated">厚皮动物-大规模可再生数据科学！</h3></div><div class="mr l"><p class="bd b dl z fp mo fr fs mp fu fw dk translated">github.com</p></div></div><div class="ms l"><div class="mt l mu mv mw ms mx kp mj"/></div></div></a></div><div class="mg mh gp gr mi mj"><a href="https://github.com/combust/mleap" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab fo"><div class="ml ab mm cl cj mn"><h2 class="bd ir gy z fp mo fr fs mp fu fw ip bi translated">燃烧/泄漏</h2><div class="mq l"><h3 class="bd b gy z fp mo fr fs mp fu fw dk translated">mleap - MLeap:将 Spark 管道部署到生产中</h3></div><div class="mr l"><p class="bd b dl z fp mo fr fs mp fu fw dk translated">github.com</p></div></div><div class="ms l"><div class="my l mu mv mw ms mx kp mj"/></div></div></a></div><p id="e2ff" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">这些包很棒，但是不容易理解。也许解决方案是这三者的混合，或者类似的东西。但在这里，我将向您展示由<a class="mz na ep" href="https://medium.com/u/5ae67e7eecef?source=post_page-----a7252c859f72--------------------------------" rel="noopener" target="_blank"> Databricks </a>创建的最新解决方案，名为 MLflow。</p><h1 id="50fa" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">MLflow 入门</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/ea9e1c4056ae727e479a40c3cd1cc263.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*CbTXZapAqi-EO1VTZdcq4A.png"/></div></figure><p id="a2db" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">MLflow 是一个完整的机器学习生命周期的开源平台。</p><p id="1bd5" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">MLflow 设计用于任何 ML 库、算法、部署工具或语言。将 MLflow 添加到您现有的<em class="nc">ML 代码中非常容易，因此您可以立即从中受益，并且可以使用您组织中的其他人可以运行的任何 ML 库来共享代码。MLflow 也是一个用户和库开发者可以扩展的<a class="ae nd" href="https://github.com/databricks/mlflow" rel="noopener ugc nofollow" target="_blank">开源项目</a>。</em></p><h2 id="901a" class="ne ks iq bd kt nf ng dn kx nh ni dp lb lt nj nk ld lx nl nm lf mb nn no lh np bi translated">安装 MLflow</h2><p id="1b41" class="pw-post-body-paragraph lk ll iq lm b ln nq jr lp lq nr ju ls lt ns lv lw lx nt lz ma mb nu md me mf ij bi translated">安装 MLflow 非常简单，您只需运行:</p><pre class="kg kh ki kj gt nv nw nx ny aw nz bi"><span id="0d58" class="ne ks iq nw b gy oa ob l oc od">pip install mlflow</span></pre><p id="1853" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">这是根据创作者所说的。但是我在安装的时候遇到了几个问题。所以下面是我的建议(如果安装 ignore 后可以在终端中运行 mlflow 的话):</p><blockquote class="oe of og"><p id="4179" class="lk ll nc lm b ln lo jr lp lq lr ju ls oh lu lv lw oi ly lz ma oj mc md me mf ij bi translated">来自 Databricks: MLflow 不能安装在 Python 的 MacOS 系统安装上。我们推荐使用<code class="fe ok ol om nw b">brew install python</code>通过<a class="ae nd" href="https://brew.sh/" rel="noopener ugc nofollow" target="_blank">自制</a>包管理器安装 Python 3。(在这种情况下，安装 mlflow 现在是<code class="fe ok ol om nw b">pip3 install mlflow</code>)。</p></blockquote><p id="6d55" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">这对我不起作用，我得到了这个错误:</p><pre class="kg kh ki kj gt nv nw nx ny aw nz bi"><span id="5dec" class="ne ks iq nw b gy oa ob l oc od">~ ❯ mlflow<br/>Traceback (most recent call last):<br/>  File "/usr/bin/mlflow", line 7, in &lt;module&gt;<br/>    from mlflow.cli import cli<br/>  File "/usr/lib/python3.6/site-packages/mlflow/__init__.py", line 8, in &lt;module&gt;<br/>    import mlflow.projects as projects # noqa<br/>  File "/usr/lib/python3.6/site-packages/mlflow/projects.py", line 18, in &lt;module&gt;<br/>    from mlflow.entities.param import Param<br/>  File "/usr/lib/python3.6/site-packages/mlflow/entities/param.py", line 2, in &lt;module&gt;<br/>    from mlflow.protos.service_pb2 import Param as ProtoParam<br/>  File "/usr/lib/python3.6/site-packages/mlflow/protos/service_pb2.py", line 127, in &lt;module&gt;<br/>    options=None, file=DESCRIPTOR),<br/>TypeError: __init__() got an unexpected keyword argument 'file'</span></pre><p id="3ff4" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">解决这个问题的方法并不容易。我用的是 MacOS btw。为了解决这个问题，我需要更新<em class="nc"> protobuf </em>库。为此，我安装了 Google 的 protobuf 库，其来源为:</p><div class="mg mh gp gr mi mj"><a href="https://github.com/google/protobuf/releases" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab fo"><div class="ml ab mm cl cj mn"><h2 class="bd ir gy z fp mo fr fs mp fu fw ip bi translated">谷歌/protobuf</h2><div class="mq l"><h3 class="bd b gy z fp mo fr fs mp fu fw dk translated">protobuf -协议缓冲区-谷歌的数据交换格式</h3></div><div class="mr l"><p class="bd b dl z fp mo fr fs mp fu fw dk translated">github.com</p></div></div><div class="ms l"><div class="on l mu mv mw ms mx kp mj"/></div></div></a></div><p id="284f" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">下载 3.5.1 版本。我之前有过 3.3.1。请遵循以下步骤:</p><div class="mg mh gp gr mi mj"><a href="http://google.github.io/proto-lens/installing-protoc.html" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab fo"><div class="ml ab mm cl cj mn"><h2 class="bd ir gy z fp mo fr fs mp fu fw ip bi translated">安装协议</h2><div class="mq l"><h3 class="bd b gy z fp mo fr fs mp fu fw dk translated">使用现代 Haskell 语言和库模式的协议缓冲 API。</h3></div><div class="mr l"><p class="bd b dl z fp mo fr fs mp fu fw dk translated">google.github.io</p></div></div></div></a></div><p id="820b" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">或者试着用自制的。</p><p id="37c7" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">如果您的安装工作正常，运行</p><pre class="kg kh ki kj gt nv nw nx ny aw nz bi"><span id="fa62" class="ne ks iq nw b gy oa ob l oc od">mlflow</span></pre><p id="5db6" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">你应该看看这个:</p><pre class="kg kh ki kj gt nv nw nx ny aw nz bi"><span id="f18a" class="ne ks iq nw b gy oa ob l oc od">Usage: mlflow [OPTIONS] COMMAND [ARGS]...</span><span id="8c34" class="ne ks iq nw b gy oo ob l oc od">Options:<br/>  --version  Show the version and exit.<br/>  --help     Show this message and exit.</span><span id="cf82" class="ne ks iq nw b gy oo ob l oc od">Commands:<br/>  azureml      Serve models on Azure ML.<br/>  download     Downloads the artifact at the specified DBFS...<br/>  experiments  Tracking APIs.<br/>  pyfunc       Serve Python models locally.<br/>  run          Run an MLflow project from the given URI.<br/>  sagemaker    Serve models on SageMaker.<br/>  sklearn      Serve SciKit-Learn models.<br/>  ui           Run the MLflow tracking UI.</span></pre><h2 id="0968" class="ne ks iq bd kt nf ng dn kx nh ni dp lb lt nj nk ld lx nl nm lf mb nn no lh np bi translated">MLflow 快速入门</h2><p id="b502" class="pw-post-body-paragraph lk ll iq lm b ln nq jr lp lq nr ju ls lt ns lv lw lx nt lz ma mb nu md me mf ij bi translated">现在您已经安装了 MLflow，让我们运行一个简单的示例。</p><pre class="kg kh ki kj gt nv nw nx ny aw nz bi"><span id="037d" class="ne ks iq nw b gy oa ob l oc od"><strong class="nw ir">import</strong> <strong class="nw ir">os</strong><br/><strong class="nw ir">from</strong> <strong class="nw ir">mlflow</strong> <strong class="nw ir">import</strong> log_metric, log_param, log_artifact<br/><br/><strong class="nw ir">if</strong> __name__ == "__main__":<br/>    <em class="nc"># Log a parameter (key-value pair)</em><br/>    log_param("param1", 5)<br/><br/>    <em class="nc"># Log a metric; metrics can be updated throughout the run</em><br/>    log_metric("foo", 1)<br/>    log_metric("foo", 2)<br/>    log_metric("foo", 3)<br/><br/>    <em class="nc"># Log an artifact (output file)</em><br/>    <strong class="nw ir">with</strong> open("output.txt", "w") <strong class="nw ir">as</strong> f:<br/>        f.write("Hello world!")<br/>    log_artifact("output.txt")</span></pre><p id="f5fe" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">将其保存到 train.py，然后使用</p><pre class="kg kh ki kj gt nv nw nx ny aw nz bi"><span id="5258" class="ne ks iq nw b gy oa ob l oc od">python train.py</span></pre><p id="06f4" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">您将看到以下内容:</p><pre class="kg kh ki kj gt nv nw nx ny aw nz bi"><span id="c3b8" class="ne ks iq nw b gy oa ob l oc od">Running test.py</span></pre><p id="9626" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">就这样吗？没有。使用 MLflow，您可以通过编写以下内容轻松访问用户界面:</p><pre class="kg kh ki kj gt nv nw nx ny aw nz bi"><span id="1ca8" class="ne ks iq nw b gy oa ob l oc od">mlflow ui</span></pre><p id="148e" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">您将看到(localhost:默认为 5000):</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi op"><img src="../Images/a3d0e258208999eff5a9dea70ed08a22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*akUJE7w95naWMV29NBmu6A.png"/></div></div></figure><p id="f873" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">那么到目前为止我们做了什么？如果你看到代码，你会看到我们使用了两个东西，一个<em class="nc"> log_param，</em>T2】log _ metric 和<em class="nc"> log_artifact。</em>第一个记录当前运行下传入的参数，如果需要的话创建一个运行，第二个记录当前运行下传入的度量，如果需要的话创建一个运行，最后一个记录一个本地文件或目录作为当前活动运行的工件。</p><p id="0cf2" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">通过这个简单的例子，我们了解了如何在生命周期中保存参数、指标和文件的日志。</p><p id="7dd4" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">如果我们点击运行的日期，我们可以看到更多的信息。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oq"><img src="../Images/c5e938bfc96396173af21c1cf7466b96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n-fYHrsu1ipBE_z0j9iapw.png"/></div></div></figure><p id="068e" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">现在，如果我们单击该指标，我们可以看到它在运行过程中是如何更新的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi or"><img src="../Images/6cd5ac4d41d851f28b4b9c285e2484c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*D1LN3R9byRXl01Aw3Ra4dw.png"/></div></div></figure><p id="778a" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">如果我们单击工件，我们可以看到它的预览:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi os"><img src="../Images/2a4974d5c4110051baf4a68cdc689b1b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eGCq8CWVkCmF_a3KARMluA.png"/></div></div></figure><h1 id="cb3e" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">物流跟踪</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ot"><img src="../Images/82d5c48827f85b76102e291ebd70fc57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KyuCY_JVO5sMwOxk.png"/></div></div></figure><p id="e202" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">MLflow 跟踪组件允许您使用 REST 或 Python 记录和查询实验。</p><p id="e99b" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">每次运行记录以下信息:</p><p id="9f00" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated"><strong class="lm ir">代码版本:</strong> Git commit 用于执行运行，如果它是从<a class="ae nd" href="https://mlflow.org/docs/latest/projects.html#projects" rel="noopener ugc nofollow" target="_blank"> MLflow 项目</a>中执行的。</p><p id="70c7" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated"><strong class="lm ir">开始&amp;结束:</strong>运行的开始和结束时间</p><p id="619f" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated"><strong class="lm ir">源:</strong>为启动运行而执行的文件的名称，或者如果运行是从<a class="ae nd" href="https://mlflow.org/docs/latest/projects.html#projects" rel="noopener ugc nofollow" target="_blank"> MLflow 项目</a>中执行的，则为运行的项目名称和入口点。</p><p id="5025" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated"><strong class="lm ir">参数:</strong>键值输入你选择的参数。键和值都是字符串。</p><p id="dfd2" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated"><strong class="lm ir">指标:</strong>值为数字的键值指标。在整个运行过程中，可以更新每个指标(例如，跟踪模型的损失函数如何收敛)，MLflow 将记录并让您可视化指标的完整历史。</p><p id="501b" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated"><strong class="lm ir">工件:</strong>输出任意格式的文件。例如，您可以将图像(例如，png)、模型(例如，腌制的 SciKit-Learn 模型)甚至数据文件(例如，<a class="ae nd" href="https://parquet.apache.org/" rel="noopener ugc nofollow" target="_blank">拼花</a>文件)记录为工件。</p><p id="b2f9" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">可以有选择地将运行组织成<em class="nc">实验</em>，这些实验将特定任务的运行组合在一起。您可以通过<code class="fe ok ol om nw b">mlflow experiments</code> CLI、使用<code class="fe ok ol om nw b"><a class="ae nd" href="https://mlflow.org/docs/latest/python_api/mlflow.html#mlflow.create_experiment" rel="noopener ugc nofollow" target="_blank"><strong class="lm ir">mlflow.create_experiment()</strong></a></code>或通过相应的 REST 参数创建一个实验。</p><pre class="kg kh ki kj gt nv nw nx ny aw nz bi"><span id="7887" class="ne ks iq nw b gy oa ob l oc od"><em class="nc"># Prints "created an experiment with ID &lt;id&gt;</em><br/>mlflow experiments create face-detection<br/><em class="nc"># Set the ID via environment variables</em><br/>export MLFLOW_EXPERIMENT_ID=&lt;id&gt;</span></pre><p id="e6bd" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">然后你开始一个实验:</p><pre class="kg kh ki kj gt nv nw nx ny aw nz bi"><span id="539c" class="ne ks iq nw b gy oa ob l oc od"><em class="nc"># Launch a run. The experiment ID is inferred from the MLFLOW_EXPERIMENT_ID environment variable</em></span><span id="7f61" class="ne ks iq nw b gy oo ob l oc od"><strong class="nw ir">with</strong> mlflow.start_run():<br/>    mlflow.log_parameter("a", 1)<br/>    mlflow.log_metric("b", 2)</span></pre><h2 id="b80e" class="ne ks iq bd kt nf ng dn kx nh ni dp lb lt nj nk ld lx nl nm lf mb nn no lh np bi translated">跟踪示例:</h2><p id="00a0" class="pw-post-body-paragraph lk ll iq lm b ln nq jr lp lq nr ju ls lt ns lv lw lx nt lz ma mb nu md me mf ij bi translated">一个使用<a class="ae nd" href="https://archive.ics.uci.edu/ml/datasets/wine+quality" rel="noopener ugc nofollow" target="_blank">葡萄酒质量数据集</a>的简单例子:包括两个数据集，分别与来自葡萄牙北部的红葡萄酒和白葡萄酒相关。目标是基于物理化学测试来模拟葡萄酒质量。</p><p id="ab38" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">首先下载该文件:</p><p id="a1d3" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated"><a class="ae nd" href="https://raw.githubusercontent.com/databricks/mlflow/master/example/tutorial/wine-quality.csv" rel="noopener ugc nofollow" target="_blank">https://raw . githubusercontent . com/databricks/ml flow/master/example/tutorial/wine-quality . CSV</a></p><p id="df68" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">然后在文件夹中创建文件 train.py，内容如下:</p><pre class="kg kh ki kj gt nv nw nx ny aw nz bi"><span id="afc6" class="ne ks iq nw b gy oa ob l oc od"><em class="nc"># Read the wine-quality csv file</em><br/><br/>data = pd.read_csv("wine-quality.csv")<br/><br/><em class="nc"># Split the data into training and test sets. (0.75, 0.25) split.</em><br/>train, test = train_test_split(data)<br/><br/><em class="nc"># The predicted column is "quality" which is a scalar from [3, 9]</em><br/>train_x = train.drop(["quality"], axis=1)<br/>test_x = test.drop(["quality"], axis=1)<br/>train_y = train[["quality"]]<br/>test_y = test[["quality"]]<br/><br/>alpha = float(sys.argv[1]) <strong class="nw ir">if</strong> len(sys.argv) &gt; 1 <strong class="nw ir">else</strong> 0.5<br/>l1_ratio = float(sys.argv[2]) <strong class="nw ir">if</strong> len(sys.argv) &gt; 2 <strong class="nw ir">else</strong> 0.5<br/><br/><strong class="nw ir">with</strong> mlflow.start_run():<br/>    lr = ElasticNet(alpha=alpha, l1_ratio=l1_ratio, random_state=42)<br/>    lr.fit(train_x, train_y)<br/><br/>    predicted_qualities = lr.predict(test_x)<br/><br/>    (rmse, mae, r2) = eval_metrics(test_y, predicted_qualities)<br/><br/>    print("Elasticnet model (alpha=<em class="nc">%f</em>, l1_ratio=<em class="nc">%f</em>):" % (alpha, l1_ratio))<br/>    print("  RMSE: <em class="nc">%s</em>" % rmse)<br/>    print("  MAE: <em class="nc">%s</em>" % mae)<br/>    print("  R2: <em class="nc">%s</em>" % r2)<br/><br/>    mlflow.log_param("alpha", alpha)<br/>    mlflow.log_param("l1_ratio", l1_ratio)<br/>    mlflow.log_metric("rmse", rmse)<br/>    mlflow.log_metric("r2", r2)<br/>    mlflow.log_metric("mae", mae)<br/><br/>    mlflow.sklearn.log_model(lr, "model")</span></pre><p id="28f8" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">在这里，我们将为 SciKit-Learn 介绍 MLflow 集成。运行后，您将在终端中看到:</p><pre class="kg kh ki kj gt nv nw nx ny aw nz bi"><span id="c476" class="ne ks iq nw b gy oa ob l oc od">Elasticnet model (alpha=0.500000, l1_ratio=0.500000):<br/>  RMSE: 0.82224284976<br/>  MAE: 0.627876141016<br/>  R2: 0.126787219728</span></pre><p id="3469" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">然后在包含<code class="fe ok ol om nw b">mlruns</code>目录的同一个当前工作目录中运行 mlflow ui，并在浏览器中导航到<a class="ae nd" href="http://localhost:5000/" rel="noopener ugc nofollow" target="_blank"> http://localhost:5000 </a>。你会看到:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ou"><img src="../Images/771ac76bd3ebce75791eb41b393295e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K8osy-1ju5fqMaxxGrsj6w.png"/></div></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ov"><img src="../Images/41ff0711f158d9638a34095995cedeec.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gLVq3Rt0nigt_1NLF2p45Q.png"/></div></div></figure><p id="8c60" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">每次跑步你都会有这个，这样你就可以跟踪你做的每一件事。该模型还有一个 pkl 文件和一个 YAML，用于部署、复制和共享。</p><h1 id="f192" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated"><strong class="ak">敬请关注更多</strong></h1><p id="1fa7" class="pw-post-body-paragraph lk ll iq lm b ln nq jr lp lq nr ju ls lt ns lv lw lx nt lz ma mb nu md me mf ij bi translated">在下一篇文章中，我将介绍项目和模型 API，我们将能够在生产中运行这些模型，并创建一个完整的生命周期。</p><p id="6a53" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">请务必查看 MLflow 项目以了解更多信息:</p><div class="mg mh gp gr mi mj"><a href="https://github.com/databricks/mlflow" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab fo"><div class="ml ab mm cl cj mn"><h2 class="bd ir gy z fp mo fr fs mp fu fw ip bi translated">数据块/ml 流</h2><div class="mq l"><h3 class="bd b gy z fp mo fr fs mp fu fw dk translated">mlflow -完整机器学习生命周期的开源平台</h3></div><div class="mr l"><p class="bd b dl z fp mo fr fs mp fu fw dk translated">github.com</p></div></div><div class="ms l"><div class="ow l mu mv mw ms mx kp mj"/></div></div></a></div></div><div class="ab cl ox oy hu oz" role="separator"><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc"/></div><div class="ij ik il im in"><p id="a131" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">感谢你阅读这篇文章。希望你在这里发现了一些有趣的东西:)</p><p id="183c" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">如果你有任何问题，请在推特上关注我</p><div class="mg mh gp gr mi mj"><a href="https://twitter.com/faviovaz" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab fo"><div class="ml ab mm cl cj mn"><h2 class="bd ir gy z fp mo fr fs mp fu fw ip bi translated">法维奥·巴斯克斯(@法维奥·巴斯克斯)|推特</h2><div class="mq l"><h3 class="bd b gy z fp mo fr fs mp fu fw dk translated">Favio Vázquez 的最新推文(@FavioVaz)。数据科学家。物理学家和计算工程师。我有一个…</h3></div><div class="mr l"><p class="bd b dl z fp mo fr fs mp fu fw dk translated">twitter.com</p></div></div><div class="ms l"><div class="pe l mu mv mw ms mx kp mj"/></div></div></a></div><p id="f3ae" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">还有 LinkedIn。</p><div class="mg mh gp gr mi mj"><a href="http://linkedin.com/in/faviovazquez/" rel="noopener  ugc nofollow" target="_blank"><div class="mk ab fo"><div class="ml ab mm cl cj mn"><h2 class="bd ir gy z fp mo fr fs mp fu fw ip bi translated">Favio Vázquez —首席数据科学家— OXXO | LinkedIn</h2><div class="mq l"><h3 class="bd b gy z fp mo fr fs mp fu fw dk translated">查看 Favio Vázquez 在世界上最大的职业社区 LinkedIn 上的个人资料。Favio 有 15 个工作职位列在…</h3></div><div class="mr l"><p class="bd b dl z fp mo fr fs mp fu fw dk translated">linkedin.com</p></div></div><div class="ms l"><div class="pf l mu mv mw ms mx kp mj"/></div></div></a></div><p id="24a1" class="pw-post-body-paragraph lk ll iq lm b ln lo jr lp lq lr ju ls lt lu lv lw lx ly lz ma mb mc md me mf ij bi translated">那里见:)</p></div></div>    
</body>
</html>