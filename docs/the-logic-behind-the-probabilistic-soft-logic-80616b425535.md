# 概率软逻辑背后的逻辑

> 原文：<https://towardsdatascience.com/the-logic-behind-the-probabilistic-soft-logic-80616b425535?source=collection_archive---------10----------------------->

继我之前的博客文章“概率软逻辑的高层次概述”之后，我们将关注 PSL 的核心。

我们在上一篇博客中讨论的样本规则(原子)由变量组成，并且是通用的格式。

例如

*2.0:姓名(A，姓名 _A) &姓名(B，姓名 _B) &相似(姓名 _A，姓名 _B) →同一个人(A，B)*

因此，我们称这些规则为“解除规则”。如果你记得接地是什么意思，我们可以重申，并提到这些规则还没有接地。所以，第一步是把实际值代入这些原子，得到一组基本规则，我们将在这里继续工作。

现在我们需要理解这些基于“和”和“或”的基本规则是如何被解释的，以至于 PSL 可以处理它。使用布尔逻辑，很容易观察到基本规则到逻辑规则的转换。但是对于处理软逻辑的 PSL 来说，它比简单的“1”或“0”要稍微复杂一些。

![](img/afd03a798a20708fdd49494b475ddad5.png)

让我们从评估规则是否会“快乐”开始。

(在看了一些先决概念之后，我们将阐明规则的快乐到底意味着什么)。

规则的“快乐”将是基于规则体(规则的“如果”部分)和头(规则的“那么”部分)的真值的度量。由于规则的行为类似布尔逻辑，如果主体的真值较低，则规则将始终为真。

![](img/c05eda86f013d22895c4e9aa936ffd53.png)

如果身体有很高的真值，那么规则的快乐将取决于头脑是否快乐。

![](img/b4406017b6d9807b403d15b755d26b8f.png)

在《T4》中，如果瑞秋和莫妮卡真的是朋友，规则就是快乐。既然我们提到了 ***如果*** (瑞秋，莫妮卡)是朋友 ***和*** (菲比，莫妮卡)是朋友 ***那么*** (瑞秋，莫妮卡)是朋友，结果就是这样。

但是在*(2)*中，因为我们考虑了如果-然后的关系，我们设想了瑞秋和莫妮卡不是朋友的场景。因为这个压头会很低，所以规则不会被满足。

所以我们仍然试图在这里传达一种直觉。但是我们需要从数学上明确这些函数实际上做什么。为此，我们使用 Lukasiewicz T-范数。

# Lukasiewicz T-范数

Lukasiewicz T-norms 采用逻辑规则(A 和 B)主体的真值，并评估要满足的规则头部的最小所需真值。

![](img/d3ffb442019abe2614e45b6b6b0e66be.png)

这里上面将产生身体的真值

根据以上所述，可以观察到，这些逻辑具有与布尔逻辑完全一样的行为能力。当主体的所有真值都是 1 和 0 时，它能够产生 1 或 0，对于其他软真值，它将在 0 和 1 之间变化。

这里上面会产生身体的真值。

根据以上所述，可以观察到，这些逻辑具有与布尔逻辑完全一样的行为能力。当主体的所有真值都是 1 和 0 时，它能够产生 1 或 0，对于其他软真值，它将在 0 和 1 之间变化。

# 规则的快乐

现在回到规则的“快乐”，这也可以被称为规则的满意度。但是对于一个规则来说，快乐或满意到底意味着什么呢？

为了说一个规则被满足，头脑的真值应该至少和身体的真值一样大。

示例:

考虑以下情况，其中 *B1* 和 *B2* 是基本规则主体的一部分，而 *H1* 是头部。

![](img/2ef57c0653b9a1b16670be4c0462945e.png)

为身体中的原子建立真值我们需要找到头部的最小真值以满足规则。

![](img/f48b7eefa3713d25d9823f87a2b34d12.png)

我们可以将上述内容转化为实际场景:

(瑞秋，菲比)是真值 0.7 的朋友。(菲比，莫妮卡)是真值 0.8 的朋友。那么在什么条件下会满足这个规则呢？

为了回答这个问题，我们解析 Lukasiewicz T-norms，其中 *B1* 和 *B2* 映射到 A 和 b

![](img/2b8adfa9bb1f1000c55b6b00e8ed00af.png)

据此，身体的真值为 0.5。所以，对于任何头部≥5 的值，规则都是快乐的或满足的。这意味着如果( *Rachel* ， *Monica)* 的友谊的真值至少为 0.5，那么传递性规则将得到满足。

![](img/f4a48194ac3044a6e8d9600ffbd6f4ff.png)

所以当规则需要快乐或满足时，头部的真值应该是或超过上面案例中的 0.5。但是当头部的真值没有超过这个值会怎么样呢？当规则不能快乐或满足时会发生什么？

这就是另一个衡量标准“满意度”的背景。

**满意距离**

“距离”，在一般意义上，意味着一个人离某物有多远。调整到“满意的距离”，它仅仅意味着规则离满意还有多远。当头部的价值没有超过身体时，满足感的距离可以让我们洞察到规则离达到这样的满足感还有多远。

满意的距离作用于以下，这将导致 0 或身体和头部之间的差异。

![](img/be58a205772ba54116bb190565d13954.png)

在上面我们规则的快乐评估中，规则的满意度是 0.5。如果我们将 0.7 的真值赋给头部，这意味着

![](img/6030fc2eedd044e629483794e9560e2d.png)

因为身体的真实值是 0.5，而头部的真实值是 0.7，很明显，这个规则将会令人高兴或满意，因为头部的真实值大于身体的真实值。因此，在这里计算满意的距离，我们得到 0.0 满意的距离，因为规则将总是被满足，并且在这个实例中离被满足不远。

但现在让我们举一个反面的例子，头部的真值为 0.3，身体的真值保持不变。

![](img/66b3beb151df12594f2c65f4940ca4a2.png)

这些计算计算规则是否得到满足以及离满足还有多远。但是我们可以通过给每条规则增加一个权重来增强这些规则，这将会给我们“满意的加权距离”。

总结到这一点，

*   有一组已知的关系被发现为谓词。这些都有固定的真值。
*   但是有些人可能不知道真实值，在这种情况下，我们得到满意度的加权距离。这就是概率论发挥作用的地方。

# 概率论

所有可能的分配都可以绘制成概率分布，并放置在概率模型中。并且概率将由那些加权的满意度距离来确定。

因此，继续下去，权重的可能值从 0 到无穷大，我们如何决定分配给每个基本规则的权重？

![](img/575e6a6b5e55a4f071798ce2ac9f151a.png)![](img/5c131e7f6ba639d56ac027aea03494e1.png)

这个概率模型复制了判别模型。所以在这里，我们为不同的真值赋值定义了一个概率分布，给了我们未知原子不同的解释。

这就给我们留下了模型中每个基本规则的 1 个基础或 1 个特征。该要素将满意度的距离作为其值。规则的权重将作为满意距离的参数。

所以根据这个概率密度，随着满意距离的增加，我们会失去更多的概率。此外，随着规则权重的增加，我们会更快地失去概率。这方面的概要是:

规则的权重越高→满足该规则就越重要

该模型是称为“铰链损失马尔可夫随机场”的特定类型模型的推广。

# 铰链损失马尔可夫随机场

铰链损失函数是一种表示机器学习中错误分类或不准确预测所导致的开销的方式。铰链损失在支持向量机(SVM)中被形象地用于最大间隔分类。因此，铰链损失马尔可夫随机场是离散马尔可夫随机场的分支，除了它的函数是铰链损失[1]。

![](img/45e6a885d162da186f38962583e6fcbb.png)

PSL 模型总是基于铰链损失马尔可夫随机场。

**参考文献**

[1]巴赫，S. H .，布罗意切勒，m .，黄，b .，&格图尔，L. (2015)。铰链损失马尔可夫随机场和概率软逻辑。arXiv 预印本 arXiv:1505.04406。