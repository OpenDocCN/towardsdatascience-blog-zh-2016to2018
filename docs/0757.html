<html>
<head>
<title>Data Visualization of Elite Swimmers’ Competition Results (Part 1 — Datasets)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">优秀游泳运动员比赛成绩的数据可视化(第一部分——数据集)</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-visualization-of-elite-swimmers-competition-results-part-1-datasets-bd09b68154c2?source=collection_archive---------2-----------------------#2017-06-18">https://towardsdatascience.com/data-visualization-of-elite-swimmers-competition-results-part-1-datasets-bd09b68154c2?source=collection_archive---------2-----------------------#2017-06-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="b746" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这篇文章是数据可视化项目《游泳者的历史》制作笔记的第一部分。</p><div class="kl km gp gr kn ko"><a href="http://tany.kim/swimmers-history" rel="noopener  ugc nofollow" target="_blank"><div class="kp ab fo"><div class="kq ab kr cl cj ks"><h2 class="bd ir gy z fp kt fr fs ku fu fw ip bi translated">游泳运动员的历史</h2><div class="kv l"><h3 class="bd b gy z fp kt fr fs ku fu fw dk translated">大型游泳比赛中优秀游泳运动员比赛成绩的数据可视化。探索+1500 游泳者的历史…</h3></div><div class="kw l"><p class="bd b dl z fp kt fr fs ku fu fw dk translated">tany.kim</p></div></div><div class="kx l"><div class="ky l kz la lb kx lc ld ko"/></div></div></a></div><p id="f56b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">游泳是我长期以来的兴趣，我一直想让数据可视化。最近(阅读:一年前:-)，我发现<a class="ae le" href="https://www.swimrankings.net/" rel="noopener ugc nofollow" target="_blank">一个伟大的网站</a>提供了无数游泳比赛的结果，我试图利用网站上的信息。在这篇文章中，我将讨论我是如何<strong class="jp ir">废弃安全的 HTML 页面(用 R) </strong>，提取有用的数据点，最后<strong class="jp ir">生成可视化的最佳数据集(用 Python) </strong>。有了数据集，我设计了允许用户选择游泳比赛/事件的可视化，并按游泳者过滤比赛。因此，我在前端包含了用于<strong class="jp ir">数据过滤(重新生成数据子集)的 UI 组件设计。为了更好地理解收集到的数据集，我还谈了一下游泳世界。</strong></p><h1 id="7ada" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">感兴趣的游泳数据</h1><p id="4713" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">在 SwimRankings.net 的众多网页中，我关注的是精英游泳运动员渴望参加的国际比赛。目前，自 2007 年以来主要比赛的全部结果都在网站上公开。</p><h2 id="9435" class="mi lg iq bd lh mj mk dn ll ml mm dp lp jy mn mo lt kc mp mq lx kg mr ms mb mt bi translated">五大游泳比赛</h2><p id="48d3" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">从 2007 年到 2016 年，总共报道了 17 场会议。</p><ul class=""><li id="d430" class="mu mv iq jp b jq jr ju jv jy mw kc mx kg my kk mz na nb nc bi translated">奥运会:每四年一次——2008 年、2012 年、2016 年</li><li id="8a7b" class="mu mv iq jp b jq nd ju ne jy nf kc ng kg nh kk mz na nb nc bi translated"><a class="ae le" href="https://en.wikipedia.org/wiki/FINA_World_Aquatics_Championships" rel="noopener ugc nofollow" target="_blank">世界锦标赛</a>:每隔奇数年——2007、2009、2011、2013、2015</li><li id="e4a0" class="mu mv iq jp b jq nd ju ne jy nf kc ng kg nh kk mz na nb nc bi translated"><a class="ae le" href="https://en.wikipedia.org/wiki/LEN_European_Aquatics_Championships" rel="noopener ugc nofollow" target="_blank">欧洲锦标赛</a>:每偶数年——2008、2010、2012、2014、2016 年</li><li id="92af" class="mu mv iq jp b jq nd ju ne jy nf kc ng kg nh kk mz na nb nc bi translated"><a class="ae le" href="https://en.wikipedia.org/wiki/Swimming_at_the_Commonwealth_Games" rel="noopener ugc nofollow" target="_blank">英联邦运动会</a>:每四年一届非奥运会——2010 年、2014 年</li><li id="60eb" class="mu mv iq jp b jq nd ju ne jy nf kc ng kg nh kk mz na nb nc bi translated"><a class="ae le" href="https://en.wikipedia.org/wiki/Pan_Pacific_Swimming_Championships" rel="noopener ugc nofollow" target="_blank">泛太平洋锦标赛</a>:每非奥运四年一届——2010 年、2014 年</li></ul><h2 id="c033" class="mi lg iq bd lh mj mk dn ll ml mm dp lp jy mn mo lt kc mp mq lx kg mr ms mb mt bi translated">奥运项目</h2><p id="5c23" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">游泳项目大体上分为个人和团体两种。在这个项目中，我包括了引入奥运会的项目。例如，较短距离(50 米)仰泳和蛙泳比赛在世界锦标赛中进行，但在奥运会中没有。男女种族之间，没有完美的对称；男子最长自由泳是 1500 米，而女子是 800 米。</p><p id="1291" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该数据集只包括决赛，这使得<strong class="jp ir">总共有 544 场比赛(16 场比赛 X 2 个性别 X 17 场比赛)</strong>。下面是我使用的数据集中的事件列表。</p><ul class=""><li id="a0a6" class="mu mv iq jp b jq jr ju jv jy mw kc mx kg my kk mz na nb nc bi translated">个人自由泳:50 米、100 米、200 米、400 米、800 米(仅限女子)、1500 米(仅限男子)</li><li id="5435" class="mu mv iq jp b jq nd ju ne jy nf kc ng kg nh kk mz na nb nc bi translated">个人仰泳:100 米，200 米</li><li id="e370" class="mu mv iq jp b jq nd ju ne jy nf kc ng kg nh kk mz na nb nc bi translated">个人蛙泳:100 米、200 米</li><li id="7cf9" class="mu mv iq jp b jq nd ju ne jy nf kc ng kg nh kk mz na nb nc bi translated">个人蝶泳:100 米，200 米</li><li id="343f" class="mu mv iq jp b jq nd ju ne jy nf kc ng kg nh kk mz na nb nc bi translated">个人混合泳:200 米，400 米</li><li id="3d2d" class="mu mv iq jp b jq nd ju ne jy nf kc ng kg nh kk mz na nb nc bi translated">团体自由泳:4x 100 米、4x 200 米</li><li id="995c" class="mu mv iq jp b jq nd ju ne jy nf kc ng kg nh kk mz na nb nc bi translated">团体混合泳:4x 100 米</li></ul><h1 id="2682" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">用 R 废弃安全的 HTML 页面</h1><p id="6c8e" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">在源网站上，每个事件都在一个单独的页面中提供，该页面在相同的 URL 基础上用参数标识，这些参数包括会议 ID、性别和风格(事件)ID。比如 2016 里约奥运会的(遇见)男子(性别)，50 米自由泳项目(风格)页面网址是这样的:</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="c039" class="mi lg iq nn b gy nr ns l nt nu">page=meetDetail&amp;meetId=596227&amp;gender=1&amp;styleId=16</span></pre><p id="9a71" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了获得 17 场比赛的 ID，我解析了每场比赛的 meta info 页面(例如，<a class="ae le" href="https://www.swimrankings.net/index.php?page=meetSelect&amp;selectPage=BYTYPE&amp;nationId=0&amp;meetType=1" rel="noopener ugc nofollow" target="_blank">奥运会页面</a>)，因为这些页面有到上面 URL 的超链接。<strong class="jp ir">获得正确索引值的保证方法是检查源代码。</strong>在奥运页面，我关注的部分在这里:</p><figure class="ni nj nk nl gt nw gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi nv"><img src="../Images/db8fdae2bbed64480f3f0980e0021605.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eVyvU4wvDdSLSrcJAaH06g.png"/></div></div><figcaption class="oc od gj gh gi oe of bd b be z dk">A part that I inspected of the Olympics info page.</figcaption></figure><figure class="ni nj nk nl gt nw gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi og"><img src="../Images/53415e8b69d5a5d9e78022a6b800b4f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KkAYRtvrSRWIdVdFdL9tYQ.png"/></div></div><figcaption class="oc od gj gh gi oe of bd b be z dk">A link to a specific meet has the meet ID</figcaption></figure><p id="4b7c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">代码检查显示每届奥运会的比赛 ID。此外，我从这个来源追踪了主办国和主办城市的名称。</p><figure class="ni nj nk nl gt nw gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi oh"><img src="../Images/104f10783681227be2b90c1548adfe88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2rPyHuogT_TOv23iYIBgZw.png"/></div></div><figcaption class="oc od gj gh gi oe of bd b be z dk">Dropdown menu of styles shows style IDs.</figcaption></figure><p id="79a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们有了所有的会议 id。样式 ID 是从 meet 页面中的<select>标签的代码检查中手工收集的。</select></p><p id="6efd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">提取所有 544 场比赛的 R 脚本在这里<a class="ae le" href="https://github.com/tanykim/swimmers-history/blob/master/R/swimmers.R" rel="noopener ugc nofollow" target="_blank">可用</a>。有了这些脚本，我只想用<strong class="jp ir">将整个网页删除并保存为文件</strong>，然后用 Python 做更多的数据烹饪。为什么不用 R 或 Python 做所有的事情？我更喜欢 Python 语法的简单性。我尝试用 Python 解析网页，但是用 Python 解析安全页面(https)很棘手。如果你知道一个方法，请让我知道！</p><h1 id="d60f" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">用 Python 烹饪数据</h1><p id="679c" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">下一步是从废弃的网页中只解析有用的部分。</p><figure class="ni nj nk nl gt nw gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi oi"><img src="../Images/aae6fa92e4eac49882c80313c39662aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3ocNyDT2a-wNDnaBZ04GGA.png"/></div></div><figcaption class="oc od gj gh gi oe of bd b be z dk">The exact part of resource that I targeted in a webpage</figcaption></figure><h2 id="808a" class="mi lg iq bd lh mj mk dn ll ml mm dp lp jy mn mo lt kc mp mq lx kg mr ms mb mt bi translated">数据解析</h2><p id="0d3e" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">与我对 R 所做的类似，我检查了 HTML 标签，并跟踪了比赛信息，包括比赛日期和决赛的结果(例如，<a class="ae le" href="https://www.swimrankings.net/index.php?page=meetDetail&amp;meetId=596227&amp;gender=1&amp;styleId=1" rel="noopener ugc nofollow" target="_blank">里约奥运会 50 米男子自由泳</a>)。</p><figure class="ni nj nk nl gt nw gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi oj"><img src="../Images/4bd56f441f73f0e139b9030275adfd35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AojzdH11kH0jyblFf-pIiw.png"/></div></div><figcaption class="oc od gj gh gi oe of bd b be z dk">The hyperlink to a swimmer’s info has theathlete ID.</figcaption></figure><p id="23eb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于每个游泳者，我追踪他们的名字、国家、游泳时间和分数。此外，<strong class="jp ir">通过检查源代码，我能够找到每个游泳者的唯一 ID </strong>，它也用作前端上数据过滤/处理的标识符<strong class="jp ir">。最后，我得出了总共 869 名男子和 779 名女子游泳运动员的比赛结果。</strong></p><p id="8f58" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">没有完美的干净数据</strong>可以立即满足您的需求。特别是当你想设计独特的和定制的数据可视化，<strong class="jp ir">在前端使用数据集之前，优化数据集以满足你的需求是至关重要的。</strong>这是因为在客户端使用 Javascript 处理大型数据集需要一些时间，这可能会导致大量的加载时间，并最终导致用户受挫。</p><h2 id="da63" class="mi lg iq bd lh mj mk dn ll ml mm dp lp jy mn mo lt kc mp mq lx kg mr ms mb mt bi translated">格式化用于演示的数据</h2><p id="b67a" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">我想在前端以特定的顺序显示比赛和事件，所以我给每个比赛和比赛名称添加了单个字母。</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="0904" class="mi lg iq nn b gy nr ns l nt nu">meet_year_letter = {    <br/>    '2016': 'a',    <br/>    '2015': 'b',<br/>    ...<br/>    '2007': 'j'<br/>}</span><span id="ab30" class="mi lg iq nn b gy ok ns l nt nu">events_name = {    <br/>    '1': ['50m Freestyle', 'a50Fr', '0IND'],    <br/>    '2': ['100m Freestyle', 'b100Fr', '0IND'], <br/>    ...<br/>    '19': ['400m Medley', 'n400IM', '0IND'],    <br/>    ...<br/>    '40': ['4 X 100m Medley', 'q4X100M', '1TEAM']<br/>}</span></pre><p id="0ee1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我分析了所有游泳者的信息。游泳者的信息结构如下:我将记录信息存储为数组。</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="71e5" class="mi lg iq nn b gy nr ns l nt nu">{<br/>    "id": "4038916",<br/>    "name":"Michael Phelps",<br/>    "country": "United States",<br/>    "records":[<br/>        {<br/>            "place":"2",<br/>            "point":924,<br/>            "race_id":"0OG-a2016--0IND-k100Fly",<br/>            "swimtime":"51.14"<br/>        },<br/>        ....<br/>    ]<br/>}</span></pre><p id="99c3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">正如我将在下一篇文章中更详细描述的，我想展示游泳者的网络。使用 Python，我创建了包含任何一对在同一场比赛中一起参赛的游泳运动员的关系信息的数据集。</p><pre class="ni nj nk nl gt nm nn no np aw nq bi"><span id="5b11" class="mi lg iq nn b gy nr ns l nt nu">{<br/>    "source":"4042367",<br/>    "target":"4081509",<br/>    "value":[<br/>        "0OG-a2016--0IND-a50Fr",<br/>        "0OG-e2012--0IND-a50Fr",<br/>        "1WC-d2013--0IND-a50Fr",<br/>        "1WC-d2013--1TEAM-o4X100Fr"<br/>    ]<br/>}</span></pre><p id="ed06" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在 Python 脚本的最后，我将它保存为前端的一个 JSON 文件<strong class="jp ir">。看 Python 代码<a class="ae le" href="https://github.com/tanykim/swimmers-history/blob/master/python/parsing.py" rel="noopener ugc nofollow" target="_blank">这里</a>。</strong></p><h1 id="2ce5" class="lf lg iq bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">前端的数据过滤</h1><p id="9d23" class="pw-post-body-paragraph jn jo iq jp b jq md js jt ju me jw jx jy mf ka kb kc mg ke kf kg mh ki kj kk ij bi translated">考虑到这个项目的真实用例，一次呈现所有游泳者的数据并不是最有用的。人们会有特定的需求，比如“我想看迈克尔·菲尔普斯在奥运会上的所有游泳比赛。”为了支持这一点，我设计了 UI 组件，允许用户选择比赛和事件，并按名称指定游泳者。我假设人们想要比较不同会议上的同一事件或同一会议上的多个事件。这样设计:一旦用户选择会议和事件，所选会议和事件的所有组合都包括在内。此外，她还可以选择游泳运动员，以进一步排除所选游泳运动员没有参加的比赛。</p><figure class="ni nj nk nl gt nw gh gi paragraph-image"><div role="button" tabindex="0" class="nx ny di nz bf oa"><div class="gh gi ol"><img src="../Images/62d71ecfee8ba7788f2590bbb02a1f0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3XHym1q5ODSHVITBWZf1Wg.png"/></div></div><figcaption class="oc od gj gh gi oe of bd b be z dk">Options for filtering races (Among total 17 meets and 16 events)</figcaption></figure><p id="b83c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如，选择三届奥运会(2008、2012、2016)和男子所有七项自由泳赛事(50 米、100 米、200 米、400 米、800/1500 米、4 X 100 米接力和 4 X 200 米接力)将返回 21 场比赛(3 X 7)和 166 名游泳运动员。然后，如果通过姓名过滤选项选择了迈克尔·菲尔普斯，则游泳运动员的总数将减少到 140 名。</p><p id="5eed" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">当该选项面板中的选择被更新时，一个新的数据子集被生成，可视化也被重新创建。React-Redux 很好地管理了这种基于前端的数据处理，我在这里不再进一步讨论。如果你感兴趣，去检查我的<a class="ae le" href="https://github.com/tanykim/swimmers-history/tree/master/react-app/src/reducers" rel="noopener ugc nofollow" target="_blank"> GitHub repo </a>上的代码。</strong></p><p id="1b6b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请继续阅读下一篇关于<a class="ae le" href="https://medium.com/@tanykim/data-visualization-of-elite-swimmers-competition-results-part-2-design-dc86d77946b8" rel="noopener">可视化设计</a>和同一项目构思的帖子。也别忘了查看<a class="ae le" href="https://medium.com/@tanykim/data-visualization-of-elite-swimmers-competition-results-part-3-insights-7ec5862f48a7" rel="noopener">见解</a>上的帖子。</p></div></div>    
</body>
</html>