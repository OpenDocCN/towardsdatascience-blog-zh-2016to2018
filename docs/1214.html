<html>
<head>
<title>Deep Learning with Tensorflow: Part 4 — face classification and video inputs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Tensorflow深度学习:第4部分—人脸分类和视频输入</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/deep-learning-with-tensorflow-part-4-face-classification-and-video-inputs-fa078f22c1e5?source=collection_archive---------1-----------------------#2017-08-11">https://towardsdatascience.com/deep-learning-with-tensorflow-part-4-face-classification-and-video-inputs-fa078f22c1e5?source=collection_archive---------1-----------------------#2017-08-11</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div class="gh gi jq"><img src="../Images/8506c628069c236e106078f6c540e30e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/0*HWFrQkopocYHTdBw.jpg"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk">Can we classify different people?</figcaption></figure><p id="0b6b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">大家好，欢迎回到我的紧张流系列，这是第4部分。这可能是这个系列的最后一部分，因为我们已经学到了很多:</p><ul class=""><li id="f3c0" class="kz la it kd b ke kf ki kj km lb kq lc ku ld ky le lf lg lh bi translated"><a class="ae li" href="https://medium.com/towards-data-science/deep-learning-with-tensorflow-part-1-b19ce7803428" rel="noopener">第1部分</a>全是理论，我们看了神经网络和张量流的逻辑和功能。</li><li id="dfd9" class="kz la it kd b ke lj ki lk km ll kq lm ku ln ky le lf lg lh bi translated">在<a class="ae li" href="https://medium.com/towards-data-science/deep-learning-with-tensorflow-part-2-image-classification-58fcdffa7b84" rel="noopener">第二部分，我们用几何形状进行图像分类。</a></li><li id="cd5b" class="kz la it kd b ke lj ki lk km ll kq lm ku ln ky le lf lg lh bi translated">在<a class="ae li" href="https://medium.com/towards-data-science/deep-learning-with-tensorflow-part-3-music-and-text-generation-8a3fbfdc5e9b" rel="noopener"> part 3 </a>中，我们成功生成了自己的音乐和文字。</li></ul><p id="ea49" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">由于图像分类是神经网络最有趣的部分(至少在我看来)，我们将在这一部分再次进行。但是，在我们继续重建分类器以接收视频输入之前，我们将对人的图像进行分类，而不是几何形状。让我们去争取吧。</p></div><div class="ab cl lo lp hx lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="im in io ip iq"><h1 id="1662" class="lv lw it bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">回顾我们在第2部分中构建的分类器</h1><figure class="mu mv mw mx gt ju gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/f6c9974772e70b071248001461667a9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*_pW0vpQRgFXxHkOPMGqRZw.png"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk">how did our classifier work?</figcaption></figure><p id="c391" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">你可能不记得第二部分是关于什么的，所以这里有一个简短的总结:</p><p id="7642" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">我们构建了一个程序，它加载了来自Google的预训练的Inception v3模型，移除了旧的顶层，并在我们想要添加的几何形状类上训练了一个新的顶层。再培训分为两个阶段——瓶颈阶段和培训阶段。瓶颈将我们的图像处理成一个有意义的和紧凑的摘要，训练实际上训练了我们神经网络的顶层。如果还是不清楚，请阅读<a class="ae li" href="https://medium.com/towards-data-science/deep-learning-with-tensorflow-part-2-image-classification-58fcdffa7b84" rel="noopener">第二部分</a>；)</p></div><div class="ab cl lo lp hx lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="im in io ip iq"><h1 id="75a2" class="lv lw it bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">给人分类</h1><p id="6904" class="pw-post-body-paragraph kb kc it kd b ke my kg kh ki mz kk kl km na ko kp kq nb ks kt ku nc kw kx ky im bi translated">上次，我们在初始模型中添加了四类几何形状。这一次，我们将对三个不同的人进行分类:“史蒂夫·乔布斯”、“比尔·盖茨”和“马克·扎克伯格”。让我们看看《盗梦空间》是否足以区分这些人的面孔:</p><p id="0e88" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">首先从GitHub克隆我的存储库，键入:</p><pre class="mu mv mw mx gt nd ne nf ng aw nh bi"><span id="4f7e" class="ni lw it ne b gy nj nk l nl nm">git clone <a class="ae li" href="https://github.com/koflerm/tensorflow-image-classifier.git" rel="noopener ugc nofollow" target="_blank">https://github.com/koflerm/tensorflow-image-classifier.git</a></span></pre><p id="b29a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来，我们需要添加我们的训练图像并给它们贴上标签。建立一个这样的结构:</p><pre class="mu mv mw mx gt nd ne nf ng aw nh bi"><span id="83d5" class="ni lw it ne b gy nj nk l nl nm">/<br/>--- /training_dataset<br/>|    |<br/>|    --- /billgates<br/>|    |    billy.jpg<br/>|    |    bill_gates.png<br/>|    |    ...<br/>|    |<br/>|    --- /stevejobs<br/>|         stevejobs.jpg<br/>|         jobs.jpg<br/>|         ...<br/>|    |<br/>|    --- /markzuckerberg<br/>|         zuckerberg46.jpg<br/>|         zuckerberg2020.jpg<br/>|         ...</span></pre><p id="470b" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">为了下载图片，我使用了一个名为“<a class="ae li" href="http://chrome-extension://gfjhimhkjmipphnaminnnnjpnlneeplk" rel="noopener ugc nofollow" target="_blank">批量下载图片</a>”的Chrome扩展。这个扩展允许你自动下载谷歌图片到你的电脑上。图像格式不重要！</p><figure class="mu mv mw mx gt ju gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/496166c36bffc6961c093799934b6ceb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1284/format:webp/1*Y-V1JUM9U0thBBwZFcvjSQ.png"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk">how images for the Steve-Jobs-class could look like</figcaption></figure></div><div class="ab cl lo lp hx lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="im in io ip iq"><h2 id="5fe6" class="ni lw it bd lx no np dn mb nq nr dp mf km ns nt mj kq nu nv mn ku nw nx mr ny bi translated">是时候训练我们的模型了</h2><p id="7d84" class="pw-post-body-paragraph kb kc it kd b ke my kg kh ki mz kk kl km na ko kp kq nb ks kt ku nc kw kx ky im bi translated">设置好数据后，让训练开始！双击执行<code class="fe nz oa ob ne b">train.sh</code>脚本。该脚本安装初始模型，并为指定的图像数据集启动重新训练过程。</p><figure class="mu mv mw mx gt ju gh gi paragraph-image"><div class="gh gi mt"><img src="../Images/f6c9974772e70b071248001461667a9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:920/format:webp/1*_pW0vpQRgFXxHkOPMGqRZw.png"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk">re-training process</figcaption></figure><p id="d569" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">一旦这个过程完成，我们的训练准确率应该在90%左右。</p><p id="a652" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在重新训练模型之后，现在是用其他图像测试模型的时候了。下载并复制到根目录，然后键入:</p><pre class="mu mv mw mx gt nd ne nf ng aw nh bi"><span id="5632" class="ni lw it ne b gy nj nk l nl nm">python classify.py downloadedBillGates.jpg</span></pre></div><div class="ab cl lo lp hx lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="im in io ip iq"><h2 id="c3e6" class="ni lw it bd lx no np dn mb nq nr dp mf km ns nt mj kq nu nv mn ku nw nx mr ny bi translated">好吧，很好。但是我们的模型表现如何呢？</h2><figure class="mu mv mw mx gt ju gh gi paragraph-image"><div class="gh gi oc"><img src="../Images/9e060cdf3e93b17bc825c3b379c24aeb.png" data-original-src="https://miro.medium.com/v2/resize:fit:972/format:webp/1*DB0Dw0LAQn8lnob-ElikeQ.png"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk">model works!</figcaption></figure><p id="24f7" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">比尔·盖茨直视镜头，光线还不错，所以没问题。</p><figure class="mu mv mw mx gt ju gh gi paragraph-image"><div class="gh gi od"><img src="../Images/e43c1fdab7cad13966ba0bacaea2d221.png" data-original-src="https://miro.medium.com/v2/resize:fit:1102/format:webp/1*uamlbCgMCeEufEYA47gstA.png"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk">success!</figcaption></figure><p id="3e3e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">令人惊讶的是，合适的人又得到了认可。图像分辨率很差(300x300)，扎克伯格甚至不在图像的中心。干得好，盗梦空间！</p><figure class="mu mv mw mx gt ju gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/45a94f74afbd0c7cf2c75b2e8fb501c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1058/format:webp/1*1PzkAM-DeDloEjZ5iKm6Rw.png"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk">Both are recognized, but both can’t get a high score</figcaption></figure><p id="42e2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这是一个棘手的问题！Inception是为单标签图像分类而训练的，这意味着它的总得分为1。多标签分类是不可能的，而且由于我们的两个类都显示在图像中，所以都不可能得到高分。如果我想让这张图片更像“史蒂夫·乔布斯”，我必须为他的班级使用更准确、更大的训练集。</p><figure class="mu mv mw mx gt ju gh gi paragraph-image"><div class="gh gi of"><img src="../Images/1fb3faee5e6924367bd6b2fdc6cb0764.png" data-original-src="https://miro.medium.com/v2/resize:fit:1086/format:webp/1*KCXrZpz6Abk_g8Pm0ZO_Cg.png"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk">Again, Gates over Jobs</figcaption></figure><p id="77ea" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这张图片再次被归类为盖茨胜于乔布斯，这一次是以巨大的优势。我猜，在准确的照明条件下，更准确的训练集和更多的训练数据可能会让史蒂夫·乔布斯赢得这场决斗。</p><figure class="mu mv mw mx gt ju gh gi paragraph-image"><div class="gh gi og"><img src="../Images/60eae819cbfd124bde6355d1e1e1bf79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1176/format:webp/1*AjjYUv1sO8jam38uidw5aQ.png"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk">All about Steve Jobs this time</figcaption></figure><p id="d4ba" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">最后，这个人被认出来了！但这对我们的模特来说并不难，不是吗(很棒的灯光，他直视镜头，…)</p><figure class="mu mv mw mx gt ju gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/ca3a315bef7611126634735bdcd6136a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1292/format:webp/1*uxFZaqdbUkeEHT7DXO54yQ.png"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk">Testing on images with other, unknown people</figcaption></figure><p id="b33f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">盖茨被认出来了，马克·扎克伯格也是(尽管他不在照片上)。我猜《盗梦空间》把桑德罗·罗塞尔(左边)当成了马克·扎克伯格，但没错，肯定是不匹配！</p></div><div class="ab cl lo lp hx lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="im in io ip iq"><p id="b40a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">(可选):如果您现在想要添加新的类，可以通过键入以下命令将培训和测试结合起来:</p><pre class="mu mv mw mx gt nd ne nf ng aw nh bi"><span id="e875" class="ni lw it ne b gy nj nk l nl nm">python retrain.py — bottleneck_dir=tf_files/bottlenecks — how_many_training_steps=500 — model_dir=inception — summaries_dir=tf_files/training_summaries/basic — output_graph=tf_files/retrained_graph.pb — output_labels=tf_files/retrained_labels.txt — image_dir=training_dataset — eval_step_interval=100 &amp; python classify.py image.jpg</span></pre><blockquote class="oi oj ok"><p id="83b8" class="kb kc ol kd b ke kf kg kh ki kj kk kl om kn ko kp on kr ks kt oo kv kw kx ky im bi translated">注意:image.jpg是你想用来测试你的模型的图像</p></blockquote><p id="a52a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在你知道了，我们可以用盗梦空间对人脸进行分类。但是现在，让我们继续为视频输入重建分类器。</p></div><div class="ab cl lo lp hx lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="im in io ip iq"><h1 id="3af7" class="lv lw it bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">重建我们的视频输入分类器</h1><figure class="mu mv mw mx gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="oq or di os bf ot"><div class="gh gi op"><img src="../Images/f5b2ef176e8b6050c86c0b4e4c5890d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o3g5IqkLpBlV4NrC2_EYMA.png"/></div></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk">image classification using a video as input stream and analyzing it frame-by-frame</figcaption></figure><p id="f7cb" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">到目前为止，我们一张一张地下载了我们的测试数据，但是这很费力，不是吗？用视频输入来测试我们的模型会容易得多。我们只需要插入一个视频一次，但是分类是一帧一帧完成的。简单多了。因此，让我们建立这样一个系统:</p></div><div class="ab cl lo lp hx lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="im in io ip iq"><h2 id="4d97" class="ni lw it bd lx no np dn mb nq nr dp mf km ns nt mj kq nu nv mn ku nw nx mr ny bi translated">我们的代码如何变化</h2><p id="8f7b" class="pw-post-body-paragraph kb kc it kd b ke my kg kh ki mz kk kl km na ko kp kq nb ks kt ku nc kw kx ky im bi translated">基本上没什么变化。我们只需要触摸<code class="fe nz oa ob ne b">classify.py</code>脚本。我将一步一步地引导你完成这些改变:</p><pre class="mu mv mw mx gt nd ne nf ng aw nh bi"><span id="8e44" class="ni lw it ne b gy nj nk l nl nm">pip install opencv-py </span></pre><p id="3ec2" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">首先，打开一个终端并安装OpenCV，一个用于视频处理和图像分析的库。</p><pre class="mu mv mw mx gt nd ne nf ng aw nh bi"><span id="a00c" class="ni lw it ne b gy nj nk l nl nm">import cv2<br/>import math</span></pre><p id="5d17" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后我们需要加载和处理我们的视频。我们通过导入OpenCV模块来做到这一点。数学包的导入实际上是可选的，只有当你不想处理每一帧时才需要它。</p><figure class="mu mv mw mx gt ju"><div class="bz fp l di"><div class="ou ov l"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk">rewritten part of the code</figcaption></figure><p id="4e23" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这是代码的重要部分。如果你想更深入一点，请阅读评论，我认为他们自己说了算。原理很简单:当我们得到一个视频帧时，我们存储它并立即再次读取它用于分类目的，然后在一个单独的窗口中输出分数和帧本身。</p></div><div class="ab cl lo lp hx lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="im in io ip iq"><h2 id="1586" class="ni lw it bd lx no np dn mb nq nr dp mf km ns nt mj kq nu nv mn ku nw nx mr ny bi translated">现在，让我们用比尔·盖茨和史蒂夫·乔布斯的对话视频来测试我们的模型。</h2><p id="b24f" class="pw-post-body-paragraph kb kc it kd b ke my kg kh ki mz kk kl km na ko kp kq nb ks kt ku nc kw kx ky im bi translated">但首先，我认为你必须同时…执行<code class="fe nz oa ob ne b">train.sh</code>并等待直到进程完成:)</p><p id="7a5a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后，有趣的部分开始了。我将在下面的视频中测试我的模型:</p><figure class="mu mv mw mx gt ju"><div class="bz fp l di"><div class="ow ov l"/></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk">Video does not contain Mark Zuckerberg</figcaption></figure><p id="37ec" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来，我们要等很长时间，直到比尔·盖茨第一次被拍摄。分类器有什么反应？</p><figure class="mu mv mw mx gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="oq or di os bf ot"><div class="gh gi ox"><img src="../Images/8eb3b88702cbba64ab646b16a3806c83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h7JqZSzFffhw4sCo4FQg9A.png"/></div></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk">Gates gets recognized more or less</figcaption></figure><p id="af6e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">正如我们所看到的，模型实际上对他进行了正确的分类，尽管比尔·盖茨的头被切掉了一点。我们当然知道我们的模型现在确实适用于视频，但它也能识别史蒂夫·乔布斯吗？</p><figure class="mu mv mw mx gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="oq or di os bf ot"><div class="gh gi oy"><img src="../Images/1f28449645b0eaffaeef5a96d0eaa2c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1ZHLPWlpxBk7jWc5HmS30Q.png"/></div></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk">Perfect recognition</figcaption></figure><p id="ddd6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">是的。用乔布斯的话其实更好，分数大概是0.9。但是有一个问题仍然悬而未决:如果两个人都在同一个框架里会发生什么？</p><figure class="mu mv mw mx gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="oq or di os bf ot"><div class="gh gi oy"><img src="../Images/6139f4020657f77728ec77df936234bf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZWu9q1EGuiP8Vxe9CLN8iQ.png"/></div></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk">Jobs over Gates here</figcaption></figure><p id="a066" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这个框架被归类为“工作”。前面解释过，分数加起来一个，两个人都拿不到高分。</p><p id="fe00" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">现在是时候接受新的挑战了:手绘。我们的模型能识别手绘物体吗？<br/>我们将再次添加四个几何类“圆”、“三角形”、“正方形”和“加号”来完成:</p></div><div class="ab cl lo lp hx lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="im in io ip iq"><h2 id="8cf2" class="ni lw it bd lx no np dn mb nq nr dp mf km ns nt mj kq nu nv mn ku nw nx mr ny bi translated">让我们用手绘视频作为输入来测试我们的模型</h2><p id="104f" class="pw-post-body-paragraph kb kc it kd b ke my kg kh ki mz kk kl km na ko kp kq nb ks kt ku nc kw kx ky im bi translated">因此，首先我们必须再次将我们的类添加到模型中，以防您在第2部分中删除了它们。最终，培训文件夹中应该会有这样的结构。</p><pre class="mu mv mw mx gt nd ne nf ng aw nh bi"><span id="b5bb" class="ni lw it ne b gy nj nk l nl nm">/<br/>--- /training_dataset<br/>|    |<br/>|    --- /billgates<br/>|    --- /stevejobs<br/>|    --- /markzuckerberg<br/>|    --- /circle<br/>|    --- /square<br/>|    --- /plus<br/>|    --- /triangle</span></pre><p id="074e" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">用训练图像填充所有这些文件夹。我将用谷歌搜索的图像填充它们，尽管这些图像不会是手绘！看事情如何发展会很有趣。</p><p id="2e49" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">接下来，训练。在拍摄你自己的几何图形定制视频之前，运行<code class="fe nz oa ob ne b">train.sh</code>脚本来添加新的类到模型中。你也可以用我的，在GitHub上我的回购里找到的<code class="fe nz oa ob ne b">math_own_old.mp4</code>。</p><p id="345f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">那么，我们来对一些框架进行分类。在命令行输入<code class="fe nz oa ob ne b">python classify.py math_own_old.mp4</code>，看看你的模型是否能够识别正确的形状。</p><figure class="mu mv mw mx gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="oq or di os bf ot"><div class="gh gi oz"><img src="../Images/3446ce6ffb78e6496b7a70d51f409f79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KsfDIdDr08GCGMJiLo4eNQ.png"/></div></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk">Square gets classified correctly</figcaption></figure><p id="809f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">多好的开始啊！正方形是成功的，但是其他的物体呢？</p><figure class="mu mv mw mx gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="oq or di os bf ot"><div class="gh gi pa"><img src="../Images/ad0190262501984bb3bf1e55e100c16b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_sEXRQrMqe-vzP-CtYc7qw.png"/></div></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk">Our model mistakes triangle</figcaption></figure><p id="fd12" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">好了，你知道了。我们的模型不识别手绘的三角形，它认为它是正方形。也许下一个…</p><figure class="mu mv mw mx gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="oq or di os bf ot"><div class="gh gi oz"><img src="../Images/0b9ccf749c3febb74344f168454d0d92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z1Zsrla9LX5ld3NVZw14Bg.png"/></div></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk">Again, triangle not recognized</figcaption></figure><p id="bcbe" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">这值得一试，但它再次认为它是一个正方形。奇怪的是，加号似乎对模型也是不可见的。秘社是我们最后的希望！</p><figure class="mu mv mw mx gt ju gh gi paragraph-image"><div role="button" tabindex="0" class="oq or di os bf ot"><div class="gh gi pb"><img src="../Images/6a9f3287f564077f817d51336d03178b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bC3CeBKUaW0FuZ8wom5FAg.png"/></div></div><figcaption class="jx jy gj gh gi jz ka bd b be z dk">Success!</figcaption></figure><p id="7b61" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">是的，圆得到正确分类！但正如所见，对于一个由计算机生成的图像训练的模型来说，识别分辨率很差的手绘图片是非常困难的。</p><h1 id="a22c" class="lv lw it bd lx ly pc ma mb mc pd me mf mg pe mi mj mk pf mm mn mo pg mq mr ms bi translated">结论</h1><p id="ba71" class="pw-post-body-paragraph kb kc it kd b ke my kg kh ki mz kk kl km na ko kp kq nb ks kt ku nc kw kx ky im bi translated">所以，现在你知道了，用盗梦空间和张量流对人进行分类是可能的。此外，您还学习了如何重写一些代码来使用视频作为输入源。这是这个系列的最后一部分，我希望你喜欢这个旅程。我自己肯定学到了很多。如果你有任何类型的反馈给我，我会很感激的<a class="ae li" href="https://emojipedia.org/victory-hand/" rel="noopener ugc nofollow" target="_blank"> ✌ </a></p></div></div>    
</body>
</html>