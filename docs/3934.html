<html>
<head>
<title>My Journey Into Programming and Bioinformatics: Part 3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">我的编程和生物信息学之旅:第 3 部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/my-journey-into-programming-and-bioinformatics-part-3-224ea62e92e0?source=collection_archive---------10-----------------------#2018-07-02">https://towardsdatascience.com/my-journey-into-programming-and-bioinformatics-part-3-224ea62e92e0?source=collection_archive---------10-----------------------#2018-07-02</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/8a3541e207b0fb39ab267987d84a3640.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zm8p-1r4VnK9ynCjfUAfrw.png"/></div></div></figure><p id="ae1d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">生物信息学是一个非常广阔的领域，甚至还有专门的生物信息学硕士学位。在 10 分钟左右的阅读时间内涵盖所有方面是不可能的。如果你刚刚起步，对专业术语感到困惑，请阅读这篇文章。如果你想深入研究，Github   <em class="kw">上有免费开放的</em> <a class="ae kx" href="https://github.com/ossu/bioinformatics" rel="noopener ugc nofollow" target="_blank"> <em class="kw">生物信息学课程。</em></a></p></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><p id="79f1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi lf translated">既然我们可以(在某种程度上)编程(第 1 部分)并对大规模并行测序(第 2 部分)的一些概念有所了解，我们可以继续并将这些应用于我们面临的任何问题。</p><p id="b4e1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">更类似于第 1 部分，这篇文章将是一个教程、指南和期刊文章的集合，可以帮助您找到进一步研究的正确方向。这里的很多信息在<a class="ae kx" href="https://www.illumina.com/content/dam/illumina-marketing/documents/products/illumina_sequencing_introduction.pdf" rel="noopener ugc nofollow" target="_blank"> Illumina 测序介绍中也有涉及。</a></p><p id="a301" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在我们开始之前，了解常用术语是很重要的。我也将只涉及基于 Illumina 的测序，因为它是最广泛使用的测序类型。</p><h2 id="0d07" class="lo lp iq bd lq lr ls dn lt lu lv dp lw kj lx ly lz kn ma mb mc kr md me mf mg bi translated">词汇表</h2><p id="96f5" class="pw-post-body-paragraph jy jz iq ka b kb mh kd ke kf mi kh ki kj mj kl km kn mk kp kq kr ml kt ku kv ij bi translated"><strong class="ka ir">覆盖面或阅读深度。</strong>单个核苷酸的覆盖率或阅读深度(例如 30X)是该核苷酸被测序运行有效调用的次数。人类基因组 30 倍的平均覆盖率意味着平均每个核苷酸被测序 30 次。为什么这很重要？假设你只调用每个核苷酸一次。这样，你永远也不能说出这个位点是纯合的还是杂合的。如果你调用每个核苷酸两次，你可能会碰巧得到两次相同的核苷酸(例如一个 T)。你会认为这是一个纯合位点，而实际上，它是一个杂合位点(例如 A/C)。增加你调用该碱基的次数会增加以该碱基的真实频率结束的几率(50-50%，在蚊子或癌症中非常小的亚克隆的情况下为 1-99%)。</p><p id="bc9d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">成对末端读取。</strong>成对末端测序能够对 DNA 片段的两端进行测序。因为每对读数之间的距离是已知的，比对算法可以使用该信息更精确地绘制重复区域的读数。这导致更好的读数比对，特别是在基因组的难以测序的重复区域，并允许检测结构变异。<a class="ae kx" href="http://www.illumina. com/technology/next-generation-sequencing/paired-end-sequencing_assay.html" rel="noopener ugc nofollow" target="_blank">更多信息请点击这里</a>。</p><p id="72c6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> Phred (Q)质量评分。</strong>Q = 10 log(10)P，其中 P =不良碱基或变异呼叫的概率。例如，如果 Phred 给碱基分配 30 (Q30)的 Q 分数，这相当于 1000 次中不正确碱基呼叫 1 的概率。这意味着碱基调用的准确性(即，正确碱基调用的概率)是 99.9%。<a class="ae kx" href="https://www.illumina.com/documents/products/technotes/technote_Q-Scores.pdf" rel="noopener ugc nofollow" target="_blank">更多信息点击这里</a>。</p><p id="ba3d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> FASTA 和 FASTQ 文件。</strong>FASTA 格式用于存储生物序列(如核苷酸:“AGTCGGCTATTGCGAG”或氨基酸:“LIAEAYPEDSNATST”)。FASTQ 格式是 FASTA 格式的扩展，包含相应核苷酸的 Phred 质量分数，以显示测序仪对该核苷酸的“确信”程度。<a class="ae kx" href="https://en.wikipedia.org/wiki/FASTQ_format" rel="noopener ugc nofollow" target="_blank">更多信息请点击此处。</a></p><p id="8342" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">参考基因组。</strong>当测序仪显示读数时(FASTQ 格式)，您需要将它们与参考基因组进行比对，以查看它们来自哪里。更简单的是，目前有三个参考基因组在使用。2009 年:GRCh37 和 hg192013 年:GRCh38。GRCh37 和 hg19 的染色体位置相同，但 GRCh*使用“chr”前缀表示染色体，而 hg*不使用。虽然这似乎是一个微不足道的问题，但如果你决定交换参考基因组，这可能会给你带来很多麻烦。挑一个坚持下去，除非真的要改。<a class="ae kx" href="https://www.biostars.org/p/113100/" rel="noopener ugc nofollow" target="_blank">这里是关于差异的更多信息</a>。<a class="ae kx" href="https://lh3.github.io/2017/11/13/which-human-reference-genome-to-use" rel="noopener ugc nofollow" target="_blank">阅读如何选择参考基因组。</a>虽然如果每个人都改用 GRCh38 会更好，但许多工具仍然依赖于 2009 版本，这使得转换很困难。</p><p id="ce4a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> SAM/BAM/CRAM-files。</strong>SAM 格式是用于与参考序列比对的生物序列的格式，支持短和长读取(高达 128 Mb)。BAM 与 SAM 完全相同，但采用二进制格式以实现高效压缩(BAM 可由计算机读取，而 SAM 可由人类读取),因为 SAM 文件可能会变得非常、非常、非常大。CRAM 是 BAM 的更压缩版本。更多信息可在<a class="ae kx" href="https://samtools.github.io/hts-specs/SAMv1.pdf." rel="noopener ugc nofollow" target="_blank"> SAMtools 文档中找到。</a></p><p id="7361" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">变体呼叫格式(VCF)。</strong>VCF 格式是包含元信息行、标题行和数据行的文本文件，每一行都包含关于基因组中位置的信息。标题行命名了 8 个固定的强制列。这些列是:CHROM(染色体)、POS(位置)、ID(如 rsID)、REF(参考)、ALT(替代)、QUAL <br/>(质量)、FILTER(通过或失败)、INFO(附加信息)。SAMtools 文档中提供了更多信息<a class="ae kx" href="http://samtools.github.io/hts-specs/VCFv4.2.pdf." rel="noopener ugc nofollow" target="_blank">。</a></p><h2 id="b806" class="lo lp iq bd lq lr ls dn lt lu lv dp lw kj lx ly lz kn ma mb mc kr md me mf mg bi translated">图书馆准备</h2><p id="d80b" class="pw-post-body-paragraph jy jz iq ka b kb mh kd ke kf mi kh ki kj mj kl km kn mk kp kq kr ml kt ku kv ij bi translated">在您开始处理数据之前，显然您首先需要数据。将“原始”DNA 或 RNA 转化为可以测序的东西的过程被称为<em class="kw">文库制备</em>或简称为文库制备。它包括将 DNA 片段化成短序列(~300bp)并添加衔接子、索引和尾部。测序引物需要衔接子来结合。后面的解复用需要索引(见下文),最后，尾使 DNA 片段结合流动细胞成为可能。如果您对此感到困惑，请阅读第 2 部分了解更多信息。</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mm"><img src="../Images/c587f9afe8155016e1e56e3b71d1e462.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cr_VUAo1WctxADtspDIrUA.jpeg"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk"><a class="ae kx" href="https://www.fimm.fi/en/services/technology-centre/sequencing/next-generation-sequencing/dna-library-preparation" rel="noopener ugc nofollow" target="_blank">Illustration by Fimm</a></figcaption></figure><p id="da6c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我不会在这里涉及湿实验室方面，让湿实验室的人在你开始做这些类型的分析时施展他们的魔法。但是，每个实验都是不同的，您需要了解您的样品使用的是哪种文库制备。如果你不这样做，你会有解释 QC 图的问题。</p><h2 id="3be7" class="lo lp iq bd lq lr ls dn lt lu lv dp lw kj lx ly lz kn ma mb mc kr md me mf mg bi translated">定序</h2><p id="91a4" class="pw-post-body-paragraph jy jz iq ka b kb mh kd ke kf mi kh ki kj mj kl km kn mk kp kq kr ml kt ku kv ij bi translated">在大多数情况下，当你刚刚开始时，你的工作将在测序运行结束时开始。看看测序的质量。我怎么强调都不为过。如果你有坏的数据开始，因为，例如，你的文库制备或测序运行出错，你的下游分析也将是坏的。垃圾进=垃圾出。</p><p id="fd0b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你的跑步记录被上传到 Basespace，你需要在<a class="ae kx" href="https://basespace.illumina.com/" rel="noopener ugc nofollow" target="_blank">https://basespace.illumina.com/</a>建立账户。</p><p id="2cb1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">第一次打开 Basespace 时，你会被一系列你不理解的 QC 参数击中。为了更好地了解在 Basespace QC 中发生的事情，最好了解 Illumina 测序实际上是如何工作的。为此，我们需要深入研究流动池。根据您使用的机器，有两种流动池:模式化流动池和随机流动池。</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/7cfcbe3969d4b3f9532b7f3d736b3f72.png" data-original-src="https://miro.medium.com/v2/resize:fit:1270/format:webp/1*SJUfxYWhE_o9cTvXOOtX-g.png"/></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk"><a class="ae kx" href="https://core-genomics.blogspot.com/2016/01/almost-everything-you-wanted-to-know.html" rel="noopener ugc nofollow" target="_blank">Further reading at CoreGenomics</a></figcaption></figure><p id="bf85" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">图案化和非图案化流动池都有优点和缺点。</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/357d326c30ac4277064076597658f3b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mPq4mGtNoKQfeoXp73gCUQ.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk">Sources of duplicate reads on Illumina platforms. Source: Illumina.</figcaption></figure><p id="899d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您使用的是未形成图案的流动池，机器必须预先(用显微镜)目测决定簇的位置。通常(取决于测序机器)，这在前 5 个循环中完成。如果你使用一个低多样性的库，这会导致问题。例如，如果您的文库中的前 5 个核苷酸都是相同的(以 CAGTG 开始)，测序仪将不知道哪里有簇(因为在循环 1 中，整个流动池有 1 种颜色，C；在周期 2 中，整个流动池具有不同的颜色，等等)。</p><p id="0016" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了解决这个问题，你可以插入一个更复杂的不同的库，比如<a class="ae kx" href="https://www.illumina.com/products/by-type/sequencing-kits/cluster-gen-sequencing-reagents/phix-control-v3.html" rel="noopener ugc nofollow" target="_blank"> PhiX 基因组。</a>通常，在文库中加入约 1%的 PhiX 作为阳性对照来计算错误率。您知道 PhiX 基因组的序列，并且您知道比对后 PhiX 基因组中有多少错误，从而允许您计算测序运行中其他样品的错误率。在低多样性库的情况下，增加更高%的 PhiX 会增加库的多样性。</p><p id="461b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">Illumina 有一个指南<a class="ae kx" href="https://help.basespace.illumina.com/articles/descriptive/runs-charts/" rel="noopener ugc nofollow" target="_blank">解释地下室的参数</a>。如果你认为你的跑步过于拥挤，这里有一个有用的指南<a class="ae kx" href="https://www.illumina.com/content/dam/illumina-marketing/documents/products/other/miseq-overclustering-primer-770-2014-038.pdf" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="953a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一个常见的问题是，你需要多少阅读量来准备你的图书馆。老实说，我不知道。使用覆盖率计算器。</p><p id="65f1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在看了几次测序运行后(特别是如果你有一次不好的运行)，你会更熟悉什么参数是重要的，要注意什么等等。如果你不知道你在看什么，问问你的同事。</p><h2 id="c008" class="lo lp iq bd lq lr ls dn lt lu lv dp lw kj lx ly lz kn ma mb mc kr md me mf mg bi translated">Fastq 产生和解复用</h2><p id="34a0" class="pw-post-body-paragraph jy jz iq ka b kb mh kd ke kf mi kh ki kj mj kl km kn mk kp kq kr ml kt ku kv ij bi translated">你的测序给了你。bcl 文件(基本调用文件)。对于下游分析，我们需要。fastq 文件，用<a class="ae kx" href="https://support.illumina.com/content/dam/illumina-support/documents/documentation/software_documentation/bcl2fastq/bcl2fastq_letterbooklet_15038058brpmi.pdf" rel="noopener ugc nofollow" target="_blank"> bcl2fastq </a>生成。如果您使用的是 Basespace，这是自动完成的。大多数情况下，您会希望每次测序运行对多个样品进行测序，因为(a)每个样品不需要那么多读数，(b)这样更便宜，(c)这样更快。</p><p id="6e05" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这就是为什么对于每个样本，你的 DNA 片段会有不同的索引。将读数合并回原始样本的过程称为<em class="kw">解复用</em>。Basespace 会自动为您完成这项工作。如果出于某种原因，你需要手动操作，<a class="ae kx" href="http://bioinformatics.cvr.ac.uk/blog/how-to-demultiplex-illumina-data-and-generate-fastq-files-using-bcl2fastq/" rel="noopener ugc nofollow" target="_blank">Gavin Wilkie 的</a>是一个很好的指南。</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mx"><img src="../Images/b13af5a1c3b5038ec5bb14a0854cbb0d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kKwo7fnUhDyvkP1dHaJqUQ.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk"><a class="ae kx" href="https://www.illumina.com/content/dam/illumina-marketing/documents/products/illumina_sequencing_introduction.pdf" rel="noopener ugc nofollow" target="_blank">Illustration by Illumina</a></figcaption></figure><h2 id="da6a" class="lo lp iq bd lq lr ls dn lt lu lv dp lw kj lx ly lz kn ma mb mc kr md me mf mg bi translated"><strong class="ak">使用 FastQC 进行质量评估</strong></h2><p id="df3d" class="pw-post-body-paragraph jy jz iq ka b kb mh kd ke kf mi kh ki kj mj kl km kn mk kp kq kr ml kt ku kv ij bi translated">更多质量控制！耶！请注意，我们仍然没有做任何事情来解释我们测序运行的生物学结果。</p><p id="5dc9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">FastQC 是一个很好的工具，可以让你先看看你的数据。它可以给你一个印象，如果你的数据中有某些偏差，或者如果你的文库准备或测序运行中出现了问题。这真的很容易运行，只需在命令行中键入以下内容(安装后):</p><pre class="mn mo mp mq gt my mz na nb aw nc bi"><span id="a275" class="lo lp iq mz b gy nd ne l nf ng">fastqc sample1.fastq.gz --outdir=/some/other/dir/</span></pre><p id="7290" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您将收到一个包含不同情节的. html。更多信息，一如既往，<a class="ae kx" href="https://www.bioinformatics.babraham.ac.uk/projects/fastqc/Help/3%20Analysis%20Modules/" rel="noopener ugc nofollow" target="_blank">在文档中。</a>不要依赖于 FastQC 上的通过/警告/失败，这真的取决于你的库准备。例如，在亚硫酸氢盐测序中，每个碱基序列中几乎没有胞嘧啶，但这是意料之中的(因为它们几乎都转化为胸腺嘧啶)。FastQC 将这些错误标记为“失败”。像 Basespace 一样，在解释 FastQC 图时，经验也很重要。如果你对某事感到困惑，问问同事。</p><p id="ac98" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">大多数情况下，您会分析多个样本，并且会生成相当多的日志文件。<a class="ae kx" href="http://multiqc.info/" rel="noopener ugc nofollow" target="_blank"> MultiQC </a>是一款非常棒的软件，只有一个命令:</p><pre class="mn mo mp mq gt my mz na nb aw nc bi"><span id="c742" class="lo lp iq mz b gy nd ne l nf ng">multiqc .</span></pre><p id="bdd7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">您可以将所有日志文件汇总到一个报告中。我一直在用，怎么推荐都不够。</p><p id="3126" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果您对编写处理 fastq 文件的最佳实践管道感兴趣，您可能会对<a class="ae kx" href="https://bcbio-nextgen.readthedocs.io/en/latest/index.html" rel="noopener ugc nofollow" target="_blank"> bcbio </a>感兴趣。但是你仍然需要知道在 bcbio 管道的引擎盖下发生了什么，或者你可能想要自己开发一个。</p><h1 id="1b0e" class="nh lp iq bd lq ni nj nk lt nl nm nn lw no np nq lz nr ns nt mc nu nv nw mf nx bi translated">绘图</h1><p id="ab63" class="pw-post-body-paragraph jy jz iq ka b kb mh kd ke kf mi kh ki kj mj kl km kn mk kp kq kr ml kt ku kv ij bi translated">将产生的读数与参考序列进行比对的过程被称为“作图”。组装就是在没有参考序列的情况下生成基因组。这种方法的优点是检测结构变异、复杂的重排和重复序列。然而，精确的<em class="kw">从头</em>组装需要相对长的读数，这在 Illumina 测序中是不可能的。但是更长的阅读测序技术(纳米孔和 PacBio)即将出现，所以我们可能很快就会看到一些变化。然而，在 RNA 测序中，转录组的<em class="kw">从头</em>组装已经被用于检测新的转录物。</p><p id="ce2e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于 DNA 图谱，最受欢迎的图谱绘制者是<a class="ae kx" href="http://bio-bwa.sourceforge.net/" rel="noopener ugc nofollow" target="_blank">BWA-记忆</a>和<a class="ae kx" href="http://bowtie-bio.sourceforge.net/bowtie2/index.shtml" rel="noopener ugc nofollow" target="_blank">鲍蒂 2 </a>。</p><p id="9755" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于 RNA 测序来说，最受欢迎的图谱绘制者是<a class="ae kx" href="https://github.com/alexdobin/STAR" rel="noopener ugc nofollow" target="_blank"> STAR </a>、<a class="ae kx" href="https://ccb.jhu.edu/software/hisat2/index.shtml" rel="noopener ugc nofollow" target="_blank"> HISAT2 </a>和 TopHat。只有在 STAR 遇到内存问题时才使用 TopHat。总的来说，对于 RNA 测序，我喜欢参考 Conesa 及其同事的<a class="ae kx" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4728800/" rel="noopener ugc nofollow" target="_blank">这篇论文</a>和 Sahraeian 及其同事的<a class="ae kx" href="https://www.nature.com/articles/s41467-017-00050-4" rel="noopener ugc nofollow" target="_blank">这篇论文</a>。</p><p id="962f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了绘制 DNA 甲基化图谱(亚硫酸氢盐转化的 DNA)，我使用<a class="ae kx" href="https://www.bioinformatics.babraham.ac.uk/projects/bismark/" rel="noopener ugc nofollow" target="_blank"> Bismark </a>。</p><p id="3a35" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">映射后，您的。fastq 通常被转换成. bam 文件。同样，查看日志文件。如果只有 35%的读数被唯一定位，那么你的文库准备、测序或数据分析可能出了问题。</p><h2 id="698f" class="lo lp iq bd lq lr ls dn lt lu lv dp lw kj lx ly lz kn ma mb mc kr md me mf mg bi translated">重复读取</h2><p id="b1d0" class="pw-post-body-paragraph jy jz iq ka b kb mh kd ke kf mi kh ki kj mj kl km kn mk kp kq kr ml kt ku kv ij bi translated">通常，您还会对样品中重复的数量感兴趣。如果&gt; 99.9%是重复的，你将只是在你的文库制备中看到一些独特的片段。除非你在处理扩增子测序，否则你不会想要这个。</p><p id="ea60" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">重复读取可能源于测序(见上文；流动细胞的类型)或从文库制备中的 PCR 获得。这些可以用<a class="ae kx" href="https://broadinstitute.github.io/picard/command-line-overview.html#MarkDuplicates" rel="noopener ugc nofollow" target="_blank">皮卡德</a>识别(用 MultiQC 可视化):</p><pre class="mn mo mp mq gt my mz na nb aw nc bi"><span id="4e4b" class="lo lp iq mz b gy nd ne l nf ng">java -jar picard.jar MarkDuplicates \<br/>      I=input.bam \<br/>      O=marked_duplicates.bam \<br/>      M=marked_dup_metrics.txt</span></pre><p id="4ce7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果一切看起来都很好，你可以继续进行下游分析，这取决于你的输入:DNA，RNA 或 DNA 甲基化。</p><h1 id="c766" class="nh lp iq bd lq ni nj nk lt nl nm nn lw no np nq lz nr ns nt mc nu nv nw mf nx bi translated">例子:DNA 测序</h1><h2 id="ca94" class="lo lp iq bd lq lr ls dn lt lu lv dp lw kj lx ly lz kn ma mb mc kr md me mf mg bi translated">变体调用</h2><p id="94f2" class="pw-post-body-paragraph jy jz iq ka b kb mh kd ke kf mi kh ki kj mj kl km kn mk kp kq kr ml kt ku kv ij bi translated">变异体调用是识别与参考序列(单核苷酸变异体、SNVs 和插入/缺失、indels)不同的核苷酸的过程，在这种情况下是您选择的参考基因组。根据你的输入材料，你可能对种系变异或体细胞变异感兴趣。</p><p id="677d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">变体调用很难。非常辛苦。对我们来说幸运的是，布罗德研究所开发了一个工具包，名为<a class="ae kx" href="https://software.broadinstitute.org/gatk/" rel="noopener ugc nofollow" target="_blank">基因组分析工具包(简称 GATK)</a>，它附带了<a class="ae kx" href="https://software.broadinstitute.org/gatk/best-practices/" rel="noopener ugc nofollow" target="_blank">【最佳实践】</a>关于如何从全基因组测序、外显子组测序和靶向测序中为种系和体细胞变异调用进行变异调用。</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ny"><img src="../Images/225b8225b89af6e5c753c7ca00b968bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*F5rvb02wy5Ig-txcVJTmHA.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk">GATK workflow for germline short variant discovery —June 2018</figcaption></figure><p id="2a49" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">GATK 附带了大量的文档和教程。如果你有问题，而且你是在非常罕见的情况下，你不能在文档或谷歌上找到它，<a class="ae kx" href="https://gatkforums.broadinstitute.org/gatk" rel="noopener ugc nofollow" target="_blank">开发者会非常迅速地在论坛</a>上回答问题。留意你附近的 GATK 工作室。我有幸参加了 2017 年在比利时鲁汶举行的一次研讨会，这是我参加过的最有用的研讨会之一。GATK 进化的速度也很惊人。去年，体细胞 CNV 呼叫(见下文)仍处于早期测试阶段，现在已经有了经过验证的最佳实践指南。</p><p id="9697" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">虽然 GATK 是一个很棒的软件，但它对你放进去的东西也很挑剔。如果你正在用 GATK 开发一个管道，不要偷工减料。如果你在想“哦，我不需要按坐标排序我的 bam 文件，它可能会运行”。</p><p id="bfcd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">剧透:不会的。</p><p id="9af8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">或者“我用的是 GRCh37，这个参考集在 hg19 中，这可能不成问题”。相信我，会的。我想我已经从 GATK 那里得到了所有存在的错误信息。但是过一会儿你就知道陷阱在哪里了。</p><p id="7ef6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">成功运行 GATK 后，您将拥有一个. vcf 文件。然而，这是一个很长的变体列表。你如何从生物学角度理解这一点？首先，您可以从注释. vcf 开始。</p><h2 id="85e2" class="lo lp iq bd lq lr ls dn lt lu lv dp lw kj lx ly lz kn ma mb mc kr md me mf mg bi translated">VCF 注释</h2><p id="2cb6" class="pw-post-body-paragraph jy jz iq ka b kb mh kd ke kf mi kh ki kj mj kl km kn mk kp kq kr ml kt ku kv ij bi translated">答。没有任何注释的 vcf 看起来有点像:</p><pre class="mn mo mp mq gt my mz na nb aw nc bi"><span id="a8e1" class="lo lp iq mz b gy nd ne l nf ng">[HEADER]<br/>#CHROM  POS     ID      REF    ALT      QUAL    FILTER  INFO                    <br/>1	889455	.	G	A	100.0	PASS	AF=0.0005<br/>1	897062	.	C	T	100.0	PASS	AF=0.0005</span></pre><p id="1228" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kx" href="http://snpeff.sourceforge.net/S" rel="noopener ugc nofollow" target="_blank"> SnpEff </a>就是一个注释这个的工具。带有功能信息的 vcf。它用基因名称、错义/无意义变体、编码或非编码等信息更新 INFO 字段，结果如下所示:</p><pre class="mn mo mp mq gt my mz na nb aw nc bi"><span id="de09" class="lo lp iq mz b gy nd ne l nf ng">#CHROM POS     ID        REF    ALT     QUAL FILTER INFO                    <br/>1	889455	.	G	A	100.0	PASS	AF=0.0005;EFF=STOP_GAINED(HIGH|NONSENSE|Cag/Tag|Q236*|749|NOC2L||CODING|NM_015658|)<br/>1	897062	.	C	T	100.0	PASS	AF=0.0005;EFF=STOP_GAINED(HIGH|NONSENSE|Cag/Tag|Q141*|642|KLHL17||CODING|NM_198317|</span></pre><p id="f6a2" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">接下来，SnpSift(不要与<a class="ae kx" href="http://sift.jcvi.org/" rel="noopener ugc nofollow" target="_blank"> SIFT </a>混淆)允许您基于您选择的参数过滤带注释的 VCF(例如，过滤掉质量分数低于 30 的变体):</p><pre class="mn mo mp mq gt my mz na nb aw nc bi"><span id="a801" class="lo lp iq mz b gy nd ne l nf ng">cat variants.vcf | java -jar SnpSift.jar filter " ( QUAL &gt;= 30 )" &gt; filtered.vcf</span></pre><p id="9535" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这是一个非常强大的工具，可以做更多的事情，一定要看看文档。</p><p id="2695" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><a class="ae kx" href="http://annovar.openbioinformatics.org/en/latest/user-guide/startup/" rel="noopener ugc nofollow" target="_blank"> ANNOVAR </a>是另一个为注释. vcf 而设计的工具，与 SnpSift 不同，ANNOVAR 的输出是. csv 或。tsv(逗号或制表符分隔的文件)。这些文件可以很容易地在 Excel 或其他电子表格程序中打开(只要确保基因名称没有被转换成日期，因为 Excel 是出了名的)。《T4》快速入门指南让你一切顺利。最后，你会得到这种格式，对于非生物信息学领域的人来说也很容易使用:</p><figure class="mn mo mp mq gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nz"><img src="../Images/b672afc72c66a534d984f10a2380aa05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O3Yjx4PT3jSGGYuBW06tSw.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk">Source: ANNOVAR quick start guide</figcaption></figure><p id="145a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">使用 Excel，您可以基于群体频率、内含子/外显子进一步筛选，以进一步探索数据。</p><h2 id="7f3e" class="lo lp iq bd lq lr ls dn lt lu lv dp lw kj lx ly lz kn ma mb mc kr md me mf mg bi translated">复制号码变体(CNV)呼叫</h2><p id="2128" class="pw-post-body-paragraph jy jz iq ka b kb mh kd ke kf mi kh ki kj mj kl km kn mk kp kq kr ml kt ku kv ij bi translated">拷贝数变异是大于 1000bp 的 DNA 片段的增加或减少。CNV 打电话也是辛苦的，这体现在<a class="ae kx" href="https://academic.oup.com/bib/article/17/2/185/1744035" rel="noopener ugc nofollow" target="_blank">许多刊物</a>上 CNV 打电话。</p><blockquote class="oa ob oc"><p id="b906" class="jy jz kw ka b kb kc kd ke kf kg kh ki od kk kl km oe ko kp kq of ks kt ku kv ij bi translated">没有黄金标准，不同的工具针对非常不同的场景进行了优化。一些工具需要匹配的法线。一些使用法线池来更好的覆盖归一化。有些支持不使用平铺探针的检测的脱靶读数。有些是肿瘤纯度和倍性意识，并提供整数拷贝数。有些工具在高吞吐量环境中比其他工具工作得更好。有些在临床样品(例如低纯度 FFPE 样品)中比其他样品效果更好。— <a class="ae kx" href="https://www.biostars.org/p/242992/" rel="noopener ugc nofollow" target="_blank">马库斯·里斯特</a></p></blockquote><p id="7124" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">本质上看你想做什么。如果你想看看种系 CNVs，那就看看<a class="ae kx" href="https://cnvkit.readthedocs.io/en/stable/" rel="noopener ugc nofollow" target="_blank"> CNVkit </a>。CNVKit 可以处理靶向测序、外显子组测序和全基因组测序数据，是 bcbio 推荐的。也很好用。Illumina 还有一个工具，<a class="ae kx" href="https://support.illumina.com/help/BaseSpace_App_SmallPedigree_v1_OLH_1000000042562/Content/Source/Informatics/Canvas_Intro_swBS.htm" rel="noopener ugc nofollow" target="_blank"> Canvas </a>，可以处理 WGS 数据。另一方面，如果你对体细胞 CNVs 感兴趣，今天是你的幸运日:GATK4 <a class="ae kx" href="https://software.broadinstitute.org/gatk/best-practices/workflow?id=11147" rel="noopener ugc nofollow" target="_blank">有最佳实践</a>。如果你想看看等离子体中的 CNVs，看看<a class="ae kx" href="https://github.com/VUmcCGP/wisecondor" rel="noopener ugc nofollow" target="_blank"> WISECONDOR。</a></p><h1 id="82df" class="nh lp iq bd lq ni nj nk lt nl nm nn lw no np nq lz nr ns nt mc nu nv nw mf nx bi translated">现在去哪里？</h1><p id="d6c4" class="pw-post-body-paragraph jy jz iq ka b kb mh kd ke kf mi kh ki kj mj kl km kn mk kp kq kr ml kt ku kv ij bi translated">最后，基于最初的临床问题或假设，你会想要做一些生物学上的解释。你可能会对家庭成员之间共享的变体感兴趣(或缺乏变体，从头开始<em class="kw">变体)。还有一个工具<a class="ae kx" href="https://gemini.readthedocs.io/en/latest/index.html" rel="noopener ugc nofollow" target="_blank">可以完成这个任务。或者，你可能对癌症中的体细胞热点突变感兴趣。或者是易患癌症的种系突变。或者完全不同的东西(那样的话，谷歌就是你的朋友。在写你自己的脚本之前，记住<em class="kw">某人</em>在某个时候也可能想做同样的事情。</a></em></p><p id="c2a1" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在从原始读取到变量调用的每一步过程中，保持你最初的假设是头脑。当与最初的问题(一个极端的例子:进行拷贝数变异呼叫以发现肺癌中的 EGFR T790M 突变)结合时，您的工作流程有意义吗？如果答案是“我不知道”或“可能”，你应该再次咨询做文库准备的湿实验室科学家和/或启动测序运行或项目的临床医生或研究人员。</p><p id="0571" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了简洁起见，我在这里只关注 DNA。我可以继续下去，用 RNA 和甲基化测序的类似资源填充另外 4 个段落。但是一旦你对以上有了一些经验，你就能自己找到你需要的。然而，如果你对一个关于 RNA 或甲基化的帖子感兴趣，请给我留言！</p></div><div class="ab cl ky kz hu la" role="separator"><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld le"/><span class="lb bw bk lc ld"/></div><div class="ij ik il im in"><p id="4bf7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kw">我想感谢我在这篇博文中提到的每一个人，以及导师、朋友、同事和其他以各种方式帮助我的人。我与我提到的任何公司都没有任何关系。</em></p><p id="a8e0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你喜欢读这本书，如果你把它推荐给你的朋友和同事，或者在推特或脸书上分享，那会很有帮助。</p><p id="9d45" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kw">关于作者:</em></p><p id="6ffe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kw">我是 Ruben Van Paemel 博士，2017 年从医学院毕业后，我开始在根特大学(医学遗传学中心)担任博士研究员，由研究基金会 Flanders 资助。我也是根特大学医院的儿科住院医师。可以在 Twitter 关注我:</em><a class="ae kx" href="http://www.twitter.com/RubenVanPaemel" rel="noopener ugc nofollow" target="_blank"><em class="kw">@ RubenVanPaemel</em></a></p><p id="cd00" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kw">我从事神经母细胞瘤的研究，这是一种罕见但极具破坏性的肿瘤，最常见于非常年幼的儿童。我们的团队试图了解潜在的基因改变，以提高神经母细胞瘤儿童的诊断、治疗和最终存活率。大数据和现代测序技术让我对编程、生物信息学、统计学和人工智能产生了兴趣。</em></p></div></div>    
</body>
</html>