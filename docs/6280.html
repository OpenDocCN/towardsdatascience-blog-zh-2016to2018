<html>
<head>
<title>How to Build a Market Simulator Using Markov Chains and Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用马尔可夫链和 Python 构建市场模拟器</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-build-a-market-simulator-using-markov-chains-and-python-7923256f8d29?source=collection_archive---------4-----------------------#2018-12-05">https://towardsdatascience.com/how-to-build-a-market-simulator-using-markov-chains-and-python-7923256f8d29?source=collection_archive---------4-----------------------#2018-12-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="1e41" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">建模客户行为，可视化 A/B 测试结果，预测用户指标…所有这些都使用一个简单的马尔可夫框架！</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/5040d0e6e30135103549eb2895a4f188.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mC63NKUzUwxipVfDMG-Jow.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">final product</figcaption></figure><p id="2910" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在本文中，我的目标是向您介绍(不考虑您的技术能力)马尔可夫链，并使用它来模拟客户行为。</p><p id="026d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">这不会是一个传统的每两行代码片段的“如何做”教程。我写这篇文章的主要目的是为您提供一个可以灵活使用的概念框架，这样您就不必为了学习新东西而编码了。技术细节会不时出现，但我会尽可能地为他们提供直觉。</p><h1 id="82d3" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">数据处理</h1><p id="1679" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">在这次分析中，我将使用我在一次数据马拉松中获得的 Credit Sesame 的分析数据。你可以使用任何你感兴趣的时间范围内的用户数据(例如一周/月/年的数据)。它应该遵循类似于下面的结构。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mo"><img src="../Images/528322e378f8f6fb4b3fdfe07fbf57e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Rel153l3rtVlwaqhcl8dXg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">example data</figcaption></figure><p id="3072" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">动作的例子可以是“点击报价/广告”、“点击订阅”等。列也可以是其他指标，如页面浏览量或收入。包括任何你认为对你的建模计划有用的专栏——在我的例子中，就是用户参与。</p><h1 id="4b23" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">客户细分</h1><p id="106e" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">在您的数据集中选择一个特定的日期，并获取该特定日期的<strong class="kx ir">的<strong class="kx ir">新用户</strong>数据。我正在模拟新用户在使用 Credit Sesame 网站 30 天内的行为。</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/fb45237e016f6968cda2a8799a9d047a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tVajLvErawR_9tovhlBcYw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">new user data on a particular day</figcaption></figure><p id="723b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">接下来，我们将客户分为不同的类别或状态。有许多方法可以做到这一点。</p><ol class=""><li id="71e6" class="mq mr iq kx b ky kz lb lc le ms li mt lm mu lq mv mw mx my bi translated">您可以应用一个<strong class="kx ir">评分函数</strong>:给每个用户一个分数，表示他们的整体参与度。您可以为您认为影响更高用户参与度的操作(如“会话长度”)赋予更高的权重。<br/>然后，您可以根据自己的经验将分布划分为 3 个部分(不活跃、活跃和非常活跃)。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/8456cd005b710492f7ac130f7273efc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/1*Lj2VtfXVVPbIs21m-gXm2Q.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Distribution of applied score function</figcaption></figure><p id="c422" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">2.应用无监督的算法，比如 k-means:你可以使用聚类算法，比如 k-means，来对参与度相似的客户进行聚类。每个集群都有自己独特的属性，希望这些属性就是您想要建模的属性。您甚至可以将该算法应用于您之前计算的得分函数(单变量数据),使其更加简单。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi na"><img src="../Images/2363c47eb9cd7101b8948c5512839238.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*FHVSNBqBal14VtqGUHyUjw.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">K-means segments visualized on the score function</figcaption></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nb"><img src="../Images/f94d0cbd4d932de89a458f7b9b2437a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZEJtY89x4KZFZs5T9BqCrg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">after segmentation on first-day data. 1 = inactive user, 2 = active user, 3 = very active user.</figcaption></figure><p id="fe32" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">分割第一天的数据后，你选择一个时间框架。我选择了一个月，因为我相信 Credit Sesame 有很多回头客，一个月的数据可以捕捉到他们的数量。30 天后，用户将有机会在各个细分市场之间转换:非常活跃的用户可能会变得不活跃，中度活跃的用户可能会变得非常活跃，等等。</p><p id="4931" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对此 30 天后的数据进行分段。确保您考虑了时间框架(例如，平均 30 天的参与度分数)。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/5cb35e65c909ddf9ce3143a5a39263e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sHNQTdxQZLhzE9aCDitxKQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">segmentation applied to 30-day data</figcaption></figure><p id="01b2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">让我们来看看结果:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/eea52ce27569576533a985cc7e527242.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h8Vgonx1Qi0K0YnbLlyirQ.png"/></div></div></figure><p id="1b8c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">正如预期的那样，在 30 天内变得不活跃的用户数量上升，而保持活跃和非常活跃的用户数量下降。</p><p id="afe3" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">应用马尔可夫框架</p><h1 id="1c7e" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">马尔可夫链基础</h1><p id="6ea1" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">马尔可夫链是简单的数学系统，它使用一定的概率规则和固定的假设来模拟状态到状态的运动。</p><p id="4da1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">更简单地说，当您有一个具有固定状态(或段)的系统，并且代理/用户可以以一定的固定概率在这些状态之间移动时，您可以使用马尔可夫链对其进行建模。</p><p id="ecf2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">但是让我们首先看看我们的系统是否满足马尔可夫模型的假设:</p><ul class=""><li id="a9bb" class="mq mr iq kx b ky kz lb lc le ms li mt lm mu lq ne mw mx my bi translated"><strong class="kx ir">假设 1: </strong>有一组有限的状态。在我们的系统中，只有 3 类客户可以进出。</li><li id="eb43" class="mq mr iq kx b ky nf lb ng le nh li ni lm nj lq ne mw mx my bi translated"><strong class="kx ir">假设 2: </strong>状态间移动的概率是固定的。我承认，这是一个很强的假设。虽然我的系统确实考虑了成千上万的用户数据点，但很容易相信不同的 30 天时间框架的概率方差不应太大。但是，即使有大量的数据，正如我们将在本文后面看到的，我们也必须谨慎。</li><li id="9bda" class="mq mr iq kx b ky nf lb ng le nh li ni lm nj lq ne mw mx my bi translated"><strong class="kx ir">假设三:</strong>状态可达性。任何细分市场中的用户都可以移动到不同的细分市场，而不受任何外部限制。</li><li id="e116" class="mq mr iq kx b ky nf lb ng le nh li ni lm nj lq ne mw mx my bi translated"><strong class="kx ir">假设 4: </strong>非循环。在我们的系统中，片段到片段的移动决不是“自动的”,所以这个假设是成立的。</li></ul><p id="579e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们的系统对马尔可夫链的大多数假设表现良好。这给了我们对模型估计的一些信心，一旦我们建立了模型，我们就会得到这些。</p><h1 id="a8e1" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">构建马尔可夫链</h1><p id="d1ff" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">马尔可夫链有三个部分，最好用矩阵向量乘法来表示。如果你对线性代数完全陌生，我建议你在阅读本文之前浏览一下这个<a class="ae nk" href="https://mathinsight.org/matrix_vector_multiplication" rel="noopener ugc nofollow" target="_blank">链接</a>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/dabf80bcc8cf63837c116446e0337544.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vESU5MQQb5HhgYCc7V_VVQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">N represents the number of segments</figcaption></figure><p id="e746" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们系统中的初始状态是一个 3×1 向量，表示每个分段中的用户数量。结束状态也是一个 3x1 向量，显示第一个月之后每个细分市场中的用户数量(在我们将初始状态向量乘以概率矩阵之后)。转移概率矩阵是一个 3×3 的矩阵，代表了不同客户群之间的固定转移概率。</p><p id="44dc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">那么我们如何计算这些固定概率呢？</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/1943b2894e9d0d84035a88dedf13644b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/format:webp/1*PXZBg9KAbMB35Icoz-A67w.png"/></div></figure><p id="b043" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">从我们记录的片段移动来看。我们观察第一天每个细分市场的用户在 30 天后如何移动到不同的细分市场，并相应地计算概率(相当于比例)。</p><p id="e292" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">0.89(图中)指的是第一天第一个细分市场中的某个人在 30 天后仍在同一细分市场中的概率，即不活跃用户在 30 天后仍不活跃的概率。请注意，每列中的概率总和必须为 1。我们对所有细分市场重复这一过程，并构建最终转换矩阵:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/1b1eab0585700b0f9a577c7b986dba06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1138/format:webp/1*LFraJizE-fVoD99_g98VDw.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Deconstructing the transition matrix for a clearer understanding</figcaption></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi no"><img src="../Images/d436c499a29c48417c44f3791df50740.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Kuz8-e-PXYRfW4LoTFmo4g.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">different way to visualize the transition matrix</figcaption></figure><p id="b9cd" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最后，我们把它们组合成这个漂亮的形式:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/2f5c7af24e469aef5f74256a9862ed78.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uyMyT2mEpwatV0DhxDk0pw.png"/></div></div></figure><p id="85a1" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在我们已经建模了，我们可以开始有趣的事情了。</p><h1 id="8032" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">绘图结果</h1><p id="8035" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">给定马尔可夫链，让我们从绘制客户流动趋势开始。</p><pre class="kg kh ki kj gt nq nr ns nt aw nu bi"><span id="2139" class="nv ls iq nr b gy nw nx l ny nz">a_val,b_val,c_val = [],[],[]</span><span id="867e" class="nv ls iq nr b gy oa nx l ny nz"># initial state<br/>init_state = np.array([188969, 81356, 14210])</span><span id="b534" class="nv ls iq nr b gy oa nx l ny nz"># transition matrix<br/>a = np.array([[ 0.89, 0.75 ,0.49], [ 0.10, 0.22 ,0.44], [ 0.01, 0.03 ,0.07]])</span><span id="705d" class="nv ls iq nr b gy oa nx l ny nz">for x in range(10):<br/>    a_val.append(init_state[0])<br/>    b_val.append(init_state[1])<br/>    c_val.append(init_state[2])<br/>    b = init_state<br/>    init_state = a.dot(b)</span><span id="41f2" class="nv ls iq nr b gy oa nx l ny nz"># plotting<br/>plt.figure(figsize=(11,8))<br/>plt.plot( [x for x in range(10)], a_val, marker='o', markerfacecolor='blue', markersize=12, color='skyblue', linewidth=4,label='Inactive users')<br/>plt.plot( [x for x in range(10)], b_val, marker='o', markerfacecolor='red', markersize=12, color='pink', linewidth=4,label='Active users')<br/>plt.plot( [x for x in range(10)], c_val, marker='o', markerfacecolor='orange', markersize=12, color='yellow', linewidth=4,label='Very active users')<br/>plt.legend(loc='best')<br/>plt.xlabel('Months')<br/>plt.ylabel('Number of customers')</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/0349f952e452b946a11887f27f08446f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d1jj1u6Sc810c-Agd9NQ5A.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">output</figcaption></figure><p id="4048" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">从中我们可以推断出什么？</p><p id="b5bf" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们看到，大约 2 个月后，所有三个细分市场都达到了平衡，也就是说，虽然有用户从一个细分市场转移到另一个细分市场，但每个细分市场的客户总数保持不变。</p><p id="f657" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">但是有一个条件。我们在这里做了一个非常强有力的假设——我们相信，无论我们预测用户行为的未来有多远，概率都将是固定的。这是非常不可信的。我举个例子:假设你拥有一个销售冬装的网站。在 12 月份购买了几件外套的活跃用户不太可能在 7 月份遵循同样的购物模式。模式可能是季节性的，而我们的马尔可夫模型没有捕捉到这一点！</p><p id="2add" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">那我们该怎么办？</p><p id="dd39" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们可以为每个月计算不同的转换矩阵来捕捉这些趋势，也可以将我们的分析范围限制在一个月。由于我只有一个月的数据，我选择后者。如果您确实有更长时间的数据，我会鼓励您将真实数据结果与马尔可夫模型输出进行比较，看看转移概率是否在几个月内保持不变，并相应地进行调整。</p><p id="ae00" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我得到的结果如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oc"><img src="../Images/4e564737c7455b465235147b47b5628d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xzStcXJeM0TfEwuToiOqYA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Single month analysis of customer flow</figcaption></figure><h1 id="8d51" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">应用:</h1><h2 id="f759" class="nv ls iq bd lt od oe dn lx of og dp mb le oh oi md li oj ok mf lm ol om mh on bi translated">A/B 测试</h2><p id="8df1" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">既然您已经有了一个描述客户行为的模型，我们如何引入“变化”或“干预”，并对它们的影响建模呢？我们的马尔可夫模型识别了两种类型的变化:</p><h2 id="7c16" class="nv ls iq bd lt od oe dn lx of og dp mb le oh oi md li oj ok mf lm ol om mh on bi translated"><strong class="ak"> 1。初始状态的改变</strong>:</h2><p id="9c5b" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">假设你拥有一家披萨店，你的网站在 12 月 1 日提供买二送一的优惠。你怀疑这种变化会带来更多的活跃用户访问你的网站。当你有 1000 个不同的新访客时，你的假设被证实了，其中有 300 人在同一天真的买了披萨(非常活跃的用户)。你又惊又喜，心想“嗯，我习惯了一天接到 100 个订单:一个月后会怎么样呢？”你只需要调整马尔可夫链的初始状态来解释这种变化。</p><pre class="kg kh ki kj gt nq nr ns nt aw nu bi"><span id="ecae" class="nv ls iq nr b gy nw nx l ny nz"># CHANGES TO INITIAL STATE - NUMBERS RECEIVED FROM MATRIX VECTOR PRODUCT</span><span id="8a7e" class="nv ls iq nr b gy oa nx l ny nz">before = (855,130,15) # Without any change<br/>after = (509,389,102) # After placing deal</span><span id="5418" class="nv ls iq nr b gy oa nx l ny nz"># create plot<br/>plt.figure(figsize=(11,8))<br/>index = np.arange(3)<br/>bar_width = 0.35<br/>opacity = 0.8<br/> <br/>rects1 = plt.bar(index, before, bar_width,<br/>                 alpha=opacity,<br/>                 color='b',<br/>                 label='Without deal')<br/> <br/>rects2 = plt.bar(index + bar_width, after, bar_width,<br/>                 alpha=opacity,<br/>                 color='g',<br/>                 label='With deal')<br/> <br/>plt.xlabel('Segments')<br/>plt.ylabel('Number of Users')<br/>plt.title('Customer behavior after a month')<br/>plt.xticks(index + bar_width- 0.18, ('Inactive','Active','Very Active'))<br/>plt.legend()<br/> <br/>plt.tight_layout()<br/>plt.show()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/6fdcee4d66a3a6afa9f1e7f20c38ac4f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2oHMVdo9fVbYdvbHWkFOFg.png"/></div></div></figure><p id="cb0e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">从初始状态由(不活跃=500，活跃=400，非常活跃=100)变为(100，600，300)，我们得到上面的结果。在月初有更多活跃和非常活跃的用户，你就增加了在这个月中拥有更多回头客的机会。</p><h2 id="b890" class="nv ls iq bd lt od oe dn lx of og dp mb le oh oi md li oj ok mf lm ol om mh on bi translated">2.转移概率的变化:</h2><p id="5aaa" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">你意识到这些交易很好，但它们只影响初始状态，这些交易的好处不会持续几个月，即它们是扩大参与用户的短期解决方案。为了有更持久的变化，我们必须引入改变概率的行动。假设你完全重新设计了你的披萨外卖网站，使结账速度提高了 10 倍。这是一种会持续影响每个细分市场<strong class="kx ir">中用户数量的行动。</strong>为了说明这种类型的变化，我们改变了转移矩阵中的概率。<br/>你可以通过在用户子样本上对新网站进行 A/B 测试来计算改变的概率，或者，你可以使用你自己的试探法和假设来手动改变它们。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi op"><img src="../Images/bd8c9becb8da37fb3b281fa34e738efe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1350/format:webp/1*6wFKzxEAmxsPdXwSL-KdzQ.png"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oq"><img src="../Images/42bc0995584b70b4b94ee4b1a6a44082.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N1PeuslC_Ls2QPP8U8Q-WQ.png"/></div></div></figure><p id="46d4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">假设概率保持不变，我们可以看到客户流如何随着新的转移矩阵而变化。</p><h2 id="d04d" class="nv ls iq bd lt od oe dn lx of og dp mb le oh oi md li oj ok mf lm ol om mh on bi translated">预测其他指标</h2><p id="aa5c" class="pw-post-body-paragraph kv kw iq kx b ky mj jr la lb mk ju ld le ml lg lh li mm lk ll lm mn lo lp lq ij bi translated">您可以预测其他几个用户指标，如客户终身价值、每用户收入等。使用我们上面描述的技术。例如，预测收入变化，计算每个细分市场的平均收入，计算输出状态，并将收入乘以各自细分市场中的用户数。</p><h1 id="f69d" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">结论</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi or"><img src="../Images/9c76581502b158a8a93dc1fb9269b23d.png" data-original-src="https://miro.medium.com/v2/resize:fit:456/format:webp/1*9KOp9TqhOCPMiiGWfnobLQ.png"/></div></figure><p id="91d8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你已经走了这么远，我推荐你。至少，我希望我已经传达了马尔可夫链的美妙之处，以及尽管它们很简单却能提供关键见解的能力(假设关键假设得到满足)。我希望你找到自己的创造性的方法来应用这个模型！</p></div></div>    
</body>
</html>