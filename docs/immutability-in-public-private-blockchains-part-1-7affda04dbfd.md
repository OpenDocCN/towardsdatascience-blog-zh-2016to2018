# 公共/私人区块链中的不变性—第 1 部分

> 原文：<https://towardsdatascience.com/immutability-in-public-private-blockchains-part-1-7affda04dbfd?source=collection_archive---------8----------------------->

![](img/7b919cb819482427f5b9dbb59c550d05.png)

Photo by [Donnie Rosie](https://unsplash.com/photos/fD0pgJCvypk?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) on [Unsplash](https://unsplash.com/search/photos/stone?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)

不变性是区块链实现的核心价值。在公开和私下的区块链谈论这个问题的技术细节之前，退一步想想它意味着什么以及它为什么重要可能是有益的。

# 不变性是什么意思？

尽可能字面上的不变性是指某件事不能改变。好吧，这很简单，对吧？。有点…我们首先需要定义什么是真正的改变。

想象一下，现在你有一辆白色的汽车。现在你决定你想要一个红色的。你至少有两个选择:

1.  把你现在的车涂成红色。
2.  卖掉你现在的车，买一辆红色的。

前者，你可以说你的车变了，因为颜色是你车的一个属性。因为这个属性已经改变了，所以你可以放心地说你的车已经改变了。后者，你不能真的说你的车自从你买了另一辆车后就变了。

那么这有什么意义呢？。首先，在分析对象的可变性之前，我们必须弄清楚是什么定义了对象的身份。将这个想法发挥到极致，如果一个对象的身份被定义为它的所有属性，那么改变其中任何一个属性都意味着我们有了另一个对象，因此原始对象没有改变。

还有一个关于如何定义身份的哲学讨论。当然，这不是这篇文章的目的，但是如果你感兴趣的话，你可以看看太阳的[船。](https://en.wikipedia.org/wiki/Ship_of_Theseus)

TL；DR:在考虑一个对象是否已经改变之前，我们应该首先对它的身份有一个清晰的定义。

# 为什么不变性很重要？

让我们考虑以下情况。你是一个房屋所有者，你居住的国家决定房屋所有权将由分类账中的记录来定义。

考虑以下索赔:

**我是房子的主人，所以账本里有记录支持这个事实。**

这种说法并不准确。以下说法是这个国家房屋所有权的正确表述:

**账本上有记录，所以我是房主。**

现在，这听起来很不一样。由于拥有自己的房子需要付出很多努力，你可能会开始考虑问以下问题:

*   如果账本被销毁了呢？
*   如果我房子的相关记录被删除了怎么办？
*   如果不知何故记录被更改，另一个人拥有我的房子怎么办？
*   账本查不到怎么办？

这些都是合理的问题，因为房子是非常高价值的资产。如果我们谈论的不是房子，而是糖果，你不介意在这些方面冒险。

前面的问题分析了分类账可能面临的不同风险，特别是，第二个问题听起来应该是不可改变的。第三个不是关于不变性，而是关于授权。

也许*不可变*这个词现在开始变得有意义了。但是，等等，房地产业务就是转让所有权，所以我们有突变。

**现实在变，但历史不会变。**

这才是重点。一个新的转让所有权的交易并不能改变一个事实，那就是在那之前的某个时候，我是那栋房子的主人。

如果我们使用分类账中的信息做出重要决策，我们希望这些信息是不可变的；我们需要建立因果关系，并保持它的永久性。更准确地说，把*时间*看作一个维度，考虑到时间是单行道，我们应该得出这样的结论:历史应该是不可改变的。

我们仍然没有讨论账本是否是数字的。它可以是基于纸张的分类账、关系数据库、区块链等；但是这是一个实现细节，无论如何都不会改变我们例子中不变性的重要性。不变性是一个设计决策。

# 在区块链的上下文中，不变性是什么意思？

作为复习，请记住以下几点:

*   区块链是分布式总账。
*   *分布式*部分指的是很多参与节点，特别是有一个账本的副本。
*   区块链共识算法负责所有节点最终汇聚到同一个账本。
*   区块链由有序的块组成，其中每个块包含前一个块的散列(这就是它被称为区块链的原因；块用散列来链接)。
*   区块链是只附加的数据结构。

区块链 as 分类帐实施用于对事务处理历史进行建模。一个交易*发生*如果是历史的一部分。正如我们前面提到的，历史是不变的，因此区块链也应该是不变的。

上面列表的最后一点提到区块链是只附加的数据结构；这是必不可少的，因为每个生成的块不能被改变以保持不变性。

如果我们有相同的事务有序历史记录，但在块中分组不同(例如，我们使用两倍大小的块)，会怎么样？我们可以问，对于同一段历史，我们是否有多个区块链。这是一个更微妙的讨论，因为我们有两个相同历史的表述。在比特币的情况下，当生成一个块时，*生成交易*由*矿工*包含，其中包含奖励，如果相同的有序交易被不同地分组在块中，则历史会不同。

在区块链，打破不变性指的是说服大多数节点改变现有块的难度。如果这是可能的，我们将*改变历史*导致可能无法接受的后果。

在第 2 部分中，我将比较两种解决方案中这一设计目标的实现差异:

*   使用工作证明(PoW)共识机制的公共区块链，例如比特币。
*   一个私人的区块链，特别是 Hyperledger 面料。

我认为两者之间的对比非常有趣，因为链接块的核心思想在不变性中有非常不同的重要性。