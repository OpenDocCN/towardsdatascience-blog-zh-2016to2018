<html>
<head>
<title>End-to-End Data Science Example: Predicting Diabetes with Logistic Regression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">端到端数据科学示例:用逻辑回归预测糖尿病</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/end-to-end-data-science-example-predicting-diabetes-with-logistic-regression-db9bc88b4d16?source=collection_archive---------0-----------------------#2018-05-24">https://towardsdatascience.com/end-to-end-data-science-example-predicting-diabetes-with-logistic-regression-db9bc88b4d16?source=collection_archive---------0-----------------------#2018-05-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="9e34" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">顾名思义，本教程是使用数据科学解决现实世界问题的端到端示例。我们将使用机器学习来预测一个人是否患有糖尿病，基于患者的信息，如血压、身体质量指数(身体质量指数)、年龄等。本教程介绍了数据科学工作流程的各个阶段。具体来说，本教程包含以下几个部分</p><ul class=""><li id="7eeb" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated">概观</li><li id="b138" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">数据描述</li><li id="592e" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">数据探索</li><li id="6e7f" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">数据准备</li><li id="adb5" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">训练和评估机器学习模型</li><li id="f9f7" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">解读 ML 模型</li><li id="0d8e" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">保存模型</li><li id="eaee" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">用模型做预测</li><li id="9e7c" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated">后续步骤</li></ul><figure class="la lb lc ld gt le gh gi paragraph-image"><div class="gh gi kz"><img src="../Images/fcb047bb412e9b564953b78c45fcfaff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/0*IunJJNPI_F6U8ii9."/></div></figure><h1 id="6fc4" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">概观</h1><p id="d083" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">数据由“国家糖尿病、消化和肾脏疾病研究所”收集并提供，作为皮马印第安人糖尿病数据库的一部分。从一个较大的数据库中选择这些实例有几个限制。特别是，这里的所有患者都属于皮马印第安人(美洲土著人的一个亚群)，并且都是 21 岁以上的女性。</p><p id="7921" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将使用 Python 和一些流行的数据科学相关包。首先，我们将导入<code class="fe ml mm mn mo b">pandas</code>从一个 CSV 文件中读取我们的数据，并操纵它以供进一步使用。我们还将使用<code class="fe ml mm mn mo b">numpy</code>将数据转换成适合我们的分类模型的格式。我们将使用<code class="fe ml mm mn mo b">seaborn</code>和<code class="fe ml mm mn mo b">matplotlib</code>进行可视化。然后我们将从<code class="fe ml mm mn mo b">sklearn</code>引入逻辑回归算法。这个算法将帮助我们建立分类模型。最后，我们将使用<code class="fe ml mm mn mo b">sklearn</code>中可用的<code class="fe ml mm mn mo b">joblib</code>来保存我们的模型以备将来使用。</p><pre class="la lb lc ld gt mp mo mq mr aw ms bi"><span id="1a91" class="mt li iq mo b gy mu mv l mw mx">import pandas as pd<br/>import numpy as np<br/>import seaborn as sns<br/>import matplotlib.pyplot as plt<br/>% matplotlib inline</span><span id="0ba7" class="mt li iq mo b gy my mv l mw mx">from sklearn.linear_model import LogisticRegression<br/>from sklearn.externals import joblib</span></pre><h1 id="7c6d" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">数据描述</h1><p id="9788" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">我们将数据保存在名为<code class="fe ml mm mn mo b">diabetes.csv</code>的 CSV 文件中。我们首先将数据集读入名为<code class="fe ml mm mn mo b">diabetesDF</code>的 pandas 数据帧，然后使用<code class="fe ml mm mn mo b">head()</code>函数显示数据集中的前五条记录。</p><pre class="la lb lc ld gt mp mo mq mr aw ms bi"><span id="9d25" class="mt li iq mo b gy mu mv l mw mx">diabetesDF = pd.read_csv('diabetes.csv')<br/>print(diabetesDF.head())</span></pre><figure class="la lb lc ld gt le gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/7962515ac28d797f7128a78424228df1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*g73aFNXrQNhOsIwG."/></div><figcaption class="na nb gj gh gi nc nd bd b be z dk">First 5 records in the Pima Indians Diabetes Database</figcaption></figure><p id="8171" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">以下特征有助于我们预测一个人是否患有糖尿病:</p><ul class=""><li id="1f81" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk kq kr ks kt bi translated"><strong class="jp ir">怀孕次数:</strong>怀孕次数</li><li id="3afc" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated"><strong class="jp ir">葡萄糖:</strong>口服葡萄糖耐量试验中超过 2 小时的血浆葡萄糖浓度</li><li id="d0b4" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated"><strong class="jp ir">血压:</strong>舒张压(毫米汞柱)</li><li id="eed5" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated"><strong class="jp ir">皮厚:</strong>三头肌皮褶厚度(mm)</li><li id="f8d5" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated"><strong class="jp ir">胰岛素:</strong> 2 小时血清胰岛素(μU/ml)</li><li id="7c77" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated"><strong class="jp ir">身体质量指数:</strong>身体质量指数(体重公斤/(身高米)2)</li><li id="db10" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated"><strong class="jp ir">糖尿病谱系功能:</strong>糖尿病谱系功能(根据家族史对糖尿病可能性评分的功能)</li><li id="b58b" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated"><strong class="jp ir">年龄:</strong>年龄(岁)</li><li id="dd6f" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk kq kr ks kt bi translated"><strong class="jp ir">结果:</strong>类别变量(0 表示非糖尿病，1 表示糖尿病)</li></ul><p id="32d8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们也确保我们的数据是干净的(没有空值，等等)。</p><pre class="la lb lc ld gt mp mo mq mr aw ms bi"><span id="aff5" class="mt li iq mo b gy mu mv l mw mx">diabetesDF.info() # output shown below</span><span id="16c6" class="mt li iq mo b gy my mv l mw mx">&lt;class 'pandas.core.frame.DataFrame'&gt;<br/>RangeIndex: 768 entries, 0 to 767<br/>Data columns (total 9 columns):<br/>Pregnancies                 768 non-null int64<br/>Glucose                     768 non-null int64<br/>BloodPressure               768 non-null int64<br/>SkinThickness               768 non-null int64<br/>Insulin                     768 non-null int64<br/>BMI                         768 non-null float64<br/>DiabetesPedigreeFunction    768 non-null float64<br/>Age                         768 non-null int64<br/>Outcome                     768 non-null int64<br/>dtypes: float64(2), int64(7)<br/>memory usage: 54.1 KB</span></pre><p id="892e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请注意，在上图的样本中，数据确实有一些缺失值(参见胰岛素= 0)。理想情况下，我们可以将这些 0 值替换为该特性的平均值，但现在我们将跳过这一步。</p><h1 id="b7bd" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">数据探索</h1><p id="48ce" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">现在让我们研究一下我们的数据集，感受一下它的样子，并获得一些关于它的见解。</p><p id="7805" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们从寻找每一对特征(和结果变量)的相关性开始，并使用热图可视化相关性。</p><pre class="la lb lc ld gt mp mo mq mr aw ms bi"><span id="28f7" class="mt li iq mo b gy mu mv l mw mx">corr = diabetesDF.corr()<br/>print(corr)<br/>sns.heatmap(corr, <br/>         xticklabels=corr.columns, <br/>         yticklabels=corr.columns)</span></pre><figure class="la lb lc ld gt le gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/c1991a413e635ba12297fc02803e5556.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*rqngyEW3Q_tuxuln."/></div><figcaption class="na nb gj gh gi nc nd bd b be z dk">Output of feature (and outcome) correlations</figcaption></figure><figure class="la lb lc ld gt le gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi mz"><img src="../Images/64122ed8551c8e8021cf080b87aacded.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*E3vgeIODUr2Yv_Qy."/></div></div><figcaption class="na nb gj gh gi nc nd bd b be z dk">Heatmap of feature (and outcome) correlations</figcaption></figure><p id="ee19" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在上面的热图中，颜色越亮表示相关性越强。从表格和热图中我们可以看出，血糖水平、年龄、身体质量指数和怀孕次数都与结果变量有显著相关性。还要注意特征对之间的相关性，比如年龄和怀孕，或者胰岛素和皮肤厚度。</p><p id="9b3c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们看看数据集中有多少人是糖尿病患者，有多少人不是。下面是相同的柱状图:</p><figure class="la lb lc ld gt le gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/95c0114dbce443ee24b8c49ddd172a69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*iLf5VElZ14aXJzGi."/></div><figcaption class="na nb gj gh gi nc nd bd b be z dk">Barplot visualization of number of non-diabetic (0) and diabetic (1) people in the dataset</figcaption></figure><p id="9b75" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">可视化单个变量和结果之间的关系也是有帮助的。下面，我们将看到年龄和结果之间的关系。您可以类似地可视化其他特征。该图是每个输出类的平均年龄图。我们可以看到，糖尿病患者的平均年龄更高。</p><figure class="la lb lc ld gt le gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/bfe386e361499edfbd35a6893a500933.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*WBWltN6DZcUiZMIy."/></div><figcaption class="na nb gj gh gi nc nd bd b be z dk">Average age of non-diabetic and diabetic people in the dataset</figcaption></figure></div><div class="ab cl ni nj hu nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ij ik il im in"><p id="91d3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">顺便提一句，这个教程摘自<a class="ae mk" href="https://www.commonlounge.com/" rel="noopener ugc nofollow" target="_blank"> Commonlounge </a>上的<a class="ae mk" href="https://www.commonlounge.com/discussion/367fb21455e04c7c896e9cac25b11b47" rel="noopener ugc nofollow" target="_blank">数据科学课程</a>。该课程包括许多实践作业和项目。另外，80%的课程内容都是免费的！如果你对学习数据科学感兴趣，绝对推荐去看看。</p><h1 id="c448" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">数据集准备(拆分和归一化)</h1><p id="1b05" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">当使用机器学习算法时，我们应该总是将数据分成训练集和测试集。(如果我们运行的实验数量很大，那么我们应该将数据分成 3 部分，即训练集、开发集和测试集)。在我们的例子中，我们还将分离出一些数据用于人工交叉检查。</p><p id="51c7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">数据集包括总共 767 名患者的记录。为了训练我们的模型，我们将使用 650 条记录。我们将使用 100 条记录进行测试，最后 17 条记录用于交叉检查我们的模型。</p><pre class="la lb lc ld gt mp mo mq mr aw ms bi"><span id="645c" class="mt li iq mo b gy mu mv l mw mx">dfTrain = diabetesDF[:650]<br/>dfTest = diabetesDF[650:750]<br/>dfCheck = diabetesDF[750:]</span></pre></div><div class="ab cl ni nj hu nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ij ik il im in"><p id="2e1d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们分离标签和特征(对于训练和测试数据集)。除此之外，我们还会将它们转换为 NumPy 数组，因为我们的机器学习算法处理 NumPy 数组格式的数据。</p><pre class="la lb lc ld gt mp mo mq mr aw ms bi"><span id="b215" class="mt li iq mo b gy mu mv l mw mx">trainLabel = np.asarray(dfTrain['Outcome'])<br/>trainData = np.asarray(dfTrain.drop('Outcome',1))<br/>testLabel = np.asarray(dfTest['Outcome'])<br/>testData = np.asarray(dfTest.drop('Outcome',1))</span></pre></div><div class="ab cl ni nj hu nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ij ik il im in"><p id="f637" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">作为使用机器学习之前的最后一步，我们将标准化我们的输入。机器学习模型通常从输入标准化中受益匪浅。这也使我们在以后查看模型权重时，更容易理解每个特性的重要性。我们将对数据进行标准化，使每个变量的平均值为 0，标准差为 1。</p><pre class="la lb lc ld gt mp mo mq mr aw ms bi"><span id="4181" class="mt li iq mo b gy mu mv l mw mx">means = np.mean(trainData, axis=0)<br/>stds = np.std(trainData, axis=0)</span><span id="88b0" class="mt li iq mo b gy my mv l mw mx">trainData = (trainData - means)/stds<br/>testData = (testData - means)/stds</span><span id="0bf3" class="mt li iq mo b gy my mv l mw mx"># np.mean(trainData, axis=0) =&gt; check that new means equal 0<br/># np.std(trainData, axis=0) =&gt; check that new stds equal 1</span></pre><h1 id="8f77" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">训练和评估机器学习模型</h1><p id="81f2" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">我们现在可以训练我们的分类模型。我们将使用一个叫做<em class="np">逻辑回归</em>的机器简单学习模型。因为模型在 sklearn 中很容易获得，所以训练过程非常容易，我们可以用几行代码就可以完成。首先，我们创建一个名为 diabetesCheck 的实例，然后使用 fit 函数来训练模型。</p><pre class="la lb lc ld gt mp mo mq mr aw ms bi"><span id="bf53" class="mt li iq mo b gy mu mv l mw mx">diabetesCheck = LogisticRegression()<br/>diabetesCheck.fit(trainData, trainLabel)</span></pre></div><div class="ab cl ni nj hu nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ij ik il im in"><p id="c57b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来，我们将使用我们的测试数据来找出模型的准确性。</p><pre class="la lb lc ld gt mp mo mq mr aw ms bi"><span id="4072" class="mt li iq mo b gy mu mv l mw mx">accuracy = diabetesCheck.score(testData, testLabel)<br/>print("accuracy = ", accuracy * 100, "%")</span></pre><p id="152a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">打印语句将打印<code class="fe ml mm mn mo b">accuracy = 78.0 %</code>。</p><h1 id="1771" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">解读 ML 模型</h1><p id="237b" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">为了更好地理解逻辑回归模型内部的情况，我们可以直观地看到我们的模型如何使用不同的特性，以及哪些特性具有更大的影响。</p><pre class="la lb lc ld gt mp mo mq mr aw ms bi"><span id="cc3f" class="mt li iq mo b gy mu mv l mw mx">coeff = list(diabetesCheck.coef_[0])<br/>labels = list(trainData.columns)<br/>features = pd.DataFrame()<br/>features['Features'] = labels<br/>features['importance'] = coeff<br/>features.sort_values(by=['importance'], ascending=True, inplace=True)<br/>features['positive'] = features['importance'] &gt; 0<br/>features.set_index('Features', inplace=True)<br/>features.importance.plot(kind='barh', figsize=(11, 6),color = features.positive.map({True: 'blue', False: 'red'}))<br/>plt.xlabel('Importance')</span></pre><figure class="la lb lc ld gt le gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/98fd83c039e14984c224fd591e366c42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*2v_WDoY_Fs16TmVT."/></div><figcaption class="na nb gj gh gi nc nd bd b be z dk">Visualization of the weights in the Logistic Regression model corresponding to each of the feature variables</figcaption></figure><p id="5e6a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从上图，我们可以得出以下结论。</p><ol class=""><li id="91a8" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk nq kr ks kt bi translated">血糖水平、身体质量指数、妊娠和糖尿病家系功能对模型有显著影响，尤其是血糖水平和身体质量指数。很高兴看到我们的机器学习模型与我们一生中从医生那里听到的相匹配！</li><li id="5480" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk nq kr ks kt bi translated">血压对预测有负面影响，即较高的血压与没有糖尿病的人相关。(另外，注意血压作为一个特征比年龄更重要，因为血压的<em class="np">值</em>更高)。</li><li id="1413" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk nq kr ks kt bi translated">虽然年龄比身体质量指数与产出变量更相关(正如我们在数据探索中看到的)，但该模型更依赖于身体质量指数。发生这种情况有几个原因，包括这样一个事实，即年龄捕捉到的相关性也被一些其他变量捕捉到，而身体质量指数捕捉到的信息没有被其他变量捕捉到。</li></ol><p id="0bca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意，上面的解释要求我们的输入数据是标准化的。没有这一点，我们就不能说<em class="np">的重要性</em>与<em class="np">的权重</em>成正比。</p><h1 id="a08d" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">保存模型</h1><p id="a97b" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">现在，我们将使用<code class="fe ml mm mn mo b">joblib</code>保存训练好的模型以备将来使用。</p><pre class="la lb lc ld gt mp mo mq mr aw ms bi"><span id="064d" class="mt li iq mo b gy mu mv l mw mx">joblib.dump([diabetesCheck, means, stds], 'diabeteseModel.pkl')</span></pre><p id="83e0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">为了检查我们是否正确地保存了模型，我们将使用我们的测试数据来检查我们保存的模型的准确性(如果我们正确地保存了它，我们应该观察不到准确性的变化)。</p><pre class="la lb lc ld gt mp mo mq mr aw ms bi"><span id="e5cf" class="mt li iq mo b gy mu mv l mw mx">diabetesLoadedModel, means, stds = joblib.load('diabeteseModel.pkl')<br/>accuracyModel = diabetesLoadedModel.score(testData, testLabel)<br/>print("accuracy = ",accuracyModel * 100,"%")</span></pre><h1 id="5911" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">用模型做预测</h1><p id="0e7e" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">我们现在将使用未使用的数据来看看如何进行预测。我们在 dfCheck 中有未使用的数据。</p><pre class="la lb lc ld gt mp mo mq mr aw ms bi"><span id="2e99" class="mt li iq mo b gy mu mv l mw mx">print(dfCheck.head())</span></pre><figure class="la lb lc ld gt le gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/588c2dd8501aa4f1ac7b19bf1b8f224f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*-SWG0nrLIjMCioRG."/></div></figure><p id="8e09" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们现在将使用第一个记录来进行预测。</p><pre class="la lb lc ld gt mp mo mq mr aw ms bi"><span id="c1e0" class="mt li iq mo b gy mu mv l mw mx">sampleData = dfCheck[:1]</span><span id="668f" class="mt li iq mo b gy my mv l mw mx"># prepare sample<br/>sampleDataFeatures = np.asarray(sampleData.drop('Outcome',1))<br/>sampleDataFeatures = (sampleDataFeatures - means)/stds</span><span id="ea35" class="mt li iq mo b gy my mv l mw mx"># predict<br/>predictionProbability = diabetesLoadedModel.predict_proba(sampleDataFeatures)<br/>prediction = diabetesLoadedModel.predict(sampleDataFeatures)<br/>print('Probability:', predictionProbability)<br/>print('prediction:', prediction)</span></pre><p id="d5db" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">从上面的代码我们得到:</p><pre class="la lb lc ld gt mp mo mq mr aw ms bi"><span id="344c" class="mt li iq mo b gy mu mv l mw mx">Probability: [[ 0.4385153,  0.5614847]]<br/>prediction: [1]</span></pre><p id="bcfb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">数组<strong class="jp ir">的第一个元素预测概率</strong> 0.438 是类为<strong class="jp ir"> 0 </strong>的概率，第二个元素 0.561 是类为<strong class="jp ir"> 1 </strong>的概率。概率总和为 1。正如我们可以看到的，<strong class="jp ir"> 1 </strong>是更可能的类别，我们得到<strong class="jp ir">【1】</strong>作为我们的预测，这意味着模型预测此人患有糖尿病。</p><h1 id="b909" class="lh li iq bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">后续步骤</h1><p id="7adc" class="pw-post-body-paragraph jn jo iq jp b jq mf js jt ju mg jw jx jy mh ka kb kc mi ke kf kg mj ki kj kk ij bi translated">有很多方法可以改进上述模型。这里有一些想法。</p><ol class=""><li id="ed2f" class="kl km iq jp b jq jr ju jv jy kn kc ko kg kp kk nq kr ks kt bi translated">输入特征分块应该有所帮助，即创建特定范围内的血压、特定范围内的葡萄糖水平等的新变量。</li><li id="b5bf" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk nq kr ks kt bi translated">您还可以通过用平均值替换 0 值来改进数据清理。</li><li id="60e8" class="kl km iq jp b jq ku ju kv jy kw kc kx kg ky kk nq kr ks kt bi translated">阅读一些关于医生诊断糖尿病患者最依赖的指标，并相应地创建新的功能。</li></ol><p id="4978" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">看看你能否达到 85-90%的准确率。本教程可以用 jupyter 笔记本入门:<a class="ae mk" href="https://www.dropbox.com/s/fk0rovvvy6tv7tr/DiabeteseModel.ipynb?dl=1" rel="noopener ugc nofollow" target="_blank"> pima_indians.ipynb </a>。</p></div><div class="ab cl ni nj hu nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ij ik il im in"><p id="6558" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="np">由 Keshav Dhandhania 和 Bishal Lakha 合著。</em></p><p id="f056" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="np">最初作为</em> <a class="ae mk" href="https://www.commonlounge.com/discussion/d6b0c91db14245b8998afd2a5c0f5b83" rel="noopener ugc nofollow" target="_blank"> <em class="np">的教程发表于 www.commonlounge.com</em></a><em class="np">作为</em> <a class="ae mk" href="https://www.commonlounge.com/discussion/367fb21455e04c7c896e9cac25b11b47" rel="noopener ugc nofollow" target="_blank"> <em class="np">数据科学课程</em> </a> <em class="np">的一部分。</em></p></div></div>    
</body>
</html>