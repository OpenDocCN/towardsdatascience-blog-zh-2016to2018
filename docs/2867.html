<html>
<head>
<title>Machine Learning Madness: Predicting Every NCAA Tournament Matchup</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">机器学习的疯狂:预测每一场NCAA锦标赛</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/machine-learning-madness-predicting-every-ncaa-tournament-matchup-7d9ce7d5fc6d?source=collection_archive---------8-----------------------#2018-03-15">https://towardsdatascience.com/machine-learning-madness-predicting-every-ncaa-tournament-matchup-7d9ce7d5fc6d?source=collection_archive---------8-----------------------#2018-03-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="cc47" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">大舞蹈的概率模型、可视化和结果</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/192e2c1ee52e8d97be4230c23a93cc20.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1dKSUMUiM1oc_vF58kjn_Q.png"/></div></div></figure><p id="61cd" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">又到了一年中的这个时候。三月疯狂来了，这意味着是时候填写你的括号了，当它不可避免地被你所有的朋友和家人看到时，你会很失望。</p><p id="a9c2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">不过，也不全是坏消息。NCAA级男子篮球锦标赛是本年度最激动人心的体育赛事之一，因为它伴随着冷门、灰姑娘和不可预测性。每年三月，数以百万计的篮球迷和非篮球迷都拿着他们的虚拟锐器参与这一现象，希望获得一个不可能的完美支架。有多不可能？鉴于你对篮球略知一二，教授们保守地认为你的胜算是1280亿分之一。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ln lo l"/></div></figure><h1 id="cf15" class="lp lq iq bd lr ls lt lu lv lw lx ly lz jw ma jx mb jz mc ka md kc me kd mf mg bi translated">动机</h1><p id="9d5a" class="pw-post-body-paragraph kr ks iq kt b ku mh jr kw kx mi ju kz la mj lc ld le mk lg lh li ml lk ll lm ij bi translated">感谢我的成长经历和在体育中心的成长经历，从我记事起，我就是一个狂热的大学篮球迷。每年我都期待着进行研究，有条不紊地填写一个括号。</p><p id="eb1d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然而，今年在收到一封关于即将到来的Kaggle比赛的电子邮件后，我决定第一次尝试模拟比赛，标题是:<a class="ae mm" href="https://www.kaggle.com/c/mens-machine-learning-competition-2018" rel="noopener ugc nofollow" target="_blank">谷歌云&amp; NCAA机器学习比赛</a>。如果你不熟悉Kaggle，它被称为“数据科学&amp;机器学习之家”。<a class="ae mm" href="https://www.kaggle.com" rel="noopener ugc nofollow" target="_blank"> Kaggle </a>举办机器学习比赛，收集有趣的数据集，并提供指南来帮助你成长为一名数据科学家。</p><h1 id="01fc" class="lp lq iq bd lr ls lt lu lv lw lx ly lz jw ma jx mb jz mc ka md kc me kd mf mg bi translated">竞争</h1><p id="17fc" class="pw-post-body-paragraph kr ks iq kt b ku mh jr kw kx mi ju kz la mj lc ld le mk lg lh li ml lk ll lm ij bi translated">比赛的目标是利用过去的锦标赛结果来建立和测试模型，以便预测2018年NCAA第一组男子篮球锦标赛中所有可能比赛的结果。这些结果是通过概率计算得出的，例如，A队有55%的机会击败b队。然后，我们会对每个最终提交的作品进行评估，并使用一种称为对数损失的指标在公共排行榜上进行排名。如果您不熟悉日志损失，只需知道越小越好。对数的使用为自信和错误提供了极端的惩罚，如下面的公式所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mn"><img src="../Images/d0d09c833bdc9e432510f19d6de4e0eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RQ896sPBSAgMqq3ya9V2CA.png"/></div></div></figure><h1 id="4380" class="lp lq iq bd lr ls lt lu lv lw lx ly lz jw ma jx mb jz mc ka md kc me kd mf mg bi translated">方法</h1><p id="997e" class="pw-post-body-paragraph kr ks iq kt b ku mh jr kw kx mi ju kz la mj lc ld le mk lg lh li ml lk ll lm ij bi translated">进入这个项目，我有一个大概的想法，我想用它做什么。话虽如此，我对前几年的类似项目做了一些研究，从中我发现了一些对我有用的见解。</p><p id="47b7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">首先，似乎很多模型都将逻辑回归作为它们的主要算法，这是因为它的概率性质和有效而简单的实现。第二，许多模型利用了其他广受好评的排名和评分系统，如肯·波默罗伊和T2的杰夫·萨格林。</p><p id="f6f5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">利用以前的领域知识，以及这些来自研究的见解，我决定对其他模型采取类似的方法，同时做一些有趣的改变。我的高级方法可以分为几个步骤:</p><ol class=""><li id="1468" class="mo mp iq kt b ku kv kx ky la mq le mr li ms lm mt mu mv mw bi translated">收集旨在衡量给定团队质量的高绩效排名、分数和评级</li><li id="65bb" class="mo mp iq kt b ku mx kx my la mz le na li nb lm mt mu mv mw bi translated">将这些指标汇编成一个综合得分，提供可靠的能力度量</li><li id="a3de" class="mo mp iq kt b ku mx kx my la mz le na li nb lm mt mu mv mw bi translated">计算每场比赛中各队综合得分的差异</li><li id="45c3" class="mo mp iq kt b ku mx kx my la mz le na li nb lm mt mu mv mw bi translated">对综合得分差异进行训练和测试逻辑回归，以预测未来的比赛</li></ol><h1 id="8ccc" class="lp lq iq bd lr ls lt lu lv lw lx ly lz jw ma jx mb jz mc ka md kc me kd mf mg bi translated">模型分解</h1><p id="b644" class="pw-post-body-paragraph kr ks iq kt b ku mh jr kw kx mi ju kz la mj lc ld le mk lg lh li ml lk ll lm ij bi translated">按照这种方法，我的模型由两个不同的部分组成。每个部分都有独特的权重，用于生成每个团队的综合得分。查看以下可视化内容，了解各种输入的概述:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nc"><img src="../Images/ea6a776d2b5f4ef4ec89df4edf154528.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*KVab5yTbm32oUhOtYWF48w.png"/></div></figure><p id="bb68" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这些重量是在相互测试了几个变量之后选择的。在本文的其余部分，在最终模拟今年的锦标赛结果之前，我将更详细地介绍模型的每个部分。</p><h1 id="e750" class="lp lq iq bd lr ls lt lu lv lw lx ly lz jw ma jx mb jz mc ka md kc me kd mf mg bi translated">平均选择排名分数</h1><p id="8aba" class="pw-post-body-paragraph kr ks iq kt b ku mh jr kw kx mi ju kz la mj lc ld le mk lg lh li ml lk ll lm ij bi translated">我发现最有用的资源之一是一个数据集，其中包含随着时间推移的<a class="ae mm" href="https://www.masseyratings.com/cb/compare.htm" rel="noopener ugc nofollow" target="_blank">梅西综合排名</a>。梅西排名是检查所有其他排名系统的目的地。我决定选择可用的最高性能系统，并平均计算分数。在为每个持续更新的系统拟合和测试单独的逻辑回归模型后，我发现表现最好的指标是<a class="ae mm" href="http://sagarin.com/sports/cbsend.htm" rel="noopener ugc nofollow" target="_blank">Sagarin</a>(SAG)<a class="ae mm" href="https://kenpom.com" rel="noopener ugc nofollow" target="_blank">Pomeroy</a>(POM)<a class="ae mm" href="http://sonnymoorepowerratings.com/m-basket.htm" rel="noopener ugc nofollow" target="_blank">Moore</a>(MOR)和<a class="ae mm" href="http://sawhitlock.home.mindspring.com" rel="noopener ugc nofollow" target="_blank"> Whitlock </a> (WLK)。</p><p id="7f72" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在编辑了这些排名的平均分数后，我单独对这个特征进行了拟合和测试，得到了-0.543的对数损失，这比我的基线基于种子的模型和整体平均排名实现都有所改进。</p><h1 id="8dbf" class="lp lq iq bd lr ls lt lu lv lw lx ly lz jw ma jx mb jz mc ka md kc me kd mf mg bi translated">标准化Elo评级</h1><p id="6de2" class="pw-post-body-paragraph kr ks iq kt b ku mh jr kw kx mi ju kz la mj lc ld le mk lg lh li ml lk ll lm ij bi translated">如果你曾经研究过体育预测背后的方法论，你可能会遇到一两次Elo。Nate Silver和他的团队是Elo的大力支持者，所以当我在Kaggle上看到<a class="ae mm" href="https://www.kaggle.com/lpkirwin/fivethirtyeight-elo-ratings" rel="noopener ugc nofollow" target="_blank"> Liam Kirwin的实现</a>后，我不得不考虑以某种方式将它融入我的模型中。</p><p id="4eef" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果你不熟悉Elo评级系统，这是一种计算零和游戏中玩家相对技能水平的迭代方法。你可能听说过它被用于国际象棋或其他棋盘/视频游戏，但只知道应用程序是无止境的。Elo通常使用以下公式计算:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/574c003282dd603036ab084678359fcd.png" data-original-src="https://miro.medium.com/v2/resize:fit:820/format:webp/1*wd-YdFBqnNfFj-tD-Rk6Bg.png"/></div></figure><p id="b60a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">计算每支球队的Elo分数需要一些时间，因为该程序必须迭代每场比赛并调整相应球队的评级。一旦计算出来，基于Elo的逻辑回归模型也表现得相当好，其对数损失为-0.543，与选择排名模型的先前结果持平。</p><h1 id="50a3" class="lp lq iq bd lr ls lt lu lv lw lx ly lz jw ma jx mb jz mc ka md kc me kd mf mg bi translated">模型评估</h1><p id="2a05" class="pw-post-body-paragraph kr ks iq kt b ku mh jr kw kx mi ju kz la mj lc ld le mk lg lh li ml lk ll lm ij bi translated">一旦之前的两个分数都被收集，它们被重新调整到介于0和1之间。然后使用上述方法对他们进行加权，并随后汇编成每个团队的最终综合得分，最终用于我们的逻辑回归模型。使用交叉验证，该模型在训练数据上获得了-0.540的对数损失，这比其自身的任何一部分都略有改善！</p><p id="30bb" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了更好地了解综合得分，请根据以下指标查看今年锦标赛中排名前十的球队:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/cac6c1aaa383793c32ab9e325780e925.png" data-original-src="https://miro.medium.com/v2/resize:fit:580/format:webp/1*zvxQJUZHkSRqvJXRJ7lqyQ.png"/></div></figure><h1 id="a547" class="lp lq iq bd lr ls lt lu lv lw lx ly lz jw ma jx mb jz mc ka md kc me kd mf mg bi translated">锦标赛模拟</h1><p id="8adf" class="pw-post-body-paragraph kr ks iq kt b ku mh jr kw kx mi ju kz la mj lc ld le mk lg lh li ml lk ll lm ij bi translated">所有这些都是好东西，但我们真正想看到的是所有这些分数和概率如何应用于今年的数据！多亏了扎克·梅尔令人敬畏的名为<a class="ae mm" href="https://github.com/zachmayer/kaggleNCAA" rel="noopener ugc nofollow" target="_blank"> kaggleNCAA </a>的R包，这个任务相当容易完成。在用1000次模拟运行我的模型后，我得到了以下结果:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/b92ca7c3b68b46cbf43e447355807372.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LaoYvABakyh7i3oeHYzAnw.png"/></div></div></figure><p id="31c0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如你所见，从长远来看，我的模型预测最有可能的赢家是弗吉尼亚，有16%的机会。一些有趣的选择还包括杜克大学(2)和冈萨加大学(4)作为进入四强的热门，很可能第一轮就被佛罗里达大学(9)和洛约拉-芝加哥大学(11)击败。</p><h1 id="5ba4" class="lp lq iq bd lr ls lt lu lv lw lx ly lz jw ma jx mb jz mc ka md kc me kd mf mg bi translated">包扎</h1><p id="45c0" class="pw-post-body-paragraph kr ks iq kt b ku mh jr kw kx mi ju kz la mj lc ld le mk lg lh li ml lk ll lm ij bi translated">恭喜你能走到这一步！总的来说，我很高兴地说，承担这个项目使我成为一个更有能力的数据科学家。我也很兴奋能参加今年的比赛，最重要的是，我渴望为明年调整和改进我的模型！</p><p id="2a72" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">代码及完整Jupyter笔记本见我的</strong> <a class="ae mm" href="https://github.com/conordewey3/Kaggle-March-Madness-Machine-Learning-2018" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir"> Github </strong> </a> <strong class="kt ir">。</strong></p><h2 id="c376" class="ng lq iq bd lr nh ni dn lv nj nk dp lz la nl nm mb le nn no md li np nq mf nr bi translated">感谢阅读，并祝所有参加今年三月疯狂的有抱负的支架学家好运！</h2></div><div class="ab cl ns nt hu nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ij ik il im in"><p id="17c2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">感谢阅读！如果你喜欢这篇文章，请继续向鼓掌按钮展示你的爱。对更多的帖子感兴趣吗？请务必<a class="ae mm" href="https://twitter.com/cdeweyx" rel="noopener ugc nofollow" target="_blank">关注我</a>并订阅下面的<a class="ae mm" href="https://www.conordewey.com/" rel="noopener ugc nofollow" target="_blank">我的简讯</a>以接收任何新内容。想了解更多关于我和我在做什么，请查看我的网站。</p></div></div>    
</body>
</html>