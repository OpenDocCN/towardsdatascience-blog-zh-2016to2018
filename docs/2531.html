<html>
<head>
<title>Just another AI trying to predict the stock market: Part 1</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">只是另一个试图预测股市的人工智能:第 1 部分</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/just-another-ai-trying-to-predict-the-stock-market-part-1-d0663673a30e?source=collection_archive---------2-----------------------#2018-02-05">https://towardsdatascience.com/just-another-ai-trying-to-predict-the-stock-market-part-1-d0663673a30e?source=collection_archive---------2-----------------------#2018-02-05</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><figure class="ip iq gp gr ir is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi io"><img src="../Images/9276ed13ddfd3e6b33005de5877ea239.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oIaHz-b7xdHutGGgvK_aRw.png"/></div></div></figure><div class=""/><p id="6c17" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">学习如何建立机器学习模型既不是一件简单的事情，也不是一件容易的事情。我花了一个月左右的时间学习神经网络如何详细工作，以及是什么让某些模型比其他模型表现得更好。</p><p id="197e" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在我决定将我的知识付诸实践，实现一个相当简单的例子——使用 GRU 网络预测 S&amp;P500 指数的股票价格。</p><p id="1cdb" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka jc">你可以将这些系列作为你机器学习之旅的起点，所以不要犹豫，毫无准备地投入进去吧。</strong>如果有任何问题，请在评论区与我分享。</p><h2 id="6218" class="kx ky jb bd kz la lb dn lc ld le dp lf kj lg lh li kn lj lk ll kr lm ln lo lp bi translated">#1.准备数据</h2><p id="a8cf" class="pw-post-body-paragraph jy jz jb ka b kb lq kd ke kf lr kh ki kj ls kl km kn lt kp kq kr lu kt ku kv ij bi translated">我们应该做的第一件事就是获取数据来训练我们的模型。雅虎财经是一个寻找任何公司新数据的好地方。因此，我们将使用从 1950 年 1 月 1 日到今天这段时间的<a class="ae kw" href="https://finance.yahoo.com/quote/%5EGSPC/history?p=%5EGSPC" rel="noopener ugc nofollow" target="_blank"> S &amp; P500 数据集</a>。只需点击<em class="lv">下载数据</em>即可。</p><p id="a1a8" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">出于这个例子的目的，我们将只使用一个 python 文件，没有面向对象的模式或任何花哨的结构。让我们将文件命名为<em class="lv"> sp_rnn_prediction.py </em>并加载数据。</p><figure class="lw lx ly lz gt is"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="bc06" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">这些库的目的如下:</p><ul class=""><li id="9516" class="mc md jb ka b kb kc kf kg kj me kn mf kr mg kv mh mi mj mk bi translated"><a class="ae kw" href="http://www.numpy.org/" rel="noopener ugc nofollow" target="_blank"> numpy </a> —用于轻松进行矩阵计算和数学运算，这对于任何 ML 模型都是必不可少的</li><li id="cbee" class="mc md jb ka b kb ml kf mm kj mn kn mo kr mp kv mh mi mj mk bi translated"><a class="ae kw" href="https://pandas.pydata.org/" rel="noopener ugc nofollow" target="_blank">熊猫</a> —用于为你的训练数据定义一个好的数据结构</li><li id="d391" class="mc md jb ka b kb ml kf mm kj mn kn mo kr mp kv mh mi mj mk bi translated"><a class="ae kw" href="http://scikit-learn.org/stable/" rel="noopener ugc nofollow" target="_blank"> sklearn </a> —用于数据分析的工具(例如标准化或聚类数据)</li><li id="67be" class="mc md jb ka b kb ml kf mm kj mn kn mo kr mp kv mh mi mj mk bi translated"><a class="ae kw" href="https://matplotlib.org/" rel="noopener ugc nofollow" target="_blank"> matplotlib </a> —用于显示我们的数据</li><li id="99fa" class="mc md jb ka b kb ml kf mm kj mn kn mo kr mp kv mh mi mj mk bi translated"><a class="ae kw" href="https://www.tensorflow.org/" rel="noopener ugc nofollow" target="_blank"> tensorflow </a> — Google 的开源库，用于以简单优雅的方式构建 ML 图</li></ul><p id="1baa" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">数据集应分为训练/验证/测试部分，每个部分都相互独立。我选择将数据分成 80%的训练、10%的验证和 10%的测试。</p><p id="89dd" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">最后，我用<em class="lv">熊猫</em>来装载<em class="lv">。csv </em>文件，并将其存储到一个数据框架中。我们将在后面看到如何使用它。</p><h2 id="8f43" class="kx ky jb bd kz la lb dn lc ld le dp lf kj lg lh li kn lj lk ll kr lm ln lo lp bi translated">#2.操纵数据</h2><p id="a537" class="pw-post-body-paragraph jy jz jb ka b kb lq kd ke kf lr kh ki kj ls kl km kn lt kp kq kr lu kt ku kv ij bi translated">我们的下一步是以某种方式改革数据，使其可用于训练。</p><p id="c87d" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，我们需要规范化它，这基本上意味着将每个特征缩放到一个给定的范围，在我们的例子中，这个范围在 0 和 1 之间。正常化通过以下方式实现:</p><figure class="lw lx ly lz gt is"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="df55" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们使用<code class="fe mq mr ms mt b">sklearn.preprocessing.MinMaxScaler()</code>和<code class="fe mq mr ms mt b">fit_transform</code>将<em class="lv">开盘价、最高价、最低价和收盘价</em>中的每个值拟合到 0-1 的范围内，并将这些矩阵转换为(-1，1)的形状。用(-1，1)整形意味着我们希望，例如，<code class="fe mq mr ms mt b">df['open'].values</code>成为形状(k，1)的矩阵，其中 k 未知，由 numpy 决定。在这种情况下，k 将等于不同价格的数量。</p><p id="30f1" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">然后，我们需要将数据分为训练、验证和测试。如上所述，80%是培训，10%是验证，10%是测试。</p><figure class="lw lx ly lz gt is"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="7e43" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在上面的代码片段中有 3 个主要步骤:</p><ol class=""><li id="613d" class="mc md jb ka b kb kc kf kg kj me kn mf kr mg kv mu mi mj mk bi translated">将数据分割成长度相同的不同数组<code class="fe mq mr ms mt b">seq_len</code>。</li><li id="d0bd" class="mc md jb ka b kb ml kf mm kj mn kn mo kr mp kv mu mi mj mk bi translated">根据项目数量确定训练/验证和测试数据的长度。</li><li id="c124" class="mc md jb ka b kb ml kf mm kj mn kn mo kr mp kv mu mi mj mk bi translated">按照正确的比例划分数据。</li></ol><h2 id="0d97" class="kx ky jb bd kz la lb dn lc ld le dp lf kj lg lh li kn lj lk ll kr lm ln lo lp bi translated">#3.显示数据</h2><p id="0c9a" class="pw-post-body-paragraph jy jz jb ka b kb lq kd ke kf lr kh ki kj ls kl km kn lt kp kq kr lu kt ku kv ij bi translated">最后，我们需要显示规范化的数据。这对于模型性能来说并不重要，但是在调试代码时非常有用。因此，应该养成经常可视化数据集的习惯。</p><figure class="lw lx ly lz gt is"><div class="bz fp l di"><div class="ma mb l"/></div></figure><p id="567e" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在绘制数据之前，我们需要使用上面定义的方法。</p><p id="ca01" class="pw-post-body-paragraph jy jz jb ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，我们复制数据帧并删除未使用的参数(本例中为“Volume”)，然后对其他值进行规范化。之后，我们只需要使用 matplotlib 库来绘制它:</p><ul class=""><li id="74f2" class="mc md jb ka b kb kc kf kg kj me kn mf kr mg kv mh mi mj mk bi translated">第 14 行:初始化图像帧。</li><li id="5d46" class="mc md jb ka b kb ml kf mm kj mn kn mo kr mp kv mh mi mj mk bi translated">第 15–18 行:绘制不同的值。</li><li id="b065" class="mc md jb ka b kb ml kf mm kj mn kn mo kr mp kv mh mi mj mk bi translated">第 19–23 行:添加符号并显示图形。</li></ul><figure class="lw lx ly lz gt is gh gi paragraph-image"><div role="button" tabindex="0" class="it iu di iv bf iw"><div class="gh gi mv"><img src="../Images/859f97ad865a68b7b93ff199e1bb7cef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xOqYqjwgOOempe1Oe6SenQ.png"/></div></div><figcaption class="mw mx gj gh gi my mz bd b be z dk">S&amp;P500 price visualization (normalized)</figcaption></figure><h2 id="a034" class="kx ky jb bd kz la lb dn lc ld le dp lf kj lg lh li kn lj lk ll kr lm ln lo lp bi translated">在下一部分</h2><p id="e167" class="pw-post-body-paragraph jy jz jb ka b kb lq kd ke kf lr kh ki kj ls kl km kn lt kp kq kr lu kt ku kv ij bi translated">我们以上面的可视化来结束第一部分。在<a class="ae kw" rel="noopener" target="_blank" href="/just-another-ai-trying-to-predict-the-stock-market-part-2-88605f9d8e45">第 2 部分</a>中，我们将重点关注使用价格训练模型。我们将大量使用 TensorFlow，因此您可以看到这个优秀的库在实践中是如何工作的。</p><h2 id="67d4" class="kx ky jb bd kz la lb dn lc ld le dp lf kj lg lh li kn lj lk ll kr lm ln lo lp bi translated">谢谢你的阅读。如果你喜欢这篇文章，给它一些掌声👏。希望你有一个伟大的一天！</h2></div></div>    
</body>
</html>