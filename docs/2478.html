<html>
<head>
<title>Only Numpy: Convolutional Update Gate RNN, modifying Google Brain’s Update Gate RNN (Capacity and Trainability in Recurrent Neural Networks) with Interactive Code.</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">只有Numpy:卷积更新门RNN，用交互代码修改谷歌大脑的更新门RNN(递归神经网络中的容量和可训练性)。</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/only-numpy-convolutional-update-gate-rnn-modifying-google-brains-update-gate-rnn-capacity-and-4a3e932eccf8?source=collection_archive---------7-----------------------#2018-01-30">https://towardsdatascience.com/only-numpy-convolutional-update-gate-rnn-modifying-google-brains-update-gate-rnn-capacity-and-4a3e932eccf8?source=collection_archive---------7-----------------------#2018-01-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div class="gh gi jn"><img src="../Images/9cd8bad084dd82105228722e0285b9ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/1*6UcQdP-1yFoUotb-QnDWsg.gif"/></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk">Gif from <a class="ae jy" href="https://giphy.com/gifs/neural-networks-IthDvtTlWezf2/download" rel="noopener ugc nofollow" target="_blank">here</a></figcaption></figure><p id="a9c7" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">因此，我在这里发表了一篇文章，实现了本文中提出的各种不同的RNN "<a class="ae jy" href="https://arxiv.org/abs/1611.09913" rel="noopener ugc nofollow" target="_blank">递归神经网络的容量和可训练性</a>"，请<a class="ae jy" href="https://becominghuman.ai/only-numpy-implementing-and-comparing-google-brains-update-gate-capacity-and-trainability-in-940f0ad80649" rel="noopener ugc nofollow" target="_blank">点击这里的链接阅读我的中型博客文章</a>。但是为什么就此打住呢？</p><p id="89ad" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">让我们将更新门RNN (URNN)转换为CURNN，卷积更新RNN。此外，我将使用动量优化器。我们正在对仅用于0和1图像的“<a class="ae jy" href="http://scikit-learn.org/stable/auto_examples/classification/plot_digits_classification.html" rel="noopener ugc nofollow" target="_blank">识别手写数字</a>”数据集执行一个非常简单的二进制任务。</p><h1 id="2df3" class="kx ky iq bd kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu bi translated">热门人工智能文章:</h1><blockquote class="lv"><p id="417f" class="lw lx iq bd ly lz ma mb mc md me kw dk translated"><a class="ae jy" href="https://becominghuman.ai/back-propagation-is-very-simple-who-made-it-complicated-97b794c97e5c" rel="noopener ugc nofollow" target="_blank"> 1。反向传播非常简单。谁让它变得复杂了？</a></p><p id="fb20" class="lw lx iq bd ly lz ma mb mc md me kw dk translated"><a class="ae jy" href="https://becominghuman.ai/neural-networks-for-algorithmic-trading-multimodal-and-multitask-deep-learning-5498e0098caf" rel="noopener ugc nofollow" target="_blank"> 2。用于算法交易的神经网络</a></p><p id="04bf" class="lw lx iq bd ly lz ma mb mc md me kw dk translated"><a class="ae jy" href="https://becominghuman.ai/introducing-ozlo-d5cce73d7ba5" rel="noopener ugc nofollow" target="_blank"> 3。介绍Ozlo </a></p></blockquote><p id="6733" class="pw-post-body-paragraph jz ka iq kb b kc mf ke kf kg mg ki kj kk mh km kn ko mi kq kr ks mj ku kv kw ij bi translated"><strong class="kb ir">网络架构:数学形式</strong></p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi mk"><img src="../Images/9e2ec7eaf8e3390662e09e0f4d54d249.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LzbP4XaySSFrlIAhm6JFoA.png"/></div></div><figcaption class="ju jv gj gh gi jw jx bd b be z dk">Image fr<a class="ae jy" href="https://arxiv.org/abs/1611.09913" rel="noopener ugc nofollow" target="_blank">om Original Pap</a>er</figcaption></figure><p id="0158" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">上面的图像只是一个复习，但是请注意红色的星形区域，我们将把这个操作从点积改为卷积操作。</p></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><p id="d3b5" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">网络架构:图形形式/前馈操作</strong></p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi na"><img src="../Images/6a3442bba8c0e9181105f48a6515741b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BISTXlo7GplO8TA3ujC-IA.png"/></div></div></figure><p id="99a3" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">上图中有很多东西，所以让我从最右边解释一下。</p><p id="c92e" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">浅绿色框</strong> → <strong class="kb ir">零填充隐藏状态以保留尺寸(</strong> <em class="nb">注意这一点非常重要，因为我们需要保留尺寸！</em> <strong class="kb ir"> ) </strong></p><p id="2162" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir"> X </strong> →尺寸为(8*8) <br/> <strong class="kb ir"> Wxg，Wxc </strong> →将要应用于尺寸为(5*5)的输入图像的卷积核</p><p id="0084" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir"> g(t)，c(t)，h(t) </strong> →各门输出，尺寸均为(4*4)</p><p id="7b7a" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir"> Wrecc，Wrecg </strong> →将要应用于先前隐藏状态维度(3*3)的卷积核</p><p id="8658" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir"> Wfc1，Wfc2 </strong> →分类全连接层的权重</p><p id="ba19" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">橙色框</strong> →我和CURNN的前馈假设有2个时间戳</p><p id="1b71" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">紫色方框</strong> →对于两个时间戳来说，<strong class="kb ir">输入是完全相同的图像！(所以我的想法是，网络可以通过再次显示相同的图像来学习得更好，LOL不知道这是否可能是真的。)</strong></p><p id="d29f" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">蓝框</strong> →矢量化隐藏状态(2)矩阵(4*4)成(1*16)矢量。</p><p id="3a83" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">下面是代码实现。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nc"><img src="../Images/0d9172e0aca3babb0127d8851c620394.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fyqHbkAiWkyybk3q-DnD9g.png"/></div></div></figure></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><p id="3be9" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">关于<br/> Wfc2，Wfc1，c(2) —时间戳= 2，g(1) —时间戳= 1 </strong>的反向传播</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi na"><img src="../Images/7c7831435f048499cf9d341f7afc929e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YhtbGnUEuLJOnAT762-UvA.png"/></div></div></figure><p id="c475" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">再一次，这张图片包含了很多东西。</p><p id="dd2b" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">粉色星形/红色星形→ </strong>全连接层的标准反向传播尊重Wfc1、Wfc2</p><p id="97cf" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">蓝星</strong> →时间标记2时相对于c门()的导数。请注意，我们对c()求导，而不是对权重Wrecc或Wxc求导，这是因为一旦我们对c()求导，我们就可以很容易地对这些变量进行反向传播。如果你想看RNN反向传播的完整例子。请通过<a class="ae jy" href="https://medium.com/@SeoJaeDuk/only-numpy-deriving-forward-feed-and-back-propagation-in-long-short-term-memory-lstm-part-1-4ee82c14a652" rel="noopener">点击此处</a>或<a class="ae jy" href="https://becominghuman.ai/only-numpy-implementing-and-comparing-google-brains-update-gate-capacity-and-trainability-in-940f0ad80649" rel="noopener ugc nofollow" target="_blank">点击此处</a>阅读我的中帖。</p><p id="8c8d" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">粉色星星</strong> →故事同上，但针对g门()，时间标记为1。</p><p id="0bdd" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">下面是反向传播的局部视图。</p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nd"><img src="../Images/91eb07e2045df95b02eff0694ac9b9f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yFLcj5rAjM4QSNJfrfYGOA.png"/></div></div></figure></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><p id="00dc" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">培训和结果</strong></p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi ne"><img src="../Images/c62f3636a827215d9a8a0094c3f70181.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1S-f-d2jF9KyVbQ69pa-WQ.png"/></div></div></figure><p id="d0c0" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">在使用超级参数后，(ALOT)我能够取得不错的成绩。然而，这是非常困难的训练。在一些点上，学习只是停止在成本44或类似的东西，所以它是相当令人沮丧的。</p></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><p id="3421" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">互动码</strong></p><figure class="ml mm mn mo gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="mp mq di mr bf ms"><div class="gh gi nf"><img src="../Images/166190f286289cad818e39fc2722da32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*21x21vwUZfMjT9WDSPjBZw.png"/></div></div></figure><p id="2f03" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><em class="nb">注意:在线编译器没有“从sklearn导入数据集”，所以我不能复制并粘贴我在笔记本电脑上使用的代码。所以我复制了四个训练样本，分别代表手写数字0，1，0，1，并调整了超参数。</em></p><p id="8fa0" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><em class="nb">更新:我为了交互代码搬到了Google Colab！所以你需要一个谷歌帐户来查看代码，你也不能在谷歌实验室运行只读脚本，所以在你的操场上做一个副本。最后，我永远不会请求允许访问你在Google Drive上的文件，仅供参考。编码快乐！</em></p><p id="4fc3" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">请<a class="ae jy" href="https://colab.research.google.com/notebook#fileId=1Q4uM2nh3HrsCzY6aEVWyFAiEo-Yy_6Xq" rel="noopener ugc nofollow" target="_blank">点击此处，进入互动码</a>。</p></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><h2 id="2dc4" class="ng ky iq bd kz nh ni dn ld nj nk dp lh kk nl nm ll ko nn no lp ks np nq lt nr bi translated">最后的话</h2><p id="660e" class="pw-post-body-paragraph jz ka iq kb b kc ns ke kf kg nt ki kj kk nu km kn ko nv kq kr ks nw ku kv kw ij bi translated">我真的需要使用不同的优化方法。在纯SGD或Momentum上训练复杂模型变得有点困难。</p><p id="f67c" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">如果发现任何错误，请发电子邮件到jae.duk.seo@gmail.com找我。</p><p id="ccc9" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated">同时，在我的twitter上关注我<a class="ae jy" href="https://twitter.com/JaeDukSeo" rel="noopener ugc nofollow" target="_blank">这里</a>，访问<a class="ae jy" href="https://jaedukseo.me/" rel="noopener ugc nofollow" target="_blank">我的网站</a>，或者我的<a class="ae jy" href="https://www.youtube.com/c/JaeDukSeo" rel="noopener ugc nofollow" target="_blank"> Youtube频道</a>了解更多内容。如果你感兴趣的话，我还做了解耦神经网络<a class="ae jy" href="https://becominghuman.ai/only-numpy-implementing-and-comparing-combination-of-google-brains-decoupled-neural-interfaces-6712e758c1af" rel="noopener ugc nofollow" target="_blank">的比较。</a></p></div><div class="ab cl mt mu hu mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ij ik il im in"><p id="fca2" class="pw-post-body-paragraph jz ka iq kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ij bi translated"><strong class="kb ir">参考文献</strong></p><ol class=""><li id="8d98" class="nx ny iq kb b kc kd kg kh kk nz ko oa ks ob kw oc od oe of bi translated">Collins，j .，Sohl-Dickstein，j .，和Sussillo，D. (2016年)。递归神经网络的容量和可训练性。<em class="nb"> arXiv预印本arXiv:1611.09913 </em>。</li><li id="ee8a" class="nx ny iq kb b kc og kg oh kk oi ko oj ks ok kw oc od oe of bi translated">Seo，J. D. (2018年1月24日)。Only Numpy:实现和比较Google Brain的更新门(容量和可训练性in…2018年1月29日检索，来自<a class="ae jy" href="https://becominghuman.ai/only-numpy-implementing-and-comparing-google-brains-update-gate-capacity-and-trainability-in-940f0ad80649" rel="noopener ugc nofollow" target="_blank">https://becoming human . ai/only-Numpy-Implementing-and-comparison-Google-brains-Update-Gate-Capacity-and-training ability-in-940 f0ad 80649</a></li><li id="c9b4" class="nx ny iq kb b kc og kg oh kk oi ko oj ks ok kw oc od oe of bi translated">Seo，J. D. (2018年1月11日)。只有Numpy:推导长期短期记忆中的前馈和反向传播(LSTM)第1部分。2018年1月29日检索，来自<a class="ae jy" href="https://medium.com/@SeoJaeDuk/only-numpy-deriving-forward-feed-and-back-propagation-in-long-short-term-memory-lstm-part-1-4ee82c14a652" rel="noopener">https://medium . com/@ SeoJaeDuk/only-numpy-derivating-forward-feed-and-back-propagation-in-long-short-term-memory-lstm-part-1-4 ee 82 c 14 a 652</a></li><li id="903c" class="nx ny iq kb b kc og kg oh kk oi ko oj ks ok kw oc od oe of bi translated">Seo，J. D. (2018年1月29日)。Only Numpy:(我为什么做手动反向传播)实现多通道/层卷积神经…2018年1月29日检索自<a class="ae jy" href="https://medium.com/@SeoJaeDuk/only-numpy-why-i-do-manual-back-propagation-implementing-multi-channel-layer-convolution-neural-7d83242fcc24" rel="noopener">https://medium . com/@ SeoJaeDuk/only-Numpy-Why-I-do-Manual-Back-Propagation-Implementing-Multi-Channel-Layer-con { volution-Neural-7d 83242 FCC 24</a></li></ol><figure class="ml mm mn mo gt jr"><div class="bz fp l di"><div class="ol om l"/></div></figure><div class="ml mm mn mo gt ab cb"><figure class="on jr oo op oq or os paragraph-image"><a href="https://becominghuman.ai/artificial-intelligence-communities-c305f28e674c"><img src="../Images/20880898f038333e31843bbd07b0e4df.png" data-original-src="https://miro.medium.com/v2/resize:fit:510/format:webp/1*2f7OqE2AJK1KSrhkmD9ZMw.png"/></a></figure><figure class="on jr oo op oq or os paragraph-image"><a href="https://upscri.be/8f5f8b"><img src="../Images/dd23357ef17960a7bfb82e7b277f50f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:510/format:webp/1*v-PpfkSWHbvlWWamSVHHWg.png"/></a></figure><figure class="on jr oo op oq or os paragraph-image"><a href="https://becominghuman.ai/write-for-us-48270209de63"><img src="../Images/91ecfb22295488bc2c6af3d2ac34d857.png" data-original-src="https://miro.medium.com/v2/resize:fit:510/format:webp/1*Wt2auqISiEAOZxJ-I7brDQ.png"/></a></figure></div></div></div>    
</body>
</html>