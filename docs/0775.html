<html>
<head>
<title>How Not to Sort by Popularity</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何不按受欢迎程度排序</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-not-to-sort-by-popularity-92745397a7ae?source=collection_archive---------2-----------------------#2017-06-20">https://towardsdatascience.com/how-not-to-sort-by-popularity-92745397a7ae?source=collection_archive---------2-----------------------#2017-06-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="f844" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">问题</strong>:你是一个web程序员。你有用户。你的用户会阅读你网站上的内容，但不会对他们进行<a class="ae kl" href="http://www.evanmiller.org/how-not-to-sort-by-average-rating.html" rel="noopener ugc nofollow" target="_blank">评级</a>。您想要制作一个用户可能想要点击的流行内容列表。你需要某种“分数”来排序。</p><p id="a7f8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">错解#1 </strong>:分数=浏览量</p><p id="8977" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="km">为什么是错的</em>:如果你的网站足够老，你可能有过去流行的内容，但那已经不再相关了。</p><p id="c766" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">错解#2 </strong>:分数=最近<em class="km">小时浏览量x </em>小时。</p><p id="2583" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="km">为什么是错的</em>:“趋势”是一个比绝对流行更好的解决方案，但它缺乏意外收获。没有必要显示用户<a class="ae kl" href="https://www.slideshare.net/xamat/recommender-systems-machine-learning-summer-school-2014-cmu/20" rel="noopener ugc nofollow" target="_blank">可能会找到的内容</a>。如果某样东西很流行，它可能已经在你的主页上了。</p><h1 id="0688" class="kn ko iq bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated"><strong class="ak">间歇I:隐性反馈</strong></h1><p id="cb0f" class="pw-post-body-paragraph jn jo iq jp b jq ll js jt ju lm jw jx jy ln ka kb kc lo ke kf kg lp ki kj kk ij bi translated">如果用户在给你的内容评分，你应该去看看埃文·米勒8年前的建议，而不是按平均评分排序。但通常情况并非如此。更多的时候，我们有隐性的反馈，而不是显性的评级。那个是什么<a class="ae kl" href="http://recsyswiki.com/wiki/Implicit_feedback" rel="noopener ugc nofollow" target="_blank">？</a></p><blockquote class="lq"><p id="04e1" class="lr ls iq bd lt lu lv lw lx ly lz kk dk translated"><strong class="ak">隐性反馈</strong>是<a class="ae kl" href="http://recsyswiki.com/mediawiki/index.php?title=User&amp;action=edit&amp;redlink=1" rel="noopener ugc nofollow" target="_blank">用户</a>活动，可用于间接推断用户<a class="ae kl" href="http://recsyswiki.com/mediawiki/index.php?title=Preference&amp;action=edit&amp;redlink=1" rel="noopener ugc nofollow" target="_blank">偏好</a>，例如点击、页面浏览量、购买行为。有时只知道正面的反馈，例如，客户已经购买的产品，但不知道他们已经决定不购买的产品。</p></blockquote><p id="718f" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">通过隐式反馈来推断用户偏好听起来可能很难，但在实践中效果很好。主要原因是，收集点击量和页面浏览量比显式评级容易得多。如果你有足够的数据，输入中的噪声就不会有太大影响。</p><p id="007d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你有很多注册用户，你可以(也应该)<a class="ae kl" href="https://open.blogs.nytimes.com/2015/08/11/building-the-next-new-york-times-recommendation-engine/?mcubz=0&amp;_r=0" rel="noopener ugc nofollow" target="_blank">用这些数据建立一个推荐系统</a>。但即使你建立了一个，你如何推荐项目(博客帖子，文章，音乐，视频，产品等。)给新用户如果你对他们一无所知？</p><p id="1cd5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这就是所谓的<a class="ae kl" href="https://en.wikipedia.org/wiki/Cold_start" rel="noopener ugc nofollow" target="_blank">冷启动</a>问题。当你掌握了用户的一些信息，你可以推荐与她之前消费过的东西相似的商品，但对于新用户，你不能这么做。最简单的方法是显示“流行”的内容，但我们可以做得比天真的解决方案好得多。</p><p id="4407" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">主要的技巧是不要只跟踪人们在看什么，而是要跟踪呈现给他们的选项是什么(<em class="km">印象</em>)以及他们决定点击什么。</p><p id="7d50" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">错误解决方案#3: </strong>得分=点击率=点击数/印象数</p><p id="7d1e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们将<em class="km">点击数</em>除以一个项目的<em class="km">印象数</em>，我们就得到了CTR(点击率)。这意味着一个项目每次被推荐时平均有多少点击量。好的物品会有很高的点击率。</p><p id="8cef" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="km">为什么错了</em>:这里的问题是，如果一件商品的点击率很少，就很难估计它的点击率。假设有一篇文章被推荐了一次，没有被点击。你会相信点击率为零，你永远不会再推荐它吗？或者说如果这个商品被展示一次并被点击，你会把它推荐给每个用户吗？</p><p id="a005" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="km">免责声明</em> : <a class="ae kl" href="http://www.hongliangjie.com/publications/recsys2014.pdf" rel="noopener ugc nofollow" target="_blank"> CTR不是评估推荐质量的唯一指标，也可能不是最佳指标</a>。我们不想显示用户实际上不喜欢的点击诱饵内容，但这超出了本文的范围。</p><p id="22de" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们回到我们的问题上来。我们怎样才能得到一个可靠的估计项目的CTR？</p><p id="a30c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">错误解决方案#4: </strong>得分= LCB(CTR)</p><p id="bf61" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">LCB在这里代表较低的置信限。它表示在您可以指定的置信度下，该项目保证具有的最小CTR。为了计算这一点，我们可以使用威尔逊评分，来自埃文·米勒的建议。我们只需要将每一次点击视为“竖起大拇指”，而将每一次未被点击的印象视为“竖起大拇指”。如果我们的例子很少，它会考虑到CTR的不确定性。</p><p id="4bb3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="km">为什么是错的</em>:这个解决方案在实践中很好，但它仍然是错的。它擅长<em class="km">发掘点击率高的</em>文章，但不擅长<em class="km">发掘</em>新文章。也许一篇新文章会有一个更好的点击率，但是我们会因为没有一个好的估计值而陷入展示一篇次优文章的困境。</p><p id="38b8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你明白这一点，恭喜你！这是<a class="ae kl" href="https://en.wikipedia.org/wiki/Multi-armed_bandit" rel="noopener ugc nofollow" target="_blank">多股武装匪徒</a>理论背后的基本概念。你已经知道了足够的术语来在拉斯维加斯的鸡尾酒会上讨论MAB。但是什么是MAB呢？</p><h1 id="fd9f" class="kn ko iq bd kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk bi translated">幕间休息二:多武装匪徒</h1><figure class="mg mh mi mj gt mk gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi mf"><img src="../Images/fa86ccfb48aaf5e920a7642487a11660.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Eu4JvIdV50o4SmIDeDb0Q.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk">By Yamaguchi先生 at the English language Wikipedia, CC BY-SA 3.0, <a class="ae kl" href="https://commons.wikimedia.org/w/index.php?curid=57295504" rel="noopener ugc nofollow" target="_blank">https://commons.wikimedia.org/w/index.php?curid=57295504</a></figcaption></figure><p id="6d1f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://en.wikipedia.org/wiki/Multi-armed_bandit" rel="noopener ugc nofollow" target="_blank">维基百科定义</a>解释了这个古怪名字的来源:</p><blockquote class="lq"><p id="e45c" class="lr ls iq bd lt lu lv lw lx ly lz kk dk translated"><strong class="ak">多臂土匪问题</strong>是一个在一排<a class="ae kl" href="https://en.wikipedia.org/wiki/Slot_machines" rel="noopener ugc nofollow" target="_blank">吃角子老虎机</a>(有时被称为“独臂土匪”)上的赌徒必须决定玩哪些机器、每台机器玩多少次以及以什么顺序玩它们的问题。当游戏开始时，每台机器从特定于该机器的<a class="ae kl" href="https://en.wikipedia.org/wiki/Probability_distribution" rel="noopener ugc nofollow" target="_blank">概率分布</a>中提供随机奖励。游戏者的目标是通过一系列的杠杆操作获得最大的回报。</p></blockquote><p id="b64c" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">MAB在业内最为人所知的是作为A/B测试的替代选择，作为挑选你的网站的最佳变体的一种方式。在我们的例子中，我们可以把每篇文章看作一个不同的手臂，每一次点击都是一种奖励。有些文章会给更好的奖励，因为他们有更好的平均点击率。</p><p id="9cea" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">好的解决方案#1: </strong>分数=对某些用户随机，对其余用户LCB</p><p id="8291" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们选择一小部分(epsilon，ε)用户，并向他们展示随机的文章，我们将能够探索所有的项目，同时仍然显示大多数用户的最佳选择。这被称为ε-greedy，非常有效，但是很难为ε选择一个好的值。如果太小，我们将无法探索所有项目。如果太大，太多用户会收到差的推荐。</p><p id="9f9f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">好方案#2: </strong>得分= UCB(CTR)</p><p id="a538" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果我们使用<a class="ae kl" href="http://www.cs.mcgill.ca/~vkules/bandits.pdf" rel="noopener ugc nofollow" target="_blank"> UCB </a>(置信上限)而不是LCB，我们将有一个非常好的MAB政策。LCB给出了项目的最小CTR估计值，而UCB返回了项目在给定期望置信度的情况下可以具有的最大CTR。</p><p id="2dfe" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它能够尝试新的武器，直到它有一个合理的点击率估计，并会更经常地推荐最好的文章。我们说它有低<em class="km">遗憾</em>。如果与总是推荐最好武器的最佳可能的<em class="km">政策</em>相比，这基本上是多少<em class="km">点击</em>将会失去。一个问题是，如果你不实时更新点击和印象，它可能不会很好地工作。我们可以做得更好。</p><p id="01f0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">最佳解决方案</strong>:分数= beta(点击次数+ 1，展示次数-点击次数+ 1)</p><p id="fc16" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">也称为汤普森采样。</p><figure class="mg mh mi mj gt mk gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/5ce3bd7fff9b0dc5b67c0a1446baf5a5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1038/format:webp/1*fQjCIhLpLkN_fzbTj6_CXQ.png"/></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk"><a class="ae kl" href="https://sk.pinterest.com/pin/537898749225885705" rel="noopener ugc nofollow" target="_blank">https://sk.pinterest.com/pin/537898749225885705</a></figcaption></figure><blockquote class="lq"><p id="a189" class="lr ls iq bd lt lu mw mx my mz na kk dk translated">Thompson抽样是解决多臂强盗问题的最古老的启发式方法之一。这是一种基于贝叶斯思想的随机算法，最近几项研究表明，与最先进的方法相比，它具有更好的经验性能，因此引起了人们的极大兴趣。</p></blockquote><p id="ca41" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">上面的引用来自文章<a class="ae kl" href="http://proceedings.mlr.press/v28/agrawal13.pdf" rel="noopener ugc nofollow" target="_blank">Thompson Sampling for Contextual bottom with Linear payments</a>。<a class="ae kl" href="https://twitter.com/xamat" rel="noopener ugc nofollow" target="_blank"> Xavier Amatriain </a>，前机器学习研究员，后来领导网飞的推荐系统团队，以及后来的Quora，<a class="ae kl" href="https://soundcloud.com/twiml/twiml-talk-3-xavier-amatriain-engineering-practical-machine-learning-systems#t=41:44" rel="noopener ugc nofollow" target="_blank">在本期播客<a class="ae kl" href="https://twimlai.com/twiml-talk-3-xavier-amatriain-engineering-practical-machine-learning-systems/" rel="noopener ugc nofollow" target="_blank"> TWiML </a>中说了同样的话</a>:</p><blockquote class="lq"><p id="68a8" class="lr ls iq bd lt lu lv lw lx ly lz kk dk translated">有很多关于多臂强盗的文献，但只有一本在实践中有效。我不知道我是否想给出答案(……)在业内众所周知，汤姆逊抽样是最简单、最实用的MAB方法。</p></blockquote><p id="e63e" class="pw-post-body-paragraph jn jo iq jp b jq ma js jt ju mb jw jx jy mc ka kb kc md ke kf kg me ki kj kk ij bi translated">听起来不错，对吧？不过，如果你看看维基百科上关于<a class="ae kl" href="https://en.wikipedia.org/wiki/Thompson_sampling" rel="noopener ugc nofollow" target="_blank">汤普森取样</a>的文章，数学可能会非常吓人。幸运的是，实现和理解它实际上非常简单。</p><p id="beae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那么，什么是汤普森抽样？它是以威廉·r·汤普森的名字命名的，他在1933年提出了这个想法。这叫做抽样，因为对于每一条手臂，我们从我们当前对其概率分布的信念中挑选(抽样)一个随机的CTR比率，然后我们根据<em class="km">抽样的</em> CTR对文章进行分类。</p><p id="7811" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但是CTR的概率分布是什么呢？当我们使用LCB和UCB时，我们承认我们不知道确切的CTR值是多少，所以我们对其值进行了有根据的猜测。概率分布只是一个函数，它返回CTR为任何特定值的几率。</p><p id="67af" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它看起来怎么样？对于一篇新文章，我们不知道CTR是什么。它可以是0到1之间的任何数字。这叫做均匀分布。但每次我们展示一篇文章，就像是在抛一枚不公平的硬币。我们翻转它，看看结果。假设是正面，我们得到一个点击。每次我们抛硬币并看到结果，我们可以更新我们对正面概率或文章CTR的信念。</p><p id="371a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面是一个例子，根据我们得到的人头数，在我们进行一些投掷后，这个分布(名为<a class="ae kl" href="https://en.wikipedia.org/wiki/Beta_distribution" rel="noopener ugc nofollow" target="_blank"> Beta </a>)看起来是什么样的:</p><figure class="mg mh mi mj gt mk gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi nb"><img src="../Images/b3503b4c162534daef0569d4f4f09bf8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gx_ulGAILAFafkq1hVkmEw.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk"><a class="ae kl" href="http://nbviewer.jupyter.org/github/CamDavidsonPilon/Probabilistic-Programming-and-Bayesian-Methods-for-Hackers/blob/master/Chapter1_Introduction/Ch1_Introduction_PyMC2.ipynb" rel="noopener ugc nofollow" target="_blank">http://nbviewer.jupyter.org/github/CamDavidsonPilon/Probabilistic-Programming-and-Bayesian-Methods-for-Hackers/blob/master/Chapter1_Introduction/Ch1_Introduction_PyMC2.ipynb</a></figcaption></figure><p id="e39a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这种承认我们不知道所有事情的想法和<a class="ae kl" href="https://www.nytimes.com/2017/05/27/opinion/sunday/youre-not-going-to-change-your-mind.html" rel="noopener ugc nofollow" target="_blank">根据新信息修正我们的信念</a>是所谓贝叶斯统计背后的主要思想。如果你想了解更多这方面的知识，我推荐《T4概率编程》&amp;黑客贝叶斯方法这本书。它不像深度学习那样新潮，但仍然很有趣，很有用。这是你在鸡尾酒会上可以讨论的另一个好话题！</p><p id="feca" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">那么，用score = beta(点击+ 1，impressions - clicks + 1)是什么意思呢？我们只是得到一个随机的CTR，从beta分布中取样。然后，我们根据这个随机分数对文章进行排序。点击率高的文章将会更频繁地展示(<em class="km"> exploited </em> ) <em class="km"> </em>，但我们也会随着新项目的出现<em class="km">探索</em>。太神奇了，这么简单，效果这么好。</p><p id="72b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">确保你理解所有概念的最后一个测试:你会发现这部卡通很有趣。:)</p><figure class="mg mh mi mj gt mk gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi nc"><img src="../Images/fdd78d51b2b2dc23adda9a42c2034b12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SiXVYSHlYWvN7gVAR04UxQ.png"/></div></div><figcaption class="mr ms gj gh gi mt mu bd b be z dk"><a class="ae kl" href="https://xkcd.com/1132/" rel="noopener ugc nofollow" target="_blank">https://xkcd.com/1132/</a></figcaption></figure><p id="1192" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="km">拜</em> <a class="ae kl" href="https://twitter.com/hltbra" rel="noopener ugc nofollow" target="_blank"> <em class="km">雨果·洛佩斯·塔瓦雷斯</em></a><em class="km"/><a class="ae kl" href="https://leandromoreira.com.br/" rel="noopener ugc nofollow" target="_blank"><em class="km">莱安德罗·莫雷拉</em></a><em class="km"/><a class="ae kl" href="https://twitter.com/danielfmt" rel="noopener ugc nofollow" target="_blank"><em class="km">丹尼尔·马丁斯</em></a><em class="km"/><a class="ae kl" href="http://flavioribeiro.com/" rel="noopener ugc nofollow" target="_blank"><em class="km">菲拉维奥·里贝罗</em></a><em class="km"/><a class="ae kl" href="https://caricio.com/" rel="noopener ugc nofollow" target="_blank"><em class="km">拉斐尔·卡里奥</em> </a> <em class="km"/></p></div></div>    
</body>
</html>