<html>
<head>
<title>Python for Android: Start Building Kivy Cross-Platform Applications</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Python for Android:开始构建 Kivy 跨平台应用程序</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/python-for-android-start-building-kivy-cross-platform-applications-6cf867d44612?source=collection_archive---------2-----------------------#2018-07-07">https://towardsdatascience.com/python-for-android-start-building-kivy-cross-platform-applications-6cf867d44612?source=collection_archive---------2-----------------------#2018-07-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="5996" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">本教程介绍了使用 Linux Ubuntu 发行版使用 Kivy 跨平台 Python 框架创建 Android 应用程序所需的步骤。在开始安装 Kivy 并启动和运行它之前，需要安装它的依赖项。大部分时间用于通过安装运行所需的库来准备 Kivy 环境。在本教程中，Kivy 本身将安装在一个虚拟环境中。</p><p id="6f28" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">本教程中使用的平台是带有 Python 3.6.5 的 Linux Ubuntu 18.04。在其他平台上运行 Kivy 会存在一些差异。为了能够安装库、浏览操作系统的目录、复制/删除/提取文件、运行 Python 脚本，读者应该对 Linux 终端命令和 Python 有一个基本的了解。</p></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><p id="a0ff" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">本教程包含以下几个部分:</p><ol class=""><li id="37e8" class="ks kt iq jp b jq jr ju jv jy ku kc kv kg kw kk kx ky kz la bi translated">介绍</li><li id="7ef8" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">安装 Kivy 依赖项</li><li id="bc6e" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">为安装 Kivy 创建虚拟环境</li><li id="6ca1" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">安装 Cython</li><li id="127b" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">安装 Kivy</li><li id="fa65" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">进口基维</li><li id="5943" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">创建简单的 Kivy 应用</li><li id="1cac" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">安装 Buildozer</li><li id="5bce" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">正在创建 buildozer.spec 文件</li><li id="ec11" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">使用 Buildozer 构建 Android 应用程序</li><li id="9feb" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">参考</li></ol></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><h1 id="0a66" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">1.介绍</h1><p id="7ffb" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">Kivy 用于创建自然的用户界面，具有抽象和模块化的优点。它将开发人员从不必要的复杂细节中分离出来，只给出简单的 API 来完成复杂的任务。因此，您应该确定 Kivy 将使用什么样的后端库来完成它的任务。我们将使用 SDL ( <strong class="jp ir">简单直接媒体层</strong>)跨平台库，通过 OpenGL 对图形硬件进行低级访问。除了 SDL，GStreamer 等其他库也用于处理音频和视频。因为这样的库是用 C 写的，所以需要 Cython。</p></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><h1 id="3209" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">2.安装 Kivy 依赖项</h1><p id="342c" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">根据 Kivy Linux 安装说明(【https://kivy.org/docs/installation/installation-linux.html】T2)，下面是获得 SDL2 和 GStreamer 需要安装的库。注意，您可以选择在 Kivy 中使用哪个 Python 版本，对于 Python 2 使用<strong class="jp ir"> python </strong>和<strong class="jp ir"> python-dev </strong>，或者对于 python3 使用<strong class="jp ir"> python3 </strong>和<strong class="jp ir"> python3-dev </strong>。Pip 安装在下面，供以后准备 Kivy 虚拟环境时使用。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="a1c5" class="mt lh iq mp b gy mu mv l mw mx"><strong class="mp ir">ahmed-gad@ubuntu:~$ sudo apt install -y \</strong></span><span id="9bc3" class="mt lh iq mp b gy my mv l mw mx"><strong class="mp ir">python-pip \</strong></span><span id="ca23" class="mt lh iq mp b gy my mv l mw mx"><strong class="mp ir">build-essential \</strong></span><span id="76be" class="mt lh iq mp b gy my mv l mw mx"><strong class="mp ir">git \</strong></span><span id="ae68" class="mt lh iq mp b gy my mv l mw mx"><strong class="mp ir">python3 \</strong></span><span id="9aa0" class="mt lh iq mp b gy my mv l mw mx"><strong class="mp ir">python3-dev \</strong></span><span id="22f2" class="mt lh iq mp b gy my mv l mw mx"><strong class="mp ir">ffmpeg \</strong></span><span id="c80d" class="mt lh iq mp b gy my mv l mw mx"><strong class="mp ir">libsdl2-dev \</strong></span><span id="b16d" class="mt lh iq mp b gy my mv l mw mx"><strong class="mp ir">libsdl2-image-dev \</strong></span><span id="5916" class="mt lh iq mp b gy my mv l mw mx"><strong class="mp ir">libsdl2-mixer-dev \</strong></span><span id="4ec5" class="mt lh iq mp b gy my mv l mw mx"><strong class="mp ir">libsdl2-ttf-dev \</strong></span><span id="c818" class="mt lh iq mp b gy my mv l mw mx"><strong class="mp ir">libportmidi-dev \</strong></span><span id="4472" class="mt lh iq mp b gy my mv l mw mx"><strong class="mp ir">libswscale-dev \</strong></span><span id="fae6" class="mt lh iq mp b gy my mv l mw mx"><strong class="mp ir">libavformat-dev \</strong></span><span id="93f1" class="mt lh iq mp b gy my mv l mw mx"><strong class="mp ir">libavcodec-dev \</strong></span><span id="d3b9" class="mt lh iq mp b gy my mv l mw mx"><strong class="mp ir">zlib1g-dev \</strong></span><span id="e779" class="mt lh iq mp b gy my mv l mw mx"><strong class="mp ir">libgstreamer1.0 \</strong></span><span id="765f" class="mt lh iq mp b gy my mv l mw mx"><strong class="mp ir">gstreamer1.0-plugins-base \</strong></span><span id="c51a" class="mt lh iq mp b gy my mv l mw mx"><strong class="mp ir">gstreamer1.0-plugins-good</strong></span></pre></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><h1 id="1c42" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">3.为安装 Kivy 创建虚拟环境</h1><p id="cd35" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">准备好 Kivy 依赖项后，我们可以通过创建虚拟环境来开始安装 Kivy。不要求使用虚拟环境来运行 Kivy，但建议将 Kivy 与其他现有项目分开。</p><p id="df62" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在开始创建虚拟环境之前，我们应该确保创建虚拟环境所需的工具已经安装并更新。以下命令确保<strong class="jp ir"> virtualenv </strong>和<strong class="jp ir"> setuptools </strong>工具已经存在并更新。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="3ddf" class="mt lh iq mp b gy mu mv l mw mx"><strong class="mp ir">ahmed-gad@ubuntu:~$ sudo pip install --upgrade pip virtualenv setuptools</strong></span></pre><p id="5b7a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> virtualenv </strong>用于创建隔离的 Python 环境。有关虚拟环境优势的更多信息，您可以访问本页<a class="ae mj" href="https://virtualenv.pypa.io/en/stable/" rel="noopener ugc nofollow" target="_blank">https://virtualenv.pypa.io/en/stable/</a>。<strong class="jp ir"> setuptools </strong>用于打包 Python 项目。</p><p id="eb9c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">之后，我们准备创建 Kivy 虚拟环境。以下命令创建了一个名为 mykivyinstall 的环境。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="c9b3" class="mt lh iq mp b gy mu mv l mw mx"><strong class="mp ir">ahmed-gad@ubuntu:~$ virtualenv --no-site-packages mykivyinstall</strong></span></pre><p id="5bb6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> — no-site-packages </strong>参数用于将环境与主 Python 安装隔离开来。这是在不影响任何其他项目的情况下，在那个项目上自由地工作。</p><p id="ed82" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">发出该命令后，预计会在当前目录中获得一个根据虚拟环境名称命名的新文件夹，如图 1 所示。</p><figure class="mk ml mm mn gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi mz"><img src="../Images/42d63b30e53185df78731cf5ff450ca5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KPnn-xv809B1JmyHpWAmJA.png"/></div></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk"><strong class="bd nl">Figure 1. Creating Kivy virtual environment.</strong></figcaption></figure><p id="075d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">前面的命令将在环境中使用默认的 Python 解释器。它可能是 Python 2，我们希望与 Python 3 合作。因此，我们可以使用下面的命令中的<strong class="jp ir"> -p </strong>选项来明确指定使用哪个 Python 解释器:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="2e3c" class="mt lh iq mp b gy mu mv l mw mx"><strong class="mp ir">ahmed-gad@ubuntu:~$ virtualenv --no-site-packages -p /usr/bin/python3 mykivyinstall</strong></span></pre><p id="3bfa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建虚拟环境后，我们可以激活它来开始安装 Kivy。可以基于以下命令激活它。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="56d1" class="mt lh iq mp b gy mu mv l mw mx"><strong class="mp ir">ahmed-gad@ubuntu:~$ . mykivyinstall/bin/activate</strong></span></pre><p id="e10c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">点号(<strong class="jp ir">)。</strong>)是一个内置命令，执行作为参数传递的文件内容。它是命令源的同义词。因此，前面的命令与此命令相同:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="1771" class="mt lh iq mp b gy mu mv l mw mx"><strong class="mp ir">ahmed-gad@ubuntu:~$ <em class="nm">source</em> mykivyinstall/bin/activate</strong></span></pre><p id="17ba" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">激活虚拟环境后，命令提示符应更改如下:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="13e5" class="mt lh iq mp b gy mu mv l mw mx"><strong class="mp ir">(mykivyinstall) ahmed-gad@ubuntu:~$</strong></span></pre></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><h1 id="25fa" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">4.安装 Cython</h1><p id="41a1" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">在安装 Kivy 之前，根据以下命令将 Cython 安装在这样的环境中:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="fbb9" class="mt lh iq mp b gy mu mv l mw mx"><strong class="mp ir">(mykivyinstall) ahmed-gad@ubuntu:~$ pip install cython=0.25.2</strong></span></pre><p id="8f60" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">请注意，Cython 的版本取决于要安装的 Kivy 的版本。在当前日期，最新的<strong class="jp ir"> Kivy </strong>版本是<strong class="jp ir"> 1.10.0 </strong>，它需要<strong class="jp ir"> Cython 0.25.2 </strong>，这就是为什么在上面的命令中使用它。之后，我们准备安装 Kivy。</p></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><h1 id="4b65" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">5.安装 Kivy</h1><p id="c68c" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">可以根据以下命令使用 pip 安装 Kivy:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="2d81" class="mt lh iq mp b gy mu mv l mw mx"><strong class="mp ir">(mykivyinstall) ahmed-gad@ubuntu:~$ pip install kivy</strong></span></pre><p id="ed98" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个命令之后，Kivy 会自动下载并安装。但是请注意，Kivy 的安装是最难的部分，因为有许多依赖项是基于机器、平台以及您已经拥有和缺少的库而变化的。这个过程并不简单，您应该寻找其他方法来解决安装错误。例如，Kivy 可以通过使用 wheel 文件或根据以下命令克隆其 github 项目来安装:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="0402" class="mt lh iq mp b gy mu mv l mw mx"><strong class="mp ir">(mykivyinstall) ahmed-gad@ubuntu:~$ pip install git+https://github.com/kivy/kivy.git@master</strong></span></pre></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><h1 id="9061" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">6.进口基维</h1><p id="01bf" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">达到 is 阶段后，预计 Kivy 会成功安装并运行在您的机器上。我们可以通过导入 Kivy 来测试这个环境，如图 2 所示。虚拟环境被激活，Python 被激活，Kivy 被成功导入。</p><figure class="mk ml mm mn gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi nn"><img src="../Images/9c49a16dd1aa45346e267066d014b843.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c16xUmZNVKIQ-aIl3ncwEA.png"/></div></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk"><strong class="bd nl">Figure 2. Testing the virtual environment.</strong></figcaption></figure><p id="3cda" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在确保 Kivy 运行良好之后，我们准备创建我们的第一个 Kivy 应用程序。</p></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><h1 id="bca2" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">7.创建简单的 Kivy 应用</h1><p id="35ba" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">Kivy 应用程序只是一个保存 Kivy 代码的简单 Python 文件。我们的应用程序中的文件将被命名为“<strong class="jp ir"> main.py </strong>”。原因是在构建移动应用的时候，必须有一个名为“<strong class="jp ir"> main.py </strong>的文件，这是应用的入口。要创建的应用程序将有三个 Kivy 小部件，分别是<strong class="jp ir">文本输入</strong>、<strong class="jp ir">标签、</strong>和<strong class="jp ir">按钮</strong>。这些小部件使用方框布局垂直显示在一个窗口中。它们将按照添加到框布局的顺序出现。换句话说，文本输入将是第一个小部件，其次是标签，最后是底部的按钮。当点击按钮时，在文本输入中输入的文本将显示在标签上。下面是应用程序的 Kivy 代码。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="e399" class="mt lh iq mp b gy mu mv l mw mx">1.  <strong class="mp ir">import</strong> kivy.app</span></pre><ol class=""><li id="9f90" class="ks kt iq jp b jq jr ju jv jy ku kc kv kg kw kk kx ky kz la bi translated"><strong class="jp ir">导入</strong> kivy.uix.boxlayout</li><li id="1d91" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated"><strong class="jp ir">导入</strong> kivy.uix.textinput</li><li id="5379" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated"><strong class="jp ir">导入</strong> kivy.uix.label</li><li id="83ea" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated"><strong class="jp ir">导入</strong> kivy.uix.button</li><li id="f963" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated"><strong class="jp ir">类</strong>简单应用程序(kivy.app.App):</li><li id="14ef" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated"><strong class="jp ir"> def </strong> build(自我):</li><li id="de31" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">self . textinput = kivy . uix . textinput . textinput()</li><li id="5f08" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">self . label = kivy . uix . label . label(text = "您的消息。")</li><li id="5ada" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">self . button = kivy . uix . button . button(text = "点击我。")</li><li id="b449" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">self . button . bind(on _ press = self . display message)</li><li id="6cc6" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">self . box layout = kivy . uix . box layout . box layout(orientation = " vertical ")</li><li id="4ddf" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">self . box layout . add _ widget(self . textinput)</li><li id="1ed9" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">self . box layout . add _ widget(self . label)</li><li id="390b" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">self . box layout . add _ widget(self . button)</li><li id="1ee4" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated"><strong class="jp ir">返回</strong> self.boxLayout</li><li id="546f" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated"><strong class="jp ir"> def </strong>显示消息(self，btn):</li><li id="f2a3" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">self . label . text = self . textinput . text</li><li id="6c53" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated"><strong class="jp ir">如果</strong> __name__ == "__main__ ":</li><li id="d618" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">simpleApp = SimpleApp()</li><li id="1a5d" class="ks kt iq jp b jq lb ju lc jy ld kc le kg lf kk kx ky kz la bi translated">simpleApp.run()</li></ol><p id="79c8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">build 方法是应用程序运行后调用的方法，因此它用于初始化 Kivy GUI 窗口。这三个小部件被创建，然后被添加到框布局中。bind 方法将一个回调方法附加到单击时要执行的按钮上。回调方法名为“<strong class="jp ir"> displayMessage </strong>”，它将标签文本设置为文本输入小部件中输入的文本。只有通过确保 if 语句中的<strong class="jp ir">“_ _ name _ _</strong>”变量具有值“<strong class="jp ir">_ _ main _ _”</strong>来执行 main.py 文件，应用程序才会运行。做那件事是好习惯。为了运行该应用程序，需要两个步骤。首先是激活先前创建的名为"<strong class="jp ir"> mykivyinstall </strong>"的 Kivy 虚拟环境。第二个是在导航到应用程序文件所在的文件夹后，运行应用程序文件“<strong class="jp ir"> main.py </strong>”。这些步骤如图 3 所示。</p><figure class="mk ml mm mn gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi no"><img src="../Images/ca9b1fa02f6b872f4655f49e789d7afc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*d020_8aSBgenygXAc9rG4A.png"/></div></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk"><strong class="bd nl">Figure 3. Activating the virtual environment.</strong></figcaption></figure><p id="dfd3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">图 4 显示了带有之前创建的三个小部件的窗口。请注意，窗口高度在它的三个小部件之间平均分配，因此每个小部件只有窗口高度的三分之一。在本例中，在文本输入中输入了“<strong class="jp ir"> Hello Kivy </strong>”消息。当按钮被点击时，信息将出现在标签上。</p><figure class="mk ml mm mn gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi np"><img src="../Images/a8e3f5f529d7f8999bcde7166593791c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4dg9UqYGhfoLzI95tqlRiA.png"/></div></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk"><strong class="bd nl">Figure 4. Simple Kivy application.</strong></figcaption></figure><p id="e5c5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">至此，成功创建了一个 Kivy 桌面应用程序。我们现在可以开始将这个项目打包成一个 Android 应用程序。</p></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><h1 id="4733" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">8.安装 Buildozer</h1><p id="9255" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated"><strong class="jp ir"> Buildozer </strong>工具用于将项目打包成 Android 应用。一旦安装完毕，<strong class="jp ir"> Buildozer </strong>就会自动完成构建 Android 应用的过程。为了安装<strong class="jp ir"> Buildozer </strong>，有一些依赖关系。除了之前安装的 Cython 和 git，还有一些其他的库需要安装。根据<a class="ae mj" href="http://buildozer.readthedocs.io/en/latest/installation.html" rel="noopener ugc nofollow" target="_blank">http://buildozer.readthedocs.io/en/latest/installation.html</a>中的安装说明，可以使用以下 Ubuntu 命令下载并安装所有依赖项:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="81a1" class="mt lh iq mp b gy mu mv l mw mx"><strong class="mp ir">ahmed-gad@ubuntu:~$ sudo dpkg --add-architecture i386</strong></span><span id="a948" class="mt lh iq mp b gy my mv l mw mx"><strong class="mp ir">ahmed-gad@ubuntu:~$ sudo get install build-essential ccache libncurses5:i386 libstdc++6:i386 libgtk2.0-0:i386 libpangox-1.0-0:i386 libpangoxft-1.0-0:i386 libidn11:i386 python2.7 python2.7-dev openjdk-8-jdk unzip zlib1g-dev zlib1g:i386</strong></span></pre><p id="6634" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">可以使用这个命令安装 Buildozer。该命令确保 Buildozer 已安装并升级。</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="44ce" class="mt lh iq mp b gy mu mv l mw mx"><strong class="mp ir">ahmed-gad@ubuntu:~$ sudo install –upgrade buildozer</strong></span></pre><p id="4cb7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">成功安装 Buildozer 后，让我们准备好所有需要的文件，以便成功构建 android 应用程序。</p></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><h1 id="c727" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">9.正在创建 buildozer.spec 文件</h1><p id="2f87" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated">我们的项目结构如图 5 所示。有一个名为<strong class="jp ir"> simpleapp </strong>的文件夹，里面放着之前创建的<strong class="jp ir"> main.py </strong>文件。Kivy 的美妙之处在于，同样的 Python 文件将在 Android 应用程序中不加修改地使用。但是还有另一个名为<strong class="jp ir"> buildozer.spec </strong>的文件，这是构建这个应用程序所必需的。这个文件包含了 Android 应用程序的信息，比如标题和版本。如何创建该文件？</p><figure class="mk ml mm mn gt na gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/5bbf0ab6150f6df97b4b8c2f8ab77aa2.png" data-original-src="https://miro.medium.com/v2/resize:fit:370/format:webp/1*3hi-HheJtTooTly2-eroCg.png"/></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk"><strong class="bd nl">Figure 5. Project structure.</strong></figcaption></figure><p id="c07d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">可以使用 buildozer 工具生成<strong class="jp ir"> buildozer.spec </strong>文件。将当前工作目录设为应用程序<strong class="jp ir"> main.py </strong>文件所在的目录后，发出以下命令:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="c009" class="mt lh iq mp b gy mu mv l mw mx"><strong class="mp ir">ahmed-gad@ubuntu:~/Desktop/simpleapp$ buildozer init</strong></span></pre><p id="ff85" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">将会出现一条消息，表明<strong class="jp ir"> buildozer.spec </strong>文件已经创建，如图 6 所示。</p><figure class="mk ml mm mn gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi nr"><img src="../Images/88d84c77a397622e254f956849eda3ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0K_gNJwMcKrlwQvZykndog.png"/></div></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk"><strong class="bd nl">Figure 6. Generating the buildozer.spec file.</strong></figcaption></figure><p id="6cc5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> buildozer.spec </strong>文件中 Android 应用的一些重要属性如下:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="73fa" class="mt lh iq mp b gy mu mv l mw mx"><strong class="mp ir">[app]</strong></span><span id="5d0d" class="mt lh iq mp b gy my mv l mw mx"><strong class="mp ir">title = Simple Application</strong></span><span id="100d" class="mt lh iq mp b gy my mv l mw mx"><strong class="mp ir">package.name = simpleapp</strong></span><span id="aa9a" class="mt lh iq mp b gy my mv l mw mx"><strong class="mp ir">package.domain = org.simpleapp</strong></span><span id="d824" class="mt lh iq mp b gy my mv l mw mx"><strong class="mp ir">source.dir = .</strong></span><span id="6dad" class="mt lh iq mp b gy my mv l mw mx"><strong class="mp ir">source.include_exts = py,png,jpg,kv,atlas</strong></span><span id="837e" class="mt lh iq mp b gy my mv l mw mx"><strong class="mp ir">version = 0.1</strong></span><span id="9d62" class="mt lh iq mp b gy my mv l mw mx"><strong class="mp ir">requirements = kivy</strong></span><span id="5b33" class="mt lh iq mp b gy my mv l mw mx"><strong class="mp ir">orientation = portrait</strong></span><span id="47a8" class="mt lh iq mp b gy my mv l mw mx"><strong class="mp ir">osx.python_version = 3</strong></span><span id="297f" class="mt lh iq mp b gy my mv l mw mx"><strong class="mp ir">osx.kivy_version = 1.9.1</strong></span><span id="f9ab" class="mt lh iq mp b gy my mv l mw mx"><strong class="mp ir">fullscreen = 0</strong></span></pre><p id="2d54" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">例如，title 保存应用程序的标题，source directory 引用应用程序的目录，在这种情况下设置为当前目录、app 版本、Python 和 Kivy 版本等。这些字段位于规范文件的<strong class="jp ir">【app】</strong>部分。你可以在这个链接<a class="ae mj" href="http://buildozer.readthedocs.io/en/latest/specifications.html" rel="noopener ugc nofollow" target="_blank">http://buildozer . readthedocs . io/en/latest/specifications . html</a>查看 app 规范。您还可以编辑规范文件，以更改您认为值得修改的任何字段。</p><p id="c87a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">准备好构建 Android 应用程序所需的所有文件后，让我们开始构建它。</p></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><h1 id="4f65" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">10.使用 Buildozer 构建 Android 应用程序</h1><p id="67cd" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated"><strong class="jp ir"> Buildozer </strong>是构建 Android 应用程序的好工具，因为它根据所有需求准备环境，以便成功构建应用程序。这些需求比如<strong class="jp ir"> python-for-android </strong>、Android <strong class="jp ir"> SDK </strong>、<strong class="jp ir"> NDK </strong>等等。在 app 目录中，可以使用以下命令构建它:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="036c" class="mt lh iq mp b gy mu mv l mw mx"><strong class="mp ir">ahmed-gad@ubuntu:~/Desktop/simpleapp$ buildozer android release</strong></span></pre><p id="1880" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">图 7 显示了输入命令时的响应。当第一次构建应用程序时，Buildozer 必须下载所有这些依赖项。下载和安装它们需要时间。耐心点。</p><figure class="mk ml mm mn gt na gh gi paragraph-image"><div role="button" tabindex="0" class="nb nc di nd bf ne"><div class="gh gi ns"><img src="../Images/473152aad93a4f5cb092b15f89f7f83e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jM7s4ssINaoHtCUtCyYGJg.png"/></div></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk"><strong class="bd nl">Figure 7. Building the Kivy project.</strong></figcaption></figure><p id="3e8f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">该命令执行后，APK 文件将位于项目目录<strong class="jp ir"> /simpleapp/下的这个位置。buildozer/Android/platform/build/dists/simple app/bin</strong>。APK 的文件可以转移到安卓设备上运行。此外，还可以将 Android 设备连接到机器，使用一个命令构建、部署和运行应用程序，如下所示:</p><pre class="mk ml mm mn gt mo mp mq mr aw ms bi"><span id="8a2d" class="mt lh iq mp b gy mu mv l mw mx"><strong class="mp ir">ahmed-gad@ubuntu:~/Desktop/simpleapp$ buildozer android release deploy run</strong></span></pre><p id="dd73" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">图 8 显示了 Android 应用程序的运行。</p><figure class="mk ml mm mn gt na gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/55957c8837d0aa2f43f9c650f5f1e471.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*4PPwDPp9Oej1sUdHt9Fyzg.png"/></div><figcaption class="nh ni gj gh gi nj nk bd b be z dk"><strong class="bd nl">Figure 8. Running the Android application.</strong></figcaption></figure></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><h1 id="23ee" class="lg lh iq bd li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md bi translated">11.参考</h1><p id="eedb" class="pw-post-body-paragraph jn jo iq jp b jq me js jt ju mf jw jx jy mg ka kb kc mh ke kf kg mi ki kj kk ij bi translated"><strong class="jp ir">小菲，风尘仆仆。使用 Python 在 Kivy: Mobile 中创建应用程序。“奥莱利媒体公司”，2014 年。</strong></p><p id="4fe3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">https://kivy.org/docs/installation/installation-linux.html<a class="ae mj" href="https://kivy.org/docs/installation/installation-linux.html" rel="noopener ugc nofollow" target="_blank"/></p><p id="1f0f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">【https://virtualenv.pypa.io/en/stable/ T4】</p><p id="f969" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae mj" href="https://kivy.org/docs/guide/architecture.html" rel="noopener ugc nofollow" target="_blank">https://kivy.org/docs/guide/architecture.html</a></p><p id="9d2c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae mj" href="https://github.com/kivy/kivy/blob/master/kivy/" rel="noopener ugc nofollow" target="_blank">https://github.com/kivy/kivy/blob/master/kivy/</a></p><p id="2726" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae mj" href="http://buildozer.readthedocs.io/en/latest/installation.html" rel="noopener ugc nofollow" target="_blank">http://buildozer.readthedocs.io/en/latest/installation.html</a></p><p id="c1a7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae mj" href="https://buildozer.readthedocs.io/en/stable/quickstart.html" rel="noopener ugc nofollow" target="_blank">https://buildozer.readthedocs.io/en/stable/quickstart.html</a></p></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><p id="7061" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">原文可在 LinkedIn 本页面查看:<a class="ae mj" href="https://www.linkedin.com/pulse/python-android-start-building-kivy-cross-platform-applications-gad" rel="noopener ugc nofollow" target="_blank">https://www . LinkedIn . com/pulse/python-Android-start-building-kivy-cross-platform-applications-gad</a></p></div><div class="ab cl kl km hu kn" role="separator"><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq kr"/><span class="ko bw bk kp kq"/></div><div class="ij ik il im in"><p id="7c06" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">联系作者:</p><p id="029d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">电子邮件:ahmed.f.gad@gmail.com</p><p id="17aa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">领英:<a class="ae mj" href="https://linkedin.com/in/ahmedfgad" rel="noopener ugc nofollow" target="_blank">https://linkedin.com/in/ahmedfgad</a></p></div></div>    
</body>
</html>