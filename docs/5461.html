<html>
<head>
<title>Ruby Plotting with Galaaz: An example of tightly coupling Ruby and R in GraalVM</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 Galaaz 绘制 Ruby:GraalVM 中 Ruby 和 R 紧密耦合的一个例子</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/ruby-plotting-with-galaaz-an-example-of-tightly-coupling-ruby-and-r-in-graalvm-520b69e21021?source=collection_archive---------8-----------------------#2018-10-19">https://towardsdatascience.com/ruby-plotting-with-galaaz-an-example-of-tightly-coupling-ruby-and-r-in-graalvm-520b69e21021?source=collection_archive---------8-----------------------#2018-10-19</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><h1 id="e2bd" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">介绍</h1><p id="b0a2" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">Galaaz 是一个紧密耦合 Ruby 和 r 的系统。Ruby 是一种强大的语言，有一个大型社区，一个非常大的库集，非常适合 web 开发。然而，它缺乏数据科学、统计学、科学绘图和机器学习的图书馆。另一方面，R 被认为是解决上述所有问题的最强大的语言之一。也许 R 最强的竞争对手是 Python，它有诸如 NumPy、Panda、SciPy、SciKit-Learn 等库。</p><p id="b82c" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">对于 Galaaz，我们不打算在 R 中重新实现任何科学库，我们允许两种语言之间非常紧密的耦合，以至于 Ruby 开发人员不需要知道有一个 R 引擎在运行。为此，我们使用了 Oracle 提供的新技术:GraalVM、TruffleRuby 和 FastR:</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="0bc4" class="lx jo iq lt b gy ly lz l ma mb">GraalVM is a universal virtual machine for running applications written in JavaScript, Python 3, Ruby, R, JVM-based languages like Java, Scala, Kotlin, and LLVM-based languages such as C and C++.<!-- --> </span><span id="cd65" class="lx jo iq lt b gy mc lz l ma mb">GraalVM removes the isolation between programming languages and enables interoperability in a shared runtime. It can run either standalone or in the context of OpenJDK, Node.js, Oracle Database, or MySQL.<!-- --> </span><span id="0d29" class="lx jo iq lt b gy mc lz l ma mb">GraalVM allows you to write polyglot applications with a seamless way to pass values from one language to another. With GraalVM there is no copying or marshaling necessary as it is with other polyglot systems. This lets you achieve high performance when language boundaries are crossed. Most of the time there is no additional cost for crossing a language boundary at all.</span><span id="4fe4" class="lx jo iq lt b gy mc lz l ma mb">Often developers have to make uncomfortable compromises that require them to rewrite their software in other languages. For example:</span><span id="935f" class="lx jo iq lt b gy mc lz l ma mb">  * “That library is not available in my language. I need to rewrite it.” <br/>  * “That language would be the perfect fit for my problem, but we cannot run it in our environment.” <br/>  * “That problem is already solved in my language, but the language is too slow.”</span><span id="4dcc" class="lx jo iq lt b gy mc lz l ma mb">With GraalVM we aim to allow developers to freely choose the right language for the task at hand without making compromises.</span></pre><p id="ab0d" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">感兴趣的读者还应该查看以下网站:</p><ul class=""><li id="c0c9" class="md me iq kn b ko lj ks lk kw mf la mg le mh li mi mj mk ml bi translated"><a class="ae mm" href="https://www.graalvm.org/" rel="noopener ugc nofollow" target="_blank"> GraalVM Home </a></li><li id="cd92" class="md me iq kn b ko mn ks mo kw mp la mq le mr li mi mj mk ml bi translated"><a class="ae mm" href="https://github.com/oracle/truffleruby" rel="noopener ugc nofollow" target="_blank">松露红宝石</a></li><li id="abd6" class="md me iq kn b ko mn ks mo kw mp la mq le mr li mi mj mk ml bi translated"><a class="ae mm" href="https://github.com/oracle/fastr" rel="noopener ugc nofollow" target="_blank"> FastR </a></li><li id="d370" class="md me iq kn b ko mn ks mo kw mp la mq le mr li mi mj mk ml bi translated"><a class="ae mm" href="https://medium.com/graalvm/faster-r-with-fastr-4b8db0e0dceb" rel="noopener">用 FastR 加快 R </a></li></ul><h1 id="e68e" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">加拉茨是什么意思</h1><p id="c7fc" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">加拉茨是“加拉哈德”的葡萄牙语名称。来自维基百科:</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="1be8" class="lx jo iq lt b gy ly lz l ma mb">Sir Galahad (/ˈɡæləhæd/; sometimes referred to as Galeas /ɡəˈliːəs/ or Galath /ˈɡæləθ/), in Arthurian legend, is a knight of King Arthur's Round Table and one of the three achievers of the Holy Grail. He is the illegitimate son of Sir Lancelot and Elaine of Corbenic, and is renowned for his gallantry and purity as the most perfect of all knights.</span><span id="bdc8" class="lx jo iq lt b gy mc lz l ma mb">Emerging quite late in the medieval Arthurian tradition, Sir Galahad first appears in the Lancelot–Grail cycle, and his story is taken up in later works such as the Post-Vulgate Cycle and Sir Thomas Malory's Le Morte d'Arthur. His name should not be mistaken with Galehaut, a different knight from Arthurian legend.</span></pre><h1 id="4640" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">Galaaz 演示</h1><h1 id="bc24" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">先决条件</h1><ul class=""><li id="777d" class="md me iq kn b ko kp ks kt kw ms la mt le mu li mi mj mk ml bi translated">GraalVM (&gt;= rc7)</li><li id="29c2" class="md me iq kn b ko mn ks mo kw mp la mq le mr li mi mj mk ml bi translated">松露红宝石</li><li id="41ac" class="md me iq kn b ko mn ks mo kw mp la mq le mr li mi mj mk ml bi translated">FastR</li></ul><p id="cfc4" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">以下 R 包将在必要时自动安装，但如果需要，也可以在演示之前安装:</p><ul class=""><li id="04be" class="md me iq kn b ko lj ks lk kw mf la mg le mh li mi mj mk ml bi translated">ggplot2</li><li id="0c1b" class="md me iq kn b ko mn ks mo kw mp la mq le mr li mi mj mk ml bi translated">gridExtra</li></ul><p id="f2eb" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">安装 R 包需要一个开发环境。在 Linux 中，gnu 编译器和工具应该足够了。</p><p id="4d52" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">为了运行“规范”,以下 Ruby 包是必需的:</p><ul class=""><li id="fcd8" class="md me iq kn b ko lj ks lk kw mf la mg le mh li mi mj mk ml bi translated">gem 安装 rspec</li></ul><h1 id="cd2c" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">准备</h1><ul class=""><li id="2c82" class="md me iq kn b ko kp ks kt kw ms la mt le mu li mi mj mk ml bi translated">gem 安装 galaaz</li></ul><h1 id="6cf9" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">运行演示</h1><p id="6bbf" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">这个演示的 ggplot 是从这里的<a class="ae mm" href="http://r-statistics.co/Top50-Ggplot2-Visualizations-MasterList-R-Code.html" rel="noopener ugc nofollow" target="_blank">中提取的</a></p><p id="7cfd" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">在控制台上做</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="692f" class="lx jo iq lt b gy ly lz l ma mb">&gt; galaaz master_list:scatter_plot</span></pre><h1 id="905d" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">运行其他演示</h1><p id="0425" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">在控制台上做什么</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="228a" class="lx jo iq lt b gy ly lz l ma mb">&gt; galaaz -T</span></pre><p id="8dce" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">将显示所有可用演示的列表。要运行列表中的任何演示，请将对“rake”的调用替换为“galaaz”。例如，列表中的一个示例是“rake sthda:bar”。为了运行这个示例，只需执行“galaaz sthda:bar”。执行“galaaz sthda:all”将运行 sthda 类别中的所有演示，在本例中，幻灯片放映中有 80 多个用 Ruby 编写的 ggplot 图形。</p><p id="4278" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">一些示例要求“rspec”可用。要安装“rspec ”,只需执行“gem install rspec”。</p><h1 id="3144" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">演示代码</h1><p id="76ec" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">以下是上述示例的 Ruby 代码和绘图。示例中的代码和下面的代码有一点不同。如果运行该示例，绘图将出现在屏幕上，如下所示，我们生成一个“svg”图像，然后将其包含在本文档中。为了生成和成像，使用了 R.svg 设备。要在屏幕上生成绘图，请使用 R.awt 设备，如代码中所述。</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="fd9d" class="lx jo iq lt b gy ly lz l ma mb">require 'galaaz'<br/>require 'ggplot'</span><span id="e925" class="lx jo iq lt b gy mc lz l ma mb"># load package and data<br/>R.options(scipen: 999)  # turn-off scientific notation like 1e+48<br/>R.theme_set(R.theme_bw) # pre-set the bw theme.</span><span id="836f" class="lx jo iq lt b gy mc lz l ma mb">midwest = ~:midwest</span><span id="2da5" class="lx jo iq lt b gy mc lz l ma mb">R.svg                   # run the svg device to generate an<br/>                        # image in .png format</span><span id="b609" class="lx jo iq lt b gy mc lz l ma mb"># Scatterplot<br/>gg = midwest.ggplot(E.aes(x: :area, y: :poptotal)) + <br/>     R.geom_point(E.aes(col: :state, size: :popdensity)) + <br/>     R.geom_smooth(method: "loess", se: false) + <br/>     R.xlim(R.c(0, 0.1)) + <br/>     R.ylim(R.c(0, 500000)) + <br/>     R.labs(subtitle: "Area Vs Population", <br/>            y: "Population", <br/>            x: "Area", <br/>            title: "Scatterplot", <br/>            caption: "Source: midwest")</span><span id="2e5a" class="lx jo iq lt b gy mc lz l ma mb">R.png('midwest.png')     <br/>puts gg</span><span id="34dc" class="lx jo iq lt b gy mc lz l ma mb">R.dev__off               # R.dev__off turns off the device.  <br/>                         # If using awt, the plot window will <br/>                         # be closed</span></pre><figure class="lo lp lq lr gt mw gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/e4ebe2b6b7950ae79f3153bd07c472c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*QS2krLxMqL4JFZDNRZ8TJQ.png"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk">Midwest Scatterplot</figcaption></figure><p id="f76a" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">在 R 中，生成该图的代码如下</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="ba7e" class="lx jo iq lt b gy ly lz l ma mb"># install.packages("ggplot2")<br/># load package and data<!-- --> </span><span id="1b7c" class="lx jo iq lt b gy mc lz l ma mb">library(ggplot2)</span><span id="7804" class="lx jo iq lt b gy mc lz l ma mb">options(scipen=999)    # turn-off scientific notation like 1e+48<br/>theme_set(theme_bw())  # pre-set the bw theme.</span><span id="bce8" class="lx jo iq lt b gy mc lz l ma mb">data("midwest", package = "ggplot2")</span><span id="7dc9" class="lx jo iq lt b gy mc lz l ma mb"># Scatterplot<br/>gg &lt;- ggplot(midwest, aes(x=area, y=poptotal)) + <br/>      geom_point(aes(col=state, size=popdensity)) + <br/>      geom_smooth(method="loess", se=F) + <br/>      xlim(c(0, 0.1)) + <br/>      ylim(c(0, 500000)) + <br/>      labs(subtitle="Area Vs Population", <br/>           y="Population", <br/>           x="Area", <br/>           title="Scatterplot", <br/>           caption = "Source: midwest")</span><span id="0506" class="lx jo iq lt b gy mc lz l ma mb">plot(gg)</span></pre><p id="e687" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">请注意，这两个代码非常相似。Ruby 代码要求在调用任何函数之前使用“R”，例如，在 Ruby 中，R 函数“geom_point”变成了“R.geom_point”。r 命名参数如(col = state，size = popdensity)，在 Ruby 中变成(col: :state，size: :popdensity)。</p><p id="61e3" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">需要注意的最后一点是对‘AES’函数的调用。在 Ruby 中，我们不用“R.aes ”,而是使用“E.aes”。为什么需要 E.aes 的解释是 R 中的一个高级主题，取决于 R 中的非标准求值(NSE)。简而言之，函数“aes”在 R 中是延迟求值的，即在 R 中调用 geom_point(aes(col=state，size=popdensity))时，函数 geom_point 接收类似于包含“aes(col=state，size=popdensity)”的字符串作为参数，aes 函数将在 geom_point 函数内部求值。在 Ruby 中，没有懒惰求值，做 R.aes 会尝试立即求值。为了延迟函数 aes 的评估，我们需要使用 E.aes。对 R 中的 NSE 感兴趣的读者可参考此处的<a class="ae mm" href="http://adv-r.had.co.nz/Computing-on-the-language.html." rel="noopener ugc nofollow" target="_blank"/>。</p><h1 id="f5c2" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">该示例的扩展</h1><p id="1c3a" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">如果这两个代码如此相似，那么为什么要用 Ruby 而不是 R 呢？galaaz 到底有什么好处呢？</p><p id="a35f" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">Ruby 是一种现代的面向对象语言，有许多非常有用的结构，比如类、模块、块、过程等等。上面的例子关注于两种语言的耦合，并没有展示其他 Ruby 结构的使用。在下面的例子中，我们将展示一个使用其他 Ruby 结构的更复杂的例子。这当然不是一个写得很好的健壮的 Ruby 代码，但是它给出了 Ruby 和 R 是如何紧密耦合的想法。</p><p id="d98d" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">让我们想象一下，我们在一家公司工作，这家公司有自己的情节主题。因此，它定义了一个“CorpTheme”模块。该公司的地块不应有网格，标签中的数字不应使用科学符号，首选颜色是蓝色。</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="4918" class="lx jo iq lt b gy ly lz l ma mb"># corp_theme.rb<br/># defines the corporate theme for all plots<br/>    <br/>module CorpTheme</span><span id="eb5b" class="lx jo iq lt b gy mc lz l ma mb">#----------------------------------------------------------------<br/># Defines the plot theme (visualization).  In this theme we<br/># remove major and minor<br/># grids, borders and background.  We also turn-off scientific<br/># notation.<br/>#---------------------------------------------------------------<br/>  <br/>  def self.global_theme</span><span id="04ad" class="lx jo iq lt b gy mc lz l ma mb">    # turn-off scientific notation like 1e+48    <br/>    R.options(scipen: 999)<br/>    # remove major grids<br/>    global_theme = R.theme(panel__grid__major: E.element_blank())<br/>    # remove minor grids<br/>    global_theme = global_theme + <br/>       R.theme(panel__grid__minor: E.element_blank)<br/>    # remove border<br/>    global_theme = global_theme + <br/>       R.theme(panel__border: E.element_blank)<br/>    # remove background<br/>    global_theme = global_theme + <br/>       R.theme(panel__background: E.element_blank)<br/>    # Change axis font<br/>    global_theme = global_theme +<br/>                   R.theme(axis__text: E.element_text(size: 8,<br/>                                color: "#000080"))<br/>    # change color of axis titles<br/>    global_theme = global_theme +<br/>                   R.theme(axis__title: E.element_text(<br/>                             color: "#000080", <br/>                             face: "bold",<br/>                             size: 8,<br/>                             hjust: 1))<br/>  end<br/>   <br/>end</span></pre><p id="2aa6" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">我们现在定义一个散点图类:</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="11b7" class="lx jo iq lt b gy ly lz l ma mb"># ScatterPlot.rb<br/># creates a scatter plot and allow some configuration<br/>    <br/>class ScatterPlot</span><span id="d02d" class="lx jo iq lt b gy mc lz l ma mb">  attr_accessor :title<br/>  attr_accessor :subtitle<br/>  attr_accessor :caption<br/>  attr_accessor :x_label<br/>  attr_accessor :y_label<br/>  <br/>  #----------------------------------------------------------------<br/># Initialize the plot with the data and the x and y variables<br/>#----------------------------------------------------------------</span><span id="1d4a" class="lx jo iq lt b gy mc lz l ma mb">  def initialize(data, x:, y:)<br/>    @data = data<br/>    @x = x<br/>    @y = y<br/>  end</span><span id="0360" class="lx jo iq lt b gy mc lz l ma mb">#----------------------------------------------------------------<br/># Define groupings by color and size<br/>#---------------------------------------------------------------</span><span id="fb5c" class="lx jo iq lt b gy mc lz l ma mb">  def group_by(color:, size:)<br/>    @color_by = color<br/>    @size_by = size<br/>  end</span><span id="eaeb" class="lx jo iq lt b gy mc lz l ma mb">#----------------------------------------------------------------<br/># Add a smoothing line, and if confidence is true the add a<br/># confidence interval, if false does not add the confidence<br/># interval<br/>#-_--------------------------------------------------------------</span><span id="fe54" class="lx jo iq lt b gy mc lz l ma mb">  def add_smoothing_line(method:, confidence: true)<br/>    @method = method<br/>    @confidence = confidence<br/>  end <br/>  #---------------------------------------------------------------<br/># Creates the graph title, properly formated for this theme<br/># @param title [String] The title to add to the graph<br/># @return textGrob that can be included in a graph<br/>#----------------------------------------------------------------</span><span id="ef0a" class="lx jo iq lt b gy mc lz l ma mb">  def graph_params(title: "", subtitle: "", caption: "", <br/>                   x_label: "", y_label: "")<br/>    R.labs(<br/>      title: title, <br/>      subtitle: subtitle, <br/>      caption: caption,<br/>      y_label: y_label, <br/>      x_label: x_label, <br/>    )<br/>  end</span><span id="42d0" class="lx jo iq lt b gy mc lz l ma mb">#---------------------------------------------------------------<br/># Prepare the plot's points<br/>#---------------------------------------------------------------</span><span id="19c4" class="lx jo iq lt b gy mc lz l ma mb">  def points<br/>    params = {}<br/>    params[:col] = @color_by if @color_by<br/>    params[:size] = @size_by if @size_by<br/>    R.geom_point(E.aes(params))<br/>  end</span><span id="6ce5" class="lx jo iq lt b gy mc lz l ma mb">#----------------------------------------------------------------<br/># Plots the scatterplot<br/>#----------------------------------------------------------------</span><span id="71c6" class="lx jo iq lt b gy mc lz l ma mb">  def plot(device = 'awt')</span><span id="c163" class="lx jo iq lt b gy mc lz l ma mb">    device == 'awt' ? R.awt : R.svg<br/>   <br/>    gg = @data.ggplot(E.aes(x: @x, y: @y)) +<br/>      points + <br/>      R.geom_smooth(method: @method, se: @confidence) +<br/>      R.xlim(R.c(0, 0.1)) +<br/>      R.ylim(R.c(0, 500000)) + <br/>      graph_params(title: @title,<br/>                   subtitle: @subtitle, <br/>                   y_label: @y_label, <br/>                   x_label: @x_label, <br/>                   caption: @caption) +<br/>      CorpTheme.global_theme</span><span id="8ffb" class="lx jo iq lt b gy mc lz l ma mb">    R.png('scatter_plot.png') if !(device == 'awt')<br/>    puts gg<br/>    R.dev__off<br/>    <br/>  end<br/>  <br/>end</span></pre><p id="8106" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">这是用中西部数据制作散点图的最终代码</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="864b" class="lx jo iq lt b gy ly lz l ma mb">require 'galaaz'<br/>require 'ggplot'</span><span id="9f48" class="lx jo iq lt b gy mc lz l ma mb">sp = ScatterPlot.new(~:midwest, x: :area, y: :poptotal)<br/>sp.title = "Midwest Dataset - Scatterplot"<br/>sp.subtitle = "Area Vs Population"<br/>sp.caption = "Source: midwest"<br/>sp.x_label = "Area"<br/>sp.y_label = "Population"<br/>sp.group_by(color: :state, size: :popdensity)    # try sp.group_by(color: :state)<br/># available methods: "lm", "glm", "loess", "gam"<br/>sp.add_smoothing_line(method: "glm") <br/>sp.plot('svg')</span></pre><figure class="lo lp lq lr gt mw gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/b731904f81106317665cecd29980588c.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*KL1mM1S9xSaadB5pSoBIWQ.png"/></div><figcaption class="mz na gj gh gi nb nc bd b be z dk">Midwest Plot with ‘glm’ function and modified theme</figcaption></figure><h1 id="c959" class="jn jo iq bd jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk bi translated">结论</h1><p id="8eec" class="pw-post-body-paragraph kl km iq kn b ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li ij bi translated">r 是一种非常强大的语言，用于统计分析、数据分析、机器学习、绘图和许多其他具有非常大的软件包生态系统的科学应用。然而，R 通常被认为很难学，缺乏现代计算机语言的结构，如面向对象的类、模块、lambdas 等。正因如此，许多开发人员已经开始或从 R 转向 Python。</p><p id="71ff" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">有了 Galaaz，R 程序员几乎可以透明地从 R 移植到 Ruby，因为语法几乎是一样的，而且他们用 fastR 作为 R 引擎。根据大多数基准测试，FastR 可以比 Gnu R 快几个数量级。此外，通过使用 Galaaz，R 开发人员可以开始(如果需要的话，可以慢慢地)使用 Ruby 的所有构造和库来很好地补充 R 包。</p><p id="1cf9" class="pw-post-body-paragraph kl km iq kn b ko lj kq kr ks lk ku kv kw ll ky kz la lm lc ld le ln lg lh li ij bi translated">对于 Ruby 开发人员来说，Galaaz 允许完全透明地直接使用 R 函数。如上面第二个例子所示，类 ScatterPlot 完全隐藏了 R 调用 Ruby 开发者的所有细节，此外，Galaaz 由 TruffleRuby 提供支持，也可以比 MRI Ruby 快几个数量级。</p></div></div>    
</body>
</html>