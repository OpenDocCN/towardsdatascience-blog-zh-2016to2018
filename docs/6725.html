<html>
<head>
<title>How fuzzy matching improve your NLP model</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">模糊匹配如何改进你的 NLP 模型</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-fuzzy-matching-improve-your-nlp-model-bc617385ad6b?source=collection_archive---------7-----------------------#2018-12-28">https://towardsdatascience.com/how-fuzzy-matching-improve-your-nlp-model-bc617385ad6b?source=collection_archive---------7-----------------------#2018-12-28</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><div class=""><h2 id="c9b7" class="pw-subtitle-paragraph jq is it bd b jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh dk translated">模糊匹配</h2></div><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi ki"><img src="../Images/a46137d5f723632a37e6a1c7284b8faf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6Aryp7K8Pn57IkR9"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Photo by <a class="ae ky" href="https://unsplash.com/@rossjoyner?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Ross Joyner</a> on <a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="9aeb" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">处理自然语言处理任务的挑战之一是文本模糊匹配对齐。当跳过这个文本处理文本时，您仍然可以构建您的 NLP 模型，但是代价是您可能不会获得好的结果。有人可能会说，在使用深度学习时，没有必要进行预处理。从我的经验来看，有适当的文本预处理至少可以提高你的模型 3% ~ 5%。</p><p id="c6b3" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">那么在什么样的场景下我们需要处理文本模糊匹配，我们能做些什么呢？如果输入源(即文本)不能保证 100%正确，或者存在别名，如“纽约”和“美国纽约”。</p><p id="fa21" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于情况 1，输入可以来自用户，典型的例子是搜索。想象你正在构建<a class="ae ky" href="https://www.google.com" rel="noopener ugc nofollow" target="_blank">谷歌搜索</a>引擎，你必须验证输入而不是盲目地使用输入。</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lv"><img src="../Images/8b1bcecab83a468c913dfa84faed6378.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sHLMwN3SrBOl6Ukhv7T2hA.png"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">“language” is suggested to replace “lang” by Google</figcaption></figure><p id="bd2b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">另一种可能的情况是输入是其他模型的输出。例如，输入来自光学字符引擎(OCR)的输出，您最好减少来自其他模型的错误。</p><p id="6f26" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">对于第二种情况，即别名。尽管有人认为我们可以构建一个惊人的<a class="ae ky" rel="noopener" target="_blank" href="/3-silver-bullets-of-word-embedding-in-nlp-10fa8f50cc5a">单词嵌入</a>，使得“纽约”和“美国纽约”的向量对于模型来说足够接近。但是，为什么不用一种简单的方法来解决呢？</p><figure class="kj kk kl km gt kn gh gi paragraph-image"><div role="button" tabindex="0" class="ko kp di kq bf kr"><div class="gh gi lw"><img src="../Images/e2f2223851b6cecbcbeb865cb48d3de4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KZkeVdviqNXLiQgQ"/></div></div><figcaption class="ku kv gj gh gi kw kx bd b be z dk">Photo by <a class="ae ky" href="https://unsplash.com/@kwhatswong?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">KEITH WONG</a> on <a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="a1e0" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">模糊的</h1><p id="1ab0" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">FuzzyWuzzy 是一个简单但有用的库，可以找到相似的文本和分数。这个库是由<a class="ae ky" href="https://seatgeek.com" rel="noopener ugc nofollow" target="_blank"> SeatGeek </a>提供的。使用这个库非常简单。您只需要传递目标令牌和字典。对于下面的例子，我试着搜索国家，国家列表可以从<a class="ae ky" href="https://github.com/umpirsky/country-list" rel="noopener ugc nofollow" target="_blank">这里</a>下载。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="eb82" class="mz ly it mv b gy na nb l nc nd">from fuzzywuzzy import process<br/>process.extract('Hong Kong', countries, limit=3)</span></pre><p id="de35" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">第一个参数是你的目标词，而第二个参数是字典。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="588b" class="mz ly it mv b gy na nb l nc nd">[('Hong Kong SAR China', 90), ('Kongo', 72), ('Tonga', 54)]</span></pre><p id="312a" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">经过计算，fuzzywuzzy 提出“中国香港特别行政区”与“香港”的得分最高。</p><h2 id="93d2" class="mz ly it bd lz ne nf dn md ng nh dp mh li ni nj mj lm nk nl ml lq nm nn mn no bi translated">其他得分算法</h2><p id="b316" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">Fuzzywuzzy 为我们提供了以下不同的算法来对字符串进行评分。详细实现可以访问<a class="ae ky" href="https://github.com/seatgeek/fuzzywuzzy/blob/master/fuzzywuzzy/fuzz.py" rel="noopener ugc nofollow" target="_blank">源代码</a>。</p><blockquote class="np nq nr"><p id="98c8" class="kz la ns lb b lc ld ju le lf lg jx lh nt lj lk ll nu ln lo lp nv lr ls lt lu im bi translated">ratio:sequence matcher 的包装器。根据 0 到 100 之间的匹配字符块的数量计算分数。</p></blockquote><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="1d7e" class="mz ly it mv b gy na nb l nc nd">Formula: 2*(Matched Characters) / (len(String A) + len(String B))</span></pre><p id="f9ce" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">以“Edward”为目标词，以“Edwards”、“Edwards2”和“drawdE”为词典。字符数分别为 7、8 和 6。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="7af0" class="mz ly it mv b gy na nb l nc nd">process.extract('Edward', ['Edwards', 'Edwards2', 'drawdE'], scorer=fuzz.ratio)</span></pre><p id="641d" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果是</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="fabb" class="mz ly it mv b gy na nb l nc nd">[('Edwards', 92), ('Edwards2', 86), ('drawdE', 50)]</span></pre><p id="4ef7" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">“drawdE”的结果是 50，你可以看到它不是简单地计算匹配字符的数量，而是字符块。</p><blockquote class="np nq nr"><p id="0b97" class="kz la ns lb b lc ld ju le lf lg jx lh nt lj lk ll nu ln lo lp nv lr ls lt lu im bi translated">WRatio:默认计分器。使用不同的算法给 0 到 100 之间的字符串打分。</p></blockquote><p id="a76b" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">为了查看我们是否可以查询回预期的位置名称，让我们看看是否可以返回日本(输入“日本”)和美国(输入“美国”)。</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="f653" class="mz ly it mv b gy na nb l nc nd"># Default scorer is Weighed Ratio<br/>for location in ['Hong Kong', 'jepen', 'United tates']:<br/>    result = process.extract(location, countries, limit=2)<br/>    print(result)</span></pre><p id="d4d0" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果是</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="a77a" class="mz ly it mv b gy na nb l nc nd">[('Hong Kong SAR China', 90), ('Congo - Kinshasa', 57)]<br/>[('Japan', 60), ('Yemen', 60)]<br/>[('United States', 96), ('United Arab Emirates', 86)]</span></pre><blockquote class="np nq nr"><p id="7e46" class="kz la ns lb b lc ld ju le lf lg jx lh nt lj lk ll nu ln lo lp nv lr ls lt lu im bi translated">QRatio:字符串的快速比率比较。</p></blockquote><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="91b8" class="mz ly it mv b gy na nb l nc nd"># Partial Ratio<br/>process.extract('Hong Kong', countries, scorer=fuzz.QRatio, limit=3)</span></pre><p id="79e5" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">结果是</p><pre class="kj kk kl km gt mu mv mw mx aw my bi"><span id="3489" class="mz ly it mv b gy na nb l nc nd">[('Hong Kong SAR China', 64), ('Kongo', 57), ('Togo', 46)]</span></pre><p id="fec2" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated">还有 UWRatio(与 WRatio 相同)和 UQRatio(与 QRatio 相同)，以防你必须处理 unicode。</p><h1 id="db45" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">拿走</h1><p id="ce0b" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">要访问项目模板，您可以访问这个<a class="ae ky" href="https://github.com/makcedward/nlp/blob/master/sample/preprocessing/nlp-preprocessing-string_matching-fuzzywuzzy.ipynb" rel="noopener ugc nofollow" target="_blank"> github </a> repo。</p><h1 id="e537" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">关于我</h1><p id="49f6" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated">我是湾区的数据科学家。专注于数据科学、人工智能，尤其是 NLP 和平台相关领域的最新发展。你可以通过<a class="ae ky" href="http://medium.com/@makcedward/" rel="noopener">媒体博客</a>、<a class="ae ky" href="https://www.linkedin.com/in/edwardma1026" rel="noopener ugc nofollow" target="_blank"> LinkedIn </a>或<a class="ae ky" href="https://github.com/makcedward" rel="noopener ugc nofollow" target="_blank"> Github </a>联系我。</p><h1 id="a53d" class="lx ly it bd lz ma mb mc md me mf mg mh jz mi ka mj kc mk kd ml kf mm kg mn mo bi translated">参考</h1><p id="71d0" class="pw-post-body-paragraph kz la it lb b lc mp ju le lf mq jx lh li mr lk ll lm ms lo lp lq mt ls lt lu im bi translated"><a class="ae ky" href="https://github.com/seatgeek/fuzzywuzzy" rel="noopener ugc nofollow" target="_blank">Python 中的 Fuzzywuzzy</a>(原创)</p><p id="ac61" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://github.com/xdrop/fuzzywuzzy" rel="noopener ugc nofollow" target="_blank">Java 中的 Fuzzywuzzy</a></p><p id="3111" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" href="https://github.com/umpirsky/country-list" rel="noopener ugc nofollow" target="_blank">国家数据集</a></p><p id="0835" class="pw-post-body-paragraph kz la it lb b lc ld ju le lf lg jx lh li lj lk ll lm ln lo lp lq lr ls lt lu im bi translated"><a class="ae ky" rel="noopener" target="_blank" href="/3-silver-bullets-of-word-embedding-in-nlp-10fa8f50cc5a">文字嵌入故事</a></p></div></div>    
</body>
</html>