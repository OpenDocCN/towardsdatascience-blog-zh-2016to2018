<html>
<head>
<title>Connecting the dots for a Deep Learning App …</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">连接深度学习应用程序的点…</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/connecting-the-dots-for-a-deep-learning-app-324e4648720a?source=collection_archive---------7-----------------------#2017-08-22">https://towardsdatascience.com/connecting-the-dots-for-a-deep-learning-app-324e4648720a?source=collection_archive---------7-----------------------#2017-08-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="7ecc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们的日常活动充满了情感和情绪。想过我们如何通过计算机识别这些情绪吗？哎呀，没脑子的电脑:)？</p><p id="ece0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">亲自尝试这个深度学习应用程序(如果有应用程序错误，最初刷新几次):</p><p id="fe9f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://movie-review-sentiment.herokuapp.com" rel="noopener ugc nofollow" target="_blank">https://movie-review-sentiment.herokuapp.com</a></p><p id="e8e2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> Dot 0:情感分析中的深度学习</strong></p><p id="7773" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">情感分析是一个强大的应用程序，它在当今世界中扩展到了以下领域。<br/> 1。<strong class="jp ir">电影评论</strong>——超过60%的人会在网上查看电影评论，然后决定观看。<br/> 2。<strong class="jp ir">餐厅点评</strong>——你有没有去过一家餐厅而不看点评的经历？<br/> 3。<strong class="jp ir">产品评论</strong> —许多B2B或B2C产品都是基于它们产生的评论来销售的。<br/> 4。<strong class="jp ir">功能评论</strong> —任何产品的成功都与其功能评论成正比。<br/> 5。<strong class="jp ir">政治评论</strong> —政党和候选人是根据他们在评论中的表现来选择的。<br/> 6。客户支持评论 —令人印象深刻的产品由于糟糕的支持评论而失败。简单的产品获得好评。7。<strong class="jp ir">博客评论</strong> —等待你在本博客的评论和点评，了解感悟！！！</p><p id="2cd7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">什么是情感分析？</strong> <br/>据<strong class="jp ir">维基百科</strong>介绍:情感分析(有时也称为意见挖掘或情感AI)是指利用自然语言处理、文本分析、计算语言学和生物特征识别技术，系统地识别、提取、量化和研究情感状态和主观信息。在这种情况下，让我们使用深度学习的方法开发一个电影评论情感应用程序。</p><p id="e7e4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">什么是深度学习？</strong> <br/>深度学习是机器学习的高级领域，是向更大的人工智能学科迈进的一步。<br/>目前，它正在图像处理、自然语言处理、语音处理、视频处理等领域掀起波澜。<br/>这里我们就来说说如何把各个点连接起来，完成一个深度学习App。在我们开始理清头绪之前，让我们先了解一些有用的定义和概念。<br/>将用于任何预测任务的数据集应首先针对以下关键点进行分析，然后再开始解决这些问题。<br/> 1。标签有多好？<br/> 2。我们能抽查几个数据点吗？<br/> 3。数据集有多大？</p><p id="2699" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦我们通过了这个基本的障碍，任何数据科学家生活中的大过程就进入了画面。</p><p id="7021" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">点1:数据准备</strong></p><p id="8ab1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">准备和清理数据目前是数据科学工作的主要部分。相信我，百分之百是真的。<br/>电影评论情感应用程序使用来自IMDB、UCI、Cornell dataset等各种不同来源的众多电影评论的定制数据集<br/>制作黄金数据集(为预测准备的数据集)的过程是一个逐步的过程，包括数据收集、数据清理、数据标准化，之后数据可以称为预测过程的黄金数据集。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/8f54181169a13606249723d0bccea5c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2OH5tiWGA8gzD0eVFDVmuA.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Dataset preparation process</figcaption></figure><p id="3a73" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦我们有了黄金数据集，它只不过是为预测准备的数据集，我们就为建模做好了准备。</p><p id="611d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">点2:基准模型</strong></p><p id="7424" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">任何深度学习分析的第一个架构总是从单个隐藏层架构开始，这要感谢杰瑞米·霍华德教授和雷切尔·托马斯教授，他们坚持从简单开始训练任何深度模型。这个简单而强大的架构充当了我们的基线！！！<br/>以下是在训练我们的情感分析(自然语言处理)管道时采用的步骤:</p><p id="9bf0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1.<strong class="jp ir">记号化器:</strong>每个评论都被分解成一组记号，称为单词。这可以使用keras文本标记器来完成。</p><p id="92c6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.<strong class="jp ir">嵌入:</strong>有多种方法可以将这些单词编码成矢量(矢量化)，在这里，我们将使用默认的keras嵌入作为起点。尽管最终模型使用有效的预训练word2Vec嵌入，其捕获单词的语义信息以及它们与其他单词的关系。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi lc"><img src="../Images/1bca5bf7d8d5c1c3769eb5d0f0cf5957.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ytqlSUVrsRW2jGojkoiOnw.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Courtesy: Tensorflow word2vec</figcaption></figure><p id="4515" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.<strong class="jp ir">复习编码:</strong>这些单词嵌入抓住了单词之间的语义关系。然后，我们需要对整个电影评论进行编码，这样它就可以作为训练数据进行传递。最简单的策略是将单个单词编码相加，形成审查编码。</p><p id="6d62" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.<strong class="jp ir">预测:</strong>这些检查编码然后通过300个神经元的单个隐藏全连接神经网络层，如下所示:<br/>具有批处理规范化的单个隐藏层</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ld"><img src="../Images/8b35562fc60277a47ba89fe1e55e7a06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o9RleJGSv3eieQqUDYU9fg.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Single Hidden Layer with BatchNormalization</figcaption></figure><p id="b338" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">完整的基线模型如下所示:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi le"><img src="../Images/80cb9a56673d673b33f99b817e243cf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fgn70bfdmGAarOsXKrpLdw.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Baseline Model Architecture</figcaption></figure><p id="ef3d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">点3:不同模型架构的实验</strong></p><p id="084d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦我们有了基线，我们就可以开始改进我们的模型目标，比如准确性。为了提高情绪应用的准确性，进行了大量的实验:下表提供了经过测试的模型的摘要。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi lf"><img src="../Images/8881d1a169c3929bedaa0c36948cdb28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ThhXCkpnTIZL_xznqfWo5Q.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Different Model Architectures experimentation</figcaption></figure><p id="608a" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">点4: CNN-GRU建筑</strong></p><p id="d9a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">你们中的许多人可能想知道，卷积神经网络(CNN)对图像很有效，但它对文本效果如何？事实上，CNN在训练NLP模型方面有很多优势，因为它们的训练时间更快，当精确调整时，它们也成为训练文本数据的致命工具。在这里，我们使用CNN来捕捉单词之间的局部和深层关系，用于我们的评论编码，其中的想法来自“用于句子分类的卷积神经网络”(Kim，2014)。由于电影评论可能是几个长句，需要有效地捕捉长期依赖。在这方面，我想到了两个选择，即LSTM(长短期记忆神经网络)和GRU(门控递归神经网络)。<br/>了解这两个网络的好方法是前往http://colah.github.io/的<a class="ae kl" href="http://colah.github.io/" rel="noopener ugc nofollow" target="_blank"/></p><p id="cd73" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在我们的实验中，GRU在训练速度和准确性方面比LSTM表现得更好。</p><p id="749d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个黄金数据集上提供最佳准确性和性能的最终模型:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi lg"><img src="../Images/fd89628d88f648470957f3c6c18d25e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uxu1D05OTFTamollbi2yKQ.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Best Sentiment Model</figcaption></figure><p id="52b2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> Dot 5: App </strong></p><p id="43c9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一旦建立了最佳模型，那么剩下的最后一点就是如何将它用作推断/预测的应用程序。推理使用CPU，因为每个请求都是异步处理的。在CPU和GPU上都进行了训练。在CPU上每个时期的训练平均需要140秒，而在Nvidia 1080 GPU上要快3倍。</p><p id="39f4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最简单的赌注是一些轻量级的东西，当我们谈到轻量级的第一件事想到的是烧瓶。阅读更多关于烧瓶的信息:<a class="ae kl" href="http://flask.pocoo.org/" rel="noopener ugc nofollow" target="_blank">http://flask.pocoo.org/</a></p><p id="10a4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Flask需要以下文件或目录:<br/> <strong class="jp ir"> app.py: </strong> Flask app代码。这将调用predict函数，该函数从加载的最佳模型中获取预测。<br/> <strong class="jp ir">模板:</strong>HTML文件所在的目录。<br/>始终从简单的用户界面(UI)开始，根据用户反馈，您可以添加更多功能。</p><p id="9446" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们决定使用jQuery UI Bootstrap(<a class="ae kl" href="https://jquery-ui-bootstrap.github.io/jquery-ui-bootstrap/" rel="noopener ugc nofollow" target="_blank">https://jquery-ui-bootstrap.github.io/jquery-ui-bootstrap/</a>)，因为我们希望使用现有的UI组件开发UI的第一次迭代，其次是因为它准确地支持移动视图。感谢Arjun Upadhyaya 想出了这个UI方法。这个想法是给用户提供输入文本的选项，并以进度图的形式显示结果。这样，最终用户可以很快看到结果。</p><p id="97ab" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">第一次迭代:</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi lj"><img src="../Images/16b380e586b8da68d07a7697f03a4ade.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VSNXK9LR6JNxIYlmXeVhJQ.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">UI-First Iteration</figcaption></figure><p id="6143" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，我们集思广益，添加了5个样本电影评论输入的选择列表，以允许用户测试模型，而不必手动输入文本。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi lk"><img src="../Images/8b934a1063a19135c2c66f28bd38c08a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EQ6ooE02uK0ByEBtzDdfZA.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Movie Review Sentiment App</figcaption></figure><p id="13b5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后，你还在等什么？。请试一试，进入一个你选择的电影评论，看看有什么感想！！！</p><p id="66a0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><a class="ae kl" href="https://movie-review-sentiment.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">https://movie-review-sentiment.herokuapp.com</a></p><p id="b817" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我错过什么了吗？有什么问题吗？请在下面留言告诉我。</p><p id="4a67" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">如果你喜欢这篇文章，请鼓掌并分享。它让我知道我对你有帮助。</p><p id="98df" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir"> <em class="ll">感谢:</em></strong><a class="lh li ep" href="https://medium.com/u/34ab754f8c5e?source=post_page-----324e4648720a--------------------------------" rel="noopener" target="_blank"><strong class="jp ir"><em class="ll"/></strong></a><strong class="jp ir"><em class="ll"/></strong><a class="lh li ep" href="https://medium.com/u/ee56d0bac1b7?source=post_page-----324e4648720a--------------------------------" rel="noopener" target="_blank"><strong class="jp ir"><em class="ll">雷切尔·托马斯</em></strong></a><strong class="jp ir"><em class="ll"/></strong><a class="lh li ep" href="https://medium.com/u/69a655fa6c1e?source=post_page-----324e4648720a--------------------------------" rel="noopener" target="_blank"><strong class="jp ir"><em class="ll">斯拉维亚·蒂鲁克科瓦鲁尔</em> </strong> </a></p></div></div>    
</body>
</html>