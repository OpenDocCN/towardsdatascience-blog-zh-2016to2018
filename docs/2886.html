<html>
<head>
<title>Python WebServer With Flask and Raspberry Pi</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带有 Flask 和 Raspberry Pi 的 Python WebServer</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/python-webserver-with-flask-and-raspberry-pi-398423cc6f5d?source=collection_archive---------0-----------------------#2018-03-17">https://towardsdatascience.com/python-webserver-with-flask-and-raspberry-pi-398423cc6f5d?source=collection_archive---------0-----------------------#2018-03-17</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="1a5e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们创建一个简单的网络服务器来控制你家里的事情。有很多方法可以做到这一点。例如，在我的教程:<a class="ae kl" href="https://www.hackster.io/mjrobot/iot-raspberry-pi-robot-with-video-streamer-and-pan-tilt-f50e53" rel="noopener ugc nofollow" target="_blank">IoT——仅使用 HTML 和 Shell 脚本通过互联网控制 Raspberry Pi 机器人</a>中，我们已经探索了如何使用<em class="km">light tpd web 服务器通过本地网络控制机器人。对于这里的这个项目，我们将使用<a class="ae kl" href="http://flask.pocoo.org/" rel="noopener ugc nofollow" target="_blank"> FLASK </a>，一个非常简单和免费的 Python 微框架。有了 Flask，通过互联网控制 Raspberry GPIOs 将变得非常简单。</em></p><blockquote class="kn ko kp"><p id="056b" class="jn jo km jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated"><em class="iq">看完这篇教程，请访问它的续篇:</em> <a class="ae kl" href="https://medium.com/@rovai/from-data-to-graph-a-web-jorney-with-flask-and-sqlite-6c2ec9c0ad0" rel="noopener"> <em class="iq">从数据到图形:一个带 Flask 和 SQLite 的 Web Jorney</em></a></p></blockquote><h1 id="c5eb" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">1.介绍</h1><p id="22cf" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">Flask 被称为微框架，因为它不需要特殊的工具或库。它没有数据库抽象层、表单验证或任何其他组件，而现有的第三方库提供了通用功能。然而，Flask 支持可以添加应用程序特性的扩展，就好像它们是在 Flask 本身中实现的一样。</p><p id="caaa" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在本教程中，我们将使用 Raspberry Pi 作为本地 Web 服务器，我们将通过一个简单的网页来控制其 3 个编程为输出的 gpio(充当<em class="km">致动器</em>)和监视器 2 个编程为输入的 gpio(<em class="km">传感器</em>)。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/37c2d4e72ec08e8642147173a7712642.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*RmkJKEuUTIQltF-X."/></div></figure><p id="0cd1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上面的框图显示了我们想要实现的目标</p><p id="c515" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下面的视频可以给出一些提示:</p><figure class="lx ly lz ma gt mb"><div class="bz fp l di"><div class="me mf l"/></div></figure><blockquote class="kn ko kp"><p id="f0f1" class="jn jo km jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">请注意，您将在这里学习的使用 Flask 的 Python WebServer 可以直接应用于任何 Linux/OS 机器，并对 Windows PCs 进行一些调整(不幸的是，这不是我的专业领域)。</p></blockquote><h1 id="d71e" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">2.安装 FLASK 并设置您的 RPi 服务器</h1><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/7d4a0a9e5ee58a50d30cbad5d85514e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/0*tmDBPaHp3kb9mEJr."/></div></figure><h2 id="c9d4" class="mh ku iq bd kv mi mj dn kz mk ml dp ld jy mm mn lh kc mo mp ll kg mq mr lp ms bi translated"><strong class="ak">砂箱安装</strong></h2><p id="7ac5" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">首先要做的是在你的树莓派上安装 Flask。转到终端并输入:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="e272" class="mh ku iq mu b gy my mz l na nb">sudo apt-get install python3-flask</span></pre><p id="9cae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">当你开始一个新项目时，最好是创建一个文件夹来组织你的文件。例如:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="7387" class="mh ku iq mu b gy my mz l na nb">mkdir rpiWebServer</span></pre><p id="3a1e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上面的命令将创建一个名为“Server”的文件夹。我们将在那里保存我们的 python 文件(应用程序):</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="1416" class="mh ku iq mu b gy my mz l na nb">/home/pi/Documents/Server</span></pre><p id="1522" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这个文件夹中，让我们创建另外两个子文件夹:<em class="km">静态</em>用于 CSS 和最终的 JavaScript 文件，以及<em class="km">模板</em>用于 HTML 文件(或者更准确地说，Jinja2 模板。但是不要担心。转到您新创建的文件夹:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="6557" class="mh ku iq mu b gy my mz l na nb">cd rpiWebServer</span></pre><p id="8384" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">并创建两个新的子文件夹:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="027a" class="mh ku iq mu b gy my mz l na nb">mkdir static</span></pre><p id="7fe1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">和</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="62fd" class="mh ku iq mu b gy my mz l na nb">mkdir templates</span></pre><p id="ffe5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最终的文件夹“树”，看起来会像:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="0da9" class="mh ku iq mu b gy my mz l na nb">/rpiWebServer<br/>    /static<br/>    /templates</span></pre><h2 id="9e9b" class="mh ku iq bd kv mi mj dn kz mk ml dp ld jy mm mn lh kc mo mp ll kg mq mr lp ms bi translated">Python 服务器应用程序</h2><p id="ec19" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">现在，让我们用 Flask 创建我们的第一个 python 服务器:</p><ul class=""><li id="bc4a" class="nc nd iq jp b jq jr ju jv jy ne kc nf kg ng kk nh ni nj nk bi translated">打开你的 Python3 IDE，Thonny 或者 Geany。</li><li id="99fa" class="nc nd iq jp b jq nl ju nm jy nn kc no kg np kk nh ni nj nk bi translated">在您的 IDE 上复制下面的“Hello Word”代码，并将其保存为例如 helloWorld.py</li></ul><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="f558" class="mh ku iq mu b gy my mz l na nb">from flask import Flask<br/>app = Flask(__name__)<br/>@app.route('/')<br/>def index():<br/>    return 'Hello world'<br/>if __name__ == '__main__':<br/>    app.run(debug=True, port=80, host='0.0.0.0')</span></pre><p id="0dd8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上述代码的作用是:</p><p id="446f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">1.将 Flask 模块加载到 Python 脚本中:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="7599" class="mh ku iq mu b gy my mz l na nb">from flask import Flask</span></pre><p id="bf33" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.创建名为 app 的 Flask 对象:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="7f27" class="mh ku iq mu b gy my mz l na nb">app = Flask(__name__)</span></pre><p id="d8a0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.当有人访问服务器的根 URL ('/')时，运行 index()函数。在这种情况下，只发送文本“Hello World！”通过“返回”到客户的网络浏览器</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="3197" class="mh ku iq mu b gy my mz l na nb">def index():<br/>   return "Hello Word"</span></pre><p id="3e97" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.一旦这个脚本从命令行在终端上运行，服务器就开始“监听”端口 80，报告任何错误:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="7d15" class="mh ku iq mu b gy my mz l na nb">if __name__ == '__main__':<br/>   app.run(debug=True, port=80, host='0.0.0.0')</span></pre><h2 id="4a20" class="mh ku iq bd kv mi mj dn kz mk ml dp ld jy mm mn lh kc mo mp ll kg mq mr lp ms bi translated">Raspberry PI IP 地址:</h2><p id="f23e" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">如果您不确定您的 RPi IP 地址，请在您的终端上运行:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="5a81" class="mh ku iq mu b gy my mz l na nb">ifconfig</span></pre><p id="63ee" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在 wlan0: section 你会找到。就我而言:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="dceb" class="mh ku iq mu b gy my mz l na nb">10.0.1.27</span></pre><h2 id="1271" class="mh ku iq bd kv mi mj dn kz mk ml dp ld jy mm mn lh kc mo mp ll kg mq mr lp ms bi translated">运行应用程序</h2><p id="5f43" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">现在，运行上面的应用程序:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="5ce3" class="mh ku iq mu b gy my mz l na nb">sudo python3 helloWorld.py</span></pre><p id="8413" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在上面的第一张图片上，你可以看到终端上会出现什么。除非您键入[CTRL] + [C]，否则应用程序将会运行。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/16280f8c0e490ba565507d807abd44c9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*GK7n3PdgFCmnHNMW."/></div></figure><p id="100f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，你必须打开与你的树莓连接到同一个 wifi 网络的任何网络浏览器，并键入它的 IP 地址，如上面第二张图片所示。如上图所示,“Hello World”应该会出现在您的浏览器中。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/3c37a01a05208a28c45089660272aace.png" data-original-src="https://miro.medium.com/v2/resize:fit:1118/0*iRpAqg658EDbQORz."/></div></figure><p id="a1a1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意上图底部有 2 条线。这几行显示两个不同的 web 浏览器请求了根 URL，我们的服务器返回了 HTTP 状态代码 200 表示“OK”。我在 RPI 本身(10.1.0.27)和我的 Mac (10.1.0.10)上输入了我们的 RPi 服务器地址。对于每个新的请求，只要应用程序正在运行，终端就会出现一个新的行。</p><h1 id="c8a3" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">3.创建合适的服务器网页</h1><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/ea3cb0037d2bc29ffe3602eb95e11a76.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/0*mRkGrq7pVOR5L776."/></div></figure><p id="ffcc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们完善我们的“Hello World”应用程序，创建一个 HTML 模板和一个 CSS 文件来设计我们的页面。事实上，这是很重要的，否则，你将会使 Python 脚本变得复杂。</p><p id="999d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><strong class="jp ir">模板</strong></p><p id="713f" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">创建一个位于“模板”子文件夹中的 HTML 文件，我们可以使用单独的文件，在需要插入动态数据的地方放置占位符。</p><p id="2d6e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，我们将创建一个名为<em class="km">index.html</em>的文件，保存在<em class="km"> /templates </em>中。您可以使用任何文本编辑器来创建您的 HTML 文件。可以是 Geany、终端的“nano”或位于“附件”主菜单下的 RPi 文本编辑器(LeafPad)。</p><blockquote class="kn ko kp"><p id="5018" class="jn jo km jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">GEANY 可用于同时处理所有项目文件。py；。html 和。css)对于更大更复杂的项目来说，这是一个很好的选择</p></blockquote><p id="61c0" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">好了，让我们创建<em class="km"> /templates/index.html </em>:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="2d79" class="mh ku iq mu b gy my mz l na nb">&lt;!DOCTYPE html&gt;<br/>   &lt;head&gt;<br/>      &lt;title&gt;{{ title }}&lt;/title&gt;<br/>   &lt;/head&gt;<br/>   &lt;body&gt;<br/>      &lt;h1&gt;Hello, World!&lt;/h1&gt;<br/>      &lt;h2&gt;The date and time on the server is: {{ time }}&lt;/h2&gt;<br/>   &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><blockquote class="kn ko kp"><p id="29c7" class="jn jo km jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated"><em class="iq">注意，HTML 模板中的</em> <strong class="jp ir"> <em class="iq">双花括号</em> </strong> <em class="iq">中的任何内容都被解释为一个变量，该变量将通过 render_template 函数从 Python 脚本传递给它。</em></p></blockquote><p id="2877" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，让我们创建一个新的 Python 脚本。我们将把它命名为<em class="km"> helloWorldTemplate.py: </em></p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="cdb5" class="mh ku iq mu b gy my mz l na nb">'''<br/>Code created by Matt Richardson <br/>for details, visit:  http://mattrichardson.com/Raspberry-Pi-Flask/inde...<br/>'''<br/>from flask import Flask, render_template<br/>import datetime<br/>app = Flask(__name__)<br/>@app.route("/")<br/>def hello():<br/>   now = datetime.datetime.now()<br/>   timeString = now.strftime("%Y-%m-%d %H:%M")<br/>   templateData = {<br/>      'title' : 'HELLO!',<br/>      'time': timeString<br/>      }<br/>   return render_template('index.html', **templateData)<br/>if __name__ == "__main__":<br/>   app.run(host='0.0.0.0', port=80, debug=True)</span></pre><p id="3bda" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意，我们使用“now”对象中的日期和时间创建了一个格式化的<code class="fe nr ns nt mu b">string("timeString")</code>，其中存储了当前时间。</p><p id="11bf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在上面的代码中，下一件重要的事情是我们创建了一个变量字典(一组键，比如与值相关联的标题，比如 HELLO！)传递到模板中。在“返回”上，我们将使用<em class="km">模板数据</em>字典中的变量将<em class="km">index.html</em>模板返回到网络浏览器。</p><p id="835b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">执行 Python 脚本:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="2201" class="mh ku iq mu b gy my mz l na nb">sudo python3 helloWorldTemplate.py</span></pre><p id="4f4c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">打开任何网络浏览器，输入您的 RPi IP 地址。上图是结果。</p><blockquote class="kn ko kp"><p id="b79c" class="jn jo km jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated"><em class="iq">请注意，每当您使用 Python 脚本传递的实际变量数据刷新页面时，页面的内容都会发生动态变化。在我们的例子中，“标题”是一个固定值，但是“时间”每秒都在改变它。</em></p></blockquote><p id="345c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，让我们在页面上添加一些样式，创建一个 CSS 文件并将其存储在/static/style.css 上:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="3c82" class="mh ku iq mu b gy my mz l na nb">body {<br/>   background: blue;<br/>   color: yellow;<br/>}</span></pre><p id="8d38" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您还必须修改 index.html 文件，通知它查找 style.css 文件。您可以在“head”处插入“link”:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="7f3e" class="mh ku iq mu b gy my mz l na nb">&lt;!DOCTYPE html&gt;<br/>   &lt;head&gt;<br/>      &lt;title&gt;{{ title }}&lt;/title&gt;<br/>      &lt;link rel="stylesheet" href="../static/style.css/"&gt;<br/>   &lt;/head&gt;<br/>   &lt;body&gt;<br/>      &lt;h1&gt;Hello, World!&lt;/h1&gt;<br/>      &lt;h2&gt;The date and time on the server is: {{ time }}&lt;/h2&gt;<br/>   &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><blockquote class="kn ko kp"><p id="cf7f" class="jn jo km jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated"><em class="iq">记住，index.html 在“下”/template，style.css 在“下”/static，所以，注意，你必须告诉 HTML 再次“向上”和“向下”去寻找 static 子文件夹:../static/style . CSS .</em></p></blockquote><p id="6dd7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下图是新风格的网页！</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi lw"><img src="../Images/05a348c3de99c7d9f41007abe8c06578.png" data-original-src="https://miro.medium.com/v2/resize:fit:1360/0*TwWbjKIoijLsAoZl."/></div></figure><p id="a1f8" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">有关 Raspberry Pi 的更详细的 Flask 概述，请访问 Raspberry Pi 组织项目:<a class="ae kl" href="https://projects.raspberrypi.org/en/projects/python-web-server-with-flask" rel="noopener ugc nofollow" target="_blank">python-we b-server-with-Flask</a>。</p><h1 id="4219" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">4.硬件</h1><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi mg"><img src="../Images/7032e814660ac22e6de893db790408a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/0*OPue2X8su-KVLV2q."/></div></figure><p id="a988" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">硬件很简单。仅遵循上述电气连接。</p><h1 id="99a0" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">5.读取 GPIO 状态</h1><p id="29fc" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">现在让我们通过监控它们的 GPIOs 来读取我们的“传感器”的状态。</p><h2 id="2e11" class="mh ku iq bd kv mi mj dn kz mk ml dp ld jy mm mn lh kc mo mp ll kg mq mr lp ms bi translated"><strong class="ak">Python 脚本</strong></h2><p id="c857" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">让我们创建一个新的 Python 脚本，并将其命名为 app.py:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="dfb3" class="mh ku iq mu b gy my mz l na nb">'''<br/>	Raspberry Pi GPIO Status and Control<br/>'''<br/>import RPi.GPIO as GPIO<br/>from flask import Flask, render_template<br/>app = Flask(__name__)<br/>GPIO.setmode(GPIO.BCM)<br/>GPIO.setwarnings(False)<br/>button = 20<br/>senPIR = 16<br/>buttonSts = GPIO.LOW<br/>senPIRSts = GPIO.LOW<br/>   <br/># Set button and PIR sensor pins as an input<br/>GPIO.setup(button, GPIO.IN)   <br/>GPIO.setup(senPIR, GPIO.IN)<br/>	<br/>@app.route("/")<br/>def index():<br/>	# Read Sensors Status<br/>	buttonSts = GPIO.input(button)<br/>	senPIRSts = GPIO.input(senPIR)<br/>	templateData = {<br/>      'title' : 'GPIO input Status!',<br/>      'button'  : buttonSts,<br/>      'senPIR'  : senPIRSts<br/>      }<br/>	return render_template('index.html', **templateData)<br/>if __name__ == "__main__":<br/>   app.run(host='0.0.0.0', port=80, debug=True)</span></pre><p id="6684" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">注意，我们所做的只是将 GIPOs 20 和 16 定义为输入，读取其值并将其存储在两个变量上:buttonSts 和<em class="km"> senPIRSts。</em>在函数 index()中，我们将通过变量字典中的“button”和“senPIR”变量将这些值传递给我们的网页:<em class="km"> templateData。</em></p><p id="2d5c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="km">创建 app.py 后，在终端上运行它:</em></p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="c0f0" class="mh ku iq mu b gy my mz l na nb">python3 app.py</span></pre><h2 id="2083" class="mh ku iq bd kv mi mj dn kz mk ml dp ld jy mm mn lh kc mo mp ll kg mq mr lp ms bi translated"><strong class="ak">模板</strong></h2><p id="c60e" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">我们还创建一个新的 index.html 来显示两个传感器的 GPIO 状态:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="cc53" class="mh ku iq mu b gy my mz l na nb">&lt;!DOCTYPE html&gt;<br/>   &lt;head&gt;<br/>      &lt;title&gt;{{ title }}&lt;/title&gt;<br/>      &lt;link rel="stylesheet" href='../static/style.css'/&gt;<br/>   &lt;/head&gt;<br/>   &lt;body&gt;<br/>	  &lt;h1&gt;{{ title }}&lt;/h1&gt;<br/>      &lt;h2&gt;Button pressed:  {{ button }}&lt;/h1&gt;<br/>      &lt;h2&gt;Motion detected: {{ senPIR }}&lt;/h2&gt;<br/>   &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><blockquote class="kn ko kp"><p id="1ee7" class="jn jo km jp b jq jr js jt ju jv jw jx kq jz ka kb kr kd ke kf ks kh ki kj kk ij bi translated">不要忘记刷新页面以查看结果。</p></blockquote><p id="6caf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">按下按钮或在 PIR 传感器前移动并刷新页面。</p><p id="ec88" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">图为网页。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/898f856540f5dc1dd847c0a718a2b440.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/0*m7akTt8QXPv-Us18."/></div></figure><h1 id="3152" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">6.控制 GPIOs</h1><p id="a702" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">现在我们知道了如何“读取”GPIO 状态，让我们来改变它们。我们要做的是通过网页“命令”这些“致动器”。我们有 3 个 led 连接到树莓 GPIOs。远程命令他们，我们将改变他们的地位从低到高，反之亦然。例如，我们可以用继电器代替发光二极管来控制你房间的灯和/或风扇。</p><h2 id="a12b" class="mh ku iq bd kv mi mj dn kz mk ml dp ld jy mm mn lh kc mo mp ll kg mq mr lp ms bi translated"><strong class="ak">python 脚本</strong></h2><p id="f1e3" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">让我们创建一个新的 Python 脚本，并将其命名为 app.py:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="ffb5" class="mh ku iq mu b gy my mz l na nb">'''<br/>	Raspberry Pi GPIO Status and Control<br/>'''<br/>import RPi.GPIO as GPIO<br/>from flask import Flask, render_template, request<br/>app = Flask(__name__)<br/>GPIO.setmode(GPIO.BCM)<br/>GPIO.setwarnings(False)<br/>#define actuators GPIOs<br/>ledRed = 13<br/>ledYlw = 19<br/>ledGrn = 26<br/>#initialize GPIO status variables<br/>ledRedSts = 0<br/>ledYlwSts = 0<br/>ledGrnSts = 0<br/># Define led pins as output<br/>GPIO.setup(ledRed, GPIO.OUT)   <br/>GPIO.setup(ledYlw, GPIO.OUT) <br/>GPIO.setup(ledGrn, GPIO.OUT) <br/># turn leds OFF <br/>GPIO.output(ledRed, GPIO.LOW)<br/>GPIO.output(ledYlw, GPIO.LOW)<br/>GPIO.output(ledGrn, GPIO.LOW)<br/>	<br/>@app.route("/")<br/>def index():<br/>	# Read Sensors Status<br/>	ledRedSts = GPIO.input(ledRed)<br/>	ledYlwSts = GPIO.input(ledYlw)<br/>	ledGrnSts = GPIO.input(ledGrn)<br/>	templateData = {<br/>              'title' : 'GPIO output Status!',<br/>              'ledRed'  : ledRedSts,<br/>              'ledYlw'  : ledYlwSts,<br/>              'ledGrn'  : ledGrnSts,<br/>        }<br/>	return render_template('index.html', **templateData)<br/>	<br/>@app.route("/&lt;deviceName&gt;/&lt;action&gt;")<br/>def action(deviceName, action):<br/>	if deviceName == 'ledRed':<br/>		actuator = ledRed<br/>	if deviceName == 'ledYlw':<br/>		actuator = ledYlw<br/>	if deviceName == 'ledGrn':<br/>		actuator = ledGrn<br/>   <br/>	if action == "on":<br/>		GPIO.output(actuator, GPIO.HIGH)<br/>	if action == "off":<br/>		GPIO.output(actuator, GPIO.LOW)<br/>		     <br/>	ledRedSts = GPIO.input(ledRed)<br/>	ledYlwSts = GPIO.input(ledYlw)<br/>	ledGrnSts = GPIO.input(ledGrn)<br/>   <br/>	templateData = {<br/>              'ledRed'  : ledRedSts,<br/>              'ledYlw'  : ledYlwSts,<br/>              'ledGrn'  : ledGrnSts,<br/>	}<br/>	return render_template('index.html', **templateData)<br/>if __name__ == "__main__":<br/>   app.run(host='0.0.0.0', port=80, debug=True)</span></pre><p id="9437" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们在上述代码中的新内容是新的“路线”:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="5c36" class="mh ku iq mu b gy my mz l na nb">@app.route("/&lt;deviceName&gt;/&lt;action&gt;")</span></pre><p id="0503" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在网页上，呼叫将按照以下格式生成:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="cd42" class="mh ku iq mu b gy my mz l na nb"><a class="ae kl" href="http://10.0.1.27/ledRed/on" rel="noopener ugc nofollow" target="_blank">http://10.0.1.27/ledRed/on</a></span></pre><p id="8a70" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">或者</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="30a9" class="mh ku iq mu b gy my mz l na nb"><a class="ae kl" href="http://10.0.1.27/ledRed/off" rel="noopener ugc nofollow" target="_blank">http://10.0.1.27/ledRed/off</a></span></pre><p id="36bb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">对于上面的例子，<em class="km"> ledRed </em>是“设备名称”，而<em class="km"> on </em>或<em class="km"> off </em>是可能的“动作”的例子。</p><p id="6fe7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这些路线将被识别并适当地“工作”。主要步骤是:</p><ul class=""><li id="bc82" class="nc nd iq jp b jq jr ju jv jy ne kc nf kg ng kk nh ni nj nk bi translated">例如，在其等效的 GPIO 引脚上转换字符串“ledRED”。整数变量 ledRed 相当于 GPIO13。我们将把这个值存储在变量“执行器”上</li><li id="0879" class="nc nd iq jp b jq nl ju nm jy nn kc no kg np kk nh ni nj nk bi translated">对于每个致动器，我们将分析“动作”，或“命令”并正确地动作。例如，如果“action = on ”,我们必须使用命令:GPIO.output(actuator，GPIO。高)</li><li id="a46b" class="nc nd iq jp b jq nl ju nm jy nn kc no kg np kk nh ni nj nk bi translated">更新每个执行器的状态</li><li id="4587" class="nc nd iq jp b jq nl ju nm jy nn kc no kg np kk nh ni nj nk bi translated">更新变量库</li><li id="931a" class="nc nd iq jp b jq nl ju nm jy nn kc no kg np kk nh ni nj nk bi translated">把数据还给 index.html</li></ul><h2 id="3cab" class="mh ku iq bd kv mi mj dn kz mk ml dp ld jy mm mn lh kc mo mp ll kg mq mr lp ms bi translated"><strong class="ak">模板</strong></h2><p id="0efe" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">现在让我们创建一个 index.html 来显示每个执行器的 GPIO 状态，更重要的是，创建“按钮”来发送命令:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="3982" class="mh ku iq mu b gy my mz l na nb">&lt;!DOCTYPE html&gt;<br/>   &lt;head&gt;<br/>      &lt;title&gt;GPIO Control&lt;/title&gt;<br/>      &lt;link rel="stylesheet" href='../static/style.css'/&gt;<br/>   &lt;/head&gt;<br/>   &lt;body&gt;<br/>		&lt;h1&gt;Actuators&lt;/h1&gt;<br/>		&lt;h2&gt; Status &lt;/h2&gt;<br/>		&lt;h3&gt; RED LED ==&gt;  {{ ledRed  }}&lt;/h3&gt;<br/>		&lt;h3&gt; YLW LED ==&gt;  {{ ledYlw  }}&lt;/h3&gt;<br/>		&lt;h3&gt; GRN LED ==&gt;  {{ ledGrn  }}&lt;/h3&gt;<br/>		&lt;br&gt;<br/>		&lt;h2&gt; Commands &lt;/h2&gt;<br/>		&lt;h3&gt; <br/>			RED LED Ctrl ==&gt; <br/>			&lt;a href="/ledRed/on" class="button"&gt;TURN ON&lt;/a&gt;  <br/>			&lt;a href="/ledRed/off"class="button"&gt;TURN OFF&lt;/a&gt;<br/>		&lt;/h3&gt;<br/>		&lt;h3&gt; <br/>			YLW LED Ctrl ==&gt; <br/>			&lt;a href="/ledYlw/on" class="button"&gt;TURN ON&lt;/a&gt;  <br/>			&lt;a href="/ledYlw/off"class="button"&gt;TURN OFF&lt;/a&gt;<br/>		&lt;/h3&gt;<br/>		&lt;h3&gt; <br/>			GRN LED Ctrl ==&gt; <br/>			&lt;a href="/ledGrn/on" class="button"&gt;TURN ON&lt;/a&gt;  <br/>			&lt;a href="/ledGrn/off"class="button"&gt;TURN OFF&lt;/a&gt;<br/>		&lt;/h3&gt;<br/>		<br/>   &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="3b73" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">只为了给一个更好的“伏”，我创建了一个类“按钮”。如果你愿意，你只能保留正常链接。</p><p id="fdcf" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在 style.css 文件下:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="c5f3" class="mh ku iq mu b gy my mz l na nb">body {<br/>	background: blue;<br/>	color: yellow;<br/>}<br/>.button {<br/>  font: bold 15px Arial;<br/>  text-decoration: none;<br/>  background-color: #EEEEEE;<br/>  color: #333333;<br/>  padding: 2px 6px 2px 6px;<br/>  border-top: 1px solid #CCCCCC;<br/>  border-right: 1px solid #333333;<br/>  border-bottom: 1px solid #333333;<br/>  border-left: 1px solid #CCCCCC;<br/>}</span></pre><p id="0697" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">图为控制我们的执行器的网站。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/8c8f5d6a3b1f92f7156b1fa2237cb01c.png" data-original-src="https://miro.medium.com/v2/resize:fit:848/0*CjdtrqNi7xiwLtOj."/></div></figure><h1 id="d88e" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">7.集成传感器和执行器</h1><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/aa4179cb25e278cdebab975cdb2a69cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/0*ctD4T2GpDX__E9O0."/></div></figure><p id="bd81" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在，我们必须将之前开发的两个部分放在一起。最终的 Python 脚本如下所示:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="447d" class="mh ku iq mu b gy my mz l na nb">'''<br/>	Raspberry Pi GPIO Status and Control<br/>'''<br/>import RPi.GPIO as GPIO<br/>from flask import Flask, render_template, request<br/>app = Flask(__name__)<br/>GPIO.setmode(GPIO.BCM)<br/>GPIO.setwarnings(False)<br/>#define sensors GPIOs<br/>button = 20<br/>senPIR = 16<br/>#define actuators GPIOs<br/>ledRed = 13<br/>ledYlw = 19<br/>ledGrn = 26<br/>#initialize GPIO status variables<br/>buttonSts = 0<br/>senPIRSts = 0<br/>ledRedSts = 0<br/>ledYlwSts = 0<br/>ledGrnSts = 0<br/># Define button and PIR sensor pins as an input<br/>GPIO.setup(button, GPIO.IN)   <br/>GPIO.setup(senPIR, GPIO.IN)<br/># Define led pins as output<br/>GPIO.setup(ledRed, GPIO.OUT)   <br/>GPIO.setup(ledYlw, GPIO.OUT) <br/>GPIO.setup(ledGrn, GPIO.OUT) <br/># turn leds OFF <br/>GPIO.output(ledRed, GPIO.LOW)<br/>GPIO.output(ledYlw, GPIO.LOW)<br/>GPIO.output(ledGrn, GPIO.LOW)<br/>	<br/>@app.route("/")<br/>def index():<br/>	# Read GPIO Status<br/>	buttonSts = GPIO.input(button)<br/>	senPIRSts = GPIO.input(senPIR)<br/>	ledRedSts = GPIO.input(ledRed)<br/>	ledYlwSts = GPIO.input(ledYlw)<br/>	ledGrnSts = GPIO.input(ledGrn)<br/>	templateData = {<br/>      		'button'  : buttonSts,<br/>      		'senPIR'  : senPIRSts,<br/>      		'ledRed'  : ledRedSts,<br/>      		'ledYlw'  : ledYlwSts,<br/>      		'ledGrn'  : ledGrnSts,<br/>      	}<br/>	return render_template('index.html', **templateData)<br/>	<br/>@app.route("/&lt;deviceName&gt;/&lt;action&gt;")<br/>def action(deviceName, action):<br/>	if deviceName == 'ledRed':<br/>		actuator = ledRed<br/>	if deviceName == 'ledYlw':<br/>		actuator = ledYlw<br/>	if deviceName == 'ledGrn':<br/>		actuator = ledGrn<br/>   <br/>	if action == "on":<br/>		GPIO.output(actuator, GPIO.HIGH)<br/>	if action == "off":<br/>		GPIO.output(actuator, GPIO.LOW)<br/>		     <br/>	buttonSts = GPIO.input(button)<br/>	senPIRSts = GPIO.input(senPIR)<br/>	ledRedSts = GPIO.input(ledRed)<br/>	ledYlwSts = GPIO.input(ledYlw)<br/>	ledGrnSts = GPIO.input(ledGrn)<br/>   <br/>	templateData = {<br/>	 	'button'  : buttonSts,<br/>      		'senPIR'  : senPIRSts,<br/>      		'ledRed'  : ledRedSts,<br/>      		'ledYlw'  : ledYlwSts,<br/>      		'ledGrn'  : ledGrnSts,<br/>	}<br/>	return render_template('index.html', **templateData)<br/>if __name__ == "__main__":<br/>   app.run(host='0.0.0.0', port=80, debug=True)</span></pre><p id="f8bd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">最后的 index.html:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="5c71" class="mh ku iq mu b gy my mz l na nb">&lt;!DOCTYPE html&gt;<br/>   &lt;head&gt;<br/>      &lt;title&gt;GPIO Control&lt;/title&gt;<br/>      &lt;link rel="stylesheet" href='../static/master.css'/&gt;<br/>   &lt;/head&gt;<br/>   &lt;body&gt;<br/>		&lt;h1&gt;RPi GPIO Control&lt;/h1&gt;<br/>		&lt;h2&gt; Sensor Status &lt;/h2&gt;<br/>		&lt;h3&gt; BUTTON ==&gt;  {{ button  }}&lt;/h3&gt;<br/>		&lt;h3&gt; MOTION ==&gt;  {{ senPIR  }}&lt;/h3&gt;<br/>		&lt;br&gt;<br/>		<br/>		&lt;h2&gt; Actuator Status &lt;/h2&gt;<br/>		&lt;h3&gt; RED LED ==&gt;  {{ ledRed  }}&lt;/h3&gt;<br/>		&lt;h3&gt; YLW LED ==&gt;  {{ ledYlw  }}&lt;/h3&gt;<br/>		&lt;h3&gt; GRN LED ==&gt;  {{ ledGrn  }}&lt;/h3&gt;<br/>		&lt;br&gt;<br/>		&lt;h2&gt; Commands &lt;/h2&gt;<br/>		&lt;h3&gt; <br/>			RED LED Ctrl ==&gt; <br/>			&lt;a href="/ledRed/on" class="button"&gt;TURN ON&lt;/a&gt;  <br/>			&lt;a href="/ledRed/off"class="button"&gt;TURN OFF&lt;/a&gt;<br/>		&lt;/h3&gt;<br/>		&lt;h3&gt; <br/>			YLW LED Ctrl ==&gt; <br/>			&lt;a href="/ledYlw/on" class="button"&gt;TURN ON&lt;/a&gt;  <br/>			&lt;a href="/ledYlw/off"class="button"&gt;TURN OFF&lt;/a&gt;<br/>		&lt;/h3&gt;<br/>		&lt;h3&gt; <br/>			GRN LED Ctrl ==&gt; <br/>			&lt;a href="/ledGrn/on" class="button"&gt;TURN ON&lt;/a&gt;  <br/>			&lt;a href="/ledGrn/off"class="button"&gt;TURN OFF&lt;/a&gt;<br/>		&lt;/h3&gt;<br/>		<br/>   &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="8377" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">图为最终的网页。</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi nx"><img src="../Images/547560eeccaa83d9ada31dae3c4ee80e.png" data-original-src="https://miro.medium.com/v2/resize:fit:656/0*X-E1n7A7MG7aP5R9."/></div></figure><h1 id="6c21" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">8.使用模板更进一步</h1><p id="bc71" class="pw-post-body-paragraph jn jo iq jp b jq lr js jt ju ls jw jx jy lt ka kb kc lu ke kf kg lv ki kj kk ij bi translated">正如我们之前简单讨论过的，<em class="km"> render_template()函数</em>调用与 Flask 框架捆绑在一起的<em class="km"> Jinja2 模板</em>引擎。Jinja2 用 render_template()调用中提供的参数给出的相应值替换{{ … }}块。</p><p id="31eb" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">但这并不仅仅是 Jinja2 能做的。例如，模板也支持在{% … %}块中给出的控制语句。我们可以改变我们的 index.html 模板，以便添加条件语句，根据执行器的实际值来部署特定的按钮。换句话说，“切换”致动器状态。让我们用条件语句重写 index.html 的状态和命令部分:</p><pre class="lx ly lz ma gt mt mu mv mw aw mx bi"><span id="a261" class="mh ku iq mu b gy my mz l na nb">&lt;!DOCTYPE html&gt; <br/>  &lt;head&gt; <br/>     &lt;title&gt;GPIO Control&lt;/title&gt; <br/>     &lt;link rel="stylesheet" href='../static/master.css'/&gt; <br/>  &lt;/head&gt; <br/>  &lt;body&gt; <br/>		&lt;h1&gt;RPi GPIO Control&lt;/h1&gt; <br/>		&lt;h2&gt; Sensor Status &lt;/h2&gt; <br/>		&lt;h3&gt; BUTTON ==&gt;  {{ button  }}&lt;/h3&gt; <br/>		&lt;h3&gt; MOTION ==&gt;  {{ senPIR  }}&lt;/h3&gt; <br/>		&lt;br&gt; <br/>		&lt;h2&gt; Actuator Status &amp; Control &lt;/h2&gt; <br/>		&lt;h3&gt; RED LED ==&gt;  {{ ledRed  }}  ==&gt;   <br/>			{% if  ledRed   == 1 %} <br/>				&lt;a href="/ledRed/off"class="button"&gt;TURN OFF&lt;/a&gt; <br/>			{% else %} <br/>				&lt;a href="/ledRed/on" class="button"&gt;TURN ON&lt;/a&gt;  <br/>			{% endif %}	 <br/>		&lt;/h3&gt; <br/>		&lt;h3&gt; YLW LED ==&gt;  {{ ledYlw  }}  ==&gt;   <br/>			{% if  ledYlw   == 1 %} <br/>				&lt;a href="/ledYlw/off"class="button"&gt;TURN OFF&lt;/a&gt; <br/>			{% else %} <br/>				&lt;a href="/ledYlw/on" class="button"&gt;TURN ON&lt;/a&gt;  <br/>			{% endif %}	 <br/>		&lt;/h3&gt; <br/>		&lt;h3&gt; GRN LED ==&gt;  {{ ledGrn  }}  ==&gt;   <br/>			{% if  ledGrn   == 1 %} <br/>				&lt;a href="/ledGrn/off"class="button"&gt;TURN OFF&lt;/a&gt; <br/>			{% else %} <br/>				&lt;a href="/ledGrn/on" class="button"&gt;TURN ON&lt;/a&gt;  <br/>			{% endif %}	 <br/>		&lt;/h3&gt; <br/>  &lt;/body&gt; <br/>&lt;/html&gt;</span></pre><p id="9056" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下图显示了结果:</p><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/d073e52c74caaec99629a68b81d89a64.png" data-original-src="https://miro.medium.com/v2/resize:fit:678/0*ljOc0-LJehONMVey."/></div></figure><p id="4383" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这只是 Python 和 Flask 所能做的一小部分。如果你真的想深入了解 Flask，你可以跟随 Miguel Grimberg 的伟大教程:<a class="ae kl" href="https://blog.miguelgrinberg.com/post/the-flask-mega-tutorial-part-i-hello-world" rel="noopener ugc nofollow" target="_blank">Flask Mega 教程，</a></p><h1 id="7510" class="kt ku iq bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">9.结论</h1><figure class="lx ly lz ma gt mb gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/bdacf29fe7726a43f92de15ecb214668.png" data-original-src="https://miro.medium.com/v2/resize:fit:886/0*PYI7pJ5dtGwJRd8R."/></div></figure><p id="bfb1" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">一如既往，我希望这个项目可以帮助其他人找到进入令人兴奋的电子世界的方法！</p><p id="8810" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">详情和最终代码，请访问我的 GitHub 仓库:<a class="ae kl" href="https://github.com/Mjrovai/RPi-Flask-WebServer" rel="noopener ugc nofollow" target="_blank"> RPi-Flask-WebServer </a></p><p id="2d57" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">而要学习如何处理数据、图形、数据库，也可以看我的教程:<a class="ae kl" href="https://www.hackster.io/mjrobot/from-data-to-graph-a-web-jorney-with-flask-and-sqlite-4dba35" rel="noopener ugc nofollow" target="_blank">从数据到图形。带烧瓶和 SQLite 的 Web Jorney</a></p><p id="1313" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">更多项目，请访问我的博客:【MJRoBot.org T2】</p><p id="cd9e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">来自世界南部的 Saludos！</p><p id="0048" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">下节课再见！</p><p id="ecf9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">谢谢你，</p><p id="e24e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">马塞洛</p></div></div>    
</body>
</html>