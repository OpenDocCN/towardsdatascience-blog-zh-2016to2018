# 用同音异义词和单词向量来扫“不能”的兴

> 原文：<https://towardsdatascience.com/canning-the-cant-fun-with-homonyms-and-word-vectors-179ab58c76d2?source=collection_archive---------8----------------------->

XYZ 派高级 NLU 工程师亚历山大·维考特伦。

作为一家专门从事自然语言理解的公司，单词嵌入是我们技术的组成部分之一。我们的 NLU 模型需要能够正确“理解”所写或所说的内容。一种方法是使用意图分类模型:当用户输入一个句子时，该模型预测一个意图。因此，准确的意图分类对于交互的顺利进行至关重要。虽然我们的模型是我们所知道的最准确的，但有时分类会出错，偶尔这会导致有趣的对话。最近，一个基于我们的 NLU 模型的聊天机器人未能识别用户的诙谐讽刺，并以下面的被动-主动方式做出回应:

> *用户:谢谢你没有回答，天才。机器人:不客气！*

这句话被误认为是“谢谢”的意思，对此机器人非常礼貌地给出了正确的回答。我们发现的许多错误分类都可以追溯到我们使用的单词嵌入和它们被创建的方式。

有几种训练单词嵌入的方法，但大多数方法的共同点是，单词嵌入的整个概念都是基于这样一种想法:*词汇语义是分布式的*:意思相似的单词出现在相似的上下文中，相似的上下文包含相似的单词。

> “从一个人交的朋友就可以知道他说了什么！”，约翰·鲁珀特·弗斯— 语言学理论概要

但这真的足够了吗？只看上下文就能得到一个词的全部意思吗？语境是什么意思？哪里出了问题？通过在这里分享这些问题，我希望人类语言的奇妙复杂性能给你带来和给我一样的惊奇感。

## 将上下文放入单词中。

简单地说，经典的 word2vec 单词嵌入将单词表示为它们可能出现的上下文的平均值。一个词出现的“语境”可以在不同的层面上描述。你可以谈论一个单词的**句法环境**。例如，一些单词有不同的词性，因此也有不同的意思，这取决于它们出现的句法环境。

> 我非常努力地工作，因为我热爱我的工作。

第一次出现的 *work* 是动词，表示动作。另一方面，第二次出现是一个名词，表示一项活动。虽然我们可以同意这两个词在许多方面是相似的——它们是同音异义词，有着相同的词根*作品*——但它们在意思上是不同的。然而，它们将有一个单一的向量表示，总结了这些单词和它们可能出现的上下文。
让我们看另一个例子:

> 厨房地板上有咖啡*。请给我来一杯咖啡。*

在这里， *coffee* 的两个出现都是名词，但是它们的含义因出现的上下文而不同。在第一句话中， *coffee* 指代一种物质，它是一个物质名词，而在第二句话中， *coffee* 指代一杯黑金。我们怎么知道？句法环境。不定限定词“a”的出现表明*咖啡*的出现是可数的，因此我们自动推断应该有一个杯子。然而，你不能对所有单词都这样做。无论你把哪个限定词放在前面，沙子都是不可数的。所以，是的，语义是分布式的，从某种意义上说，单词的意义取决于它们出现的上下文，单词不能出现在特定的上下文中，因为它们的意义不允许它出现。

![](img/45899329ada531b3bdae800cb67f063e.png)

同样，语义语境也可以“改变”一个单词的意思。看看下面的例子。

> *低音*低音*演奏了*低音*。*

bass 的两个实例都是名词，前面都有相同的限定词，但它们显然有不同的意思。我们面对的是一条渴望音乐的鱼。我们怎么知道？嗯，只有*贝司*能弹，*贝司*不能。注意，尽管句法语境(更具体地说是词序和主客体关系)有助于我们解释*低音*的每次出现，但主要是 played 的语义与*低音*的语义相互作用，这有助于我们消除含义的歧义。在下面的例子中，我们切换了主客体关系和词序，但由于 played 的存在，我们仍然得到了相同的两种低音解释:

> *由*贝斯*演奏*贝斯*。(等等…也许贝司终究是可以弹的…做鱼的戏码！)*

最后，我们有**语用语境。**语用学指的是语言的使用，很多人性在这里发挥作用。人类使用语言的目的多种多样，不仅是为了传递思想和信息，也是为了让别人做事情。人类使用一种语言的不同变体来显示他们在社会群体中的包容性或遵守某些社会规则。与我们这里的讨论最相关的是*寄存器*的作用。在不同的社会背景下，我们倾向于使用不同的语言。差异可能在发音上(*我不知道*对*我不知道*)，也可能在我们选择使用的词汇上。我们可以请朋友*给我们拿杯咖啡*(在杯子里)，但我们很可能会请同事*给我们拿杯咖啡*。完全相同的语法，相同的语义，甚至相同的意图(我懒得去买咖啡，所以我希望你不要明确告诉你该做什么，因为我重视我们的关系和我们生活的社会规则，规定我们要有礼貌，因此使用问题而不是命令来保持良好的关系)。不过，背景不同。不是语言学，而是语用学。

## 你能像罐头工人一样装罐头吗？

原因之一(还有很多，单词嵌入很牛逼！)为什么单词嵌入如此受欢迎是因为它们允许我们计算单词相似度。如上所述，相似的单词可以出现在相似的上下文中，所以假设单词向量代表单词可以出现的平均上下文，我们期望相似的单词具有相似的单词向量。然而，就像上下文一样，单词相似性可以指代多个概念。
单词“相似”到底是什么意思？单词可以在很多方面相似:它们可以有相同的**拼写** ( *地址*和*地址*)或者相同或相似的**发音** ( *太*和*两个*)。话可以相似的是有同一个**根** : *罐*，*罐*和*罐*有同一个根*罐*，但是*罐*没有，它有另一个根*罐*。记得呼吸，别搞混了。

单词也可以有相同的**词性** : work 和 sing 相似之处在于都是动词，work 和 song 相似之处在于都是名词(而 work 和 work 相似之处在于都有相同的词根 work)。

最后，单词可以有相同或相似的**含义**。不过还是那句话，意思差不多是什么意思？两个词的意思可以是相似的，因为它们指的是同一本体**类**的实体，例如*苹果*和*牛排*都指的是可食用对象类的实体。*苹果*和*梨*甚至有更相似的意思，因为它们不仅都指可食用物类中的实体，而且还指水果类中的实体，甚至更严格地说，指梨子类。然而，当谈到相似的词时，大多数人会想到同义词或近义词:指同一实体、动作或概念的词。单词嵌入不会。他们想到几种相似性，并把它们混合在一起。

## 适者生存。

正如我上面提到的，单词向量代表它们出现的上下文的平均值。我们将一个巨大的语料库输入到一个智能算法中，我们得到了语料库中单词的一系列数字表示。相似的向量代表相似的单词，因为它们出现在相似的上下文中。

由于单词-上下文相互作用的复杂性，向量相似性不会总是代表我们所追求的相似性类型。例如，其中一个与*的向量最相似的词可以*，是*不能*(检查你最喜欢的词向量！).我想我们都同意，这两个词的意思并不完全相同，那么为什么它们的向量如此相似呢？实际上很简单:两个单词都可能出现的上下文的一个方面比其他方面有更大的权重，这将决定它们向量的形状。在这种情况下，**句法环境**胜出。*可以*和*不可以*都只能出现在一组非常有限的语法上下文中。作为助动词，它们只能出现在其他助动词或词汇动词之前的位置，或者在句子是疑问句的情况下出现在句子的开头。此外，它们糟糕的语义内容使得 *can* 和 *cannot* 都与大量的动词和名词兼容，所以它可以出现的语义上下文是非常不确定的。因此，这些词的向量将主要代表它们的句法分布，并且从词向量的角度来看，它们将非常类似于具有相同句法分布和较差语义内容的词，例如所有其他助动词。can 中否定的存在没有足够的权重来补偿 *can* 和*can*之间的句法相似性。幸运的是，有一些方法可以确保考虑到非常相关的语义差异，例如通过使用硬编码的**否定提取器**，它可以识别否定元素，如 *no* ，以及 *un-* 和 *anti* -。自从我们开始使用这样的否定提取器，我们的机器人变得不那么自大了。
句法语境决定了所有虚词的向量表示，如*限定词、数词、介词*和*代词*。它们的语义内容只是不够强，不足以体现在它们的向量表示中，并且它们的句法分布是如此受限制，以至于单词向量将基本上表示它们经常出现的句法上下文。

另一种情况是当**语用语境**具有最大权重时。如果你在 [fastText](https://github.com/facebookresearch/fastText/blob/master/pretrained-vectors.md) 预训练词向量中查找与 *nope* 最相似的词，你会注意到前十名包含了大量在非正式语域中频繁使用的短词，如*反正*、 *fwiw* 、 *yeah* 和 *hmmm* 。同样，这些词几乎没有语义内容。它们在句法上也是相当独立的(它们可以是独立的“句子”)。这就给语用学留下了空间来确定它们的分布，而这将在它们的词向量中表现出来。

**语义语境**到底有没有影响？当然有！尤其是那些具有强烈的、专门的、语义内容的、相当自由的句法分布的、与任何语域都没有语用联系的词。许多名词、动词和形容词都是如此。与*怒*最相似的词是 a.o. *怒*、*怒*、*怒*，是同义词。然而，单词的语义内容越一般，因此它可以出现的语义上下文的种类越多，其单词向量中的语义表示就越“一般”。就拿 *make* 来说吧，它的前十名里有 *create* ，还有 *give* 、 *bring* 和 *get* ，这些和 *make* 一样，都是有多重含义的动词，取决于它们出现的语境(*我造的*！vs. *我做了个煎蛋*。所以显然*制造*的平均意义(不管那是什么意思)和*给予*的平均意义相似。由词向量表示的语义相似性通常是类相似性。*杏*类似于*李子*和*梨*因为它们出现在水果环境中，而*流感*类似于*登革热*和*麻疹*因为它们出现在发烧环境中。

## 现实与可能性的差异。

那么为什么在寻找相似向量时很少会弹出同义词呢？并不是因为两个词可以出现在同一个语境中，它们才会出现。同义词之间往往有所不同，因为其中一个词经常与另一个词一起使用。想想我们亲爱的朋友贝斯。最相似的词是*吉他*，前十名中没有鱼，可能是因为我们不像谈论乐器那样经常谈论鱼。另一个原因是，单词很少在所有上下文中都是同义词:*方言*和*变体*在谈论语言学时可以互换使用，但这是唯一可能的上下文。*变体*可以出现在如此多的其他语境中，这些语境会将词向量拉向某个方向，远离*方言*。在一种语言的所有变体中，同义词并不总是同义词。 *Verlof* (假日或休假)在佛兰德荷兰语中是 *vakantie* (假日)的同义词，但在来自荷兰的荷兰语中不是。最后，在某些语域中，同义词是首选的。 *Bro* 是 *friend* 的同义词，但不是和老板说话的时候。很明显，使用单词向量来寻找同义词不是一个好主意。尽管有一些替代的方法来构建一个好的**同义词提示器**。这一次，您可以利用内置的同义词库，并使用单词预测技术来预测哪个候选同义词最有可能出现在给定的上下文中。无论如何，一个经验法则是，你需要考虑具体的上下文，因为两个词是否是同义词，往往取决于它们出现的上下文。

## 一般的结论。

单词向量代表单词的平均上下文。语境的所有方面:句法、语义和语用。如果一个方面比另一个方面具有更大的权重，这将在单词向量表示中可见。如果一个单词在一个上下文中比在另一个上下文中出现得更频繁，这将在单词向量表示中可见。如果一个单词以它的一种含义更频繁地出现，这将在单词向量表示中可见。所以如果你想用词向量来计算相似度，要当心**相似度复杂度**。
尽管词向量在许多方面非常有用，并让我们在 NLU 取得了巨大的进步，但它们是基于一种相当简单的语言方法(我们必须从某个地方开始……)。语言中有如此多的微妙之处，人类凭直觉就能理解，甚至不用思考就能应付。我们能够推断出许多甚至没有用语言表达的意思，仅仅基于我们使用语言的语境，或者我们对与我们互动的人的了解和关系，以及许多其他因素。所以让我们继续努力，处理好单词向量的缺点，因为有一天**我想要一个宠物机器人。**有什么改进的办法吗？取得联系！

*原载于 2018 年 3 月 20 日*[*www . paintity . XYZ*](https://www.faction.xyz/canning-the-canner-fun-with-homonyms-and-word-vectors/)*。*