<html>
<head>
<title>Plain and Simple Estimators</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">简单估计量</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/plain-and-simple-estimators-d8d3f4c185c1?source=collection_archive---------2-----------------------#2017-09-07">https://towardsdatascience.com/plain-and-simple-estimators-d8d3f4c185c1?source=collection_archive---------2-----------------------#2017-09-07</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="37e9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">机器学习很棒，除非它强迫你做高等数学。机器学习的工具变得越来越好，训练你自己的模型变得前所未有的简单。</p><p id="44f3" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们将利用我们对数据集的理解，而不是对原始数学的理解来编写一个模型，让我们获得洞察力。</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="kq kr l"/></div></figure><p id="4b40" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在这一集里，我们将只用几行代码来训练一个简单的分类器。以下是我们今天要看的所有代码:</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="ks kr l"/></div></figure></div><div class="ab cl kt ku hu kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ij ik il im in"><h1 id="e649" class="la lb iq bd lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx bi translated">机器学习的张量流估计器</h1><p id="111c" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">为了训练我们的分类器，我们将使用 TensorFlow，谷歌的开源机器学习库。TensorFlow 有一个相当大的 API 面，但是我们要关注的部分是高级 API，称为估计器。</p><p id="298e" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">评估人员为我们打包了训练循环，因此我们可以通过配置它来训练模型，而不是手工编码。这去掉了许多样板文件，允许我们在更高的抽象层次上思考。这意味着我们将开始玩机器学习的有趣部分，而不会陷入太多的细节。</p><p id="8617" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">由于到目前为止我们只讨论了线性模型，我们将把它放在这里。我们将在将来再次讨论这个例子，以扩展它的功能。</p><h1 id="c367" class="la lb iq bd lc ld md lf lg lh me lj lk ll mf ln lo lp mg lr ls lt mh lv lw lx bi translated">花卉分类:就像葡萄酒 vs 啤酒一样有趣？</h1><p id="6700" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">本周我们将建立一个模型来区分三种不同类型的非常相似的花。我意识到这是一个<em class="mi">小</em>有点不如前一集的啤酒和葡萄酒令人兴奋，但这些花有点更难区分，使这成为一个更有趣的挑战。</p><div class="mj mk gp gr ml mm"><a href="https://medium.com/towards-data-science/the-7-steps-of-machine-learning-2877d7e5548e" rel="noopener follow" target="_blank"><div class="mn ab fo"><div class="mo ab mp cl cj mq"><h2 class="bd ir gy z fp mr fr fs ms fu fw ip bi translated">机器学习的 7 个步骤</h2><div class="mt l"><h3 class="bd b gy z fp mr fr fs ms fu fw dk translated">从检测皮肤癌，到分拣黄瓜，到检测需要维修的自动扶梯，机器学习已经…</h3></div><div class="mu l"><p class="bd b dl z fp mr fr fs ms fu fw dk translated">medium.com</p></div></div><div class="mv l"><div class="mw l mx my mz mv na nb mm"/></div></div></a></div><p id="22de" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">特别是，我们将对不同种类的<a class="ae nc" href="https://en.wikipedia.org/wiki/Iris_flower_data_set" rel="noopener ugc nofollow" target="_blank">鸢尾花</a>进行分类。现在，我不确定我能从一片玫瑰丛中挑出一朵鸢尾花，但我们的模型旨在区分鸢尾、杂色鸢尾和海滨鸢尾。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nd"><img src="../Images/42f515850303c030208f79a036bc5b83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DFH1O1wlV7uAjqnN7WPdtA.png"/></div></div><figcaption class="nj nk gj gh gi nl nm bd b be z dk">Iris Setosa, Iris Versicolour, and Iris Virginica</figcaption></figure><p id="2b36" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们有一个测量这些花的花瓣和萼片的高度和宽度的数据集。这 4 个栏目将作为我们的“特色”。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nn"><img src="../Images/a5ffbcf70feb8743a578feae00d7a5dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OJ5qIIfd98Y5G790kMKMjQ.png"/></div></div></figure><h1 id="8806" class="la lb iq bd lc ld md lf lg lh me lj lk ll mf ln lo lp mg lr ls lt mh lv lw lx bi translated">加载数据</h1><p id="f601" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">导入 TensorFlow 和 NumPy 后，我们将使用 TensorFlow 的<code class="fe no np nq nr b">load_csv_with_header</code>函数加载数据集。数据或特征以浮点数表示，每行数据或目标的“标签”记录为整数:0、1 或 2，对应于 3 种花卉。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi ns"><img src="../Images/67beb28cb8d42a3d41054e4f3ba96935.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pThRpBKucTF2g8JNqYh6ug.png"/></div></div></figure><p id="3522" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我已经打印出了我们加载的结果，我们可以看到，我们现在能够使用命名属性访问训练数据和相关联的标签或目标。</p><h1 id="2e02" class="la lb iq bd lc ld md lf lg lh me lj lk ll mf ln lo lp mg lr ls lt mh lv lw lx bi translated">建立模型</h1><p id="a604" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">接下来，我们将构建模型。为此，我们将首先设置特性列。要素列定义了进入模型的数据类型。我们使用一个 4 维特征列来表示我们的特征，并将其命名为“flower_features”。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nt"><img src="../Images/5a711c1601b623af54454d3b708c1ff4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*p2EOPd2e9AgfRNGFR4tp7A.png"/></div></div></figure><p id="2eae" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">使用估计量建立我们的模型非常简单。使用“tf.estimator.LinearClassifier ”,我们可以通过传入刚刚创建的特征列来实例化模型；模型预测的不同输出的数量，在本例中为 3；以及一个存储模型的训练进度和输出文件的目录。这使得 TensorFlow 可以在需要时从中断的地方继续训练。</p><h1 id="61ea" class="la lb iq bd lc ld md lf lg lh me lj lk ll mf ln lo lp mg lr ls lt mh lv lw lx bi translated">输入功能</h1><p id="9fae" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">这个分类器对象将为我们跟踪状态，我们现在<em class="mi">几乎</em>准备好继续训练了。将我们的模型与训练数据联系起来还有最后一个环节，那就是输入函数。输入函数的任务是创建张量流操作，为模型生成数据。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nu"><img src="../Images/e275915f6b599ca4465da0d6cdc1961e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uX8LITio0iqQ0hKAhWYm1g.png"/></div></div></figure><p id="e8a4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">因此，我们从原始数据到输入函数，输入函数传递数据，然后由特征列映射到模型中。请注意，我们对特性使用了与定义特性列时相同的名称。这就是数据的关联方式。</p><h1 id="36a2" class="la lb iq bd lc ld md lf lg lh me lj lk ll mf ln lo lp mg lr ls lt mh lv lw lx bi translated">运行培训</h1><p id="8506" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">现在是时候开始我们的训练了。为了训练我们的模型，我们只需运行 classifier.train()，将输入函数作为参数传入。这就是我们连接数据集和模型的方式。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi ns"><img src="../Images/2caffa1caa5dce1d2429a173e99c5338.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GKRvGb8o6Kus_E2SAtNl3A.png"/></div></div></figure><p id="1955" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">train 函数处理训练循环并在数据集上迭代，每一步都提高其性能。就这样，我们完成了 1000 个训练步骤！我们的数据集并不大，所以完成得相当快。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nv"><img src="../Images/6905dda7ae0b282e76fdef3a715c8173.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lhq5KRB5WuAKn6X0FQbyyg.png"/></div></div></figure><h1 id="022d" class="la lb iq bd lc ld md lf lg lh me lj lk ll mf ln lo lp mg lr ls lt mh lv lw lx bi translated">评估时间</h1><p id="6e97" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">现在是时候评估我们的结果了。我们可以使用之前的相同分类器对象来实现这一点，因为它保存了模型的训练状态。为了确定我们的模型有多好，我们运行 classifier.evaluate()并传入我们的测试数据集，并从返回的指标中提取准确性。</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi ns"><img src="../Images/cad7408fa49d3d293088a3ddd5122ce1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mJ2HVCiMnQ7VmFbG_rsKgA.png"/></div></div></figure><p id="ed0c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">我们得到了 96.66%的准确率！一点都不差！</p><figure class="kl km kn ko gt kp gh gi paragraph-image"><div role="button" tabindex="0" class="ne nf di ng bf nh"><div class="gh gi nw"><img src="../Images/cee5476bee022d24991433841f8d818c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sKW_Wi20jMs59tcvdqcsVQ.png"/></div></div></figure><h1 id="71c0" class="la lb iq bd lc ld md lf lg lh me lj lk ll mf ln lo lp mg lr ls lt mh lv lw lx bi translated">评估人员:简单的工作流程</h1><p id="d01d" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">让我们在这一周暂停一下，回顾一下到目前为止我们使用估算器所取得的成果。</p><p id="bc32" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Estimators API 为我们提供了一个很好的工作流程:获取原始数据，通过输入函数传递数据，设置我们的特征列和模型结构，运行我们的训练，以及运行我们的评估。这个易于理解的框架允许我们考虑我们的数据及其属性，而不是数学的基础，这是一个很好的地方！</p><h1 id="f8a4" class="la lb iq bd lc ld md lf lg lh me lj lk ll mf ln lo lp mg lr ls lt mh lv lw lx bi translated">下一步是什么</h1><p id="3ce6" class="pw-post-body-paragraph jn jo iq jp b jq ly js jt ju lz jw jx jy ma ka kb kc mb ke kf kg mc ki kj kk ij bi translated">今天我们看了 TensorFlow 的高级 API 的一个非常简单的版本，使用了一个固定的估计器。在未来的几集中，我们将探讨如何用更多的细节来扩充这个模型，使用更复杂的数据，并添加更多的高级功能。</p><p id="99f2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">喜欢这一集吗？在 YouTube 上查看整个播放列表！</p><figure class="kl km kn ko gt kp"><div class="bz fp l di"><div class="nx kr l"/></div></figure></div></div>    
</body>
</html>