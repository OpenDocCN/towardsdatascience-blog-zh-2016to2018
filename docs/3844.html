<html>
<head>
<title>How can I use player name to predict World Cup with 80% accuracy?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用球员名字预测世界杯，准确率 80%？</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-can-use-player-name-to-predict-world-cup-with-80-accuracy-262d076544c4?source=collection_archive---------13-----------------------#2018-06-24">https://towardsdatascience.com/how-can-use-player-name-to-predict-world-cup-with-80-accuracy-262d076544c4?source=collection_archive---------13-----------------------#2018-06-24</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><div class=""/><figure class="gl gn jr js jt ju gh gi paragraph-image"><div role="button" tabindex="0" class="jv jw di jx bf jy"><div class="gh gi jq"><img src="../Images/828de73a2229e08b2146673fb88812b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*HUGysw2qoBcEvH8V.png"/></div></div></figure><p id="bac6" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在这个内核中，我将演示如何通过 Tensorflow 使用球员姓名来预测历史世界杯结果，准确率达到 80%。后来，我试图预测 2018 年世界杯的结果，似乎有一些有趣的发现</p><h1 id="b636" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">阶段</h1><ol class=""><li id="1ec2" class="lx ly it kd b ke lz ki ma km mb kq mc ku md ky me mf mg mh bi translated">数据摄取:首先，我从给定的数据集中获得 3 个数据框架，并从网站上手工构建 2018 年世界杯数据</li><li id="4cfb" class="lx ly it kd b ke mi ki mj km mk kq ml ku mm ky me mf mg mh bi translated">预处理:对建筑物特征嵌入输入所需的特征进行预处理</li><li id="aedd" class="lx ly it kd b ke mi ki mj km mk kq ml ku mm ky me mf mg mh bi translated">转换:为模型输入转换处理过的数据</li><li id="e312" class="lx ly it kd b ke mi ki mj km mk kq ml ku mm ky me mf mg mh bi translated">模型构建:构建字符嵌入模型</li><li id="b663" class="lx ly it kd b ke mi ki mj km mk kq ml ku mm ky me mf mg mh bi translated">评估:尝试预测 2018 年世界杯结果</li></ol><h1 id="dc20" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">特征工程</h1><p id="0a0d" class="pw-post-body-paragraph kb kc it kd b ke lz kg kh ki ma kk kl km mn ko kp kq mo ks kt ku mp kw kx ky im bi translated">为什么球员名字和教练名字选择为特色？这是因为我们发现这些名字可能为我们做预测提供关键信号(来自测试集结果)。</p><h1 id="0e0d" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">标记</h1><p id="5ee3" class="pw-post-body-paragraph kb kc it kd b ke lz kg kh ki ma kk kl km mn ko kp kq mo ks kt ku mp kw kx ky im bi translated">为了建立一个训练数据，让冠军的标号为 1，亚军的标号为 2，季军的标号为 3，依次为 4。团队的其他成员为 0。从数据来看，我们有大约 20 个世界杯记录。</p><p id="65ef" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">数据分布:标签 1、2、3 和 4 分别有 20 条记录，大约有 300 条负数据。</p><h1 id="5139" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">模型结构</h1><p id="ed58" class="pw-post-body-paragraph kb kc it kd b ke lz kg kh ki ma kk kl km mn ko kp kq mo ks kt ku mp kw kx ky im bi translated">我们使用字符嵌入来建模预测模型。如果你不熟悉，你可以看看这篇文章。通过使用定义的函数，我们可以简单地用几行代码构建模型</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="66cc" class="na la it mw b gy nb nc l nd ne">char_cnn = CharCNN(max_len_of_sentence=256, max_num_of_setnence=1)<br/>char_cnn.preporcess(labels=training_df['label'].unique())</span></pre><p id="810a" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">然后处理原始数据</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="acc4" class="na la it mw b gy nb nc l nd ne">x_train, y_train = char_cnn.process(<br/>    df=train_df, x_col='name', y_col='label')<br/>x_test, y_test = char_cnn.process(<br/>    df=test_df, x_col='name', y_col='label')</span></pre><p id="3ead" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">试着预测结果</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="2feb" class="na la it mw b gy nb nc l nd ne">char_cnn.build_model()<br/>char_cnn.train(x_train, y_train, x_test, y_test, batch_size=32, epochs=10)</span></pre><p id="da04" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">输出</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="12ee" class="na la it mw b gy nb nc l nd ne">Train on 341 samples, validate on 86 samples<br/>Epoch 1/10<br/>341/341 [==============================] - 13s 40ms/step - loss: 0.9741 - acc: 0.7801 - val_loss: 1.0188 - val_acc: 0.7674<br/>Epoch 2/10<br/>341/341 [==============================] - 10s 30ms/step - loss: 0.7981 - acc: 0.8240 - val_loss: 1.0271 - val_acc: 0.7674<br/>Epoch 3/10<br/>341/341 [==============================] - 11s 31ms/step - loss: 0.7864 - acc: 0.8240 - val_loss: 1.0512 - val_acc: 0.7674<br/>Epoch 4/10<br/>341/341 [==============================] - 10s 30ms/step - loss: 0.7660 - acc: 0.8240 - val_loss: 0.9753 - val_acc: 0.7674<br/>Epoch 5/10<br/>341/341 [==============================] - 10s 30ms/step - loss: 0.7506 - acc: 0.8240 - val_loss: 1.0135 - val_acc: 0.7674<br/>Epoch 6/10<br/>341/341 [==============================] - 10s 30ms/step - loss: 0.7426 - acc: 0.8240 - val_loss: 1.0135 - val_acc: 0.7674<br/>Epoch 7/10<br/>341/341 [==============================] - 10s 30ms/step - loss: 0.7824 - acc: 0.8240 - val_loss: 1.0176 - val_acc: 0.7674<br/>Epoch 8/10<br/>341/341 [==============================] - 10s 30ms/step - loss: 0.7763 - acc: 0.8240 - val_loss: 1.0137 - val_acc: 0.7674<br/>Epoch 9/10<br/>341/341 [==============================] - 10s 30ms/step - loss: 0.7805 - acc: 0.8240 - val_loss: 0.9793 - val_acc: 0.7674<br/>Epoch 10/10<br/>341/341 [==============================] - 10s 31ms/step - loss: 0.7624 - acc: 0.8240 - val_loss: 1.0138 - val_acc: 0.7674</span></pre><h1 id="8e36" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">估价</h1><p id="27e3" class="pw-post-body-paragraph kb kc it kd b ke lz kg kh ki ma kk kl km mn ko kp kq mo ks kt ku mp kw kx ky im bi translated">来到这篇文章的结尾，准确率好像很不错，大概是 80%左右。让我们看看 2018 年世界杯的预测结果。</p><p id="4241" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">在我们的编码中，4 表示团队失败。说到这一点，你可能会认为这有什么不对吗？请看看结论部分。</p><p id="082f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">输出</p><pre class="mr ms mt mu gt mv mw mx my aw mz bi"><span id="663e" class="na la it mw b gy nb nc l nd ne">array([4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,<br/>       4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,<br/>       4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4,<br/>       4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4])</span></pre><h1 id="e6ff" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">结论</h1><p id="598e" class="pw-post-body-paragraph kb kc it kd b ke lz kg kh ki ma kk kl km mn ko kp kq mo ks kt ku mp kw kx ky im bi translated">完整源代码请去<a class="ae mq" href="https://www.kaggle.com/makcedward/world-cup-prediction-with-80-accuracy-in-dl-model" rel="noopener ugc nofollow" target="_blank"> kaggle </a>看看。</p><p id="2d16" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">谢谢你看了这个毫无意义的模型。实际上，我想展示的是特性的重要性，而不是模型架构。</p><ul class=""><li id="9141" class="lx ly it kd b ke kf ki kj km nf kq ng ku nh ky ni mf mg mh bi translated">当人们谈论“我们正在使用机器学习”、“应用深度神经网络”时，你可能更好地询问特征和数据，而不是询问模型架构。当然，模型架构很重要，但是特性和数据也很重要。请记住<strong class="kd iu">垃圾进，垃圾出</strong>。</li><li id="6367" class="lx ly it kd b ke mi ki mj km mk kq ml ku mm ky ni mf mg mh bi translated">当人们谈论拥有 80%甚至 90%的准确率时。你最好检查一下是<strong class="kd iu">实验的结果还是实际</strong>的结果。许多模型在实验阶段过度拟合，尽管数据科学家认为他们已经很好地防止了这种情况。</li><li id="e833" class="lx ly it kd b ke mi ki mj km mk kq ml ku mm ky ni mf mg mh bi translated">对于测量，更好地理解<strong class="kd iu">其他指标</strong>，而不仅仅是准确度。比如我们在分类上也有精准和召回。我们有机器翻译的 BELU。</li><li id="554f" class="lx ly it kd b ke mi ki mj km mk kq ml ku mm ky ni mf mg mh bi translated">作为一名数据科学家，与其谈论使用 CNN，LSTM bla bla bla，<strong class="kd iu">花更多的时间去理解你的特性和数据</strong></li><li id="fdc0" class="lx ly it kd b ke mi ki mj km mk kq ml ku mm ky ni mf mg mh bi translated">如果您<strong class="kd iu">没有足够大的数据</strong>(在本例中，少于 500 条记录)。不要相信你可以从零开始建立一个惊人的模型。</li></ul><h1 id="72ce" class="kz la it bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">关于我</h1><p id="9f6c" class="pw-post-body-paragraph kb kc it kd b ke lz kg kh ki ma kk kl km mn ko kp kq mo ks kt ku mp kw kx ky im bi translated">我是湾区的数据科学家。专注于数据科学、人工智能，尤其是 NLP 和平台相关领域的最新发展。</p><p id="040f" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">中:<a class="ae mq" href="http://medium.com/@makcedward/" rel="noopener">http://medium.com/@makcedward/</a></p><p id="5738" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">领英:<a class="ae mq" href="https://www.linkedin.com/in/edwardma1026" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/edwardma1026</a></p><p id="f1a0" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">github:<a class="ae mq" href="https://github.com/makcedward" rel="noopener ugc nofollow" target="_blank">https://github.com/makcedward</a></p><p id="dce4" class="pw-post-body-paragraph kb kc it kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky im bi translated">https://www.kaggle.com/makcedward</p></div></div>    
</body>
</html>