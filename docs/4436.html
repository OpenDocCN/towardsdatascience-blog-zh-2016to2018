<html>
<head>
<title>Decomposing Non-linearity with ISOMAP</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用 ISOMAP 分解非线性</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/decomposing-non-linearity-with-isomap-32cf1e95a483?source=collection_archive---------10-----------------------#2018-08-15">https://towardsdatascience.com/decomposing-non-linearity-with-isomap-32cf1e95a483?source=collection_archive---------10-----------------------#2018-08-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="7ddc" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">数据科学的许多应用包括处理像图像这样的高维数据。面对如此大量的多元数据，一个潜在的问题就是如何将它们可视化。为此，我们通常将数据投影到更低的维度。传统的降维技术，如 PCA、LDA 等，由于大多是线性方法，不能给出正确的结果，不能解释数据的非线性结构。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kl"><img src="../Images/209addf9933de9e424287477bacd2c7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:786/format:webp/1*AXXKTGcf3qsmBdTHt3WQkg.png"/></div><figcaption class="kt ku gj gh gi kv kw bd b be z dk">nonlinear data after applying PCA.</figcaption></figure><p id="5ca9" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">线性方法基于<strong class="jp ir">欧几里德距离</strong>来降低维度，而 ISOMAP(等距映射)在多元数据点中使用<strong class="jp ir">测地线距离</strong>方法。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi kx"><img src="../Images/08b2eb1b5d6e83f8b4b7ee1aaa6d545d.png" data-original-src="https://miro.medium.com/v2/resize:fit:984/format:webp/1*WXfslXYOuL7lcNdJdmXrXw.png"/></div></figure><p id="b411" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">Isomap 按照以下步骤工作:</p><ol class=""><li id="794b" class="ky kz iq jp b jq jr ju jv jy la kc lb kg lc kk ld le lf lg bi translated">它根据流形距离确定相邻点，并连接固定半径内的点。</li><li id="d4b9" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">它计算在上述步骤中确定的点之间的测地线距离。</li><li id="19ab" class="ky kz iq jp b jq lh ju li jy lj kc lk kg ll kk ld le lf lg bi translated">最后，在距离图上应用多维缩放，并且保持几何形状，然后优化点的位置。</li></ol><p id="193d" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们举一个简单的例子来理解这一点。我们将在 sklearn 生成的非线性数据集上测试这些算法。</p><pre class="km kn ko kp gt lm ln lo lp aw lq bi"><span id="197d" class="lr ls iq ln b gy lt lu l lv lw">import matplotlib.pyplot as plt<br/>from mpl_toolkits.mplot3d import Axes3D<br/>from matplotlib.ticker import NullFormatter<br/>from sklearn.manifold import Isomap</span><span id="8c4a" class="lr ls iq ln b gy lx lu l lv lw">from sklearn import datasets</span><span id="bc41" class="lr ls iq ln b gy lx lu l lv lw">n_points = 1000</span><span id="b4a5" class="lr ls iq ln b gy lx lu l lv lw"># S dataset</span><span id="c1fb" class="lr ls iq ln b gy lx lu l lv lw">X, color = datasets.samples_generator.make_s_curve(n_points, random_state=0)<br/>n_neighbors = 10<br/>n_components = 2</span><span id="4e01" class="lr ls iq ln b gy lx lu l lv lw">X, color = datasets.samples_generator.make_s_curve(n_points, random_state=0)<br/>n_neighbors = 10<br/>n_components = 2</span></pre><p id="66e5" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">可视化我们生成的数据集。</p><pre class="km kn ko kp gt lm ln lo lp aw lq bi"><span id="b4bb" class="lr ls iq ln b gy lt lu l lv lw">%matplotlib inline<br/>fig = plt.figure(figsize=(15, 8))</span><span id="7130" class="lr ls iq ln b gy lx lu l lv lw">plt.suptitle("S shape dataset"<br/>             % (1000, n_neighbors), fontsize=14)<br/>ax = fig.add_subplot(111, projection='3d')<br/>ax.scatter(X[:, 0], X[:, 1], X[:, 2], c=color, cmap=plt.cm.Spectral)<br/>ax.view_init(4, -72)</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="lz ma di mb bf mc"><div class="gh gi ly"><img src="../Images/3cb631f7b1cde0aaee9088f3ec935875.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WD91LDxbDcJNBJz0ZqbTxQ.png"/></div></div><figcaption class="kt ku gj gh gi kv kw bd b be z dk">S shaped dataset</figcaption></figure><p id="16b4" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">现在我们在上面的数据集上应用 PCA。</p><pre class="km kn ko kp gt lm ln lo lp aw lq bi"><span id="559d" class="lr ls iq ln b gy lt lu l lv lw">Y = PCA(n_components).fit_transform(X)</span><span id="17c9" class="lr ls iq ln b gy lx lu l lv lw">ax = fig.add_subplot(111)<br/>plt.scatter(Y[:, 0], Y[:, 1], c=color, cmap=plt.cm.Spectral)<br/>plt.title("PCA on S curve")<br/>ax.xaxis.set_major_formatter(NullFormatter())<br/>ax.yaxis.set_major_formatter(NullFormatter())<br/>plt.axis('tight')<br/>plt.show()</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi md"><img src="../Images/5f7e8ded6ec510f901de09916982c518.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*nkZOdQF7c73Tn774yHUiqQ.png"/></div></figure><p id="a276" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">在上面的图中，PCA 在二维上分解 3d 图的维度，但是在这样做的时候丢失了很多信息。</p><p id="0c42" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们检查流形上的 Isomap 的结果</p><pre class="km kn ko kp gt lm ln lo lp aw lq bi"><span id="a03f" class="lr ls iq ln b gy lt lu l lv lw">Y = Isomap(n_neighbors, n_components).fit_transform(X)</span><span id="d3d8" class="lr ls iq ln b gy lx lu l lv lw">ax = fig.add_subplot(111)<br/>plt.scatter(Y[:, 0], Y[:, 1], c=color, cmap=plt.cm.Spectral)<br/>plt.title("Isomap on S curve")<br/>ax.xaxis.set_major_formatter(NullFormatter())<br/>ax.yaxis.set_major_formatter(NullFormatter())<br/>plt.axis('tight')<br/>plt.show()</span></pre><figure class="km kn ko kp gt kq gh gi paragraph-image"><div class="gh gi md"><img src="../Images/be3da062f83c7fc8e5d841af656fca5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*z41pSmLy2H1x7M5vdxwzAg.png"/></div></figure><p id="a0fd" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">这里，非线性数据被适当地投影在 2d 图上。Isomap 根据点之间的测地线距离分解数据。</p></div></div>    
</body>
</html>