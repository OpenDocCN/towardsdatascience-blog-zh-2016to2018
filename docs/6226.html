<html>
<head>
<title>Syncing your Jupyter Notebook Charts to Microsoft Word Reports</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将 Jupyter 笔记本图表同步到 Microsoft Word 报表</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/syncing-your-jupyter-notebook-charts-to-microsoft-word-reports-187fc6cde5b6?source=collection_archive---------12-----------------------#2018-12-02">https://towardsdatascience.com/syncing-your-jupyter-notebook-charts-to-microsoft-word-reports-187fc6cde5b6?source=collection_archive---------12-----------------------#2018-12-02</a></blockquote><div><div class="fc ih ii ij ik il"/><div class="im in io ip iq"><figure class="is it gp gr iu iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ir"><img src="../Images/e252583161d8d95f018160b591f8f9f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kiMxQP04AoO4hIz8APPwHQ.jpeg"/></div></div><figcaption class="jc jd gj gh gi je jf bd b be z dk">Photo by <a class="ae jg" href="https://unsplash.com/photos/ywwoGCpczeM?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">J-S Romeo</a> on <a class="ae jg" href="https://unsplash.com/search/photos/word-document?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><div class=""/><p id="d30c" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><strong class="ki jk"> <em class="le">情况是这样的</em> </strong>:你正在 Jupyter 笔记本上做大数据分析。你有大量的图表，你想对它们进行报告。理想情况下，你可以在 Jupyter 笔记本上创建你的最终报告，它具有所有花哨的降价功能，并且能够将你的代码和报告保存在同一个地方。但问题是:大多数人仍然想要 Word 文档报告，并不关心您的代码、可复制性等。报道时，以最有用的形式向人们提供信息是很重要的。</p><p id="a059" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">因此，您有大量的图表和图形想要放入 Word 报告中——您如何保持两者同步呢？如果您的图表稍有变化(例如，更改报告中每个图表的样式)会怎样？您不得不从笔记本中复制和粘贴图表，这是一个手动、耗时且容易出错的过程。</p><p id="42b3" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在这篇文章中，我将向你展示我对这个问题的解决方案。它包括以下步骤:</p><ul class=""><li id="f45c" class="lf lg jj ki b kj kk kn ko kr lh kv li kz lj ld lk ll lm ln bi translated"><strong class="ki jk">用代码将 Jupyter 笔记本上的图表图像保存到你的桌面上。</strong></li><li id="c7d0" class="lf lg jj ki b kj lo kn lp kr lq kv lr kz ls ld lk ll lm ln bi translated"><strong class="ki jk">准备您的 Word 文档报告，在报告的适当位置引用您保存在桌面上的图像名称。</strong></li><li id="00cd" class="lf lg jj ki b kj lo kn lp kr lq kv lr kz ls ld lk ll lm ln bi translated"><strong class="ki jk">将图像加载到新版本的 Word 文档中。</strong></li></ul><h1 id="2c3a" class="lt lu jj bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">将 Jupyter 笔记本中的图表图像保存到桌面</h1><p id="221f" class="pw-post-body-paragraph kg kh jj ki b kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">第一步是收集您想要加载到报告中的图像，将它们从 Jupyter 笔记本保存到硬盘上的图像文件中。在这篇文章中，我将使用几个月前我的“<a class="ae jg" href="http://www.marknagelberg.com/lets-scrape-a-blog-part-1/" rel="noopener ugc nofollow" target="_blank">让我们刮一个博客</a>”文章中产生的数据和分析，在那里我刮了我最喜欢的博客<a class="ae jg" href="https://marginalrevolution.com/" rel="noopener ugc nofollow" target="_blank">边际革命</a>并做了一些简单的分析。</p><p id="63e2" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">该分析使用 matplotlib 生成了一些简单的结果图表。为了将这些图像保存到您的桌面，matplotlib 提供了一个名为 savefig 的有用函数。例如，在该分析中生成的一个图表按作者查看了博客帖子的数量:</p><figure class="mx my mz na gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi mw"><img src="../Images/7d8bd5d747cc8b9cce9e9891960cebc0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4tPjXtvxdgzfhNKfepBUOw.png"/></div></div></figure><p id="bccb" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">以下代码生成此图表，并将其保存到“report_images”文件夹中名为“num_posts_by_author_plot.png”的文件中。</p><figure class="mx my mz na gt iv"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="bc50" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">关于这一步的几点建议:</p><ul class=""><li id="f8a5" class="lf lg jj ki b kj kk kn ko kr lh kv li kz lj ld lk ll lm ln bi translated"><em class="le">确保给你的图片起一个有用的、描述性的名字</em>。这有助于确保在 Word 文档中放置正确的引用。我个人喜欢遵循这样的惯例，即在代码中给绘图图像取与绘图对象相同的名称。</li><li id="399e" class="lf lg jj ki b kj lo kn lp kr lq kv lr kz ls ld lk ll lm ln bi translated"><em class="le">您的图像必须有唯一的名称，否则第一个图像将被第二个图像覆盖</em>。</li><li id="5e83" class="lf lg jj ki b kj lo kn lp kr lq kv lr kz ls ld lk ll lm ln bi translated"><em class="le">为了保持有序，请将图像存储在专门为保存报告图像而设计的单独文件夹中</em>。</li></ul><p id="e4c0" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">对我的其他图表重复类似的代码，我的 report_images 文件夹中只剩下 5 个图表图像:</p><figure class="mx my mz na gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi nd"><img src="../Images/1cafb748b77b60f6bc309f10ecaa56d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FnvlKSJpPc8R29_0WMsIww.png"/></div></div></figure><h1 id="cf93" class="lt lu jj bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">准备带有图像引用的 Word 文档报告</h1><p id="68e7" class="pw-post-body-paragraph kg kh jj ki b kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">有一个流行的微软 Word 文档包叫做<a class="ae jg" href="https://python-docx.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> python-docx </a>，它是一个很棒的库，可以用 Python 代码操作 Word 文档。但是，它的 API 不允许您在文档中间插入图像。</p><p id="6383" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">我们真正需要的是类似 Jinja2 for Word Docs 的东西:一个可以在文档中指定特殊占位符值，然后自动加载图像的包。嗯，幸运的是确实有这样一个包存在:<a class="ae jg" href="https://docxtpl.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank"> python-docx-template </a>。它构建在 python-docx 和 Jinja2 之上，允许您在 Word 文档中使用类似 Jinja2 的语法(参见<a class="ae jg" href="http://www.marknagelberg.com/creating-pdf-reports-with-python-pdfkit-and-jinja2-templates/" rel="noopener ugc nofollow" target="_blank">我的另一篇关于使用 Jinja2 模板创建 PDF 报告的文章</a>)。</p><p id="66f7" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要使用 python-docx-template 将图像导入 Word，很简单:只需在 Word 文档中使用常用的 Jinja2 语法{{ image_variable }}。在我的例子中，我有六张图片，我放在一起测试的 Word 模板看起来像这样:</p><figure class="mx my mz na gt iv gh gi paragraph-image"><div role="button" tabindex="0" class="iw ix di iy bf iz"><div class="gh gi ne"><img src="../Images/5ed248f73fce06fe5c1dd1ef282132eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*spoL0TcU71iqRMdf5WqJcg.png"/></div></div></figure><p id="2ebb" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">为了让系统工作，您必须在{{ }}中使用与图像名称对齐的变量名(在'之前)。png ')和 Jupyter 笔记本中的绘图变量名。</p><h1 id="7b3a" class="lt lu jj bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated">将图像加载到文档中</h1><p id="bd3e" class="pw-post-body-paragraph kg kh jj ki b kj mr kl km kn ms kp kq kr mt kt ku kv mu kx ky kz mv lb lc ld im bi translated">最后也是最重要的一步是获取模板中的所有图像。为此，代码大致遵循以下步骤:加载 Word 文档模板，从 image 目录中加载图像作为 InlineImage 对象的 dict，在 Word 文档中呈现图像，并将加载的图像版本保存为新文件名。</p><p id="66a7" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">下面是执行此操作的代码:</p><figure class="mx my mz na gt iv"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="1695" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">要运行代码，您需要指定 Word 模板文档、将包含图像的新 Word 文档名称以及存储图像的目录。</p><pre class="mx my mz na gt nf ng nh ni aw nj bi"><span id="498a" class="nk lu jj ng b gy nl nm l nn no">python load_images.py &lt;template Word Doc Filename&gt; &lt;image-loaded Word Doc filename&gt; &lt;image directory name&gt;</span></pre><p id="4036" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">在我的例子中，我使用了以下命令，它接受模板<em class="le"> template.docx </em>，生成加载了图像的 Word 文档<em class="le"> result.docx </em>，并从文件夹<em class="le"> report_images </em>中获取图像:</p><pre class="mx my mz na gt nf ng nh ni aw nj bi"><span id="dde5" class="nk lu jj ng b gy nl nm l nn no">python load_images.py template.docx result.docx report_images</span></pre><p id="19b0" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">瞧，加载了图像的 Word 文档看起来像这样:</p><figure class="mx my mz na gt iv gh gi paragraph-image"><div class="gh gi np"><img src="../Images/4512c39102e0c5e62d65bff92bc17125.png" data-original-src="https://miro.medium.com/v2/resize:fit:944/format:webp/1*Hxp5nCb_2SxND8xt3dbpzQ.png"/></div></figure><p id="377d" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated">你可以在 Github <a class="ae jg" href="https://github.com/marknagelberg/load-images-to-word" rel="noopener ugc nofollow" target="_blank">这里</a>找到我用来创建这个指南的代码。</p></div><div class="ab cl nq nr hx ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="im in io ip iq"><p id="8c40" class="pw-post-body-paragraph kg kh jj ki b kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld im bi translated"><em class="le">原载于 2018 年 12 月 2 日</em><a class="ae jg" href="http://www.marknagelberg.com/syncing-your-jupyter-notebook-charts-to-microsoft-word-reports/" rel="noopener ugc nofollow" target="_blank"><em class="le">【www.marknagelberg.com】</em></a><em class="le">。你可以在推特上关注我</em> <a class="ae jg" href="https://twitter.com/MarkNagelberg" rel="noopener ugc nofollow" target="_blank"> <em class="le">这里</em> </a> <em class="le">。要访问我共享的 Anki deck 和 Roam Research notes 知识库，以及关于间隔重复和提高学习效率的技巧和想法的定期更新，</em> <a class="ae jg" href="http://downloadmarksbrain.marknagelberg.com/auth" rel="noopener ugc nofollow" target="_blank"> <em class="le">加入“下载马克的大脑”。</em> </a></p></div></div>    
</body>
</html>